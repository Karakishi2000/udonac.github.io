(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[179],{7849:(T,fe,Ce)=>{"use strict";function f(n){return"function"==typeof n}function S(n){const e=n(i=>{Error.call(i),i.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const te=S(n=>function(e){n(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function v(n,t){if(n){const e=n.indexOf(t);0<=e&&n.splice(e,1)}}class D{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const o of e)o.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(f(i))try{i()}catch(o){t=o instanceof te?o.errors:[o]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const o of r)try{Q(o)}catch(s){t=null!=t?t:[],s instanceof te?t=[...t,...s.errors]:t.push(s)}}if(t)throw new te(t)}}add(t){var e;if(t&&t!==this)if(this.closed)Q(t);else{if(t instanceof D){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&v(e,t)}remove(t){const{_finalizers:e}=this;e&&v(e,t),t instanceof D&&t._removeParent(this)}}D.EMPTY=(()=>{const n=new D;return n.closed=!0,n})();const z=D.EMPTY;function I(n){return n instanceof D||n&&"closed"in n&&f(n.remove)&&f(n.add)&&f(n.unsubscribe)}function Q(n){f(n)?n():n.unsubscribe()}const U={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},N={setTimeout(n,t,...e){const{delegate:i}=N;return(null==i?void 0:i.setTimeout)?i.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){const{delegate:t}=N;return((null==t?void 0:t.clearTimeout)||clearTimeout)(n)},delegate:void 0};function G(n){N.setTimeout(()=>{const{onUnhandledError:t}=U;if(!t)throw n;t(n)})}function re(){}const q=le("C",void 0,void 0);function le(n,t,e){return{kind:n,value:t,error:e}}let Z=null;function Y(n){if(U.useDeprecatedSynchronousErrorHandling){const t=!Z;if(t&&(Z={errorThrown:!1,error:null}),n(),t){const{errorThrown:e,error:i}=Z;if(Z=null,e)throw i}}else n()}class k extends D{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,I(t)&&t.add(this)):this.destination=L}static create(t,e,i){return new A(t,e,i)}next(t){this.isStopped?P(function V(n){return le("N",n,void 0)}(t),this):this._next(t)}error(t){this.isStopped?P(function E(n){return le("E",void 0,n)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?P(q,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const R=Function.prototype.bind;function ee(n,t){return R.call(n,t)}class H{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(i){M(i)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(i){M(i)}else M(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){M(e)}}}class A extends k{constructor(t,e,i){let r;if(super(),f(t)||!t)r={next:null!=t?t:void 0,error:null!=e?e:void 0,complete:null!=i?i:void 0};else{let o;this&&U.useDeprecatedNextContext?(o=Object.create(t),o.unsubscribe=()=>this.unsubscribe(),r={next:t.next&&ee(t.next,o),error:t.error&&ee(t.error,o),complete:t.complete&&ee(t.complete,o)}):r=t}this.destination=new H(r)}}function M(n){U.useDeprecatedSynchronousErrorHandling?function X(n){U.useDeprecatedSynchronousErrorHandling&&Z&&(Z.errorThrown=!0,Z.error=n)}(n):G(n)}function P(n,t){const{onStoppedNotification:e}=U;e&&N.setTimeout(()=>e(n,t))}const L={closed:!0,next:re,error:function C(n){throw n},complete:re},ne="function"==typeof Symbol&&Symbol.observable||"@@observable";function F(n){return n}function he(...n){return B(n)}function B(n){return 0===n.length?F:1===n.length?n[0]:function(e){return n.reduce((i,r)=>r(i),e)}}let O=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new n;return i.source=this,i.operator=e,i}subscribe(e,i,r){const o=function c(n){return n&&n instanceof k||function l(n){return n&&f(n.next)&&f(n.error)&&f(n.complete)}(n)&&I(n)}(e)?e:new A(e,i,r);return Y(()=>{const{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=m(i))((r,o)=>{const s=new A({next:a=>{try{e(a)}catch(g){o(g),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(e){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(e)}[ne](){return this}pipe(...e){return B(e)(this)}toPromise(e){return new(e=m(e))((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return n.create=t=>new n(t),n})();function m(n){var t;return null!==(t=null!=n?n:U.Promise)&&void 0!==t?t:Promise}const h=S(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let d=(()=>{class n extends O{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const i=new p(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new h}next(e){Y(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(e)}})}error(e){Y(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){Y(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:i,isStopped:r,observers:o}=this;return i||r?z:(this.currentObservers=null,o.push(e),new D(()=>{this.currentObservers=null,v(o,e)}))}_checkFinalizedStatuses(e){const{hasError:i,thrownError:r,isStopped:o}=this;i?e.error(r):o&&e.complete()}asObservable(){const e=new O;return e.source=this,e}}return n.create=(t,e)=>new p(t,e),n})();class p extends d{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===i||i.call(e,t)}error(t){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===i||i.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,i;return null!==(i=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==i?i:z}}function _(n){return f(null==n?void 0:n.lift)}function x(n){return t=>{if(_(t))return t.lift(function(e){try{return n(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function $(n,t,e,i,r){return new se(n,t,e,i,r)}class se extends k{constructor(t,e,i,r,o,s){super(t),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=e?function(a){try{e(a)}catch(g){t.error(g)}}:super._next,this._error=r?function(a){try{r(a)}catch(g){t.error(g)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){t.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function ae(n,t){return x((e,i)=>{let r=0;e.subscribe($(i,o=>{i.next(n.call(t,o,r++))}))})}var Te=function(n,t){return(Te=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])})(n,t)};function Ae(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=n}Te(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}var de=function(){return de=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},de.apply(this,arguments)};function xe(n,t,e,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,e):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(t,e,o):s(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o}function Pe(n){return this instanceof Pe?(this.v=n,this):new Pe(n)}function Ue(n,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=e.apply(n,t||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(me){i[me]&&(r[me]=function(Se){return new Promise(function(Oe,Ve){o.push([me,Se,Oe,Ve])>1||a(me,Se)})})}function a(me,Se){try{!function g(me){me.value instanceof Pe?Promise.resolve(me.value.v).then(w,W):ve(o[0][2],me)}(i[me](Se))}catch(Oe){ve(o[0][3],Oe)}}function w(me){a("next",me)}function W(me){a("throw",me)}function ve(me,Se){me(Se),o.shift(),o.length&&a(o[0][0],o[0][1])}}function nt(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=n[Symbol.asyncIterator];return t?t.call(n):(n=function ye(n){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&n[t],i=0;if(e)return e.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(o){e[o]=n[o]&&function(s){return new Promise(function(a,g){!function r(o,s,a,g){Promise.resolve(g).then(function(w){o({value:w,done:a})},s)}(a,g,(s=n[o](s)).done,s.value)})}}}const Hi=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function lr(n){return f(null==n?void 0:n.then)}function Sl(n){return f(n[ne])}function vc(n){return Symbol.asyncIterator&&f(null==n?void 0:n[Symbol.asyncIterator])}function Jo(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Cd=function Dl(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function eu(n){return f(null==n?void 0:n[Cd])}function xd(n){return Ue(this,arguments,function*(){const e=n.getReader();try{for(;;){const{value:i,done:r}=yield Pe(e.read());if(r)return yield Pe(void 0);yield yield Pe(i)}}finally{e.releaseLock()}})}function tu(n){return f(null==n?void 0:n.getReader)}function Mo(n){if(n instanceof O)return n;if(null!=n){if(Sl(n))return function Bp(n){return new O(t=>{const e=n[ne]();if(f(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(Hi(n))return function jf(n){return new O(t=>{for(let e=0;e<n.length&&!t.closed;e++)t.next(n[e]);t.complete()})}(n);if(lr(n))return function Gf(n){return new O(t=>{n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,G)})}(n);if(vc(n))return qf(n);if(eu(n))return function Lp(n){return new O(t=>{for(const e of n)if(t.next(e),t.closed)return;t.complete()})}(n);if(tu(n))return function wd(n){return qf(xd(n))}(n)}throw Jo(n)}function qf(n){return new O(t=>{(function nu(n,t){var e,i,r,o;return function Me(n,t,e,i){return new(e||(e=Promise))(function(o,s){function a(W){try{w(i.next(W))}catch(ve){s(ve)}}function g(W){try{w(i.throw(W))}catch(ve){s(ve)}}function w(W){W.done?o(W.value):function r(o){return o instanceof e?o:new e(function(s){s(o)})}(W.value).then(a,g)}w((i=i.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){try{for(e=nt(n);!(i=yield e.next()).done;)if(t.next(i.value),t.closed)return}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=e.return)&&(yield o.call(e))}finally{if(r)throw r.error}}t.complete()})})(n,t).catch(e=>t.error(e))})}function es(n,t,e,i=0,r=!1){const o=t.schedule(function(){e(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(o),!r)return o}function bc(n,t,e=1/0){return f(t)?bc((i,r)=>ae((o,s)=>t(i,o,r,s))(Mo(n(i,r))),e):("number"==typeof t&&(e=t),x((i,r)=>function zp(n,t,e,i,r,o,s,a){const g=[];let w=0,W=0,ve=!1;const me=()=>{ve&&!g.length&&!w&&t.complete()},Se=Ve=>w<i?Oe(Ve):g.push(Ve),Oe=Ve=>{o&&t.next(Ve),w++;let We=!1;Mo(e(Ve,W++)).subscribe($(t,Ze=>{null==r||r(Ze),o?Se(Ze):t.next(Ze)},()=>{We=!0},void 0,()=>{if(We)try{for(w--;g.length&&w<i;){const Ze=g.shift();s?es(t,s,()=>Oe(Ze)):Oe(Ze)}me()}catch(Ze){t.error(Ze)}}))};return n.subscribe($(t,Se,()=>{ve=!0,me()})),()=>{null==a||a()}}(i,r,n,e)))}function iu(n=1/0){return bc(F,n)}const Ed=new O(n=>n.complete());function Td(n){return n&&f(n.schedule)}function ru(n){return n[n.length-1]}function Il(n){return f(ru(n))?n.pop():void 0}function kl(n){return Td(ru(n))?n.pop():void 0}function ha(n,t=0){return x((e,i)=>{e.subscribe($(i,r=>es(i,n,()=>i.next(r),t),()=>es(i,n,()=>i.complete(),t),r=>es(i,n,()=>i.error(r),t)))})}function Ml(n,t=0){return x((e,i)=>{i.add(n.schedule(()=>e.subscribe(i),t))})}function Cc(n,t){if(!n)throw new Error("Iterable cannot be null");return new O(e=>{es(e,t,()=>{const i=n[Symbol.asyncIterator]();es(e,t,()=>{i.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function mo(n,t){return t?function Ao(n,t){if(null!=n){if(Sl(n))return function yc(n,t){return Mo(n).pipe(Ml(t),ha(t))}(n,t);if(Hi(n))return function Al(n,t){return new O(e=>{let i=0;return t.schedule(function(){i===n.length?e.complete():(e.next(n[i++]),e.closed||this.schedule())})})}(n,t);if(lr(n))return function ou(n,t){return Mo(n).pipe(Ml(t),ha(t))}(n,t);if(vc(n))return Cc(n,t);if(eu(n))return function Up(n,t){return new O(e=>{let i;return es(e,t,()=>{i=n[Cd](),es(e,t,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){return void e.error(s)}o?e.complete():e.next(r)},0,!0)}),()=>f(null==i?void 0:i.return)&&i.return()})}(n,t);if(tu(n))return function su(n,t){return Cc(xd(n),t)}(n,t)}throw Jo(n)}(n,t):Mo(n)}function $o(...n){const t=kl(n),e=function Sd(n,t){return"number"==typeof ru(n)?n.pop():t}(n,1/0),i=n;return i.length?1===i.length?Mo(i[0]):iu(e)(mo(i,t)):Ed}function Po(n){return n<=0?()=>Ed:x((t,e)=>{let i=0;t.subscribe($(e,r=>{++i<=n&&(e.next(r),n<=i&&e.complete())}))})}function Fo(n,t,...e){return!0===t?(n(),null):!1===t?null:t(...e).pipe(Po(1)).subscribe(()=>n())}function Zn(n){for(let t in n)if(n[t]===Zn)return t;throw Error("Could not find renamed property on target object.")}function au(n,t){for(const e in t)t.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(n[e]=t[e])}function ui(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(ui).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const t=n.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function Za(n,t){return null==n||""===n?null===t?"":t:null==t||""===t?n:n+" "+t}const Ro=Zn({__forward_ref__:Zn});function oi(n){return n.__forward_ref__=oi,n.toString=function(){return ui(this())},n}function Dn(n){return lu(n)?n():n}function lu(n){return"function"==typeof n&&n.hasOwnProperty(Ro)&&n.__forward_ref__===oi}class jt extends Error{constructor(t,e){super(function Ya(n,t){return`NG0${Math.abs(n)}${t?": "+t:""}`}(t,e)),this.code=t}}function _n(n){return"string"==typeof n?n:null==n?"":String(n)}function Dr(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():_n(n)}function xc(n,t){const e=t?` in ${t}`:"";throw new jt(-201,`No provider for ${Dr(n)} found${e}`)}function No(n,t){null==n&&function qi(n,t,e,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${e} ${i} ${t} <=Actual]`))}(t,n,null,"!=")}function Tn(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function ts(n){return{providers:n.providers||[],imports:n.imports||[]}}function Gp(n){return Qm(n,Wf)||Qm(n,Jm)}function Qm(n,t){return n.hasOwnProperty(t)?n[t]:null}function Ni(n){return n&&(n.hasOwnProperty(qp)||n.hasOwnProperty(Cb))?n[qp]:null}const Wf=Zn({\u0275prov:Zn}),qp=Zn({\u0275inj:Zn}),Jm=Zn({ngInjectableDef:Zn}),Cb=Zn({ngInjectorDef:Zn});var Rn=(()=>((Rn=Rn||{})[Rn.Default=0]="Default",Rn[Rn.Host=1]="Host",Rn[Rn.Self=2]="Self",Rn[Rn.SkipSelf=4]="SkipSelf",Rn[Rn.Optional=8]="Optional",Rn))();let Wp;function Fl(n){const t=Wp;return Wp=n,t}function Ir(n,t,e){const i=Gp(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:e&Rn.Optional?null:void 0!==t?t:void xc(ui(n),"Injector")}function Cs(n){return{toString:n}.toString()}var xs=(()=>((xs=xs||{})[xs.OnPush=0]="OnPush",xs[xs.Default=1]="Default",xs))(),ws=(()=>{return(n=ws||(ws={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",ws;var n})();const n0="undefined"!=typeof globalThis&&globalThis,r0="undefined"!=typeof window&&window,o0="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,wi=n0||"undefined"!=typeof global&&global||r0||o0,Ur={},Oi=[],kd=Zn({\u0275cmp:Zn}),pa=Zn({\u0275dir:Zn}),uu=Zn({\u0275pipe:Zn}),Zf=Zn({\u0275mod:Zn}),di=Zn({\u0275fac:Zn}),Ts=Zn({__NG_ELEMENT_ID__:Zn});let Zp=0;function Qt(n){return Cs(()=>{const e={},i={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===xs.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||Oi,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||ws.Emulated,id:"c",styles:n.styles||Oi,_:null,setInput:null,schemas:n.schemas||null,tView:null},r=n.directives,o=n.features,s=n.pipes;return i.id+=Zp++,i.inputs=wc(n.inputs,e),i.outputs=wc(n.outputs),o&&o.forEach(a=>a(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(s0):null,i.pipeDefs=s?()=>("function"==typeof s?s():s).map(a0):null,i})}function s0(n){return Gr(n)||function ga(n){return n[pa]||null}(n)}function a0(n){return function Ka(n){return n[uu]||null}(n)}const l0={};function ns(n){return Cs(()=>{const t={type:n.type,bootstrap:n.bootstrap||Oi,declarations:n.declarations||Oi,imports:n.imports||Oi,exports:n.exports||Oi,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(l0[n.id]=n.type),t})}function wc(n,t){if(null==n)return Ur;const e={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],o=r;Array.isArray(r)&&(o=r[1],r=r[0]),e[r]=i,t&&(t[r]=o)}return e}const nn=Qt;function jr(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,onDestroy:n.type.prototype.ngOnDestroy||null}}function Gr(n){return n[kd]||null}function is(n,t){const e=n[Zf]||null;if(!e&&!0===t)throw new Error(`Type ${ui(n)} does not have '\u0275mod' property.`);return e}function _a(n){return Array.isArray(n)&&"object"==typeof n[1]}function qs(n){return Array.isArray(n)&&!0===n[1]}function Xp(n){return 0!=(8&n.flags)}function Dc(n){return 2==(2&n.flags)}function at(n){return 1==(1&n.flags)}function mt(n){return null!==n.template}function gt(n){return 0!=(512&n[2])}function ma(n,t){return n.hasOwnProperty(di)?n[di]:null}class d0{constructor(t,e,i){this.previousValue=t,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function br(){return rg}function rg(n){return n.type.prototype.ngOnChanges&&(n.setInput=Qf),f0}function f0(){const n=pu(this),t=null==n?void 0:n.current;if(t){const e=n.previous;if(e===Ur)n.previous=t;else for(let i in t)e[i]=t[i];n.current=null,this.ngOnChanges(t)}}function Qf(n,t,e,i){const r=pu(n)||function kc(n,t){return n[og]=t}(n,{previous:Ur,current:null}),o=r.current||(r.current={}),s=r.previous,a=this.declaredInputs[e],g=s[a];o[a]=new d0(g&&g.currentValue,t,s===Ur),n[i]=t}br.ngInherit=!0;const og="__ngSimpleChanges__";function pu(n){return n[og]||null}let eh;function lg(){return void 0!==eh?eh:"undefined"!=typeof document?document:void 0}function Yn(n){return!!n.listen}const h0={createRenderer:(n,t)=>lg()};function ur(n){for(;Array.isArray(n);)n=n[0];return n}function Nl(n,t){return ur(t[n])}function Bo(n,t){return ur(t[n.index])}function Mc(n,t){return n.data[t]}function $a(n,t){return n[t]}function so(n,t){const e=t[n];return _a(e)?e:e[0]}function Ac(n){return 4==(4&n[2])}function cg(n){return 128==(128&n[2])}function Ol(n,t){return null==t?null:n[t]}function g0(n){n[18]=0}function ug(n,t){n[5]+=t;let e=n,i=n[3];for(;null!==i&&(1===t&&1===e[5]||-1===t&&0===e[5]);)i[5]+=t,e=i,i=i[3]}const wn={lFrame:_g(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Nd(){return wn.bindingsEnabled}function Tt(){return wn.lFrame.lView}function ii(){return wn.lFrame.tView}function Le(n){return wn.lFrame.contextLView=n,n[8]}function Zi(){let n=m0();for(;null!==n&&64===n.type;)n=n.parent;return n}function m0(){return wn.lFrame.currentTNode}function va(n,t){const e=wn.lFrame;e.currentTNode=n,e.isParent=t}function dg(){return wn.lFrame.isParent}function fg(){wn.lFrame.isParent=!1}function nh(){return wn.isInCheckNoChangesMode}function ih(n){wn.isInCheckNoChangesMode=n}function vo(){const n=wn.lFrame;let t=n.bindingRootIndex;return-1===t&&(t=n.bindingRootIndex=n.tView.bindingStartIndex),t}function Xa(){return wn.lFrame.bindingIndex}function vu(){return wn.lFrame.bindingIndex++}function Qa(n){const t=wn.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+n,e}function Nb(n,t){const e=wn.lFrame;e.bindingIndex=e.bindingRootIndex=n,hg(t)}function hg(n){wn.lFrame.currentDirectiveIndex=n}function Is(){return wn.lFrame.currentQueryIndex}function gg(n){wn.lFrame.currentQueryIndex=n}function Ob(n){const t=n[1];return 2===t.type?t.declTNode:1===t.type?n[6]:null}function v0(n,t,e){if(e&Rn.SkipSelf){let r=t,o=n;for(;!(r=r.parent,null!==r||e&Rn.Host||(r=Ob(o),null===r||(o=o[15],10&r.type))););if(null===r)return!1;t=r,n=o}const i=wn.lFrame=b0();return i.currentTNode=t,i.lView=n,!0}function rh(n){const t=b0(),e=n[1];wn.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function b0(){const n=wn.lFrame,t=null===n?null:n.child;return null===t?_g(n):t}function _g(n){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=t),t}function mg(){const n=wn.lFrame;return wn.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const y0=mg;function oh(){const n=mg();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Pr(){return wn.lFrame.selectedIndex}function Ll(n){wn.lFrame.selectedIndex=n}function tr(){const n=wn.lFrame;return Mc(n.tView,n.selectedIndex)}function bu(){wn.lFrame.currentNamespace="svg"}function Ld(n,t){for(let e=t.directiveStart,i=t.directiveEnd;e<i;e++){const o=n.data[e].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:g,ngAfterViewChecked:w,ngOnDestroy:W}=o;s&&(n.contentHooks||(n.contentHooks=[])).push(-e,s),a&&((n.contentHooks||(n.contentHooks=[])).push(e,a),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(e,a)),g&&(n.viewHooks||(n.viewHooks=[])).push(-e,g),w&&((n.viewHooks||(n.viewHooks=[])).push(e,w),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(e,w)),null!=W&&(n.destroyHooks||(n.destroyHooks=[])).push(e,W)}}function zd(n,t,e){bg(n,t,3,e)}function zl(n,t,e,i){(3&n[2])===e&&bg(n,t,e,i)}function ya(n,t){let e=n[2];(3&e)===t&&(e&=2047,e+=1,n[2]=e)}function bg(n,t,e,i){const o=null!=i?i:-1,s=t.length-1;let a=0;for(let g=void 0!==i?65535&n[18]:0;g<s;g++)if("number"==typeof t[g+1]){if(a=t[g],null!=i&&a>=i)break}else t[g]<0&&(n[18]+=65536),(a<o||-1==o)&&(Lb(n,e,t,g),n[18]=(4294901760&n[18])+g+2),g++}function Lb(n,t,e,i){const r=e[i]<0,o=e[i+1],a=n[r?-e[i]:e[i]];if(r){if(n[2]>>11<n[18]>>16&&(3&n[2])===t){n[2]+=2048;try{o.call(a)}finally{}}}else try{o.call(a)}finally{}}class Hd{constructor(t,e,i){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function Vd(n,t,e){const i=Yn(n);let r=0;for(;r<e.length;){const o=e[r];if("number"==typeof o){if(0!==o)break;r++;const s=e[r++],a=e[r++],g=e[r++];i?n.setAttribute(t,a,g,s):t.setAttributeNS(s,a,g)}else{const s=o,a=e[++r];Ud(s)?i&&n.setProperty(t,s,a):i?n.setAttribute(t,s,a):t.setAttribute(s,a),r++}}return r}function ao(n){return 3===n||4===n||6===n}function Ud(n){return 64===n.charCodeAt(0)}function ah(n,t){if(null!==t&&0!==t.length)if(null===n||0===n.length)n=t.slice();else{let e=-1;for(let i=0;i<t.length;i++){const r=t[i];"number"==typeof r?e=r:0===e||x0(n,e,r,null,-1===e||2===e?t[++i]:null)}}return n}function x0(n,t,e,i,r){let o=0,s=n.length;if(-1===t)s=-1;else for(;o<n.length;){const a=n[o++];if("number"==typeof a){if(a===t){s=-1;break}if(a>t){s=o-1;break}}}for(;o<n.length;){const a=n[o];if("number"==typeof a)break;if(a===e){if(null===i)return void(null!==r&&(n[o+1]=r));if(i===n[o+1])return void(n[o+2]=r)}o++,null!==i&&o++,null!==r&&o++}-1!==s&&(n.splice(s,0,t),o=s+1),n.splice(o++,0,e),null!==i&&n.splice(o++,0,i),null!==r&&n.splice(o++,0,r)}function w0(n){return-1!==n}function Hl(n){return 32767&n}function xa(n,t){let e=function zb(n){return n>>16}(n),i=t;for(;e>0;)i=i[15],e--;return i}let lh=!0;function ch(n){const t=lh;return lh=n,t}let Hb=0;function xu(n,t){const e=Eg(n,t);if(-1!==e)return e;const i=t[1];i.firstCreatePass&&(n.injectorIndex=t.length,wg(i.data,n),wg(t,null),wg(i.blueprint,null));const r=uh(n,t),o=n.injectorIndex;if(w0(r)){const s=Hl(r),a=xa(r,t),g=a[1].data;for(let w=0;w<8;w++)t[o+w]=a[s+w]|g[s+w]}return t[o+8]=r,o}function wg(n,t){n.push(0,0,0,0,0,0,0,0,t)}function Eg(n,t){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===t[n.injectorIndex+8]?-1:n.injectorIndex}function uh(n,t){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let e=0,i=null,r=t;for(;null!==r;){const o=r[1],s=o.type;if(i=2===s?o.declTNode:1===s?r[6]:null,null===i)return-1;if(e++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|e<<16}return-1}function jd(n,t,e){!function xg(n,t,e){let i;"string"==typeof e?i=e.charCodeAt(0)||0:e.hasOwnProperty(Ts)&&(i=e[Ts]),null==i&&(i=e[Ts]=Hb++);const r=255&i;t.data[n+(r>>5)]|=1<<r}(n,t,e)}function T0(n,t,e){if(e&Rn.Optional)return n;xc(t,"NodeInjector")}function dh(n,t,e,i){if(e&Rn.Optional&&void 0===i&&(i=null),0==(e&(Rn.Self|Rn.Host))){const r=n[9],o=Fl(void 0);try{return r?r.get(t,i,e&Rn.Optional):Ir(t,i,e&Rn.Optional)}finally{Fl(o)}}return T0(i,t,e)}function Sg(n,t,e,i=Rn.Default,r){if(null!==n){const o=function D0(n){if("string"==typeof n)return n.charCodeAt(0)||0;const t=n.hasOwnProperty(Ts)?n[Ts]:void 0;return"number"==typeof t?t>=0?255&t:S0:t}(e);if("function"==typeof o){if(!v0(t,n,i))return i&Rn.Host?T0(r,e,i):dh(t,e,i,r);try{const s=o(i);if(null!=s||i&Rn.Optional)return s;xc(e)}finally{y0()}}else if("number"==typeof o){let s=null,a=Eg(n,t),g=-1,w=i&Rn.Host?t[16][6]:null;for((-1===a||i&Rn.SkipSelf)&&(g=-1===a?uh(n,t):t[a+8],-1!==g&&Ig(i,!1)?(s=t[1],a=Hl(g),t=xa(g,t)):a=-1);-1!==a;){const W=t[1];if(I0(o,a,W.data)){const ve=fh(a,t,e,s,i,w);if(ve!==Dg)return ve}g=t[a+8],-1!==g&&Ig(i,t[1].data[a+8]===w)&&I0(o,a,t)?(s=W,a=Hl(g),t=xa(g,t)):a=-1}}}return dh(t,e,i,r)}const Dg={};function S0(){return new Eu(Zi(),Tt())}function fh(n,t,e,i,r,o){const s=t[1],a=s.data[n+8],W=hh(a,s,e,null==i?Dc(a)&&lh:i!=s&&0!=(3&a.type),r&Rn.Host&&o===a);return null!==W?wu(t,s,W,a):Dg}function hh(n,t,e,i,r){const o=n.providerIndexes,s=t.data,a=1048575&o,g=n.directiveStart,W=o>>20,me=r?a+W:n.directiveEnd;for(let Se=i?a:a+W;Se<me;Se++){const Oe=s[Se];if(Se<g&&e===Oe||Se>=g&&Oe.type===e)return Se}if(r){const Se=s[g];if(Se&&mt(Se)&&Se.type===e)return g}return null}function wu(n,t,e,i){let r=n[e];const o=t.data;if(function C0(n){return n instanceof Hd}(r)){const s=r;s.resolving&&function Id(n,t){const e=t?`. Dependency path: ${t.join(" > ")} > ${n}`:"";throw new jt(-200,`Circular dependency in DI detected for ${n}${e}`)}(Dr(o[e]));const a=ch(s.canSeeViewProviders);s.resolving=!0;const g=s.injectImpl?Fl(s.injectImpl):null;v0(n,i,Rn.Default);try{r=n[e]=s.factory(void 0,o,n,i),t.firstCreatePass&&e>=i.directiveStart&&function Bb(n,t,e){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=t.type.prototype;if(i){const s=rg(t);(e.preOrderHooks||(e.preOrderHooks=[])).push(n,s),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,s)}r&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-n,r),o&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n,o),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,o))}(e,o[e],t)}finally{null!==g&&Fl(g),ch(a),s.resolving=!1,y0()}}return r}function I0(n,t,e){return!!(e[t+(n>>5)]&1<<n)}function Ig(n,t){return!(n&Rn.Self||n&Rn.Host&&t)}class Eu{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,i){return Sg(this._tNode,this._lView,t,i,e)}}function Fr(n){return Cs(()=>{const t=n.prototype.constructor,e=t[di]||ph(t),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const o=r[di]||ph(r);if(o&&o!==e)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function ph(n){return lu(n)?()=>{const t=ph(Dn(n));return t&&t()}:ma(n)}function Nc(n){return function Tg(n,t){if("class"===t)return n.classes;if("style"===t)return n.styles;const e=n.attrs;if(e){const i=e.length;let r=0;for(;r<i;){const o=e[r];if(ao(o))break;if(0===o)r+=2;else if("number"==typeof o)for(r++;r<i&&"string"==typeof e[r];)r++;else{if(o===t)return e[r+1];r+=2}}}return null}(Zi(),n)}const Vl="__parameters__";function wa(n,t,e){return Cs(()=>{const i=function kg(n){return function(...e){if(n){const i=n(...e);for(const r in i)this[r]=i[r]}}}(t);function r(...o){if(this instanceof r)return i.apply(this,o),this;const s=new r(...o);return a.annotation=s,a;function a(g,w,W){const ve=g.hasOwnProperty(Vl)?g[Vl]:Object.defineProperty(g,Vl,{value:[]})[Vl];for(;ve.length<=W;)ve.push(null);return(ve[W]=ve[W]||[]).push(s),g}}return e&&(r.prototype=Object.create(e.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class ei{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=Tn({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return`InjectionToken ${this._desc}`}}function Lo(n,t){void 0===t&&(t=n);for(let e=0;e<n.length;e++){let i=n[e];Array.isArray(i)?(t===n&&(t=n.slice(0,e)),Lo(i,t)):t!==n&&t.push(i)}return t}function Ps(n,t){n.forEach(e=>Array.isArray(e)?Ps(e,t):t(e))}function el(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function gh(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function Fs(n,t){const e=[];for(let i=0;i<n;i++)e.push(t);return e}function zo(n,t,e){let i=Iu(n,t);return i>=0?n[1|i]=e:(i=~i,function Pg(n,t,e,i){let r=n.length;if(r==t)n.push(e,i);else if(1===r)n.push(i,n[0]),n[0]=e;else{for(r--,n.push(n[r-1],n[r]);r>t;)n[r]=n[r-2],r--;n[t]=e,n[t+1]=i}}(n,i,t,e)),i}function _h(n,t){const e=Iu(n,t);if(e>=0)return n[1|e]}function Iu(n,t){return function Fg(n,t,e){let i=0,r=n.length>>e;for(;r!==i;){const o=i+(r-i>>1),s=n[o<<e];if(t===s)return o<<e;s>t?r=o:i=o+1}return~(r<<e)}(n,t,1)}const ku={},Ul="__NG_DI_FLAG__",jl="ngTempTokenPath",O0=/\n/gm,qd="__source",L0=Zn({provide:String,useValue:Zn});let Gl;function vh(n){const t=Gl;return Gl=n,t}function bh(n,t=Rn.Default){if(void 0===Gl)throw new jt(203,"");return null===Gl?Ir(n,void 0,t):Gl.get(n,t&Rn.Optional?null:void 0,t)}function In(n,t=Rn.Default){return(function e0(){return Wp}()||bh)(Dn(n),t)}const yh=In;function Ch(n){const t=[];for(let e=0;e<n.length;e++){const i=Dn(n[e]);if(Array.isArray(i)){if(0===i.length)throw new jt(900,"");let r,o=Rn.Default;for(let s=0;s<i.length;s++){const a=i[s],g=Kb(a);"number"==typeof g?-1===g?r=a.token:o|=g:r=a}t.push(In(r,o))}else t.push(In(i))}return t}function Bc(n,t){return n[Ul]=t,n.prototype[Ul]=t,n}function Kb(n){return n[Ul]}const Wd=Bc(wa("Optional"),8),Zd=Bc(wa("SkipSelf"),4);let Sh,Ih;function Au(n){var t;return(null===(t=function Dh(){if(void 0===Sh&&(Sh=null,wi.trustedTypes))try{Sh=wi.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch(n){}return Sh}())||void 0===t?void 0:t.createHTML(n))||n}function co(n){var t;return(null===(t=function Qs(){if(void 0===Ih&&(Ih=null,wi.trustedTypes))try{Ih=wi.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch(n){}return Ih}())||void 0===t?void 0:t.createHTML(n))||n}class nl{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class ty extends nl{getTypeName(){return"HTML"}}class ny extends nl{getTypeName(){return"Style"}}class Yd extends nl{getTypeName(){return"Script"}}class Z0 extends nl{getTypeName(){return"URL"}}class Y0 extends nl{getTypeName(){return"ResourceURL"}}function ss(n){return n instanceof nl?n.changingThisBreaksApplicationSecurity:n}function Ta(n,t){const e=K0(n);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see https://g.co/ng/security#xss)`)}return e===t}function K0(n){return n instanceof nl&&n.getTypeName()||null}class Kd{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(Au(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch(e){return null}}}class Lg{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const i=this.inertDocument.createElement("body");e.appendChild(i)}}getInertBodyElement(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=Au(t),e;const i=this.inertDocument.createElement("body");return i.innerHTML=Au(t),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(i),i}stripCustomNsAttrs(t){const e=t.attributes;for(let r=e.length-1;0<r;r--){const s=e.item(r).name;("xmlns:ns1"===s||0===s.indexOf("ns1:"))&&t.removeAttribute(s)}let i=t.firstChild;for(;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}const e$=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,t$=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Vo(n){return(n=String(n)).match(e$)||n.match(t$)?n:"unsafe:"+n}function Wl(n){return(n=String(n)).split(",").map(t=>Vo(t.trim())).join(", ")}function Sa(n){const t={};for(const e of n.split(","))t[e]=!0;return t}function Pu(...n){const t={};for(const e of n)for(const i in e)e.hasOwnProperty(i)&&(t[i]=!0);return t}const n$=Sa("area,br,col,hr,img,wbr"),i$=Sa("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),r$=Sa("rp,rt"),Hg=Pu(n$,Pu(i$,Sa("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Pu(r$,Sa("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Pu(r$,i$)),Vg=Sa("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Ug=Sa("srcset"),jg=Pu(Vg,Ug,Sa("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Sa("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),o$=Sa("script,style,template");class s${constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,i=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?i=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,i&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let r=this.checkClobberedElement(e,e.nextSibling);if(r){e=r;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!Hg.hasOwnProperty(e))return this.sanitizedSomething=!0,!o$.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const i=t.attributes;for(let r=0;r<i.length;r++){const o=i.item(r),s=o.name,a=s.toLowerCase();if(!jg.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let g=o.value;Vg[a]&&(g=Vo(g)),Ug[a]&&(g=Wl(g)),this.buf.push(" ",s,'="',a$(g),'"')}return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();Hg.hasOwnProperty(e)&&!n$.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(a$(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const oy=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,sy=/([^\#-~ |!])/g;function a$(n){return n.replace(/&/g,"&amp;").replace(oy,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(sy,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Xd;function l$(n,t){let e=null;try{Xd=Xd||function Bg(n){const t=new Lg(n);return function J0(){try{return!!(new window.DOMParser).parseFromString(Au(""),"text/html")}catch(n){return!1}}()?new Kd(t):t}(n);let i=t?String(t):"";e=Xd.getInertBodyElement(i);let r=5,o=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=o,o=e.innerHTML,e=Xd.getInertBodyElement(i)}while(i!==o);return Au((new s$).sanitizeChildren(Gg(e)||e))}finally{if(e){const i=Gg(e)||e;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function Gg(n){return"content"in n&&function ay(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var ji=(()=>((ji=ji||{})[ji.NONE=0]="NONE",ji[ji.HTML=1]="HTML",ji[ji.STYLE=2]="STYLE",ji[ji.SCRIPT=3]="SCRIPT",ji[ji.URL=4]="URL",ji[ji.RESOURCE_URL=5]="RESOURCE_URL",ji))();function Lc(n){const t=zc();return t?co(t.sanitize(ji.HTML,n)||""):Ta(n,"HTML")?co(ss(n)):l$(lg(),_n(n))}function hn(n){const t=zc();return t?t.sanitize(ji.URL,n)||"":Ta(n,"URL")?ss(n):Vo(_n(n))}function zc(){const n=Tt();return n&&n[12]}const f$="__ngContext__";function uo(n,t){n[f$]=t}function Wg(n){const t=function Qd(n){return n[f$]||null}(n);return t?Array.isArray(t)?t:t.lView:null}function Yg(n){return n.ngOriginalError}function _$(n,...t){n.error(...t)}class Jd{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),i=function Kg(n){return n&&n.ngErrorLogger||_$}(t);i(this._console,"ERROR",t),e&&i(this._console,"ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&Yg(t);for(;e&&Yg(e);)e=Yg(e);return e||null}}const Dy=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(wi))();function Ah(n){return n.ownerDocument}function Da(n){return n instanceof Function?n():n}var as=(()=>((as=as||{})[as.Important=1]="Important",as[as.DashCase=2]="DashCase",as))();function Qg(n,t){return undefined(n,t)}function ef(n){const t=n[3];return qs(t)?t[3]:t}function t_(n){return y$(n[13])}function n_(n){return y$(n[4])}function y$(n){for(;null!==n&&!qs(n);)n=n[4];return n}function il(n,t,e,i,r){if(null!=i){let o,s=!1;qs(i)?o=i:_a(i)&&(s=!0,i=i[0]);const a=ur(i);0===n&&null!==e?null==r?l_(t,e,a):Zl(t,e,a,r||null,!0):1===n&&null!==e?Zl(t,e,a,r||null,!0):2===n?function k$(n,t,e){const i=Fh(n,t);i&&function Ly(n,t,e,i){Yn(n)?n.removeChild(t,e,i):t.removeChild(e)}(n,i,t,e)}(t,a,s):3===n&&t.destroyNode(a),null!=o&&function Hy(n,t,e,i,r){const o=e[7];o!==ur(e)&&il(t,n,i,o,r);for(let a=10;a<e.length;a++){const g=e[a];rf(g[1],g,n,t,i,o)}}(t,n,o,e,r)}}function r_(n,t,e){if(Yn(n))return n.createElement(t,e);{const i=null!==e?function Ib(n){const t=n.toLowerCase();return"svg"===t?"http://www.w3.org/2000/svg":"math"===t?"http://www.w3.org/1998/MathML/":null}(e):null;return null===i?n.createElement(t):n.createElementNS(i,t)}}function x$(n,t){const e=n[9],i=e.indexOf(t),r=t[3];1024&t[2]&&(t[2]&=-1025,ug(r,-1)),e.splice(i,1)}function Ru(n,t){if(n.length<=10)return;const e=10+t,i=n[e];if(i){const r=i[17];null!==r&&r!==n&&x$(r,i),t>0&&(n[e-1][4]=i[4]);const o=gh(n,10+t);!function Py(n,t){rf(n,t,t[11],2,null,null),t[0]=null,t[6]=null}(i[1],i);const s=o[19];null!==s&&s.detachView(o[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function w$(n,t){if(!(256&t[2])){const e=t[11];Yn(e)&&e.destroyNode&&rf(n,t,e,3,null,null),function Ny(n){let t=n[13];if(!t)return Ph(n[1],n);for(;t;){let e=null;if(_a(t))e=t[13];else{const i=t[10];i&&(e=i)}if(!e){for(;t&&!t[4]&&t!==n;)_a(t)&&Ph(t[1],t),t=t[3];null===t&&(t=n),_a(t)&&Ph(t[1],t),e=t&&t[4]}t=e}}(t)}}function Ph(n,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function o_(n,t){let e;if(null!=n&&null!=(e=n.destroyHooks))for(let i=0;i<e.length;i+=2){const r=t[e[i]];if(!(r instanceof Hd)){const o=e[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){const a=r[o[s]],g=o[s+1];try{g.call(a)}finally{}}else try{o.call(r)}finally{}}}}(n,t),function E$(n,t){const e=n.cleanup,i=t[7];let r=-1;if(null!==e)for(let o=0;o<e.length-1;o+=2)if("string"==typeof e[o]){const s=e[o+1],a="function"==typeof s?s(t):ur(t[s]),g=i[r=e[o+2]],w=e[o+3];"boolean"==typeof w?a.removeEventListener(e[o],g,w):w>=0?i[r=w]():i[r=-w].unsubscribe(),o+=2}else{const s=i[r=e[o+1]];e[o].call(s)}if(null!==i){for(let o=r+1;o<i.length;o++)i[o]();t[7]=null}}(n,t),1===t[1].type&&Yn(t[11])&&t[11].destroy();const e=t[17];if(null!==e&&qs(t[3])){e!==t[3]&&x$(e,t);const i=t[19];null!==i&&i.detachView(n)}}}function s_(n,t,e){return function a_(n,t,e){let i=t;for(;null!==i&&40&i.type;)i=(t=i).parent;if(null===i)return e[0];if(2&i.flags){const r=n.data[i.directiveStart].encapsulation;if(r===ws.None||r===ws.Emulated)return null}return Bo(i,e)}(n,t.parent,e)}function Zl(n,t,e,i,r){Yn(n)?n.insertBefore(t,e,i,r):t.insertBefore(e,i,r)}function l_(n,t,e){Yn(n)?n.appendChild(t,e):t.appendChild(e)}function T$(n,t,e,i,r){null!==i?Zl(n,t,e,i,r):l_(n,t,e)}function Fh(n,t){return Yn(n)?n.parentNode(t):t.parentNode}function tf(n,t,e){return D$(n,t,e)}let D$=function S$(n,t,e){return 40&n.type?Bo(n,e):null};function Nh(n,t,e,i){const r=s_(n,i,t),o=t[11],a=tf(i.parent||t[6],i,t);if(null!=r)if(Array.isArray(e))for(let g=0;g<e.length;g++)T$(o,r,e[g],a,!1);else T$(o,r,e,a,!1)}function Oh(n,t){if(null!==t){const e=t.type;if(3&e)return Bo(t,n);if(4&e)return u_(-1,n[t.index]);if(8&e){const i=t.child;if(null!==i)return Oh(n,i);{const r=n[t.index];return qs(r)?u_(-1,r):ur(r)}}if(32&e)return Qg(t,n)()||ur(n[t.index]);{const i=I$(n,t);return null!==i?Array.isArray(i)?i[0]:Oh(ef(n[16]),i):Oh(n,t.next)}}return null}function I$(n,t){return null!==t?n[16][6].projection[t.projection]:null}function u_(n,t){const e=10+n+1;if(e<t.length){const i=t[e],r=i[1].firstChild;if(null!==r)return Oh(i,r)}return t[7]}function d_(n,t,e,i,r,o,s){for(;null!=e;){const a=i[e.index],g=e.type;if(s&&0===t&&(a&&uo(ur(a),i),e.flags|=4),64!=(64&e.flags))if(8&g)d_(n,t,e.child,i,r,o,!1),il(t,n,r,a,o);else if(32&g){const w=Qg(e,i);let W;for(;W=w();)il(t,n,r,W,o);il(t,n,r,a,o)}else 16&g?M$(n,t,i,e,r,o):il(t,n,r,a,o);e=s?e.projectionNext:e.next}}function rf(n,t,e,i,r,o){d_(e,i,n.firstChild,t,r,o,!1)}function M$(n,t,e,i,r,o){const s=e[16],g=s[6].projection[i.projection];if(Array.isArray(g))for(let w=0;w<g.length;w++)il(t,n,r,g[w],o);else d_(n,t,g,s[3],r,o,!0)}function A$(n,t,e){Yn(n)?n.setAttribute(t,"style",e):t.style.cssText=e}function ls(n,t,e){Yn(n)?""===e?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e):t.className=e}function P$(n,t,e){let i=n.length;for(;;){const r=n.indexOf(t,e);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const o=t.length;if(r+o===i||n.charCodeAt(r+o)<=32)return r}e=r+1}}const Yl="ng-template";function On(n,t,e){let i=0;for(;i<n.length;){let r=n[i++];if(e&&"class"===r){if(r=n[i],-1!==P$(r.toLowerCase(),t,0))return!0}else if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===t)return!0;return!1}}return!1}function F$(n){return 4===n.type&&n.value!==Yl}function Uo(n,t,e){return t===(4!==n.type||e?n.value:Yl)}function dr(n,t,e){let i=4;const r=n.attrs||[],o=function jy(n){for(let t=0;t<n.length;t++)if(ao(n[t]))return t;return n.length}(r);let s=!1;for(let a=0;a<t.length;a++){const g=t[a];if("number"!=typeof g){if(!s)if(4&i){if(i=2|1&i,""!==g&&!Uo(n,g,e)||""===g&&1===t.length){if(Js(i))return!1;s=!0}}else{const w=8&i?g:t[++a];if(8&i&&null!==n.attrs){if(!On(n.attrs,w,e)){if(Js(i))return!1;s=!0}continue}const ve=Kl(8&i?"class":g,r,F$(n),e);if(-1===ve){if(Js(i))return!1;s=!0;continue}if(""!==w){let me;me=ve>o?"":r[ve+1].toLowerCase();const Se=8&i?me:null;if(Se&&-1!==P$(Se,w,0)||2&i&&w!==me){if(Js(i))return!1;s=!0}}}}else{if(!s&&!Js(i)&&!Js(g))return!1;if(s&&Js(g))continue;s=!1,i=g|1&i}}return Js(i)||s}function Js(n){return 0==(1&n)}function Kl(n,t,e,i){if(null===t)return-1;let r=0;if(i||!e){let o=!1;for(;r<t.length;){const s=t[r];if(s===n)return r;if(3===s||6===s)o=!0;else{if(1===s||2===s){let a=t[++r];for(;"string"==typeof a;)a=t[++r];continue}if(4===s)break;if(0===s){r+=4;continue}}r+=o?1:2}return-1}return function Gy(n,t){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){const i=n[e];if("number"==typeof i)return-1;if(i===t)return e;e++}return-1}(t,n)}function R$(n,t,e=!1){for(let i=0;i<t.length;i++)if(dr(n,t[i],e))return!0;return!1}function qy(n,t){e:for(let e=0;e<t.length;e++){const i=t[e];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function Bh(n,t){return n?":not("+t.trim()+")":t}function Wy(n){let t=n[0],e=1,i=2,r="",o=!1;for(;e<n.length;){let s=n[e];if("string"==typeof s)if(2&i){const a=n[++e];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+s:4&i&&(r+=" "+s);else""!==r&&!Js(s)&&(t+=Bh(o,r),r=""),i=s,o=o||!Js(i);e++}return""!==r&&(t+=Bh(o,r)),t}const kn={};function j(n){nr(ii(),Tt(),Pr()+n,nh())}function nr(n,t,e,i){if(!i)if(3==(3&t[2])){const o=n.preOrderCheckHooks;null!==o&&zd(t,o,e)}else{const o=n.preOrderHooks;null!==o&&zl(t,o,0,e)}Ll(e)}function Lh(n,t){return n<<17|t<<2}function ea(n){return n>>17&32767}function h_(n){return 2|n}function ol(n){return(131068&n)>>2}function zh(n,t){return-131069&n|t<<2}function of(n){return 1|n}function V$(n,t){const e=n.contentQueries;if(null!==e)for(let i=0;i<e.length;i+=2){const r=e[i],o=e[i+1];if(-1!==o){const s=n.data[o];gg(r),s.contentQueries(2,t[o],o)}}}function sf(n,t,e,i,r,o,s,a,g,w){const W=t.blueprint.slice();return W[0]=r,W[2]=140|i,g0(W),W[3]=W[15]=n,W[8]=e,W[10]=s||n&&n[10],W[11]=a||n&&n[11],W[12]=g||n&&n[12]||null,W[9]=w||n&&n[9]||null,W[6]=o,W[16]=2==t.type?n[16]:W,W}function Bu(n,t,e,i,r){let o=n.data[t];if(null===o)o=function Uh(n,t,e,i,r){const o=m0(),s=dg(),g=n.data[t]=function K$(n,t,e,i,r,o){return{type:e,index:i,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,e,t,i,r);return null===n.firstChild&&(n.firstChild=g),null!==o&&(s?null==o.child&&null!==g.parent&&(o.child=g):null===o.next&&(o.next=g)),g}(n,t,e,i,r),function Rb(){return wn.lFrame.inI18n}()&&(o.flags|=64);else if(64&o.type){o.type=e,o.value=i,o.attrs=r;const s=function Od(){const n=wn.lFrame,t=n.currentTNode;return n.isParent?t:t.parent}();o.injectorIndex=null===s?-1:s.injectorIndex}return va(o,!0),o}function Lu(n,t,e,i){if(0===e)return-1;const r=t.length;for(let o=0;o<e;o++)t.push(i),n.blueprint.push(i),n.data.push(null);return r}function af(n,t,e){rh(t);try{const i=n.viewQuery;null!==i&&cf(1,i,e);const r=n.template;null!==r&&w_(n,t,r,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&V$(n,t),n.staticViewQueries&&cf(2,n.viewQuery,e);const o=n.components;null!==o&&function Jy(n,t){for(let e=0;e<t.length;e++)_C(n,t[e])}(t,o)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{t[2]&=-5,oh()}}function zu(n,t,e,i){const r=t[2];if(256==(256&r))return;rh(t);const o=nh();try{g0(t),function ba(n){return wn.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==e&&w_(n,t,e,2,i);const s=3==(3&r);if(!o)if(s){const w=n.preOrderCheckHooks;null!==w&&zd(t,w,null)}else{const w=n.preOrderHooks;null!==w&&zl(t,w,0,null),ya(t,0)}if(function gC(n){for(let t=t_(n);null!==t;t=n_(t)){if(!t[2])continue;const e=t[9];for(let i=0;i<e.length;i++){const r=e[i],o=r[3];0==(1024&r[2])&&ug(o,1),r[2]|=1024}}}(t),function pC(n){for(let t=t_(n);null!==t;t=n_(t))for(let e=10;e<t.length;e++){const i=t[e],r=i[1];cg(i)&&zu(r,i,r.template,i[8])}}(t),null!==n.contentQueries&&V$(n,t),!o)if(s){const w=n.contentCheckHooks;null!==w&&zd(t,w)}else{const w=n.contentHooks;null!==w&&zl(t,w,1),ya(t,1)}!function Qy(n,t){const e=n.hostBindingOpCodes;if(null!==e)try{for(let i=0;i<e.length;i++){const r=e[i];if(r<0)Ll(~r);else{const o=r,s=e[++i],a=e[++i];Nb(s,o),a(2,t[o])}}}finally{Ll(-1)}}(n,t);const a=n.components;null!==a&&function U$(n,t){for(let e=0;e<t.length;e++)M_(n,t[e])}(t,a);const g=n.viewQuery;if(null!==g&&cf(2,g,i),!o)if(s){const w=n.viewCheckHooks;null!==w&&zd(t,w)}else{const w=n.viewHooks;null!==w&&zl(t,w,2),ya(t,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),o||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,ug(t[3],-1))}finally{oh()}}function j$(n,t,e,i){const r=t[10],o=!nh(),s=Ac(t);try{o&&!s&&r.begin&&r.begin(),s&&af(n,t,i),zu(n,t,e,i)}finally{o&&!s&&r.end&&r.end()}}function w_(n,t,e,i,r){const o=Pr(),s=2&i;try{Ll(-1),s&&t.length>20&&nr(n,t,20,nh()),e(i,r)}finally{Ll(o)}}function G$(n,t,e){if(Xp(t)){const r=t.directiveEnd;for(let o=t.directiveStart;o<r;o++){const s=n.data[o];s.contentQueries&&s.contentQueries(1,e[o],o)}}}function E_(n,t,e){!Nd()||(function aC(n,t,e,i){const r=e.directiveStart,o=e.directiveEnd;n.firstCreatePass||xu(e,t),uo(i,t);const s=e.initialInputs;for(let a=r;a<o;a++){const g=n.data[a],w=mt(g);w&&fC(t,e,g);const W=wu(t,n,a,e);uo(W,t),null!==s&&k_(0,a-r,W,g,0,s),w&&(so(e.index,t)[8]=W)}}(n,t,e,Bo(e,t)),128==(128&e.flags)&&function lC(n,t,e){const i=e.directiveStart,r=e.directiveEnd,s=e.index,a=function Pc(){return wn.lFrame.currentDirectiveIndex}();try{Ll(s);for(let g=i;g<r;g++){const w=n.data[g],W=t[g];hg(g),(null!==w.hostBindings||0!==w.hostVars||null!==w.hostAttrs)&&J$(w,W)}}finally{Ll(-1),hg(a)}}(n,t,e))}function T_(n,t,e=Bo){const i=t.localNames;if(null!==i){let r=t.index+1;for(let o=0;o<i.length;o+=2){const s=i[o+1],a=-1===s?e(t,n):n[s];n[r++]=a}}}function q$(n){const t=n.tView;return null===t||t.incompleteFirstPass?n.tView=ll(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):t}function ll(n,t,e,i,r,o,s,a,g,w){const W=20+i,ve=W+r,me=function eC(n,t){const e=[];for(let i=0;i<t;i++)e.push(i<n?null:kn);return e}(W,ve),Se="function"==typeof w?w():w;return me[1]={type:n,blueprint:me,template:e,queries:null,viewQuery:a,declTNode:t,data:me.slice().fill(null,W),bindingStartIndex:W,expandoStartIndex:ve,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:g,consts:Se,incompleteFirstPass:!1}}function Y$(n,t,e,i){const r=s1(t);null===e?r.push(i):(r.push(e),n.firstCreatePass&&a1(n).push(i,r.length-1))}function S_(n,t,e){for(let i in n)if(n.hasOwnProperty(i)){const r=n[i];(e=null===e?{}:e).hasOwnProperty(i)?e[i].push(t,r):e[i]=[t,r]}return e}function cs(n,t,e,i,r,o,s,a){const g=Bo(t,e);let W,w=t.inputs;!a&&null!=w&&(W=w[i])?(c1(n,e,W,i,r),Dc(t)&&function iC(n,t){const e=so(t,n);16&e[2]||(e[2]|=64)}(e,t.index)):3&t.type&&(i=function nC(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=s?s(r,t.value||"",i):r,Yn(o)?o.setProperty(g,i,r):Ud(i)||(g.setProperty?g.setProperty(i,r):g[i]=r))}function D_(n,t,e,i){let r=!1;if(Nd()){const o=function cC(n,t,e){const i=n.directiveRegistry;let r=null;if(i)for(let o=0;o<i.length;o++){const s=i[o];R$(e,s.selectors,!1)&&(r||(r=[]),jd(xu(e,t),n,s.type),mt(s)?(e1(n,e),r.unshift(s)):r.push(s))}return r}(n,t,e),s=null===i?null:{"":-1};if(null!==o){r=!0,t1(e,n.data.length,o.length);for(let W=0;W<o.length;W++){const ve=o[W];ve.providersResolver&&ve.providersResolver(ve)}let a=!1,g=!1,w=Lu(n,t,o.length,null);for(let W=0;W<o.length;W++){const ve=o[W];e.mergedAttrs=ah(e.mergedAttrs,ve.hostAttrs),n1(n,e,t,w,ve),dC(w,ve,s),null!==ve.contentQueries&&(e.flags|=8),(null!==ve.hostBindings||null!==ve.hostAttrs||0!==ve.hostVars)&&(e.flags|=128);const me=ve.type.prototype;!a&&(me.ngOnChanges||me.ngOnInit||me.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e.index),a=!0),!g&&(me.ngOnChanges||me.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e.index),g=!0),w++}!function tC(n,t){const i=t.directiveEnd,r=n.data,o=t.attrs,s=[];let a=null,g=null;for(let w=t.directiveStart;w<i;w++){const W=r[w],ve=W.inputs,me=null===o||F$(t)?null:i1(ve,o);s.push(me),a=S_(ve,w,a),g=S_(W.outputs,w,g)}null!==a&&(a.hasOwnProperty("class")&&(t.flags|=16),a.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=s,t.inputs=a,t.outputs=g}(n,e)}s&&function uC(n,t,e){if(t){const i=n.localNames=[];for(let r=0;r<t.length;r+=2){const o=e[t[r+1]];if(null==o)throw new jt(-301,!1);i.push(t[r],o)}}}(e,i,s)}return e.mergedAttrs=ah(e.mergedAttrs,e.attrs),r}function Q$(n,t,e,i,r,o){const s=o.hostBindings;if(s){let a=n.hostBindingOpCodes;null===a&&(a=n.hostBindingOpCodes=[]);const g=~t.index;(function sC(n){let t=n.length;for(;t>0;){const e=n[--t];if("number"==typeof e&&e<0)return e}return 0})(a)!=g&&a.push(g),a.push(i,r,s)}}function J$(n,t){null!==n.hostBindings&&n.hostBindings(1,t)}function e1(n,t){t.flags|=2,(n.components||(n.components=[])).push(t.index)}function dC(n,t,e){if(e){if(t.exportAs)for(let i=0;i<t.exportAs.length;i++)e[t.exportAs[i]]=n;mt(t)&&(e[""]=n)}}function t1(n,t,e){n.flags|=1,n.directiveStart=t,n.directiveEnd=t+e,n.providerIndexes=t}function n1(n,t,e,i,r){n.data[i]=r;const o=r.factory||(r.factory=ma(r.type)),s=new Hd(o,mt(r),null);n.blueprint[i]=s,e[i]=s,Q$(n,t,0,i,Lu(n,e,r.hostVars,kn),r)}function fC(n,t,e){const i=Bo(t,n),r=q$(e),o=n[10],s=Wr(n,sf(n,r,null,e.onPush?64:16,i,t,o,o.createRenderer(i,e),null,null));n[t.index]=s}function Ia(n,t,e,i,r,o){const s=Bo(n,t);!function I_(n,t,e,i,r,o,s){if(null==o)Yn(n)?n.removeAttribute(t,r,e):t.removeAttribute(r);else{const a=null==s?_n(o):s(o,i||"",r);Yn(n)?n.setAttribute(t,r,a,e):e?t.setAttributeNS(e,r,a):t.setAttribute(r,a)}}(t[11],s,o,n.value,e,i,r)}function k_(n,t,e,i,r,o){const s=o[t];if(null!==s){const a=i.setInput;for(let g=0;g<s.length;){const w=s[g++],W=s[g++],ve=s[g++];null!==a?i.setInput(e,ve,w,W):e[W]=ve}}}function i1(n,t){let e=null,i=0;for(;i<t.length;){const r=t[i];if(0!==r)if(5!==r){if("number"==typeof r)break;n.hasOwnProperty(r)&&(null===e&&(e=[]),e.push(r,n[r],t[i+1])),i+=2}else i+=2;else i+=4}return e}function r1(n,t,e,i){return new Array(n,!0,!1,t,null,0,i,e,null,null)}function M_(n,t){const e=so(t,n);if(cg(e)){const i=e[1];80&e[2]?zu(i,e,i.template,e[8]):e[5]>0&&A_(e)}}function A_(n){for(let i=t_(n);null!==i;i=n_(i))for(let r=10;r<i.length;r++){const o=i[r];if(1024&o[2]){const s=o[1];zu(s,o,s.template,o[8])}else o[5]>0&&A_(o)}const e=n[1].components;if(null!==e)for(let i=0;i<e.length;i++){const r=so(e[i],n);cg(r)&&r[5]>0&&A_(r)}}function _C(n,t){const e=so(t,n),i=e[1];(function mC(n,t){for(let e=t.length;e<n.blueprint.length;e++)t.push(n.blueprint[e])})(i,e),af(i,e,e[8])}function Wr(n,t){return n[13]?n[14][4]=t:n[13]=t,n[14]=t,t}function lf(n){for(;n;){n[2]|=64;const t=ef(n);if(gt(n)&&!t)return n;n=t}return null}function F_(n,t,e){const i=t[10];i.begin&&i.begin();try{zu(n,t,n.template,e)}catch(r){throw l1(t,r),r}finally{i.end&&i.end()}}function o1(n){!function P_(n){for(let t=0;t<n.components.length;t++){const e=n.components[t],i=Wg(e),r=i[1];j$(r,i,r.template,e)}}(n[8])}function cf(n,t,e){gg(0),t(n,e)}const bC=(()=>Promise.resolve(null))();function s1(n){return n[7]||(n[7]=[])}function a1(n){return n.cleanup||(n.cleanup=[])}function l1(n,t){const e=n[9],i=e?e.get(Jd,null):null;i&&i.handleError(t)}function c1(n,t,e,i,r){for(let o=0;o<e.length;){const s=e[o++],a=e[o++],g=t[s],w=n.data[s];null!==w.setInput?w.setInput(g,r,i,a):g[a]=r}}function cl(n,t,e){const i=Nl(t,n);!function C$(n,t,e){Yn(n)?n.setValue(t,e):t.textContent=e}(n[11],i,e)}function Hu(n,t,e){let i=e?n.styles:null,r=e?n.classes:null,o=0;if(null!==t)for(let s=0;s<t.length;s++){const a=t[s];"number"==typeof a?o=a:1==o?r=Za(r,a):2==o&&(i=Za(i,a+": "+t[++s]+";"))}e?n.styles=i:n.stylesWithoutHost=i,e?n.classes=r:n.classesWithoutHost=r}const B_=new ei("INJECTOR",-1);class u1{get(t,e=ku){if(e===ku){const i=new Error(`NullInjectorError: No provider for ${ui(t)}!`);throw i.name="NullInjectorError",i}return e}}const L_=new ei("Set Injector scope."),uf={},CC={};let z_;function d1(){return void 0===z_&&(z_=new u1),z_}function f1(n,t=null,e=null,i){const r=h1(n,t,e,i);return r._resolveInjectorDefTypes(),r}function h1(n,t=null,e=null,i){return new xC(n,e,t||d1(),i)}class xC{constructor(t,e,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const o=[];e&&Ps(e,a=>this.processProvider(a,t,e)),Ps([t],a=>this.processInjectorType(a,[],o)),this.records.set(B_,Vu(void 0,this));const s=this.records.get(L_);this.scope=null!=s?s.value:null,this.source=r||("object"==typeof t?null:ui(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,e=ku,i=Rn.Default){this.assertNotDestroyed();const r=vh(this),o=Fl(void 0);try{if(!(i&Rn.SkipSelf)){let a=this.records.get(t);if(void 0===a){const g=function Ie(n){return"function"==typeof n||"object"==typeof n&&n instanceof ei}(t)&&Gp(t);a=g&&this.injectableDefInScope(g)?Vu(H_(t),uf):null,this.records.set(t,a)}if(null!=a)return this.hydrate(t,a)}return(i&Rn.Self?d1():this.parent).get(t,e=i&Rn.Optional&&e===ku?null:e)}catch(s){if("NullInjectorError"===s.name){if((s[jl]=s[jl]||[]).unshift(ui(t)),r)throw s;return function z0(n,t,e,i){const r=n[jl];throw t[qd]&&r.unshift(t[qd]),n.message=function tl(n,t,e,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let r=ui(t);if(Array.isArray(t))r=t.map(ui).join(" -> ");else if("object"==typeof t){let o=[];for(let s in t)if(t.hasOwnProperty(s)){let a=t[s];o.push(s+":"+("string"==typeof a?JSON.stringify(a):ui(a)))}r=`{${o.join(", ")}}`}return`${e}${i?"("+i+")":""}[${r}]: ${n.replace(O0,"\n  ")}`}("\n"+n.message,r,e,i),n.ngTokenPath=r,n[jl]=null,n}(s,t,"R3InjectorError",this.source)}throw s}finally{Fl(o),vh(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((i,r)=>t.push(ui(r))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new jt(205,!1)}processInjectorType(t,e,i){if(!(t=Dn(t)))return!1;let r=Ni(t);const o=null==r&&t.ngModule||void 0,s=void 0===o?t:o,a=-1!==i.indexOf(s);if(void 0!==o&&(r=Ni(o)),null==r)return!1;if(null!=r.imports&&!a){let W;i.push(s);try{Ps(r.imports,ve=>{this.processInjectorType(ve,e,i)&&(void 0===W&&(W=[]),W.push(ve))})}finally{}if(void 0!==W)for(let ve=0;ve<W.length;ve++){const{ngModule:me,providers:Se}=W[ve];Ps(Se,Oe=>this.processProvider(Oe,me,Se||Oi))}}this.injectorDefTypes.add(s);const g=ma(s)||(()=>new s);this.records.set(s,Vu(g,uf));const w=r.providers;if(null!=w&&!a){const W=t;Ps(w,ve=>this.processProvider(ve,W,w))}return void 0!==o&&void 0!==t.providers}processProvider(t,e,i){let r=Uu(t=Dn(t))?t:Dn(t&&t.provide);const o=function EC(n,t,e){return g1(n)?Vu(void 0,n.useValue):Vu(p1(n),uf)}(t);if(Uu(t)||!0!==t.multi)this.records.get(r);else{let s=this.records.get(r);s||(s=Vu(void 0,uf,!0),s.factory=()=>Ch(s.multi),this.records.set(r,s)),r=t,s.multi.push(t)}this.records.set(r,o)}hydrate(t,e){return e.value===uf&&(e.value=CC,e.value=e.factory()),"object"==typeof e.value&&e.value&&function ue(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(e.value)&&this.onDestroy.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=Dn(t.providedIn);return"string"==typeof e?"any"===e||e===this.scope:this.injectorDefTypes.has(e)}}function H_(n){const t=Gp(n),e=null!==t?t.factory:ma(n);if(null!==e)return e;if(n instanceof ei)throw new jt(204,!1);if(n instanceof Function)return function wC(n){const t=n.length;if(t>0)throw Fs(t,"?"),new jt(204,!1);const e=function yb(n){const t=n&&(n[Wf]||n[Jm]);if(t){const e=function Wi(n){if(n.hasOwnProperty("name"))return n.name;const t=(""+n).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),t}return null}(n);return null!==e?()=>e.factory(n):()=>new n}(n);throw new jt(204,!1)}function p1(n,t,e){let i;if(Uu(n)){const r=Dn(n);return ma(r)||H_(r)}if(g1(n))i=()=>Dn(n.useValue);else if(function SC(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Ch(n.deps||[]));else if(function TC(n){return!(!n||!n.useExisting)}(n))i=()=>In(Dn(n.useExisting));else{const r=Dn(n&&(n.useClass||n.provide));if(!function y(n){return!!n.deps}(n))return ma(r)||H_(r);i=()=>new r(...Ch(n.deps))}return i}function Vu(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function g1(n){return null!==n&&"object"==typeof n&&L0 in n}function Uu(n){return"function"==typeof n}let Ne=(()=>{class n{static create(e,i){var r;if(Array.isArray(e))return f1({name:""},i,e,"");{const o=null!==(r=e.name)&&void 0!==r?r:"";return f1({name:o},e.parent,e.providers,o)}}}return n.THROW_IF_NOT_FOUND=ku,n.NULL=new u1,n.\u0275prov=Tn({token:n,providedIn:"any",factory:()=>In(B_)}),n.__NG_ELEMENT_ID__=-1,n})();function lF(n,t){Ld(Wg(n)[1],Zi())}function Li(n){let t=function qE(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),e=!0;const i=[n];for(;t;){let r;if(mt(n))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new jt(903,"");r=t.\u0275dir}if(r){if(e){i.push(r);const s=n;s.inputs=IC(n.inputs),s.declaredInputs=IC(n.declaredInputs),s.outputs=IC(n.outputs);const a=r.hostBindings;a&&fF(n,a);const g=r.viewQuery,w=r.contentQueries;if(g&&uF(n,g),w&&dF(n,w),au(n.inputs,r.inputs),au(n.declaredInputs,r.declaredInputs),au(n.outputs,r.outputs),mt(r)&&r.data.animation){const W=n.data;W.animation=(W.animation||[]).concat(r.data.animation)}}const o=r.features;if(o)for(let s=0;s<o.length;s++){const a=o[s];a&&a.ngInherit&&a(n),a===Li&&(e=!1)}}t=Object.getPrototypeOf(t)}!function cF(n){let t=0,e=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=t+=r.hostVars,r.hostAttrs=ah(r.hostAttrs,e=ah(e,r.hostAttrs))}}(i)}function IC(n){return n===Ur?{}:n===Oi?[]:n}function uF(n,t){const e=n.viewQuery;n.viewQuery=e?(i,r)=>{t(i,r),e(i,r)}:t}function dF(n,t){const e=n.contentQueries;n.contentQueries=e?(i,r,o)=>{t(i,r,o),e(i,r,o)}:t}function fF(n,t){const e=n.hostBindings;n.hostBindings=e?(i,r)=>{t(i,r),e(i,r)}:t}let _1=null;function jh(){if(!_1){const n=wi.Symbol;if(n&&n.iterator)_1=n.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const i=t[e];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(_1=i)}}}return _1}function V_(n){return!!kC(n)&&(Array.isArray(n)||!(n instanceof Map)&&jh()in n)}function kC(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function Jl(n,t,e){return n[t]=e}function qo(n,t,e){return!Object.is(n[t],e)&&(n[t]=e,!0)}function df(n,t,e,i){const r=qo(n,t,e);return qo(n,t+1,i)||r}function m1(n,t,e,i,r){const o=df(n,t,e,i);return qo(n,t+2,r)||o}function Yt(n,t,e,i){const r=Tt();return qo(r,vu(),t)&&(ii(),Ia(tr(),r,n,t,e,i)),Yt}function qh(n,t,e,i){return qo(n,vu(),e)?t+_n(e)+i:kn}function Wh(n,t,e,i,r,o){const a=df(n,Xa(),e,r);return Qa(2),a?t+_n(e)+i+_n(r)+o:kn}function Ee(n,t,e,i,r,o,s,a){const g=Tt(),w=ii(),W=n+20,ve=w.firstCreatePass?function vF(n,t,e,i,r,o,s,a,g){const w=t.consts,W=Bu(t,n,4,s||null,Ol(w,a));D_(t,e,W,Ol(w,g)),Ld(t,W);const ve=W.tViews=ll(2,W,i,r,o,t.directiveRegistry,t.pipeRegistry,null,t.schemas,w);return null!==t.queries&&(t.queries.template(t,W),ve.queries=t.queries.embeddedTView(W)),W}(W,w,g,t,e,i,r,o,s):w.data[W];va(ve,!1);const me=g[11].createComment("");Nh(w,g,me,ve),uo(me,g),Wr(g,g[W]=r1(me,g,me,ve)),at(ve)&&E_(w,g,ve),null!=s&&T_(g,ve,a)}function ln(n){return $a(function Fb(){return wn.lFrame.contextLView}(),20+n)}function Be(n,t=Rn.Default){const e=Tt();return null===e?In(n,t):Sg(Zi(),e,Dn(n),t)}function ie(n,t,e){const i=Tt();return qo(i,vu(),t)&&cs(ii(),tr(),i,n,t,i[11],e,!1),ie}function RC(n,t,e,i,r){const s=r?"class":"style";c1(n,e,t.inputs[s],s,i)}function J(n,t,e,i){const r=Tt(),o=ii(),s=20+n,a=r[11],g=r[s]=r_(a,t,function ks(){return wn.lFrame.currentNamespace}()),w=o.firstCreatePass?function HF(n,t,e,i,r,o,s){const a=t.consts,w=Bu(t,n,2,r,Ol(a,o));return D_(t,e,w,Ol(a,s)),null!==w.attrs&&Hu(w,w.attrs,!1),null!==w.mergedAttrs&&Hu(w,w.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,w),w}(s,o,r,0,t,e,i):o.data[s];va(w,!0);const W=w.mergedAttrs;null!==W&&Vd(a,g,W);const ve=w.classes;null!==ve&&ls(a,g,ve);const me=w.styles;return null!==me&&A$(a,g,me),64!=(64&w.flags)&&Nh(o,r,g,w),0===function _0(){return wn.lFrame.elementDepthCount}()&&uo(g,r),function He(){wn.lFrame.elementDepthCount++}(),at(w)&&(E_(o,r,w),G$(o,w,r)),null!==i&&T_(r,w),J}function oe(){let n=Zi();dg()?fg():(n=n.parent,va(n,!1));const t=n;!function $u(){wn.lFrame.elementDepthCount--}();const e=ii();return e.firstCreatePass&&(Ld(e,n),Xp(n)&&e.queries.elementEnd(n)),null!=t.classesWithoutHost&&function Ca(n){return 0!=(16&n.flags)}(t)&&RC(e,t,Tt(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function yg(n){return 0!=(32&n.flags)}(t)&&RC(e,t,Tt(),t.stylesWithoutHost,!1),oe}function it(n,t,e,i){return J(n,t,e,i),oe(),it}function Je(n,t,e){const i=Tt(),r=ii(),o=n+20,s=r.firstCreatePass?function VF(n,t,e,i,r){const o=t.consts,s=Ol(o,i),a=Bu(t,n,8,"ng-container",s);return null!==s&&Hu(a,s,!0),D_(t,e,a,Ol(o,r)),null!==t.queries&&t.queries.elementStart(t,a),a}(o,r,i,t,e):r.data[o];va(s,!0);const a=i[o]=i[11].createComment("");return Nh(r,i,a,s),uo(a,i),at(s)&&(E_(r,i,s),G$(r,s,i)),null!=e&&T_(i,s),Je}function et(){let n=Zi();const t=ii();return dg()?fg():(n=n.parent,va(n,!1)),t.firstCreatePass&&(Ld(t,n),Xp(n)&&t.queries.elementEnd(n)),et}function pn(n,t,e){return Je(n,t,e),et(),pn}function pt(){return Tt()}function v1(n){return!!n&&"function"==typeof n.then}const hT=function fT(n){return!!n&&"function"==typeof n.subscribe};function Re(n,t,e,i){const r=Tt(),o=ii(),s=Zi();return function gT(n,t,e,i,r,o,s,a){const g=at(i),W=n.firstCreatePass&&a1(n),ve=t[8],me=s1(t);let Se=!0;if(3&i.type||a){const We=Bo(i,t),Ze=a?a(We):We,je=me.length,ut=a?ot=>a(ur(ot[i.index])):i.index;if(Yn(e)){let ot=null;if(!a&&g&&(ot=function UF(n,t,e,i){const r=n.cleanup;if(null!=r)for(let o=0;o<r.length-1;o+=2){const s=r[o];if(s===e&&r[o+1]===i){const a=t[7],g=r[o+2];return a.length>g?a[g]:null}"string"==typeof s&&(o+=2)}return null}(n,t,r,i.index)),null!==ot)(ot.__ngLastListenerFn__||ot).__ngNextListenerFn__=o,ot.__ngLastListenerFn__=o,Se=!1;else{o=NC(i,t,ve,o,!1);const ft=e.listen(Ze,r,o);me.push(o,ft),W&&W.push(r,ut,je,je+1)}}else o=NC(i,t,ve,o,!0),Ze.addEventListener(r,o,s),me.push(o),W&&W.push(r,ut,je,s)}else o=NC(i,t,ve,o,!1);const Oe=i.outputs;let Ve;if(Se&&null!==Oe&&(Ve=Oe[r])){const We=Ve.length;if(We)for(let Ze=0;Ze<We;Ze+=2){const Ot=t[Ve[Ze]][Ve[Ze+1]].subscribe(o),Et=me.length;me.push(o,Ot),W&&W.push(r,i.index,Et,-(Et+1))}}}(o,r,r[11],s,n,t,!!e,i),Re}function _T(n,t,e,i){try{return!1!==e(i)}catch(r){return l1(n,r),!1}}function NC(n,t,e,i,r){return function o(s){if(s===Function)return i;const a=2&n.flags?so(n.index,t):t;0==(32&t[2])&&lf(a);let g=_T(t,0,i,s),w=o.__ngNextListenerFn__;for(;w;)g=_T(t,0,w,s)&&g,w=w.__ngNextListenerFn__;return r&&!1===g&&(s.preventDefault(),s.returnValue=!1),g}}function $e(n=1){return function $g(n){return(wn.lFrame.contextLView=function Bd(n,t){for(;n>0;)t=t[15],n--;return t}(n,wn.lFrame.contextLView))[8]}(n)}function jF(n,t){let e=null;const i=function Uy(n){const t=n.attrs;if(null!=t){const e=t.indexOf(5);if(0==(1&e))return t[e+1]}return null}(n);for(let r=0;r<t.length;r++){const o=t[r];if("*"!==o){if(null===i?R$(n,o,!0):qy(i,o))return r}else e=r}return e}function j_(n){const t=Tt()[16][6];if(!t.projection){const i=t.projection=Fs(n?n.length:1,null),r=i.slice();let o=t.child;for(;null!==o;){const s=n?jF(o,n):0;null!==s&&(r[s]?r[s].projectionNext=o:i[s]=o,r[s]=o),o=o.next}}}function G_(n,t=0,e){const i=Tt(),r=ii(),o=Bu(r,20+n,16,null,e||null);null===o.projection&&(o.projection=t),fg(),64!=(64&o.flags)&&function zy(n,t,e){M$(t[11],0,t,e,s_(n,e,t),tf(e.parent||t[6],e,t))}(r,i,o)}function Ht(n,t,e){return na(n,"",t,"",e),Ht}function na(n,t,e,i,r){const o=Tt(),s=qh(o,t,e,i);return s!==kn&&cs(ii(),tr(),o,n,s,o[11],r,!1),na}function tp(n,t,e,i,r,o,s){const a=Tt(),g=Wh(a,t,e,i,r,o);return g!==kn&&cs(ii(),tr(),a,n,g,a[11],s,!1),tp}function wT(n,t,e,i,r){const o=n[e+1],s=null===t;let a=i?ea(o):ol(o),g=!1;for(;0!==a&&(!1===g||s);){const W=n[a+1];WF(n[a],t)&&(g=!0,n[a+1]=i?of(W):h_(W)),a=i?ea(W):ol(W)}g&&(n[e+1]=i?h_(o):of(o))}function WF(n,t){return null===n||null==t||(Array.isArray(n)?n[1]:n)===t||!(!Array.isArray(n)||"string"!=typeof t)&&Iu(n,t)>=0}const Zr={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function ET(n){return n.substring(Zr.key,Zr.keyEnd)}function ZF(n){return n.substring(Zr.value,Zr.valueEnd)}function ST(n,t){const e=Zr.textEnd;let i=Zr.key=np(n,t,e);return e===i?-1:(i=Zr.keyEnd=function QF(n,t,e){let i;for(;t<e&&(45===(i=n.charCodeAt(t))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)t++;return t}(n,i,e),i=IT(n,i,e),i=Zr.value=np(n,i,e),i=Zr.valueEnd=function JF(n,t,e){let i=-1,r=-1,o=-1,s=t,a=s;for(;s<e;){const g=n.charCodeAt(s++);if(59===g)return a;34===g||39===g?a=s=kT(n,g,s,e):t===s-4&&85===o&&82===r&&76===i&&40===g?a=s=kT(n,41,s,e):g>32&&(a=s),o=r,r=i,i=-33&g}return a}(n,i,e),IT(n,i,e))}function np(n,t,e){for(;t<e&&n.charCodeAt(t)<=32;)t++;return t}function IT(n,t,e,i){return(t=np(n,t,e))<e&&t++,t}function kT(n,t,e,i){let r=-1,o=e;for(;o<i;){const s=n.charCodeAt(o++);if(s==t&&92!==r)return o;r=92==s&&92===r?0:s}throw new Error}function un(n,t,e){return dl(n,t,e,!1),un}function Aa(n,t){return dl(n,t,null,!0),Aa}function Qn(n){!function fl(n,t,e,i){const r=ii(),o=Qa(2);r.firstUpdatePass&&AT(r,null,o,i);const s=Tt();if(e!==kn&&qo(s,o,e)){const a=r.data[Pr()];if(NT(a,i)&&!MT(r,o)){let g=i?a.classesWithoutHost:a.stylesWithoutHost;null!==g&&(e=Za(g,e||"")),RC(r,a,s,e,i)}else!function a4(n,t,e,i,r,o,s,a){r===kn&&(r=Oi);let g=0,w=0,W=0<r.length?r[0]:null,ve=0<o.length?o[0]:null;for(;null!==W||null!==ve;){const me=g<r.length?r[g+1]:void 0,Se=w<o.length?o[w+1]:void 0;let Ve,Oe=null;W===ve?(g+=2,w+=2,me!==Se&&(Oe=ve,Ve=Se)):null===ve||null!==W&&W<ve?(g+=2,Oe=W):(w+=2,Oe=ve,Ve=Se),null!==Oe&&FT(n,t,e,i,Oe,Ve,s,a),W=g<r.length?r[g]:null,ve=w<o.length?o[w]:null}}(r,a,s,s[11],s[o+1],s[o+1]=function s4(n,t,e){if(null==e||""===e)return Oi;const i=[],r=ss(e);if(Array.isArray(r))for(let o=0;o<r.length;o++)n(i,r[o],!0);else if("object"==typeof r)for(const o in r)r.hasOwnProperty(o)&&n(i,o,r[o]);else"string"==typeof r&&t(i,r);return i}(n,t,e),i,o)}}(PT,e4,n,!1)}function e4(n,t){for(let e=function KF(n){return function DT(n){Zr.key=0,Zr.keyEnd=0,Zr.value=0,Zr.valueEnd=0,Zr.textEnd=n.length}(n),ST(n,np(n,0,Zr.textEnd))}(t);e>=0;e=ST(t,e))PT(n,ET(t),ZF(t))}function dl(n,t,e,i){const r=Tt(),o=ii(),s=Qa(2);o.firstUpdatePass&&AT(o,n,s,i),t!==kn&&qo(r,s,t)&&FT(o,o.data[Pr()],r,r[11],n,r[s+1]=function l4(n,t){return null==n||("string"==typeof t?n+=t:"object"==typeof n&&(n=ui(ss(n)))),n}(t,e),i,s)}function MT(n,t){return t>=n.expandoStartIndex}function AT(n,t,e,i){const r=n.data;if(null===r[e+1]){const o=r[Pr()],s=MT(n,e);NT(o,i)&&null===t&&!s&&(t=!1),t=function n4(n,t,e,i){const r=function pg(n){const t=wn.lFrame.currentDirectiveIndex;return-1===t?null:n[t]}(n);let o=i?t.residualClasses:t.residualStyles;if(null===r)0===(i?t.classBindings:t.styleBindings)&&(e=q_(e=OC(null,n,t,e,i),t.attrs,i),o=null);else{const s=t.directiveStylingLast;if(-1===s||n[s]!==r)if(e=OC(r,n,t,e,i),null===o){let g=function i4(n,t,e){const i=e?t.classBindings:t.styleBindings;if(0!==ol(i))return n[ea(i)]}(n,t,i);void 0!==g&&Array.isArray(g)&&(g=OC(null,n,t,g[1],i),g=q_(g,t.attrs,i),function r4(n,t,e,i){n[ea(e?t.classBindings:t.styleBindings)]=i}(n,t,i,g))}else o=function o4(n,t,e){let i;const r=t.directiveEnd;for(let o=1+t.directiveStylingLast;o<r;o++)i=q_(i,n[o].hostAttrs,e);return q_(i,t.attrs,e)}(n,t,i)}return void 0!==o&&(i?t.residualClasses=o:t.residualStyles=o),e}(r,o,t,i),function GF(n,t,e,i,r,o){let s=o?t.classBindings:t.styleBindings,a=ea(s),g=ol(s);n[i]=e;let W,w=!1;if(Array.isArray(e)){const ve=e;W=ve[1],(null===W||Iu(ve,W)>0)&&(w=!0)}else W=e;if(r)if(0!==g){const me=ea(n[a+1]);n[i+1]=Lh(me,a),0!==me&&(n[me+1]=zh(n[me+1],i)),n[a+1]=function Zy(n,t){return 131071&n|t<<17}(n[a+1],i)}else n[i+1]=Lh(a,0),0!==a&&(n[a+1]=zh(n[a+1],i)),a=i;else n[i+1]=Lh(g,0),0===a?a=i:n[g+1]=zh(n[g+1],i),g=i;w&&(n[i+1]=h_(n[i+1])),wT(n,W,i,!0),wT(n,W,i,!1),function qF(n,t,e,i,r){const o=r?n.residualClasses:n.residualStyles;null!=o&&"string"==typeof t&&Iu(o,t)>=0&&(e[i+1]=of(e[i+1]))}(t,W,n,i,o),s=Lh(a,g),o?t.classBindings=s:t.styleBindings=s}(r,o,t,e,s,i)}}function OC(n,t,e,i,r){let o=null;const s=e.directiveEnd;let a=e.directiveStylingLast;for(-1===a?a=e.directiveStart:a++;a<s&&(o=t[a],i=q_(i,o.hostAttrs,r),o!==n);)a++;return null!==n&&(e.directiveStylingLast=a),i}function q_(n,t,e){const i=e?1:2;let r=-1;if(null!==t)for(let o=0;o<t.length;o++){const s=t[o];"number"==typeof s?r=s:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),zo(n,s,!!e||t[++o]))}return void 0===n?null:n}function PT(n,t,e){zo(n,t,ss(e))}function FT(n,t,e,i,r,o,s,a){if(!(3&t.type))return;const g=n.data,w=g[a+1];b1(function Nu(n){return 1==(1&n)}(w)?RT(g,t,e,r,ol(w),s):void 0)||(b1(o)||function O$(n){return 2==(2&n)}(w)&&(o=RT(g,null,e,r,a,s)),function Vy(n,t,e,i,r){const o=Yn(n);if(t)r?o?n.addClass(e,i):e.classList.add(i):o?n.removeClass(e,i):e.classList.remove(i);else{let s=-1===i.indexOf("-")?void 0:as.DashCase;if(null==r)o?n.removeStyle(e,i,s):e.style.removeProperty(i);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),s|=as.Important),o?n.setStyle(e,i,r,s):e.style.setProperty(i,r,a?"important":"")}}}(i,s,Nl(Pr(),e),r,o))}function RT(n,t,e,i,r,o){const s=null===t;let a;for(;r>0;){const g=n[r],w=Array.isArray(g),W=w?g[1]:g,ve=null===W;let me=e[r+1];me===kn&&(me=ve?Oi:void 0);let Se=ve?_h(me,i):W===i?me:void 0;if(w&&!b1(Se)&&(Se=_h(g,i)),b1(Se)&&(a=Se,s))return a;const Oe=n[r+1];r=s?ea(Oe):ol(Oe)}if(null!==t){let g=o?t.residualClasses:t.residualStyles;null!=g&&(a=_h(g,i))}return a}function b1(n){return void 0!==n}function NT(n,t){return 0!=(n.flags&(t?16:32))}function we(n,t=""){const e=Tt(),i=ii(),r=n+20,o=i.firstCreatePass?Bu(i,r,1,t,null):i.data[r],s=e[r]=function i_(n,t){return Yn(n)?n.createText(t):n.createTextNode(t)}(e[11],t);Nh(i,e,s,o),va(o,!1)}function xt(n){return sn("",n,""),xt}function sn(n,t,e){const i=Tt(),r=qh(i,n,t,e);return r!==kn&&cl(i,Pr(),r),sn}function Os(n,t,e,i,r){const o=Tt(),s=Wh(o,n,t,e,i,r);return s!==kn&&cl(o,Pr(),s),Os}function y1(n,t,e,i,r,o,s){const a=Tt(),g=function Zh(n,t,e,i,r,o,s,a){const w=m1(n,Xa(),e,r,s);return Qa(3),w?t+_n(e)+i+_n(r)+o+_n(s)+a:kn}(a,n,t,e,i,r,o,s);return g!==kn&&cl(a,Pr(),g),y1}const ff=void 0;var D4=["en",[["a","p"],["AM","PM"],ff],[["AM","PM"],ff,ff],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ff,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ff,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ff,"{1} 'at' {0}",ff],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function S4(n){const e=Math.floor(Math.abs(n)),i=n.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===i?1:5}];let ip={};function us(n){const t=function I4(n){return n.toLowerCase().replace(/_/g,"-")}(n);let e=n3(t);if(e)return e;const i=t.split("-")[0];if(e=n3(i),e)return e;if("en"===i)return D4;throw new Error(`Missing locale data for the locale "${n}".`)}function n3(n){return n in ip||(ip[n]=wi.ng&&wi.ng.common&&wi.ng.common.locales&&wi.ng.common.locales[n]),ip[n]}var qt=(()=>((qt=qt||{})[qt.LocaleId=0]="LocaleId",qt[qt.DayPeriodsFormat=1]="DayPeriodsFormat",qt[qt.DayPeriodsStandalone=2]="DayPeriodsStandalone",qt[qt.DaysFormat=3]="DaysFormat",qt[qt.DaysStandalone=4]="DaysStandalone",qt[qt.MonthsFormat=5]="MonthsFormat",qt[qt.MonthsStandalone=6]="MonthsStandalone",qt[qt.Eras=7]="Eras",qt[qt.FirstDayOfWeek=8]="FirstDayOfWeek",qt[qt.WeekendRange=9]="WeekendRange",qt[qt.DateFormat=10]="DateFormat",qt[qt.TimeFormat=11]="TimeFormat",qt[qt.DateTimeFormat=12]="DateTimeFormat",qt[qt.NumberSymbols=13]="NumberSymbols",qt[qt.NumberFormats=14]="NumberFormats",qt[qt.CurrencyCode=15]="CurrencyCode",qt[qt.CurrencySymbol=16]="CurrencySymbol",qt[qt.CurrencyName=17]="CurrencyName",qt[qt.Currencies=18]="Currencies",qt[qt.Directionality=19]="Directionality",qt[qt.PluralCase=20]="PluralCase",qt[qt.ExtraData=21]="ExtraData",qt))();const C1="en-US";let i3=C1;function zC(n,t,e,i,r){if(n=Dn(n),Array.isArray(n))for(let o=0;o<n.length;o++)zC(n[o],t,e,i,r);else{const o=ii(),s=Tt();let a=Uu(n)?n:Dn(n.provide),g=p1(n);const w=Zi(),W=1048575&w.providerIndexes,ve=w.directiveStart,me=w.providerIndexes>>20;if(Uu(n)||!n.multi){const Se=new Hd(g,r,Be),Oe=VC(a,t,r?W:W+me,ve);-1===Oe?(jd(xu(w,s),o,a),HC(o,n,t.length),t.push(a),w.directiveStart++,w.directiveEnd++,r&&(w.providerIndexes+=1048576),e.push(Se),s.push(Se)):(e[Oe]=Se,s[Oe]=Se)}else{const Se=VC(a,t,W+me,ve),Oe=VC(a,t,W,W+me),Ve=Se>=0&&e[Se],We=Oe>=0&&e[Oe];if(r&&!We||!r&&!Ve){jd(xu(w,s),o,a);const Ze=function S5(n,t,e,i,r){const o=new Hd(n,e,Be);return o.multi=[],o.index=t,o.componentProviders=0,S3(o,r,i&&!e),o}(r?T5:E5,e.length,r,i,g);!r&&We&&(e[Oe].providerFactory=Ze),HC(o,n,t.length,0),t.push(a),w.directiveStart++,w.directiveEnd++,r&&(w.providerIndexes+=1048576),e.push(Ze),s.push(Ze)}else HC(o,n,Se>-1?Se:Oe,S3(e[r?Oe:Se],g,!r&&i));!r&&i&&We&&e[Oe].componentProviders++}}}function HC(n,t,e,i){const r=Uu(t),o=function u(n){return!!n.useClass}(t);if(r||o){const g=(o?Dn(t.useClass):t).prototype.ngOnDestroy;if(g){const w=n.destroyHooks||(n.destroyHooks=[]);if(!r&&t.multi){const W=w.indexOf(e);-1===W?w.push(e,[i,g]):w[W+1].push(i,g)}else w.push(e,g)}}}function S3(n,t,e){return e&&n.componentProviders++,n.multi.push(t)-1}function VC(n,t,e,i){for(let r=e;r<i;r++)if(t[r]===n)return r;return-1}function E5(n,t,e,i){return UC(this.multi,[])}function T5(n,t,e,i){const r=this.multi;let o;if(this.providerFactory){const s=this.providerFactory.componentProviders,a=wu(e,e[1],this.providerFactory.index,i);o=a.slice(0,s),UC(r,o);for(let g=s;g<a.length;g++)o.push(a[g])}else o=[],UC(r,o);return o}function UC(n,t){for(let e=0;e<n.length;e++)t.push((0,n[e])());return t}function Xi(n,t=[]){return e=>{e.providersResolver=(i,r)=>function w5(n,t,e){const i=ii();if(i.firstCreatePass){const r=mt(n);zC(e,i.data,i.blueprint,r,!0),zC(t,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,t)}}class D3{}class k5{resolveComponentFactory(t){throw function I5(n){const t=Error(`No component factory found for ${ui(n)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=n,t}(t)}}let ju=(()=>{class n{}return n.NULL=new k5,n})();function M5(){return op(Zi(),Tt())}function op(n,t){return new fi(Bo(n,t))}let fi=(()=>{class n{constructor(e){this.nativeElement=e}}return n.__NG_ELEMENT_ID__=M5,n})();function A5(n){return n instanceof fi?n.nativeElement:n}class X_{}let Gu=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function F5(){const n=Tt(),e=so(Zi().index,n);return function P5(n){return n[11]}(_a(e)?e:n)}(),n})(),R5=(()=>{class n{}return n.\u0275prov=Tn({token:n,providedIn:"root",factory:()=>null}),n})();class S1{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const N5=new S1("13.3.1"),jC={};function D1(n,t,e,i,r=!1){for(;null!==e;){const o=t[e.index];if(null!==o&&i.push(ur(o)),qs(o))for(let a=10;a<o.length;a++){const g=o[a],w=g[1].firstChild;null!==w&&D1(g[1],g,w,i)}const s=e.type;if(8&s)D1(n,t,e.child,i);else if(32&s){const a=Qg(e,t);let g;for(;g=a();)i.push(g)}else if(16&s){const a=I$(t,e);if(Array.isArray(a))i.push(...a);else{const g=ef(t[16]);D1(g[1],g,a,i,!0)}}e=r?e.projectionNext:e.next}return i}class Q_{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return D1(e,t,e.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(qs(t)){const e=t[8],i=e?e.indexOf(this):-1;i>-1&&(Ru(t,i),gh(e,i))}this._attachedToViewContainer=!1}w$(this._lView[1],this._lView)}onDestroy(t){Y$(this._lView[1],this._lView,null,t)}markForCheck(){lf(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){F_(this._lView[1],this._lView,this.context)}checkNoChanges(){!function R_(n,t,e){ih(!0);try{F_(n,t,e)}finally{ih(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new jt(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Ry(n,t){rf(n,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new jt(902,"");this._appRef=t}}class O5 extends Q_{constructor(t){super(t),this._view=t}detectChanges(){o1(this._view)}checkNoChanges(){!function vC(n){ih(!0);try{o1(n)}finally{ih(!1)}}(this._view)}get context(){return null}}class k3 extends ju{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=Gr(t);return new GC(e,this.ngModule)}}function M3(n){const t=[];for(let e in n)n.hasOwnProperty(e)&&t.push({propName:n[e],templateName:e});return t}class GC extends D3{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function rl(n){return n.map(Wy).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return M3(this.componentDef.inputs)}get outputs(){return M3(this.componentDef.outputs)}create(t,e,i,r){const o=(r=r||this.ngModule)?function L5(n,t){return{get:(e,i,r)=>{const o=n.get(e,jC,r);return o!==jC||i===jC?o:t.get(e,i,r)}}}(t,r.injector):t,s=o.get(X_,h0),a=o.get(R5,null),g=s.createRenderer(null,this.componentDef),w=this.componentDef.selectors[0][0]||"div",W=i?function Z$(n,t,e){if(Yn(n))return n.selectRootElement(t,e===ws.ShadowDom);let i="string"==typeof t?n.querySelector(t):t;return i.textContent="",i}(g,i,this.componentDef.encapsulation):r_(s.createRenderer(null,this.componentDef),w,function B5(n){const t=n.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(w)),ve=this.componentDef.onPush?576:528,me=function GE(n,t){return{components:[],scheduler:n||Dy,clean:bC,playerHandler:t||null,flags:0}}(),Se=ll(0,null,null,1,0,null,null,null,null,null),Oe=sf(null,Se,me,ve,null,null,s,g,a,o);let Ve,We;rh(Oe);try{const Ze=function UE(n,t,e,i,r,o){const s=e[1];e[20]=n;const g=Bu(s,20,2,"#host",null),w=g.mergedAttrs=t.hostAttrs;null!==w&&(Hu(g,w,!0),null!==n&&(Vd(r,n,w),null!==g.classes&&ls(r,n,g.classes),null!==g.styles&&A$(r,n,g.styles)));const W=i.createRenderer(n,t),ve=sf(e,q$(t),null,t.onPush?64:16,e[20],g,i,W,o||null,null);return s.firstCreatePass&&(jd(xu(g,e),s,t.type),e1(s,g),t1(g,e.length,1)),Wr(e,ve),e[20]=ve}(W,this.componentDef,Oe,s,g);if(W)if(i)Vd(g,W,["ng-version",N5.full]);else{const{attrs:je,classes:ut}=function N$(n){const t=[],e=[];let i=1,r=2;for(;i<n.length;){let o=n[i];if("string"==typeof o)2===r?""!==o&&t.push(o,n[++i]):8===r&&e.push(o);else{if(!Js(r))break;r=o}i++}return{attrs:t,classes:e}}(this.componentDef.selectors[0]);je&&Vd(g,W,je),ut&&ut.length>0&&ls(g,W,ut.join(" "))}if(We=Mc(Se,20),void 0!==e){const je=We.projection=[];for(let ut=0;ut<this.ngContentSelectors.length;ut++){const ot=e[ut];je.push(null!=ot?Array.from(ot):null)}}Ve=function jE(n,t,e,i,r){const o=e[1],s=function oC(n,t,e){const i=Zi();n.firstCreatePass&&(e.providersResolver&&e.providersResolver(e),n1(n,i,t,Lu(n,t,1,null),e));const r=wu(t,n,i.directiveStart,i);uo(r,t);const o=Bo(i,t);return o&&uo(o,t),r}(o,e,t);if(i.components.push(s),n[8]=s,r&&r.forEach(g=>g(s,t)),t.contentQueries){const g=Zi();t.contentQueries(1,s,g.directiveStart)}const a=Zi();return!o.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(Ll(a.index),Q$(e[1],a,0,a.directiveStart,a.directiveEnd,t),J$(t,s)),s}(Ze,this.componentDef,Oe,me,[lF]),af(Se,Oe,null)}finally{oh()}return new H5(this.componentType,Ve,op(We,Oe),Oe,We)}}class H5 extends class D5{}{constructor(t,e,i,r,o){super(),this.location=i,this._rootLView=r,this._tNode=o,this.instance=e,this.hostView=this.changeDetectorRef=new O5(r),this.componentType=t}get injector(){return new Eu(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}class sp{}const ap=new Map;class F3 extends sp{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new k3(this);const i=is(t);this._bootstrapComponents=Da(i.bootstrap),this._r3Injector=h1(t,e,[{provide:sp,useValue:this},{provide:ju,useValue:this.componentFactoryResolver}],ui(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,e=Ne.THROW_IF_NOT_FOUND,i=Rn.Default){return t===Ne||t===sp||t===B_?this:this._r3Injector.get(t,e,i)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class qC extends class U5{}{constructor(t){super(),this.moduleType=t,null!==is(t)&&function j5(n){const t=new Set;!function e(i){const r=is(i,!0),o=r.id;null!==o&&(function A3(n,t,e){if(t&&t!==e)throw new Error(`Duplicate module registered for ${n} - ${ui(t)} vs ${ui(t.name)}`)}(o,ap.get(o),i),ap.set(o,i));const s=Da(r.imports);for(const a of s)t.has(a)||(t.add(a),e(a))}(n)}(t)}create(t){return new F3(this.moduleType,t)}}function $r(n,t,e){const i=vo()+n,r=Tt();return r[i]===kn?Jl(r,i,e?t.call(e):t()):function U_(n,t){return n[t]}(r,i)}function Nt(n,t,e,i){return R3(Tt(),vo(),n,t,e,i)}function hi(n,t,e,i,r){return N3(Tt(),vo(),n,t,e,i,r)}function Wo(n,t,e,i,r,o){return function O3(n,t,e,i,r,o,s,a){const g=t+e;return m1(n,g,r,o,s)?Jl(n,g+3,a?i.call(a,r,o,s):i(r,o,s)):J_(n,g+3)}(Tt(),vo(),n,t,e,i,r,o)}function Rr(n,t,e,i,r,o,s){return function B3(n,t,e,i,r,o,s,a,g){const w=t+e;return function Ma(n,t,e,i,r,o){const s=df(n,t,e,i);return df(n,t+2,r,o)||s}(n,w,r,o,s,a)?Jl(n,w+4,g?i.call(g,r,o,s,a):i(r,o,s,a)):J_(n,w+4)}(Tt(),vo(),n,t,e,i,r,o,s)}function J_(n,t){const e=n[t];return e===kn?void 0:e}function R3(n,t,e,i,r,o){const s=t+e;return qo(n,s,r)?Jl(n,s+1,o?i.call(o,r):i(r)):J_(n,s+1)}function N3(n,t,e,i,r,o,s){const a=t+e;return df(n,a,r,o)?Jl(n,a+2,s?i.call(s,r,o):i(r,o)):J_(n,a+2)}function At(n,t){const e=ii();let i;const r=n+20;e.firstCreatePass?(i=function K5(n,t){if(t)for(let e=t.length-1;e>=0;e--){const i=t[e];if(n===i.name)return i}}(t,e.pipeRegistry),e.data[r]=i,i.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(r,i.onDestroy)):i=e.data[r];const o=i.factory||(i.factory=ma(i.type)),s=Fl(Be);try{const a=ch(!1),g=o();return ch(a),function bF(n,t,e,i){e>=n.data.length&&(n.data[e]=null,n.blueprint[e]=null),t[e]=i}(e,Tt(),r,g),g}finally{Fl(s)}}function Ft(n,t,e,i){const r=n+20,o=Tt(),s=$a(o,r);return em(o,r)?N3(o,vo(),t,s.transform,e,i,s):s.transform(e,i)}function em(n,t){return n[1].data[t].pure}function WC(n){return t=>{setTimeout(n,void 0,t)}}const Xt=class eR extends d{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,i){var r,o,s;let a=t,g=e||(()=>null),w=i;if(t&&"object"==typeof t){const ve=t;a=null===(r=ve.next)||void 0===r?void 0:r.bind(ve),g=null===(o=ve.error)||void 0===o?void 0:o.bind(ve),w=null===(s=ve.complete)||void 0===s?void 0:s.bind(ve)}this.__isAsync&&(g=WC(g),a&&(a=WC(a)),w&&(w=WC(w)));const W=super.subscribe({next:a,error:g,complete:w});return t instanceof D&&t.add(W),W}};function tR(){return this._results[jh()]()}class ZC{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=jh(),i=ZC.prototype;i[e]||(i[e]=tR)}get changes(){return this._changes||(this._changes=new Xt)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const i=this;i.dirty=!1;const r=Lo(t);(this._changesDetected=!function F0(n,t,e){if(n.length!==t.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],o=t[i];if(e&&(r=e(r),o=e(o)),o!==r)return!1}return!0}(i._results,r,e))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let Ei=(()=>{class n{}return n.__NG_ELEMENT_ID__=rR,n})();const nR=Ei,iR=class extends nR{constructor(t,e,i){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=i}createEmbeddedView(t){const e=this._declarationTContainer.tViews,i=sf(this._declarationLView,e,t,16,null,e.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[19];return null!==o&&(i[19]=o.createEmbeddedView(e)),af(e,i,t),new Q_(i)}};function rR(){return I1(Zi(),Tt())}function I1(n,t){return 4&n.type?new iR(t,n,op(n,t)):null}let ds=(()=>{class n{}return n.__NG_ELEMENT_ID__=oR,n})();function oR(){return U3(Zi(),Tt())}const sR=ds,H3=class extends sR{constructor(t,e,i){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=i}get element(){return op(this._hostTNode,this._hostLView)}get injector(){return new Eu(this._hostTNode,this._hostLView)}get parentInjector(){const t=uh(this._hostTNode,this._hostLView);if(w0(t)){const e=xa(t,this._hostLView),i=Hl(t);return new Eu(e[1].data[i+8],e)}return new Eu(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=V3(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,i){const r=t.createEmbeddedView(e||{});return this.insert(r,i),r}createComponent(t,e,i,r,o){const s=t&&!function Du(n){return"function"==typeof n}(t);let a;if(s)a=e;else{const ve=e||{};a=ve.index,i=ve.injector,r=ve.projectableNodes,o=ve.ngModuleRef}const g=s?t:new GC(Gr(t)),w=i||this.parentInjector;if(!o&&null==g.ngModule){const me=(s?w:this.parentInjector).get(sp,null);me&&(o=me)}const W=g.create(w,r,void 0,o);return this.insert(W.hostView,a),W}insert(t,e){const i=t._lView,r=i[1];if(function Pb(n){return qs(n[3])}(i)){const W=this.indexOf(t);if(-1!==W)this.detach(W);else{const ve=i[3],me=new H3(ve,ve[6],ve[3]);me.detach(me.indexOf(t))}}const o=this._adjustIndex(e),s=this._lContainer;!function Oy(n,t,e,i){const r=10+i,o=e.length;i>0&&(e[r-1][4]=t),i<o-10?(t[4]=e[r],el(e,10+i,t)):(e.push(t),t[4]=null),t[3]=e;const s=t[17];null!==s&&e!==s&&function By(n,t){const e=n[9];t[16]!==t[3][3][16]&&(n[2]=!0),null===e?n[9]=[t]:e.push(t)}(s,t);const a=t[19];null!==a&&a.insertView(n),t[2]|=128}(r,i,s,o);const a=u_(o,s),g=i[11],w=Fh(g,s[7]);return null!==w&&function Fy(n,t,e,i,r,o){i[0]=r,i[6]=t,rf(n,i,e,1,r,o)}(r,s[6],g,i,w,a),t.attachToViewContainerRef(),el(YC(s),o,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=V3(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),i=Ru(this._lContainer,e);i&&(gh(YC(this._lContainer),e),w$(i[1],i))}detach(t){const e=this._adjustIndex(t,-1),i=Ru(this._lContainer,e);return i&&null!=gh(YC(this._lContainer),e)?new Q_(i):null}_adjustIndex(t,e=0){return null==t?this.length+e:t}};function V3(n){return n[8]}function YC(n){return n[8]||(n[8]=[])}function U3(n,t){let e;const i=t[n.index];if(qs(i))e=i;else{let r;if(8&n.type)r=ur(i);else{const o=t[11];r=o.createComment("");const s=Bo(n,t);Zl(o,Fh(o,s),r,function Rh(n,t){return Yn(n)?n.nextSibling(t):t.nextSibling}(o,s),!1)}t[n.index]=e=r1(i,t,r,n),Wr(t,e)}return new H3(e,n,t)}class KC{constructor(t){this.queryList=t,this.matches=null}clone(){return new KC(this.queryList)}setDirty(){this.queryList.setDirty()}}class XC{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const i=null!==t.contentQueries?t.contentQueries[0]:e.length,r=[];for(let o=0;o<i;o++){const s=e.getByIndex(o);r.push(this.queries[s.indexInDeclarationView].clone())}return new XC(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==Z3(t,e).matches&&this.queries[e].setDirty()}}class j3{constructor(t,e,i=null){this.predicate=t,this.flags=e,this.read=i}}class QC{constructor(t=[]){this.queries=t}elementStart(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let i=0;i<this.length;i++){const r=null!==e?e.length:0,o=this.getByIndex(i).embeddedTView(t,r);o&&(o.indexInDeclarationView=i,null!==e?e.push(o):e=[o])}return null!==e?new QC(e):null}template(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class JC{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new JC(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let i=t.parent;for(;null!==i&&8&i.type&&i.index!==e;)i=i.parent;return e===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const o=i[r];this.matchTNodeWithReadOption(t,e,cR(e,o)),this.matchTNodeWithReadOption(t,e,hh(e,t,o,!1,!1))}else i===Ei?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,hh(e,t,i,!1,!1))}matchTNodeWithReadOption(t,e,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===fi||r===ds||r===Ei&&4&e.type)this.addMatch(e.index,-2);else{const o=hh(e,t,r,!1,!1);null!==o&&this.addMatch(e.index,o)}else this.addMatch(e.index,i)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function cR(n,t){const e=n.localNames;if(null!==e)for(let i=0;i<e.length;i+=2)if(e[i]===t)return e[i+1];return null}function dR(n,t,e,i){return-1===e?function uR(n,t){return 11&n.type?op(n,t):4&n.type?I1(n,t):null}(t,n):-2===e?function fR(n,t,e){return e===fi?op(t,n):e===Ei?I1(t,n):e===ds?U3(t,n):void 0}(n,t,i):wu(n,n[1],e,t)}function G3(n,t,e,i){const r=t[19].queries[i];if(null===r.matches){const o=n.data,s=e.matches,a=[];for(let g=0;g<s.length;g+=2){const w=s[g];a.push(w<0?null:dR(t,o[w],s[g+1],e.metadata.read))}r.matches=a}return r.matches}function e2(n,t,e,i){const r=n.queries.getByIndex(e),o=r.matches;if(null!==o){const s=G3(n,t,r,e);for(let a=0;a<o.length;a+=2){const g=o[a];if(g>0)i.push(s[a/2]);else{const w=o[a+1],W=t[-g];for(let ve=10;ve<W.length;ve++){const me=W[ve];me[17]===me[3]&&e2(me[1],me,w,i)}if(null!==W[9]){const ve=W[9];for(let me=0;me<ve.length;me++){const Se=ve[me];e2(Se[1],Se,w,i)}}}}}return i}function yn(n){const t=Tt(),e=ii(),i=Is();gg(i+1);const r=Z3(e,i);if(n.dirty&&Ac(t)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const o=r.crossesNgTemplate?e2(e,t,i,[]):G3(e,t,r,i);n.reset(o,A5),n.notifyOnChanges()}return!0}return!1}function Gn(n,t,e){const i=ii();i.firstCreatePass&&(W3(i,new j3(n,t,e),-1),2==(2&t)&&(i.staticViewQueries=!0)),q3(i,Tt(),t)}function ia(n,t,e,i){const r=ii();if(r.firstCreatePass){const o=Zi();W3(r,new j3(t,e,i),o.index),function pR(n,t){const e=n.contentQueries||(n.contentQueries=[]);t!==(e.length?e[e.length-1]:-1)&&e.push(n.queries.length-1,t)}(r,n),2==(2&e)&&(r.staticContentQueries=!0)}q3(r,Tt(),e)}function Cn(){return function hR(n,t){return n[19].queries[t].queryList}(Tt(),Is())}function q3(n,t,e){const i=new ZC(4==(4&e));Y$(n,t,i,i.destroy),null===t[19]&&(t[19]=new XC),t[19].queries.push(new KC(i))}function W3(n,t,e){null===n.queries&&(n.queries=new QC),n.queries.track(new JC(t,e))}function Z3(n,t){return n.queries.getByIndex(t)}function Ln(n,t){return I1(n,t)}function A1(...n){}const dS=new ei("Application Initializer");let s2=(()=>{class n{constructor(e){this.appInits=e,this.resolve=A1,this.reject=A1,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const e=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const o=this.appInits[r]();if(v1(o))e.push(o);else if(hT(o)){const s=new Promise((a,g)=>{o.subscribe({complete:a,error:g})});e.push(s)}}Promise.all(e).then(()=>{i()}).catch(r=>{this.reject(r)}),0===e.length&&i(),this.initialized=!0}}return n.\u0275fac=function(e){return new(e||n)(In(dS,8))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const nm=new ei("AppId",{providedIn:"root",factory:function fS(){return`${a2()}${a2()}${a2()}`}});function a2(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const hS=new ei("Platform Initializer"),P1=new ei("Platform ID"),MR=new ei("appBootstrapListener");let AR=(()=>{class n{log(e){console.log(e)}warn(e){console.warn(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();const qu=new ei("LocaleId",{providedIn:"root",factory:()=>yh(qu,Rn.Optional|Rn.SkipSelf)||function PR(){return"undefined"!=typeof $localize&&$localize.locale||C1}()}),OR=(()=>Promise.resolve(0))();function l2(n){"undefined"==typeof Zone?OR.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class An{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Xt(!1),this.onMicrotaskEmpty=new Xt(!1),this.onStable=new Xt(!1),this.onError=new Xt(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&e,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function BR(){let n=wi.requestAnimationFrame,t=wi.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&t){const e=n[Zone.__symbol__("OriginalDelegate")];e&&(n=e);const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function HR(n){const t=()=>{!function zR(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(wi,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,u2(n),n.isCheckStableRunning=!0,c2(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),u2(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,i,r,o,s,a)=>{try{return pS(n),e.invokeTask(r,o,s,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||n.shouldCoalesceRunChangeDetection)&&t(),gS(n)}},onInvoke:(e,i,r,o,s,a,g)=>{try{return pS(n),e.invoke(r,o,s,a,g)}finally{n.shouldCoalesceRunChangeDetection&&t(),gS(n)}},onHasTask:(e,i,r,o)=>{e.hasTask(r,o),i===r&&("microTask"==o.change?(n._hasPendingMicrotasks=o.microTask,u2(n),c2(n)):"macroTask"==o.change&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:(e,i,r,o)=>(e.handleError(r,o),n.runOutsideAngular(()=>n.onError.emit(o)),!1)})}(r)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!An.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(An.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,i){return this._inner.run(t,e,i)}runTask(t,e,i,r){const o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,t,LR,A1,A1);try{return o.runTask(s,e,i)}finally{o.cancelTask(s)}}runGuarded(t,e,i){return this._inner.runGuarded(t,e,i)}runOutsideAngular(t){return this._outer.run(t)}}const LR={};function c2(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function u2(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function pS(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function gS(n){n._nesting--,c2(n)}class VR{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Xt,this.onMicrotaskEmpty=new Xt,this.onStable=new Xt,this.onError=new Xt}run(t,e,i){return t.apply(e,i)}runGuarded(t,e,i){return t.apply(e,i)}runOutsideAngular(t){return t()}runTask(t,e,i,r){return t.apply(e,i)}}let d2=(()=>{class n{constructor(e){this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{An.assertNotInAngularZone(),l2(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())l2(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(e)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,i,r){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==o),e(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:e,timeoutId:o,updateCb:r})}whenStable(e,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(e,i,r){return[]}}return n.\u0275fac=function(e){return new(e||n)(In(An))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})(),_S=(()=>{class n{constructor(){this._applications=new Map,f2.addToWindow(this)}registerApplication(e,i){this._applications.set(e,i)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,i=!0){return f2.findTestabilityInTree(this,e,i)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();class UR{addToWindow(t){}findTestabilityInTree(t,e,i){return null}}let hl,f2=new UR;const mS=new ei("AllowMultipleToken");function $S(n,t,e=[]){const i=`Platform: ${t}`,r=new ei(i);return(o=[])=>{let s=vS();if(!s||s.injector.get(mS,!1))if(n)n(e.concat(o).concat({provide:r,useValue:!0}));else{const a=e.concat(o).concat({provide:r,useValue:!0},{provide:L_,useValue:"platform"});!function WR(n){if(hl&&!hl.destroyed&&!hl.injector.get(mS,!1))throw new jt(400,"");hl=n.get(bS);const t=n.get(hS,null);t&&t.forEach(e=>e())}(Ne.create({providers:a,name:i}))}return function ZR(n){const t=vS();if(!t)throw new jt(401,"");return t}()}}function vS(){return hl&&!hl.destroyed?hl:null}let bS=(()=>{class n{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,i){const a=function YR(n,t){let e;return e="noop"===n?new VR:("zone.js"===n?void 0:n)||new An({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)}),e}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),g=[{provide:An,useValue:a}];return a.run(()=>{const w=Ne.create({providers:g,parent:this.injector,name:e.moduleType.name}),W=e.create(w),ve=W.injector.get(Jd,null);if(!ve)throw new jt(402,"");return a.runOutsideAngular(()=>{const me=a.onError.subscribe({next:Se=>{ve.handleError(Se)}});W.onDestroy(()=>{h2(this._modules,W),me.unsubscribe()})}),function KR(n,t,e){try{const i=e();return v1(i)?i.catch(r=>{throw t.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw t.runOutsideAngular(()=>n.handleError(i)),i}}(ve,a,()=>{const me=W.injector.get(s2);return me.runInitializers(),me.donePromise.then(()=>(function P4(n){No(n,"Expected localeId to be defined"),"string"==typeof n&&(i3=n.toLowerCase().replace(/_/g,"-"))}(W.injector.get(qu,C1)||C1),this._moduleDoBootstrap(W),W))})})}bootstrapModule(e,i=[]){const r=yS({},i);return function GR(n,t,e){const i=new qC(e);return Promise.resolve(i)}(0,0,e).then(o=>this.bootstrapModuleFactory(o,r))}_moduleDoBootstrap(e){const i=e.injector.get(CS);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!e.instance.ngDoBootstrap)throw new jt(403,"");e.instance.ngDoBootstrap(i)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new jt(404,"");this._modules.slice().forEach(e=>e.destroy()),this._destroyListeners.forEach(e=>e()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(e){return new(e||n)(In(Ne))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();function yS(n,t){return Array.isArray(t)?t.reduce(yS,n):Object.assign(Object.assign({},n),t)}let CS=(()=>{class n{constructor(e,i,r,o,s){this._zone=e,this._injector=i,this._exceptionHandler=r,this._componentFactoryResolver=o,this._initStatus=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new O(w=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{w.next(this._stable),w.complete()})}),g=new O(w=>{let W;this._zone.runOutsideAngular(()=>{W=this._zone.onStable.subscribe(()=>{An.assertNotInAngularZone(),l2(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,w.next(!0))})})});const ve=this._zone.onUnstable.subscribe(()=>{An.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{w.next(!1)}))});return()=>{W.unsubscribe(),ve.unsubscribe()}});this.isStable=$o(a,g.pipe(function Pl(n={}){const{connector:t=(()=>new d),resetOnError:e=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return o=>{let s=null,a=null,g=null,w=0,W=!1,ve=!1;const me=()=>{null==a||a.unsubscribe(),a=null},Se=()=>{me(),s=g=null,W=ve=!1},Oe=()=>{const Ve=s;Se(),null==Ve||Ve.unsubscribe()};return x((Ve,We)=>{w++,!ve&&!W&&me();const Ze=g=null!=g?g:t();We.add(()=>{w--,0===w&&!ve&&!W&&(a=Fo(Oe,r))}),Ze.subscribe(We),s||(s=new A({next:je=>Ze.next(je),error:je=>{ve=!0,me(),a=Fo(Se,e,je),Ze.error(je)},complete:()=>{W=!0,me(),a=Fo(Se,i),Ze.complete()}}),mo(Ve).subscribe(s))})(o)}}()))}bootstrap(e,i){if(!this._initStatus.done)throw new jt(405,"");let r;r=e instanceof D3?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(r.componentType);const o=function qR(n){return n.isBoundToModule}(r)?void 0:this._injector.get(sp),a=r.create(Ne.NULL,[],i||r.selector,o),g=a.location.nativeElement,w=a.injector.get(d2,null),W=w&&a.injector.get(_S);return w&&W&&W.registerApplication(g,w),a.onDestroy(()=>{this.detachView(a.hostView),h2(this.components,a),W&&W.unregisterApplication(g)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new jt(101,"");try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){const i=e;h2(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(MR,[]).concat(this._bootstrapListeners).forEach(r=>r(e))}ngOnDestroy(){this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(e){return new(e||n)(In(An),In(Ne),In(Jd),In(ju),In(s2))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function h2(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}let wS=!0,bi=(()=>{class n{}return n.__NG_ELEMENT_ID__=JR,n})();function JR(n){return function eN(n,t,e){if(Dc(n)&&!e){const i=so(n.index,t);return new Q_(i,i)}return 47&n.type?new Q_(t[16],t):null}(Zi(),Tt(),16==(16&n))}class IS{constructor(){}supports(t){return V_(t)}create(t){return new sN(t)}}const oN=(n,t)=>t;class sN{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||oN}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,i=this._removalsHead,r=0,o=null;for(;e||i;){const s=!i||e&&e.currentIndex<MS(i,r,o)?e:i,a=MS(s,r,o),g=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(e=e._next,null==s.previousIndex)r++;else{o||(o=[]);const w=a-r,W=g-r;if(w!=W){for(let me=0;me<w;me++){const Se=me<o.length?o[me]:o[me]=0,Oe=Se+me;W<=Oe&&Oe<w&&(o[me]=Se+1)}o[s.previousIndex]=W-w}}a!==g&&t(s,a,g)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!V_(t))throw new jt(900,"");return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let r,o,s,e=this._itHead,i=!1;if(Array.isArray(t)){this.length=t.length;for(let a=0;a<this.length;a++)o=t[a],s=this._trackByFn(a,o),null!==e&&Object.is(e.trackById,s)?(i&&(e=this._verifyReinsertion(e,o,s,a)),Object.is(e.item,o)||this._addIdentityChange(e,o)):(e=this._mismatch(e,o,s,a),i=!0),e=e._next}else r=0,function $F(n,t){if(Array.isArray(n))for(let e=0;e<n.length;e++)t(n[e]);else{const e=n[jh()]();let i;for(;!(i=e.next()).done;)t(i.value)}}(t,a=>{s=this._trackByFn(r,a),null!==e&&Object.is(e.trackById,s)?(i&&(e=this._verifyReinsertion(e,a,s,r)),Object.is(e.item,a)||this._addIdentityChange(e,a)):(e=this._mismatch(e,a,s,r),i=!0),e=e._next,r++}),this.length=r;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,i,r){let o;return null===t?o=this._itTail:(o=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,o,r)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,o,r)):t=this._addAfter(new aN(e,i),o,r),t}_verifyReinsertion(t,e,i,r){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==o?t=this._reinsertAfter(o,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,o=t._nextRemoved;return null===r?this._removalsHead=o:r._nextRemoved=o,null===o?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(t,e,i),this._addToMoves(t,i),t}_moveAfter(t,e,i){return this._unlink(t),this._insertAfter(t,e,i),this._addToMoves(t,i),t}_addAfter(t,e,i){return this._insertAfter(t,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,i){const r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new kS),this._linkedRecords.put(t),t.currentIndex=i,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,i=t._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new kS),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class aN{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class lN{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,t))return i;return null}remove(t){const e=t._prevDup,i=t._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class kS{constructor(){this.map=new Map}put(t){const e=t.trackById;let i=this.map.get(e);i||(i=new lN,this.map.set(e,i)),i.add(t)}get(t,e){const r=this.map.get(t);return r?r.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function MS(n,t,e){const i=n.previousIndex;if(null===i)return i;let r=0;return e&&i<e.length&&(r=e[i]),i+t+r}class AS{constructor(){}supports(t){return t instanceof Map||kC(t)}create(){return new cN}}class cN{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||kC(t)))throw new jt(900,"")}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(i,r)=>{if(e&&e.key===r)this._maybeAddToChanges(e,i),this._appendAfter=e,e=e._next;else{const o=this._getOrCreateRecordForKey(r,i);e=this._insertBeforeOrAppend(e,o)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let i=e;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const i=t._prev;return e._next=t,e._prev=i,t._prev=e,i&&(i._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const r=this._records.get(t);this._maybeAddToChanges(r,e);const o=r._prev,s=r._next;return o&&(o._next=s),s&&(s._prev=o),r._next=null,r._prev=null,r}const i=new uN(t);return this._records.set(t,i),i.currentValue=e,this._addToAdditions(i),i}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(i=>e(t[i],i))}}class uN{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function PS(){return new N1([new IS])}let N1=(()=>{class n{constructor(e){this.factories=e}static create(e,i){if(null!=i){const r=i.factories.slice();e=e.concat(r)}return new n(e)}static extend(e){return{provide:n,useFactory:i=>n.create(e,i||PS()),deps:[[n,new Zd,new Wd]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(null!=i)return i;throw new jt(901,"")}}return n.\u0275prov=Tn({token:n,providedIn:"root",factory:PS}),n})();function FS(){return new im([new AS])}let im=(()=>{class n{constructor(e){this.factories=e}static create(e,i){if(i){const r=i.factories.slice();e=e.concat(r)}return new n(e)}static extend(e){return{provide:n,useFactory:i=>n.create(e,i||FS()),deps:[[n,new Zd,new Wd]]}}find(e){const i=this.factories.find(o=>o.supports(e));if(i)return i;throw new jt(901,"")}}return n.\u0275prov=Tn({token:n,providedIn:"root",factory:FS}),n})();const hN=$S(null,"core",[{provide:P1,useValue:"unknown"},{provide:bS,deps:[Ne]},{provide:_S,deps:[]},{provide:AR,deps:[]}]);let pN=(()=>{class n{constructor(e){}}return n.\u0275fac=function(e){return new(e||n)(In(CS))},n.\u0275mod=ns({type:n}),n.\u0275inj=ts({}),n})(),O1=null;function pf(){return O1}const hs=new ei("DocumentToken");var Cr=(()=>((Cr=Cr||{})[Cr.Format=0]="Format",Cr[Cr.Standalone=1]="Standalone",Cr))(),ni=(()=>((ni=ni||{})[ni.Narrow=0]="Narrow",ni[ni.Abbreviated=1]="Abbreviated",ni[ni.Wide=2]="Wide",ni[ni.Short=3]="Short",ni))(),hr=(()=>((hr=hr||{})[hr.Short=0]="Short",hr[hr.Medium=1]="Medium",hr[hr.Long=2]="Long",hr[hr.Full=3]="Full",hr))(),En=(()=>((En=En||{})[En.Decimal=0]="Decimal",En[En.Group=1]="Group",En[En.List=2]="List",En[En.PercentSign=3]="PercentSign",En[En.PlusSign=4]="PlusSign",En[En.MinusSign=5]="MinusSign",En[En.Exponential=6]="Exponential",En[En.SuperscriptingExponent=7]="SuperscriptingExponent",En[En.PerMille=8]="PerMille",En[En.Infinity=9]="Infinity",En[En.NaN=10]="NaN",En[En.TimeSeparator=11]="TimeSeparator",En[En.CurrencyDecimal=12]="CurrencyDecimal",En[En.CurrencyGroup=13]="CurrencyGroup",En))();function B1(n,t){return Fa(us(n)[qt.DateFormat],t)}function L1(n,t){return Fa(us(n)[qt.TimeFormat],t)}function z1(n,t){return Fa(us(n)[qt.DateTimeFormat],t)}function Pa(n,t){const e=us(n),i=e[qt.NumberSymbols][t];if(void 0===i){if(t===En.CurrencyDecimal)return e[qt.NumberSymbols][En.Decimal];if(t===En.CurrencyGroup)return e[qt.NumberSymbols][En.Group]}return i}function BS(n){if(!n[qt.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[qt.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Fa(n,t){for(let e=t;e>-1;e--)if(void 0!==n[e])return n[e];throw new Error("Locale data API: locale data undefined")}function v2(n){const[t,e]=n.split(":");return{hours:+t,minutes:+e}}const PN=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,rm={},FN=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Yr=(()=>((Yr=Yr||{})[Yr.Short=0]="Short",Yr[Yr.ShortGMT=1]="ShortGMT",Yr[Yr.Long=2]="Long",Yr[Yr.Extended=3]="Extended",Yr))(),Mn=(()=>((Mn=Mn||{})[Mn.FullYear=0]="FullYear",Mn[Mn.Month=1]="Month",Mn[Mn.Date=2]="Date",Mn[Mn.Hours=3]="Hours",Mn[Mn.Minutes=4]="Minutes",Mn[Mn.Seconds=5]="Seconds",Mn[Mn.FractionalSeconds=6]="FractionalSeconds",Mn[Mn.Day=7]="Day",Mn))(),qn=(()=>((qn=qn||{})[qn.DayPeriods=0]="DayPeriods",qn[qn.Days=1]="Days",qn[qn.Months=2]="Months",qn[qn.Eras=3]="Eras",qn))();function RN(n,t,e,i){let r=function jN(n){if(HS(n))return n;if("number"==typeof n&&!isNaN(n))return new Date(n);if("string"==typeof n){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){const[r,o=1,s=1]=n.split("-").map(a=>+a);return H1(r,o-1,s)}const e=parseFloat(n);if(!isNaN(n-e))return new Date(e);let i;if(i=n.match(PN))return function GN(n){const t=new Date(0);let e=0,i=0;const r=n[8]?t.setUTCFullYear:t.setFullYear,o=n[8]?t.setUTCHours:t.setHours;n[9]&&(e=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(t,Number(n[1]),Number(n[2])-1,Number(n[3]));const s=Number(n[4]||0)-e,a=Number(n[5]||0)-i,g=Number(n[6]||0),w=Math.floor(1e3*parseFloat("0."+(n[7]||0)));return o.call(t,s,a,g,w),t}(i)}const t=new Date(n);if(!HS(t))throw new Error(`Unable to convert "${n}" into a date`);return t}(n);t=Hc(e,t)||t;let a,s=[];for(;t;){if(a=FN.exec(t),!a){s.push(t);break}{s=s.concat(a.slice(1));const W=s.pop();if(!W)break;t=W}}let g=r.getTimezoneOffset();i&&(g=zS(i,g),r=function UN(n,t,e){const i=e?-1:1,r=n.getTimezoneOffset();return function VN(n,t){return(n=new Date(n.getTime())).setMinutes(n.getMinutes()+t),n}(n,i*(zS(t,r)-r))}(r,i,!0));let w="";return s.forEach(W=>{const ve=function HN(n){if(y2[n])return y2[n];let t;switch(n){case"G":case"GG":case"GGG":t=Qi(qn.Eras,ni.Abbreviated);break;case"GGGG":t=Qi(qn.Eras,ni.Wide);break;case"GGGGG":t=Qi(qn.Eras,ni.Narrow);break;case"y":t=Or(Mn.FullYear,1,0,!1,!0);break;case"yy":t=Or(Mn.FullYear,2,0,!0,!0);break;case"yyy":t=Or(Mn.FullYear,3,0,!1,!0);break;case"yyyy":t=Or(Mn.FullYear,4,0,!1,!0);break;case"Y":t=G1(1);break;case"YY":t=G1(2,!0);break;case"YYY":t=G1(3);break;case"YYYY":t=G1(4);break;case"M":case"L":t=Or(Mn.Month,1,1);break;case"MM":case"LL":t=Or(Mn.Month,2,1);break;case"MMM":t=Qi(qn.Months,ni.Abbreviated);break;case"MMMM":t=Qi(qn.Months,ni.Wide);break;case"MMMMM":t=Qi(qn.Months,ni.Narrow);break;case"LLL":t=Qi(qn.Months,ni.Abbreviated,Cr.Standalone);break;case"LLLL":t=Qi(qn.Months,ni.Wide,Cr.Standalone);break;case"LLLLL":t=Qi(qn.Months,ni.Narrow,Cr.Standalone);break;case"w":t=b2(1);break;case"ww":t=b2(2);break;case"W":t=b2(1,!0);break;case"d":t=Or(Mn.Date,1);break;case"dd":t=Or(Mn.Date,2);break;case"c":case"cc":t=Or(Mn.Day,1);break;case"ccc":t=Qi(qn.Days,ni.Abbreviated,Cr.Standalone);break;case"cccc":t=Qi(qn.Days,ni.Wide,Cr.Standalone);break;case"ccccc":t=Qi(qn.Days,ni.Narrow,Cr.Standalone);break;case"cccccc":t=Qi(qn.Days,ni.Short,Cr.Standalone);break;case"E":case"EE":case"EEE":t=Qi(qn.Days,ni.Abbreviated);break;case"EEEE":t=Qi(qn.Days,ni.Wide);break;case"EEEEE":t=Qi(qn.Days,ni.Narrow);break;case"EEEEEE":t=Qi(qn.Days,ni.Short);break;case"a":case"aa":case"aaa":t=Qi(qn.DayPeriods,ni.Abbreviated);break;case"aaaa":t=Qi(qn.DayPeriods,ni.Wide);break;case"aaaaa":t=Qi(qn.DayPeriods,ni.Narrow);break;case"b":case"bb":case"bbb":t=Qi(qn.DayPeriods,ni.Abbreviated,Cr.Standalone,!0);break;case"bbbb":t=Qi(qn.DayPeriods,ni.Wide,Cr.Standalone,!0);break;case"bbbbb":t=Qi(qn.DayPeriods,ni.Narrow,Cr.Standalone,!0);break;case"B":case"BB":case"BBB":t=Qi(qn.DayPeriods,ni.Abbreviated,Cr.Format,!0);break;case"BBBB":t=Qi(qn.DayPeriods,ni.Wide,Cr.Format,!0);break;case"BBBBB":t=Qi(qn.DayPeriods,ni.Narrow,Cr.Format,!0);break;case"h":t=Or(Mn.Hours,1,-12);break;case"hh":t=Or(Mn.Hours,2,-12);break;case"H":t=Or(Mn.Hours,1);break;case"HH":t=Or(Mn.Hours,2);break;case"m":t=Or(Mn.Minutes,1);break;case"mm":t=Or(Mn.Minutes,2);break;case"s":t=Or(Mn.Seconds,1);break;case"ss":t=Or(Mn.Seconds,2);break;case"S":t=Or(Mn.FractionalSeconds,1);break;case"SS":t=Or(Mn.FractionalSeconds,2);break;case"SSS":t=Or(Mn.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=U1(Yr.Short);break;case"ZZZZZ":t=U1(Yr.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=U1(Yr.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=U1(Yr.Long);break;default:return null}return y2[n]=t,t}(W);w+=ve?ve(r,e,g):"''"===W?"'":W.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),w}function H1(n,t,e){const i=new Date(0);return i.setFullYear(n,t,e),i.setHours(0,0,0),i}function Hc(n,t){const e=function yN(n){return us(n)[qt.LocaleId]}(n);if(rm[e]=rm[e]||{},rm[e][t])return rm[e][t];let i="";switch(t){case"shortDate":i=B1(n,hr.Short);break;case"mediumDate":i=B1(n,hr.Medium);break;case"longDate":i=B1(n,hr.Long);break;case"fullDate":i=B1(n,hr.Full);break;case"shortTime":i=L1(n,hr.Short);break;case"mediumTime":i=L1(n,hr.Medium);break;case"longTime":i=L1(n,hr.Long);break;case"fullTime":i=L1(n,hr.Full);break;case"short":const r=Hc(n,"shortTime"),o=Hc(n,"shortDate");i=V1(z1(n,hr.Short),[r,o]);break;case"medium":const s=Hc(n,"mediumTime"),a=Hc(n,"mediumDate");i=V1(z1(n,hr.Medium),[s,a]);break;case"long":const g=Hc(n,"longTime"),w=Hc(n,"longDate");i=V1(z1(n,hr.Long),[g,w]);break;case"full":const W=Hc(n,"fullTime"),ve=Hc(n,"fullDate");i=V1(z1(n,hr.Full),[W,ve])}return i&&(rm[e][t]=i),i}function V1(n,t){return t&&(n=n.replace(/\{([^}]+)}/g,function(e,i){return null!=t&&i in t?t[i]:e})),n}function pl(n,t,e="-",i,r){let o="";(n<0||r&&n<=0)&&(r?n=1-n:(n=-n,o=e));let s=String(n);for(;s.length<t;)s="0"+s;return i&&(s=s.substr(s.length-t)),o+s}function Or(n,t,e=0,i=!1,r=!1){return function(o,s){let a=function ON(n,t){switch(n){case Mn.FullYear:return t.getFullYear();case Mn.Month:return t.getMonth();case Mn.Date:return t.getDate();case Mn.Hours:return t.getHours();case Mn.Minutes:return t.getMinutes();case Mn.Seconds:return t.getSeconds();case Mn.FractionalSeconds:return t.getMilliseconds();case Mn.Day:return t.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}(n,o);if((e>0||a>-e)&&(a+=e),n===Mn.Hours)0===a&&-12===e&&(a=12);else if(n===Mn.FractionalSeconds)return function NN(n,t){return pl(n,3).substr(0,t)}(a,t);const g=Pa(s,En.MinusSign);return pl(a,t,g,i,r)}}function Qi(n,t,e=Cr.Format,i=!1){return function(r,o){return function BN(n,t,e,i,r,o){switch(e){case qn.Months:return function wN(n,t,e){const i=us(n),o=Fa([i[qt.MonthsFormat],i[qt.MonthsStandalone]],t);return Fa(o,e)}(t,r,i)[n.getMonth()];case qn.Days:return function xN(n,t,e){const i=us(n),o=Fa([i[qt.DaysFormat],i[qt.DaysStandalone]],t);return Fa(o,e)}(t,r,i)[n.getDay()];case qn.DayPeriods:const s=n.getHours(),a=n.getMinutes();if(o){const w=function DN(n){const t=us(n);return BS(t),(t[qt.ExtraData][2]||[]).map(i=>"string"==typeof i?v2(i):[v2(i[0]),v2(i[1])])}(t),W=function IN(n,t,e){const i=us(n);BS(i);const o=Fa([i[qt.ExtraData][0],i[qt.ExtraData][1]],t)||[];return Fa(o,e)||[]}(t,r,i),ve=w.findIndex(me=>{if(Array.isArray(me)){const[Se,Oe]=me,Ve=s>=Se.hours&&a>=Se.minutes,We=s<Oe.hours||s===Oe.hours&&a<Oe.minutes;if(Se.hours<Oe.hours){if(Ve&&We)return!0}else if(Ve||We)return!0}else if(me.hours===s&&me.minutes===a)return!0;return!1});if(-1!==ve)return W[ve]}return function CN(n,t,e){const i=us(n),o=Fa([i[qt.DayPeriodsFormat],i[qt.DayPeriodsStandalone]],t);return Fa(o,e)}(t,r,i)[s<12?0:1];case qn.Eras:return function EN(n,t){return Fa(us(n)[qt.Eras],t)}(t,i)[n.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(r,o,n,t,e,i)}}function U1(n){return function(t,e,i){const r=-1*i,o=Pa(e,En.MinusSign),s=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case Yr.Short:return(r>=0?"+":"")+pl(s,2,o)+pl(Math.abs(r%60),2,o);case Yr.ShortGMT:return"GMT"+(r>=0?"+":"")+pl(s,1,o);case Yr.Long:return"GMT"+(r>=0?"+":"")+pl(s,2,o)+":"+pl(Math.abs(r%60),2,o);case Yr.Extended:return 0===i?"Z":(r>=0?"+":"")+pl(s,2,o)+":"+pl(Math.abs(r%60),2,o);default:throw new Error(`Unknown zone width "${n}"`)}}}function LS(n){return H1(n.getFullYear(),n.getMonth(),n.getDate()+(4-n.getDay()))}function b2(n,t=!1){return function(e,i){let r;if(t){const o=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,s=e.getDate();r=1+Math.floor((s+o)/7)}else{const o=LS(e),s=function zN(n){const t=H1(n,0,1).getDay();return H1(n,0,1+(t<=4?4:11)-t)}(o.getFullYear()),a=o.getTime()-s.getTime();r=1+Math.round(a/6048e5)}return pl(r,n,Pa(i,En.MinusSign))}}function G1(n,t=!1){return function(e,i){return pl(LS(e).getFullYear(),n,Pa(i,En.MinusSign),t)}}const y2={};function zS(n,t){n=n.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(e)?t:e}function HS(n){return n instanceof Date&&!isNaN(n.valueOf())}let ir=(()=>{class n{constructor(e,i,r,o){this._iterableDiffers=e,this._keyValueDiffers=i,this._ngEl=r,this._renderer=o,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(V_(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(i=>this._toggleClass(i.key,i.currentValue)),e.forEachChangedItem(i=>this._toggleClass(i.key,i.currentValue)),e.forEachRemovedItem(i=>{i.previousValue&&this._toggleClass(i.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(i=>{if("string"!=typeof i.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${ui(i.item)}`);this._toggleClass(i.item,!0)}),e.forEachRemovedItem(i=>this._toggleClass(i.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(i=>this._toggleClass(i,!0)):Object.keys(e).forEach(i=>this._toggleClass(i,!!e[i])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(i=>this._toggleClass(i,!1)):Object.keys(e).forEach(i=>this._toggleClass(i,!1)))}_toggleClass(e,i){(e=e.trim())&&e.split(/\s+/g).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return n.\u0275fac=function(e){return new(e||n)(Be(N1),Be(im),Be(fi),Be(Gu))},n.\u0275dir=nn({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),n})();class o6{constructor(t,e,i,r){this.$implicit=t,this.ngForOf=e,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let si=(()=>{class n{constructor(e,i,r){this._viewContainer=e,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const i=this._viewContainer;e.forEachOperation((r,o,s)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new o6(r.item,this._ngForOf,-1,-1),null===s?void 0:s);else if(null==s)i.remove(null===o?void 0:o);else if(null!==o){const a=i.get(o);i.move(a,s),GS(a,r)}});for(let r=0,o=i.length;r<o;r++){const a=i.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{GS(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,i){return!0}}return n.\u0275fac=function(e){return new(e||n)(Be(ds),Be(Ei),Be(N1))},n.\u0275dir=nn({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),n})();function GS(n,t){n.context.$implicit=t.item}let Sn=(()=>{class n{constructor(e,i){this._viewContainer=e,this._context=new s6,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){qS("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){qS("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,i){return!0}}return n.\u0275fac=function(e){return new(e||n)(Be(ds),Be(Ei))},n.\u0275dir=nn({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class s6{constructor(){this.$implicit=null,this.ngIf=null}}function qS(n,t){if(t&&!t.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${ui(t)}'.`)}class S2{constructor(t,e){this._viewContainerRef=t,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(t){t&&!this._created?this.create():!t&&this._created&&this.destroy()}}let tc=(()=>{class n{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(e)}_matchCase(e){const i=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(e){if(this._defaultViews&&e!==this._defaultUsed){this._defaultUsed=e;for(let i=0;i<this._defaultViews.length;i++)this._defaultViews[i].enforceState(e)}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=nn({type:n,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),n})(),Wu=(()=>{class n{constructor(e,i,r){this.ngSwitch=r,r._addCase(),this._view=new S2(e,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return n.\u0275fac=function(e){return new(e||n)(Be(ds),Be(Ei),Be(tc,9))},n.\u0275dir=nn({type:n,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),n})(),gf=(()=>{class n{constructor(e,i,r){r._addDefault(new S2(e,i))}}return n.\u0275fac=function(e){return new(e||n)(Be(ds),Be(Ei),Be(tc,9))},n.\u0275dir=nn({type:n,selectors:[["","ngSwitchDefault",""]]}),n})(),Co=(()=>{class n{constructor(e,i,r){this._ngEl=e,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,i){const[r,o]=e.split(".");null!=(i=null!=i&&o?`${i}${o}`:i)?this._renderer.setStyle(this._ngEl.nativeElement,r,i):this._renderer.removeStyle(this._ngEl.nativeElement,r)}_applyChanges(e){e.forEachRemovedItem(i=>this._setStyle(i.key,null)),e.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),e.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}}return n.\u0275fac=function(e){return new(e||n)(Be(fi),Be(im),Be(Gu))},n.\u0275dir=nn({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),n})(),Ra=(()=>{class n{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}ngOnChanges(e){if(e.ngTemplateOutlet){const i=this._viewContainerRef;this._viewRef&&i.remove(i.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?i.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&e.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return n.\u0275fac=function(e){return new(e||n)(Be(ds))},n.\u0275dir=nn({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[br]}),n})();const m6=new ei("DATE_PIPE_DEFAULT_TIMEZONE");let D2=(()=>{class n{constructor(e,i){this.locale=e,this.defaultTimezone=i}transform(e,i="mediumDate",r,o){var s;if(null==e||""===e||e!=e)return null;try{return RN(e,i,o||this.locale,null!==(s=null!=r?r:this.defaultTimezone)&&void 0!==s?s:void 0)}catch(a){throw function gl(n,t){return new jt(2100,"")}()}}}return n.\u0275fac=function(e){return new(e||n)(Be(qu,16),Be(m6,24))},n.\u0275pipe=jr({name:"date",type:n,pure:!0}),n})(),M2=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ns({type:n}),n.\u0275inj=ts({}),n})();const YS="browser";class A2 extends class F6 extends class mN{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function _N(n){O1||(O1=n)}(new A2)}onAndCancel(t,e,i){return t.addEventListener(e,i,!1),()=>{t.removeEventListener(e,i,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function R6(){return sm=sm||document.querySelector("base"),sm?sm.getAttribute("href"):null}();return null==e?null:function N6(n){W1=W1||document.createElement("a"),W1.setAttribute("href",n);const t=W1.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){sm=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return function i6(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const i=e.indexOf("="),[r,o]=-1==i?[e,""]:[e.slice(0,i),e.slice(i+1)];if(r.trim()===t)return decodeURIComponent(o)}return null}(document.cookie,t)}}let W1,sm=null;const XS=new ei("TRANSITION_ID"),B6=[{provide:dS,useFactory:function O6(n,t,e){return()=>{e.get(s2).donePromise.then(()=>{const i=pf(),r=t.querySelectorAll(`style[ng-transition="${n}"]`);for(let o=0;o<r.length;o++)i.remove(r[o])})}},deps:[XS,hs,Ne],multi:!0}];class P2{static init(){!function jR(n){f2=n}(new P2)}addToWindow(t){wi.getAngularTestability=(i,r=!0)=>{const o=t.findTestabilityInTree(i,r);if(null==o)throw new Error("Could not find testability for element.");return o},wi.getAllAngularTestabilities=()=>t.getAllTestabilities(),wi.getAllAngularRootElements=()=>t.getAllRootElements(),wi.frameworkStabilizers||(wi.frameworkStabilizers=[]),wi.frameworkStabilizers.push(i=>{const r=wi.getAllAngularTestabilities();let o=r.length,s=!1;const a=function(g){s=s||g,o--,0==o&&i(s)};r.forEach(function(g){g.whenStable(a)})})}findTestabilityInTree(t,e,i){if(null==e)return null;const r=t.getTestability(e);return null!=r?r:i?pf().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null}}let L6=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();const Z1=new ei("EventManagerPlugins");let Y1=(()=>{class n{constructor(e,i){this._zone=i,this._eventNameToPlugin=new Map,e.forEach(r=>r.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,i,r){return this._findPluginFor(i).addEventListener(e,i,r)}addGlobalEventListener(e,i,r){return this._findPluginFor(i).addGlobalEventListener(e,i,r)}getZone(){return this._zone}_findPluginFor(e){const i=this._eventNameToPlugin.get(e);if(i)return i;const r=this._plugins;for(let o=0;o<r.length;o++){const s=r[o];if(s.supports(e))return this._eventNameToPlugin.set(e,s),s}throw new Error(`No event manager plugin found for event ${e}`)}}return n.\u0275fac=function(e){return new(e||n)(In(Z1),In(An))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();class QS{constructor(t){this._doc=t}addGlobalEventListener(t,e,i){const r=pf().getGlobalEventTarget(this._doc,t);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,i)}}let JS=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(e){const i=new Set;e.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})(),am=(()=>{class n extends JS{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,i,r){e.forEach(o=>{const s=this._doc.createElement("style");s.textContent=o,r.push(i.appendChild(s))})}addHost(e){const i=[];this._addStylesToHost(this._stylesSet,e,i),this._hostNodes.set(e,i)}removeHost(e){const i=this._hostNodes.get(e);i&&i.forEach(eD),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(e,r,i)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(eD))}}return n.\u0275fac=function(e){return new(e||n)(In(hs))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();function eD(n){pf().remove(n)}const F2={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},R2=/%COMP%/g;function K1(n,t,e){for(let i=0;i<t.length;i++){let r=t[i];Array.isArray(r)?K1(n,r,e):(r=r.replace(R2,n),e.push(r))}return e}function iD(n){return t=>{if("__ngUnwrap__"===t)return n;!1===n(t)&&(t.preventDefault(),t.returnValue=!1)}}let X1=(()=>{class n{constructor(e,i,r){this.eventManager=e,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new N2(e)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;switch(i.encapsulation){case ws.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new G6(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(e),r}case 1:case ws.ShadowDom:return new q6(this.eventManager,this.sharedStylesHost,e,i);default:if(!this.rendererByCompId.has(i.id)){const r=K1(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(e){return new(e||n)(In(Y1),In(am),In(nm))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();class N2{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?document.createElementNS(F2[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,i){t&&t.insertBefore(e,i)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let i="string"==typeof t?document.querySelector(t):t;if(!i)throw new Error(`The selector "${t}" did not match any elements`);return e||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,i,r){if(r){e=r+":"+e;const o=F2[r];o?t.setAttributeNS(o,e,i):t.setAttribute(e,i)}else t.setAttribute(e,i)}removeAttribute(t,e,i){if(i){const r=F2[i];r?t.removeAttributeNS(r,e):t.removeAttribute(`${i}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,i,r){r&(as.DashCase|as.Important)?t.style.setProperty(e,i,r&as.Important?"important":""):t.style[e]=i}removeStyle(t,e,i){i&as.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,i){t[e]=i}setValue(t,e){t.nodeValue=e}listen(t,e,i){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,iD(i)):this.eventManager.addEventListener(t,e,iD(i))}}class G6 extends N2{constructor(t,e,i,r){super(t),this.component=i;const o=K1(r+"-"+i.id,i.styles,[]);e.addStyles(o),this.contentAttr=function V6(n){return"_ngcontent-%COMP%".replace(R2,n)}(r+"-"+i.id),this.hostAttr=function U6(n){return"_nghost-%COMP%".replace(R2,n)}(r+"-"+i.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const i=super.createElement(t,e);return super.setAttribute(i,this.contentAttr,""),i}}class q6 extends N2{constructor(t,e,i,r){super(t),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const o=K1(r.id,r.styles,[]);for(let s=0;s<o.length;s++){const a=document.createElement("style");a.textContent=o[s],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,i){return super.insertBefore(this.nodeOrShadowRoot(t),e,i)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let W6=(()=>{class n extends QS{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,r){return e.addEventListener(i,r,!1),()=>this.removeEventListener(e,i,r)}removeEventListener(e,i,r){return e.removeEventListener(i,r)}}return n.\u0275fac=function(e){return new(e||n)(In(hs))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();const oD=["alt","control","meta","shift"],Y6={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},sD={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},K6={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let X6=(()=>{class n extends QS{constructor(e){super(e)}supports(e){return null!=n.parseEventName(e)}addEventListener(e,i,r){const o=n.parseEventName(i),s=n.eventCallback(o.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>pf().onAndCancel(e,o.domEventName,s))}static parseEventName(e){const i=e.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const o=n._normalizeKey(i.pop());let s="";if(oD.forEach(g=>{const w=i.indexOf(g);w>-1&&(i.splice(w,1),s+=g+".")}),s+=o,0!=i.length||0===o.length)return null;const a={};return a.domEventName=r,a.fullKey=s,a}static getEventFullKey(e){let i="",r=function Q6(n){let t=n.key;if(null==t){if(t=n.keyIdentifier,null==t)return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===n.location&&sD.hasOwnProperty(t)&&(t=sD[t]))}return Y6[t]||t}(e);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),oD.forEach(o=>{o!=r&&K6[o](e)&&(i+=o+".")}),i+=r,i}static eventCallback(e,i,r){return o=>{n.getEventFullKey(o)===e&&r.runGuarded(()=>i(o))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return n.\u0275fac=function(e){return new(e||n)(In(hs))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();const nO=$S(hN,"browser",[{provide:P1,useValue:YS},{provide:hS,useValue:function J6(){A2.makeCurrent(),P2.init()},multi:!0},{provide:hs,useFactory:function tO(){return function kb(n){eh=n}(document),document},deps:[]}]),iO=[{provide:L_,useValue:"root"},{provide:Jd,useFactory:function eO(){return new Jd},deps:[]},{provide:Z1,useClass:W6,multi:!0,deps:[hs,An,P1]},{provide:Z1,useClass:X6,multi:!0,deps:[hs]},{provide:X1,useClass:X1,deps:[Y1,am,nm]},{provide:X_,useExisting:X1},{provide:JS,useExisting:am},{provide:am,useClass:am,deps:[hs]},{provide:d2,useClass:d2,deps:[An]},{provide:Y1,useClass:Y1,deps:[Z1,An]},{provide:class P6{},useClass:L6,deps:[]}];let aD=(()=>{class n{constructor(e){if(e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:n,providers:[{provide:nm,useValue:e.appId},{provide:XS,useExisting:nm},B6]}}}return n.\u0275fac=function(e){return new(e||n)(In(n,12))},n.\u0275mod=ns({type:n}),n.\u0275inj=ts({providers:iO,imports:[M2,pN]}),n})();"undefined"!=typeof window&&window;let Q1=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:function(e){let i=null;return i=e?new(e||n):In(uD),i},providedIn:"root"}),n})(),uD=(()=>{class n extends Q1{constructor(e){super(),this._doc=e}sanitize(e,i){if(null==i)return null;switch(e){case ji.NONE:return i;case ji.HTML:return Ta(i,"HTML")?ss(i):l$(this._doc,String(i)).toString();case ji.STYLE:return Ta(i,"Style")?ss(i):i;case ji.SCRIPT:if(Ta(i,"Script"))return ss(i);throw new Error("unsafe value used in a script context");case ji.URL:return K0(i),Ta(i,"URL")?ss(i):Vo(String(i));case ji.RESOURCE_URL:if(Ta(i,"ResourceURL"))return ss(i);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return function iy(n){return new ty(n)}(e)}bypassSecurityTrustStyle(e){return function X0(n){return new ny(n)}(e)}bypassSecurityTrustScript(e){return function Q0(n){return new Yd(n)}(e)}bypassSecurityTrustUrl(e){return function ry(n){return new Z0(n)}(e)}bypassSecurityTrustResourceUrl(e){return function Og(n){return new Y0(n)}(e)}}return n.\u0275fac=function(e){return new(e||n)(In(hs))},n.\u0275prov=Tn({token:n,factory:function(e){let i=null;return i=e?new e:function hO(n){return new uD(n.get(hs))}(In(Ne)),i},providedIn:"root"}),n})();Ce(5386);const{isArray:pO}=Array,{getPrototypeOf:gO,prototype:_O,keys:mO}=Object;function dD(n){if(1===n.length){const t=n[0];if(pO(t))return{args:t,keys:null};if(function $O(n){return n&&"object"==typeof n&&gO(n)===_O}(t)){const e=mO(t);return{args:e.map(i=>t[i]),keys:e}}}return{args:n,keys:null}}const{isArray:vO}=Array;function lm(n){return ae(t=>function bO(n,t){return vO(t)?n(...t):n(t)}(n,t))}function fD(n,t){return n.reduce((e,i,r)=>(e[i]=t[r],e),{})}let hD=(()=>{class n{constructor(e,i){this._renderer=e,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return n.\u0275fac=function(e){return new(e||n)(Be(Gu),Be(fi))},n.\u0275dir=nn({type:n}),n})(),_f=(()=>{class n extends hD{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Fr(n)))(i||n)}}(),n.\u0275dir=nn({type:n,features:[Li]}),n})();const _l=new ei("NgValueAccessor"),CO={provide:_l,useExisting:oi(()=>ra),multi:!0};let ra=(()=>{class n extends _f{writeValue(e){this.setProperty("checked",e)}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Fr(n)))(i||n)}}(),n.\u0275dir=nn({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,i){1&e&&Re("change",function(o){return i.onChange(o.target.checked)})("blur",function(){return i.onTouched()})},features:[Xi([CO]),Li]}),n})();const xO={provide:_l,useExisting:oi(()=>Fi),multi:!0},EO=new ei("CompositionEventMode");let Fi=(()=>{class n extends hD{constructor(e,i,r){super(e,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function wO(){const n=pf()?pf().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(e){this.setProperty("value",null==e?"":e)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return n.\u0275fac=function(e){return new(e||n)(Be(Gu),Be(fi),Be(EO,8))},n.\u0275dir=nn({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,i){1&e&&Re("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},features:[Xi([xO]),Li]}),n})();function Yu(n){return null==n||0===n.length}function pD(n){return null!=n&&"number"==typeof n.length}const Zo=new ei("NgValidators"),Ku=new ei("NgAsyncValidators");function mD(n){return Yu(n.value)?{required:!0}:null}function J1(n){return null}function xD(n){return null!=n}function wD(n){const t=v1(n)?mo(n):n;return hT(t),t}function ED(n){let t={};return n.forEach(e=>{t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function TD(n,t){return t.map(e=>e(n))}function SD(n){return n.map(t=>function SO(n){return!n.validate}(t)?t:e=>t.validate(e))}function B2(n){return null!=n?function DD(n){if(!n)return null;const t=n.filter(xD);return 0==t.length?null:function(e){return ED(TD(e,t))}}(SD(n)):null}function L2(n){return null!=n?function ID(n){if(!n)return null;const t=n.filter(xD);return 0==t.length?null:function(e){return function yO(...n){const t=Il(n),{args:e,keys:i}=dD(n),r=new O(o=>{const{length:s}=e;if(!s)return void o.complete();const a=new Array(s);let g=s,w=s;for(let W=0;W<s;W++){let ve=!1;Mo(e[W]).subscribe($(o,me=>{ve||(ve=!0,w--),a[W]=me},()=>g--,void 0,()=>{(!g||!ve)&&(w||o.next(i?fD(i,a):a),o.complete())}))}});return t?r.pipe(lm(t)):r}(TD(e,t).map(wD)).pipe(ae(ED))}}(SD(n)):null}function kD(n,t){return null===n?[t]:Array.isArray(n)?[...n,t]:[n,t]}function z2(n){return n?Array.isArray(n)?n:[n]:[]}function ev(n,t){return Array.isArray(n)?n.includes(t):n===t}function PD(n,t){const e=z2(t);return z2(n).forEach(r=>{ev(e,r)||e.push(r)}),e}function FD(n,t){return z2(t).filter(e=>!ev(n,e))}class RD{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=B2(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=L2(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class Xu extends RD{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class ps extends RD{get formDirective(){return null}get path(){return null}}class ND{constructor(t){this._cd=t}is(t){var e,i,r;return"submitted"===t?!!(null===(e=this._cd)||void 0===e?void 0:e.submitted):!!(null===(r=null===(i=this._cd)||void 0===i?void 0:i.control)||void 0===r?void 0:r[t])}}let Ti=(()=>{class n extends ND{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(Be(Xu,2))},n.\u0275dir=nn({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,i){2&e&&Aa("ng-untouched",i.is("untouched"))("ng-touched",i.is("touched"))("ng-pristine",i.is("pristine"))("ng-dirty",i.is("dirty"))("ng-valid",i.is("valid"))("ng-invalid",i.is("invalid"))("ng-pending",i.is("pending"))},features:[Li]}),n})(),gs=(()=>{class n extends ND{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(Be(ps,10))},n.\u0275dir=nn({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,i){2&e&&Aa("ng-untouched",i.is("untouched"))("ng-touched",i.is("touched"))("ng-pristine",i.is("pristine"))("ng-dirty",i.is("dirty"))("ng-valid",i.is("valid"))("ng-invalid",i.is("invalid"))("ng-pending",i.is("pending"))("ng-submitted",i.is("submitted"))},features:[Li]}),n})();function cm(n,t){U2(n,t),t.valueAccessor.writeValue(n.value),function RO(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&BD(n,t)})}(n,t),function OO(n,t){const e=(i,r)=>{t.valueAccessor.writeValue(i),r&&t.viewToModelUpdate(i)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}(n,t),function NO(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&BD(n,t),"submit"!==n.updateOn&&n.markAsTouched()})}(n,t),function FO(n,t){if(t.valueAccessor.setDisabledState){const e=i=>{t.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}(n,t)}function rv(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function U2(n,t){const e=function MD(n){return n._rawValidators}(n);null!==t.validator?n.setValidators(kD(e,t.validator)):"function"==typeof e&&n.setValidators([e]);const i=function AD(n){return n._rawAsyncValidators}(n);null!==t.asyncValidator?n.setAsyncValidators(kD(i,t.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();rv(t._rawValidators,r),rv(t._rawAsyncValidators,r)}function BD(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function q2(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}const um="VALID",sv="INVALID",cp="PENDING",dm="DISABLED";function Z2(n){return(av(n)?n.validators:n)||null}function VD(n){return Array.isArray(n)?B2(n):n||null}function Y2(n,t){return(av(t)?t.asyncValidators:n)||null}function UD(n){return Array.isArray(n)?L2(n):n||null}function av(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}const K2=n=>n instanceof Q2;function GD(n){return(n=>n instanceof ZD)(n)?n.value:n.getRawValue()}function qD(n,t){const e=K2(n),i=n.controls;if(!(e?Object.keys(i):i).length)throw new jt(1e3,"");if(!i[t])throw new jt(1001,"")}function WD(n,t){K2(n),n._forEachChild((i,r)=>{if(void 0===t[r])throw new jt(1002,"")})}class X2{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=VD(this._rawValidators),this._composedAsyncValidatorFn=UD(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===um}get invalid(){return this.status===sv}get pending(){return this.status==cp}get disabled(){return this.status===dm}get enabled(){return this.status!==dm}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=VD(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=UD(t)}addValidators(t){this.setValidators(PD(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(PD(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(FD(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(FD(t,this._rawAsyncValidators))}hasValidator(t){return ev(this._rawValidators,t)}hasAsyncValidator(t){return ev(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=cp,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=dm,this.errors=null,this._forEachChild(i=>{i.disable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(i=>i(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=um,this._forEachChild(i=>{i.enable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===um||this.status===cp)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?dm:um}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=cp,this._hasOwnPendingAsyncValidator=!0;const e=wD(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){return function HO(n,t,e){if(null==t||(Array.isArray(t)||(t=t.split(e)),Array.isArray(t)&&0===t.length))return null;let i=n;return t.forEach(r=>{i=K2(i)?i.controls.hasOwnProperty(r)?i.controls[r]:null:(n=>n instanceof UO)(i)&&i.at(r)||null}),i}(this,t,".")}getError(t,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new Xt,this.statusChanges=new Xt}_calculateStatus(){return this._allControlsDisabled()?dm:this.errors?sv:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(cp)?cp:this._anyControlsHaveStatus(sv)?sv:um}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){av(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class ZD extends X2{constructor(t=null,e,i){super(Z2(e),Y2(i,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),av(e)&&e.initialValueIsDefault&&(this.defaultValue=this._isBoxedValue(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){q2(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){q2(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class Q2 extends X2{constructor(t,e,i){super(Z2(e),Y2(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,i={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){WD(this,t),Object.keys(t).forEach(i=>{qD(this,i),this.controls[i].setValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(i=>{this.controls[i]&&this.controls[i].patchValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((i,r)=>{i.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,i)=>(t[i]=GD(e),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,i)=>!!i._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const i=this.controls[e];i&&t(i,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const e of Object.keys(this.controls)){const i=this.controls[e];if(this.contains(e)&&t(i))return!0}return!1}_reduceValue(){return this._reduceChildren({},(t,e,i)=>((e.enabled||this.disabled)&&(t[i]=e.value),t))}_reduceChildren(t,e){let i=t;return this._forEachChild((r,o)=>{i=e(i,r,o)}),i}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class UO extends X2{constructor(t,e,i){super(Z2(e),Y2(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[t]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,i={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){WD(this,t),t.forEach((i,r)=>{qD(this,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(t.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((i,r)=>{i.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>GD(t))}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_syncPendingControls(){let t=this.controls.reduce((e,i)=>!!i._syncPendingControls()||e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,i)=>{t(e,i)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}const jO={provide:ps,useExisting:oi(()=>xo)},fm=(()=>Promise.resolve(null))();let xo=(()=>{class n extends ps{constructor(e,i){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new Xt,this.form=new Q2({},B2(e),L2(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){fm.then(()=>{const i=this._findContainer(e.path);e.control=i.registerControl(e.name,e.control),cm(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){fm.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){fm.then(()=>{const i=this._findContainer(e.path),r=new Q2({});(function LD(n,t){U2(n,t)})(r,e),i.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){fm.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,i){fm.then(()=>{this.form.get(e.path).setValue(i)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,function HD(n,t){n._syncPendingControls(),t.forEach(e=>{const i=e.control;"submit"===i.updateOn&&i._pendingChange&&(e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(e),!1}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return n.\u0275fac=function(e){return new(e||n)(Be(Zo,10),Be(Ku,10))},n.\u0275dir=nn({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,i){1&e&&Re("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Xi([jO]),Li]}),n})();const qO={provide:Xu,useExisting:oi(()=>yi)},XD=(()=>Promise.resolve(null))();let yi=(()=>{class n extends Xu{constructor(e,i,r,o,s){super(),this._changeDetectorRef=s,this.control=new ZD,this._registered=!1,this.update=new Xt,this._parent=e,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function G2(n,t){if(!t)return null;let e,i,r;return Array.isArray(t),t.forEach(o=>{o.constructor===Fi?e=o:function zO(n){return Object.getPrototypeOf(n.constructor)===_f}(o)?i=o:r=o}),r||i||e||null}(0,o)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),function j2(n,t){if(!n.hasOwnProperty("model"))return!1;const e=n.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){cm(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){XD.then(()=>{var i;this.control.setValue(e,{emitViewToModelChange:!1}),null===(i=this._changeDetectorRef)||void 0===i||i.markForCheck()})}_updateDisabled(e){const i=e.isDisabled.currentValue,r=""===i||i&&"false"!==i;XD.then(()=>{var o;r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),null===(o=this._changeDetectorRef)||void 0===o||o.markForCheck()})}_getPath(e){return this._parent?function nv(n,t){return[...t.path,n]}(e,this._parent):[e]}}return n.\u0275fac=function(e){return new(e||n)(Be(ps,9),Be(Zo,10),Be(Ku,10),Be(_l,10),Be(bi,8))},n.\u0275dir=nn({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Xi([qO]),Li,br]}),n})(),_s=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=nn({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})();const WO={provide:_l,useExisting:oi(()=>ms),multi:!0};let ms=(()=>{class n extends _f{writeValue(e){this.setProperty("value",null==e?"":e)}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Fr(n)))(i||n)}}(),n.\u0275dir=nn({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,i){1&e&&Re("input",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},features:[Xi([WO]),Li]}),n})();const ZO={provide:_l,useExisting:oi(()=>Qu),multi:!0};let QD=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ns({type:n}),n.\u0275inj=ts({}),n})(),YO=(()=>{class n{constructor(){this._accessors=[]}add(e,i){this._accessors.push([e,i])}remove(e){for(let i=this._accessors.length-1;i>=0;--i)if(this._accessors[i][1]===e)return void this._accessors.splice(i,1)}select(e){this._accessors.forEach(i=>{this._isSameGroup(i,e)&&i[1]!==e&&i[1].fireUncheck(e.value)})}_isSameGroup(e,i){return!!e[0].control&&e[0]._parent===i._control._parent&&e[1].name===i.name}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac,providedIn:QD}),n})(),Qu=(()=>{class n extends _f{constructor(e,i,r,o){super(e,i),this._registry=r,this._injector=o,this.onChange=()=>{}}ngOnInit(){this._control=this._injector.get(Xu),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(e){this._state=e===this.value,this.setProperty("checked",this._state)}registerOnChange(e){this._fn=e,this.onChange=()=>{e(this.value),this._registry.select(this)}}fireUncheck(e){this.writeValue(e)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return n.\u0275fac=function(e){return new(e||n)(Be(Gu),Be(fi),Be(YO),Be(Ne))},n.\u0275dir=nn({type:n,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(e,i){1&e&&Re("change",function(){return i.onChange()})("blur",function(){return i.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[Xi([ZO]),Li]}),n})();const KO={provide:_l,useExisting:oi(()=>oa),multi:!0};let oa=(()=>{class n extends _f{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Fr(n)))(i||n)}}(),n.\u0275dir=nn({type:n,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,i){1&e&&Re("change",function(o){return i.onChange(o.target.value)})("input",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},features:[Xi([KO]),Li]}),n})();const n8={provide:_l,useExisting:oi(()=>nc),multi:!0};function iI(n,t){return null==n?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let nc=(()=>{class n extends _f{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const r=iI(this._getOptionId(e),e);this.setProperty("value",r)}registerOnChange(e){this.onChange=i=>{this.value=this._getOptionValue(i),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i),e))return i;return null}_getOptionValue(e){const i=function i8(n){return n.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i):e}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Fr(n)))(i||n)}}(),n.\u0275dir=nn({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,i){1&e&&Re("change",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[Xi([n8]),Li]}),n})(),ic=(()=>{class n{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(iI(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(Be(fi),Be(Gu),Be(nc,9))},n.\u0275dir=nn({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();const r8={provide:_l,useExisting:oi(()=>nx),multi:!0};function rI(n,t){return null==n?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let nx=(()=>{class n extends _f{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let i;if(this.value=e,Array.isArray(e)){const r=e.map(o=>this._getOptionId(o));i=(o,s)=>{o._setSelected(r.indexOf(s.toString())>-1)}}else i=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(e){this.onChange=i=>{const r=[],o=i.selectedOptions;if(void 0!==o){const s=o;for(let a=0;a<s.length;a++){const w=this._getOptionValue(s[a].value);r.push(w)}}else{const s=i.options;for(let a=0;a<s.length;a++){const g=s[a];if(g.selected){const w=this._getOptionValue(g.value);r.push(w)}}}this.value=r,e(r)}}_registerOption(e){const i=(this._idCounter++).toString();return this._optionMap.set(i,e),i}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i)._value,e))return i;return null}_getOptionValue(e){const i=function o8(n){return n.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i)._value:e}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Fr(n)))(i||n)}}(),n.\u0275dir=nn({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,i){1&e&&Re("change",function(o){return i.onChange(o.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[Xi([r8]),Li]}),n})(),rc=(()=>{class n{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(rI(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(rI(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(Be(fi),Be(Gu),Be(nx,9))},n.\u0275dir=nn({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();function oI(n){return"number"==typeof n?n:parseInt(n,10)}function sI(n){return"number"==typeof n?n:parseFloat(n)}let mf=(()=>{class n{constructor(){this._validator=J1}ngOnChanges(e){if(this.inputName in e){const i=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):J1,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=nn({type:n,features:[br]}),n})();const a8={provide:Zo,useExisting:oi(()=>Ju),multi:!0};let Ju=(()=>{class n extends mf{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=e=>sI(e),this.createValidator=e=>function _D(n){return t=>{if(Yu(t.value)||Yu(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e>n?{max:{max:n,actual:t.value}}:null}}(e)}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Fr(n)))(i||n)}}(),n.\u0275dir=nn({type:n,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Yt("max",i._enabled?i.max:null)},inputs:{max:"max"},features:[Xi([a8]),Li]}),n})();const l8={provide:Zo,useExisting:oi(()=>Vc),multi:!0};let Vc=(()=>{class n extends mf{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=e=>sI(e),this.createValidator=e=>function gD(n){return t=>{if(Yu(t.value)||Yu(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<n?{min:{min:n,actual:t.value}}:null}}(e)}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Fr(n)))(i||n)}}(),n.\u0275dir=nn({type:n,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Yt("min",i._enabled?i.min:null)},inputs:{min:"min"},features:[Xi([l8]),Li]}),n})();const c8={provide:Zo,useExisting:oi(()=>lv),multi:!0};let lv=(()=>{class n extends mf{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=e=>function s8(n){return null!=n&&!1!==n&&"false"!=`${n}`}(e),this.createValidator=e=>mD}enabled(e){return e}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Fr(n)))(i||n)}}(),n.\u0275dir=nn({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,i){2&e&&Yt("required",i._enabled?"":null)},inputs:{required:"required"},features:[Xi([c8]),Li]}),n})();const f8={provide:Zo,useExisting:oi(()=>ix),multi:!0};let ix=(()=>{class n extends mf{constructor(){super(...arguments),this.inputName="minlength",this.normalizeInput=e=>oI(e),this.createValidator=e=>function bD(n){return t=>Yu(t.value)||!pD(t.value)?null:t.value.length<n?{minlength:{requiredLength:n,actualLength:t.value.length}}:null}(e)}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Fr(n)))(i||n)}}(),n.\u0275dir=nn({type:n,selectors:[["","minlength","","formControlName",""],["","minlength","","formControl",""],["","minlength","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Yt("minlength",i._enabled?i.minlength:null)},inputs:{minlength:"minlength"},features:[Xi([f8]),Li]}),n})();const h8={provide:Zo,useExisting:oi(()=>rx),multi:!0};let rx=(()=>{class n extends mf{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>oI(e),this.createValidator=e=>function yD(n){return t=>pD(t.value)&&t.value.length>n?{maxlength:{requiredLength:n,actualLength:t.value.length}}:null}(e)}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Fr(n)))(i||n)}}(),n.\u0275dir=nn({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Yt("maxlength",i._enabled?i.maxlength:null)},inputs:{maxlength:"maxlength"},features:[Xi([h8]),Li]}),n})(),g8=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ns({type:n}),n.\u0275inj=ts({imports:[[QD]]}),n})(),_8=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ns({type:n}),n.\u0275inj=ts({imports:[g8]}),n})();class uI{}const Uc="*";function Na(n,t){return{type:7,name:n,definitions:t,options:{}}}function Br(n,t=null){return{type:4,styles:t,timings:n}}function dI(n,t=null){return{type:2,steps:n,options:t}}function mn(n){return{type:6,styles:n,offset:null}}function ox(n,t,e){return{type:0,name:n,styles:t,options:e}}function Ls(n){return{type:5,steps:n}}function Lr(n,t,e=null){return{type:1,expr:n,animation:t,options:e}}function fI(n){Promise.resolve(null).then(n)}class hm{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){fI(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class hI{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,i=0,r=0;const o=this.players.length;0==o?fI(()=>this._onFinish()):this.players.forEach(s=>{s.onDone(()=>{++e==o&&this._onFinish()}),s.onDestroy(()=>{++i==o&&this._onDestroy()}),s.onStart(()=>{++r==o&&this._onStart()})}),this.totalTime=this.players.reduce((s,a)=>Math.max(s,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,e/i.totalTime):1;i.setPosition(r)})}getPosition(){const t=this.players.reduce((e,i)=>null===e||i.totalTime>e.totalTime?i:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}const ri=!1;function pI(n){return new jt(3e3,ri)}function X8(){return"undefined"!=typeof window&&void 0!==window.document}function ax(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function ed(n){switch(n.length){case 0:return new hm;case 1:return n[0];default:return new hI(n)}}function gI(n,t,e,i,r={},o={}){const s=[],a=[];let g=-1,w=null;if(i.forEach(W=>{const ve=W.offset,me=ve==g,Se=me&&w||{};Object.keys(W).forEach(Oe=>{let Ve=Oe,We=W[Oe];if("offset"!==Oe)switch(Ve=t.normalizePropertyName(Ve,s),We){case"!":We=r[Oe];break;case Uc:We=o[Oe];break;default:We=t.normalizeStyleValue(Oe,Ve,We,s)}Se[Ve]=We}),me||a.push(Se),w=Se,g=ve}),s.length)throw function z8(n){return new jt(3502,ri)}();return a}function lx(n,t,e,i){switch(t){case"start":n.onStart(()=>i(e&&cx(e,"start",n)));break;case"done":n.onDone(()=>i(e&&cx(e,"done",n)));break;case"destroy":n.onDestroy(()=>i(e&&cx(e,"destroy",n)))}}function cx(n,t,e){const i=e.totalTime,o=ux(n.element,n.triggerName,n.fromState,n.toState,t||n.phaseName,null==i?n.totalTime:i,!!e.disabled),s=n._data;return null!=s&&(o._data=s),o}function ux(n,t,e,i,r="",o=0,s){return{element:n,triggerName:t,fromState:e,toState:i,phaseName:r,totalTime:o,disabled:!!s}}function sa(n,t,e){let i;return n instanceof Map?(i=n.get(t),i||n.set(t,i=e)):(i=n[t],i||(i=n[t]=e)),i}function _I(n){const t=n.indexOf(":");return[n.substring(1,t),n.substr(t+1)]}let dx=(n,t)=>!1,mI=(n,t,e)=>[],$I=null;function fx(n){const t=n.parentNode||n.host;return t===$I?null:t}(ax()||"undefined"!=typeof Element)&&(X8()?($I=(()=>document.documentElement)(),dx=(n,t)=>{for(;t;){if(t===n)return!0;t=fx(t)}return!1}):dx=(n,t)=>n.contains(t),mI=(n,t,e)=>{if(e)return Array.from(n.querySelectorAll(t));const i=n.querySelector(t);return i?[i]:[]});let $f=null,vI=!1;function bI(n){$f||($f=function J8(){return"undefined"!=typeof document?document.body:null}()||{},vI=!!$f.style&&"WebkitAppearance"in $f.style);let t=!0;return $f.style&&!function Q8(n){return"ebkit"==n.substring(1,6)}(n)&&(t=n in $f.style,!t&&vI&&(t="Webkit"+n.charAt(0).toUpperCase()+n.substr(1)in $f.style)),t}const yI=dx,CI=mI;let xI=(()=>{class n{validateStyleProperty(e){return bI(e)}matchesElement(e,i){return!1}containsElement(e,i){return yI(e,i)}getParentElement(e){return fx(e)}query(e,i,r){return CI(e,i,r)}computeStyle(e,i,r){return r||""}animate(e,i,r,o,s,a=[],g){return new hm(r,o)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})(),hx=(()=>{class n{}return n.NOOP=new xI,n})();const px="ng-enter",uv="ng-leave",dv="ng-trigger",fv=".ng-trigger",EI="ng-animating",gx=".ng-animating";function vf(n){if("number"==typeof n)return n;const t=n.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:_x(parseFloat(t[1]),t[2])}function _x(n,t){return"s"===t?1e3*n:n}function hv(n,t,e){return n.hasOwnProperty("duration")?n:function nB(n,t,e){let r,o=0,s="";if("string"==typeof n){const a=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return t.push(pI()),{duration:0,delay:0,easing:""};r=_x(parseFloat(a[1]),a[2]);const g=a[3];null!=g&&(o=_x(parseFloat(g),a[4]));const w=a[5];w&&(s=w)}else r=n;if(!e){let a=!1,g=t.length;r<0&&(t.push(function $8(){return new jt(3100,ri)}()),a=!0),o<0&&(t.push(function v8(){return new jt(3101,ri)}()),a=!0),a&&t.splice(g,0,pI())}return{duration:r,delay:o,easing:s}}(n,t,e)}function up(n,t={}){return Object.keys(n).forEach(e=>{t[e]=n[e]}),t}function td(n,t,e={}){if(t)for(let i in n)e[i]=n[i];else up(n,e);return e}function SI(n,t,e){return e?t+":"+e+";":""}function DI(n){let t="";for(let e=0;e<n.style.length;e++){const i=n.style.item(e);t+=SI(0,i,n.style.getPropertyValue(i))}for(const e in n.style)n.style.hasOwnProperty(e)&&!e.startsWith("_")&&(t+=SI(0,oB(e),n.style[e]));n.setAttribute("style",t)}function oc(n,t,e){n.style&&(Object.keys(t).forEach(i=>{const r=$x(i);e&&!e.hasOwnProperty(i)&&(e[i]=n.style[r]),n.style[r]=t[i]}),ax()&&DI(n))}function bf(n,t){n.style&&(Object.keys(t).forEach(e=>{const i=$x(e);n.style[i]=""}),ax()&&DI(n))}function pm(n){return Array.isArray(n)?1==n.length?n[0]:dI(n):n}const mx=new RegExp("{{\\s*(.+?)\\s*}}","g");function II(n){let t=[];if("string"==typeof n){let e;for(;e=mx.exec(n);)t.push(e[1]);mx.lastIndex=0}return t}function pv(n,t,e){const i=n.toString(),r=i.replace(mx,(o,s)=>{let a=t[s];return t.hasOwnProperty(s)||(e.push(function y8(n){return new jt(3003,ri)}()),a=""),a.toString()});return r==i?n:r}function gv(n){const t=[];let e=n.next();for(;!e.done;)t.push(e.value),e=n.next();return t}const rB=/-+([a-z0-9])/g;function $x(n){return n.replace(rB,(...t)=>t[1].toUpperCase())}function oB(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function aa(n,t,e){switch(t.type){case 7:return n.visitTrigger(t,e);case 0:return n.visitState(t,e);case 1:return n.visitTransition(t,e);case 2:return n.visitSequence(t,e);case 3:return n.visitGroup(t,e);case 4:return n.visitAnimate(t,e);case 5:return n.visitKeyframes(t,e);case 6:return n.visitStyle(t,e);case 8:return n.visitReference(t,e);case 9:return n.visitAnimateChild(t,e);case 10:return n.visitAnimateRef(t,e);case 11:return n.visitQuery(t,e);case 12:return n.visitStagger(t,e);default:throw function C8(n){return new jt(3004,ri)}()}}function kI(n,t){return window.getComputedStyle(n)[t]}function dB(n,t){const e=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function fB(n,t,e){if(":"==n[0]){const g=function hB(n,t){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,i)=>parseFloat(i)>parseFloat(e);case":decrement":return(e,i)=>parseFloat(i)<parseFloat(e);default:return t.push(function N8(n){return new jt(3016,ri)}()),"* => *"}}(n,e);if("function"==typeof g)return void t.push(g);n=g}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return e.push(function R8(n){return new jt(3015,ri)}()),t;const r=i[1],o=i[2],s=i[3];t.push(MI(r,s));"<"==o[0]&&!("*"==r&&"*"==s)&&t.push(MI(s,r))}(i,e,t)):e.push(n),e}const vv=new Set(["true","1"]),bv=new Set(["false","0"]);function MI(n,t){const e=vv.has(n)||bv.has(n),i=vv.has(t)||bv.has(t);return(r,o)=>{let s="*"==n||n==r,a="*"==t||t==o;return!s&&e&&"boolean"==typeof r&&(s=r?vv.has(n):bv.has(n)),!a&&i&&"boolean"==typeof o&&(a=o?vv.has(t):bv.has(t)),s&&a}}const pB=new RegExp("s*:selfs*,?","g");function vx(n,t,e,i){return new gB(n).build(t,e,i)}class gB{constructor(t){this._driver=t}build(t,e,i){const r=new $B(e);this._resetContextStyleTimingState(r);const o=aa(this,pm(t),r);return r.unsupportedCSSPropertiesFound.size&&r.unsupportedCSSPropertiesFound.keys(),o}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles={},t.collectedStyles[""]={},t.currentTime=0}visitTrigger(t,e){let i=e.queryCount=0,r=e.depCount=0;const o=[],s=[];return"@"==t.name.charAt(0)&&e.errors.push(function w8(){return new jt(3006,ri)}()),t.definitions.forEach(a=>{if(this._resetContextStyleTimingState(e),0==a.type){const g=a,w=g.name;w.toString().split(/\s*,\s*/).forEach(W=>{g.name=W,o.push(this.visitState(g,e))}),g.name=w}else if(1==a.type){const g=this.visitTransition(a,e);i+=g.queryCount,r+=g.depCount,s.push(g)}else e.errors.push(function E8(){return new jt(3007,ri)}())}),{type:7,name:t.name,states:o,transitions:s,queryCount:i,depCount:r,options:null}}visitState(t,e){const i=this.visitStyle(t.styles,e),r=t.options&&t.options.params||null;if(i.containsDynamicStyles){const o=new Set,s=r||{};i.styles.forEach(a=>{if(yv(a)){const g=a;Object.keys(g).forEach(w=>{II(g[w]).forEach(W=>{s.hasOwnProperty(W)||o.add(W)})})}}),o.size&&(gv(o.values()),e.errors.push(function T8(n,t){return new jt(3008,ri)}()))}return{type:0,name:t.name,style:i,options:r?{params:r}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const i=aa(this,pm(t.animation),e);return{type:1,matchers:dB(t.expr,e.errors),animation:i,queryCount:e.queryCount,depCount:e.depCount,options:yf(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(i=>aa(this,i,e)),options:yf(t.options)}}visitGroup(t,e){const i=e.currentTime;let r=0;const o=t.steps.map(s=>{e.currentTime=i;const a=aa(this,s,e);return r=Math.max(r,e.currentTime),a});return e.currentTime=r,{type:3,steps:o,options:yf(t.options)}}visitAnimate(t,e){const i=function bB(n,t){let e=null;if(n.hasOwnProperty("duration"))e=n;else if("number"==typeof n)return bx(hv(n,t).duration,0,"");const i=n;if(i.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=bx(0,0,"");return o.dynamic=!0,o.strValue=i,o}return e=e||hv(i,t),bx(e.duration,e.delay,e.easing)}(t.timings,e.errors);e.currentAnimateTimings=i;let r,o=t.styles?t.styles:mn({});if(5==o.type)r=this.visitKeyframes(o,e);else{let s=t.styles,a=!1;if(!s){a=!0;const w={};i.easing&&(w.easing=i.easing),s=mn(w)}e.currentTime+=i.duration+i.delay;const g=this.visitStyle(s,e);g.isEmptyStep=a,r=g}return e.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(t,e){const i=this._makeStyleAst(t,e);return this._validateStyleAst(i,e),i}_makeStyleAst(t,e){const i=[];Array.isArray(t.styles)?t.styles.forEach(s=>{"string"==typeof s?s==Uc?i.push(s):e.errors.push(function S8(n){return new jt(3002,ri)}()):i.push(s)}):i.push(t.styles);let r=!1,o=null;return i.forEach(s=>{if(yv(s)){const a=s,g=a.easing;if(g&&(o=g,delete a.easing),!r)for(let w in a)if(a[w].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:i,easing:o,offset:t.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(t,e){const i=e.currentAnimateTimings;let r=e.currentTime,o=e.currentTime;i&&o>0&&(o-=i.duration+i.delay),t.styles.forEach(s=>{"string"!=typeof s&&Object.keys(s).forEach(a=>{if(!this._driver.validateStyleProperty(a))return delete s[a],void e.unsupportedCSSPropertiesFound.add(a);const g=e.collectedStyles[e.currentQuerySelector],w=g[a];let W=!0;w&&(o!=r&&o>=w.startTime&&r<=w.endTime&&(e.errors.push(function D8(n,t,e,i,r){return new jt(3010,ri)}()),W=!1),o=w.startTime),W&&(g[a]={startTime:o,endTime:r}),e.options&&function iB(n,t,e){const i=t.params||{},r=II(n);r.length&&r.forEach(o=>{i.hasOwnProperty(o)||e.push(function b8(n){return new jt(3001,ri)}())})}(s[a],e.options,e.errors)})})}visitKeyframes(t,e){const i={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function I8(){return new jt(3011,ri)}()),i;let o=0;const s=[];let a=!1,g=!1,w=0;const W=t.steps.map(Ze=>{const je=this._makeStyleAst(Ze,e);let ut=null!=je.offset?je.offset:function vB(n){if("string"==typeof n)return null;let t=null;if(Array.isArray(n))n.forEach(e=>{if(yv(e)&&e.hasOwnProperty("offset")){const i=e;t=parseFloat(i.offset),delete i.offset}});else if(yv(n)&&n.hasOwnProperty("offset")){const e=n;t=parseFloat(e.offset),delete e.offset}return t}(je.styles),ot=0;return null!=ut&&(o++,ot=je.offset=ut),g=g||ot<0||ot>1,a=a||ot<w,w=ot,s.push(ot),je});g&&e.errors.push(function k8(){return new jt(3012,ri)}()),a&&e.errors.push(function M8(){return new jt(3200,ri)}());const ve=t.steps.length;let me=0;o>0&&o<ve?e.errors.push(function A8(){return new jt(3202,ri)}()):0==o&&(me=1/(ve-1));const Se=ve-1,Oe=e.currentTime,Ve=e.currentAnimateTimings,We=Ve.duration;return W.forEach((Ze,je)=>{const ut=me>0?je==Se?1:me*je:s[je],ot=ut*We;e.currentTime=Oe+Ve.delay+ot,Ve.duration=ot,this._validateStyleAst(Ze,e),Ze.offset=ut,i.styles.push(Ze)}),i}visitReference(t,e){return{type:8,animation:aa(this,pm(t.animation),e),options:yf(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:yf(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:yf(t.options)}}visitQuery(t,e){const i=e.currentQuerySelector,r=t.options||{};e.queryCount++,e.currentQuery=t;const[o,s]=function _B(n){const t=!!n.split(/\s*,\s*/).find(e=>":self"==e);return t&&(n=n.replace(pB,"")),n=n.replace(/@\*/g,fv).replace(/@\w+/g,e=>fv+"-"+e.substr(1)).replace(/:animating/g,gx),[n,t]}(t.selector);e.currentQuerySelector=i.length?i+" "+o:o,sa(e.collectedStyles,e.currentQuerySelector,{});const a=aa(this,pm(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=i,{type:11,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:s,animation:a,originalSelector:t.selector,options:yf(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function P8(){return new jt(3013,ri)}());const i="full"===t.timings?{duration:0,delay:0,easing:"full"}:hv(t.timings,e.errors,!0);return{type:12,animation:aa(this,pm(t.animation),e),timings:i,options:null}}}class $B{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function yv(n){return!Array.isArray(n)&&"object"==typeof n}function yf(n){return n?(n=up(n)).params&&(n.params=function mB(n){return n?up(n):null}(n.params)):n={},n}function bx(n,t,e){return{duration:n,delay:t,easing:e}}function yx(n,t,e,i,r,o,s=null,a=!1){return{type:1,element:n,keyframes:t,preStyleProps:e,postStyleProps:i,duration:r,delay:o,totalTime:r+o,easing:s,subTimeline:a}}class Cv{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let i=this._map.get(t);i||this._map.set(t,i=[]),i.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const xB=new RegExp(":enter","g"),EB=new RegExp(":leave","g");function Cx(n,t,e,i,r,o={},s={},a,g,w=[]){return(new TB).buildKeyframes(n,t,e,i,r,o,s,a,g,w)}class TB{buildKeyframes(t,e,i,r,o,s,a,g,w,W=[]){w=w||new Cv;const ve=new xx(t,e,w,r,o,W,[]);ve.options=g,ve.currentTimeline.setStyles([s],null,ve.errors,g),aa(this,i,ve);const me=ve.timelines.filter(Se=>Se.containsAnimation());if(Object.keys(a).length){let Se;for(let Oe=me.length-1;Oe>=0;Oe--){const Ve=me[Oe];if(Ve.element===e){Se=Ve;break}}Se&&!Se.allowOnlyTimelineStyles()&&Se.setStyles([a],null,ve.errors,g)}return me.length?me.map(Se=>Se.buildKeyframes()):[yx(e,[],[],[],0,0,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const i=e.subInstructions.get(e.element);if(i){const r=e.createSubContext(t.options),o=e.currentTimeline.currentTime,s=this._visitSubInstructions(i,r,r.options);o!=s&&e.transformIntoNewTimeline(s)}e.previousNode=t}visitAnimateRef(t,e){const i=e.createSubContext(t.options);i.transformIntoNewTimeline(),this.visitReference(t.animation,i),e.transformIntoNewTimeline(i.currentTimeline.currentTime),e.previousNode=t}_visitSubInstructions(t,e,i){let o=e.currentTimeline.currentTime;const s=null!=i.duration?vf(i.duration):null,a=null!=i.delay?vf(i.delay):null;return 0!==s&&t.forEach(g=>{const w=e.appendInstructionToTimeline(g,s,a);o=Math.max(o,w.duration+w.delay)}),o}visitReference(t,e){e.updateOptions(t.options,!0),aa(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const i=e.subContextCount;let r=e;const o=t.options;if(o&&(o.params||o.delay)&&(r=e.createSubContext(o),r.transformIntoNewTimeline(),null!=o.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=xv);const s=vf(o.delay);r.delayNextStep(s)}t.steps.length&&(t.steps.forEach(s=>aa(this,s,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const i=[];let r=e.currentTimeline.currentTime;const o=t.options&&t.options.delay?vf(t.options.delay):0;t.steps.forEach(s=>{const a=e.createSubContext(t.options);o&&a.delayNextStep(o),aa(this,s,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(s=>e.currentTimeline.mergeTimelineCollectedStyles(s)),e.transformIntoNewTimeline(r),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const i=t.strValue;return hv(e.params?pv(i,e.params,e.errors):i,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const i=e.currentAnimateTimings=this._visitTiming(t.timings,e),r=e.currentTimeline;i.delay&&(e.incrementTime(i.delay),r.snapshotCurrentStyles());const o=t.style;5==o.type?this.visitKeyframes(o,e):(e.incrementTime(i.duration),this.visitStyle(o,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const i=e.currentTimeline,r=e.currentAnimateTimings;!r&&i.getCurrentStyleProperties().length&&i.forwardFrame();const o=r&&r.easing||t.easing;t.isEmptyStep?i.applyEmptyStep(o):i.setStyles(t.styles,o,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const i=e.currentAnimateTimings,r=e.currentTimeline.duration,o=i.duration,a=e.createSubContext().currentTimeline;a.easing=i.easing,t.styles.forEach(g=>{a.forwardTime((g.offset||0)*o),a.setStyles(g.styles,g.easing,e.errors,e.options),a.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(a),e.transformIntoNewTimeline(r+o),e.previousNode=t}visitQuery(t,e){const i=e.currentTimeline.currentTime,r=t.options||{},o=r.delay?vf(r.delay):0;o&&(6===e.previousNode.type||0==i&&e.currentTimeline.getCurrentStyleProperties().length)&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=xv);let s=i;const a=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=a.length;let g=null;a.forEach((w,W)=>{e.currentQueryIndex=W;const ve=e.createSubContext(t.options,w);o&&ve.delayNextStep(o),w===e.element&&(g=ve.currentTimeline),aa(this,t.animation,ve),ve.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,ve.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(s),g&&(e.currentTimeline.mergeTimelineCollectedStyles(g),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const i=e.parentContext,r=e.currentTimeline,o=t.timings,s=Math.abs(o.duration),a=s*(e.currentQueryTotal-1);let g=s*e.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":g=a-g;break;case"full":g=i.currentStaggerTime}const W=e.currentTimeline;g&&W.delayNextStep(g);const ve=W.currentTime;aa(this,t.animation,e),e.previousNode=t,i.currentStaggerTime=r.currentTime-ve+(r.startTime-i.currentTimeline.startTime)}}const xv={};class xx{constructor(t,e,i,r,o,s,a,g){this._driver=t,this.element=e,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=o,this.errors=s,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=xv,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=g||new wv(this._driver,e,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const i=t;let r=this.options;null!=i.duration&&(r.duration=vf(i.duration)),null!=i.delay&&(r.delay=vf(i.delay));const o=i.params;if(o){let s=r.params;s||(s=this.options.params={}),Object.keys(o).forEach(a=>{(!e||!s.hasOwnProperty(a))&&(s[a]=pv(o[a],s,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const i=t.params={};Object.keys(e).forEach(r=>{i[r]=e[r]})}}return t}createSubContext(t=null,e,i){const r=e||this.element,o=new xx(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(t),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(t){return this.previousNode=xv,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,i){const r={duration:null!=e?e:t.duration,delay:this.currentTimeline.currentTime+(null!=i?i:0)+t.delay,easing:""},o=new SB(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(o),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,i,r,o,s){let a=[];if(r&&a.push(this.element),t.length>0){t=(t=t.replace(xB,"."+this._enterClassName)).replace(EB,"."+this._leaveClassName);let w=this._driver.query(this.element,t,1!=i);0!==i&&(w=i<0?w.slice(w.length+i,w.length):w.slice(0,i)),a.push(...w)}return!o&&0==a.length&&s.push(function F8(n){return new jt(3014,ri)}()),a}}class wv{constructor(t,e,i,r){this._driver=t,this.element=e,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new wv(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles[t]=e,this._globalTimelineStyles[t]=e,this._styleSummary[t]={time:this.currentTime,value:e}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&(this._previousKeyframe.easing=t),Object.keys(this._globalTimelineStyles).forEach(e=>{this._backFill[e]=this._globalTimelineStyles[e]||Uc,this._currentKeyframe[e]=Uc}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,i,r){e&&(this._previousKeyframe.easing=e);const o=r&&r.params||{},s=function DB(n,t){const e={};let i;return n.forEach(r=>{"*"===r?(i=i||Object.keys(t),i.forEach(o=>{e[o]=Uc})):td(r,!1,e)}),e}(t,this._globalTimelineStyles);Object.keys(s).forEach(a=>{const g=pv(s[a],o,i);this._pendingStyles[a]=g,this._localTimelineStyles.hasOwnProperty(a)||(this._backFill[a]=this._globalTimelineStyles.hasOwnProperty(a)?this._globalTimelineStyles[a]:Uc),this._updateStyle(a,g)})}applyStylesToKeyframe(){const t=this._pendingStyles,e=Object.keys(t);0!=e.length&&(this._pendingStyles={},e.forEach(i=>{this._currentKeyframe[i]=t[i]}),Object.keys(this._localTimelineStyles).forEach(i=>{this._currentKeyframe.hasOwnProperty(i)||(this._currentKeyframe[i]=this._localTimelineStyles[i])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(t=>{const e=this._localTimelineStyles[t];this._pendingStyles[t]=e,this._updateStyle(t,e)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){Object.keys(t._styleSummary).forEach(e=>{const i=this._styleSummary[e],r=t._styleSummary[e];(!i||r.time>i.time)&&this._updateStyle(e,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,g)=>{const w=td(a,!0);Object.keys(w).forEach(W=>{const ve=w[W];"!"==ve?t.add(W):ve==Uc&&e.add(W)}),i||(w.offset=g/this.duration),r.push(w)});const o=t.size?gv(t.values()):[],s=e.size?gv(e.values()):[];if(i){const a=r[0],g=up(a);a.offset=0,g.offset=1,r=[a,g]}return yx(this.element,r,o,s,this.duration,this.startTime,this.easing,!1)}}class SB extends wv{constructor(t,e,i,r,o,s,a=!1){super(t,e,s.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=o,this._stretchStartingKeyframe=a,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const o=[],s=i+e,a=e/s,g=td(t[0],!1);g.offset=0,o.push(g);const w=td(t[0],!1);w.offset=FI(a),o.push(w);const W=t.length-1;for(let ve=1;ve<=W;ve++){let me=td(t[ve],!1);me.offset=FI((e+me.offset*i)/s),o.push(me)}i=s,e=0,r="",t=o}return yx(this.element,t,this.preStyleProps,this.postStyleProps,i,e,r,!0)}}function FI(n,t=3){const e=Math.pow(10,t-1);return Math.round(n*e)/e}class wx{}class IB extends wx{normalizePropertyName(t,e){return $x(t)}normalizeStyleValue(t,e,i,r){let o="";const s=i.toString().trim();if(kB[e]&&0!==i&&"0"!==i)if("number"==typeof i)o="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function x8(n,t){return new jt(3005,ri)}())}return s+o}}const kB=(()=>function MB(n){const t={};return n.forEach(e=>t[e]=!0),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function RI(n,t,e,i,r,o,s,a,g,w,W,ve,me){return{type:0,element:n,triggerName:t,isRemovalTransition:r,fromState:e,fromStyles:o,toState:i,toStyles:s,timelines:a,queriedElements:g,preStyleProps:w,postStyleProps:W,totalTime:ve,errors:me}}const Ex={};class NI{constructor(t,e,i){this._triggerName=t,this.ast=e,this._stateStyles=i}match(t,e,i,r){return function AB(n,t,e,i,r){return n.some(o=>o(t,e,i,r))}(this.ast.matchers,t,e,i,r)}buildStyles(t,e,i){const r=this._stateStyles["*"],o=this._stateStyles[t],s=r?r.buildStyles(e,i):{};return o?o.buildStyles(e,i):s}build(t,e,i,r,o,s,a,g,w,W){const ve=[],me=this.ast.options&&this.ast.options.params||Ex,Oe=this.buildStyles(i,a&&a.params||Ex,ve),Ve=g&&g.params||Ex,We=this.buildStyles(r,Ve,ve),Ze=new Set,je=new Map,ut=new Map,ot="void"===r,ft={params:Object.assign(Object.assign({},me),Ve)},Ot=W?[]:Cx(t,e,this.ast.animation,o,s,Oe,We,ft,w,ve);let Et=0;if(Ot.forEach(It=>{Et=Math.max(It.duration+It.delay,Et)}),ve.length)return RI(e,this._triggerName,i,r,ot,Oe,We,[],[],je,ut,Et,ve);Ot.forEach(It=>{const Pt=It.element,Wt=sa(je,Pt,{});It.preStyleProps.forEach(Jn=>Wt[Jn]=!0);const ci=sa(ut,Pt,{});It.postStyleProps.forEach(Jn=>ci[Jn]=!0),Pt!==e&&Ze.add(Pt)});const Ut=gv(Ze.values());return RI(e,this._triggerName,i,r,ot,Oe,We,Ot,Ut,je,ut,Et)}}class PB{constructor(t,e,i){this.styles=t,this.defaultParams=e,this.normalizer=i}buildStyles(t,e){const i={},r=up(this.defaultParams);return Object.keys(t).forEach(o=>{const s=t[o];null!=s&&(r[o]=s)}),this.styles.styles.forEach(o=>{if("string"!=typeof o){const s=o;Object.keys(s).forEach(a=>{let g=s[a];g.length>1&&(g=pv(g,r,e));const w=this.normalizer.normalizePropertyName(a,e);g=this.normalizer.normalizeStyleValue(a,w,g,e),i[w]=g})}}),i}}class RB{constructor(t,e,i){this.name=t,this.ast=e,this._normalizer=i,this.transitionFactories=[],this.states={},e.states.forEach(r=>{this.states[r.name]=new PB(r.style,r.options&&r.options.params||{},i)}),OI(this.states,"true","1"),OI(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new NI(t,r,this.states))}),this.fallbackTransition=function NB(n,t,e){return new NI(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(s,a)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,i,r){return this.transitionFactories.find(s=>s.match(t,e,i,r))||null}matchStyles(t,e,i){return this.fallbackTransition.buildStyles(t,e,i)}}function OI(n,t,e){n.hasOwnProperty(t)?n.hasOwnProperty(e)||(n[e]=n[t]):n.hasOwnProperty(e)&&(n[t]=n[e])}const OB=new Cv;class BB{constructor(t,e,i){this.bodyNode=t,this._driver=e,this._normalizer=i,this._animations={},this._playersById={},this.players=[]}register(t,e){const i=[],o=vx(this._driver,e,i,[]);if(i.length)throw function H8(n){return new jt(3503,ri)}();this._animations[t]=o}_buildPlayer(t,e,i){const r=t.element,o=gI(0,this._normalizer,0,t.keyframes,e,i);return this._driver.animate(r,o,t.duration,t.delay,t.easing,[],!0)}create(t,e,i={}){const r=[],o=this._animations[t];let s;const a=new Map;if(o?(s=Cx(this._driver,e,o,px,uv,{},{},i,OB,r),s.forEach(W=>{const ve=sa(a,W.element,{});W.postStyleProps.forEach(me=>ve[me]=null)})):(r.push(function V8(){return new jt(3300,ri)}()),s=[]),r.length)throw function U8(n){return new jt(3504,ri)}();a.forEach((W,ve)=>{Object.keys(W).forEach(me=>{W[me]=this._driver.computeStyle(ve,me,Uc)})});const w=ed(s.map(W=>{const ve=a.get(W.element);return this._buildPlayer(W,{},ve)}));return this._playersById[t]=w,w.onDestroy(()=>this.destroy(t)),this.players.push(w),w}destroy(t){const e=this._getPlayer(t);e.destroy(),delete this._playersById[t];const i=this.players.indexOf(e);i>=0&&this.players.splice(i,1)}_getPlayer(t){const e=this._playersById[t];if(!e)throw function j8(n){return new jt(3301,ri)}();return e}listen(t,e,i,r){const o=ux(e,"","","");return lx(this._getPlayer(t),i,o,r),()=>{}}command(t,e,i,r){if("register"==i)return void this.register(t,r[0]);if("create"==i)return void this.create(t,e,r[0]||{});const o=this._getPlayer(t);switch(i){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}}const BI="ng-animate-queued",Tx="ng-animate-disabled",UB=[],LI={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},jB={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Oa="__ng_removed";class Sx{constructor(t,e=""){this.namespaceId=e;const i=t&&t.hasOwnProperty("value");if(this.value=function ZB(n){return null!=n?n:null}(i?t.value:t),i){const o=up(t);delete o.value,this.options=o}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const i=this.options.params;Object.keys(e).forEach(r=>{null==i[r]&&(i[r]=e[r])})}}}const gm="void",Dx=new Sx(gm);class GB{constructor(t,e,i){this.id=t,this.hostElement=e,this._engine=i,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,Ba(e,this._hostClassName)}listen(t,e,i,r){if(!this._triggers.hasOwnProperty(e))throw function G8(n,t){return new jt(3302,ri)}();if(null==i||0==i.length)throw function q8(n){return new jt(3303,ri)}();if(!function YB(n){return"start"==n||"done"==n}(i))throw function W8(n,t){return new jt(3400,ri)}();const o=sa(this._elementListeners,t,[]),s={name:e,phase:i,callback:r};o.push(s);const a=sa(this._engine.statesByElement,t,{});return a.hasOwnProperty(e)||(Ba(t,dv),Ba(t,dv+"-"+e),a[e]=Dx),()=>{this._engine.afterFlush(()=>{const g=o.indexOf(s);g>=0&&o.splice(g,1),this._triggers[e]||delete a[e]})}}register(t,e){return!this._triggers[t]&&(this._triggers[t]=e,!0)}_getTrigger(t){const e=this._triggers[t];if(!e)throw function Z8(n){return new jt(3401,ri)}();return e}trigger(t,e,i,r=!0){const o=this._getTrigger(e),s=new Ix(this.id,e,t);let a=this._engine.statesByElement.get(t);a||(Ba(t,dv),Ba(t,dv+"-"+e),this._engine.statesByElement.set(t,a={}));let g=a[e];const w=new Sx(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&g&&w.absorbOptions(g.options),a[e]=w,g||(g=Dx),w.value!==gm&&g.value===w.value){if(!function QB(n,t){const e=Object.keys(n),i=Object.keys(t);if(e.length!=i.length)return!1;for(let r=0;r<e.length;r++){const o=e[r];if(!t.hasOwnProperty(o)||n[o]!==t[o])return!1}return!0}(g.params,w.params)){const Ve=[],We=o.matchStyles(g.value,g.params,Ve),Ze=o.matchStyles(w.value,w.params,Ve);Ve.length?this._engine.reportError(Ve):this._engine.afterFlush(()=>{bf(t,We),oc(t,Ze)})}return}const me=sa(this._engine.playersByElement,t,[]);me.forEach(Ve=>{Ve.namespaceId==this.id&&Ve.triggerName==e&&Ve.queued&&Ve.destroy()});let Se=o.matchTransition(g.value,w.value,t,w.params),Oe=!1;if(!Se){if(!r)return;Se=o.fallbackTransition,Oe=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:Se,fromState:g,toState:w,player:s,isFallbackTransition:Oe}),Oe||(Ba(t,BI),s.onStart(()=>{dp(t,BI)})),s.onDone(()=>{let Ve=this.players.indexOf(s);Ve>=0&&this.players.splice(Ve,1);const We=this._engine.playersByElement.get(t);if(We){let Ze=We.indexOf(s);Ze>=0&&We.splice(Ze,1)}}),this.players.push(s),me.push(s),s}deregister(t){delete this._triggers[t],this._engine.statesByElement.forEach((e,i)=>{delete e[t]}),this._elementListeners.forEach((e,i)=>{this._elementListeners.set(i,e.filter(r=>r.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(i=>i.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const i=this._engine.driver.query(t,fv,!0);i.forEach(r=>{if(r[Oa])return;const o=this._engine.fetchNamespacesByElement(r);o.size?o.forEach(s=>s.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(t,e,i,r){const o=this._engine.statesByElement.get(t),s=new Map;if(o){const a=[];if(Object.keys(o).forEach(g=>{if(s.set(g,o[g].value),this._triggers[g]){const w=this.trigger(t,g,gm,r);w&&a.push(w)}}),a.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,s),i&&ed(a).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),i=this._engine.statesByElement.get(t);if(e&&i){const r=new Set;e.forEach(o=>{const s=o.name;if(r.has(s))return;r.add(s);const g=this._triggers[s].fallbackTransition,w=i[s]||Dx,W=new Sx(gm),ve=new Ix(this.id,s,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:s,transition:g,fromState:w,toState:W,player:ve,isFallbackTransition:!0})})}}removeNode(t,e){const i=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let r=!1;if(i.totalAnimations){const o=i.players.length?i.playersByQueriedElement.get(t):[];if(o&&o.length)r=!0;else{let s=t;for(;s=s.parentNode;)if(i.statesByElement.get(s)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(t),r)i.markElementAsRemoved(this.id,t,!1,e);else{const o=t[Oa];(!o||o===LI)&&(i.afterFlush(()=>this.clearElementCache(t)),i.destroyInnerAnimations(t),i._onRemovalComplete(t,e))}}insertNode(t,e){Ba(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const o=i.element,s=this._elementListeners.get(o);s&&s.forEach(a=>{if(a.name==i.triggerName){const g=ux(o,i.triggerName,i.fromState.value,i.toState.value);g._data=t,lx(i.player,a.phase,g,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(i)}),this._queue=[],e.sort((i,r)=>{const o=i.transition.ast.depCount,s=r.transition.ast.depCount;return 0==o||0==s?o-s:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(i=>i.element===t)||e,e}}class qB{constructor(t,e,i){this.bodyNode=t,this.driver=e,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,o)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(i=>{i.queued&&t.push(i)})}),t}createNamespace(t,e){const i=new GB(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(i,e):(this.newHostElements.set(e,i),this.collectEnterElement(e)),this._namespaceLookup[t]=i}_balanceNamespaceList(t,e){const i=this._namespaceList,r=this.namespacesByHostElement,o=i.length-1;if(o>=0){let s=!1;if(void 0!==this.driver.getParentElement){let a=this.driver.getParentElement(e);for(;a;){const g=r.get(a);if(g){const w=i.indexOf(g);i.splice(w+1,0,t),s=!0;break}a=this.driver.getParentElement(a)}}else for(let a=o;a>=0;a--)if(this.driver.containsElement(i[a].hostElement,e)){i.splice(a+1,0,t),s=!0;break}s||i.unshift(t)}else i.push(t);return r.set(e,t),t}register(t,e){let i=this._namespaceLookup[t];return i||(i=this.createNamespace(t,e)),i}registerTrigger(t,e,i){let r=this._namespaceLookup[t];r&&r.register(e,i)&&this.totalAnimations++}destroy(t,e){if(!t)return;const i=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[t];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,i=this.statesByElement.get(t);if(i){const r=Object.keys(i);for(let o=0;o<r.length;o++){const s=i[r[o]].namespaceId;if(s){const a=this._fetchNamespace(s);a&&e.add(a)}}}return e}trigger(t,e,i,r){if(Ev(e)){const o=this._fetchNamespace(t);if(o)return o.trigger(e,i,r),!0}return!1}insertNode(t,e,i,r){if(!Ev(e))return;const o=e[Oa];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const s=this.collectedLeaveElements.indexOf(e);s>=0&&this.collectedLeaveElements.splice(s,1)}if(t){const s=this._fetchNamespace(t);s&&s.insertNode(e,i)}r&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),Ba(t,Tx)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),dp(t,Tx))}removeNode(t,e,i,r){if(Ev(e)){const o=t?this._fetchNamespace(t):null;if(o?o.removeNode(e,r):this.markElementAsRemoved(t,e,!1,r),i){const s=this.namespacesByHostElement.get(e);s&&s.id!==t&&s.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(t,e,i,r,o){this.collectedLeaveElements.push(e),e[Oa]={namespaceId:t,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:o}}listen(t,e,i,r,o){return Ev(e)?this._fetchNamespace(t).listen(e,i,r,o):()=>{}}_buildInstruction(t,e,i,r,o){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,i,r,t.fromState.options,t.toState.options,e,o)}destroyInnerAnimations(t){let e=this.driver.query(t,fv,!0);e.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,gx,!0),e.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return ed(this.players).onDone(()=>t());t()})}processLeaveNode(t){var e;const i=t[Oa];if(i&&i.setForRemoval){if(t[Oa]=LI,i.namespaceId){this.destroyInnerAnimations(t);const r=this._fetchNamespace(i.namespaceId);r&&r.clearElementCache(t)}this._onRemovalComplete(t,i.setForRemoval)}(null===(e=t.classList)||void 0===e?void 0:e.contains(Tx))&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Ba(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{e=this._flushAnimations(i,t)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],e.length?ed(e).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(t){throw function Y8(n){return new jt(3402,ri)}()}_flushAnimations(t,e){const i=new Cv,r=[],o=new Map,s=[],a=new Map,g=new Map,w=new Map,W=new Set;this.disabledNodes.forEach(Rt=>{W.add(Rt);const Zt=this.driver.query(Rt,".ng-animate-queued",!0);for(let tn=0;tn<Zt.length;tn++)W.add(Zt[tn])});const ve=this.bodyNode,me=Array.from(this.statesByElement.keys()),Se=VI(me,this.collectedEnterElements),Oe=new Map;let Ve=0;Se.forEach((Rt,Zt)=>{const tn=px+Ve++;Oe.set(Zt,tn),Rt.forEach(dn=>Ba(dn,tn))});const We=[],Ze=new Set,je=new Set;for(let Rt=0;Rt<this.collectedLeaveElements.length;Rt++){const Zt=this.collectedLeaveElements[Rt],tn=Zt[Oa];tn&&tn.setForRemoval&&(We.push(Zt),Ze.add(Zt),tn.hasAnimation?this.driver.query(Zt,".ng-star-inserted",!0).forEach(dn=>Ze.add(dn)):je.add(Zt))}const ut=new Map,ot=VI(me,Array.from(Ze));ot.forEach((Rt,Zt)=>{const tn=uv+Ve++;ut.set(Zt,tn),Rt.forEach(dn=>Ba(dn,tn))}),t.push(()=>{Se.forEach((Rt,Zt)=>{const tn=Oe.get(Zt);Rt.forEach(dn=>dp(dn,tn))}),ot.forEach((Rt,Zt)=>{const tn=ut.get(Zt);Rt.forEach(dn=>dp(dn,tn))}),We.forEach(Rt=>{this.processLeaveNode(Rt)})});const ft=[],Ot=[];for(let Rt=this._namespaceList.length-1;Rt>=0;Rt--)this._namespaceList[Rt].drainQueuedTransitions(e).forEach(tn=>{const dn=tn.player,Wn=tn.element;if(ft.push(dn),this.collectedEnterElements.length){const io=Wn[Oa];if(io&&io.setForMove){if(io.previousTriggersValues&&io.previousTriggersValues.has(tn.triggerName)){const El=io.previousTriggersValues.get(tn.triggerName),Tl=this.statesByElement.get(tn.element);Tl&&Tl[tn.triggerName]&&(Tl[tn.triggerName].value=El)}return void dn.destroy()}}const $i=!ve||!this.driver.containsElement(ve,Wn),Mi=ut.get(Wn),ar=Oe.get(Wn),vi=this._buildInstruction(tn,i,ar,Mi,$i);if(vi.errors&&vi.errors.length)return void Ot.push(vi);if($i)return dn.onStart(()=>bf(Wn,vi.fromStyles)),dn.onDestroy(()=>oc(Wn,vi.toStyles)),void r.push(dn);if(tn.isFallbackTransition)return dn.onStart(()=>bf(Wn,vi.fromStyles)),dn.onDestroy(()=>oc(Wn,vi.toStyles)),void r.push(dn);const Mt=[];vi.timelines.forEach(io=>{io.stretchStartingKeyframe=!0,this.disabledNodes.has(io.element)||Mt.push(io)}),vi.timelines=Mt,i.append(Wn,vi.timelines),s.push({instruction:vi,player:dn,element:Wn}),vi.queriedElements.forEach(io=>sa(a,io,[]).push(dn)),vi.preStyleProps.forEach((io,El)=>{const Tl=Object.keys(io);if(Tl.length){let $c=g.get(El);$c||g.set(El,$c=new Set),Tl.forEach(Yw=>$c.add(Yw))}}),vi.postStyleProps.forEach((io,El)=>{const Tl=Object.keys(io);let $c=w.get(El);$c||w.set(El,$c=new Set),Tl.forEach(Yw=>$c.add(Yw))})});if(Ot.length){const Rt=[];Ot.forEach(Zt=>{Rt.push(function K8(n,t){return new jt(3505,ri)}())}),ft.forEach(Zt=>Zt.destroy()),this.reportError(Rt)}const Et=new Map,Ut=new Map;s.forEach(Rt=>{const Zt=Rt.element;i.has(Zt)&&(Ut.set(Zt,Zt),this._beforeAnimationBuild(Rt.player.namespaceId,Rt.instruction,Et))}),r.forEach(Rt=>{const Zt=Rt.element;this._getPreviousPlayers(Zt,!1,Rt.namespaceId,Rt.triggerName,null).forEach(dn=>{sa(Et,Zt,[]).push(dn),dn.destroy()})});const It=We.filter(Rt=>jI(Rt,g,w)),Pt=new Map;HI(Pt,this.driver,je,w,Uc).forEach(Rt=>{jI(Rt,g,w)&&It.push(Rt)});const ci=new Map;Se.forEach((Rt,Zt)=>{HI(ci,this.driver,new Set(Rt),g,"!")}),It.forEach(Rt=>{const Zt=Pt.get(Rt),tn=ci.get(Rt);Pt.set(Rt,Object.assign(Object.assign({},Zt),tn))});const Jn=[],gi=[],Ri={};s.forEach(Rt=>{const{element:Zt,player:tn,instruction:dn}=Rt;if(i.has(Zt)){if(W.has(Zt))return tn.onDestroy(()=>oc(Zt,dn.toStyles)),tn.disabled=!0,tn.overrideTotalTime(dn.totalTime),void r.push(tn);let Wn=Ri;if(Ut.size>1){let Mi=Zt;const ar=[];for(;Mi=Mi.parentNode;){const vi=Ut.get(Mi);if(vi){Wn=vi;break}ar.push(Mi)}ar.forEach(vi=>Ut.set(vi,Wn))}const $i=this._buildAnimation(tn.namespaceId,dn,Et,o,ci,Pt);if(tn.setRealPlayer($i),Wn===Ri)Jn.push(tn);else{const Mi=this.playersByElement.get(Wn);Mi&&Mi.length&&(tn.parentPlayer=ed(Mi)),r.push(tn)}}else bf(Zt,dn.fromStyles),tn.onDestroy(()=>oc(Zt,dn.toStyles)),gi.push(tn),W.has(Zt)&&r.push(tn)}),gi.forEach(Rt=>{const Zt=o.get(Rt.element);if(Zt&&Zt.length){const tn=ed(Zt);Rt.setRealPlayer(tn)}}),r.forEach(Rt=>{Rt.parentPlayer?Rt.syncPlayerEvents(Rt.parentPlayer):Rt.destroy()});for(let Rt=0;Rt<We.length;Rt++){const Zt=We[Rt],tn=Zt[Oa];if(dp(Zt,uv),tn&&tn.hasAnimation)continue;let dn=[];if(a.size){let $i=a.get(Zt);$i&&$i.length&&dn.push(...$i);let Mi=this.driver.query(Zt,gx,!0);for(let ar=0;ar<Mi.length;ar++){let vi=a.get(Mi[ar]);vi&&vi.length&&dn.push(...vi)}}const Wn=dn.filter($i=>!$i.destroyed);Wn.length?KB(this,Zt,Wn):this.processLeaveNode(Zt)}return We.length=0,Jn.forEach(Rt=>{this.players.push(Rt),Rt.onDone(()=>{Rt.destroy();const Zt=this.players.indexOf(Rt);this.players.splice(Zt,1)}),Rt.play()}),Jn}elementContainsData(t,e){let i=!1;const r=e[Oa];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(e)&&(i=!0),this.playersByQueriedElement.has(e)&&(i=!0),this.statesByElement.has(e)&&(i=!0),this._fetchNamespace(t).elementContainsData(e)||i}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,i,r,o){let s=[];if(e){const a=this.playersByQueriedElement.get(t);a&&(s=a)}else{const a=this.playersByElement.get(t);if(a){const g=!o||o==gm;a.forEach(w=>{w.queued||!g&&w.triggerName!=r||s.push(w)})}}return(i||r)&&(s=s.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),s}_beforeAnimationBuild(t,e,i){const o=e.element,s=e.isRemovalTransition?void 0:t,a=e.isRemovalTransition?void 0:e.triggerName;for(const g of e.timelines){const w=g.element,W=w!==o,ve=sa(i,w,[]);this._getPreviousPlayers(w,W,s,a,e.toState).forEach(Se=>{const Oe=Se.getRealPlayer();Oe.beforeDestroy&&Oe.beforeDestroy(),Se.destroy(),ve.push(Se)})}bf(o,e.fromStyles)}_buildAnimation(t,e,i,r,o,s){const a=e.triggerName,g=e.element,w=[],W=new Set,ve=new Set,me=e.timelines.map(Oe=>{const Ve=Oe.element;W.add(Ve);const We=Ve[Oa];if(We&&We.removedBeforeQueried)return new hm(Oe.duration,Oe.delay);const Ze=Ve!==g,je=function XB(n){const t=[];return UI(n,t),t}((i.get(Ve)||UB).map(Et=>Et.getRealPlayer())).filter(Et=>!!Et.element&&Et.element===Ve),ut=o.get(Ve),ot=s.get(Ve),ft=gI(0,this._normalizer,0,Oe.keyframes,ut,ot),Ot=this._buildPlayer(Oe,ft,je);if(Oe.subTimeline&&r&&ve.add(Ve),Ze){const Et=new Ix(t,a,Ve);Et.setRealPlayer(Ot),w.push(Et)}return Ot});w.forEach(Oe=>{sa(this.playersByQueriedElement,Oe.element,[]).push(Oe),Oe.onDone(()=>function WB(n,t,e){let i;if(n instanceof Map){if(i=n.get(t),i){if(i.length){const r=i.indexOf(e);i.splice(r,1)}0==i.length&&n.delete(t)}}else if(i=n[t],i){if(i.length){const r=i.indexOf(e);i.splice(r,1)}0==i.length&&delete n[t]}return i}(this.playersByQueriedElement,Oe.element,Oe))}),W.forEach(Oe=>Ba(Oe,EI));const Se=ed(me);return Se.onDestroy(()=>{W.forEach(Oe=>dp(Oe,EI)),oc(g,e.toStyles)}),ve.forEach(Oe=>{sa(r,Oe,[]).push(Se)}),Se}_buildPlayer(t,e,i){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,i):new hm(t.duration,t.delay)}}class Ix{constructor(t,e,i){this.namespaceId=t,this.triggerName=e,this.element=i,this._player=new hm,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,Object.keys(this._queuedCallbacks).forEach(e=>{this._queuedCallbacks[e].forEach(i=>lx(t,e,void 0,i))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){sa(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function Ev(n){return n&&1===n.nodeType}function zI(n,t){const e=n.style.display;return n.style.display=null!=t?t:"none",e}function HI(n,t,e,i,r){const o=[];e.forEach(g=>o.push(zI(g)));const s=[];i.forEach((g,w)=>{const W={};g.forEach(ve=>{const me=W[ve]=t.computeStyle(w,ve,r);(!me||0==me.length)&&(w[Oa]=jB,s.push(w))}),n.set(w,W)});let a=0;return e.forEach(g=>zI(g,o[a++])),s}function VI(n,t){const e=new Map;if(n.forEach(a=>e.set(a,[])),0==t.length)return e;const r=new Set(t),o=new Map;function s(a){if(!a)return 1;let g=o.get(a);if(g)return g;const w=a.parentNode;return g=e.has(w)?w:r.has(w)?1:s(w),o.set(a,g),g}return t.forEach(a=>{const g=s(a);1!==g&&e.get(g).push(a)}),e}function Ba(n,t){var e;null===(e=n.classList)||void 0===e||e.add(t)}function dp(n,t){var e;null===(e=n.classList)||void 0===e||e.remove(t)}function KB(n,t,e){ed(e).onDone(()=>n.processLeaveNode(t))}function UI(n,t){for(let e=0;e<n.length;e++){const i=n[e];i instanceof hI?UI(i.players,t):t.push(i)}}function jI(n,t,e){const i=e.get(n);if(!i)return!1;let r=t.get(n);return r?i.forEach(o=>r.add(o)):t.set(n,i),e.delete(n),!0}class Tv{constructor(t,e,i){this.bodyNode=t,this._driver=e,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,o)=>{},this._transitionEngine=new qB(t,e,i),this._timelineEngine=new BB(t,e,i),this._transitionEngine.onRemovalComplete=(r,o)=>this.onRemovalComplete(r,o)}registerTrigger(t,e,i,r,o){const s=t+"-"+r;let a=this._triggerCache[s];if(!a){const g=[],W=vx(this._driver,o,g,[]);if(g.length)throw function L8(n,t){return new jt(3404,ri)}();a=function FB(n,t,e){return new RB(n,t,e)}(r,W,this._normalizer),this._triggerCache[s]=a}this._transitionEngine.registerTrigger(e,r,a)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,i,r){this._transitionEngine.insertNode(t,e,i,r)}onRemove(t,e,i,r){this._transitionEngine.removeNode(t,e,r||!1,i)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,i,r){if("@"==i.charAt(0)){const[o,s]=_I(i);this._timelineEngine.command(o,e,s,r)}else this._transitionEngine.trigger(t,e,i,r)}listen(t,e,i,r,o){if("@"==i.charAt(0)){const[s,a]=_I(i);return this._timelineEngine.listen(s,e,a,o)}return this._transitionEngine.listen(t,e,i,r,o)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let eL=(()=>{class n{constructor(e,i,r){this._element=e,this._startStyles=i,this._endStyles=r,this._state=0;let o=n.initialStylesByElement.get(e);o||n.initialStylesByElement.set(e,o={}),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&oc(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(oc(this._element,this._initialStyles),this._endStyles&&(oc(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(bf(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(bf(this._element,this._endStyles),this._endStyles=null),oc(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function kx(n){let t=null;const e=Object.keys(n);for(let i=0;i<e.length;i++){const r=e[i];tL(r)&&(t=t||{},t[r]=n[r])}return t}function tL(n){return"display"===n||"position"===n}class GI{constructor(t,e,i,r){this.element=t,this.keyframes=e,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(t,e,i){return t.animate(e,i)}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t={};if(this.hasStarted()){const e=this._finalKeyframe;Object.keys(e).forEach(i=>{"offset"!=i&&(t[i]=this._finished?e[i]:kI(this.element,i))})}this.currentSnapshot=t}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class nL{validateStyleProperty(t){return bI(t)}matchesElement(t,e){return!1}containsElement(t,e){return yI(t,e)}getParentElement(t){return fx(t)}query(t,e,i){return CI(t,e,i)}computeStyle(t,e,i){return window.getComputedStyle(t)[e]}animate(t,e,i,r,o,s=[]){const g={duration:i,delay:r,fill:0==r?"both":"forwards"};o&&(g.easing=o);const w={},W=s.filter(me=>me instanceof GI);(function sB(n,t){return 0===n||0===t})(i,r)&&W.forEach(me=>{let Se=me.currentSnapshot;Object.keys(Se).forEach(Oe=>w[Oe]=Se[Oe])}),e=function aB(n,t,e){const i=Object.keys(e);if(i.length&&t.length){let o=t[0],s=[];if(i.forEach(a=>{o.hasOwnProperty(a)||s.push(a),o[a]=e[a]}),s.length)for(var r=1;r<t.length;r++){let a=t[r];s.forEach(function(g){a[g]=kI(n,g)})}}return t}(t,e=e.map(me=>td(me,!1)),w);const ve=function JB(n,t){let e=null,i=null;return Array.isArray(t)&&t.length?(e=kx(t[0]),t.length>1&&(i=kx(t[t.length-1]))):t&&(e=kx(t)),e||i?new eL(n,e,i):null}(t,e);return new GI(t,e,g,ve)}}let iL=(()=>{class n extends uI{constructor(e,i){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(i.body,{id:"0",encapsulation:ws.None,styles:[],data:{animation:[]}})}build(e){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(e)?dI(e):e;return qI(this._renderer,null,i,"register",[r]),new rL(i,this._renderer)}}return n.\u0275fac=function(e){return new(e||n)(In(X_),In(hs))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();class rL extends class m8{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new oL(this._id,t,e||{},this._renderer)}}class oL{constructor(t,e,i,r){this.id=t,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return qI(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){var t,e;return null!==(e=null===(t=this._renderer.engine.players[+this.id])||void 0===t?void 0:t.getPosition())&&void 0!==e?e:0}}function qI(n,t,e,i,r){return n.setProperty(t,`@@${e}:${i}`,r)}const WI="@.disabled";let sL=(()=>{class n{constructor(e,i,r){this.delegate=e,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(o,s)=>{const a=null==s?void 0:s.parentNode(o);a&&s.removeChild(a,o)}}createRenderer(e,i){const o=this.delegate.createRenderer(e,i);if(!(e&&i&&i.data&&i.data.animation)){let W=this._rendererCache.get(o);return W||(W=new ZI("",o,this.engine),this._rendererCache.set(o,W)),W}const s=i.id,a=i.id+"-"+this._currentId;this._currentId++,this.engine.register(a,e);const g=W=>{Array.isArray(W)?W.forEach(g):this.engine.registerTrigger(s,a,e,W.name,W)};return i.data.animation.forEach(g),new aL(this,a,o,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,i,r){e>=0&&e<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(o=>{const[s,a]=o;s(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(e){return new(e||n)(In(X_),In(Tv),In(An))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();class ZI{constructor(t,e,i){this.namespaceId=t,this.delegate=e,this.engine=i,this.destroyNode=this.delegate.destroyNode?r=>e.destroyNode(r):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,i,r=!0){this.delegate.insertBefore(t,e,i),this.engine.onInsert(this.namespaceId,e,t,r)}removeChild(t,e,i){this.engine.onRemove(this.namespaceId,e,this.delegate,i)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,i,r){this.delegate.setAttribute(t,e,i,r)}removeAttribute(t,e,i){this.delegate.removeAttribute(t,e,i)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,i,r){this.delegate.setStyle(t,e,i,r)}removeStyle(t,e,i){this.delegate.removeStyle(t,e,i)}setProperty(t,e,i){"@"==e.charAt(0)&&e==WI?this.disableAnimations(t,!!i):this.delegate.setProperty(t,e,i)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,i){return this.delegate.listen(t,e,i)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class aL extends ZI{constructor(t,e,i,r){super(e,i,r),this.factory=t,this.namespaceId=e}setProperty(t,e,i){"@"==e.charAt(0)?"."==e.charAt(1)&&e==WI?this.disableAnimations(t,i=void 0===i||!!i):this.engine.process(this.namespaceId,t,e.substr(1),i):this.delegate.setProperty(t,e,i)}listen(t,e,i){if("@"==e.charAt(0)){const r=function lL(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(t);let o=e.substr(1),s="";return"@"!=o.charAt(0)&&([o,s]=function cL(n){const t=n.indexOf(".");return[n.substring(0,t),n.substr(t+1)]}(o)),this.engine.listen(this.namespaceId,r,o,s,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(t,e,i)}}let uL=(()=>{class n extends Tv{constructor(e,i,r){super(e.body,i,r)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(e){return new(e||n)(In(hs),In(hx),In(wx))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();const YI=new ei("AnimationModuleType"),KI=[{provide:uI,useClass:iL},{provide:wx,useFactory:function dL(){return new IB}},{provide:Tv,useClass:uL},{provide:X_,useFactory:function fL(n,t,e){return new sL(n,t,e)},deps:[X1,Tv,An]}],XI=[{provide:hx,useFactory:()=>new nL},{provide:YI,useValue:"BrowserAnimations"},...KI],hL=[{provide:hx,useClass:xI},{provide:YI,useValue:"NoopAnimations"},...KI];let pL=(()=>{class n{static withConfig(e){return{ngModule:n,providers:e.disableAnimations?hL:XI}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ns({type:n}),n.\u0275inj=ts({providers:XI,imports:[aD]}),n})();function QI(n,t){if(Array.prototype.indexOf)return n.indexOf(t);for(var e=0,i=n.length;e<i;e++)if(n[e]===t)return e;return-1}function Cf(n,t){for(var e=n.length-1;e>=0;e--)!0===t(n[e])&&n.splice(e,1)}function JI(n){throw new Error("Unhandled case for value: '".concat(n,"'"))}var e,Mx=function(){function n(t){void 0===t&&(t={}),this.tagName="",this.attrs={},this.innerHTML="",this.whitespaceRegex=/\s+/,this.tagName=t.tagName||"",this.attrs=t.attrs||{},this.innerHTML=t.innerHtml||t.innerHTML||""}return n.prototype.setTagName=function(t){return this.tagName=t,this},n.prototype.getTagName=function(){return this.tagName||""},n.prototype.setAttr=function(t,e){return this.getAttrs()[t]=e,this},n.prototype.getAttr=function(t){return this.getAttrs()[t]},n.prototype.setAttrs=function(t){return Object.assign(this.getAttrs(),t),this},n.prototype.getAttrs=function(){return this.attrs||(this.attrs={})},n.prototype.setClass=function(t){return this.setAttr("class",t)},n.prototype.addClass=function(t){for(var s,e=this.getClass(),i=this.whitespaceRegex,r=e?e.split(i):[],o=t.split(i);s=o.shift();)-1===QI(r,s)&&r.push(s);return this.getAttrs().class=r.join(" "),this},n.prototype.removeClass=function(t){for(var s,e=this.getClass(),i=this.whitespaceRegex,r=e?e.split(i):[],o=t.split(i);r.length&&(s=o.shift());){var a=QI(r,s);-1!==a&&r.splice(a,1)}return this.getAttrs().class=r.join(" "),this},n.prototype.getClass=function(){return this.getAttrs().class||""},n.prototype.hasClass=function(t){return-1!==(" "+this.getClass()+" ").indexOf(" "+t+" ")},n.prototype.setInnerHTML=function(t){return this.innerHTML=t,this},n.prototype.setInnerHtml=function(t){return this.setInnerHTML(t)},n.prototype.getInnerHTML=function(){return this.innerHTML||""},n.prototype.getInnerHtml=function(){return this.getInnerHTML()},n.prototype.toAnchorString=function(){var t=this.getTagName(),e=this.buildAttrsStr();return["<",t,e=e?" "+e:"",">",this.getInnerHtml(),"</",t,">"].join("")},n.prototype.buildAttrsStr=function(){if(!this.attrs)return"";var t=this.getAttrs(),e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i+'="'+t[i]+'"');return e.join(" ")},n}(),ek=function(){function n(t){void 0===t&&(t={}),this.newWindow=!1,this.truncate={},this.className="",this.newWindow=t.newWindow||!1,this.truncate=t.truncate||{},this.className=t.className||""}return n.prototype.build=function(t){return new Mx({tagName:"a",attrs:this.createAttrs(t),innerHtml:this.processAnchorText(t.getAnchorText())})},n.prototype.createAttrs=function(t){var e={href:t.getAnchorHref()},i=this.createCssClass(t);return i&&(e.class=i),this.newWindow&&(e.target="_blank",e.rel="noopener noreferrer"),this.truncate&&this.truncate.length&&this.truncate.length<t.getAnchorText().length&&(e.title=t.getAnchorHref()),e},n.prototype.createCssClass=function(t){var e=this.className;if(e){for(var i=[e],r=t.getCssClassSuffixes(),o=0,s=r.length;o<s;o++)i.push(e+"-"+r[o]);return i.join(" ")}return""},n.prototype.processAnchorText=function(t){return this.doTruncate(t)},n.prototype.doTruncate=function(t){var e=this.truncate;if(!e||!e.length)return t;var i=e.length,r=e.location;return"smart"===r?function $L(n,t,e){var i,r;null==e?(e="&hellip;",r=3,i=8):(r=e.length,i=e.length);var s=function(je){var ut="";return je.scheme&&je.host&&(ut+=je.scheme+"://"),je.host&&(ut+=je.host),je.path&&(ut+="/"+je.path),je.query&&(ut+="?"+je.query),je.fragment&&(ut+="#"+je.fragment),ut},a=function(je,ut){var ot=ut/2,ft=Math.ceil(ot),Ot=-1*Math.floor(ot),Et="";return Ot<0&&(Et=je.substr(Ot)),je.substr(0,ft)+e+Et};if(n.length<=t)return n;var ut,ot,ft,g=t-r,w=(ut={},(ft=(ot=n).match(/^([a-z]+):\/\//i))&&(ut.scheme=ft[1],ot=ot.substr(ft[0].length)),(ft=ot.match(/^(.*?)(?=(\?|#|\/|$))/i))&&(ut.host=ft[1],ot=ot.substr(ft[0].length)),(ft=ot.match(/^\/(.*?)(?=(\?|#|$))/i))&&(ut.path=ft[1],ot=ot.substr(ft[0].length)),(ft=ot.match(/^\?(.*?)(?=(#|$))/i))&&(ut.query=ft[1],ot=ot.substr(ft[0].length)),(ft=ot.match(/^#(.*?)$/i))&&(ut.fragment=ft[1]),ut);if(w.query){var W=w.query.match(/^(.*?)(?=(\?|\#))(.*?)$/i);W&&(w.query=w.query.substr(0,W[1].length),n=s(w))}if(n.length<=t||(w.host&&(w.host=w.host.replace(/^www\./,""),n=s(w)),n.length<=t))return n;var ve="";if(w.host&&(ve+=w.host),ve.length>=g)return w.host.length==t?(w.host.substr(0,t-r)+e).substr(0,g+i):a(ve,g).substr(0,g+i);var me="";if(w.path&&(me+="/"+w.path),w.query&&(me+="?"+w.query),me){if((ve+me).length>=g)return(ve+me).length==t?(ve+me).substr(0,t):(ve+a(me,g-ve.length)).substr(0,g+i);ve+=me}if(w.fragment){var Oe="#"+w.fragment;if((ve+Oe).length>=g)return(ve+Oe).length==t?(ve+Oe).substr(0,t):(ve+a(Oe,g-ve.length)).substr(0,g+i);ve+=Oe}if(w.scheme&&w.host){var We=w.scheme+"://";if((ve+We).length<g)return(We+ve).substr(0,t)}if(ve.length<=t)return ve;var Ze="";return g>0&&(Ze=ve.substr(-1*Math.floor(g/2))),(ve.substr(0,Math.ceil(g/2))+e+Ze).substr(0,g+i)}(t,i):"middle"===r?function vL(n,t,e){if(n.length<=t)return n;var i,r;null==e?(e="&hellip;",i=8,r=3):(i=e.length,r=e.length);var o=t-r,s="";return o>0&&(s=n.substr(-1*Math.floor(o/2))),(n.substr(0,Math.ceil(o/2))+e+s).substr(0,o+i)}(t,i):function bL(n,t,e){return function _L(n,t,e){var i;return n.length>t&&(null==e?(e="&hellip;",i=3):i=e.length,n=n.substring(0,t-i)+e),n}(n,t,e)}(t,i)},n}(),fp=function(){function n(t){this.__jsduckDummyDocProp=null,this.matchedText="",this.offset=0,this.tagBuilder=t.tagBuilder,this.matchedText=t.matchedText,this.offset=t.offset}return n.prototype.getMatchedText=function(){return this.matchedText},n.prototype.setOffset=function(t){this.offset=t},n.prototype.getOffset=function(){return this.offset},n.prototype.getCssClassSuffixes=function(){return[this.getType()]},n.prototype.buildTag=function(){return this.tagBuilder.build(this)},n}(),tk=function(n){function t(e){var i=n.call(this,e)||this;return i.email="",i.email=e.email,i}return Ae(t,n),t.prototype.getType=function(){return"email"},t.prototype.getEmail=function(){return this.email},t.prototype.getAnchorHref=function(){return"mailto:"+this.email},t.prototype.getAnchorText=function(){return this.email},t}(fp),nk=function(n){function t(e){var i=n.call(this,e)||this;return i.serviceName="",i.hashtag="",i.serviceName=e.serviceName,i.hashtag=e.hashtag,i}return Ae(t,n),t.prototype.getType=function(){return"hashtag"},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getHashtag=function(){return this.hashtag},t.prototype.getAnchorHref=function(){var e=this.serviceName,i=this.hashtag;switch(e){case"twitter":return"https://twitter.com/hashtag/"+i;case"facebook":return"https://www.facebook.com/hashtag/"+i;case"instagram":return"https://instagram.com/explore/tags/"+i;case"tiktok":return"https://www.tiktok.com/tag/"+i;default:throw new Error("Unknown service name to point hashtag to: "+e)}},t.prototype.getAnchorText=function(){return"#"+this.hashtag},t}(fp),ik=function(n){function t(e){var i=n.call(this,e)||this;return i.serviceName="twitter",i.mention="",i.mention=e.mention,i.serviceName=e.serviceName,i}return Ae(t,n),t.prototype.getType=function(){return"mention"},t.prototype.getMention=function(){return this.mention},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getAnchorHref=function(){switch(this.serviceName){case"twitter":return"https://twitter.com/"+this.mention;case"instagram":return"https://instagram.com/"+this.mention;case"soundcloud":return"https://soundcloud.com/"+this.mention;case"tiktok":return"https://www.tiktok.com/@"+this.mention;default:throw new Error("Unknown service name to point mention to: "+this.serviceName)}},t.prototype.getAnchorText=function(){return"@"+this.mention},t.prototype.getCssClassSuffixes=function(){var e=n.prototype.getCssClassSuffixes.call(this),i=this.getServiceName();return i&&e.push(i),e},t}(fp),rk=function(n){function t(e){var i=n.call(this,e)||this;return i.number="",i.plusSign=!1,i.number=e.number,i.plusSign=e.plusSign,i}return Ae(t,n),t.prototype.getType=function(){return"phone"},t.prototype.getPhoneNumber=function(){return this.number},t.prototype.getNumber=function(){return this.getPhoneNumber()},t.prototype.getAnchorHref=function(){return"tel:"+(this.plusSign?"+":"")+this.number},t.prototype.getAnchorText=function(){return this.matchedText},t}(fp),ok=function(n){function t(e){var i=n.call(this,e)||this;return i.url="",i.urlMatchType="scheme",i.protocolUrlMatch=!1,i.protocolRelativeMatch=!1,i.stripPrefix={scheme:!0,www:!0},i.stripTrailingSlash=!0,i.decodePercentEncoding=!0,i.schemePrefixRegex=/^(https?:\/\/)?/i,i.wwwPrefixRegex=/^(https?:\/\/)?(www\.)?/i,i.protocolRelativeRegex=/^\/\//,i.protocolPrepended=!1,i.urlMatchType=e.urlMatchType,i.url=e.url,i.protocolUrlMatch=e.protocolUrlMatch,i.protocolRelativeMatch=e.protocolRelativeMatch,i.stripPrefix=e.stripPrefix,i.stripTrailingSlash=e.stripTrailingSlash,i.decodePercentEncoding=e.decodePercentEncoding,i}return Ae(t,n),t.prototype.getType=function(){return"url"},t.prototype.getUrlMatchType=function(){return this.urlMatchType},t.prototype.getUrl=function(){var e=this.url;return!this.protocolRelativeMatch&&!this.protocolUrlMatch&&!this.protocolPrepended&&(e=this.url="http://"+e,this.protocolPrepended=!0),e},t.prototype.getAnchorHref=function(){return this.getUrl().replace(/&amp;/g,"&")},t.prototype.getAnchorText=function(){var e=this.getMatchedText();return this.protocolRelativeMatch&&(e=this.stripProtocolRelativePrefix(e)),this.stripPrefix.scheme&&(e=this.stripSchemePrefix(e)),this.stripPrefix.www&&(e=this.stripWwwPrefix(e)),this.stripTrailingSlash&&(e=this.removeTrailingSlash(e)),this.decodePercentEncoding&&(e=this.removePercentEncoding(e)),e},t.prototype.stripSchemePrefix=function(e){return e.replace(this.schemePrefixRegex,"")},t.prototype.stripWwwPrefix=function(e){return e.replace(this.wwwPrefixRegex,"$1")},t.prototype.stripProtocolRelativePrefix=function(e){return e.replace(this.protocolRelativeRegex,"")},t.prototype.removeTrailingSlash=function(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e},t.prototype.removePercentEncoding=function(e){var i=e.replace(/%22/gi,"&quot;").replace(/%26/gi,"&amp;").replace(/%27/gi,"&#39;").replace(/%3C/gi,"&lt;").replace(/%3E/gi,"&gt;");try{return decodeURIComponent(i)}catch(r){return i}},t}(fp),hp=function n(t){this.__jsduckDummyDocProp=null,this.tagBuilder=t.tagBuilder},Ax=/[A-Za-z]/,yL=/[\d]/,CL=/[\D]/,xf=/\s/,Px=/['"]/,xL=/[\x00-\x1F\x7F]/,sk=/A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC/.source,ak=sk+/\u2700-\u27bf\udde6-\uddff\ud800-\udbff\udc00-\udfff\ufe0e\ufe0f\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0\ud83c\udffb-\udfff\u200d\u3299\u3297\u303d\u3030\u24c2\ud83c\udd70-\udd71\udd7e-\udd7f\udd8e\udd91-\udd9a\udde6-\uddff\ude01-\ude02\ude1a\ude2f\ude32-\ude3a\ude50-\ude51\u203c\u2049\u25aa-\u25ab\u25b6\u25c0\u25fb-\u25fe\u00a9\u00ae\u2122\u2139\udc04\u2600-\u26FF\u2b05\u2b06\u2b07\u2b1b\u2b1c\u2b50\u2b55\u231a\u231b\u2328\u23cf\u23e9-\u23f3\u23f8-\u23fa\udccf\u2935\u2934\u2190-\u21ff/.source+/\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D4-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D01-\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F/.source,Dv=/0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19/.source,TL=ak+Dv,Ji=ak+Dv,SL="(?:["+Dv+"]{1,3}\\.){3}["+Dv+"]{1,3}",DL="["+Ji+"](?:["+Ji+"\\-]{0,61}["+Ji+"])?",lk=function(n){return"(?=("+DL+"))\\"+n},Fx=function(n){return"(?:"+lk(n)+"(?:\\."+lk(n+1)+"){0,126}|"+SL+")"},Iv=(new RegExp("["+Ji+".\\-]*["+Ji+"\\-]"),new RegExp("[".concat(Ji,"]"))),ck=/(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|northwesternmutual|travelersinsurance|verm\xf6gensberatung|xn--3oq18vl8pn36a|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbah1a3hjkrd|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|verm\xf6gensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--mgbcpq6gpa1a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbaakc7dvf|xn--mgbc0a9azcg|xn--nqv7fs00ema|afamilycompany|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--h2breg3eve|xn--jlq480n2rg|xn--jlq61u9w7b|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|xn--rvc1e0am3e|international|lifeinsurance|travelchannel|wolterskluwer|xn--cckwcxetd|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--h2brj9c8c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|scholarships|versicherung|xn--3e0b707e|xn--45br5cyl|xn--4dbrk0ce|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbgu82a|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--3bst00m|xn--3ds443g|xn--3hcrj9c|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--mgbbh1a|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--otu796d|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b|\u0b9a\u0bbf\u0b99\u0bcd\u0b95\u0baa\u0bcd\u0baa\u0bc2\u0bb0\u0bcd|accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nextdirect|properties|protection|prudential|realestate|republican|restaurant|schaeffler|swiftcover|tatamotors|technology|university|vlaanderen|volkswagen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--q7ce6a|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|institute|insurance|kuokgroup|lancaster|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|passagens|pramerica|richardli|scjohnson|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--ngbrx|xn--nqv7f|xn--p1acf|xn--qxa6a|xn--tckwe|xn--vhquv|yodobashi|\u0645\u0648\u0631\u064a\u062a\u0627\u0646\u064a\u0627|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|budapest|builders|business|capetown|catering|catholic|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|etisalat|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|merckmsd|mortgage|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|training|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama|\u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629|abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|channel|charity|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lanxess|lasalle|latrobe|leclerc|limited|lincoln|markets|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|singles|staples|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|yamaxun|youtube|zuerich|\u043a\u0430\u0442\u043e\u043b\u0438\u043a|\u0627\u062a\u0635\u0627\u0644\u0627\u062a|\u0627\u0644\u0628\u062d\u0631\u064a\u0646|\u0627\u0644\u062c\u0632\u0627\u0626\u0631|\u0627\u0644\u0639\u0644\u064a\u0627\u0646|\u067e\u0627\u06a9\u0633\u062a\u0627\u0646|\u0643\u0627\u062b\u0648\u0644\u064a\u0643|\u0b87\u0ba8\u0bcd\u0ba4\u0bbf\u0baf\u0bbe|abarth|abbott|abbvie|africa|agency|airbus|airtel|alipay|alsace|alstom|amazon|anquan|aramco|author|bayern|beauty|berlin|bharti|bostik|boston|broker|camera|career|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|webcam|xihuan|yachts|yandex|zappos|\u043c\u043e\u0441\u043a\u0432\u0430|\u043e\u043d\u043b\u0430\u0439\u043d|\u0627\u0628\u0648\u0638\u0628\u064a|\u0627\u0631\u0627\u0645\u0643\u0648|\u0627\u0644\u0627\u0631\u062f\u0646|\u0627\u0644\u0645\u063a\u0631\u0628|\u0627\u0645\u0627\u0631\u0627\u062a|\u0641\u0644\u0633\u0637\u064a\u0646|\u0645\u0644\u064a\u0633\u064a\u0627|\u092d\u093e\u0930\u0924\u092e\u094d|\u0b87\u0bb2\u0b99\u0bcd\u0b95\u0bc8|\u30d5\u30a1\u30c3\u30b7\u30e7\u30f3|actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|drive|dubai|earth|edeka|email|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glade|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|irish|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|lixil|loans|locus|lotte|lotto|macys|mango|media|miami|money|movie|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo|\u05d9\u05e9\u05e8\u05d0\u05dc|\u0627\u06cc\u0631\u0627\u0646|\u0628\u0627\u0632\u0627\u0631|\u0628\u06be\u0627\u0631\u062a|\u0633\u0648\u062f\u0627\u0646|\u0633\u0648\u0631\u064a\u0629|\u0647\u0645\u0631\u0627\u0647|\u092d\u093e\u0930\u094b\u0924|\u0938\u0902\u0917\u0920\u0928|\u09ac\u09be\u0982\u09b2\u09be|\u0c2d\u0c3e\u0c30\u0c24\u0c4d|\u0d2d\u0d3e\u0d30\u0d24\u0d02|\u5609\u91cc\u5927\u9152\u5e97|aarp|able|adac|aero|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|duck|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|raid|read|reit|rent|rest|rich|rmit|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone|\u0434\u0435\u0442\u0438|\u0441\u0430\u0439\u0442|\u0628\u0627\u0631\u062a|\u0628\u064a\u062a\u0643|\u0680\u0627\u0631\u062a|\u062a\u0648\u0646\u0633|\u0634\u0628\u0643\u0629|\u0639\u0631\u0627\u0642|\u0639\u0645\u0627\u0646|\u0645\u0648\u0642\u0639|\u092d\u093e\u0930\u0924|\u09ad\u09be\u09b0\u09a4|\u09ad\u09be\u09f0\u09a4|\u0a2d\u0a3e\u0a30\u0a24|\u0aad\u0abe\u0ab0\u0aa4|\u0b2d\u0b3e\u0b30\u0b24|\u0cad\u0cbe\u0cb0\u0ca4|\u0dbd\u0d82\u0d9a\u0dcf|\u30a2\u30de\u30be\u30f3|\u30b0\u30fc\u30b0\u30eb|\u30af\u30e9\u30a6\u30c9|\u30dd\u30a4\u30f3\u30c8|\u5927\u4f17\u6c7d\u8f66|\u7ec4\u7ec7\u673a\u6784|\u96fb\u8a0a\u76c8\u79d1|\u9999\u683c\u91cc\u62c9|aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceo|cfa|cfd|com|cpa|crs|csc|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gay|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|llp|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|off|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|qvc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|spa|srl|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip|\u0431\u0435\u043b|\u043a\u043e\u043c|\u049b\u0430\u0437|\u043c\u043a\u0434|\u043c\u043e\u043d|\u043e\u0440\u0433|\u0440\u0443\u0441|\u0441\u0440\u0431|\u0443\u043a\u0440|\u0570\u0561\u0575|\u05e7\u05d5\u05dd|\u0639\u0631\u0628|\u0642\u0637\u0631|\u0643\u0648\u0645|\u0645\u0635\u0631|\u0915\u0949\u092e|\u0928\u0947\u091f|\u0e04\u0e2d\u0e21|\u0e44\u0e17\u0e22|\u0ea5\u0eb2\u0ea7|\u30b9\u30c8\u30a2|\u30bb\u30fc\u30eb|\u307f\u3093\u306a|\u4e2d\u6587\u7f51|\u4e9a\u9a6c\u900a|\u5929\u4e3b\u6559|\u6211\u7231\u4f60|\u65b0\u52a0\u5761|\u6de1\u9a6c\u9521|\u8bfa\u57fa\u4e9a|\u98de\u5229\u6d66|ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|\u03b5\u03bb|\u03b5\u03c5|\u0431\u0433|\u0435\u044e|\u0440\u0444|\u10d2\u10d4|\ub2f7\ub137|\ub2f7\ucef4|\uc0bc\uc131|\ud55c\uad6d|\u30b3\u30e0|\u4e16\u754c|\u4e2d\u4fe1|\u4e2d\u56fd|\u4e2d\u570b|\u4f01\u4e1a|\u4f5b\u5c71|\u4fe1\u606f|\u5065\u5eb7|\u516b\u5366|\u516c\u53f8|\u516c\u76ca|\u53f0\u6e7e|\u53f0\u7063|\u5546\u57ce|\u5546\u5e97|\u5546\u6807|\u5609\u91cc|\u5728\u7ebf|\u5927\u62ff|\u5a31\u4e50|\u5bb6\u96fb|\u5e7f\u4e1c|\u5fae\u535a|\u6148\u5584|\u624b\u673a|\u62db\u8058|\u653f\u52a1|\u653f\u5e9c|\u65b0\u95fb|\u65f6\u5c1a|\u66f8\u7c4d|\u673a\u6784|\u6e38\u620f|\u6fb3\u9580|\u70b9\u770b|\u79fb\u52a8|\u7f51\u5740|\u7f51\u5e97|\u7f51\u7ad9|\u7f51\u7edc|\u8054\u901a|\u8c37\u6b4c|\u8d2d\u7269|\u901a\u8ca9|\u96c6\u56e2|\u98df\u54c1|\u9910\u5385|\u9999\u6e2f)/,IL=new RegExp("[".concat(Ji,"!#$%&'*+/=?^_`{|}~-]")),kL=new RegExp("^".concat(ck.source,"$")),uk=function(n){function t(){var e=null!==n&&n.apply(this,arguments)||this;return e.localPartCharRegex=IL,e.strictTldRegex=kL,e}return Ae(t,n),t.prototype.parseMatches=function(e){for(var i=this.tagBuilder,r=this.localPartCharRegex,o=this.strictTldRegex,s=[],a=e.length,g=new kv,w={m:"a",a:"i",i:"l",l:"t",t:"o",o:":"},W=0,ve=0,me=g;W<a;){var Se=e.charAt(W);switch(ve){case 0:"m"===(It=Se)?Ot(1):r.test(It)&&Ot();break;case 1:Ve(e.charAt(W-1),Se);break;case 2:We(Se);break;case 3:Ze(Se);break;case 4:je(Se);break;case 5:ut(Se);break;case 6:ot(Se);break;case 7:ft(Se);break;default:JI(ve)}W++}var It;return Ut(),s;function Ve(It,Pt){":"===It?r.test(Pt)?(ve=2,me=new kv(de(de({},me),{hasMailtoPrefix:!0}))):Et():w[It]===Pt||(r.test(Pt)?ve=2:"."===Pt?ve=3:"@"===Pt?ve=4:Et())}function We(It){"."===It?ve=3:"@"===It?ve=4:r.test(It)||Et()}function Ze(It){"."===It||"@"===It?Et():r.test(It)?ve=2:Et()}function je(It){Iv.test(It)?ve=5:Et()}function ut(It){"."===It?ve=7:"-"===It?ve=6:Iv.test(It)||Ut()}function ot(It){"-"===It||"."===It?Ut():Iv.test(It)?ve=5:Ut()}function ft(It){"."===It||"-"===It?Ut():Iv.test(It)?(ve=5,me=new kv(de(de({},me),{hasDomainDot:!0}))):Ut()}function Ot(It){void 0===It&&(It=2),ve=It,me=new kv({idx:W})}function Et(){ve=0,me=g}function Ut(){if(me.hasDomainDot){var It=e.slice(me.idx,W);/[-.]$/.test(It)&&(It=It.slice(0,-1));var Pt=me.hasMailtoPrefix?It.slice(7):It;(function Wt(ci){var gi=(ci.split(".").pop()||"").toLowerCase();return o.test(gi)})(Pt)&&s.push(new tk({tagBuilder:i,matchedText:It,offset:me.idx,email:Pt}))}Et()}},t}(hp),kv=function n(t){void 0===t&&(t={}),this.idx=void 0!==t.idx?t.idx:-1,this.hasMailtoPrefix=!!t.hasMailtoPrefix,this.hasDomainDot=!!t.hasDomainDot},ML=function(){function n(){}return n.isValid=function(t,e){return!(e&&!this.isValidUriScheme(e)||this.urlMatchDoesNotHaveProtocolOrDot(t,e)||this.urlMatchDoesNotHaveAtLeastOneWordChar(t,e)&&!this.isValidIpAddress(t)||this.containsMultipleDots(t))},n.isValidIpAddress=function(t){var e=new RegExp(this.hasFullProtocolRegex.source+this.ipRegex.source);return null!==t.match(e)},n.containsMultipleDots=function(t){var e=t;return this.hasFullProtocolRegex.test(t)&&(e=t.split("://")[1]),e.split("/")[0].indexOf("..")>-1},n.isValidUriScheme=function(t){var e=t.match(this.uriSchemeRegex),i=e&&e[0].toLowerCase();return"javascript:"!==i&&"vbscript:"!==i},n.urlMatchDoesNotHaveProtocolOrDot=function(t,e){return!(!t||e&&this.hasFullProtocolRegex.test(e)||-1!==t.indexOf("."))},n.urlMatchDoesNotHaveAtLeastOneWordChar=function(t,e){return!(!t||!e||this.hasFullProtocolRegex.test(e)||this.hasWordCharAfterProtocolRegex.test(t))},n.hasFullProtocolRegex=/^[A-Za-z][-.+A-Za-z0-9]*:\/\//,n.uriSchemeRegex=/^[A-Za-z][-.+A-Za-z0-9]*:/,n.hasWordCharAfterProtocolRegex=new RegExp(":[^\\s]*?["+sk+"]"),n.ipRegex=/[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?(:[0-9]*)?\/?$/,n}(),AL=(e=new RegExp("[/?#](?:["+Ji+"\\-+&@#/%=~_()|'$*\\[\\]{}?!:,.;^\u2713]*["+Ji+"\\-+&@#/%=~_()|'$*\\[\\]{}\u2713])?"),new RegExp(["(?:","(",/(?:[A-Za-z][-.+A-Za-z0-9]{0,63}:(?![A-Za-z][-.+A-Za-z0-9]{0,63}:\/\/)(?!\d+\/?)(?:\/\/)?)/.source,Fx(2),")","|","(","(//)?",/(?:www\.)/.source,Fx(6),")","|","(","(//)?",Fx(10)+"\\.",ck.source,"(?![-"+TL+"])",")",")","(?::[0-9]+)?","(?:"+e.source+")?"].join(""),"gi")),PL=new RegExp("["+Ji+"]"),dk=function(n){function t(e){var i=n.call(this,e)||this;return i.stripPrefix={scheme:!0,www:!0},i.stripTrailingSlash=!0,i.decodePercentEncoding=!0,i.matcherRegex=AL,i.wordCharRegExp=PL,i.stripPrefix=e.stripPrefix,i.stripTrailingSlash=e.stripTrailingSlash,i.decodePercentEncoding=e.decodePercentEncoding,i}return Ae(t,n),t.prototype.parseMatches=function(e){for(var w,i=this.matcherRegex,r=this.stripPrefix,o=this.stripTrailingSlash,s=this.decodePercentEncoding,a=this.tagBuilder,g=[],W=function(){var me=w[0],Se=w[1],Oe=w[4],Ze=w.index,je=w[5]||w[9],ut=e.charAt(Ze-1);if(!ML.isValid(me,Se)||Ze>0&&"@"===ut||Ze>0&&je&&ve.wordCharRegExp.test(ut))return"continue";if(/\?$/.test(me)&&(me=me.substr(0,me.length-1)),ve.matchHasUnbalancedClosingParen(me))me=me.substr(0,me.length-1);else{var ot=ve.matchHasInvalidCharAfterTld(me,Se);ot>-1&&(me=me.substr(0,ot))}var ft=["http://","https://"].find(function(It){return!!Se&&-1!==Se.indexOf(It)});if(ft){var Ot=me.indexOf(ft);me=me.substr(Ot),Se=Se.substr(Ot),Ze+=Ot}g.push(new ok({tagBuilder:a,matchedText:me,offset:Ze,urlMatchType:Se?"scheme":Oe?"www":"tld",url:me,protocolUrlMatch:!!Se,protocolRelativeMatch:!!je,stripPrefix:r,stripTrailingSlash:o,decodePercentEncoding:s}))},ve=this;null!==(w=i.exec(e));)W();return g},t.prototype.matchHasUnbalancedClosingParen=function(e){var r,i=e.charAt(e.length-1);if(")"===i)r="(";else if("]"===i)r="[";else{if("}"!==i)return!1;r="{"}for(var o=0,s=0,a=e.length-1;s<a;s++){var g=e.charAt(s);g===r?o++:g===i&&(o=Math.max(o-1,0))}return 0===o},t.prototype.matchHasInvalidCharAfterTld=function(e,i){if(!e)return-1;var r=0;i&&(r=e.indexOf(":"),e=e.slice(r));var s=new RegExp("^((.?//)?[-."+Ji+"]*[-"+Ji+"]\\.[-"+Ji+"]+)").exec(e);return null===s?-1:(r+=s[1].length,e=e.slice(s[1].length),/^[^-.A-Za-z0-9:\/?#]/.test(e)?r:-1)},t}(hp),FL=new RegExp("#[_".concat(Ji,"]{1,139}(?![_").concat(Ji,"])"),"g"),RL=new RegExp("[^"+Ji+"]"),fk=function(n){function t(e){var i=n.call(this,e)||this;return i.serviceName="twitter",i.matcherRegex=FL,i.nonWordCharRegex=RL,i.serviceName=e.serviceName,i}return Ae(t,n),t.prototype.parseMatches=function(e){for(var g,i=this.matcherRegex,r=this.nonWordCharRegex,o=this.serviceName,s=this.tagBuilder,a=[];null!==(g=i.exec(e));){var w=g.index,W=e.charAt(w-1);if(0===w||r.test(W)){var ve=g[0],me=g[0].slice(1);a.push(new nk({tagBuilder:s,matchedText:ve,offset:w,serviceName:o,hashtag:me}))}}return a},t}(hp),BL=new RegExp("".concat(/(?:(?:(?:(\+)?\d{1,3}[-\040.]?)?\(?\d{3}\)?[-\040.]?\d{3}[-\040.]?\d{4})|(?:(\+)(?:9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)[-\040.]?(?:\d[-\040.]?){6,12}\d+))([,;]+[0-9]+#?)*/.source,"|").concat(/(0([1-9]{1}-?[1-9]\d{3}|[1-9]{2}-?\d{3}|[1-9]{2}\d{1}-?\d{2}|[1-9]{2}\d{2}-?\d{1})-?\d{4}|0[789]0-?\d{4}-?\d{4}|050-?\d{4}-?\d{4})/.source),"g"),hk=function(n){function t(){var e=null!==n&&n.apply(this,arguments)||this;return e.matcherRegex=BL,e}return Ae(t,n),t.prototype.parseMatches=function(e){for(var s,i=this.matcherRegex,r=this.tagBuilder,o=[];null!==(s=i.exec(e));){var a=s[0],g=a.replace(/[^0-9,;#]/g,""),w=!(!s[1]&&!s[2]),W=0==s.index?"":e.substr(s.index-1,1),ve=e.substr(s.index+a.length,1),me=!W.match(/\d/)&&!ve.match(/\d/);this.testMatch(s[3])&&this.testMatch(a)&&me&&o.push(new rk({tagBuilder:r,matchedText:a,offset:s.index,number:g,plusSign:w}))}return o},t.prototype.testMatch=function(e){return CL.test(e)},t}(hp),LL=new RegExp("@[_".concat(Ji,"]{1,50}(?![_").concat(Ji,"])"),"g"),zL=new RegExp("@[_.".concat(Ji,"]{1,30}(?![_").concat(Ji,"])"),"g"),HL=new RegExp("@[-_.".concat(Ji,"]{1,50}(?![-_").concat(Ji,"])"),"g"),VL=new RegExp("@[_.".concat(Ji,"]{1,23}[_").concat(Ji,"](?![_").concat(Ji,"])"),"g"),UL=new RegExp("[^"+Ji+"]"),pk=function(n){function t(e){var i=n.call(this,e)||this;return i.serviceName="twitter",i.matcherRegexes={twitter:LL,instagram:zL,soundcloud:HL,tiktok:VL},i.nonWordCharRegex=UL,i.serviceName=e.serviceName,i}return Ae(t,n),t.prototype.parseMatches=function(e){var g,i=this.serviceName,r=this.matcherRegexes[this.serviceName],o=this.nonWordCharRegex,s=this.tagBuilder,a=[];if(!r)return a;for(;null!==(g=r.exec(e));){var w=g.index,W=e.charAt(w-1);if(0===w||o.test(W)){var ve=g[0].replace(/\.+$/g,""),me=ve.slice(1);a.push(new ik({tagBuilder:s,matchedText:ve,offset:w,serviceName:i,mention:me}))}}return a},t}(hp);var sc=function n(t){void 0===t&&(t={}),this.idx=void 0!==t.idx?t.idx:-1,this.type=t.type||"tag",this.name=t.name||"",this.isOpening=!!t.isOpening,this.isClosing=!!t.isClosing},GL=function(){function n(t){void 0===t&&(t={}),this.version=n.version,this.urls={},this.email=!0,this.phone=!0,this.hashtag=!1,this.mention=!1,this.newWindow=!0,this.stripPrefix={scheme:!0,www:!0},this.stripTrailingSlash=!0,this.decodePercentEncoding=!0,this.truncate={length:0,location:"end"},this.className="",this.replaceFn=null,this.context=void 0,this.sanitizeHtml=!1,this.matchers=null,this.tagBuilder=null,this.urls=this.normalizeUrlsCfg(t.urls),this.email="boolean"==typeof t.email?t.email:this.email,this.phone="boolean"==typeof t.phone?t.phone:this.phone,this.hashtag=t.hashtag||this.hashtag,this.mention=t.mention||this.mention,this.newWindow="boolean"==typeof t.newWindow?t.newWindow:this.newWindow,this.stripPrefix=this.normalizeStripPrefixCfg(t.stripPrefix),this.stripTrailingSlash="boolean"==typeof t.stripTrailingSlash?t.stripTrailingSlash:this.stripTrailingSlash,this.decodePercentEncoding="boolean"==typeof t.decodePercentEncoding?t.decodePercentEncoding:this.decodePercentEncoding,this.sanitizeHtml=t.sanitizeHtml||!1;var e=this.mention;if(!1!==e&&-1===["twitter","instagram","soundcloud","tiktok"].indexOf(e))throw new Error("invalid `mention` cfg '".concat(e,"' - see docs"));var i=this.hashtag;if(!1!==i&&-1===["twitter","facebook","instagram","tiktok"].indexOf(i))throw new Error("invalid `hashtag` cfg '".concat(i,"' - see docs"));this.truncate=this.normalizeTruncateCfg(t.truncate),this.className=t.className||this.className,this.replaceFn=t.replaceFn||this.replaceFn,this.context=t.context||this}return n.link=function(t,e){return new n(e).link(t)},n.parse=function(t,e){return new n(e).parse(t)},n.prototype.normalizeUrlsCfg=function(t){return null==t&&(t=!0),"boolean"==typeof t?{schemeMatches:t,wwwMatches:t,tldMatches:t}:{schemeMatches:"boolean"!=typeof t.schemeMatches||t.schemeMatches,wwwMatches:"boolean"!=typeof t.wwwMatches||t.wwwMatches,tldMatches:"boolean"!=typeof t.tldMatches||t.tldMatches}},n.prototype.normalizeStripPrefixCfg=function(t){return null==t&&(t=!0),"boolean"==typeof t?{scheme:t,www:t}:{scheme:"boolean"!=typeof t.scheme||t.scheme,www:"boolean"!=typeof t.www||t.www}},n.prototype.normalizeTruncateCfg=function(t){return"number"==typeof t?{length:t,location:"end"}:function gL(n,t){for(var e in t)t.hasOwnProperty(e)&&void 0===n[e]&&(n[e]=t[e]);return n}(t||{},{length:Number.POSITIVE_INFINITY,location:"end"})},n.prototype.parse=function(t){var e=this,i=["a","style","script"],r=0,o=[];return function jL(n,t){for(var e=t.onOpenTag,i=t.onCloseTag,r=t.onText,o=t.onComment,s=t.onDoctype,a=new sc,g=0,w=n.length,W=0,ve=0,me=a;g<w;){var Se=n.charAt(g);switch(W){case 0:"<"===Se&&Wn();break;case 1:"!"===(Mt=Se)?W=13:"/"===Mt?(W=2,me=new sc(de(de({},me),{isClosing:!0}))):"<"===Mt?Wn():Ax.test(Mt)?(W=3,me=new sc(de(de({},me),{isOpening:!0}))):(W=0,me=a);break;case 2:Ze(Se);break;case 3:We(Se);break;case 4:je(Se);break;case 5:ut(Se);break;case 6:ot(Se);break;case 7:ft(Se);break;case 8:Ot(Se);break;case 9:Et(Se);break;case 10:Ut(Se);break;case 11:It(Se);break;case 12:Pt(Se);break;case 13:"--"===n.substr(g,2)?(g+=2,me=new sc(de(de({},me),{type:"comment"})),W=14):"DOCTYPE"===n.substr(g,7).toUpperCase()?(g+=7,me=new sc(de(de({},me),{type:"doctype"})),W=20):dn();break;case 14:ci(Se);break;case 15:Jn(Se);break;case 16:gi(Se);break;case 17:Ri(Se);break;case 18:Rt(Se);break;case 19:Zt(Se);break;case 20:tn(Se);break;default:JI(W)}g++}var Mt;function We(Mt){xf.test(Mt)?(me=new sc(de(de({},me),{name:ar()})),W=4):"<"===Mt?Wn():"/"===Mt?(me=new sc(de(de({},me),{name:ar()})),W=12):">"===Mt?(me=new sc(de(de({},me),{name:ar()})),$i()):!Ax.test(Mt)&&!yL.test(Mt)&&":"!==Mt&&dn()}function Ze(Mt){">"===Mt?dn():Ax.test(Mt)?W=3:dn()}function je(Mt){xf.test(Mt)||("/"===Mt?W=12:">"===Mt?$i():"<"===Mt?Wn():"="===Mt||Px.test(Mt)||xL.test(Mt)?dn():W=5)}function ut(Mt){xf.test(Mt)?W=6:"/"===Mt?W=12:"="===Mt?W=7:">"===Mt?$i():"<"===Mt?Wn():Px.test(Mt)&&dn()}function ot(Mt){xf.test(Mt)||("/"===Mt?W=12:"="===Mt?W=7:">"===Mt?$i():"<"===Mt?Wn():Px.test(Mt)?dn():W=5)}function ft(Mt){xf.test(Mt)||('"'===Mt?W=8:"'"===Mt?W=9:/[>=`]/.test(Mt)?dn():"<"===Mt?Wn():W=10)}function Ot(Mt){'"'===Mt&&(W=11)}function Et(Mt){"'"===Mt&&(W=11)}function Ut(Mt){xf.test(Mt)?W=4:">"===Mt?$i():"<"===Mt&&Wn()}function It(Mt){xf.test(Mt)?W=4:"/"===Mt?W=12:">"===Mt?$i():"<"===Mt?Wn():(W=4,function vi(){g--}())}function Pt(Mt){">"===Mt?(me=new sc(de(de({},me),{isClosing:!0})),$i()):W=4}function ci(Mt){"-"===Mt?W=15:">"===Mt?dn():W=16}function Jn(Mt){"-"===Mt?W=18:">"===Mt?dn():W=16}function gi(Mt){"-"===Mt&&(W=17)}function Ri(Mt){W="-"===Mt?18:16}function Rt(Mt){">"===Mt?$i():"!"===Mt?W=19:"-"===Mt||(W=16)}function Zt(Mt){"-"===Mt?W=17:">"===Mt?$i():W=16}function tn(Mt){">"===Mt?$i():"<"===Mt&&Wn()}function dn(){W=0,me=a}function Wn(){W=1,me=new sc({idx:g})}function $i(){var Mt=n.slice(ve,me.idx);Mt&&r(Mt,ve),"comment"===me.type?o(me.idx):"doctype"===me.type?s(me.idx):(me.isOpening&&e(me.name,me.idx),me.isClosing&&i(me.name,me.idx)),dn(),ve=g+1}function ar(){return n.slice(me.idx+(me.isClosing?2:1),g).toLowerCase()}ve<g&&function Mi(){var Mt=n.slice(ve,g);r(Mt,ve),ve=g+1}()}(t,{onOpenTag:function(s){i.indexOf(s)>=0&&r++},onText:function(s,a){if(0===r){var w=function mL(n,t){if(!t.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var r,e=[],i=0;r=t.exec(n);)e.push(n.substring(i,r.index)),e.push(r[0]),i=r.index+r[0].length;return e.push(n.substring(i)),e}(s,/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi),W=a;w.forEach(function(ve,me){if(me%2==0){var Se=e.parseText(ve,W);o.push.apply(o,Se)}W+=ve.length})}},onCloseTag:function(s){i.indexOf(s)>=0&&(r=Math.max(r-1,0))},onComment:function(s){},onDoctype:function(s){}}),o=this.compactMatches(o),o=this.removeUnwantedMatches(o)},n.prototype.compactMatches=function(t){t.sort(function(g,w){return g.getOffset()-w.getOffset()});for(var e=0;e<t.length-1;){var i=t[e],r=i.getOffset(),o=i.getMatchedText().length,s=r+o;if(e+1<t.length){if(t[e+1].getOffset()===r){var a=t[e+1].getMatchedText().length>o?e:e+1;t.splice(a,1);continue}if(t[e+1].getOffset()<s){t.splice(e+1,1);continue}}e++}return t},n.prototype.removeUnwantedMatches=function(t){return this.hashtag||Cf(t,function(e){return"hashtag"===e.getType()}),this.email||Cf(t,function(e){return"email"===e.getType()}),this.phone||Cf(t,function(e){return"phone"===e.getType()}),this.mention||Cf(t,function(e){return"mention"===e.getType()}),this.urls.schemeMatches||Cf(t,function(e){return"url"===e.getType()&&"scheme"===e.getUrlMatchType()}),this.urls.wwwMatches||Cf(t,function(e){return"url"===e.getType()&&"www"===e.getUrlMatchType()}),this.urls.tldMatches||Cf(t,function(e){return"url"===e.getType()&&"tld"===e.getUrlMatchType()}),t},n.prototype.parseText=function(t,e){void 0===e&&(e=0),e=e||0;for(var i=this.getMatchers(),r=[],o=0,s=i.length;o<s;o++){for(var a=i[o].parseMatches(t),g=0,w=a.length;g<w;g++)a[g].setOffset(e+a[g].getOffset());r.push.apply(r,a)}return r},n.prototype.link=function(t){if(!t)return"";this.sanitizeHtml&&(t=t.replace(/</g,"&lt;").replace(/>/g,"&gt;"));for(var e=this.parse(t),i=[],r=0,o=0,s=e.length;o<s;o++){var a=e[o];i.push(t.substring(r,a.getOffset())),i.push(this.createMatchReturnVal(a)),r=a.getOffset()+a.getMatchedText().length}return i.push(t.substring(r)),i.join("")},n.prototype.createMatchReturnVal=function(t){var e;return this.replaceFn&&(e=this.replaceFn.call(this.context,t)),"string"==typeof e?e:!1===e?t.getMatchedText():e instanceof Mx?e.toAnchorString():t.buildTag().toAnchorString()},n.prototype.getMatchers=function(){if(this.matchers)return this.matchers;var t=this.getTagBuilder(),e=[new fk({tagBuilder:t,serviceName:this.hashtag}),new uk({tagBuilder:t}),new hk({tagBuilder:t}),new pk({tagBuilder:t,serviceName:this.mention}),new dk({tagBuilder:t,stripPrefix:this.stripPrefix,stripTrailingSlash:this.stripTrailingSlash,decodePercentEncoding:this.decodePercentEncoding})];return this.matchers=e},n.prototype.getTagBuilder=function(){var t=this.tagBuilder;return t||(t=this.tagBuilder=new ek({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),t},n.version="3.15.0",n.AnchorTagBuilder=ek,n.HtmlTag=Mx,n.matcher={Email:uk,Hashtag:fk,Matcher:hp,Mention:pk,Phone:hk,Url:dk},n.match={Email:tk,Hashtag:nk,Match:fp,Mention:ik,Phone:rk,Url:ok},n}();const qL=GL;let Rx=(()=>{class n{transform(e,i){return qL.link(e,i)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=jr({name:"linky",type:n,pure:!0}),n})(),WL=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ns({type:n}),n.\u0275inj=ts({}),n})();function jc(n){return x((t,e)=>{Mo(n).subscribe($(e,()=>e.complete(),re)),!e.closed&&t.subscribe(e)})}class ZL extends D{constructor(t,e){super()}schedule(t,e=0){return this}}const Mv={setInterval(n,t,...e){const{delegate:i}=Mv;return(null==i?void 0:i.setInterval)?i.setInterval(n,t,...e):setInterval(n,t,...e)},clearInterval(n){const{delegate:t}=Mv;return((null==t?void 0:t.clearInterval)||clearInterval)(n)},delegate:void 0};class Nx extends ZL{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this}requestAsyncId(t,e,i=0){return Mv.setInterval(t.flush.bind(t,this),i)}recycleAsyncId(t,e,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return e;Mv.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(t,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let r,i=!1;try{this.work(t)}catch(o){i=!0,r=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:i}=e;this.work=this.state=this.scheduler=null,this.pending=!1,v(i,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}}const gk={now:()=>(gk.delegate||Date).now(),delegate:void 0};class _m{constructor(t,e=_m.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,i){return new this.schedulerActionCtor(this,t).schedule(i,e)}}_m.now=gk.now;class Ox extends _m{constructor(t,e=_m.now){super(t,e),this.actions=[],this._active=!1,this._scheduled=void 0}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let i;this._active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,i){for(;t=e.shift();)t.unsubscribe();throw i}}}const Bx=new Ox(Nx),YL=Bx;function JL(n,t=Bx){return function KL(n){return x((t,e)=>{let i=!1,r=null,o=null,s=!1;const a=()=>{if(null==o||o.unsubscribe(),o=null,i){i=!1;const w=r;r=null,e.next(w)}s&&e.complete()},g=()=>{o=null,s&&e.complete()};t.subscribe($(e,w=>{i=!0,r=w,o||Mo(n(w)).subscribe(o=$(e,a,g))},()=>{s=!0,(!i||!o||o.closed)&&e.complete()}))})}(()=>function QL(n=0,t,e=YL){let i=-1;return null!=t&&(Td(t)?e=t:i=t),new O(r=>{let o=function XL(n){return n instanceof Date&&!isNaN(n)}(n)?+n-e.now():n;o<0&&(o=0);let s=0;return e.schedule(function(){r.closed||(r.next(s++),0<=i?this.schedule(void 0,i):r.complete())},o)})}(n,t))}function _k(...n){return function ez(){return iu(1)}()(mo(n,kl(n)))}function Lx(...n){const t=kl(n);return x((e,i)=>{(t?_k(n,e,t):_k(n,e)).subscribe(i)})}function mk(n,t,e){const i=f(n)||t||e?{next:n,error:t,complete:e}:n;return i?x((r,o)=>{var s;null===(s=i.subscribe)||void 0===s||s.call(i);let a=!0;r.subscribe($(o,g=>{var w;null===(w=i.next)||void 0===w||w.call(i,g),o.next(g)},()=>{var g;a=!1,null===(g=i.complete)||void 0===g||g.call(i),o.complete()},g=>{var w;a=!1,null===(w=i.error)||void 0===w||w.call(i,g),o.error(g)},()=>{var g,w;a&&(null===(g=i.unsubscribe)||void 0===g||g.call(i)),null===(w=i.finalize)||void 0===w||w.call(i)}))}):F}function $k(n,t){return x((e,i)=>{let r=0;e.subscribe($(i,o=>n.call(t,o,r++)&&i.next(o)))})}const mm={schedule(n){let t=requestAnimationFrame,e=cancelAnimationFrame;const{delegate:i}=mm;i&&(t=i.requestAnimationFrame,e=i.cancelAnimationFrame);const r=t(o=>{e=void 0,n(o)});return new D(()=>null==e?void 0:e(r))},requestAnimationFrame(...n){const{delegate:t}=mm;return((null==t?void 0:t.requestAnimationFrame)||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:t}=mm;return((null==t?void 0:t.cancelAnimationFrame)||cancelAnimationFrame)(...n)},delegate:void 0},rz=new class iz extends Ox{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;t=t||i.shift();do{if(r=t.execute(t.state,t.delay))break}while((t=i[0])&&t.id===e&&i.shift());if(this._active=!1,r){for(;(t=i[0])&&t.id===e&&i.shift();)t.unsubscribe();throw r}}}(class nz extends Nx{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,i=0){return null!==i&&i>0?super.requestAsyncId(t,e,i):(t.actions.push(this),t._scheduled||(t._scheduled=mm.requestAnimationFrame(()=>t.flush(void 0))))}recycleAsyncId(t,e,i=0){if(null!=i&&i>0||null==i&&this.delay>0)return super.recycleAsyncId(t,e,i);t.actions.some(r=>r.id===e)||(mm.cancelAnimationFrame(e),t._scheduled=void 0)}});let zx,oz=1;const Av={};function vk(n){return n in Av&&(delete Av[n],!0)}const sz={setImmediate(n){const t=oz++;return Av[t]=!0,zx||(zx=Promise.resolve()),zx.then(()=>vk(t)&&n()),t},clearImmediate(n){vk(n)}},{setImmediate:az,clearImmediate:lz}=sz,Pv={setImmediate(...n){const{delegate:t}=Pv;return((null==t?void 0:t.setImmediate)||az)(...n)},clearImmediate(n){const{delegate:t}=Pv;return((null==t?void 0:t.clearImmediate)||lz)(n)},delegate:void 0},dz=new class uz extends Ox{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;t=t||i.shift();do{if(r=t.execute(t.state,t.delay))break}while((t=i[0])&&t.id===e&&i.shift());if(this._active=!1,r){for(;(t=i[0])&&t.id===e&&i.shift();)t.unsubscribe();throw r}}}(class cz extends Nx{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,i=0){return null!==i&&i>0?super.requestAsyncId(t,e,i):(t.actions.push(this),t._scheduled||(t._scheduled=Pv.setImmediate(t.flush.bind(t,void 0))))}recycleAsyncId(t,e,i=0){if(null!=i&&i>0||null==i&&this.delay>0)return super.recycleAsyncId(t,e,i);t.actions.some(r=>r.id===e)||(Pv.clearImmediate(e),t._scheduled=void 0)}}),fz=["addListener","removeListener"],hz=["addEventListener","removeEventListener"],pz=["on","off"];function pp(n,t,e,i){if(f(e)&&(i=e,e=void 0),i)return pp(n,t,e).pipe(lm(i));const[r,o]=function mz(n){return f(n.addEventListener)&&f(n.removeEventListener)}(n)?hz.map(s=>a=>n[s](t,a,e)):function gz(n){return f(n.addListener)&&f(n.removeListener)}(n)?fz.map(bk(n,t)):function _z(n){return f(n.on)&&f(n.off)}(n)?pz.map(bk(n,t)):[];if(!r&&Hi(n))return bc(s=>pp(s,t,e))(Mo(n));if(!r)throw new TypeError("Invalid event target");return new O(s=>{const a=(...g)=>s.next(1<g.length?g:g[0]);return r(a),()=>o(a)})}function bk(n,t){return e=>i=>n[e](t,i)}const $z=["content"],vz=["scroll"],bz=["padding"],$m=function(n){return{searchTerm:n}};function yz(n,t){if(1&n&&(J(0,"div",6),pn(1,7),oe()),2&n){const e=$e();j(1),ie("ngTemplateOutlet",e.headerTemplate)("ngTemplateOutletContext",Nt(2,$m,e.filterValue))}}function Cz(n,t){if(1&n&&(J(0,"div",8),pn(1,7),oe()),2&n){const e=$e();j(1),ie("ngTemplateOutlet",e.footerTemplate)("ngTemplateOutletContext",Nt(2,$m,e.filterValue))}}const yk=["*"],xz=["searchInput"];function wz(n,t){if(1&n){const e=pt();J(0,"span",15),Re("click",function(){Le(e);const r=$e().$implicit;return $e(2).unselect(r)}),we(1,"\xd7"),oe(),it(2,"span",16)}if(2&n){const e=$e().$implicit,i=$e(2);j(2),ie("ngItemLabel",e.label)("escape",i.escapeHTML)}}function Ez(n,t){}const Tz=function(n,t,e){return{item:n,clear:t,label:e}};function Sz(n,t){if(1&n&&(J(0,"div",12),Ee(1,wz,3,2,"ng-template",null,13,Ln),Ee(3,Ez,0,0,"ng-template",14),oe()),2&n){const e=t.$implicit,i=ln(2),r=$e(2);Aa("ng-value-disabled",e.disabled),j(3),ie("ngTemplateOutlet",r.labelTemplate||i)("ngTemplateOutletContext",Wo(4,Tz,e.value,r.clearItem,e.label))}}function Dz(n,t){if(1&n&&(Je(0),Ee(1,Sz,4,8,"div",11),et()),2&n){const e=$e();j(1),ie("ngForOf",e.selectedItems)("ngForTrackBy",e.trackByOption)}}function Iz(n,t){}const kz=function(n,t){return{items:n,clear:t}};function Mz(n,t){if(1&n&&Ee(0,Iz,0,0,"ng-template",14),2&n){const e=$e();ie("ngTemplateOutlet",e.multiLabelTemplate)("ngTemplateOutletContext",hi(2,kz,e.selectedValues,e.clearItem))}}function Az(n,t){1&n&&it(0,"div",19)}function Pz(n,t){}function Fz(n,t){if(1&n&&(Je(0),Ee(1,Az,1,0,"ng-template",null,17,Ln),Ee(3,Pz,0,0,"ng-template",18),et()),2&n){const e=ln(2),i=$e();j(3),ie("ngTemplateOutlet",i.loadingSpinnerTemplate||e)}}function Rz(n,t){1&n&&(J(0,"span",20)(1,"span",21),we(2,"\xd7"),oe()()),2&n&&Ht("title",$e().clearAllText)}function Nz(n,t){if(1&n&&it(0,"span",27),2&n){const e=$e().$implicit,i=$e(2);ie("ngItemLabel",e.label)("escape",i.escapeHTML)}}function Oz(n,t){}const Bz=function(n,t,e,i){return{item:n,item$:t,index:e,searchTerm:i}};function Lz(n,t){if(1&n){const e=pt();J(0,"div",25),Re("click",function(){const o=Le(e).$implicit;return $e(2).toggleItem(o)})("mouseover",function(){const o=Le(e).$implicit;return $e(2).onItemHover(o)}),Ee(1,Nz,1,2,"ng-template",null,26,Ln),Ee(3,Oz,0,0,"ng-template",14),oe()}if(2&n){const e=t.$implicit,i=ln(2),r=$e(2);Aa("ng-option-disabled",e.disabled)("ng-option-selected",e.selected)("ng-optgroup",e.children)("ng-option",!e.children)("ng-option-child",!!e.parent)("ng-option-marked",e===r.itemsList.markedItem),Yt("role",e.children?"group":"option")("aria-selected",e.selected)("id",null==e?null:e.htmlId),j(3),ie("ngTemplateOutlet",e.children?r.optgroupTemplate||i:r.optionTemplate||i)("ngTemplateOutletContext",Rr(17,Bz,e.value,e,e.index,r.searchTerm))}}function zz(n,t){if(1&n&&(J(0,"span")(1,"span",30),we(2),oe(),we(3),oe()),2&n){const e=$e(3);j(2),xt(e.addTagText),j(1),sn('"',e.searchTerm,'"')}}function Hz(n,t){}function Vz(n,t){if(1&n){const e=pt();J(0,"div",28),Re("mouseover",function(){return Le(e),$e(2).itemsList.unmarkItem()})("click",function(){return Le(e),$e(2).selectTag()}),Ee(1,zz,4,2,"ng-template",null,29,Ln),Ee(3,Hz,0,0,"ng-template",14),oe()}if(2&n){const e=ln(2),i=$e(2);Aa("ng-option-marked",!i.itemsList.markedItem),j(3),ie("ngTemplateOutlet",i.tagTemplate||e)("ngTemplateOutletContext",Nt(4,$m,i.searchTerm))}}function Uz(n,t){if(1&n&&(J(0,"div",32),we(1),oe()),2&n){const e=$e(3);j(1),xt(e.notFoundText)}}function jz(n,t){}function Gz(n,t){if(1&n&&(Je(0),Ee(1,Uz,2,1,"ng-template",null,31,Ln),Ee(3,jz,0,0,"ng-template",14),et()),2&n){const e=ln(2),i=$e(2);j(3),ie("ngTemplateOutlet",i.notFoundTemplate||e)("ngTemplateOutletContext",Nt(2,$m,i.searchTerm))}}function qz(n,t){if(1&n&&(J(0,"div",32),we(1),oe()),2&n){const e=$e(3);j(1),xt(e.typeToSearchText)}}function Wz(n,t){}function Zz(n,t){if(1&n&&(Je(0),Ee(1,qz,2,1,"ng-template",null,33,Ln),Ee(3,Wz,0,0,"ng-template",18),et()),2&n){const e=ln(2),i=$e(2);j(3),ie("ngTemplateOutlet",i.typeToSearchTemplate||e)}}function Yz(n,t){if(1&n&&(J(0,"div",32),we(1),oe()),2&n){const e=$e(3);j(1),xt(e.loadingText)}}function Kz(n,t){}function Xz(n,t){if(1&n&&(Je(0),Ee(1,Yz,2,1,"ng-template",null,34,Ln),Ee(3,Kz,0,0,"ng-template",14),et()),2&n){const e=ln(2),i=$e(2);j(3),ie("ngTemplateOutlet",i.loadingTextTemplate||e)("ngTemplateOutletContext",Nt(2,$m,i.searchTerm))}}function Qz(n,t){if(1&n){const e=pt();J(0,"ng-dropdown-panel",22),Re("update",function(r){return Le(e),$e().viewPortItems=r})("scroll",function(r){return Le(e),$e().scroll.emit(r)})("scrollToEnd",function(r){return Le(e),$e().scrollToEnd.emit(r)})("outsideClick",function(){return Le(e),$e().close()}),Je(1),Ee(2,Lz,4,22,"div",23),Ee(3,Vz,4,6,"div",24),et(),Ee(4,Gz,4,4,"ng-container",3),Ee(5,Zz,4,1,"ng-container",3),Ee(6,Xz,4,4,"ng-container",3),oe()}if(2&n){const e=$e();Aa("ng-select-multiple",e.multiple),ie("virtualScroll",e.virtualScroll)("bufferAmount",e.bufferAmount)("appendTo",e.appendTo)("position",e.dropdownPosition)("headerTemplate",e.headerTemplate)("footerTemplate",e.footerTemplate)("filterValue",e.searchTerm)("items",e.itemsList.filteredItems)("markedItem",e.itemsList.markedItem)("ngClass",e.appendTo?e.classes:null)("id",e.dropdownId),j(2),ie("ngForOf",e.viewPortItems)("ngForTrackBy",e.trackByOption),j(1),ie("ngIf",e.showAddTag),j(1),ie("ngIf",e.showNoItemsFound()),j(1),ie("ngIf",e.showTypeToSearch()),j(1),ie("ngIf",e.loading&&0===e.itemsList.filteredItems.length)}}const Ck=/[&<>"']/g,Jz=RegExp(Ck.source),e9={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function xr(n){return null!=n}function vm(n){return"object"==typeof n&&xr(n)}function Fv(n){return n instanceof Function}let i9=(()=>{class n{constructor(e){this.element=e,this.escape=!0}ngOnChanges(e){this.element.nativeElement.innerHTML=this.escape?function t9(n){return n&&Jz.test(n)?n.replace(Ck,t=>e9[t]):n}(this.ngItemLabel):this.ngItemLabel}}return n.\u0275fac=function(e){return new(e||n)(Be(fi))},n.\u0275dir=nn({type:n,selectors:[["","ngItemLabel",""]],inputs:{ngItemLabel:"ngItemLabel",escape:"escape"},features:[br]}),n})(),r9=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(Be(Ei))},n.\u0275dir=nn({type:n,selectors:[["","ng-option-tmp",""]]}),n})(),o9=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(Be(Ei))},n.\u0275dir=nn({type:n,selectors:[["","ng-optgroup-tmp",""]]}),n})(),s9=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(Be(Ei))},n.\u0275dir=nn({type:n,selectors:[["","ng-label-tmp",""]]}),n})(),a9=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(Be(Ei))},n.\u0275dir=nn({type:n,selectors:[["","ng-multi-label-tmp",""]]}),n})(),l9=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(Be(Ei))},n.\u0275dir=nn({type:n,selectors:[["","ng-header-tmp",""]]}),n})(),c9=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(Be(Ei))},n.\u0275dir=nn({type:n,selectors:[["","ng-footer-tmp",""]]}),n})(),u9=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(Be(Ei))},n.\u0275dir=nn({type:n,selectors:[["","ng-notfound-tmp",""]]}),n})(),d9=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(Be(Ei))},n.\u0275dir=nn({type:n,selectors:[["","ng-typetosearch-tmp",""]]}),n})(),f9=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(Be(Ei))},n.\u0275dir=nn({type:n,selectors:[["","ng-loadingtext-tmp",""]]}),n})(),h9=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(Be(Ei))},n.\u0275dir=nn({type:n,selectors:[["","ng-tag-tmp",""]]}),n})(),p9=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(Be(Ei))},n.\u0275dir=nn({type:n,selectors:[["","ng-loadingspinner-tmp",""]]}),n})();function xk(){return"axxxxxxxxxxx".replace(/[x]/g,()=>(16*Math.random()|0).toString(16))}const g9={"\u24b6":"A",\uff21:"A",\u00c0:"A",\u00c1:"A",\u00c2:"A",\u1ea6:"A",\u1ea4:"A",\u1eaa:"A",\u1ea8:"A",\u00c3:"A",\u0100:"A",\u0102:"A",\u1eb0:"A",\u1eae:"A",\u1eb4:"A",\u1eb2:"A",\u0226:"A",\u01e0:"A",\u00c4:"A",\u01de:"A",\u1ea2:"A",\u00c5:"A",\u01fa:"A",\u01cd:"A",\u0200:"A",\u0202:"A",\u1ea0:"A",\u1eac:"A",\u1eb6:"A",\u1e00:"A",\u0104:"A",\u023a:"A",\u2c6f:"A",\ua732:"AA",\u00c6:"AE",\u01fc:"AE",\u01e2:"AE",\ua734:"AO",\ua736:"AU",\ua738:"AV",\ua73a:"AV",\ua73c:"AY","\u24b7":"B",\uff22:"B",\u1e02:"B",\u1e04:"B",\u1e06:"B",\u0243:"B",\u0182:"B",\u0181:"B","\u24b8":"C",\uff23:"C",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u00c7:"C",\u1e08:"C",\u0187:"C",\u023b:"C",\ua73e:"C","\u24b9":"D",\uff24:"D",\u1e0a:"D",\u010e:"D",\u1e0c:"D",\u1e10:"D",\u1e12:"D",\u1e0e:"D",\u0110:"D",\u018b:"D",\u018a:"D",\u0189:"D",\ua779:"D",\u01f1:"DZ",\u01c4:"DZ",\u01f2:"Dz",\u01c5:"Dz","\u24ba":"E",\uff25:"E",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u1ec0:"E",\u1ebe:"E",\u1ec4:"E",\u1ec2:"E",\u1ebc:"E",\u0112:"E",\u1e14:"E",\u1e16:"E",\u0114:"E",\u0116:"E",\u00cb:"E",\u1eba:"E",\u011a:"E",\u0204:"E",\u0206:"E",\u1eb8:"E",\u1ec6:"E",\u0228:"E",\u1e1c:"E",\u0118:"E",\u1e18:"E",\u1e1a:"E",\u0190:"E",\u018e:"E","\u24bb":"F",\uff26:"F",\u1e1e:"F",\u0191:"F",\ua77b:"F","\u24bc":"G",\uff27:"G",\u01f4:"G",\u011c:"G",\u1e20:"G",\u011e:"G",\u0120:"G",\u01e6:"G",\u0122:"G",\u01e4:"G",\u0193:"G",\ua7a0:"G",\ua77d:"G",\ua77e:"G","\u24bd":"H",\uff28:"H",\u0124:"H",\u1e22:"H",\u1e26:"H",\u021e:"H",\u1e24:"H",\u1e28:"H",\u1e2a:"H",\u0126:"H",\u2c67:"H",\u2c75:"H",\ua78d:"H","\u24be":"I",\uff29:"I",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u0128:"I",\u012a:"I",\u012c:"I",\u0130:"I",\u00cf:"I",\u1e2e:"I",\u1ec8:"I",\u01cf:"I",\u0208:"I",\u020a:"I",\u1eca:"I",\u012e:"I",\u1e2c:"I",\u0197:"I","\u24bf":"J",\uff2a:"J",\u0134:"J",\u0248:"J","\u24c0":"K",\uff2b:"K",\u1e30:"K",\u01e8:"K",\u1e32:"K",\u0136:"K",\u1e34:"K",\u0198:"K",\u2c69:"K",\ua740:"K",\ua742:"K",\ua744:"K",\ua7a2:"K","\u24c1":"L",\uff2c:"L",\u013f:"L",\u0139:"L",\u013d:"L",\u1e36:"L",\u1e38:"L",\u013b:"L",\u1e3c:"L",\u1e3a:"L",\u0141:"L",\u023d:"L",\u2c62:"L",\u2c60:"L",\ua748:"L",\ua746:"L",\ua780:"L",\u01c7:"LJ",\u01c8:"Lj","\u24c2":"M",\uff2d:"M",\u1e3e:"M",\u1e40:"M",\u1e42:"M",\u2c6e:"M",\u019c:"M","\u24c3":"N",\uff2e:"N",\u01f8:"N",\u0143:"N",\u00d1:"N",\u1e44:"N",\u0147:"N",\u1e46:"N",\u0145:"N",\u1e4a:"N",\u1e48:"N",\u0220:"N",\u019d:"N",\ua790:"N",\ua7a4:"N",\u01ca:"NJ",\u01cb:"Nj","\u24c4":"O",\uff2f:"O",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u1ed2:"O",\u1ed0:"O",\u1ed6:"O",\u1ed4:"O",\u00d5:"O",\u1e4c:"O",\u022c:"O",\u1e4e:"O",\u014c:"O",\u1e50:"O",\u1e52:"O",\u014e:"O",\u022e:"O",\u0230:"O",\u00d6:"O",\u022a:"O",\u1ece:"O",\u0150:"O",\u01d1:"O",\u020c:"O",\u020e:"O",\u01a0:"O",\u1edc:"O",\u1eda:"O",\u1ee0:"O",\u1ede:"O",\u1ee2:"O",\u1ecc:"O",\u1ed8:"O",\u01ea:"O",\u01ec:"O",\u00d8:"O",\u01fe:"O",\u0186:"O",\u019f:"O",\ua74a:"O",\ua74c:"O",\u01a2:"OI",\ua74e:"OO",\u0222:"OU","\u24c5":"P",\uff30:"P",\u1e54:"P",\u1e56:"P",\u01a4:"P",\u2c63:"P",\ua750:"P",\ua752:"P",\ua754:"P","\u24c6":"Q",\uff31:"Q",\ua756:"Q",\ua758:"Q",\u024a:"Q","\u24c7":"R",\uff32:"R",\u0154:"R",\u1e58:"R",\u0158:"R",\u0210:"R",\u0212:"R",\u1e5a:"R",\u1e5c:"R",\u0156:"R",\u1e5e:"R",\u024c:"R",\u2c64:"R",\ua75a:"R",\ua7a6:"R",\ua782:"R","\u24c8":"S",\uff33:"S",\u1e9e:"S",\u015a:"S",\u1e64:"S",\u015c:"S",\u1e60:"S",\u0160:"S",\u1e66:"S",\u1e62:"S",\u1e68:"S",\u0218:"S",\u015e:"S",\u2c7e:"S",\ua7a8:"S",\ua784:"S","\u24c9":"T",\uff34:"T",\u1e6a:"T",\u0164:"T",\u1e6c:"T",\u021a:"T",\u0162:"T",\u1e70:"T",\u1e6e:"T",\u0166:"T",\u01ac:"T",\u01ae:"T",\u023e:"T",\ua786:"T",\ua728:"TZ","\u24ca":"U",\uff35:"U",\u00d9:"U",\u00da:"U",\u00db:"U",\u0168:"U",\u1e78:"U",\u016a:"U",\u1e7a:"U",\u016c:"U",\u00dc:"U",\u01db:"U",\u01d7:"U",\u01d5:"U",\u01d9:"U",\u1ee6:"U",\u016e:"U",\u0170:"U",\u01d3:"U",\u0214:"U",\u0216:"U",\u01af:"U",\u1eea:"U",\u1ee8:"U",\u1eee:"U",\u1eec:"U",\u1ef0:"U",\u1ee4:"U",\u1e72:"U",\u0172:"U",\u1e76:"U",\u1e74:"U",\u0244:"U","\u24cb":"V",\uff36:"V",\u1e7c:"V",\u1e7e:"V",\u01b2:"V",\ua75e:"V",\u0245:"V",\ua760:"VY","\u24cc":"W",\uff37:"W",\u1e80:"W",\u1e82:"W",\u0174:"W",\u1e86:"W",\u1e84:"W",\u1e88:"W",\u2c72:"W","\u24cd":"X",\uff38:"X",\u1e8a:"X",\u1e8c:"X","\u24ce":"Y",\uff39:"Y",\u1ef2:"Y",\u00dd:"Y",\u0176:"Y",\u1ef8:"Y",\u0232:"Y",\u1e8e:"Y",\u0178:"Y",\u1ef6:"Y",\u1ef4:"Y",\u01b3:"Y",\u024e:"Y",\u1efe:"Y","\u24cf":"Z",\uff3a:"Z",\u0179:"Z",\u1e90:"Z",\u017b:"Z",\u017d:"Z",\u1e92:"Z",\u1e94:"Z",\u01b5:"Z",\u0224:"Z",\u2c7f:"Z",\u2c6b:"Z",\ua762:"Z","\u24d0":"a",\uff41:"a",\u1e9a:"a",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u1ea7:"a",\u1ea5:"a",\u1eab:"a",\u1ea9:"a",\u00e3:"a",\u0101:"a",\u0103:"a",\u1eb1:"a",\u1eaf:"a",\u1eb5:"a",\u1eb3:"a",\u0227:"a",\u01e1:"a",\u00e4:"a",\u01df:"a",\u1ea3:"a",\u00e5:"a",\u01fb:"a",\u01ce:"a",\u0201:"a",\u0203:"a",\u1ea1:"a",\u1ead:"a",\u1eb7:"a",\u1e01:"a",\u0105:"a",\u2c65:"a",\u0250:"a",\ua733:"aa",\u00e6:"ae",\u01fd:"ae",\u01e3:"ae",\ua735:"ao",\ua737:"au",\ua739:"av",\ua73b:"av",\ua73d:"ay","\u24d1":"b",\uff42:"b",\u1e03:"b",\u1e05:"b",\u1e07:"b",\u0180:"b",\u0183:"b",\u0253:"b","\u24d2":"c",\uff43:"c",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u00e7:"c",\u1e09:"c",\u0188:"c",\u023c:"c",\ua73f:"c",\u2184:"c","\u24d3":"d",\uff44:"d",\u1e0b:"d",\u010f:"d",\u1e0d:"d",\u1e11:"d",\u1e13:"d",\u1e0f:"d",\u0111:"d",\u018c:"d",\u0256:"d",\u0257:"d",\ua77a:"d",\u01f3:"dz",\u01c6:"dz","\u24d4":"e",\uff45:"e",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u1ec1:"e",\u1ebf:"e",\u1ec5:"e",\u1ec3:"e",\u1ebd:"e",\u0113:"e",\u1e15:"e",\u1e17:"e",\u0115:"e",\u0117:"e",\u00eb:"e",\u1ebb:"e",\u011b:"e",\u0205:"e",\u0207:"e",\u1eb9:"e",\u1ec7:"e",\u0229:"e",\u1e1d:"e",\u0119:"e",\u1e19:"e",\u1e1b:"e",\u0247:"e",\u025b:"e",\u01dd:"e","\u24d5":"f",\uff46:"f",\u1e1f:"f",\u0192:"f",\ua77c:"f","\u24d6":"g",\uff47:"g",\u01f5:"g",\u011d:"g",\u1e21:"g",\u011f:"g",\u0121:"g",\u01e7:"g",\u0123:"g",\u01e5:"g",\u0260:"g",\ua7a1:"g",\u1d79:"g",\ua77f:"g","\u24d7":"h",\uff48:"h",\u0125:"h",\u1e23:"h",\u1e27:"h",\u021f:"h",\u1e25:"h",\u1e29:"h",\u1e2b:"h",\u1e96:"h",\u0127:"h",\u2c68:"h",\u2c76:"h",\u0265:"h",\u0195:"hv","\u24d8":"i",\uff49:"i",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u0129:"i",\u012b:"i",\u012d:"i",\u00ef:"i",\u1e2f:"i",\u1ec9:"i",\u01d0:"i",\u0209:"i",\u020b:"i",\u1ecb:"i",\u012f:"i",\u1e2d:"i",\u0268:"i",\u0131:"i","\u24d9":"j",\uff4a:"j",\u0135:"j",\u01f0:"j",\u0249:"j","\u24da":"k",\uff4b:"k",\u1e31:"k",\u01e9:"k",\u1e33:"k",\u0137:"k",\u1e35:"k",\u0199:"k",\u2c6a:"k",\ua741:"k",\ua743:"k",\ua745:"k",\ua7a3:"k","\u24db":"l",\uff4c:"l",\u0140:"l",\u013a:"l",\u013e:"l",\u1e37:"l",\u1e39:"l",\u013c:"l",\u1e3d:"l",\u1e3b:"l",\u017f:"l",\u0142:"l",\u019a:"l",\u026b:"l",\u2c61:"l",\ua749:"l",\ua781:"l",\ua747:"l",\u01c9:"lj","\u24dc":"m",\uff4d:"m",\u1e3f:"m",\u1e41:"m",\u1e43:"m",\u0271:"m",\u026f:"m","\u24dd":"n",\uff4e:"n",\u01f9:"n",\u0144:"n",\u00f1:"n",\u1e45:"n",\u0148:"n",\u1e47:"n",\u0146:"n",\u1e4b:"n",\u1e49:"n",\u019e:"n",\u0272:"n",\u0149:"n",\ua791:"n",\ua7a5:"n",\u01cc:"nj","\u24de":"o",\uff4f:"o",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u1ed3:"o",\u1ed1:"o",\u1ed7:"o",\u1ed5:"o",\u00f5:"o",\u1e4d:"o",\u022d:"o",\u1e4f:"o",\u014d:"o",\u1e51:"o",\u1e53:"o",\u014f:"o",\u022f:"o",\u0231:"o",\u00f6:"o",\u022b:"o",\u1ecf:"o",\u0151:"o",\u01d2:"o",\u020d:"o",\u020f:"o",\u01a1:"o",\u1edd:"o",\u1edb:"o",\u1ee1:"o",\u1edf:"o",\u1ee3:"o",\u1ecd:"o",\u1ed9:"o",\u01eb:"o",\u01ed:"o",\u00f8:"o",\u01ff:"o",\u0254:"o",\ua74b:"o",\ua74d:"o",\u0275:"o",\u01a3:"oi",\u0223:"ou",\ua74f:"oo","\u24df":"p",\uff50:"p",\u1e55:"p",\u1e57:"p",\u01a5:"p",\u1d7d:"p",\ua751:"p",\ua753:"p",\ua755:"p","\u24e0":"q",\uff51:"q",\u024b:"q",\ua757:"q",\ua759:"q","\u24e1":"r",\uff52:"r",\u0155:"r",\u1e59:"r",\u0159:"r",\u0211:"r",\u0213:"r",\u1e5b:"r",\u1e5d:"r",\u0157:"r",\u1e5f:"r",\u024d:"r",\u027d:"r",\ua75b:"r",\ua7a7:"r",\ua783:"r","\u24e2":"s",\uff53:"s",\u00df:"s",\u015b:"s",\u1e65:"s",\u015d:"s",\u1e61:"s",\u0161:"s",\u1e67:"s",\u1e63:"s",\u1e69:"s",\u0219:"s",\u015f:"s",\u023f:"s",\ua7a9:"s",\ua785:"s",\u1e9b:"s","\u24e3":"t",\uff54:"t",\u1e6b:"t",\u1e97:"t",\u0165:"t",\u1e6d:"t",\u021b:"t",\u0163:"t",\u1e71:"t",\u1e6f:"t",\u0167:"t",\u01ad:"t",\u0288:"t",\u2c66:"t",\ua787:"t",\ua729:"tz","\u24e4":"u",\uff55:"u",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u0169:"u",\u1e79:"u",\u016b:"u",\u1e7b:"u",\u016d:"u",\u00fc:"u",\u01dc:"u",\u01d8:"u",\u01d6:"u",\u01da:"u",\u1ee7:"u",\u016f:"u",\u0171:"u",\u01d4:"u",\u0215:"u",\u0217:"u",\u01b0:"u",\u1eeb:"u",\u1ee9:"u",\u1eef:"u",\u1eed:"u",\u1ef1:"u",\u1ee5:"u",\u1e73:"u",\u0173:"u",\u1e77:"u",\u1e75:"u",\u0289:"u","\u24e5":"v",\uff56:"v",\u1e7d:"v",\u1e7f:"v",\u028b:"v",\ua75f:"v",\u028c:"v",\ua761:"vy","\u24e6":"w",\uff57:"w",\u1e81:"w",\u1e83:"w",\u0175:"w",\u1e87:"w",\u1e85:"w",\u1e98:"w",\u1e89:"w",\u2c73:"w","\u24e7":"x",\uff58:"x",\u1e8b:"x",\u1e8d:"x","\u24e8":"y",\uff59:"y",\u1ef3:"y",\u00fd:"y",\u0177:"y",\u1ef9:"y",\u0233:"y",\u1e8f:"y",\u00ff:"y",\u1ef7:"y",\u1e99:"y",\u1ef5:"y",\u01b4:"y",\u024f:"y",\u1eff:"y","\u24e9":"z",\uff5a:"z",\u017a:"z",\u1e91:"z",\u017c:"z",\u017e:"z",\u1e93:"z",\u1e95:"z",\u01b6:"z",\u0225:"z",\u0240:"z",\u2c6c:"z",\ua763:"z",\u0386:"\u0391",\u0388:"\u0395",\u0389:"\u0397",\u038a:"\u0399",\u03aa:"\u0399",\u038c:"\u039f",\u038e:"\u03a5",\u03ab:"\u03a5",\u038f:"\u03a9",\u03ac:"\u03b1",\u03ad:"\u03b5",\u03ae:"\u03b7",\u03af:"\u03b9",\u03ca:"\u03b9",\u0390:"\u03b9",\u03cc:"\u03bf",\u03cd:"\u03c5",\u03cb:"\u03c5",\u03b0:"\u03c5",\u03c9:"\u03c9",\u03c2:"\u03c3"};function Rv(n){return n.replace(/[^\u0000-\u007E]/g,e=>g9[e]||e)}class _9{constructor(t,e){this._ngSelect=t,this._selectionModel=e,this._items=[],this._filteredItems=[],this._markedIndex=-1}get items(){return this._items}get filteredItems(){return this._filteredItems}get markedIndex(){return this._markedIndex}get selectedItems(){return this._selectionModel.value}get markedItem(){return this._filteredItems[this._markedIndex]}get noItemsToSelect(){return this._ngSelect.hideSelected&&this._items.length===this.selectedItems.length}get maxItemsSelected(){return this._ngSelect.multiple&&this._ngSelect.maxSelectedItems<=this.selectedItems.length}get lastSelectedItem(){let t=this.selectedItems.length-1;for(;t>=0;t--){const e=this.selectedItems[t];if(!e.disabled)return e}return null}setItems(t){this._items=t.map((e,i)=>this.mapItem(e,i)),this._ngSelect.groupBy?(this._groups=this._groupBy(this._items,this._ngSelect.groupBy),this._items=this._flatten(this._groups)):(this._groups=new Map,this._groups.set(void 0,this._items)),this._filteredItems=[...this._items]}select(t){if(t.selected||this.maxItemsSelected)return;const e=this._ngSelect.multiple;e||this.clearSelected(),this._selectionModel.select(t,e,this._ngSelect.selectableGroupAsModel),this._ngSelect.hideSelected&&this._hideSelected(t)}unselect(t){!t.selected||(this._selectionModel.unselect(t,this._ngSelect.multiple),this._ngSelect.hideSelected&&xr(t.index)&&this._ngSelect.multiple&&this._showSelected(t))}findItem(t){let e;return e=this._ngSelect.compareWith?i=>this._ngSelect.compareWith(i.value,t):this._ngSelect.bindValue?i=>!i.children&&this.resolveNested(i.value,this._ngSelect.bindValue)===t:i=>i.value===t||!i.children&&i.label&&i.label===this.resolveNested(t,this._ngSelect.bindLabel),this._items.find(i=>e(i))}addItem(t){const e=this.mapItem(t,this._items.length);return this._items.push(e),this._filteredItems.push(e),e}clearSelected(t=!1){this._selectionModel.clear(t),this._items.forEach(e=>{e.selected=t&&e.selected&&e.disabled,e.marked=!1}),this._ngSelect.hideSelected&&this.resetFilteredItems()}findByLabel(t){return t=Rv(t).toLocaleLowerCase(),this.filteredItems.find(e=>Rv(e.label).toLocaleLowerCase().substr(0,t.length)===t)}filter(t){if(!t)return void this.resetFilteredItems();this._filteredItems=[],t=this._ngSelect.searchFn?t:Rv(t).toLocaleLowerCase();const e=this._ngSelect.searchFn||this._defaultSearchFn,i=this._ngSelect.hideSelected;for(const r of Array.from(this._groups.keys())){const o=[];for(const s of this._groups.get(r))i&&(s.parent&&s.parent.selected||s.selected)||e(t,this._ngSelect.searchFn?s.value:s)&&o.push(s);if(o.length>0){const[s]=o.slice(-1);if(s.parent){const a=this._items.find(g=>g===s.parent);this._filteredItems.push(a)}this._filteredItems.push(...o)}}}resetFilteredItems(){this._filteredItems.length!==this._items.length&&(this._filteredItems=this._ngSelect.hideSelected&&this.selectedItems.length>0?this._items.filter(t=>!t.selected):this._items)}unmarkItem(){this._markedIndex=-1}markNextItem(){this._stepToItem(1)}markPreviousItem(){this._stepToItem(-1)}markItem(t){this._markedIndex=this._filteredItems.indexOf(t)}markSelectedOrDefault(t){if(0===this._filteredItems.length)return;const e=this._getLastMarkedIndex();this._markedIndex=e>-1?e:t?this.filteredItems.findIndex(i=>!i.disabled):-1}resolveNested(t,e){if(!vm(t))return t;if(-1===e.indexOf("."))return t[e];{const i=e.split(".");let r=t;for(let o=0,s=i.length;o<s;++o){if(null==r)return null;r=r[i[o]]}return r}}mapItem(t,e){const i=xr(t.$ngOptionLabel)?t.$ngOptionLabel:this.resolveNested(t,this._ngSelect.bindLabel),r=xr(t.$ngOptionValue)?t.$ngOptionValue:t;return{index:e,label:xr(i)?i.toString():"",value:r,disabled:t.disabled,htmlId:`${this._ngSelect.dropdownId}-${e}`}}mapSelectedItems(){const t=this._ngSelect.multiple;for(const e of this.selectedItems){const i=this._ngSelect.bindValue?this.resolveNested(e.value,this._ngSelect.bindValue):e.value,r=xr(i)?this.findItem(i):null;this._selectionModel.unselect(e,t),this._selectionModel.select(r||e,t,this._ngSelect.selectableGroupAsModel)}this._ngSelect.hideSelected&&(this._filteredItems=this.filteredItems.filter(e=>-1===this.selectedItems.indexOf(e)))}_showSelected(t){if(this._filteredItems.push(t),t.parent){const e=t.parent;this._filteredItems.find(r=>r===e)||this._filteredItems.push(e)}else if(t.children)for(const e of t.children)e.selected=!1,this._filteredItems.push(e);this._filteredItems=[...this._filteredItems.sort((e,i)=>e.index-i.index)]}_hideSelected(t){this._filteredItems=this._filteredItems.filter(e=>e!==t),t.parent?t.parent.children.every(i=>i.selected)&&(this._filteredItems=this._filteredItems.filter(i=>i!==t.parent)):t.children&&(this._filteredItems=this.filteredItems.filter(e=>e.parent!==t))}_defaultSearchFn(t,e){return Rv(e.label).toLocaleLowerCase().indexOf(t)>-1}_getNextItemIndex(t){return t>0?this._markedIndex>=this._filteredItems.length-1?0:this._markedIndex+1:this._markedIndex<=0?this._filteredItems.length-1:this._markedIndex-1}_stepToItem(t){0===this._filteredItems.length||this._filteredItems.every(e=>e.disabled)||(this._markedIndex=this._getNextItemIndex(t),this.markedItem.disabled&&this._stepToItem(t))}_getLastMarkedIndex(){if(this._ngSelect.hideSelected||this._markedIndex>-1&&void 0===this.markedItem)return-1;const t=this._filteredItems.indexOf(this.lastSelectedItem);return this.lastSelectedItem&&t<0?-1:Math.max(this.markedIndex,t)}_groupBy(t,e){const i=new Map;if(0===t.length)return i;if(Array.isArray(t[0].value[e])){for(const s of t){const a=(s.value[e]||[]).map((g,w)=>this.mapItem(g,w));i.set(s,a)}return i}const r=Fv(this._ngSelect.groupBy),o=s=>{const a=r?e(s.value):s.value[e];return xr(a)?a:void 0};for(const s of t){const a=o(s),g=i.get(a);g?g.push(s):i.set(a,[s])}return i}_flatten(t){const e=Fv(this._ngSelect.groupBy),i=[];for(const r of Array.from(t.keys())){let o=i.length;if(void 0===r){const ve=t.get(void 0)||[];i.push(...ve.map(me=>(me.index=o++,me)));continue}const s=vm(r),a={label:s?"":String(r),children:void 0,parent:null,index:o++,disabled:!this._ngSelect.selectableGroup,htmlId:xk()},g=e?this._ngSelect.bindLabel:this._ngSelect.groupBy,w=this._ngSelect.groupValue||(()=>s?r.value:{[g]:r}),W=t.get(r).map(ve=>(ve.parent=a,ve.children=void 0,ve.index=o++,ve));a.children=W,a.value=w(r,W.map(ve=>ve.value)),i.push(a),i.push(...W)}return i}}var ml=(()=>{return(n=ml||(ml={}))[n.Tab=9]="Tab",n[n.Enter=13]="Enter",n[n.Esc=27]="Esc",n[n.Space=32]="Space",n[n.ArrowUp=38]="ArrowUp",n[n.ArrowDown=40]="ArrowDown",n[n.Backspace=8]="Backspace",ml;var n})();let wk=(()=>{class n{constructor(){this._dimensions={itemHeight:0,panelHeight:0,itemsPerViewport:0}}get dimensions(){return this._dimensions}calculateItems(e,i,r){const o=this._dimensions,s=o.itemHeight*i,g=Math.max(0,e)/s*i;let w=Math.min(i,Math.ceil(g)+(o.itemsPerViewport+1));const ve=Math.max(0,w-o.itemsPerViewport);let me=Math.min(ve,Math.floor(g)),Se=o.itemHeight*Math.ceil(me)-o.itemHeight*Math.min(me,r);return Se=isNaN(Se)?0:Se,me=isNaN(me)?-1:me,w=isNaN(w)?-1:w,me-=r,me=Math.max(0,me),w+=r,w=Math.min(i,w),{topPadding:Se,scrollHeight:s,start:me,end:w}}setDimensions(e,i){const r=Math.max(1,Math.floor(i/e));this._dimensions={itemHeight:e,panelHeight:i,itemsPerViewport:r}}getScrollTo(e,i,r){const{panelHeight:o}=this.dimensions,s=e+i,g=r+o;return o>=s&&r===e?null:s>g?r+s-g:e<=r?e:null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();const Ek=["top","right","bottom","left"],m9="undefined"!=typeof requestAnimationFrame?rz:dz;let Tk=(()=>{class n{constructor(e,i,r,o,s){this._renderer=e,this._zone=i,this._panelService=r,this._document=s,this.items=[],this.position="auto",this.virtualScroll=!1,this.filterValue=null,this.update=new Xt,this.scroll=new Xt,this.scrollToEnd=new Xt,this.outsideClick=new Xt,this._destroy$=new d,this._scrollToEndFired=!1,this._updateScrollHeight=!1,this._lastScrollPosition=0,this._dropdown=o.nativeElement}get currentPosition(){return this._currentPosition}get itemsLength(){return this._itemsLength}set itemsLength(e){e!==this._itemsLength&&(this._itemsLength=e,this._onItemsLengthChanged())}get _startOffset(){if(this.markedItem){const{itemHeight:e,panelHeight:i}=this._panelService.dimensions,r=this.markedItem.index*e;return i>r?0:r}return 0}ngOnInit(){this._select=this._dropdown.parentElement,this._virtualPadding=this.paddingElementRef.nativeElement,this._scrollablePanel=this.scrollElementRef.nativeElement,this._contentPanel=this.contentElementRef.nativeElement,this._handleScroll(),this._handleOutsideClick(),this._appendDropdown(),this._setupMousedownListener()}ngOnChanges(e){if(e.items){const i=e.items;this._onItemsChange(i.currentValue,i.firstChange)}}ngOnDestroy(){this._destroy$.next(),this._destroy$.complete(),this._destroy$.unsubscribe(),this.appendTo&&this._renderer.removeChild(this._dropdown.parentNode,this._dropdown)}scrollTo(e,i=!1){if(!e)return;const r=this.items.indexOf(e);if(r<0||r>=this.itemsLength)return;let o;if(this.virtualScroll){const s=this._panelService.dimensions.itemHeight;o=this._panelService.getScrollTo(r*s,s,this._lastScrollPosition)}else{const s=this._dropdown.querySelector(`#${e.htmlId}`);o=this._panelService.getScrollTo(s.offsetTop,s.clientHeight,i?s.offsetTop:this._lastScrollPosition)}xr(o)&&(this._scrollablePanel.scrollTop=o)}scrollToTag(){const e=this._scrollablePanel;e.scrollTop=e.scrollHeight-e.clientHeight}adjustPosition(){this._updateYPosition()}_handleDropdownPosition(){this._currentPosition=this._calculateCurrentPosition(this._dropdown),Ek.includes(this._currentPosition)?this._updateDropdownClass(this._currentPosition):this._updateDropdownClass("bottom"),this.appendTo&&this._updateYPosition(),this._dropdown.style.opacity="1"}_updateDropdownClass(e){Ek.forEach(r=>{const o=`ng-select-${r}`;this._renderer.removeClass(this._dropdown,o),this._renderer.removeClass(this._select,o)});const i=`ng-select-${e}`;this._renderer.addClass(this._dropdown,i),this._renderer.addClass(this._select,i)}_handleScroll(){this._zone.runOutsideAngular(()=>{pp(this.scrollElementRef.nativeElement,"scroll").pipe(jc(this._destroy$),JL(0,m9)).subscribe(e=>{const i=e.path||e.composedPath&&e.composedPath();this._onContentScrolled(i&&0!==i.length?i[0].scrollTop:e.target.scrollTop)})})}_handleOutsideClick(){!this._document||this._zone.runOutsideAngular(()=>{$o(pp(this._document,"touchstart",{capture:!0}),pp(this._document,"mousedown",{capture:!0})).pipe(jc(this._destroy$)).subscribe(e=>this._checkToClose(e))})}_checkToClose(e){if(this._select.contains(e.target)||this._dropdown.contains(e.target))return;const i=e.path||e.composedPath&&e.composedPath();e.target&&e.target.shadowRoot&&i&&i[0]&&this._select.contains(i[0])||this._zone.run(()=>this.outsideClick.emit())}_onItemsChange(e,i){this.items=e||[],this._scrollToEndFired=!1,this.itemsLength=e.length,this.virtualScroll?this._updateItemsRange(i):(this._setVirtualHeight(),this._updateItems(i))}_updateItems(e){this.update.emit(this.items),!1!==e&&this._zone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._panelService.setDimensions(0,this._scrollablePanel.clientHeight),this._handleDropdownPosition(),this.scrollTo(this.markedItem,e)})})}_updateItemsRange(e){this._zone.runOutsideAngular(()=>{this._measureDimensions().then(()=>{e?(this._renderItemsRange(this._startOffset),this._handleDropdownPosition()):this._renderItemsRange()})})}_onContentScrolled(e){this.virtualScroll&&this._renderItemsRange(e),this._lastScrollPosition=e,this._fireScrollToEnd(e)}_updateVirtualHeight(e){this._updateScrollHeight&&(this._virtualPadding.style.height=`${e}px`,this._updateScrollHeight=!1)}_setVirtualHeight(){!this._virtualPadding||(this._virtualPadding.style.height="0px")}_onItemsLengthChanged(){this._updateScrollHeight=!0}_renderItemsRange(e=null){if(e&&this._lastScrollPosition===e)return;const i=this._panelService.calculateItems(e=e||this._scrollablePanel.scrollTop,this.itemsLength,this.bufferAmount);this._updateVirtualHeight(i.scrollHeight),this._contentPanel.style.transform=`translateY(${i.topPadding}px)`,this._zone.run(()=>{this.update.emit(this.items.slice(i.start,i.end)),this.scroll.emit({start:i.start,end:i.end})}),xr(e)&&0===this._lastScrollPosition&&(this._scrollablePanel.scrollTop=e,this._lastScrollPosition=e)}_measureDimensions(){if(this._panelService.dimensions.itemHeight>0||0===this.itemsLength)return Promise.resolve(this._panelService.dimensions);const[e]=this.items;return this.update.emit([e]),Promise.resolve().then(()=>{const r=this._dropdown.querySelector(`#${e.htmlId}`).clientHeight;return this._virtualPadding.style.height=r*this.itemsLength+"px",this._panelService.setDimensions(r,this._scrollablePanel.clientHeight),this._panelService.dimensions})}_fireScrollToEnd(e){this._scrollToEndFired||0===e||e+this._dropdown.clientHeight>=(this.virtualScroll?this._virtualPadding:this._contentPanel).clientHeight-1&&(this._zone.run(()=>this.scrollToEnd.emit()),this._scrollToEndFired=!0)}_calculateCurrentPosition(e){if("auto"!==this.position)return this.position;const i=this._select.getBoundingClientRect(),r=document.documentElement.scrollTop||document.body.scrollTop;return i.top+window.pageYOffset+i.height+e.getBoundingClientRect().height>r+document.documentElement.clientHeight?"top":"bottom"}_appendDropdown(){if(this.appendTo){if(this._parent=document.querySelector(this.appendTo),!this._parent)throw new Error(`appendTo selector ${this.appendTo} did not found any parent element`);this._updateXPosition(),this._parent.appendChild(this._dropdown)}}_updateXPosition(){const e=this._select.getBoundingClientRect(),i=this._parent.getBoundingClientRect();this._dropdown.style.left=e.left-i.left+"px",this._dropdown.style.width=e.width+"px",this._dropdown.style.minWidth=e.width+"px"}_updateYPosition(){const e=this._select.getBoundingClientRect(),i=this._parent.getBoundingClientRect(),r=e.height;"top"===this._currentPosition?(this._dropdown.style.bottom=i.bottom-e.bottom+r+"px",this._dropdown.style.top="auto"):"bottom"===this._currentPosition&&(this._dropdown.style.top=e.top-i.top+r+"px",this._dropdown.style.bottom="auto")}_setupMousedownListener(){this._zone.runOutsideAngular(()=>{pp(this._dropdown,"mousedown").pipe(jc(this._destroy$)).subscribe(e=>{"INPUT"!==e.target.tagName&&e.preventDefault()})})}}return n.\u0275fac=function(e){return new(e||n)(Be(Gu),Be(An),Be(wk),Be(fi),Be(hs,8))},n.\u0275cmp=Qt({type:n,selectors:[["ng-dropdown-panel"]],viewQuery:function(e,i){if(1&e&&(Gn($z,7,fi),Gn(vz,7,fi),Gn(bz,7,fi)),2&e){let r;yn(r=Cn())&&(i.contentElementRef=r.first),yn(r=Cn())&&(i.scrollElementRef=r.first),yn(r=Cn())&&(i.paddingElementRef=r.first)}},inputs:{items:"items",markedItem:"markedItem",position:"position",appendTo:"appendTo",bufferAmount:"bufferAmount",virtualScroll:"virtualScroll",headerTemplate:"headerTemplate",footerTemplate:"footerTemplate",filterValue:"filterValue"},outputs:{update:"update",scroll:"scroll",scrollToEnd:"scrollToEnd",outsideClick:"outsideClick"},features:[br],ngContentSelectors:yk,decls:9,vars:6,consts:[["class","ng-dropdown-header",4,"ngIf"],[1,"ng-dropdown-panel-items","scroll-host"],["scroll",""],["padding",""],["content",""],["class","ng-dropdown-footer",4,"ngIf"],[1,"ng-dropdown-header"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"ng-dropdown-footer"]],template:function(e,i){1&e&&(j_(),Ee(0,yz,2,4,"div",0),J(1,"div",1,2),it(3,"div",null,3),J(5,"div",null,4),G_(7),oe()(),Ee(8,Cz,2,4,"div",5)),2&e&&(ie("ngIf",i.headerTemplate),j(3),Aa("total-padding",i.virtualScroll),j(2),Aa("scrollable-content",i.virtualScroll&&i.items.length),j(3),ie("ngIf",i.footerTemplate))},directives:[Sn,Ra],encapsulation:2,changeDetection:0}),n})(),wf=(()=>{class n{constructor(e){this.elementRef=e,this.stateChange$=new d,this._disabled=!1}get disabled(){return this._disabled}set disabled(e){this._disabled=this._isDisabled(e)}get label(){return(this.elementRef.nativeElement.textContent||"").trim()}ngOnChanges(e){e.disabled&&this.stateChange$.next({value:this.value,disabled:this._disabled})}ngAfterViewChecked(){this.label!==this._previousLabel&&(this._previousLabel=this.label,this.stateChange$.next({value:this.value,disabled:this._disabled,label:this.elementRef.nativeElement.innerHTML}))}ngOnDestroy(){this.stateChange$.complete()}_isDisabled(e){return null!=e&&"false"!=`${e}`}}return n.\u0275fac=function(e){return new(e||n)(Be(fi))},n.\u0275cmp=Qt({type:n,selectors:[["ng-option"]],inputs:{value:"value",disabled:"disabled"},features:[br],ngContentSelectors:yk,decls:1,vars:0,template:function(e,i){1&e&&(j_(),G_(0))},encapsulation:2,changeDetection:0}),n})(),Sk=(()=>{class n{constructor(){this.notFoundText="No items found",this.typeToSearchText="Type to search",this.addTagText="Add item",this.loadingText="Loading...",this.clearAllText="Clear all",this.disableVirtualScroll=!0,this.openOnEnter=!0,this.appearance="underline"}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),$9=(()=>{class n{warn(e){console.warn(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Dk=new ei("ng-select-selection-model");let gp=(()=>{class n{constructor(e,i,r,o,s,a,g){this.classes=e,this.autoFocus=i,this.config=r,this._cd=a,this._console=g,this.markFirst=!0,this.dropdownPosition="auto",this.loading=!1,this.closeOnSelect=!0,this.hideSelected=!1,this.selectOnTab=!1,this.bufferAmount=4,this.selectableGroup=!1,this.selectableGroupAsModel=!0,this.searchFn=null,this.trackByFn=null,this.clearOnBackspace=!0,this.labelForId=null,this.inputAttrs={},this.readonly=!1,this.searchWhileComposing=!0,this.minTermLength=0,this.editableSearchTerm=!1,this.keyDownFn=w=>!0,this.multiple=!1,this.addTag=!1,this.searchable=!0,this.clearable=!0,this.isOpen=!1,this.blurEvent=new Xt,this.focusEvent=new Xt,this.changeEvent=new Xt,this.openEvent=new Xt,this.closeEvent=new Xt,this.searchEvent=new Xt,this.clearEvent=new Xt,this.addEvent=new Xt,this.removeEvent=new Xt,this.scroll=new Xt,this.scrollToEnd=new Xt,this.useDefaultClass=!0,this.viewPortItems=[],this.searchTerm=null,this.dropdownId=xk(),this.escapeHTML=!0,this._items=[],this._defaultLabel="label",this._pressedKeys=[],this._isComposing=!1,this._destroy$=new d,this._keyPress$=new d,this._onChange=w=>{},this._onTouched=()=>{},this.clearItem=w=>{const W=this.selectedItems.find(ve=>ve.value===w);this.unselect(W)},this.trackByOption=(w,W)=>this.trackByFn?this.trackByFn(W.value):W,this._mergeGlobalConfig(r),this.itemsList=new _9(this,o()),this.element=s.nativeElement}get items(){return this._items}set items(e){null===e&&(e=[]),this._itemsAreUsed=!0,this._items=e}get compareWith(){return this._compareWith}set compareWith(e){if(null!=e&&!Fv(e))throw Error("`compareWith` must be a function.");this._compareWith=e}get clearSearchOnAdd(){return xr(this._clearSearchOnAdd)?this._clearSearchOnAdd:xr(this.config.clearSearchOnAdd)?this.config.clearSearchOnAdd:this.closeOnSelect}set clearSearchOnAdd(e){this._clearSearchOnAdd=e}get disabled(){return this.readonly||this._disabled}get filtered(){return!!this.searchTerm&&this.searchable||this._isComposing}get single(){return!this.multiple}get _editableSearchTerm(){return this.editableSearchTerm&&!this.multiple}get selectedItems(){return this.itemsList.selectedItems}get selectedValues(){return this.selectedItems.map(e=>e.value)}get hasValue(){return this.selectedItems.length>0}get currentPanelPosition(){if(this.dropdownPanel)return this.dropdownPanel.currentPosition}ngOnInit(){this._handleKeyPresses(),this._setInputAttributes()}ngOnChanges(e){e.multiple&&this.itemsList.clearSelected(),e.items&&this._setItems(e.items.currentValue||[]),e.isOpen&&(this._manualOpen=xr(e.isOpen.currentValue))}ngAfterViewInit(){this._itemsAreUsed||(this.escapeHTML=!1,this._setItemsFromNgOptions()),xr(this.autoFocus)&&this.focus()}ngOnDestroy(){this._destroy$.next(),this._destroy$.complete()}handleKeyDown(e){if(ml[e.which]){if(!1===this.keyDownFn(e))return;this.handleKeyCode(e)}else e.key&&1===e.key.length&&this._keyPress$.next(e.key.toLocaleLowerCase())}handleKeyCode(e){switch(e.which){case ml.ArrowDown:this._handleArrowDown(e);break;case ml.ArrowUp:this._handleArrowUp(e);break;case ml.Space:this._handleSpace(e);break;case ml.Enter:this._handleEnter(e);break;case ml.Tab:this._handleTab(e);break;case ml.Esc:this.close(),e.preventDefault();break;case ml.Backspace:this._handleBackspace()}}handleMousedown(e){const i=e.target;"INPUT"!==i.tagName&&e.preventDefault(),i.classList.contains("ng-clear-wrapper")?this.handleClearClick():i.classList.contains("ng-arrow-wrapper")?this.handleArrowClick():i.classList.contains("ng-value-icon")||(this.focused||this.focus(),this.searchable?this.open():this.toggle())}handleArrowClick(){this.isOpen?this.close():this.open()}handleClearClick(){this.hasValue&&(this.itemsList.clearSelected(!0),this._updateNgModel()),this._clearSearch(),this.focus(),this.clearEvent.emit(),this._onSelectionChanged()}clearModel(){!this.clearable||(this.itemsList.clearSelected(),this._updateNgModel())}writeValue(e){this.itemsList.clearSelected(),this._handleWriteValue(e),this._cd.markForCheck()}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this._disabled=e,this._cd.markForCheck()}toggle(){this.isOpen?this.close():this.open()}open(){this.disabled||this.isOpen||this.itemsList.maxItemsSelected||this._manualOpen||!this._isTypeahead&&!this.addTag&&this.itemsList.noItemsToSelect||(this.isOpen=!0,this.itemsList.markSelectedOrDefault(this.markFirst),this.openEvent.emit(),this.searchTerm||this.focus(),this.detectChanges())}close(){!this.isOpen||this._manualOpen||(this.isOpen=!1,this._isComposing=!1,this._editableSearchTerm?this.itemsList.resetFilteredItems():this._clearSearch(),this.itemsList.unmarkItem(),this._onTouched(),this.closeEvent.emit(),this._cd.markForCheck())}toggleItem(e){!e||e.disabled||this.disabled||(this.multiple&&e.selected?this.unselect(e):this.select(e),this._editableSearchTerm&&this._setSearchTermFromItems(),this._onSelectionChanged())}select(e){e.selected||(this.itemsList.select(e),this.clearSearchOnAdd&&!this._editableSearchTerm&&this._clearSearch(),this._updateNgModel(),this.multiple&&this.addEvent.emit(e.value)),(this.closeOnSelect||this.itemsList.noItemsToSelect)&&this.close()}focus(){this.searchInput.nativeElement.focus()}blur(){this.searchInput.nativeElement.blur()}unselect(e){!e||(this.itemsList.unselect(e),this.focus(),this._updateNgModel(),this.removeEvent.emit(e))}selectTag(){let e;e=Fv(this.addTag)?this.addTag(this.searchTerm):this._primitive?this.searchTerm:{[this.bindLabel]:this.searchTerm};const i=r=>this._isTypeahead||!this.isOpen?this.itemsList.mapItem(r,null):this.itemsList.addItem(r);!function n9(n){return n instanceof Promise}(e)?e&&this.select(i(e)):e.then(r=>this.select(i(r))).catch(()=>{})}showClear(){return this.clearable&&(this.hasValue||this.searchTerm)&&!this.disabled}get showAddTag(){if(!this._validTerm)return!1;const e=this.searchTerm.toLowerCase().trim();return this.addTag&&!this.itemsList.filteredItems.some(i=>i.label.toLowerCase()===e)&&(!this.hideSelected&&this.isOpen||!this.selectedItems.some(i=>i.label.toLowerCase()===e))&&!this.loading}showNoItemsFound(){const e=0===this.itemsList.filteredItems.length;return(e&&!this._isTypeahead&&!this.loading||e&&this._isTypeahead&&this._validTerm&&!this.loading)&&!this.showAddTag}showTypeToSearch(){return 0===this.itemsList.filteredItems.length&&this._isTypeahead&&!this._validTerm&&!this.loading}onCompositionStart(){this._isComposing=!0}onCompositionEnd(e){this._isComposing=!1,!this.searchWhileComposing&&this.filter(e)}filter(e){this._isComposing&&!this.searchWhileComposing||(this.searchTerm=e,this._isTypeahead&&(this._validTerm||0===this.minTermLength)&&this.typeahead.next(e),this._isTypeahead||(this.itemsList.filter(this.searchTerm),this.isOpen&&this.itemsList.markSelectedOrDefault(this.markFirst)),this.searchEvent.emit({term:e,items:this.itemsList.filteredItems.map(i=>i.value)}),this.open())}onInputFocus(e){this.focused||(this._editableSearchTerm&&this._setSearchTermFromItems(),this.element.classList.add("ng-select-focused"),this.focusEvent.emit(e),this.focused=!0)}onInputBlur(e){this.element.classList.remove("ng-select-focused"),this.blurEvent.emit(e),!this.isOpen&&!this.disabled&&this._onTouched(),this._editableSearchTerm&&this._setSearchTermFromItems(),this.focused=!1}onItemHover(e){e.disabled||this.itemsList.markItem(e)}detectChanges(){this._cd.destroyed||this._cd.detectChanges()}_setSearchTermFromItems(){const e=this.selectedItems&&this.selectedItems[0];this.searchTerm=e&&e.label||null}_setItems(e){const i=e[0];this.bindLabel=this.bindLabel||this._defaultLabel,this._primitive=xr(i)?!vm(i):this._primitive||this.bindLabel===this._defaultLabel,this.itemsList.setItems(e),e.length>0&&this.hasValue&&this.itemsList.mapSelectedItems(),this.isOpen&&xr(this.searchTerm)&&!this._isTypeahead&&this.itemsList.filter(this.searchTerm),(this._isTypeahead||this.isOpen)&&this.itemsList.markSelectedOrDefault(this.markFirst)}_setItemsFromNgOptions(){const e=r=>{this.items=r.map(o=>({$ngOptionValue:o.value,$ngOptionLabel:o.elementRef.nativeElement.innerHTML,disabled:o.disabled})),this.itemsList.setItems(this.items),this.hasValue&&this.itemsList.mapSelectedItems(),this.detectChanges()},i=()=>{const r=$o(this.ngOptions.changes,this._destroy$);$o(...this.ngOptions.map(o=>o.stateChange$)).pipe(jc(r)).subscribe(o=>{const s=this.itemsList.findItem(o.value);s.disabled=o.disabled,s.label=o.label||s.label,this._cd.detectChanges()})};this.ngOptions.changes.pipe(Lx(this.ngOptions),jc(this._destroy$)).subscribe(r=>{this.bindLabel=this._defaultLabel,e(r),i()})}_isValidWriteValue(e){if(!xr(e)||this.multiple&&""===e||Array.isArray(e)&&0===e.length)return!1;const i=r=>!(!xr(this.compareWith)&&vm(r)&&this.bindValue&&(this._console.warn(`Setting object(${JSON.stringify(r)}) as your model with bindValue is not allowed unless [compareWith] is used.`),1));return this.multiple?Array.isArray(e)?e.every(r=>i(r)):(this._console.warn("Multiple select ngModel should be array."),!1):i(e)}_handleWriteValue(e){if(!this._isValidWriteValue(e))return;const i=r=>{let o=this.itemsList.findItem(r);if(o)this.itemsList.select(o);else{const s=vm(r),a=!s&&!this.bindValue;s||a?this.itemsList.select(this.itemsList.mapItem(r,null)):this.bindValue&&(o={[this.bindLabel]:null,[this.bindValue]:r},this.itemsList.select(this.itemsList.mapItem(o,null)))}};this.multiple?e.forEach(r=>i(r)):i(e)}_handleKeyPresses(){this.searchable||this._keyPress$.pipe(jc(this._destroy$),mk(e=>this._pressedKeys.push(e)),function tz(n,t=Bx){return x((e,i)=>{let r=null,o=null,s=null;const a=()=>{if(r){r.unsubscribe(),r=null;const w=o;o=null,i.next(w)}};function g(){const w=s+n,W=t.now();if(W<w)return r=this.schedule(void 0,w-W),void i.add(r);a()}e.subscribe($(i,w=>{o=w,s=t.now(),r||(r=t.schedule(g,n),i.add(r))},()=>{a(),i.complete()},void 0,()=>{o=r=null}))})}(200),$k(()=>this._pressedKeys.length>0),ae(()=>this._pressedKeys.join(""))).subscribe(e=>{const i=this.itemsList.findByLabel(e);i&&(this.isOpen?(this.itemsList.markItem(i),this._scrollToMarked(),this._cd.markForCheck()):this.select(i)),this._pressedKeys=[]})}_setInputAttributes(){const e=this.searchInput.nativeElement,i=Object.assign({type:"text",autocorrect:"off",autocapitalize:"off",autocomplete:this.labelForId?"off":this.dropdownId},this.inputAttrs);for(const r of Object.keys(i))e.setAttribute(r,i[r])}_updateNgModel(){const e=[];for(const r of this.selectedItems)if(this.bindValue){let o=null;o=r.children?r.value[(this.groupValue?this.bindValue:this.groupBy)||this.groupBy]:this.itemsList.resolveNested(r.value,this.bindValue),e.push(o)}else e.push(r.value);const i=this.selectedItems.map(r=>r.value);this.multiple?(this._onChange(e),this.changeEvent.emit(i)):(this._onChange(xr(e[0])?e[0]:null),this.changeEvent.emit(i[0])),this._cd.markForCheck()}_clearSearch(){!this.searchTerm||(this._changeSearch(null),this.itemsList.resetFilteredItems())}_changeSearch(e){this.searchTerm=e,this._isTypeahead&&this.typeahead.next(e)}_scrollToMarked(){!this.isOpen||!this.dropdownPanel||this.dropdownPanel.scrollTo(this.itemsList.markedItem)}_scrollToTag(){!this.isOpen||!this.dropdownPanel||this.dropdownPanel.scrollToTag()}_onSelectionChanged(){this.isOpen&&this.multiple&&this.appendTo&&(this._cd.detectChanges(),this.dropdownPanel.adjustPosition())}_handleTab(e){!1===this.isOpen&&!this.addTag||(this.selectOnTab?this.itemsList.markedItem?(this.toggleItem(this.itemsList.markedItem),e.preventDefault()):this.showAddTag?(this.selectTag(),e.preventDefault()):this.close():this.close())}_handleEnter(e){if(this.isOpen||this._manualOpen)this.itemsList.markedItem?this.toggleItem(this.itemsList.markedItem):this.showAddTag&&this.selectTag();else{if(!this.openOnEnter)return;this.open()}e.preventDefault()}_handleSpace(e){this.isOpen||this._manualOpen||(this.open(),e.preventDefault())}_handleArrowDown(e){this._nextItemIsTag(1)?(this.itemsList.unmarkItem(),this._scrollToTag()):(this.itemsList.markNextItem(),this._scrollToMarked()),this.open(),e.preventDefault()}_handleArrowUp(e){!this.isOpen||(this._nextItemIsTag(-1)?(this.itemsList.unmarkItem(),this._scrollToTag()):(this.itemsList.markPreviousItem(),this._scrollToMarked()),e.preventDefault())}_nextItemIsTag(e){const i=this.itemsList.markedIndex+e;return this.addTag&&this.searchTerm&&this.itemsList.markedItem&&(i<0||i===this.itemsList.filteredItems.length)}_handleBackspace(){this.searchTerm||!this.clearable||!this.clearOnBackspace||!this.hasValue||(this.multiple?this.unselect(this.itemsList.lastSelectedItem):this.clearModel())}get _isTypeahead(){return this.typeahead&&this.typeahead.observers.length>0}get _validTerm(){const e=this.searchTerm&&this.searchTerm.trim();return e&&e.length>=this.minTermLength}_mergeGlobalConfig(e){this.placeholder=this.placeholder||e.placeholder,this.notFoundText=this.notFoundText||e.notFoundText,this.typeToSearchText=this.typeToSearchText||e.typeToSearchText,this.addTagText=this.addTagText||e.addTagText,this.loadingText=this.loadingText||e.loadingText,this.clearAllText=this.clearAllText||e.clearAllText,this.virtualScroll=xr(this.virtualScroll)?this.virtualScroll:!!xr(e.disableVirtualScroll)&&!e.disableVirtualScroll,this.openOnEnter=xr(this.openOnEnter)?this.openOnEnter:e.openOnEnter,this.appendTo=this.appendTo||e.appendTo,this.bindValue=this.bindValue||e.bindValue,this.bindLabel=this.bindLabel||e.bindLabel,this.appearance=this.appearance||e.appearance}}return n.\u0275fac=function(e){return new(e||n)(Nc("class"),Nc("autofocus"),Be(Sk),Be(Dk),Be(fi),Be(bi),Be($9))},n.\u0275cmp=Qt({type:n,selectors:[["ng-select"]],contentQueries:function(e,i,r){if(1&e&&(ia(r,r9,5,Ei),ia(r,o9,5,Ei),ia(r,s9,5,Ei),ia(r,a9,5,Ei),ia(r,l9,5,Ei),ia(r,c9,5,Ei),ia(r,u9,5,Ei),ia(r,d9,5,Ei),ia(r,f9,5,Ei),ia(r,h9,5,Ei),ia(r,p9,5,Ei),ia(r,wf,5)),2&e){let o;yn(o=Cn())&&(i.optionTemplate=o.first),yn(o=Cn())&&(i.optgroupTemplate=o.first),yn(o=Cn())&&(i.labelTemplate=o.first),yn(o=Cn())&&(i.multiLabelTemplate=o.first),yn(o=Cn())&&(i.headerTemplate=o.first),yn(o=Cn())&&(i.footerTemplate=o.first),yn(o=Cn())&&(i.notFoundTemplate=o.first),yn(o=Cn())&&(i.typeToSearchTemplate=o.first),yn(o=Cn())&&(i.loadingTextTemplate=o.first),yn(o=Cn())&&(i.tagTemplate=o.first),yn(o=Cn())&&(i.loadingSpinnerTemplate=o.first),yn(o=Cn())&&(i.ngOptions=o)}},viewQuery:function(e,i){if(1&e&&(Gn(Tk,5),Gn(xz,7)),2&e){let r;yn(r=Cn())&&(i.dropdownPanel=r.first),yn(r=Cn())&&(i.searchInput=r.first)}},hostVars:20,hostBindings:function(e,i){1&e&&Re("keydown",function(o){return i.handleKeyDown(o)}),2&e&&Aa("ng-select-typeahead",i.typeahead)("ng-select-multiple",i.multiple)("ng-select-taggable",i.addTag)("ng-select-searchable",i.searchable)("ng-select-clearable",i.clearable)("ng-select-opened",i.isOpen)("ng-select",i.useDefaultClass)("ng-select-disabled",i.disabled)("ng-select-filtered",i.filtered)("ng-select-single",i.single)},inputs:{bindLabel:"bindLabel",bindValue:"bindValue",markFirst:"markFirst",placeholder:"placeholder",notFoundText:"notFoundText",typeToSearchText:"typeToSearchText",addTagText:"addTagText",loadingText:"loadingText",clearAllText:"clearAllText",appearance:"appearance",dropdownPosition:"dropdownPosition",appendTo:"appendTo",loading:"loading",closeOnSelect:"closeOnSelect",hideSelected:"hideSelected",selectOnTab:"selectOnTab",openOnEnter:"openOnEnter",maxSelectedItems:"maxSelectedItems",groupBy:"groupBy",groupValue:"groupValue",bufferAmount:"bufferAmount",virtualScroll:"virtualScroll",selectableGroup:"selectableGroup",selectableGroupAsModel:"selectableGroupAsModel",searchFn:"searchFn",trackByFn:"trackByFn",clearOnBackspace:"clearOnBackspace",labelForId:"labelForId",inputAttrs:"inputAttrs",tabIndex:"tabIndex",readonly:"readonly",searchWhileComposing:"searchWhileComposing",minTermLength:"minTermLength",editableSearchTerm:"editableSearchTerm",keyDownFn:"keyDownFn",typeahead:"typeahead",multiple:"multiple",addTag:"addTag",searchable:"searchable",clearable:"clearable",isOpen:"isOpen",items:"items",compareWith:"compareWith",clearSearchOnAdd:"clearSearchOnAdd"},outputs:{blurEvent:"blur",focusEvent:"focus",changeEvent:"change",openEvent:"open",closeEvent:"close",searchEvent:"search",clearEvent:"clear",addEvent:"add",removeEvent:"remove",scroll:"scroll",scrollToEnd:"scrollToEnd"},features:[Xi([{provide:_l,useExisting:oi(()=>n),multi:!0},wk]),br],decls:14,vars:19,consts:[[1,"ng-select-container",3,"mousedown"],[1,"ng-value-container"],[1,"ng-placeholder"],[4,"ngIf"],["role","combobox","aria-haspopup","listbox",1,"ng-input"],["aria-autocomplete","list",3,"readOnly","disabled","value","input","compositionstart","compositionend","focus","blur","change"],["searchInput",""],["class","ng-clear-wrapper",3,"title",4,"ngIf"],[1,"ng-arrow-wrapper"],[1,"ng-arrow"],["class","ng-dropdown-panel","role","listbox","aria-label","Options list",3,"virtualScroll","bufferAmount","appendTo","position","headerTemplate","footerTemplate","filterValue","items","markedItem","ng-select-multiple","ngClass","id","update","scroll","scrollToEnd","outsideClick",4,"ngIf"],["class","ng-value",3,"ng-value-disabled",4,"ngFor","ngForOf","ngForTrackBy"],[1,"ng-value"],["defaultLabelTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["aria-hidden","true",1,"ng-value-icon","left",3,"click"],[1,"ng-value-label",3,"ngItemLabel","escape"],["defaultLoadingSpinnerTemplate",""],[3,"ngTemplateOutlet"],[1,"ng-spinner-loader"],[1,"ng-clear-wrapper",3,"title"],["aria-hidden","true",1,"ng-clear"],["role","listbox","aria-label","Options list",1,"ng-dropdown-panel",3,"virtualScroll","bufferAmount","appendTo","position","headerTemplate","footerTemplate","filterValue","items","markedItem","ngClass","id","update","scroll","scrollToEnd","outsideClick"],["class","ng-option",3,"ng-option-disabled","ng-option-selected","ng-optgroup","ng-option","ng-option-child","ng-option-marked","click","mouseover",4,"ngFor","ngForOf","ngForTrackBy"],["class","ng-option","role","option",3,"ng-option-marked","mouseover","click",4,"ngIf"],[1,"ng-option",3,"click","mouseover"],["defaultOptionTemplate",""],[1,"ng-option-label",3,"ngItemLabel","escape"],["role","option",1,"ng-option",3,"mouseover","click"],["defaultTagTemplate",""],[1,"ng-tag-label"],["defaultNotFoundTemplate",""],[1,"ng-option","ng-option-disabled"],["defaultTypeToSearchTemplate",""],["defaultLoadingTextTemplate",""]],template:function(e,i){if(1&e){const r=pt();J(0,"div",0),Re("mousedown",function(s){return i.handleMousedown(s)}),J(1,"div",1)(2,"div",2),we(3),oe(),Ee(4,Dz,2,2,"ng-container",3),Ee(5,Mz,1,5,null,3),J(6,"div",4)(7,"input",5,6),Re("input",function(){Le(r);const s=ln(8);return i.filter(s.value)})("compositionstart",function(){return i.onCompositionStart()})("compositionend",function(){Le(r);const s=ln(8);return i.onCompositionEnd(s.value)})("focus",function(s){return i.onInputFocus(s)})("blur",function(s){return i.onInputBlur(s)})("change",function(s){return s.stopPropagation()}),oe()()(),Ee(9,Fz,4,1,"ng-container",3),Ee(10,Rz,3,1,"span",7),J(11,"span",8),it(12,"span",9),oe()(),Ee(13,Qz,7,19,"ng-dropdown-panel",10)}2&e&&(Aa("ng-appearance-outline","outline"===i.appearance)("ng-has-value",i.hasValue),j(3),xt(i.placeholder),j(1),ie("ngIf",(!i.multiLabelTemplate||!i.multiple)&&i.selectedItems.length>0),j(1),ie("ngIf",i.multiple&&i.multiLabelTemplate&&i.selectedValues.length>0),j(1),Yt("aria-expanded",i.isOpen)("aria-owns",i.isOpen?i.dropdownId:null),j(1),ie("readOnly",!i.searchable||i.itemsList.maxItemsSelected)("disabled",i.disabled)("value",i.searchTerm?i.searchTerm:""),Yt("id",i.labelForId)("tabindex",i.tabIndex)("aria-activedescendant",i.isOpen?null==i.itemsList||null==i.itemsList.markedItem?null:i.itemsList.markedItem.htmlId:null)("aria-controls",i.isOpen?i.dropdownId:null),j(2),ie("ngIf",i.loading),j(1),ie("ngIf",i.showClear()),j(3),ie("ngIf",i.isOpen))},directives:[Tk,Sn,si,i9,Ra,ir],styles:['@charset "UTF-8";.ng-select{position:relative;display:block;box-sizing:border-box}.ng-select div,.ng-select input,.ng-select span{box-sizing:border-box}.ng-select [hidden]{display:none}.ng-select.ng-select-searchable .ng-select-container .ng-value-container .ng-input{opacity:1}.ng-select.ng-select-opened .ng-select-container{z-index:1001}.ng-select.ng-select-disabled .ng-select-container .ng-value-container .ng-placeholder,.ng-select.ng-select-disabled .ng-select-container .ng-value-container .ng-value{-webkit-user-select:none;user-select:none;cursor:default}.ng-select.ng-select-disabled .ng-arrow-wrapper{cursor:default}.ng-select.ng-select-filtered .ng-placeholder{display:none}.ng-select .ng-select-container{cursor:default;display:flex;outline:none;overflow:hidden;position:relative;width:100%}.ng-select .ng-select-container .ng-value-container{display:flex;flex:1}.ng-select .ng-select-container .ng-value-container .ng-input{opacity:0}.ng-select .ng-select-container .ng-value-container .ng-input>input{box-sizing:content-box;background:none transparent;border:0 none;box-shadow:none;outline:none;padding:0;cursor:default;width:100%}.ng-select .ng-select-container .ng-value-container .ng-input>input::-ms-clear{display:none}.ng-select .ng-select-container .ng-value-container .ng-input>input[readonly]{-webkit-user-select:none;user-select:none;width:0;padding:0}.ng-select.ng-select-single.ng-select-filtered .ng-select-container .ng-value-container .ng-value{visibility:hidden}.ng-select.ng-select-single .ng-select-container .ng-value-container,.ng-select.ng-select-single .ng-select-container .ng-value-container .ng-value{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ng-select.ng-select-single .ng-select-container .ng-value-container .ng-value .ng-value-icon{display:none}.ng-select.ng-select-single .ng-select-container .ng-value-container .ng-input{position:absolute;left:0;width:100%}.ng-select.ng-select-multiple.ng-select-disabled>.ng-select-container .ng-value-container .ng-value .ng-value-icon{display:none}.ng-select.ng-select-multiple .ng-select-container .ng-value-container{flex-wrap:wrap}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-placeholder{position:absolute}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-value{white-space:nowrap}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-value.ng-value-disabled .ng-value-icon{display:none}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-value .ng-value-icon{cursor:pointer}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-input{flex:1;z-index:2}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-placeholder{z-index:1}.ng-select .ng-clear-wrapper{cursor:pointer;position:relative;width:17px;-webkit-user-select:none;user-select:none}.ng-select .ng-clear-wrapper .ng-clear{display:inline-block;font-size:18px;line-height:1;pointer-events:none}.ng-select .ng-spinner-loader{border-radius:50%;width:17px;height:17px;margin-right:5px;font-size:10px;position:relative;text-indent:-9999em;border-top:2px solid rgba(66,66,66,.2);border-right:2px solid rgba(66,66,66,.2);border-bottom:2px solid rgba(66,66,66,.2);border-left:2px solid #424242;transform:translateZ(0);animation:load8 .8s infinite linear}.ng-select .ng-spinner-loader:after{border-radius:50%;width:17px;height:17px}@keyframes load8{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.ng-select .ng-arrow-wrapper{cursor:pointer;position:relative;text-align:center;-webkit-user-select:none;user-select:none}.ng-select .ng-arrow-wrapper .ng-arrow{pointer-events:none;display:inline-block;height:0;width:0;position:relative}.ng-dropdown-panel{box-sizing:border-box;position:absolute;opacity:0;width:100%;z-index:1050;-webkit-overflow-scrolling:touch}.ng-dropdown-panel .ng-dropdown-panel-items{display:block;height:auto;box-sizing:border-box;max-height:240px;overflow-y:auto}.ng-dropdown-panel .ng-dropdown-panel-items .ng-optgroup{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ng-dropdown-panel .ng-dropdown-panel-items .ng-option{box-sizing:border-box;cursor:pointer;display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ng-dropdown-panel .ng-dropdown-panel-items .ng-option .ng-option-label:empty:before{content:"\\200b"}.ng-dropdown-panel .ng-dropdown-panel-items .ng-option .highlighted{font-weight:700;text-decoration:underline}.ng-dropdown-panel .ng-dropdown-panel-items .ng-option.disabled{cursor:default}.ng-dropdown-panel .scroll-host{overflow:hidden;overflow-y:auto;position:relative;display:block;-webkit-overflow-scrolling:touch}.ng-dropdown-panel .scrollable-content{top:0;left:0;width:100%;height:100%;position:absolute}.ng-dropdown-panel .total-padding{width:1px;opacity:0}\n'],encapsulation:2,changeDetection:0}),n})();function v9(){return new b9}class b9{constructor(){this._selected=[]}get value(){return this._selected}select(t,e,i){if(t.selected=!0,(!t.children||!e&&i)&&this._selected.push(t),e)if(t.parent){const r=t.parent.children.length,o=t.parent.children.filter(s=>s.selected).length;t.parent.selected=r===o}else t.children&&(this._setChildrenSelectedState(t.children,!0),this._removeChildren(t),this._selected=i&&this._activeChildren(t)?[...this._selected.filter(r=>r.parent!==t),t]:[...this._selected,...t.children.filter(r=>!r.disabled)])}unselect(t,e){if(this._selected=this._selected.filter(i=>i!==t),t.selected=!1,e)if(t.parent&&t.parent.selected){const i=t.parent.children;this._removeParent(t.parent),this._removeChildren(t.parent),this._selected.push(...i.filter(r=>r!==t&&!r.disabled)),t.parent.selected=!1}else t.children&&(this._setChildrenSelectedState(t.children,!1),this._removeChildren(t))}clear(t){this._selected=t?this._selected.filter(e=>e.disabled):[]}_setChildrenSelectedState(t,e){for(const i of t)i.disabled||(i.selected=e)}_removeChildren(t){this._selected=[...this._selected.filter(e=>e.parent!==t),...t.children.filter(e=>e.parent===t&&e.disabled&&e.selected)]}_removeParent(t){this._selected=this._selected.filter(e=>e!==t)}_activeChildren(t){return t.children.every(e=>!e.disabled||e.selected)}}let y9=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ns({type:n}),n.\u0275inj=ts({providers:[{provide:Dk,useValue:v9}],imports:[[M2]]}),n})();class nd extends d{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:i}=this;if(t)throw e;return this._throwIfClosed(),i}next(t){super.next(this._value=t)}}function bm(...n){return mo(n,kl(n))}function Ik(n,t,e){return e?Ik(n,t).pipe(lm(e)):new O(i=>{const r=(...s)=>i.next(1===s.length?s[0]:s),o=n(r);return f(t)?()=>t(r,o):void 0})}function id(...n){const t=kl(n),e=Il(n),{args:i,keys:r}=dD(n);if(0===i.length)return mo([],t);const o=new O(kk(i,t,r?s=>fD(r,s):F));return e?o.pipe(lm(e)):o}function kk(n,t,e=F){return i=>{Mk(t,()=>{const{length:r}=n,o=new Array(r);let s=r,a=r;for(let g=0;g<r;g++)Mk(t,()=>{const w=mo(n[g],t);let W=!1;w.subscribe($(i,ve=>{o[g]=ve,W||(W=!0,a--),a||i.next(e(o.slice()))},()=>{--s||i.complete()}))},i)},i)}}function Mk(n,t,e){n?es(e,n,t):t()}class x9 extends O{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,_(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,null==t||t.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new D;const e=this.getSubject();t.add(this.source.subscribe($(e,void 0,()=>{this._teardown(),e.complete()},i=>{this._teardown(),e.error(i)},()=>this._teardown()))),t.closed&&(this._connection=null,t=D.EMPTY)}return t}refCount(){return function C9(){return x((n,t)=>{let e=null;n._refCount++;const i=$(t,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(e=null);const r=n._connection,o=e;e=null,r&&(!o||r===o)&&r.unsubscribe(),t.unsubscribe()});n.subscribe(i),i.closed||(e=n.connect())})}()(this)}}const E9={connector:()=>new d};function Ak(n,t=E9){const{connector:e}=t;return x((i,r)=>{const o=e();mo(n(function w9(n){return new O(t=>n.subscribe(t))}(o))).subscribe(r),r.add(i.subscribe(o))})}function Hx(...n){const t=Il(n);return x((e,i)=>{const r=n.length,o=new Array(r);let s=n.map(()=>!1),a=!1;for(let g=0;g<r;g++)Mo(n[g]).subscribe($(i,w=>{o[g]=w,!a&&!s[g]&&(s[g]=!0,(a=s.every(F))&&(s=null))},re));e.subscribe($(i,g=>{if(a){const w=[g,...o];i.next(t?t(...w):w)}}))})}function I9(n,t,e,i,r){return(o,s)=>{let a=e,g=t,w=0;o.subscribe($(s,W=>{const ve=w++;g=a?n(g,W,ve):(a=!0,W),i&&s.next(g)},r&&(()=>{a&&s.next(g),s.complete()})))}}function A9(n,t){return n===t}const{isArray:P9}=Array;function F9(n){return 1===n.length&&P9(n[0])?n[0]:n}function Pk(...n){const t=Il(n);return t?he(Pk(...n),lm(t)):x((e,i)=>{kk([e,...F9(n)])(i)})}const N9=["youtubeContainer"];let Nk=(()=>{class n{constructor(e,i){this._ngZone=e,this._youtubeContainer=new d,this._destroyed=new d,this._playerChanges=new nd(void 0),this._videoId=new nd(void 0),this._height=new nd(390),this._width=new nd(640),this._startSeconds=new nd(void 0),this._endSeconds=new nd(void 0),this._suggestedQuality=new nd(void 0),this._playerVars=new nd(void 0),this.ready=this._getLazyEmitter("onReady"),this.stateChange=this._getLazyEmitter("onStateChange"),this.error=this._getLazyEmitter("onError"),this.apiChange=this._getLazyEmitter("onApiChange"),this.playbackQualityChange=this._getLazyEmitter("onPlaybackQualityChange"),this.playbackRateChange=this._getLazyEmitter("onPlaybackRateChange"),this._isBrowser=function M6(n){return n===YS}(i)}get videoId(){return this._videoId.value}set videoId(e){this._videoId.next(e)}get height(){return this._height.value}set height(e){this._height.next(e||390)}get width(){return this._width.value}set width(e){this._width.next(e||640)}set startSeconds(e){this._startSeconds.next(e)}set endSeconds(e){this._endSeconds.next(e)}set suggestedQuality(e){this._suggestedQuality.next(e)}get playerVars(){return this._playerVars.value}set playerVars(e){this._playerVars.next(e)}ngOnInit(){if(!this._isBrowser)return;let e=bm(!0);if(!window.YT||!window.YT.Player){const r=new d;this._existingApiReadyCallback=window.onYouTubeIframeAPIReady,window.onYouTubeIframeAPIReady=()=>{this._existingApiReadyCallback&&this._existingApiReadyCallback(),this._ngZone.run(()=>r.next(!0))},e=r.pipe(Po(1),Lx(!1))}const i=function z9(n,t,e,i,r,o,s){const a=id([t,o]).pipe(Hx(id([i,r])),ae(([g,w])=>{const[W,ve]=g,[me,Se]=w;return W?{videoId:W,playerVars:ve,width:me,height:Se}:void 0}));return id([n,a,bm(s)]).pipe(function H9(n){return he(Pk(n),function R9(n){return x((t,e)=>{let i=!1,r=0;t.subscribe($(e,o=>(i||(i=!n(o,r++)))&&e.next(o)))})}(([t,e])=>!e),ae(([t])=>t))}(e),function k9(n,t){return x(I9(n,t,arguments.length>=2,!0))}(V9,void 0),function M9(n,t=F){return n=null!=n?n:A9,x((e,i)=>{let r,o=!0;e.subscribe($(i,s=>{const a=t(s);(o||!n(r,a))&&(o=!1,r=a,i.next(s))}))})}())}(this._youtubeContainer,this._videoId,e,this._width,this._height,this._playerVars,this._ngZone).pipe(mk(r=>{this._playerChanges.next(r)}),function L9(n){return bc(t=>t?Ok(t)?bm(t):new O(e=>{let i=!1,r=!1;const o=s=>{r=!0,i||(s.target.removeEventListener("onReady",o),e.next(s.target))};return t.addEventListener("onReady",o),()=>{i=!0,r||n(t)}}).pipe(Po(1),Lx(void 0)):bm(void 0))}(r=>{Ok(r)||r.destroy()}),jc(this._destroyed),function S9(n){return n?t=>Ak(n)(t):t=>function T9(n,t){const e=f(n)?n:()=>n;return f(t)?Ak(t,{connector:e}):i=>new x9(i,e)}(new d)(t)}());i.subscribe(r=>{this._player=r,r&&this._pendingPlayerState&&this._initializePlayer(r,this._pendingPlayerState),this._pendingPlayerState=void 0}),function O9(n,t,e){id([n,t,e]).subscribe(([i,r,o])=>i&&i.setSize(r,o))}(i,this._width,this._height),function B9(n,t){id([n,t]).subscribe(([e,i])=>e&&i&&e.setPlaybackQuality(i))}(i,this._suggestedQuality),function U9(n,t,e,i,r,o){const s=id([e,i]).pipe(ae(([W,ve])=>({startSeconds:W,endSeconds:ve}))),a=s.pipe(Vx(n,W=>!!W&&!function j9(n){const t=n.getPlayerState();return t!==YT.PlayerState.UNSTARTED&&t!==YT.PlayerState.CUED}(W))),g=t.pipe(Vx(n,(W,ve)=>!!W&&W.videoId!==ve));$o(n.pipe(Vx(id([t,s]),([W,ve],me)=>!(!me||W==me.videoId&&!ve.startSeconds&&!ve.endSeconds))),g,a).pipe(Hx(id([n,t,s,r])),ae(([W,ve])=>ve),jc(o)).subscribe(([W,ve,me,Se])=>{!ve||!W||(W.videoId=ve,W.cueVideoById(Object.assign({videoId:ve,suggestedQuality:Se},me)))})}(i,this._videoId,this._startSeconds,this._endSeconds,this._suggestedQuality,this._destroyed),i.connect()}ngAfterViewInit(){this._youtubeContainer.next(this.youtubeContainer.nativeElement)}ngOnDestroy(){this._player&&(this._player.destroy(),window.onYouTubeIframeAPIReady=this._existingApiReadyCallback),this._playerChanges.complete(),this._videoId.complete(),this._height.complete(),this._width.complete(),this._startSeconds.complete(),this._endSeconds.complete(),this._suggestedQuality.complete(),this._youtubeContainer.complete(),this._playerVars.complete(),this._destroyed.next(),this._destroyed.complete()}playVideo(){this._player?this._player.playVideo():this._getPendingState().playbackState=YT.PlayerState.PLAYING}pauseVideo(){this._player?this._player.pauseVideo():this._getPendingState().playbackState=YT.PlayerState.PAUSED}stopVideo(){this._player?this._player.stopVideo():this._getPendingState().playbackState=YT.PlayerState.CUED}seekTo(e,i){this._player?this._player.seekTo(e,i):this._getPendingState().seek={seconds:e,allowSeekAhead:i}}mute(){this._player?this._player.mute():this._getPendingState().muted=!0}unMute(){this._player?this._player.unMute():this._getPendingState().muted=!1}isMuted(){return this._player?this._player.isMuted():!!this._pendingPlayerState&&!!this._pendingPlayerState.muted}setVolume(e){this._player?this._player.setVolume(e):this._getPendingState().volume=e}getVolume(){return this._player?this._player.getVolume():this._pendingPlayerState&&null!=this._pendingPlayerState.volume?this._pendingPlayerState.volume:0}setPlaybackRate(e){if(this._player)return this._player.setPlaybackRate(e);this._getPendingState().playbackRate=e}getPlaybackRate(){return this._player?this._player.getPlaybackRate():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackRate?this._pendingPlayerState.playbackRate:0}getAvailablePlaybackRates(){return this._player?this._player.getAvailablePlaybackRates():[]}getVideoLoadedFraction(){return this._player?this._player.getVideoLoadedFraction():0}getPlayerState(){if(this._isBrowser&&window.YT)return this._player?this._player.getPlayerState():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackState?this._pendingPlayerState.playbackState:YT.PlayerState.UNSTARTED}getCurrentTime(){return this._player?this._player.getCurrentTime():this._pendingPlayerState&&this._pendingPlayerState.seek?this._pendingPlayerState.seek.seconds:0}getPlaybackQuality(){return this._player?this._player.getPlaybackQuality():"default"}getAvailableQualityLevels(){return this._player?this._player.getAvailableQualityLevels():[]}getDuration(){return this._player?this._player.getDuration():0}getVideoUrl(){return this._player?this._player.getVideoUrl():""}getVideoEmbedCode(){return this._player?this._player.getVideoEmbedCode():""}_getPendingState(){return this._pendingPlayerState||(this._pendingPlayerState={}),this._pendingPlayerState}_initializePlayer(e,i){const{playbackState:r,playbackRate:o,volume:s,muted:a,seek:g}=i;switch(r){case YT.PlayerState.PLAYING:e.playVideo();break;case YT.PlayerState.PAUSED:e.pauseVideo();break;case YT.PlayerState.CUED:e.stopVideo()}null!=o&&e.setPlaybackRate(o),null!=s&&e.setVolume(s),null!=a&&(a?e.mute():e.unMute()),null!=g&&e.seekTo(g.seconds,g.allowSeekAhead)}_getLazyEmitter(e){return this._playerChanges.pipe(function D9(n,t){return x((e,i)=>{let r=null,o=0,s=!1;const a=()=>s&&!r&&i.complete();e.subscribe($(i,g=>{null==r||r.unsubscribe();let w=0;const W=o++;Mo(n(g,W)).subscribe(r=$(i,ve=>i.next(t?t(g,ve,W,w++):ve),()=>{r=null,a()}))},()=>{s=!0,a()}))})}(i=>i?Ik(r=>{i.addEventListener(e,r)},r=>{try{i.removeEventListener&&i.removeEventListener(e,r)}catch(o){}}):bm()),i=>new O(r=>i.subscribe({next:o=>this._ngZone.run(()=>r.next(o)),error:o=>r.error(o),complete:()=>r.complete()})),jc(this._destroyed))}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(P1))},n.\u0275cmp=Qt({type:n,selectors:[["youtube-player"]],viewQuery:function(e,i){if(1&e&&Gn(N9,5),2&e){let r;yn(r=Cn())&&(i.youtubeContainer=r.first)}},inputs:{videoId:"videoId",height:"height",width:"width",startSeconds:"startSeconds",endSeconds:"endSeconds",suggestedQuality:"suggestedQuality",playerVars:"playerVars",showBeforeIframeApiLoads:"showBeforeIframeApiLoads"},outputs:{ready:"ready",stateChange:"stateChange",error:"error",apiChange:"apiChange",playbackQualityChange:"playbackQualityChange",playbackRateChange:"playbackRateChange"},decls:2,vars:0,consts:[["youtubeContainer",""]],template:function(e,i){1&e&&it(0,"div",null,0)},encapsulation:2,changeDetection:0}),n})();function V9(n,[t,e,i]){if(n&&e&&n.playerVars!==e.playerVars)n.destroy();else{if(!e)return void(n&&n.destroy());if(n)return n}const r=i.runOutsideAngular(()=>new YT.Player(t,e));return r.videoId=e.videoId,r.playerVars=e.playerVars,r}function Ok(n){return"getPlayerStatus"in n}function Vx(n,t){return he(Hx(n),$k(([e,i])=>t(i,e)),ae(([e])=>e))}let G9=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ns({type:n}),n.\u0275inj=ts({}),n})();var xn=Ce(5861);let _p=0;const ym=new Map,Nv=new MessageChannel;function Yo(n){if(4294967296===_p&&(_p=0),++_p in ym)throw new Error("setZeroTimeout queue overflow.");return ym.set(_p,n),Nv.port2.postMessage(_p),_p}Nv.port1.onmessage=function(n){const t=ym.get(n.data);ym.delete(n.data),t&&t()},Nv.port1.start(),Nv.port2.start();class Bk{}var Lk=Ce(8497),zk=Ce(1817),rd=(()=>{return(n=rd||(rd={}))[n.UNSPECIFIED=0]="UNSPECIFIED",n[n.LOW=1]="LOW",n[n.MIDDLE=2]="MIDDLE",n[n.HIGH=3]="HIGH",rd;var n})();const Z9=function W9(n){if(n.length>=255)throw new TypeError("Alphabet too long");const t=new Uint8Array(256);for(let w=0;w<t.length;w++)t[w]=255;for(let w=0;w<n.length;w++){const W=n.charAt(w),ve=W.charCodeAt(0);if(255!==t[ve])throw new TypeError(W+" is ambiguous");t[ve]=w}const e=n.length,i=n.charAt(0),r=Math.log(e)/Math.log(256),o=Math.log(256)/Math.log(e);function a(w){if("string"!=typeof w)throw new TypeError("Expected String");if(0===w.length)return new Uint8Array;let W=0;if(" "===w[W])return;let ve=0,me=0;for(;w[W]===i;)ve++,W++;const Se=(w.length-W)*r+1>>>0,Oe=new Uint8Array(Se);for(;w[W];){let je=t[w.charCodeAt(W)];if(255===je)return;let ut=0;for(let ot=Se-1;(0!==je||ut<me)&&-1!==ot;ot--,ut++)je+=e*Oe[ot]>>>0,Oe[ot]=je%256>>>0,je=je/256>>>0;if(0!==je)throw new Error("Non-zero carry");me=ut,W++}if(" "===w[W])return;let Ve=Se-me;for(;Ve!==Se&&0===Oe[Ve];)Ve++;const We=new Uint8Array(ve+(Se-Ve));let Ze=ve;for(;Ve!==Se;)We[Ze++]=Oe[Ve++];return We}return{encode:function s(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===w.length)return"";let W=0,ve=0,me=0;const Se=w.length;for(;me!==Se&&0===w[me];)me++,W++;const Oe=(Se-me)*o+1>>>0,Ve=new Uint8Array(Oe);for(;me!==Se;){let je=w[me],ut=0;for(let ot=Oe-1;(0!==je||ut<ve)&&-1!==ot;ot--,ut++)je+=256*Ve[ot]>>>0,Ve[ot]=je%e>>>0,je=je/e>>>0;if(0!==je)throw new Error("Non-zero carry");ve=ut,me++}let We=Oe-ve;for(;We!==Oe&&0===Ve[We];)We++;let Ze=i.repeat(W);for(;We<Oe;++We)Ze+=n.charAt(Ve[We]);return Ze},decodeUnsafe:a,decode:function g(w){const W=a(w);if(W)return W;throw new Error("Non-base"+e+" character")}}}("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),Y9=/^(\w{6})(\w{3})(\w*)-(\w*)/i;class zi{constructor(t){this.peerId="",this.userId="",this.roomId="",this.roomName="",this.password="",this.digestUserId="",this.digestPassword="",this.isOpen=!1,this.session={grade:rd.UNSPECIFIED,ping:0,health:0,speed:0,description:""},this.parse(t)}get isRoom(){return 0<this.roomId.length}get hasPassword(){return 0<this.password.length+this.digestPassword.length}parse(t){try{this.peerId=t;let e=Y9.exec(t);if(null!=e)return this.digestUserId=e[1],this.roomId=e[2],this.roomName=Lk.L(e[3]),void(this.digestPassword=e[4])}catch(e){console.warn(e)}this.digestUserId=t}verifyPassword(t){return Hk(this.roomId,t)===this.digestPassword}static parse(t){return new zi(t)}static create(...t){return t.length<=1?zi._create.apply(this,t):zi._createRoom.apply(this,t)}static _create(t=""){let e=function K9(n){return null==n?"":Vk(n)}(t),i=new zi(e);return i.userId=t,i}static _createRoom(t="",e="",i="",r=""){let o=this.generateId("******"),s=Hk(e,r),a=`${o}${e}${Lk.n(i)}-${s}`,g=new zi(a);return g.userId=t,g.password=r,g}static generateId(t="********"){const e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";let i=t;return i=t.replace(/\*/g,r=>e[Math.floor(Math.random()*e.length)]),i}}function Hk(n,t){return null==n||null==t?"":0<t.length?Vk(n+t,7):""}function Vk(n,t=-1){if(null==n)return"";let e=zk(n),i=new Uint8Array(Uint32Array.from(e.words).buffer),r=Z9.encode(i);return t<0&&(t=r.length),r.length<t&&(t=r.length),r=r.slice(0,t),r}function mp(n){let t=n.length;for(;--t>=0;)n[t]=0}const Wx=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Ov=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),r7=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Kk=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Gc=new Array(576);mp(Gc);const wm=new Array(60);mp(wm);const Em=new Array(512);mp(Em);const Tm=new Array(256);mp(Tm);const Zx=new Array(29);mp(Zx);const Bv=new Array(30);function Yx(n,t,e,i,r){this.static_tree=n,this.extra_bits=t,this.extra_base=e,this.elems=i,this.max_length=r,this.has_stree=n&&n.length}let Xk,Qk,Jk;function Kx(n,t){this.dyn_tree=n,this.max_code=0,this.stat_desc=t}mp(Bv);const eM=n=>n<256?Em[n]:Em[256+(n>>>7)],Sm=(n,t)=>{n.pending_buf[n.pending++]=255&t,n.pending_buf[n.pending++]=t>>>8&255},zs=(n,t,e)=>{n.bi_valid>16-e?(n.bi_buf|=t<<n.bi_valid&65535,Sm(n,n.bi_buf),n.bi_buf=t>>16-n.bi_valid,n.bi_valid+=e-16):(n.bi_buf|=t<<n.bi_valid&65535,n.bi_valid+=e)},ac=(n,t,e)=>{zs(n,e[2*t],e[2*t+1])},tM=(n,t)=>{let e=0;do{e|=1&n,n>>>=1,e<<=1}while(--t>0);return e>>>1},nM=(n,t,e)=>{const i=new Array(16);let o,s,r=0;for(o=1;o<=15;o++)i[o]=r=r+e[o-1]<<1;for(s=0;s<=t;s++){let a=n[2*s+1];0!==a&&(n[2*s]=tM(i[a]++,a))}},iM=n=>{let t;for(t=0;t<286;t++)n.dyn_ltree[2*t]=0;for(t=0;t<30;t++)n.dyn_dtree[2*t]=0;for(t=0;t<19;t++)n.bl_tree[2*t]=0;n.dyn_ltree[512]=1,n.opt_len=n.static_len=0,n.last_lit=n.matches=0},rM=n=>{n.bi_valid>8?Sm(n,n.bi_buf):n.bi_valid>0&&(n.pending_buf[n.pending++]=n.bi_buf),n.bi_buf=0,n.bi_valid=0},oM=(n,t,e,i)=>{const r=2*t,o=2*e;return n[r]<n[o]||n[r]===n[o]&&i[t]<=i[e]},Xx=(n,t,e)=>{const i=n.heap[e];let r=e<<1;for(;r<=n.heap_len&&(r<n.heap_len&&oM(t,n.heap[r+1],n.heap[r],n.depth)&&r++,!oM(t,i,n.heap[r],n.depth));)n.heap[e]=n.heap[r],e=r,r<<=1;n.heap[e]=i},sM=(n,t,e)=>{let i,r,s,a,o=0;if(0!==n.last_lit)do{i=n.pending_buf[n.d_buf+2*o]<<8|n.pending_buf[n.d_buf+2*o+1],r=n.pending_buf[n.l_buf+o],o++,0===i?ac(n,r,t):(s=Tm[r],ac(n,s+256+1,t),a=Wx[s],0!==a&&(r-=Zx[s],zs(n,r,a)),i--,s=eM(i),ac(n,s,e),a=Ov[s],0!==a&&(i-=Bv[s],zs(n,i,a)))}while(o<n.last_lit);ac(n,256,t)},Qx=(n,t)=>{const e=t.dyn_tree,i=t.stat_desc.static_tree,r=t.stat_desc.has_stree,o=t.stat_desc.elems;let s,a,w,g=-1;for(n.heap_len=0,n.heap_max=573,s=0;s<o;s++)0!==e[2*s]?(n.heap[++n.heap_len]=g=s,n.depth[s]=0):e[2*s+1]=0;for(;n.heap_len<2;)w=n.heap[++n.heap_len]=g<2?++g:0,e[2*w]=1,n.depth[w]=0,n.opt_len--,r&&(n.static_len-=i[2*w+1]);for(t.max_code=g,s=n.heap_len>>1;s>=1;s--)Xx(n,e,s);w=o;do{s=n.heap[1],n.heap[1]=n.heap[n.heap_len--],Xx(n,e,1),a=n.heap[1],n.heap[--n.heap_max]=s,n.heap[--n.heap_max]=a,e[2*w]=e[2*s]+e[2*a],n.depth[w]=(n.depth[s]>=n.depth[a]?n.depth[s]:n.depth[a])+1,e[2*s+1]=e[2*a+1]=w,n.heap[1]=w++,Xx(n,e,1)}while(n.heap_len>=2);n.heap[--n.heap_max]=n.heap[1],((n,t)=>{const e=t.dyn_tree,i=t.max_code,r=t.stat_desc.static_tree,o=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,g=t.stat_desc.max_length;let w,W,ve,me,Se,Oe,Ve=0;for(me=0;me<=15;me++)n.bl_count[me]=0;for(e[2*n.heap[n.heap_max]+1]=0,w=n.heap_max+1;w<573;w++)W=n.heap[w],me=e[2*e[2*W+1]+1]+1,me>g&&(me=g,Ve++),e[2*W+1]=me,!(W>i)&&(n.bl_count[me]++,Se=0,W>=a&&(Se=s[W-a]),Oe=e[2*W],n.opt_len+=Oe*(me+Se),o&&(n.static_len+=Oe*(r[2*W+1]+Se)));if(0!==Ve){do{for(me=g-1;0===n.bl_count[me];)me--;n.bl_count[me]--,n.bl_count[me+1]+=2,n.bl_count[g]--,Ve-=2}while(Ve>0);for(me=g;0!==me;me--)for(W=n.bl_count[me];0!==W;)ve=n.heap[--w],!(ve>i)&&(e[2*ve+1]!==me&&(n.opt_len+=(me-e[2*ve+1])*e[2*ve],e[2*ve+1]=me),W--)}})(n,t),nM(e,g,n.bl_count)},aM=(n,t,e)=>{let i,o,r=-1,s=t[1],a=0,g=7,w=4;for(0===s&&(g=138,w=3),t[2*(e+1)+1]=65535,i=0;i<=e;i++)o=s,s=t[2*(i+1)+1],!(++a<g&&o===s)&&(a<w?n.bl_tree[2*o]+=a:0!==o?(o!==r&&n.bl_tree[2*o]++,n.bl_tree[32]++):a<=10?n.bl_tree[34]++:n.bl_tree[36]++,a=0,r=o,0===s?(g=138,w=3):o===s?(g=6,w=3):(g=7,w=4))},lM=(n,t,e)=>{let i,o,r=-1,s=t[1],a=0,g=7,w=4;for(0===s&&(g=138,w=3),i=0;i<=e;i++)if(o=s,s=t[2*(i+1)+1],!(++a<g&&o===s)){if(a<w)do{ac(n,o,n.bl_tree)}while(0!=--a);else 0!==o?(o!==r&&(ac(n,o,n.bl_tree),a--),ac(n,16,n.bl_tree),zs(n,a-3,2)):a<=10?(ac(n,17,n.bl_tree),zs(n,a-3,3)):(ac(n,18,n.bl_tree),zs(n,a-11,7));a=0,r=o,0===s?(g=138,w=3):o===s?(g=6,w=3):(g=7,w=4)}};let cM=!1;const uM=(n,t,e,i)=>{zs(n,0+(i?1:0),3),((n,t,e,i)=>{rM(n),Sm(n,e),Sm(n,~e),n.pending_buf.set(n.window.subarray(t,t+e),n.pending),n.pending+=e})(n,t,e)};var C7={_tr_init:n=>{cM||((()=>{let n,t,e,i,r;const o=new Array(16);for(e=0,i=0;i<28;i++)for(Zx[i]=e,n=0;n<1<<Wx[i];n++)Tm[e++]=i;for(Tm[e-1]=i,r=0,i=0;i<16;i++)for(Bv[i]=r,n=0;n<1<<Ov[i];n++)Em[r++]=i;for(r>>=7;i<30;i++)for(Bv[i]=r<<7,n=0;n<1<<Ov[i]-7;n++)Em[256+r++]=i;for(t=0;t<=15;t++)o[t]=0;for(n=0;n<=143;)Gc[2*n+1]=8,n++,o[8]++;for(;n<=255;)Gc[2*n+1]=9,n++,o[9]++;for(;n<=279;)Gc[2*n+1]=7,n++,o[7]++;for(;n<=287;)Gc[2*n+1]=8,n++,o[8]++;for(nM(Gc,287,o),n=0;n<30;n++)wm[2*n+1]=5,wm[2*n]=tM(n,5);Xk=new Yx(Gc,Wx,257,286,15),Qk=new Yx(wm,Ov,0,30,15),Jk=new Yx(new Array(0),r7,0,19,7)})(),cM=!0),n.l_desc=new Kx(n.dyn_ltree,Xk),n.d_desc=new Kx(n.dyn_dtree,Qk),n.bl_desc=new Kx(n.bl_tree,Jk),n.bi_buf=0,n.bi_valid=0,iM(n)},_tr_stored_block:uM,_tr_flush_block:(n,t,e,i)=>{let r,o,s=0;n.level>0?(2===n.strm.data_type&&(n.strm.data_type=(n=>{let e,t=4093624447;for(e=0;e<=31;e++,t>>>=1)if(1&t&&0!==n.dyn_ltree[2*e])return 0;if(0!==n.dyn_ltree[18]||0!==n.dyn_ltree[20]||0!==n.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==n.dyn_ltree[2*e])return 1;return 0})(n)),Qx(n,n.l_desc),Qx(n,n.d_desc),s=(n=>{let t;for(aM(n,n.dyn_ltree,n.l_desc.max_code),aM(n,n.dyn_dtree,n.d_desc.max_code),Qx(n,n.bl_desc),t=18;t>=3&&0===n.bl_tree[2*Kk[t]+1];t--);return n.opt_len+=3*(t+1)+5+5+4,t})(n),r=n.opt_len+3+7>>>3,o=n.static_len+3+7>>>3,o<=r&&(r=o)):r=o=e+5,e+4<=r&&-1!==t?uM(n,t,e,i):4===n.strategy||o===r?(zs(n,2+(i?1:0),3),sM(n,Gc,wm)):(zs(n,4+(i?1:0),3),((n,t,e,i)=>{let r;for(zs(n,t-257,5),zs(n,e-1,5),zs(n,i-4,4),r=0;r<i;r++)zs(n,n.bl_tree[2*Kk[r]+1],3);lM(n,n.dyn_ltree,t-1),lM(n,n.dyn_dtree,e-1)})(n,n.l_desc.max_code+1,n.d_desc.max_code+1,s+1),sM(n,n.dyn_ltree,n.dyn_dtree)),iM(n),i&&rM(n)},_tr_tally:(n,t,e)=>(n.pending_buf[n.d_buf+2*n.last_lit]=t>>>8&255,n.pending_buf[n.d_buf+2*n.last_lit+1]=255&t,n.pending_buf[n.l_buf+n.last_lit]=255&e,n.last_lit++,0===t?n.dyn_ltree[2*e]++:(n.matches++,t--,n.dyn_ltree[2*(Tm[e]+256+1)]++,n.dyn_dtree[2*eM(t)]++),n.last_lit===n.lit_bufsize-1),_tr_align:n=>{zs(n,2,3),ac(n,256,Gc),(n=>{16===n.bi_valid?(Sm(n,n.bi_buf),n.bi_buf=0,n.bi_valid=0):n.bi_valid>=8&&(n.pending_buf[n.pending++]=255&n.bi_buf,n.bi_buf>>=8,n.bi_valid-=8)})(n)}},Dm=(n,t,e,i)=>{let r=65535&n|0,o=n>>>16&65535|0,s=0;for(;0!==e;){s=e>2e3?2e3:e,e-=s;do{r=r+t[i++]|0,o=o+r|0}while(--s);r%=65521,o%=65521}return r|o<<16|0};const w7=new Uint32Array((()=>{let n,t=[];for(var e=0;e<256;e++){n=e;for(var i=0;i<8;i++)n=1&n?3988292384^n>>>1:n>>>1;t[e]=n}return t})());var ho=(n,t,e,i)=>{const r=w7,o=i+e;n^=-1;for(let s=i;s<o;s++)n=n>>>8^r[255&(n^t[s])];return-1^n},Tf={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Sf={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:E7,_tr_stored_block:T7,_tr_flush_block:S7,_tr_tally:od,_tr_align:D7}=C7,{Z_NO_FLUSH:Df,Z_PARTIAL_FLUSH:I7,Z_FULL_FLUSH:k7,Z_FINISH:sd,Z_BLOCK:dM,Z_OK:lc,Z_STREAM_END:fM,Z_STREAM_ERROR:La,Z_DATA_ERROR:M7,Z_BUF_ERROR:Jx,Z_DEFAULT_COMPRESSION:A7,Z_FILTERED:P7,Z_HUFFMAN_ONLY:Lv,Z_RLE:F7,Z_FIXED:R7,Z_DEFAULT_STRATEGY:N7,Z_UNKNOWN:O7,Z_DEFLATED:zv}=Sf,$l=262,ld=(n,t)=>(n.msg=Tf[t],t),hM=n=>(n<<1)-(n>4?9:0),cd=n=>{let t=n.length;for(;--t>=0;)n[t]=0};let ud=(n,t,e)=>(t<<n.hash_shift^e)&n.hash_mask;const dd=n=>{const t=n.state;let e=t.pending;e>n.avail_out&&(e=n.avail_out),0!==e&&(n.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+e),n.next_out),n.next_out+=e,t.pending_out+=e,n.total_out+=e,n.avail_out-=e,t.pending-=e,0===t.pending&&(t.pending_out=0))},wo=(n,t)=>{S7(n,n.block_start>=0?n.block_start:-1,n.strstart-n.block_start,t),n.block_start=n.strstart,dd(n.strm)},Ci=(n,t)=>{n.pending_buf[n.pending++]=t},Mm=(n,t)=>{n.pending_buf[n.pending++]=t>>>8&255,n.pending_buf[n.pending++]=255&t},Z7=(n,t,e,i)=>{let r=n.avail_in;return r>i&&(r=i),0===r?0:(n.avail_in-=r,t.set(n.input.subarray(n.next_in,n.next_in+r),e),1===n.state.wrap?n.adler=Dm(n.adler,t,r,e):2===n.state.wrap&&(n.adler=ho(n.adler,t,r,e)),n.next_in+=r,n.total_in+=r,r)},pM=(n,t)=>{let r,o,e=n.max_chain_length,i=n.strstart,s=n.prev_length,a=n.nice_match;const g=n.strstart>n.w_size-$l?n.strstart-(n.w_size-$l):0,w=n.window,W=n.w_mask,ve=n.prev,me=n.strstart+258;let Se=w[i+s-1],Oe=w[i+s];n.prev_length>=n.good_match&&(e>>=2),a>n.lookahead&&(a=n.lookahead);do{if(r=t,w[r+s]===Oe&&w[r+s-1]===Se&&w[r]===w[i]&&w[++r]===w[i+1]){i+=2,r++;do{}while(w[++i]===w[++r]&&w[++i]===w[++r]&&w[++i]===w[++r]&&w[++i]===w[++r]&&w[++i]===w[++r]&&w[++i]===w[++r]&&w[++i]===w[++r]&&w[++i]===w[++r]&&i<me);if(o=258-(me-i),i=me-258,o>s){if(n.match_start=t,s=o,o>=a)break;Se=w[i+s-1],Oe=w[i+s]}}}while((t=ve[t&W])>g&&0!=--e);return s<=n.lookahead?s:n.lookahead},Mf=n=>{const t=n.w_size;let e,i,r,o,s;do{if(o=n.window_size-n.lookahead-n.strstart,n.strstart>=t+(t-$l)){n.window.set(n.window.subarray(t,t+t),0),n.match_start-=t,n.strstart-=t,n.block_start-=t,i=n.hash_size,e=i;do{r=n.head[--e],n.head[e]=r>=t?r-t:0}while(--i);i=t,e=i;do{r=n.prev[--e],n.prev[e]=r>=t?r-t:0}while(--i);o+=t}if(0===n.strm.avail_in)break;if(i=Z7(n.strm,n.window,n.strstart+n.lookahead,o),n.lookahead+=i,n.lookahead+n.insert>=3)for(s=n.strstart-n.insert,n.ins_h=n.window[s],n.ins_h=ud(n,n.ins_h,n.window[s+1]);n.insert&&(n.ins_h=ud(n,n.ins_h,n.window[s+3-1]),n.prev[s&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=s,s++,n.insert--,!(n.lookahead+n.insert<3)););}while(n.lookahead<$l&&0!==n.strm.avail_in)},nw=(n,t)=>{let e,i;for(;;){if(n.lookahead<$l){if(Mf(n),n.lookahead<$l&&t===Df)return 1;if(0===n.lookahead)break}if(e=0,n.lookahead>=3&&(n.ins_h=ud(n,n.ins_h,n.window[n.strstart+3-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),0!==e&&n.strstart-e<=n.w_size-$l&&(n.match_length=pM(n,e)),n.match_length>=3)if(i=od(n,n.strstart-n.match_start,n.match_length-3),n.lookahead-=n.match_length,n.match_length<=n.max_lazy_match&&n.lookahead>=3){n.match_length--;do{n.strstart++,n.ins_h=ud(n,n.ins_h,n.window[n.strstart+3-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart}while(0!=--n.match_length);n.strstart++}else n.strstart+=n.match_length,n.match_length=0,n.ins_h=n.window[n.strstart],n.ins_h=ud(n,n.ins_h,n.window[n.strstart+1]);else i=od(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++;if(i&&(wo(n,!1),0===n.strm.avail_out))return 1}return n.insert=n.strstart<2?n.strstart:2,t===sd?(wo(n,!0),0===n.strm.avail_out?3:4):n.last_lit&&(wo(n,!1),0===n.strm.avail_out)?1:2},bp=(n,t)=>{let e,i,r;for(;;){if(n.lookahead<$l){if(Mf(n),n.lookahead<$l&&t===Df)return 1;if(0===n.lookahead)break}if(e=0,n.lookahead>=3&&(n.ins_h=ud(n,n.ins_h,n.window[n.strstart+3-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),n.prev_length=n.match_length,n.prev_match=n.match_start,n.match_length=2,0!==e&&n.prev_length<n.max_lazy_match&&n.strstart-e<=n.w_size-$l&&(n.match_length=pM(n,e),n.match_length<=5&&(n.strategy===P7||3===n.match_length&&n.strstart-n.match_start>4096)&&(n.match_length=2)),n.prev_length>=3&&n.match_length<=n.prev_length){r=n.strstart+n.lookahead-3,i=od(n,n.strstart-1-n.prev_match,n.prev_length-3),n.lookahead-=n.prev_length-1,n.prev_length-=2;do{++n.strstart<=r&&(n.ins_h=ud(n,n.ins_h,n.window[n.strstart+3-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart)}while(0!=--n.prev_length);if(n.match_available=0,n.match_length=2,n.strstart++,i&&(wo(n,!1),0===n.strm.avail_out))return 1}else if(n.match_available){if(i=od(n,0,n.window[n.strstart-1]),i&&wo(n,!1),n.strstart++,n.lookahead--,0===n.strm.avail_out)return 1}else n.match_available=1,n.strstart++,n.lookahead--}return n.match_available&&(i=od(n,0,n.window[n.strstart-1]),n.match_available=0),n.insert=n.strstart<2?n.strstart:2,t===sd?(wo(n,!0),0===n.strm.avail_out?3:4):n.last_lit&&(wo(n,!1),0===n.strm.avail_out)?1:2};function cc(n,t,e,i,r){this.good_length=n,this.max_lazy=t,this.nice_length=e,this.max_chain=i,this.func=r}const Am=[new cc(0,0,0,0,(n,t)=>{let e=65535;for(e>n.pending_buf_size-5&&(e=n.pending_buf_size-5);;){if(n.lookahead<=1){if(Mf(n),0===n.lookahead&&t===Df)return 1;if(0===n.lookahead)break}n.strstart+=n.lookahead,n.lookahead=0;const i=n.block_start+e;if((0===n.strstart||n.strstart>=i)&&(n.lookahead=n.strstart-i,n.strstart=i,wo(n,!1),0===n.strm.avail_out)||n.strstart-n.block_start>=n.w_size-$l&&(wo(n,!1),0===n.strm.avail_out))return 1}return n.insert=0,t===sd?(wo(n,!0),0===n.strm.avail_out?3:4):(n.strstart>n.block_start&&wo(n,!1),1)}),new cc(4,4,8,4,nw),new cc(4,5,16,8,nw),new cc(4,6,32,32,nw),new cc(4,4,16,16,bp),new cc(8,16,32,32,bp),new cc(8,16,128,128,bp),new cc(8,32,128,256,bp),new cc(32,128,258,1024,bp),new cc(32,258,258,4096,bp)];function J7(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=zv,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),cd(this.dyn_ltree),cd(this.dyn_dtree),cd(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),cd(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),cd(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const gM=n=>{if(!n||!n.state)return ld(n,La);n.total_in=n.total_out=0,n.data_type=O7;const t=n.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,n.adler=2===t.wrap?0:1,t.last_flush=Df,E7(t),lc},_M=n=>{const t=gM(n);return t===lc&&(n=>{n.window_size=2*n.w_size,cd(n.head),n.max_lazy_match=Am[n.level].max_lazy,n.good_match=Am[n.level].good_length,n.nice_match=Am[n.level].nice_length,n.max_chain_length=Am[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0})(n.state),t},mM=(n,t,e,i,r,o)=>{if(!n)return La;let s=1;if(t===A7&&(t=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),r<1||r>9||e!==zv||i<8||i>15||t<0||t>9||o<0||o>R7)return ld(n,La);8===i&&(i=9);const a=new J7;return n.state=a,a.strm=n,a.wrap=s,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=t,a.strategy=o,a.method=e,_M(n)};var Pm_deflateInit2=mM,Pm_deflateSetHeader=(n,t)=>n&&n.state&&2===n.state.wrap?(n.state.gzhead=t,lc):La,Pm_deflate=(n,t)=>{let e,i;if(!n||!n.state||t>dM||t<0)return n?ld(n,La):La;const r=n.state;if(!n.output||!n.input&&0!==n.avail_in||666===r.status&&t!==sd)return ld(n,0===n.avail_out?Jx:La);r.strm=n;const o=r.last_flush;if(r.last_flush=t,42===r.status)if(2===r.wrap)n.adler=0,Ci(r,31),Ci(r,139),Ci(r,8),r.gzhead?(Ci(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Ci(r,255&r.gzhead.time),Ci(r,r.gzhead.time>>8&255),Ci(r,r.gzhead.time>>16&255),Ci(r,r.gzhead.time>>24&255),Ci(r,9===r.level?2:r.strategy>=Lv||r.level<2?4:0),Ci(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(Ci(r,255&r.gzhead.extra.length),Ci(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(n.adler=ho(n.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(Ci(r,0),Ci(r,0),Ci(r,0),Ci(r,0),Ci(r,0),Ci(r,9===r.level?2:r.strategy>=Lv||r.level<2?4:0),Ci(r,3),r.status=113);else{let s=zv+(r.w_bits-8<<4)<<8,a=-1;a=r.strategy>=Lv||r.level<2?0:r.level<6?1:6===r.level?2:3,s|=a<<6,0!==r.strstart&&(s|=32),s+=31-s%31,r.status=113,Mm(r,s),0!==r.strstart&&(Mm(r,n.adler>>>16),Mm(r,65535&n.adler)),n.adler=1}if(69===r.status)if(r.gzhead.extra){for(e=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>e&&(n.adler=ho(n.adler,r.pending_buf,r.pending-e,e)),dd(n),e=r.pending,r.pending!==r.pending_buf_size));)Ci(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>e&&(n.adler=ho(n.adler,r.pending_buf,r.pending-e,e)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){e=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>e&&(n.adler=ho(n.adler,r.pending_buf,r.pending-e,e)),dd(n),e=r.pending,r.pending===r.pending_buf_size)){i=1;break}i=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,Ci(r,i)}while(0!==i);r.gzhead.hcrc&&r.pending>e&&(n.adler=ho(n.adler,r.pending_buf,r.pending-e,e)),0===i&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){e=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>e&&(n.adler=ho(n.adler,r.pending_buf,r.pending-e,e)),dd(n),e=r.pending,r.pending===r.pending_buf_size)){i=1;break}i=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,Ci(r,i)}while(0!==i);r.gzhead.hcrc&&r.pending>e&&(n.adler=ho(n.adler,r.pending_buf,r.pending-e,e)),0===i&&(r.status=103)}else r.status=103;if(103===r.status&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&dd(n),r.pending+2<=r.pending_buf_size&&(Ci(r,255&n.adler),Ci(r,n.adler>>8&255),n.adler=0,r.status=113)):r.status=113),0!==r.pending){if(dd(n),0===n.avail_out)return r.last_flush=-1,lc}else if(0===n.avail_in&&hM(t)<=hM(o)&&t!==sd)return ld(n,Jx);if(666===r.status&&0!==n.avail_in)return ld(n,Jx);if(0!==n.avail_in||0!==r.lookahead||t!==Df&&666!==r.status){let s=r.strategy===Lv?((n,t)=>{let e;for(;;){if(0===n.lookahead&&(Mf(n),0===n.lookahead)){if(t===Df)return 1;break}if(n.match_length=0,e=od(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++,e&&(wo(n,!1),0===n.strm.avail_out))return 1}return n.insert=0,t===sd?(wo(n,!0),0===n.strm.avail_out?3:4):n.last_lit&&(wo(n,!1),0===n.strm.avail_out)?1:2})(r,t):r.strategy===F7?((n,t)=>{let e,i,r,o;const s=n.window;for(;;){if(n.lookahead<=258){if(Mf(n),n.lookahead<=258&&t===Df)return 1;if(0===n.lookahead)break}if(n.match_length=0,n.lookahead>=3&&n.strstart>0&&(r=n.strstart-1,i=s[r],i===s[++r]&&i===s[++r]&&i===s[++r])){o=n.strstart+258;do{}while(i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&r<o);n.match_length=258-(o-r),n.match_length>n.lookahead&&(n.match_length=n.lookahead)}if(n.match_length>=3?(e=od(n,1,n.match_length-3),n.lookahead-=n.match_length,n.strstart+=n.match_length,n.match_length=0):(e=od(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++),e&&(wo(n,!1),0===n.strm.avail_out))return 1}return n.insert=0,t===sd?(wo(n,!0),0===n.strm.avail_out?3:4):n.last_lit&&(wo(n,!1),0===n.strm.avail_out)?1:2})(r,t):Am[r.level].func(r,t);if((3===s||4===s)&&(r.status=666),1===s||3===s)return 0===n.avail_out&&(r.last_flush=-1),lc;if(2===s&&(t===I7?D7(r):t!==dM&&(T7(r,0,0,!1),t===k7&&(cd(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),dd(n),0===n.avail_out))return r.last_flush=-1,lc}return t!==sd?lc:r.wrap<=0?fM:(2===r.wrap?(Ci(r,255&n.adler),Ci(r,n.adler>>8&255),Ci(r,n.adler>>16&255),Ci(r,n.adler>>24&255),Ci(r,255&n.total_in),Ci(r,n.total_in>>8&255),Ci(r,n.total_in>>16&255),Ci(r,n.total_in>>24&255)):(Mm(r,n.adler>>>16),Mm(r,65535&n.adler)),dd(n),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?lc:fM)},Pm_deflateEnd=n=>{if(!n||!n.state)return La;const t=n.state.status;return 42!==t&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?ld(n,La):(n.state=null,113===t?ld(n,M7):lc)},Pm_deflateSetDictionary=(n,t)=>{let e=t.length;if(!n||!n.state)return La;const i=n.state,r=i.wrap;if(2===r||1===r&&42!==i.status||i.lookahead)return La;if(1===r&&(n.adler=Dm(n.adler,t,e,0)),i.wrap=0,e>=i.w_size){0===r&&(cd(i.head),i.strstart=0,i.block_start=0,i.insert=0);let g=new Uint8Array(i.w_size);g.set(t.subarray(e-i.w_size,e),0),t=g,e=i.w_size}const o=n.avail_in,s=n.next_in,a=n.input;for(n.avail_in=e,n.next_in=0,n.input=t,Mf(i);i.lookahead>=3;){let g=i.strstart,w=i.lookahead-2;do{i.ins_h=ud(i,i.ins_h,i.window[g+3-1]),i.prev[g&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=g,g++}while(--w);i.strstart=g,i.lookahead=2,Mf(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,n.next_in=s,n.input=a,n.avail_in=o,i.wrap=r,lc};const pH=(n,t)=>Object.prototype.hasOwnProperty.call(n,t);var Gv_assign=function(n){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const e=t.shift();if(e){if("object"!=typeof e)throw new TypeError(e+"must be non-object");for(const i in e)pH(e,i)&&(n[i]=e[i])}}return n},Gv_flattenChunks=n=>{let t=0;for(let i=0,r=n.length;i<r;i++)t+=n[i].length;const e=new Uint8Array(t);for(let i=0,r=0,o=n.length;i<o;i++){let s=n[i];e.set(s,r),r+=s.length}return e};let $M=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(n){$M=!1}const Fm=new Uint8Array(256);for(let n=0;n<256;n++)Fm[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;Fm[254]=Fm[254]=1;var Rm_string2buf=n=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(n);let t,e,i,r,o,s=n.length,a=0;for(r=0;r<s;r++)e=n.charCodeAt(r),55296==(64512&e)&&r+1<s&&(i=n.charCodeAt(r+1),56320==(64512&i)&&(e=65536+(e-55296<<10)+(i-56320),r++)),a+=e<128?1:e<2048?2:e<65536?3:4;for(t=new Uint8Array(a),o=0,r=0;o<a;r++)e=n.charCodeAt(r),55296==(64512&e)&&r+1<s&&(i=n.charCodeAt(r+1),56320==(64512&i)&&(e=65536+(e-55296<<10)+(i-56320),r++)),e<128?t[o++]=e:e<2048?(t[o++]=192|e>>>6,t[o++]=128|63&e):e<65536?(t[o++]=224|e>>>12,t[o++]=128|e>>>6&63,t[o++]=128|63&e):(t[o++]=240|e>>>18,t[o++]=128|e>>>12&63,t[o++]=128|e>>>6&63,t[o++]=128|63&e);return t},Rm_buf2string=(n,t)=>{const e=t||n.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(n.subarray(0,t));let i,r;const o=new Array(2*e);for(r=0,i=0;i<e;){let s=n[i++];if(s<128){o[r++]=s;continue}let a=Fm[s];if(a>4)o[r++]=65533,i+=a-1;else{for(s&=2===a?31:3===a?15:7;a>1&&i<e;)s=s<<6|63&n[i++],a--;a>1?o[r++]=65533:s<65536?o[r++]=s:(s-=65536,o[r++]=55296|s>>10&1023,o[r++]=56320|1023&s)}}return((n,t)=>{if(t<65534&&n.subarray&&$M)return String.fromCharCode.apply(null,n.length===t?n:n.subarray(0,t));let e="";for(let i=0;i<t;i++)e+=String.fromCharCode(n[i]);return e})(o,r)},Rm_utf8border=(n,t)=>{(t=t||n.length)>n.length&&(t=n.length);let e=t-1;for(;e>=0&&128==(192&n[e]);)e--;return e<0||0===e?t:e+Fm[n[e]]>t?e:t},vM=function yH(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const bM=Object.prototype.toString,{Z_NO_FLUSH:CH,Z_SYNC_FLUSH:xH,Z_FULL_FLUSH:wH,Z_FINISH:EH,Z_OK:qv,Z_STREAM_END:TH,Z_DEFAULT_COMPRESSION:SH,Z_DEFAULT_STRATEGY:DH,Z_DEFLATED:IH}=Sf;function Nm(n){this.options=Gv_assign({level:SH,method:IH,chunkSize:16384,windowBits:15,memLevel:8,strategy:DH},n||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new vM,this.strm.avail_out=0;let e=Pm_deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(e!==qv)throw new Error(Tf[e]);if(t.header&&Pm_deflateSetHeader(this.strm,t.header),t.dictionary){let i;if(i="string"==typeof t.dictionary?Rm_string2buf(t.dictionary):"[object ArrayBuffer]"===bM.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,e=Pm_deflateSetDictionary(this.strm,i),e!==qv)throw new Error(Tf[e]);this._dict_set=!0}}function iw(n,t){const e=new Nm(t);if(e.push(n,!0),e.err)throw e.msg||Tf[e.err];return e.result}Nm.prototype.push=function(n,t){const e=this.strm,i=this.options.chunkSize;let r,o;if(this.ended)return!1;for(o=t===~~t?t:!0===t?EH:CH,e.input="string"==typeof n?Rm_string2buf(n):"[object ArrayBuffer]"===bM.call(n)?new Uint8Array(n):n,e.next_in=0,e.avail_in=e.input.length;;)if(0===e.avail_out&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),(o===xH||o===wH)&&e.avail_out<=6)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else{if(r=Pm_deflate(e,o),r===TH)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),r=Pm_deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===qv;if(0!==e.avail_out){if(o>0&&e.next_out>0)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else if(0===e.avail_in)break}else this.onData(e.output)}return!0},Nm.prototype.onData=function(n){this.chunks.push(n)},Nm.prototype.onEnd=function(n){n===qv&&(this.result=Gv_flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};var OH={Deflate:Nm,deflate:iw,deflateRaw:function kH(n,t){return(t=t||{}).raw=!0,iw(n,t)},gzip:function MH(n,t){return(t=t||{}).gzip=!0,iw(n,t)},constants:Sf},LH=function(t,e){let i,r,o,s,a,g,w,W,ve,me,Se,Oe,Ve,We,Ze,je,ut,ot,ft,Ot,Et,Ut,It,Pt;const Wt=t.state;i=t.next_in,It=t.input,r=i+(t.avail_in-5),o=t.next_out,Pt=t.output,s=o-(e-t.avail_out),a=o+(t.avail_out-257),g=Wt.dmax,w=Wt.wsize,W=Wt.whave,ve=Wt.wnext,me=Wt.window,Se=Wt.hold,Oe=Wt.bits,Ve=Wt.lencode,We=Wt.distcode,Ze=(1<<Wt.lenbits)-1,je=(1<<Wt.distbits)-1;e:do{Oe<15&&(Se+=It[i++]<<Oe,Oe+=8,Se+=It[i++]<<Oe,Oe+=8),ut=Ve[Se&Ze];t:for(;;){if(ot=ut>>>24,Se>>>=ot,Oe-=ot,ot=ut>>>16&255,0===ot)Pt[o++]=65535&ut;else{if(!(16&ot)){if(0==(64&ot)){ut=Ve[(65535&ut)+(Se&(1<<ot)-1)];continue t}if(32&ot){Wt.mode=12;break e}t.msg="invalid literal/length code",Wt.mode=30;break e}ft=65535&ut,ot&=15,ot&&(Oe<ot&&(Se+=It[i++]<<Oe,Oe+=8),ft+=Se&(1<<ot)-1,Se>>>=ot,Oe-=ot),Oe<15&&(Se+=It[i++]<<Oe,Oe+=8,Se+=It[i++]<<Oe,Oe+=8),ut=We[Se&je];n:for(;;){if(ot=ut>>>24,Se>>>=ot,Oe-=ot,ot=ut>>>16&255,!(16&ot)){if(0==(64&ot)){ut=We[(65535&ut)+(Se&(1<<ot)-1)];continue n}t.msg="invalid distance code",Wt.mode=30;break e}if(Ot=65535&ut,ot&=15,Oe<ot&&(Se+=It[i++]<<Oe,Oe+=8,Oe<ot&&(Se+=It[i++]<<Oe,Oe+=8)),Ot+=Se&(1<<ot)-1,Ot>g){t.msg="invalid distance too far back",Wt.mode=30;break e}if(Se>>>=ot,Oe-=ot,ot=o-s,Ot>ot){if(ot=Ot-ot,ot>W&&Wt.sane){t.msg="invalid distance too far back",Wt.mode=30;break e}if(Et=0,Ut=me,0===ve){if(Et+=w-ot,ot<ft){ft-=ot;do{Pt[o++]=me[Et++]}while(--ot);Et=o-Ot,Ut=Pt}}else if(ve<ot){if(Et+=w+ve-ot,ot-=ve,ot<ft){ft-=ot;do{Pt[o++]=me[Et++]}while(--ot);if(Et=0,ve<ft){ot=ve,ft-=ot;do{Pt[o++]=me[Et++]}while(--ot);Et=o-Ot,Ut=Pt}}}else if(Et+=ve-ot,ot<ft){ft-=ot;do{Pt[o++]=me[Et++]}while(--ot);Et=o-Ot,Ut=Pt}for(;ft>2;)Pt[o++]=Ut[Et++],Pt[o++]=Ut[Et++],Pt[o++]=Ut[Et++],ft-=3;ft&&(Pt[o++]=Ut[Et++],ft>1&&(Pt[o++]=Ut[Et++]))}else{Et=o-Ot;do{Pt[o++]=Pt[Et++],Pt[o++]=Pt[Et++],Pt[o++]=Pt[Et++],ft-=3}while(ft>2);ft&&(Pt[o++]=Pt[Et++],ft>1&&(Pt[o++]=Pt[Et++]))}break}}break}}while(i<r&&o<a);ft=Oe>>3,i-=ft,Oe-=ft<<3,Se&=(1<<Oe)-1,t.next_in=i,t.next_out=o,t.avail_in=i<r?r-i+5:5-(i-r),t.avail_out=o<a?a-o+257:257-(o-a),Wt.hold=Se,Wt.bits=Oe};const zH=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),HH=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),VH=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),UH=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Om=(n,t,e,i,r,o,s,a)=>{const g=a.bits;let ut,ot,ft,Ot,Et,Pt,w=0,W=0,ve=0,me=0,Se=0,Oe=0,Ve=0,We=0,Ze=0,je=0,Ut=null,It=0;const Wt=new Uint16Array(16),ci=new Uint16Array(16);let Ri,Rt,Zt,Jn=null,gi=0;for(w=0;w<=15;w++)Wt[w]=0;for(W=0;W<i;W++)Wt[t[e+W]]++;for(Se=g,me=15;me>=1&&0===Wt[me];me--);if(Se>me&&(Se=me),0===me)return r[o++]=20971520,r[o++]=20971520,a.bits=1,0;for(ve=1;ve<me&&0===Wt[ve];ve++);for(Se<ve&&(Se=ve),We=1,w=1;w<=15;w++)if(We<<=1,We-=Wt[w],We<0)return-1;if(We>0&&(0===n||1!==me))return-1;for(ci[1]=0,w=1;w<15;w++)ci[w+1]=ci[w]+Wt[w];for(W=0;W<i;W++)0!==t[e+W]&&(s[ci[t[e+W]]++]=W);if(0===n?(Ut=Jn=s,Pt=19):1===n?(Ut=zH,It-=257,Jn=HH,gi-=257,Pt=256):(Ut=VH,Jn=UH,Pt=-1),je=0,W=0,w=ve,Et=o,Oe=Se,Ve=0,ft=-1,Ze=1<<Se,Ot=Ze-1,1===n&&Ze>852||2===n&&Ze>592)return 1;for(;;){Ri=w-Ve,s[W]<Pt?(Rt=0,Zt=s[W]):s[W]>Pt?(Rt=Jn[gi+s[W]],Zt=Ut[It+s[W]]):(Rt=96,Zt=0),ut=1<<w-Ve,ot=1<<Oe,ve=ot;do{ot-=ut,r[Et+(je>>Ve)+ot]=Ri<<24|Rt<<16|Zt|0}while(0!==ot);for(ut=1<<w-1;je&ut;)ut>>=1;if(0!==ut?(je&=ut-1,je+=ut):je=0,W++,0==--Wt[w]){if(w===me)break;w=t[e+s[W]]}if(w>Se&&(je&Ot)!==ft){for(0===Ve&&(Ve=Se),Et+=ve,Oe=w-Ve,We=1<<Oe;Oe+Ve<me&&(We-=Wt[Oe+Ve],!(We<=0));)Oe++,We<<=1;if(Ze+=1<<Oe,1===n&&Ze>852||2===n&&Ze>592)return 1;ft=je&Ot,r[ft]=Se<<24|Oe<<16|Et-o|0}}return 0!==je&&(r[Et+je]=w-Ve<<24|64<<16|0),a.bits=Se,0};const{Z_FINISH:SM,Z_BLOCK:GH,Z_TREES:Zv,Z_OK:Af,Z_STREAM_END:qH,Z_NEED_DICT:WH,Z_STREAM_ERROR:za,Z_DATA_ERROR:DM,Z_MEM_ERROR:IM,Z_BUF_ERROR:ZH,Z_DEFLATED:kM}=Sf,eA=n=>(n>>>24&255)+(n>>>8&65280)+((65280&n)<<8)+((255&n)<<24);function JH(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const tA=n=>{if(!n||!n.state)return za;const t=n.state;return n.total_in=n.total_out=t.total=0,n.msg="",t.wrap&&(n.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,Af},nA=n=>{if(!n||!n.state)return za;const t=n.state;return t.wsize=0,t.whave=0,t.wnext=0,tA(n)},iA=(n,t)=>{let e;if(!n||!n.state)return za;const i=n.state;return t<0?(e=0,t=-t):(e=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?za:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=e,i.wbits=t,nA(n))},rA=(n,t)=>{if(!n)return za;const e=new JH;n.state=e,e.window=null;const i=iA(n,t);return i!==Af&&(n.state=null),i};let lw,cw,oA=!0;const tV=n=>{if(oA){lw=new Int32Array(512),cw=new Int32Array(32);let t=0;for(;t<144;)n.lens[t++]=8;for(;t<256;)n.lens[t++]=9;for(;t<280;)n.lens[t++]=7;for(;t<288;)n.lens[t++]=8;for(Om(1,n.lens,0,288,lw,0,n.work,{bits:9}),t=0;t<32;)n.lens[t++]=5;Om(2,n.lens,0,32,cw,0,n.work,{bits:5}),oA=!1}n.lencode=lw,n.lenbits=9,n.distcode=cw,n.distbits=5},sA=(n,t,e,i)=>{let r;const o=n.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),i>=o.wsize?(o.window.set(t.subarray(e-o.wsize,e),0),o.wnext=0,o.whave=o.wsize):(r=o.wsize-o.wnext,r>i&&(r=i),o.window.set(t.subarray(e-i,e-i+r),o.wnext),(i-=r)?(o.window.set(t.subarray(e-i,e),0),o.wnext=i,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0};var Wc_inflateReset=nA,Wc_inflateInit2=rA,Wc_inflate=(n,t)=>{let e,i,r,o,s,a,g,w,W,ve,me,Se,Oe,Ve,Ze,je,ut,ot,ft,Ot,Et,Ut,We=0;const It=new Uint8Array(4);let Pt,Wt;const ci=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!n||!n.state||!n.output||!n.input&&0!==n.avail_in)return za;e=n.state,12===e.mode&&(e.mode=13),s=n.next_out,r=n.output,g=n.avail_out,o=n.next_in,i=n.input,a=n.avail_in,w=e.hold,W=e.bits,ve=a,me=g,Ut=Af;e:for(;;)switch(e.mode){case 1:if(0===e.wrap){e.mode=13;break}for(;W<16;){if(0===a)break e;a--,w+=i[o++]<<W,W+=8}if(2&e.wrap&&35615===w){e.check=0,It[0]=255&w,It[1]=w>>>8&255,e.check=ho(e.check,It,2,0),w=0,W=0,e.mode=2;break}if(e.flags=0,e.head&&(e.head.done=!1),!(1&e.wrap)||(((255&w)<<8)+(w>>8))%31){n.msg="incorrect header check",e.mode=30;break}if((15&w)!==kM){n.msg="unknown compression method",e.mode=30;break}if(w>>>=4,W-=4,Et=8+(15&w),0===e.wbits)e.wbits=Et;else if(Et>e.wbits){n.msg="invalid window size",e.mode=30;break}e.dmax=1<<e.wbits,n.adler=e.check=1,e.mode=512&w?10:12,w=0,W=0;break;case 2:for(;W<16;){if(0===a)break e;a--,w+=i[o++]<<W,W+=8}if(e.flags=w,(255&e.flags)!==kM){n.msg="unknown compression method",e.mode=30;break}if(57344&e.flags){n.msg="unknown header flags set",e.mode=30;break}e.head&&(e.head.text=w>>8&1),512&e.flags&&(It[0]=255&w,It[1]=w>>>8&255,e.check=ho(e.check,It,2,0)),w=0,W=0,e.mode=3;case 3:for(;W<32;){if(0===a)break e;a--,w+=i[o++]<<W,W+=8}e.head&&(e.head.time=w),512&e.flags&&(It[0]=255&w,It[1]=w>>>8&255,It[2]=w>>>16&255,It[3]=w>>>24&255,e.check=ho(e.check,It,4,0)),w=0,W=0,e.mode=4;case 4:for(;W<16;){if(0===a)break e;a--,w+=i[o++]<<W,W+=8}e.head&&(e.head.xflags=255&w,e.head.os=w>>8),512&e.flags&&(It[0]=255&w,It[1]=w>>>8&255,e.check=ho(e.check,It,2,0)),w=0,W=0,e.mode=5;case 5:if(1024&e.flags){for(;W<16;){if(0===a)break e;a--,w+=i[o++]<<W,W+=8}e.length=w,e.head&&(e.head.extra_len=w),512&e.flags&&(It[0]=255&w,It[1]=w>>>8&255,e.check=ho(e.check,It,2,0)),w=0,W=0}else e.head&&(e.head.extra=null);e.mode=6;case 6:if(1024&e.flags&&(Se=e.length,Se>a&&(Se=a),Se&&(e.head&&(Et=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(i.subarray(o,o+Se),Et)),512&e.flags&&(e.check=ho(e.check,i,Se,o)),a-=Se,o+=Se,e.length-=Se),e.length))break e;e.length=0,e.mode=7;case 7:if(2048&e.flags){if(0===a)break e;Se=0;do{Et=i[o+Se++],e.head&&Et&&e.length<65536&&(e.head.name+=String.fromCharCode(Et))}while(Et&&Se<a);if(512&e.flags&&(e.check=ho(e.check,i,Se,o)),a-=Se,o+=Se,Et)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=8;case 8:if(4096&e.flags){if(0===a)break e;Se=0;do{Et=i[o+Se++],e.head&&Et&&e.length<65536&&(e.head.comment+=String.fromCharCode(Et))}while(Et&&Se<a);if(512&e.flags&&(e.check=ho(e.check,i,Se,o)),a-=Se,o+=Se,Et)break e}else e.head&&(e.head.comment=null);e.mode=9;case 9:if(512&e.flags){for(;W<16;){if(0===a)break e;a--,w+=i[o++]<<W,W+=8}if(w!==(65535&e.check)){n.msg="header crc mismatch",e.mode=30;break}w=0,W=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),n.adler=e.check=0,e.mode=12;break;case 10:for(;W<32;){if(0===a)break e;a--,w+=i[o++]<<W,W+=8}n.adler=e.check=eA(w),w=0,W=0,e.mode=11;case 11:if(0===e.havedict)return n.next_out=s,n.avail_out=g,n.next_in=o,n.avail_in=a,e.hold=w,e.bits=W,WH;n.adler=e.check=1,e.mode=12;case 12:if(t===GH||t===Zv)break e;case 13:if(e.last){w>>>=7&W,W-=7&W,e.mode=27;break}for(;W<3;){if(0===a)break e;a--,w+=i[o++]<<W,W+=8}switch(e.last=1&w,w>>>=1,W-=1,3&w){case 0:e.mode=14;break;case 1:if(tV(e),e.mode=20,t===Zv){w>>>=2,W-=2;break e}break;case 2:e.mode=17;break;case 3:n.msg="invalid block type",e.mode=30}w>>>=2,W-=2;break;case 14:for(w>>>=7&W,W-=7&W;W<32;){if(0===a)break e;a--,w+=i[o++]<<W,W+=8}if((65535&w)!=(w>>>16^65535)){n.msg="invalid stored block lengths",e.mode=30;break}if(e.length=65535&w,w=0,W=0,e.mode=15,t===Zv)break e;case 15:e.mode=16;case 16:if(Se=e.length,Se){if(Se>a&&(Se=a),Se>g&&(Se=g),0===Se)break e;r.set(i.subarray(o,o+Se),s),a-=Se,o+=Se,g-=Se,s+=Se,e.length-=Se;break}e.mode=12;break;case 17:for(;W<14;){if(0===a)break e;a--,w+=i[o++]<<W,W+=8}if(e.nlen=257+(31&w),w>>>=5,W-=5,e.ndist=1+(31&w),w>>>=5,W-=5,e.ncode=4+(15&w),w>>>=4,W-=4,e.nlen>286||e.ndist>30){n.msg="too many length or distance symbols",e.mode=30;break}e.have=0,e.mode=18;case 18:for(;e.have<e.ncode;){for(;W<3;){if(0===a)break e;a--,w+=i[o++]<<W,W+=8}e.lens[ci[e.have++]]=7&w,w>>>=3,W-=3}for(;e.have<19;)e.lens[ci[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,Pt={bits:e.lenbits},Ut=Om(0,e.lens,0,19,e.lencode,0,e.work,Pt),e.lenbits=Pt.bits,Ut){n.msg="invalid code lengths set",e.mode=30;break}e.have=0,e.mode=19;case 19:for(;e.have<e.nlen+e.ndist;){for(;We=e.lencode[w&(1<<e.lenbits)-1],Ze=We>>>24,je=We>>>16&255,ut=65535&We,!(Ze<=W);){if(0===a)break e;a--,w+=i[o++]<<W,W+=8}if(ut<16)w>>>=Ze,W-=Ze,e.lens[e.have++]=ut;else{if(16===ut){for(Wt=Ze+2;W<Wt;){if(0===a)break e;a--,w+=i[o++]<<W,W+=8}if(w>>>=Ze,W-=Ze,0===e.have){n.msg="invalid bit length repeat",e.mode=30;break}Et=e.lens[e.have-1],Se=3+(3&w),w>>>=2,W-=2}else if(17===ut){for(Wt=Ze+3;W<Wt;){if(0===a)break e;a--,w+=i[o++]<<W,W+=8}w>>>=Ze,W-=Ze,Et=0,Se=3+(7&w),w>>>=3,W-=3}else{for(Wt=Ze+7;W<Wt;){if(0===a)break e;a--,w+=i[o++]<<W,W+=8}w>>>=Ze,W-=Ze,Et=0,Se=11+(127&w),w>>>=7,W-=7}if(e.have+Se>e.nlen+e.ndist){n.msg="invalid bit length repeat",e.mode=30;break}for(;Se--;)e.lens[e.have++]=Et}}if(30===e.mode)break;if(0===e.lens[256]){n.msg="invalid code -- missing end-of-block",e.mode=30;break}if(e.lenbits=9,Pt={bits:e.lenbits},Ut=Om(1,e.lens,0,e.nlen,e.lencode,0,e.work,Pt),e.lenbits=Pt.bits,Ut){n.msg="invalid literal/lengths set",e.mode=30;break}if(e.distbits=6,e.distcode=e.distdyn,Pt={bits:e.distbits},Ut=Om(2,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,Pt),e.distbits=Pt.bits,Ut){n.msg="invalid distances set",e.mode=30;break}if(e.mode=20,t===Zv)break e;case 20:e.mode=21;case 21:if(a>=6&&g>=258){n.next_out=s,n.avail_out=g,n.next_in=o,n.avail_in=a,e.hold=w,e.bits=W,LH(n,me),s=n.next_out,r=n.output,g=n.avail_out,o=n.next_in,i=n.input,a=n.avail_in,w=e.hold,W=e.bits,12===e.mode&&(e.back=-1);break}for(e.back=0;We=e.lencode[w&(1<<e.lenbits)-1],Ze=We>>>24,je=We>>>16&255,ut=65535&We,!(Ze<=W);){if(0===a)break e;a--,w+=i[o++]<<W,W+=8}if(je&&0==(240&je)){for(ot=Ze,ft=je,Ot=ut;We=e.lencode[Ot+((w&(1<<ot+ft)-1)>>ot)],Ze=We>>>24,je=We>>>16&255,ut=65535&We,!(ot+Ze<=W);){if(0===a)break e;a--,w+=i[o++]<<W,W+=8}w>>>=ot,W-=ot,e.back+=ot}if(w>>>=Ze,W-=Ze,e.back+=Ze,e.length=ut,0===je){e.mode=26;break}if(32&je){e.back=-1,e.mode=12;break}if(64&je){n.msg="invalid literal/length code",e.mode=30;break}e.extra=15&je,e.mode=22;case 22:if(e.extra){for(Wt=e.extra;W<Wt;){if(0===a)break e;a--,w+=i[o++]<<W,W+=8}e.length+=w&(1<<e.extra)-1,w>>>=e.extra,W-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=23;case 23:for(;We=e.distcode[w&(1<<e.distbits)-1],Ze=We>>>24,je=We>>>16&255,ut=65535&We,!(Ze<=W);){if(0===a)break e;a--,w+=i[o++]<<W,W+=8}if(0==(240&je)){for(ot=Ze,ft=je,Ot=ut;We=e.distcode[Ot+((w&(1<<ot+ft)-1)>>ot)],Ze=We>>>24,je=We>>>16&255,ut=65535&We,!(ot+Ze<=W);){if(0===a)break e;a--,w+=i[o++]<<W,W+=8}w>>>=ot,W-=ot,e.back+=ot}if(w>>>=Ze,W-=Ze,e.back+=Ze,64&je){n.msg="invalid distance code",e.mode=30;break}e.offset=ut,e.extra=15&je,e.mode=24;case 24:if(e.extra){for(Wt=e.extra;W<Wt;){if(0===a)break e;a--,w+=i[o++]<<W,W+=8}e.offset+=w&(1<<e.extra)-1,w>>>=e.extra,W-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){n.msg="invalid distance too far back",e.mode=30;break}e.mode=25;case 25:if(0===g)break e;if(Se=me-g,e.offset>Se){if(Se=e.offset-Se,Se>e.whave&&e.sane){n.msg="invalid distance too far back",e.mode=30;break}Se>e.wnext?(Se-=e.wnext,Oe=e.wsize-Se):Oe=e.wnext-Se,Se>e.length&&(Se=e.length),Ve=e.window}else Ve=r,Oe=s-e.offset,Se=e.length;Se>g&&(Se=g),g-=Se,e.length-=Se;do{r[s++]=Ve[Oe++]}while(--Se);0===e.length&&(e.mode=21);break;case 26:if(0===g)break e;r[s++]=e.length,g--,e.mode=21;break;case 27:if(e.wrap){for(;W<32;){if(0===a)break e;a--,w|=i[o++]<<W,W+=8}if(me-=g,n.total_out+=me,e.total+=me,me&&(n.adler=e.check=e.flags?ho(e.check,r,me,s-me):Dm(e.check,r,me,s-me)),me=g,(e.flags?w:eA(w))!==e.check){n.msg="incorrect data check",e.mode=30;break}w=0,W=0}e.mode=28;case 28:if(e.wrap&&e.flags){for(;W<32;){if(0===a)break e;a--,w+=i[o++]<<W,W+=8}if(w!==(4294967295&e.total)){n.msg="incorrect length check",e.mode=30;break}w=0,W=0}e.mode=29;case 29:Ut=qH;break e;case 30:Ut=DM;break e;case 31:return IM;default:return za}return n.next_out=s,n.avail_out=g,n.next_in=o,n.avail_in=a,e.hold=w,e.bits=W,(e.wsize||me!==n.avail_out&&e.mode<30&&(e.mode<27||t!==SM))&&sA(n,n.output,n.next_out,me-n.avail_out),ve-=n.avail_in,me-=n.avail_out,n.total_in+=ve,n.total_out+=me,e.total+=me,e.wrap&&me&&(n.adler=e.check=e.flags?ho(e.check,r,me,n.next_out-me):Dm(e.check,r,me,n.next_out-me)),n.data_type=e.bits+(e.last?64:0)+(12===e.mode?128:0)+(20===e.mode||15===e.mode?256:0),(0===ve&&0===me||t===SM)&&Ut===Af&&(Ut=ZH),Ut},Wc_inflateEnd=n=>{if(!n||!n.state)return za;let t=n.state;return t.window&&(t.window=null),n.state=null,Af},Wc_inflateGetHeader=(n,t)=>{if(!n||!n.state)return za;const e=n.state;return 0==(2&e.wrap)?za:(e.head=t,t.done=!1,Af)},Wc_inflateSetDictionary=(n,t)=>{const e=t.length;let i,r,o;return n&&n.state&&(i=n.state,0===i.wrap||11===i.mode)?11===i.mode&&(r=1,r=Dm(r,t,e,0),r!==i.check)?DM:(o=sA(n,t,e,e),o?(i.mode=31,IM):(i.havedict=1,Af)):za},mV=function _V(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const aA=Object.prototype.toString,{Z_NO_FLUSH:$V,Z_FINISH:vV,Z_OK:Bm,Z_STREAM_END:uw,Z_NEED_DICT:dw,Z_STREAM_ERROR:bV,Z_DATA_ERROR:lA,Z_MEM_ERROR:yV}=Sf;function Lm(n){this.options=Gv_assign({chunkSize:65536,windowBits:15,to:""},n||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(n&&n.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new vM,this.strm.avail_out=0;let e=Wc_inflateInit2(this.strm,t.windowBits);if(e!==Bm)throw new Error(Tf[e]);if(this.header=new mV,Wc_inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=Rm_string2buf(t.dictionary):"[object ArrayBuffer]"===aA.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(e=Wc_inflateSetDictionary(this.strm,t.dictionary),e!==Bm)))throw new Error(Tf[e])}function fw(n,t){const e=new Lm(t);if(e.push(n),e.err)throw e.msg||Tf[e.err];return e.result}Lm.prototype.push=function(n,t){const e=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let o,s,a;if(this.ended)return!1;for(s=t===~~t?t:!0===t?vV:$V,e.input="[object ArrayBuffer]"===aA.call(n)?new Uint8Array(n):n,e.next_in=0,e.avail_in=e.input.length;;){for(0===e.avail_out&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),o=Wc_inflate(e,s),o===dw&&r&&(o=Wc_inflateSetDictionary(e,r),o===Bm?o=Wc_inflate(e,s):o===lA&&(o=dw));e.avail_in>0&&o===uw&&e.state.wrap>0&&0!==n[e.next_in];)Wc_inflateReset(e),o=Wc_inflate(e,s);switch(o){case bV:case lA:case dw:case yV:return this.onEnd(o),this.ended=!0,!1}if(a=e.avail_out,e.next_out&&(0===e.avail_out||o===uw))if("string"===this.options.to){let g=Rm_utf8border(e.output,e.next_out),w=e.next_out-g,W=Rm_buf2string(e.output,g);e.next_out=w,e.avail_out=i-w,w&&e.output.set(e.output.subarray(g,g+w),0),this.onData(W)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(o!==Bm||0!==a){if(o===uw)return o=Wc_inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===e.avail_in)break}}return!0},Lm.prototype.onData=function(n){this.chunks.push(n)},Lm.prototype.onEnd=function(n){n===Bm&&(this.result="string"===this.options.to?this.chunks.join(""):Gv_flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};var DV={Inflate:Lm,inflate:fw,inflateRaw:function CV(n,t){return(t=t||{}).raw=!0,fw(n,t)},ungzip:fw,constants:Sf};const{Deflate:IV}=OH,{Inflate:PV}=DV;var cA=IV,uA=PV;function hw(){return hw=(0,xn.Z)(function*(n,t){const e=new cA({level:2,gzip:!0});try{return yield dA(e,n,t),e.result}catch(i){console.error(i)}return null}),hw.apply(this,arguments)}function pw(){return pw=(0,xn.Z)(function*(n,t){const e=new uA;try{return yield dA(e,n,t),e.result}catch(i){console.error(i)}return null}),pw.apply(this,arguments)}function dA(n,t){return gw.apply(this,arguments)}function gw(){return gw=(0,xn.Z)(function*(n,t,e=16384){let i=Math.ceil(t.byteLength/e),r=null;for(let o=0;o<i;o++)yield qV(),r=t.slice(o*e,(o+1)*e),n.push(r,i<=o+1);if(n.err)throw new Error(`error: ${n.err}`);return n}),gw.apply(this,arguments)}function qV(){return new Promise(n=>Yo(n))}var la,n,fA=Ce(2391);(n=la||(la={})).encode=function t(i){try{return fA.encode(i)}catch(r){console.error(r,i)}return null},n.decode=function e(i){try{return fA.decode(i)}catch(r){console.error(r,i)}return null};var fd,WV=Ce(9069);!function(n){let t=[];for(let i=0;i<256;i++)t[i]=(i<16?"0":"")+i.toString(16);n.generateUuid=function e(){const i=new Uint32Array(4);window.crypto.getRandomValues(i);const r=i[0],o=i[1],s=i[2],a=i[3];return t[255&r]+t[r>>8&255]+t[r>>16&255]+t[r>>24&255]+"-"+t[255&o]+t[o>>8&255]+"-"+t[o>>16&15|64]+t[o>>24&255]+"-"+t[63&s|128]+t[s>>8&255]+"-"+t[s>>16&255]+t[s>>24&255]+t[255&a]+t[a>>8&255]+t[a>>16&255]+t[a>>24&255]}}(fd||(fd={}));class uc{constructor(t,e){this.timerMilliSecond=0,this.timeoutDate=0,this.isStopped=!1,this.callback=t,this.timerMilliSecond=e,this.reset()}get isActive(){return null!=this.timeoutTimer}stop(){this.isStopped=!0}clear(){this.callback=null,this.timerMilliSecond=0,this.timeoutDate=0,this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.isStopped=!1}reset(...t){1===t.length?this.timerMilliSecond=t[0]:1<t.length&&(this.callback=t[0],this.timerMilliSecond=t[1]),this.isStopped=!1;let e=this.timeoutDate;this.timeoutDate=performance.now()+this.timerMilliSecond,!(this.timeoutTimer&&e<=this.timeoutDate)&&this.setTimeout()}setTimeout(){this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.callback&&(this.timeoutTimer=setTimeout(()=>{this.timeoutTimer=null,!this.isStopped&&(performance.now()<this.timeoutDate?this.setTimeout():this.callback&&this.callback())},this.timeoutDate-performance.now()))}}class Qv{constructor(){}static add(t){this.monitoringConnections.add(t),t.updateStatsAsync(),this.restart()}static remove(t){this.monitoringConnections.delete(t)}static restart(){null==this.updateWebRTCStatsTimer?this.updateWebRTCStatsTimer=new uc(()=>this.doMonitoringAsync(),this.calcIntervalTime()):this.updateWebRTCStatsTimer.isActive||this.updateWebRTCStatsTimer.reset(this.calcIntervalTime())}static calcIntervalTime(){return Math.min(2e3+1e3*this.monitoringConnections.size,1e4)}static doMonitoringAsync(){var t=this;return(0,xn.Z)(function*(){for(let e of t.monitoringConnections)e.open?yield e.updateStatsAsync():t.remove(e);t.monitoringConnections.size<1?t.updateWebRTCStatsTimer=null:t.restart()})()}}Qv.updateWebRTCStatsTimer=null,Qv.monitoringConnections=new Set;var Ha=(()=>(function(n){n.UNKNOWN="unknown",n.RELAY="relay",n.PRFLX="prflx",n.SRFLX="srflx",n.HOST="host"}(Ha||(Ha={})),Ha))();class ZV{constructor(t){this.peerConnection=t,this.candidateType=Ha.UNKNOWN}updateAsync(){var t=this;return(0,xn.Z)(function*(){let e=null;try{e=yield t.peerConnection.getStats()}catch(me){console.warn(me)}if(null==e)return void(t.candidateType=Ha.UNKNOWN);let i=[],r=[],o=[],s=[],a=[],g=[],w=[];e.forEach(me=>{0<=me.type.indexOf("candidate-pair")&&i.push(me),0<=me.type.indexOf("local-candidate")&&r.push(me),0<=me.type.indexOf("remote-candidate")&&o.push(me)}),i.forEach(me=>{"succeeded"===me.state&&(s.push(me.localCandidateId),a.push(me.remoteCandidateId))}),r.forEach(me=>{s.includes(me.id)&&g.push(me)}),o.forEach(me=>{a.includes(me.id)&&w.push(me)});let W=Ha.UNKNOWN,ve=Object.values(Ha);g.concat(w).forEach(me=>{let Se=ve.indexOf(me.candidateType);ve.indexOf(W)<Se&&(W=ve[Se])}),t.candidateType=W})()}}class hA extends WV.EventEmitter{constructor(t){super(),this.conn=t,this.chunkSize=15872,this.receivedMap=new Map,this.timeoutTimer=null,this._timestamp=performance.now(),this._ping=0,this._candidateType=Ha.UNKNOWN,t.on("data",e=>this.onData(e)),t.on("open",()=>{this.stats=new ZV(this.getPeerConnection()),this.clearTimeoutTimer(),function YV(n){n._dc&&n._sendBuffer&&(n._startSendLoop=KV)}(t),this.emit("open"),this.startMonitoring()}),t.on("close",()=>{this.clearTimeoutTimer(),this.emit("close")}),t.on("error",e=>{this.clearTimeoutTimer(),this.emit("error",e)}),this.setTimeoutTimer()}get open(){return this.conn.open}get remoteId(){return this.conn.remoteId}get metadata(){return this.conn.metadata}get bufferedAmount(){var t,e;return null!==(e=null===(t=this.conn._dc)||void 0===t?void 0:t.bufferedAmount)&&void 0!==e?e:0}get timestamp(){return this._timestamp}set timestamp(t){this._timestamp=t}get ping(){return this._ping}set ping(t){this._ping=t}get candidateType(){return this._candidateType}set candidateType(t){this._candidateType=t}close(){this.clearTimeoutTimer(),this.stopMonitoring(),this.conn.close()}send(t){let e=la.encode(t),i=Math.ceil(e.byteLength/this.chunkSize);if(i<=1)return void this.conn.send(e);let r=fd.generateUuid(),o=null,s=null;for(let a=0;a<i;a++)o=e.slice(a*this.chunkSize,(a+1)*this.chunkSize),s={id:r,data:o,index:a,total:i},this.conn.send(la.encode(s))}getPeerConnection(){return this.conn.getPeerConnection()}startMonitoring(){Qv.add(this)}stopMonitoring(){Qv.remove(this)}updateStatsAsync(){var t=this;return(0,xn.Z)(function*(){null!=t.stats&&(t.sendPing(),yield t.stats.updateAsync(),t.candidateType=t.stats.candidateType,t.emit("stats",t.stats))})()}sendPing(){let t=la.encode({from:this.remoteId,ping:performance.now()});this.conn.send(t)}receivePing(t){if(t.from===this.remoteId){let i=performance.now()-t.ping;this.ping=i<=this.ping?.5*this.ping+.5*i:i}else{let e=la.encode(t);this.conn.send(e)}}onData(t){this.timestamp=performance.now();let e=la.decode(new Uint8Array(t));if(null!=e.ping)return void this.receivePing(e);let r=e;if(null==r.id)return void this.emit("data",e);let o=this.receivedMap.get(r.id);if(null==o&&(o={id:r.id,chanks:new Array(r.total),length:0,byteLength:0},this.receivedMap.set(r.id,o)),null!=o.chanks[r.index]||(o.length++,o.byteLength+=r.data.byteLength,o.chanks[r.index]=r.data,o.length<r.total))return;this.receivedMap.delete(r.id);let s=new Uint8Array(o.byteLength),a=0;for(let w of o.chanks)s.set(w,a),a+=w.byteLength;let g=la.decode(s);this.emit("data",g)}setTimeoutTimer(){this.clearTimeoutTimer(),this.timeoutTimer=setTimeout(()=>{console.warn(`timeout ${this.conn.remoteId}`),this.timeoutTimer=null,this.emit("close")},15e3)}clearTimeoutTimer(){null!=this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null)}}function KV(){this.sendInterval||(this.sendInterval=Yo(pA.bind(this)))}function pA(){const n=this._sendBuffer.shift();try{this._dc.send(n)}catch(t){this._sendBuffer.push(n)}this.sendInterval=0===this._sendBuffer.length?void 0:Yo(pA.bind(this))}class XV{constructor(){this._peerIds=[],this.peerContext=zi.parse("???"),this.peerContexts=[],this.callback=new Bk,this.bandwidthUsage=0,this.key="",this.connections=[],this.listAllPeersCache=[],this.httpRequestInterval=performance.now()+500,this.outboundQueue=Promise.resolve(),this.inboundQueue=Promise.resolve(),this.relayingPeerIds=new Map,this.maybeUnavailablePeerIds=new Set}get peerId(){return this.peerContext?this.peerContext.peerId:"???"}get peerIds(){return this._peerIds}open(...t){console.log("open",t),this.peerContext=0===t.length?zi.create(zi.generateId()):1===t.length?zi.create(t[0]):zi.create(t[0],t[1],t[2],t[3]),this.openPeer()}close(){this.peer&&this.peer.destroy(),this.disconnectAll(),this.peer=null,this.peerContext=zi.parse("???")}connect(t){if(!this.shouldConnect(t))return!1;let e=new hA(this.peer.connect(t,{serialization:"none",metadata:{sendFrom:this.peerId}}));return this.openDataConnection(e),!0}shouldConnect(t){return this.peerContext&&this.peer&&this.peerId?this.peerId===t?(console.log("connect() is Fail. "+t+" is me."),!1):this.findDataConnection(t)?(console.log("connect() is Fail. <"+t+"> is already connecting."),!1):!(!t||!t.length||t===this.peerId):(console.log("connect() is Fail. ID\u304c\u5272\u308a\u632f\u3089\u308c\u308b\u307e\u3067\u5f85\u3066\u3084"),!1)}disconnect(t){let e=this.findDataConnection(t);return!!e&&(this.closeDataConnection(e),!0)}disconnectAll(){console.log("<closeAllDataConnection()>");for(let t of this.connections.concat())this.closeDataConnection(t)}send(t,e){var i=this;if(this.connections.length<1)return;let r={data:la.encode(t),ttl:1},o=r.data.byteLength;this.bandwidthUsage+=o,this.outboundQueue=this.outboundQueue.then(()=>new Promise((s,a)=>{Yo((0,xn.Z)(function*(){if(1024<r.data.byteLength&&Array.isArray(t)&&1<t.length){let g=yield function jV(n,t){return hw.apply(this,arguments)}(r.data);g.byteLength<r.data.byteLength&&(r.data=g,r.isCompressed=!0)}return e?i.sendUnicast(r,e):i.sendBroadcast(r),i.bandwidthUsage-=o,s()}))}))}sendUnicast(t,e){t.ttl=0;let i=this.findDataConnection(e);i&&i.open&&i.send(t)}sendBroadcast(t){for(let e of this.connections)e.open&&e.send(t)}setApiKey(t){this.key!==t&&console.log("Key Change"),this.key=t}listAllPeers(){return new Promise((t,e)=>{if(!this.peer)return t([]);let i=performance.now();if(i<this.httpRequestInterval)return console.warn("httpRequestInterval... "+(this.httpRequestInterval-i)),void t(this.listAllPeersCache.concat());this.httpRequestInterval=i+6e3,this.peer.listAllPeers(r=>{this.listAllPeersCache=r.concat(),t(r)})})}openPeer(){this.peer&&(console.warn("It is already opened."),this.close());let t=new Peer(this.peerContext.peerId,{key:this.key});t.on("open",e=>{console.log("My peer ID is: "+e),(!this.peerContext||this.peerContext.peerId!==e)&&(this.peerContext=zi.parse(e)),this.peerContext.isOpen=!0,console.log("My peer Context",this.peerContext),this.callback.onOpen&&this.callback.onOpen(this.peerId)}),t.on("close",()=>{console.log("Peer close"),this.peerContext&&this.peerContext.isOpen&&(this.peerContext.isOpen=!1,this.callback.onClose&&this.callback.onClose(this.peerId))}),t.on("connection",e=>{this.openDataConnection(new hA(e))}),t.on("error",e=>{console.error("<"+this.peerId+"> "+e.type+" => "+e.message);let i=`${this.getSkyWayErrorMessage(e.type)}\n\n${e.type}: ${e.message}`;switch(e.type){case"peer-unavailable":let r=/"(.+)"/.exec(e.message)[1];this.disconnect(r);break;case"disconnected":case"socket-error":case"unavailable-id":case"authentication":case"server-error":this.peerContext&&this.peerContext.isOpen&&(this.close(),this.callback.onClose&&this.callback.onClose(this.peerId))}this.callback.onError&&this.callback.onError(this.peerId,e.type,i,e)}),this.peer=t}openDataConnection(t){if(!1===this.addDataConnection(t))return;let e=this.connections.indexOf(t),i=null;0<=e&&(i=this.peerContexts[e]),this.maybeUnavailablePeerIds.add(t.remoteId),t.on("data",r=>{this.onData(t,r)}),t.on("open",()=>{this.maybeUnavailablePeerIds.delete(t.remoteId),i&&(i.isOpen=!0),this.updatePeerList(),this.callback.onConnect&&this.callback.onConnect(t.remoteId)}),t.on("close",()=>{this.closeDataConnection(t)}),t.on("error",()=>{this.closeDataConnection(t)}),t.on("stats",()=>{let r=performance.now()-t.timestamp,o=r<=1e4?1:5e3/(r-1e4+5e3),s=o<1?r:t.ping,a=500/(s+500);switch(i.session.health=o,i.session.ping=s,i.session.speed=a*o,t.candidateType){case Ha.HOST:i.session.grade=rd.HIGH;break;case Ha.SRFLX:case Ha.PRFLX:i.session.grade=rd.MIDDLE;break;case Ha.RELAY:i.session.grade=rd.LOW;break;default:i.session.grade=rd.UNSPECIFIED}i.session.description=t.candidateType,i.session.health<.2&&this.closeDataConnection(t)})}closeDataConnection(t){t.close();let e=this.connections.indexOf(t);0<=e&&(console.log(t.remoteId+" is \u3048\u3093\u3044\u30fcindex:"+e+" length:"+this.connections.length),this.connections.splice(e,1),this.peerContexts.splice(e,1)),this.relayingPeerIds.delete(t.remoteId),this.relayingPeerIds.forEach(i=>{let r=i.indexOf(t.remoteId);0<=r&&i.splice(r,1)}),console.log("<close()> Peer:"+t.remoteId+" length:"+this.connections.length+":"+this.peerContexts.length),this.updatePeerList(),0<=e&&this.callback.onDisconnect&&this.callback.onDisconnect(t.remoteId)}addDataConnection(t){let e=this.findDataConnection(t.remoteId);if(null!==e){if(console.log("add() is Fail. "+t.remoteId+" is already connecting."),e!==t){if(!(e.metadata.sendFrom<t.metadata.sendFrom))return this.closeDataConnection(e),this.addDataConnection(t),!0;this.closeDataConnection(t)}return!1}return this.connections.push(t),this.peerContexts.push(zi.parse(t.remoteId)),console.log("<add()> Peer:"+t.remoteId+" length:"+this.connections.length),!0}findDataConnection(t){for(let e of this.connections)if(e.remoteId===t)return e;return null}onData(t,e){var i=this;if(e.peers&&0<e.peers.length&&this.onUpdatePeerList(t,e),0<e.ttl&&this.onRelay(t,e),this.callback.onData){let r=e.data.byteLength;this.bandwidthUsage+=r,this.inboundQueue=this.inboundQueue.then(()=>new Promise((o,s)=>{Yo((0,xn.Z)(function*(){let a=e.isCompressed?yield function GV(n,t){return pw.apply(this,arguments)}(e.data):e.data;return i.callback.onData(t.remoteId,la.decode(a)),i.bandwidthUsage-=r,o()}))}))}}onRelay(t,e){e.ttl--;let i=this.relayingPeerIds.get(t.remoteId);if(null!=i)for(let r of i){let o=this.findDataConnection(r);o&&o.open&&(console.log("<"+r+"> \u8ee2\u9001\u3057\u306a\u304d\u3083\u30fb\u30fb\u30fb"),o.send(e))}}onUpdatePeerList(t,e){let i=[],r=[],o=function QV(n,t){let e=[],i=[],r=!1,o=!1;for(let s of n.concat(t))r=n.includes(s),o=t.includes(s),r&&!o?e.push(s):!r&&o&&i.push(s);return{diff1:e,diff2:i}}(this._peerIds,e.peers);if(i=o.diff1,r=o.diff2,this.relayingPeerIds.set(t.remoteId,i),e.peers=e.peers.concat(i),r.length)for(let s of r)!this.maybeUnavailablePeerIds.has(s)&&this.connect(s)&&console.log("auto connect to unknown Peer <"+s+">")}updatePeerList(){let t=[];for(let e of this.connections)e.open&&t.push(e.remoteId);return t.push(this.peerId),t.sort(function(e,i){return e>i?1:e<i?-1:0}),this._peerIds=t,console.log("<update()>",t),this.notifyPeerList(),t}notifyPeerList(){if(this.connections.length<1)return;let t={data:la.encode([]),peers:this._peerIds,ttl:1};this.sendBroadcast(t)}getSkyWayErrorMessage(t){switch(t){case"room-error":return"SkyWay Room API \u306b\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002";case"permission":return"\u8a72\u5f53\u306e SkyWay Room \u306e\u5229\u7528\u304c\u8a31\u53ef\u3055\u308c\u3066\u307e\u305b\u3093\u3002";case"list-error":return"SkyWay listAllPeers API \u304c Disabled \u3067\u3059\u3002";case"disconnected":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u306b\u63a5\u7d9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"socket-error":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u901a\u4fe1\u3067\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002";case"invalid-id":return"Peer ID \u304c\u4e0d\u6b63\u3067\u3059\u3002";case"unavailable-id":return"\u305d\u306e Peer ID \u3059\u3067\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u307e\u3059\u3002";case"peer-unavailable":return"\u305d\u306e Peer ID \u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002";case"invalid-key":return"SkyWay API \u30ad\u30fc\u304c\u7121\u52b9\u3067\u3059\u3002";case"invalid-domain":return"SkyWay API \u30ad\u30fc\u306b\u306f\u73fe\u5728\u306e\u30c9\u30e1\u30a4\u30f3\u306f\u767b\u9332\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"authentication":return"\u8a8d\u8a3c\u30a8\u30e9\u30fc\u3067\u3059\u3002";case"server-error":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u63a5\u7d9a\u4e2d\u306b\u554f\u984c\u304c\u3042\u308a\u307e\u3057\u305f\u3002 \u5c11\u3057\u5f85\u3063\u3066\u3001\u30ea\u30c8\u30e9\u30a4\u3057\u3066\u304f\u3060\u3055\u3044\u3002";case"sfu-client-not-supported":return"\u3053\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306f SFU \u306e\u4f7f\u7528\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u6700\u65b0\u306e Google Chrome \u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044";case"peer-unavailable":return"Peer \u3078\u30c7\u30fc\u30bf\u3092\u9001\u4fe1\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002Peer ID \u304c\u6b63\u3057\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002";case"signaling-limited":return"\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u56de\u6570\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u5168\u3066\u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09";case"sfu-limited":return"SFU \u30b5\u30fc\u30d0\u306e\u5229\u7528\u91cf\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001SFU \u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09";case"turn-limited":return"TURN \u30b5\u30fc\u30d0\u306e\u5229\u7528\u91cf\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001TURN \u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09\n\u3053\u306e\u72b6\u614b\u3067\u306f\u3001\u4e00\u90e8\u306e\u30e6\u30fc\u30b6\u306e\u63a5\u7d9a\u306b\u554f\u984c\u304c\u767a\u751f\u3059\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002";case"peer-unavailable":return"\u305d\u306ePeer ID\u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002";default:return"SkyWay\u306b\u95a2\u3059\u308b\u4e0d\u660e\u306a\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002"}}}const gA=zi.parse("???");class dc{constructor(){this.callback=new Bk,this.key="",this.queue=new Set,this.sendInterval=null,this.sendCallback=()=>{this.sendQueue()},this.callbackUnload=t=>{this.close()},console.log("Network ready...")}static get instance(){return dc._instance||(dc._instance=new dc),dc._instance}get peerId(){return this.connection?this.connection.peerId:gA.peerId}get peerIds(){return this.connection?this.connection.peerIds.concat():[]}get peerContexts(){return this.connection?this.connection.peerContexts.concat():[]}get peerContext(){return this.connection?this.connection.peerContext:gA}get isOpen(){return!(!this.connection||!this.connection.peerContext)&&this.connection.peerContext.isOpen}get bandwidthUsage(){return this.connection?this.connection.bandwidthUsage:0}open(...t){this.connection&&this.connection.peerContext&&(console.warn("It is already opened."),this.close()),console.log("Network open...",t),this.connection=this.initializeConnection(),this.connection.open.apply(this.connection,t),window.addEventListener("unload",this.callbackUnload,!1)}connectionClose(){this.connection&&this.connection.close(),this.connection=null,window.removeEventListener("unload",this.callbackUnload,!1),console.log("Network close...\u5186\u67f1")}close(){this.connection&&this.connection.close(),this.connection=null,window.removeEventListener("unload",this.callbackUnload,!1),console.log("Network close...")}connect(t){return!!this.connection&&this.connection.connect(t)}disconnect(t){!this.connection||this.connection.disconnect(t)&&(console.log("<disconnectPeer()> Peer:"+t),this.disconnect(t))}send(t,e){this.queue.add({data:t,sendTo:e}),null===this.sendInterval&&(this.sendInterval=Yo(this.sendCallback))}sendQueue(){let t=[],e={},i=[],r=this.queue.size<128?this.queue.size:128;for(let o of this.queue){if(r<=0)break;r--,this.queue.delete(o),null==o.sendTo?t.push(o.data):o.sendTo===this.peerId?i.push(o.data):(o.sendTo in e||(e[o.sendTo]=[]),e[o.sendTo].push(o.data))}if(this.connection){t.length&&this.connection.send(t);for(let o in e)this.connection.send(e[o],o)}this.callback.onData&&(this.callback.onData(null,t),this.callback.onData(this.peerId,i)),this.sendInterval=0<this.queue.size?Yo(this.sendCallback):null}setApiKey(t){this.key!==t&&console.log("Key Change"),this.key=t}listAllPeers(){return this.connection?this.connection.listAllPeers():Promise.resolve([])}initializeConnection(){let t=new XV;return t.setApiKey(this.key),t.callback.onOpen=e=>{this.callback.onOpen&&this.callback.onOpen(e)},t.callback.onClose=e=>{this.callback.onClose&&this.callback.onClose(e)},t.callback.onConnect=e=>{this.callback.onConnect&&this.callback.onConnect(e)},t.callback.onDisconnect=e=>{this.callback.onDisconnect&&this.callback.onDisconnect(e)},t.callback.onData=(e,i)=>{this.callback.onData&&this.callback.onData(e,i)},t.callback.onError=(e,i,r,o)=>{this.callback.onError&&this.callback.onError(e,i,r,o)},0<this.queue.size&&null===this.sendInterval&&(this.sendInterval=Yo(this.sendCallback)),t}}class Cp{constructor(t,e,i=dc.instance.peerId){this.eventName=t,this.data=e,this.sendFrom=i,this.isSendFromSelf=!1,this.isSendFromSelf=this.sendFrom===dc.instance.peerId}toContext(){return{sendFrom:this.sendFrom,eventName:this.eventName,data:this.data}}}class _w{constructor(t,e){this._priority=0,this._isRegistered=!1,this._subject=t,this._key=e}get subject(){return this._subject}get key(){return this._key}get eventName(){return this._eventName}get priority(){return this._priority}get callback(){return this._callback}get isOnlyOnce(){return this._isOnlyOnce}get isRegistered(){return this._isRegistered}on(...t){return this._isOnlyOnce=!1,2===t.length?this.register(t[0],0,t[1]):this.register(t[0],t[1],t[2])}once(...t){let e=this.on.apply(this,t);return this._isOnlyOnce=!0,e}register(t,e,i){return this.isRegistered&&this.unregister(),this._eventName=t||"*",this._priority=e,this._callback=i,this.subject.registerListener(this),this._isRegistered=!0,new _w(this.subject,this.key)}unregister(){return this.subject.unregisterListener(this),this._callback=null,this._isRegistered=!1,this}trigger(t){this.callback&&this.isRegistered&&(this.callback.apply(this.key,[t,this]),this.isOnlyOnce&&this.unregister())}isEqual(t,e,i){return!(null!=t&&t!==this.key||null!=e&&e!==this.eventName||null!=i&&i!==this.callback)}}class Pf{constructor(){this.listenerMap=new Map,console.log("EventSystem ready...")}static get instance(){return Pf._instance||(Pf._instance=new Pf,Pf._instance.initializeNetworkEvent()),Pf._instance}register(t){return new _w(this,t)}unregister(...t){1===t.length?this._unregister(t[0],null,null):2===t.length?"string"==typeof t[1]?this._unregister(t[0],t[1],null):this._unregister(t[0],null,t[1]):this._unregister(t[0],t[1],t[2])}_unregister(t=this,e,i){let r=this.listenerMap.values();for(let o of r)for(let s of o.concat())s.isEqual(t,e,i)&&s.unregister()}registerListener(t){let e=this.getListeners(t.eventName);return e.push(t),e.sort((i,r)=>r.priority-i.priority),this.listenerMap.set(t.eventName,e),t}unregisterListener(t){let e=this.getListeners(t.eventName),i=e.indexOf(t);return i<0?null:(e.splice(i,1),t.unregister(),e.length<1&&this.listenerMap.delete(t.eventName),t)}call(...t){"string"==typeof t[0]?this._call(new Cp(t[0],t[1]),t[2]):this._call(t[0],t[1])}_call(t,e){let i=t.toContext();dc.instance.send(i,e)}trigger(...t){if(2!==t.length)return this._trigger(t[0]instanceof Cp?t[0]:new Cp(t[0].eventName,t[0].data,t[0].sendFrom));this._trigger(new Cp(t[0],t[1]))}_trigger(t){let e=this.getListeners(t.eventName).concat(this.getListeners("*"));for(let i of e)i.trigger(t);return t}getListeners(t){return this.listenerMap.has(t)?this.listenerMap.get(t):[]}initializeNetworkEvent(){let t=dc.instance.callback;t.onOpen=e=>{this.trigger("OPEN_NETWORK",{peerId:e})},t.onClose=e=>{this.trigger("CLOSE_NETWORK",{peerId:e})},t.onConnect=e=>{this.sendSystemMessage("<"+e+"> connect <DataConnection>"),this.trigger("CONNECT_PEER",{peerId:e})},t.onDisconnect=e=>{this.sendSystemMessage("<"+e+"> disconnect <DataConnection>"),this.trigger("DISCONNECT_PEER",{peerId:e})},t.onData=(e,i)=>{for(let r of i)this.trigger(r)},t.onError=(e,i,r,o)=>{this.sendSystemMessage("<"+e+"> "+r),this.trigger("NETWORK_ERROR",{peerId:e,errorType:i,errorMessage:r,errorObject:o})}}sendSystemMessage(t){console.log(t)}}const Qe=Pf.instance,bt=dc.instance;var Xr_isObject=function JV(n){return"object"==typeof n&&null!==n},Xr_repeat=function nU(n,t){var i,e="";for(i=0;i<t;i+=1)e+=n;return e},Xr_isNegativeZero=function iU(n){return 0===n&&Number.NEGATIVE_INFINITY===1/n};function mA(n,t){var e="",i=n.reason||"(unknown reason)";return n.mark?(n.mark.name&&(e+='in "'+n.mark.name+'" '),e+="("+(n.mark.line+1)+":"+(n.mark.column+1)+")",!t&&n.mark.snippet&&(e+="\n\n"+n.mark.snippet),i+" "+e):i}function zm(n,t){Error.call(this),this.name="YAMLException",this.reason=n,this.mark=t,this.message=mA(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}(zm.prototype=Object.create(Error.prototype)).constructor=zm,zm.prototype.toString=function(t){return this.name+": "+mA(this,t)};var $s=zm;function mw(n,t,e,i,r){var o="",s="",a=Math.floor(r/2)-1;return i-t>a&&(t=i-a+(o=" ... ").length),e-i>a&&(e=i+a-(s=" ...").length),{str:o+n.slice(t,e).replace(/\t/g,"\u2192")+s,pos:i-t+o.length}}function $w(n,t){return Xr_repeat(" ",t-n.length)+n}var fU=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],hU=["scalar","sequence","mapping"],Eo=function gU(n,t){if(t=t||{},Object.keys(t).forEach(function(e){if(-1===fU.indexOf(e))throw new $s('Unknown option "'+e+'" is met in definition of "'+n+'" YAML type.')}),this.options=t,this.tag=n,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=function pU(n){var t={};return null!==n&&Object.keys(n).forEach(function(e){n[e].forEach(function(i){t[String(i)]=e})}),t}(t.styleAliases||null),-1===hU.indexOf(this.kind))throw new $s('Unknown kind "'+this.kind+'" is specified for "'+n+'" YAML type.')};function $A(n,t){var e=[];return n[t].forEach(function(i){var r=e.length;e.forEach(function(o,s){o.tag===i.tag&&o.kind===i.kind&&o.multi===i.multi&&(r=s)}),e[r]=i}),e}function vw(n){return this.extend(n)}vw.prototype.extend=function(t){var e=[],i=[];if(t instanceof Eo)i.push(t);else if(Array.isArray(t))i=i.concat(t);else{if(!t||!Array.isArray(t.implicit)&&!Array.isArray(t.explicit))throw new $s("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");t.implicit&&(e=e.concat(t.implicit)),t.explicit&&(i=i.concat(t.explicit))}e.forEach(function(o){if(!(o instanceof Eo))throw new $s("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(o.loadKind&&"scalar"!==o.loadKind)throw new $s("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(o.multi)throw new $s("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),i.forEach(function(o){if(!(o instanceof Eo))throw new $s("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var r=Object.create(vw.prototype);return r.implicit=(this.implicit||[]).concat(e),r.explicit=(this.explicit||[]).concat(i),r.compiledImplicit=$A(r,"implicit"),r.compiledExplicit=$A(r,"explicit"),r.compiledTypeMap=function _U(){var t,e,n={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function i(r){r.multi?(n.multi[r.kind].push(r),n.multi.fallback.push(r)):n[r.kind][r.tag]=n.fallback[r.tag]=r}for(t=0,e=arguments.length;t<e;t+=1)arguments[t].forEach(i);return n}(r.compiledImplicit,r.compiledExplicit),r};var vA=vw,bA=new Eo("tag:yaml.org,2002:str",{kind:"scalar",construct:function(n){return null!==n?n:""}}),yA=new Eo("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(n){return null!==n?n:[]}}),CA=new Eo("tag:yaml.org,2002:map",{kind:"mapping",construct:function(n){return null!==n?n:{}}}),xA=new vA({explicit:[bA,yA,CA]}),wA=new Eo("tag:yaml.org,2002:null",{kind:"scalar",resolve:function mU(n){if(null===n)return!0;var t=n.length;return 1===t&&"~"===n||4===t&&("null"===n||"Null"===n||"NULL"===n)},construct:function $U(){return null},predicate:function vU(n){return null===n},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),EA=new Eo("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function bU(n){if(null===n)return!1;var t=n.length;return 4===t&&("true"===n||"True"===n||"TRUE"===n)||5===t&&("false"===n||"False"===n||"FALSE"===n)},construct:function yU(n){return"true"===n||"True"===n||"TRUE"===n},predicate:function CU(n){return"[object Boolean]"===Object.prototype.toString.call(n)},represent:{lowercase:function(n){return n?"true":"false"},uppercase:function(n){return n?"TRUE":"FALSE"},camelcase:function(n){return n?"True":"False"}},defaultStyle:"lowercase"});function xU(n){return 48<=n&&n<=57||65<=n&&n<=70||97<=n&&n<=102}function wU(n){return 48<=n&&n<=55}function EU(n){return 48<=n&&n<=57}var TA=new Eo("tag:yaml.org,2002:int",{kind:"scalar",resolve:function TU(n){if(null===n)return!1;var r,t=n.length,e=0,i=!1;if(!t)return!1;if(("-"===(r=n[e])||"+"===r)&&(r=n[++e]),"0"===r){if(e+1===t)return!0;if("b"===(r=n[++e])){for(e++;e<t;e++)if("_"!==(r=n[e])){if("0"!==r&&"1"!==r)return!1;i=!0}return i&&"_"!==r}if("x"===r){for(e++;e<t;e++)if("_"!==(r=n[e])){if(!xU(n.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}if("o"===r){for(e++;e<t;e++)if("_"!==(r=n[e])){if(!wU(n.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}}if("_"===r)return!1;for(;e<t;e++)if("_"!==(r=n[e])){if(!EU(n.charCodeAt(e)))return!1;i=!0}return!(!i||"_"===r)},construct:function SU(n){var i,t=n,e=1;if(-1!==t.indexOf("_")&&(t=t.replace(/_/g,"")),("-"===(i=t[0])||"+"===i)&&("-"===i&&(e=-1),i=(t=t.slice(1))[0]),"0"===t)return 0;if("0"===i){if("b"===t[1])return e*parseInt(t.slice(2),2);if("x"===t[1])return e*parseInt(t.slice(2),16);if("o"===t[1])return e*parseInt(t.slice(2),8)}return e*parseInt(t,10)},predicate:function DU(n){return"[object Number]"===Object.prototype.toString.call(n)&&n%1==0&&!Xr_isNegativeZero(n)},represent:{binary:function(n){return n>=0?"0b"+n.toString(2):"-0b"+n.toString(2).slice(1)},octal:function(n){return n>=0?"0o"+n.toString(8):"-0o"+n.toString(8).slice(1)},decimal:function(n){return n.toString(10)},hexadecimal:function(n){return n>=0?"0x"+n.toString(16).toUpperCase():"-0x"+n.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),IU=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),AU=/^[-+]?[0-9]+e/,SA=new Eo("tag:yaml.org,2002:float",{kind:"scalar",resolve:function kU(n){return!(null===n||!IU.test(n)||"_"===n[n.length-1])},construct:function MU(n){var t,e;return e="-"===(t=n.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t?1===e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:e*parseFloat(t,10)},predicate:function FU(n){return"[object Number]"===Object.prototype.toString.call(n)&&(n%1!=0||Xr_isNegativeZero(n))},represent:function PU(n,t){var e;if(isNaN(n))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===n)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===n)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Xr_isNegativeZero(n))return"-0.0";return e=n.toString(10),AU.test(e)?e.replace("e",".e"):e},defaultStyle:"lowercase"}),IA=xA.extend({implicit:[wA,EA,TA,SA]}),kA=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),MA=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),AA=new Eo("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function RU(n){return null!==n&&(null!==kA.exec(n)||null!==MA.exec(n))},construct:function NU(n){var t,e,i,r,o,s,a,me,g=0,w=null;if(null===(t=kA.exec(n))&&(t=MA.exec(n)),null===t)throw new Error("Date resolve error");if(e=+t[1],i=+t[2]-1,r=+t[3],!t[4])return new Date(Date.UTC(e,i,r));if(o=+t[4],s=+t[5],a=+t[6],t[7]){for(g=t[7].slice(0,3);g.length<3;)g+="0";g=+g}return t[9]&&(w=6e4*(60*+t[10]+ +(t[11]||0)),"-"===t[9]&&(w=-w)),me=new Date(Date.UTC(e,i,r,o,s,a,g)),w&&me.setTime(me.getTime()-w),me},instanceOf:Date,represent:function OU(n){return n.toISOString()}}),PA=new Eo("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function BU(n){return"<<"===n||null===n}}),bw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",FA=new Eo("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function LU(n){if(null===n)return!1;var t,e,i=0,r=n.length,o=bw;for(e=0;e<r;e++)if(!((t=o.indexOf(n.charAt(e)))>64)){if(t<0)return!1;i+=6}return i%8==0},construct:function zU(n){var t,e,i=n.replace(/[\r\n=]/g,""),r=i.length,o=bw,s=0,a=[];for(t=0;t<r;t++)t%4==0&&t&&(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)),s=s<<6|o.indexOf(i.charAt(t));return 0==(e=r%4*6)?(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)):18===e?(a.push(s>>10&255),a.push(s>>2&255)):12===e&&a.push(s>>4&255),new Uint8Array(a)},predicate:function VU(n){return"[object Uint8Array]"===Object.prototype.toString.call(n)},represent:function HU(n){var i,r,t="",e=0,o=n.length,s=bw;for(i=0;i<o;i++)i%3==0&&i&&(t+=s[e>>18&63],t+=s[e>>12&63],t+=s[e>>6&63],t+=s[63&e]),e=(e<<8)+n[i];return 0==(r=o%3)?(t+=s[e>>18&63],t+=s[e>>12&63],t+=s[e>>6&63],t+=s[63&e]):2===r?(t+=s[e>>10&63],t+=s[e>>4&63],t+=s[e<<2&63],t+=s[64]):1===r&&(t+=s[e>>2&63],t+=s[e<<4&63],t+=s[64],t+=s[64]),t}}),UU=Object.prototype.hasOwnProperty,jU=Object.prototype.toString,RA=new Eo("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function GU(n){if(null===n)return!0;var e,i,r,o,s,t=[],a=n;for(e=0,i=a.length;e<i;e+=1){if(s=!1,"[object Object]"!==jU.call(r=a[e]))return!1;for(o in r)if(UU.call(r,o)){if(s)return!1;s=!0}if(!s)return!1;if(-1!==t.indexOf(o))return!1;t.push(o)}return!0},construct:function qU(n){return null!==n?n:[]}}),WU=Object.prototype.toString,NA=new Eo("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function ZU(n){if(null===n)return!0;var t,e,i,r,o,s=n;for(o=new Array(s.length),t=0,e=s.length;t<e;t+=1){if("[object Object]"!==WU.call(i=s[t])||1!==(r=Object.keys(i)).length)return!1;o[t]=[r[0],i[r[0]]]}return!0},construct:function YU(n){if(null===n)return[];var t,e,i,r,o,s=n;for(o=new Array(s.length),t=0,e=s.length;t<e;t+=1)i=s[t],r=Object.keys(i),o[t]=[r[0],i[r[0]]];return o}}),KU=Object.prototype.hasOwnProperty,OA=new Eo("tag:yaml.org,2002:set",{kind:"mapping",resolve:function XU(n){if(null===n)return!0;var t,e=n;for(t in e)if(KU.call(e,t)&&null!==e[t])return!1;return!0},construct:function QU(n){return null!==n?n:{}}}),yw=IA.extend({implicit:[AA,PA],explicit:[FA,RA,NA,OA]}),hd=Object.prototype.hasOwnProperty,ej=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,tj=/[\x85\u2028\u2029]/,nj=/[,\[\]\{\}]/,HA=/^(?:!|!!|![a-z\-]+!)$/i,VA=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function UA(n){return Object.prototype.toString.call(n)}function fc(n){return 10===n||13===n}function Ff(n){return 9===n||32===n}function Hs(n){return 9===n||32===n||10===n||13===n}function xp(n){return 44===n||91===n||93===n||123===n||125===n}function ij(n){var t;return 48<=n&&n<=57?n-48:97<=(t=32|n)&&t<=102?t-97+10:-1}function rj(n){return 120===n?2:117===n?4:85===n?8:0}function oj(n){return 48<=n&&n<=57?n-48:-1}function jA(n){return 48===n?"\0":97===n?"\x07":98===n?"\b":116===n||9===n?"\t":110===n?"\n":118===n?"\v":102===n?"\f":114===n?"\r":101===n?"\x1b":32===n?" ":34===n?'"':47===n?"/":92===n?"\\":78===n?"\x85":95===n?"\xa0":76===n?"\u2028":80===n?"\u2029":""}function sj(n){return n<=65535?String.fromCharCode(n):String.fromCharCode(55296+(n-65536>>10),56320+(n-65536&1023))}for(var GA=new Array(256),qA=new Array(256),wp=0;wp<256;wp++)GA[wp]=jA(wp)?1:0,qA[wp]=jA(wp);function aj(n,t){this.input=n,this.filename=t.filename||null,this.schema=t.schema||yw,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=n.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function WA(n,t){var e={name:n.filename,buffer:n.input.slice(0,-1),position:n.position,line:n.line,column:n.position-n.lineStart};return e.snippet=function uU(n,t){if(t=Object.create(t||null),!n.buffer)return null;t.maxLength||(t.maxLength=79),"number"!=typeof t.indent&&(t.indent=1),"number"!=typeof t.linesBefore&&(t.linesBefore=3),"number"!=typeof t.linesAfter&&(t.linesAfter=2);for(var o,e=/\r?\n|\r|\0/g,i=[0],r=[],s=-1;o=e.exec(n.buffer);)r.push(o.index),i.push(o.index+o[0].length),n.position<=o.index&&s<0&&(s=i.length-2);s<0&&(s=i.length-1);var g,w,a="",W=Math.min(n.line+t.linesAfter,r.length).toString().length,ve=t.maxLength-(t.indent+W+3);for(g=1;g<=t.linesBefore&&!(s-g<0);g++)w=mw(n.buffer,i[s-g],r[s-g],n.position-(i[s]-i[s-g]),ve),a=Xr_repeat(" ",t.indent)+$w((n.line-g+1).toString(),W)+" | "+w.str+"\n"+a;for(w=mw(n.buffer,i[s],r[s],n.position,ve),a+=Xr_repeat(" ",t.indent)+$w((n.line+1).toString(),W)+" | "+w.str+"\n",a+=Xr_repeat("-",t.indent+W+3+w.pos)+"^\n",g=1;g<=t.linesAfter&&!(s+g>=r.length);g++)w=mw(n.buffer,i[s+g],r[s+g],n.position-(i[s]-i[s+g]),ve),a+=Xr_repeat(" ",t.indent)+$w((n.line+g+1).toString(),W)+" | "+w.str+"\n";return a.replace(/\n$/,"")}(e),new $s(t,e)}function gn(n,t){throw WA(n,t)}function tb(n,t){n.onWarning&&n.onWarning.call(null,WA(n,t))}var ZA={YAML:function(t,e,i){var r,o,s;null!==t.version&&gn(t,"duplication of %YAML directive"),1!==i.length&&gn(t,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(i[0]))&&gn(t,"ill-formed argument of the YAML directive"),o=parseInt(r[1],10),s=parseInt(r[2],10),1!==o&&gn(t,"unacceptable YAML version of the document"),t.version=i[0],t.checkLineBreaks=s<2,1!==s&&2!==s&&tb(t,"unsupported YAML version of the document")},TAG:function(t,e,i){var r,o;2!==i.length&&gn(t,"TAG directive accepts exactly two arguments"),o=i[1],HA.test(r=i[0])||gn(t,"ill-formed tag handle (first argument) of the TAG directive"),hd.call(t.tagMap,r)&&gn(t,'there is a previously declared suffix for "'+r+'" tag handle'),VA.test(o)||gn(t,"ill-formed tag prefix (second argument) of the TAG directive");try{o=decodeURIComponent(o)}catch(s){gn(t,"tag prefix is malformed: "+o)}t.tagMap[r]=o}};function pd(n,t,e,i){var r,o,s,a;if(t<e){if(a=n.input.slice(t,e),i)for(r=0,o=a.length;r<o;r+=1)9===(s=a.charCodeAt(r))||32<=s&&s<=1114111||gn(n,"expected valid JSON character");else ej.test(a)&&gn(n,"the stream contains non-printable characters");n.result+=a}}function YA(n,t,e,i){var r,o,s,a;for(Xr_isObject(e)||gn(n,"cannot merge mappings; the provided source object is unacceptable"),s=0,a=(r=Object.keys(e)).length;s<a;s+=1)hd.call(t,o=r[s])||(t[o]=e[o],i[o]=!0)}function Ep(n,t,e,i,r,o,s,a,g){var w,W;if(Array.isArray(r))for(w=0,W=(r=Array.prototype.slice.call(r)).length;w<W;w+=1)Array.isArray(r[w])&&gn(n,"nested arrays are not supported inside keys"),"object"==typeof r&&"[object Object]"===UA(r[w])&&(r[w]="[object Object]");if("object"==typeof r&&"[object Object]"===UA(r)&&(r="[object Object]"),r=String(r),null===t&&(t={}),"tag:yaml.org,2002:merge"===i)if(Array.isArray(o))for(w=0,W=o.length;w<W;w+=1)YA(n,t,o[w],e);else YA(n,t,o,e);else!n.json&&!hd.call(e,r)&&hd.call(t,r)&&(n.line=s||n.line,n.lineStart=a||n.lineStart,n.position=g||n.position,gn(n,"duplicated mapping key")),"__proto__"===r?Object.defineProperty(t,r,{configurable:!0,enumerable:!0,writable:!0,value:o}):t[r]=o,delete e[r];return t}function xw(n){var t;10===(t=n.input.charCodeAt(n.position))?n.position++:13===t?(n.position++,10===n.input.charCodeAt(n.position)&&n.position++):gn(n,"a line break is expected"),n.line+=1,n.lineStart=n.position,n.firstTabInLine=-1}function zr(n,t,e){for(var i=0,r=n.input.charCodeAt(n.position);0!==r;){for(;Ff(r);)9===r&&-1===n.firstTabInLine&&(n.firstTabInLine=n.position),r=n.input.charCodeAt(++n.position);if(t&&35===r)do{r=n.input.charCodeAt(++n.position)}while(10!==r&&13!==r&&0!==r);if(!fc(r))break;for(xw(n),r=n.input.charCodeAt(n.position),i++,n.lineIndent=0;32===r;)n.lineIndent++,r=n.input.charCodeAt(++n.position)}return-1!==e&&0!==i&&n.lineIndent<e&&tb(n,"deficient indentation"),i}function nb(n){var e,t=n.position;return!(45!==(e=n.input.charCodeAt(t))&&46!==e||e!==n.input.charCodeAt(t+1)||e!==n.input.charCodeAt(t+2)||(t+=3,e=n.input.charCodeAt(t),0!==e&&!Hs(e)))}function ww(n,t){1===t?n.result+=" ":t>1&&(n.result+=Xr_repeat("\n",t-1))}function KA(n,t){var e,g,i=n.tag,r=n.anchor,o=[],a=!1;if(-1!==n.firstTabInLine)return!1;for(null!==n.anchor&&(n.anchorMap[n.anchor]=o),g=n.input.charCodeAt(n.position);0!==g&&(-1!==n.firstTabInLine&&(n.position=n.firstTabInLine,gn(n,"tab characters must not be used in indentation")),45===g&&Hs(n.input.charCodeAt(n.position+1)));)if(a=!0,n.position++,zr(n,!0,-1)&&n.lineIndent<=t)o.push(null),g=n.input.charCodeAt(n.position);else if(e=n.line,Tp(n,t,3,!1,!0),o.push(n.result),zr(n,!0,-1),g=n.input.charCodeAt(n.position),(n.line===e||n.lineIndent>t)&&0!==g)gn(n,"bad indentation of a sequence entry");else if(n.lineIndent<t)break;return!!a&&(n.tag=i,n.anchor=r,n.kind="sequence",n.result=o,!0)}function pj(n){var t,r,o,s,e=!1,i=!1;if(33!==(s=n.input.charCodeAt(n.position)))return!1;if(null!==n.tag&&gn(n,"duplication of a tag property"),60===(s=n.input.charCodeAt(++n.position))?(e=!0,s=n.input.charCodeAt(++n.position)):33===s?(i=!0,r="!!",s=n.input.charCodeAt(++n.position)):r="!",t=n.position,e){do{s=n.input.charCodeAt(++n.position)}while(0!==s&&62!==s);n.position<n.length?(o=n.input.slice(t,n.position),s=n.input.charCodeAt(++n.position)):gn(n,"unexpected end of the stream within a verbatim tag")}else{for(;0!==s&&!Hs(s);)33===s&&(i?gn(n,"tag suffix cannot contain exclamation marks"):(r=n.input.slice(t-1,n.position+1),HA.test(r)||gn(n,"named tag handle cannot contain such characters"),i=!0,t=n.position+1)),s=n.input.charCodeAt(++n.position);o=n.input.slice(t,n.position),nj.test(o)&&gn(n,"tag suffix cannot contain flow indicator characters")}o&&!VA.test(o)&&gn(n,"tag name cannot contain such characters: "+o);try{o=decodeURIComponent(o)}catch(a){gn(n,"tag name is malformed: "+o)}return e?n.tag=o:hd.call(n.tagMap,r)?n.tag=n.tagMap[r]+o:"!"===r?n.tag="!"+o:"!!"===r?n.tag="tag:yaml.org,2002:"+o:gn(n,'undeclared tag handle "'+r+'"'),!0}function gj(n){var t,e;if(38!==(e=n.input.charCodeAt(n.position)))return!1;for(null!==n.anchor&&gn(n,"duplication of an anchor property"),e=n.input.charCodeAt(++n.position),t=n.position;0!==e&&!Hs(e)&&!xp(e);)e=n.input.charCodeAt(++n.position);return n.position===t&&gn(n,"name of an anchor node must contain at least one character"),n.anchor=n.input.slice(t,n.position),!0}function Tp(n,t,e,i,r){var o,s,a,ve,me,Se,Oe,Ve,We,g=1,w=!1,W=!1;if(null!==n.listener&&n.listener("open",n),n.tag=null,n.anchor=null,n.kind=null,n.result=null,o=s=a=4===e||3===e,i&&zr(n,!0,-1)&&(w=!0,n.lineIndent>t?g=1:n.lineIndent===t?g=0:n.lineIndent<t&&(g=-1)),1===g)for(;pj(n)||gj(n);)zr(n,!0,-1)?(w=!0,a=o,n.lineIndent>t?g=1:n.lineIndent===t?g=0:n.lineIndent<t&&(g=-1)):a=!1;if(a&&(a=w||r),(1===g||4===e)&&(Ve=1===e||2===e?t:t+1,We=n.position-n.lineStart,1===g?a&&(KA(n,We)||function hj(n,t,e){var i,r,o,s,a,g,je,w=n.tag,W=n.anchor,ve={},me=Object.create(null),Se=null,Oe=null,Ve=null,We=!1,Ze=!1;if(-1!==n.firstTabInLine)return!1;for(null!==n.anchor&&(n.anchorMap[n.anchor]=ve),je=n.input.charCodeAt(n.position);0!==je;){if(!We&&-1!==n.firstTabInLine&&(n.position=n.firstTabInLine,gn(n,"tab characters must not be used in indentation")),i=n.input.charCodeAt(n.position+1),o=n.line,63!==je&&58!==je||!Hs(i)){if(s=n.line,a=n.lineStart,g=n.position,!Tp(n,e,2,!1,!0))break;if(n.line===o){for(je=n.input.charCodeAt(n.position);Ff(je);)je=n.input.charCodeAt(++n.position);if(58===je)Hs(je=n.input.charCodeAt(++n.position))||gn(n,"a whitespace character is expected after the key-value separator within a block mapping"),We&&(Ep(n,ve,me,Se,Oe,null,s,a,g),Se=Oe=Ve=null),Ze=!0,We=!1,r=!1,Se=n.tag,Oe=n.result;else{if(!Ze)return n.tag=w,n.anchor=W,!0;gn(n,"can not read an implicit mapping pair; a colon is missed")}}else{if(!Ze)return n.tag=w,n.anchor=W,!0;gn(n,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===je?(We&&(Ep(n,ve,me,Se,Oe,null,s,a,g),Se=Oe=Ve=null),Ze=!0,We=!0,r=!0):We?(We=!1,r=!0):gn(n,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),n.position+=1,je=i;if((n.line===o||n.lineIndent>t)&&(We&&(s=n.line,a=n.lineStart,g=n.position),Tp(n,t,4,!0,r)&&(We?Oe=n.result:Ve=n.result),We||(Ep(n,ve,me,Se,Oe,Ve,s,a,g),Se=Oe=Ve=null),zr(n,!0,-1),je=n.input.charCodeAt(n.position)),(n.line===o||n.lineIndent>t)&&0!==je)gn(n,"bad indentation of a mapping entry");else if(n.lineIndent<t)break}return We&&Ep(n,ve,me,Se,Oe,null,s,a,g),Ze&&(n.tag=w,n.anchor=W,n.kind="mapping",n.result=ve),Ze}(n,We,Ve))||function dj(n,t){var i,r,o,a,W,ve,me,Se,Ve,We,Ze,je,e=!0,s=n.tag,g=n.anchor,Oe=Object.create(null);if(91===(je=n.input.charCodeAt(n.position)))W=93,Se=!1,a=[];else{if(123!==je)return!1;W=125,Se=!0,a={}}for(null!==n.anchor&&(n.anchorMap[n.anchor]=a),je=n.input.charCodeAt(++n.position);0!==je;){if(zr(n,!0,t),(je=n.input.charCodeAt(n.position))===W)return n.position++,n.tag=s,n.anchor=g,n.kind=Se?"mapping":"sequence",n.result=a,!0;e?44===je&&gn(n,"expected the node content, but found ','"):gn(n,"missed comma between flow collection entries"),Ze=null,ve=me=!1,63===je&&Hs(n.input.charCodeAt(n.position+1))&&(ve=me=!0,n.position++,zr(n,!0,t)),i=n.line,r=n.lineStart,o=n.position,Tp(n,t,1,!1,!0),We=n.tag,Ve=n.result,zr(n,!0,t),je=n.input.charCodeAt(n.position),(me||n.line===i)&&58===je&&(ve=!0,je=n.input.charCodeAt(++n.position),zr(n,!0,t),Tp(n,t,1,!1,!0),Ze=n.result),Se?Ep(n,a,Oe,We,Ve,Ze,i,r,o):a.push(ve?Ep(n,null,Oe,We,Ve,Ze,i,r,o):Ve),zr(n,!0,t),44===(je=n.input.charCodeAt(n.position))?(e=!0,je=n.input.charCodeAt(++n.position)):e=!1}gn(n,"unexpected end of the stream within a flow collection")}(n,Ve)?W=!0:(s&&function fj(n,t){var e,i,W,ve,r=1,o=!1,s=!1,a=t,g=0,w=!1;if(124===(ve=n.input.charCodeAt(n.position)))i=!1;else{if(62!==ve)return!1;i=!0}for(n.kind="scalar",n.result="";0!==ve;)if(43===(ve=n.input.charCodeAt(++n.position))||45===ve)1===r?r=43===ve?3:2:gn(n,"repeat of a chomping mode identifier");else{if(!((W=oj(ve))>=0))break;0===W?gn(n,"bad explicit indentation width of a block scalar; it cannot be less than one"):s?gn(n,"repeat of an indentation width identifier"):(a=t+W-1,s=!0)}if(Ff(ve)){do{ve=n.input.charCodeAt(++n.position)}while(Ff(ve));if(35===ve)do{ve=n.input.charCodeAt(++n.position)}while(!fc(ve)&&0!==ve)}for(;0!==ve;){for(xw(n),n.lineIndent=0,ve=n.input.charCodeAt(n.position);(!s||n.lineIndent<a)&&32===ve;)n.lineIndent++,ve=n.input.charCodeAt(++n.position);if(!s&&n.lineIndent>a&&(a=n.lineIndent),fc(ve))g++;else{if(n.lineIndent<a){3===r?n.result+=Xr_repeat("\n",o?1+g:g):1===r&&o&&(n.result+="\n");break}for(i?Ff(ve)?(w=!0,n.result+=Xr_repeat("\n",o?1+g:g)):w?(w=!1,n.result+=Xr_repeat("\n",g+1)):0===g?o&&(n.result+=" "):n.result+=Xr_repeat("\n",g):n.result+=Xr_repeat("\n",o?1+g:g),o=!0,s=!0,g=0,e=n.position;!fc(ve)&&0!==ve;)ve=n.input.charCodeAt(++n.position);pd(n,e,n.position,!1)}}return!0}(n,Ve)||function cj(n,t){var e,i,r;if(39!==(e=n.input.charCodeAt(n.position)))return!1;for(n.kind="scalar",n.result="",n.position++,i=r=n.position;0!==(e=n.input.charCodeAt(n.position));)if(39===e){if(pd(n,i,n.position,!0),39!==(e=n.input.charCodeAt(++n.position)))return!0;i=n.position,n.position++,r=n.position}else fc(e)?(pd(n,i,r,!0),ww(n,zr(n,!1,t)),i=r=n.position):n.position===n.lineStart&&nb(n)?gn(n,"unexpected end of the document within a single quoted scalar"):(n.position++,r=n.position);gn(n,"unexpected end of the stream within a single quoted scalar")}(n,Ve)||function uj(n,t){var e,i,r,o,s,a;if(34!==(a=n.input.charCodeAt(n.position)))return!1;for(n.kind="scalar",n.result="",n.position++,e=i=n.position;0!==(a=n.input.charCodeAt(n.position));){if(34===a)return pd(n,e,n.position,!0),n.position++,!0;if(92===a){if(pd(n,e,n.position,!0),fc(a=n.input.charCodeAt(++n.position)))zr(n,!1,t);else if(a<256&&GA[a])n.result+=qA[a],n.position++;else if((s=rj(a))>0){for(r=s,o=0;r>0;r--)(s=ij(a=n.input.charCodeAt(++n.position)))>=0?o=(o<<4)+s:gn(n,"expected hexadecimal character");n.result+=sj(o),n.position++}else gn(n,"unknown escape sequence");e=i=n.position}else fc(a)?(pd(n,e,i,!0),ww(n,zr(n,!1,t)),e=i=n.position):n.position===n.lineStart&&nb(n)?gn(n,"unexpected end of the document within a double quoted scalar"):(n.position++,i=n.position)}gn(n,"unexpected end of the stream within a double quoted scalar")}(n,Ve)?W=!0:function _j(n){var t,e,i;if(42!==(i=n.input.charCodeAt(n.position)))return!1;for(i=n.input.charCodeAt(++n.position),t=n.position;0!==i&&!Hs(i)&&!xp(i);)i=n.input.charCodeAt(++n.position);return n.position===t&&gn(n,"name of an alias node must contain at least one character"),e=n.input.slice(t,n.position),hd.call(n.anchorMap,e)||gn(n,'unidentified alias "'+e+'"'),n.result=n.anchorMap[e],zr(n,!0,-1),!0}(n)?(W=!0,(null!==n.tag||null!==n.anchor)&&gn(n,"alias node should not have any properties")):function lj(n,t,e){var r,o,s,a,g,w,W,Se,ve=n.kind,me=n.result;if(Hs(Se=n.input.charCodeAt(n.position))||xp(Se)||35===Se||38===Se||42===Se||33===Se||124===Se||62===Se||39===Se||34===Se||37===Se||64===Se||96===Se||(63===Se||45===Se)&&(Hs(r=n.input.charCodeAt(n.position+1))||e&&xp(r)))return!1;for(n.kind="scalar",n.result="",o=s=n.position,a=!1;0!==Se;){if(58===Se){if(Hs(r=n.input.charCodeAt(n.position+1))||e&&xp(r))break}else if(35===Se){if(Hs(n.input.charCodeAt(n.position-1)))break}else{if(n.position===n.lineStart&&nb(n)||e&&xp(Se))break;if(fc(Se)){if(g=n.line,w=n.lineStart,W=n.lineIndent,zr(n,!1,-1),n.lineIndent>=t){a=!0,Se=n.input.charCodeAt(n.position);continue}n.position=s,n.line=g,n.lineStart=w,n.lineIndent=W;break}}a&&(pd(n,o,s,!1),ww(n,n.line-g),o=s=n.position,a=!1),Ff(Se)||(s=n.position+1),Se=n.input.charCodeAt(++n.position)}return pd(n,o,s,!1),!!n.result||(n.kind=ve,n.result=me,!1)}(n,Ve,1===e)&&(W=!0,null===n.tag&&(n.tag="?")),null!==n.anchor&&(n.anchorMap[n.anchor]=n.result)):0===g&&(W=a&&KA(n,We))),null===n.tag)null!==n.anchor&&(n.anchorMap[n.anchor]=n.result);else if("?"===n.tag){for(null!==n.result&&"scalar"!==n.kind&&gn(n,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+n.kind+'"'),ve=0,me=n.implicitTypes.length;ve<me;ve+=1)if((Oe=n.implicitTypes[ve]).resolve(n.result)){n.result=Oe.construct(n.result),n.tag=Oe.tag,null!==n.anchor&&(n.anchorMap[n.anchor]=n.result);break}}else if("!"!==n.tag){if(hd.call(n.typeMap[n.kind||"fallback"],n.tag))Oe=n.typeMap[n.kind||"fallback"][n.tag];else for(Oe=null,ve=0,me=(Se=n.typeMap.multi[n.kind||"fallback"]).length;ve<me;ve+=1)if(n.tag.slice(0,Se[ve].tag.length)===Se[ve].tag){Oe=Se[ve];break}Oe||gn(n,"unknown tag !<"+n.tag+">"),null!==n.result&&Oe.kind!==n.kind&&gn(n,"unacceptable node kind for !<"+n.tag+'> tag; it should be "'+Oe.kind+'", not "'+n.kind+'"'),Oe.resolve(n.result,n.tag)?(n.result=Oe.construct(n.result,n.tag),null!==n.anchor&&(n.anchorMap[n.anchor]=n.result)):gn(n,"cannot resolve a node with !<"+n.tag+"> explicit tag")}return null!==n.listener&&n.listener("close",n),null!==n.tag||null!==n.anchor||W}function mj(n){var e,i,r,s,t=n.position,o=!1;for(n.version=null,n.checkLineBreaks=n.legacy,n.tagMap=Object.create(null),n.anchorMap=Object.create(null);0!==(s=n.input.charCodeAt(n.position))&&(zr(n,!0,-1),s=n.input.charCodeAt(n.position),!(n.lineIndent>0||37!==s));){for(o=!0,s=n.input.charCodeAt(++n.position),e=n.position;0!==s&&!Hs(s);)s=n.input.charCodeAt(++n.position);for(r=[],(i=n.input.slice(e,n.position)).length<1&&gn(n,"directive name must not be less than one character in length");0!==s;){for(;Ff(s);)s=n.input.charCodeAt(++n.position);if(35===s){do{s=n.input.charCodeAt(++n.position)}while(0!==s&&!fc(s));break}if(fc(s))break;for(e=n.position;0!==s&&!Hs(s);)s=n.input.charCodeAt(++n.position);r.push(n.input.slice(e,n.position))}0!==s&&xw(n),hd.call(ZA,i)?ZA[i](n,i,r):tb(n,'unknown document directive "'+i+'"')}zr(n,!0,-1),0===n.lineIndent&&45===n.input.charCodeAt(n.position)&&45===n.input.charCodeAt(n.position+1)&&45===n.input.charCodeAt(n.position+2)?(n.position+=3,zr(n,!0,-1)):o&&gn(n,"directives end mark is expected"),Tp(n,n.lineIndent-1,4,!1,!0),zr(n,!0,-1),n.checkLineBreaks&&tj.test(n.input.slice(t,n.position))&&tb(n,"non-ASCII line breaks are interpreted as content"),n.documents.push(n.result),n.position===n.lineStart&&nb(n)?46===n.input.charCodeAt(n.position)&&(n.position+=3,zr(n,!0,-1)):n.position<n.length-1&&gn(n,"end of the stream or a document separator is expected")}function XA(n,t){t=t||{},0!==(n=String(n)).length&&(10!==n.charCodeAt(n.length-1)&&13!==n.charCodeAt(n.length-1)&&(n+="\n"),65279===n.charCodeAt(0)&&(n=n.slice(1)));var e=new aj(n,t),i=n.indexOf("\0");for(-1!==i&&(e.position=i,gn(e,"null byte is not allowed in input")),e.input+="\0";32===e.input.charCodeAt(e.position);)e.lineIndent+=1,e.position+=1;for(;e.position<e.length-1;)mj(e);return e.documents}var QA_load=function vj(n,t){var e=XA(n,t);if(0!==e.length){if(1===e.length)return e[0];throw new $s("expected a single document in the stream, but found more")}};function kw(n,t){return function(){throw new Error("Function yaml."+n+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var $P=QA_load;kw("safeLoad","load"),kw("safeLoadAll","loadAll"),kw("safeDump","dump");const vP=Object.getOwnPropertyNames(Object.prototype),mG=Object.getOwnPropertyNames(Array.prototype);let Mw=(()=>{class n{constructor(){this.peerHistory=[],this.isOpen=!1}initialize(){this.initAppConfig()}initAppConfig(){var e=this;return(0,xn.Z)(function*(){try{console.log("YAML\u8aad\u307f\u8fbc\u307f...");let i=yield e.loadYaml(),r=$P(i);n.applyConfig(r)}catch(i){console.warn(i)}Qe.trigger("LOAD_CONFIG",n.appConfig)})()}loadYaml(){return(0,xn.Z)(function*(){let e=document.querySelector('script[type$="yaml"]');if(!e)return console.warn("loadYaml element not found."),"";let i=e.getAttribute("src");return null==i?(console.warn("loadYaml url undefined."),e.textContent):(yield fetch(i)).text()})()}static applyConfig(e,i=n.appConfig){if(null==e)return i;let r=Object.getOwnPropertyNames(e);for(let o of r)(Array.isArray(e)||Array.isArray(i)?vP.concat(mG):vP).includes(o)?console.log(`skip invalid key (${o})`):null!=e[o]&&"object"==typeof e[o]?(null==i[o]&&(i[o]=Array.isArray(e[o])?[]:{}),n.applyConfig(e[o],i[o])):"function"!=typeof e[o]&&"function"!=typeof i[o]&&(i[o]=e[o]);return i}}return n.appConfig={webrtc:{key:""},app:{title:"",mode:""}},n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();var Aw;!function(n){n.resize=function t(e,i,r,o){let s=e.width,a=e.height,g=s/(i=Math.round(i)),w=a/(r=Math.round(r)),W=Math.ceil(g/2),ve=Math.ceil(w/2),me=e.getContext("2d"),Se=me.getImageData(0,0,s,a),Oe=me.createImageData(i,r),Ve=Se.data,We=Oe.data;for(let Ze=0;Ze<r;Ze++)for(let je=0;je<i;je++){let ut=4*(je+Ze*i),ot=0,ft=0,Ot=0,Et=0,Ut=0,It=0,Pt=0,Wt=(Ze+.5)*w,ci=Math.floor(Ze*w),Jn=Math.ceil((Ze+1)*w);for(let gi=ci;gi<Jn;gi++){let Ri=Math.abs(Wt-(gi+.5))/ve,Rt=(je+.5)*g,Zt=Ri*Ri,tn=Math.floor(je*g),dn=Math.ceil((je+1)*g);for(let Wn=tn;Wn<dn;Wn++){let $i=Math.abs(Rt-(Wn+.5))/W,Mi=Math.sqrt(Zt+$i*$i);if(Mi>=1)continue;ot=2*Mi*Mi*Mi-3*Mi*Mi+1;let ar=4*(Wn+gi*s);Pt+=ot*Ve[ar+3],Ot+=ot,Ve[ar+3]<255&&(ot=ot*Ve[ar+3]/250),Et+=ot*Ve[ar],Ut+=ot*Ve[ar+1],It+=ot*Ve[ar+2],ft+=ot}}We[ut]=Et/ft,We[ut+1]=Ut/ft,We[ut+2]=It/ft,We[ut+3]=Pt/Ot}!0===o?(e.width=i,e.height=r):me.clearRect(0,0,s,a),me.putImageData(Oe,0,0)}}(Aw||(Aw={}));var vl,$G=Ce(7412);!function(n){function r(){return(r=(0,xn.Z)(function*(g){return g instanceof Blob?o(g):a(g)})).apply(this,arguments)}function o(g){return s.apply(this,arguments)}function s(){return(s=(0,xn.Z)(function*(g){return a(yield n.readAsArrayBufferAsync(g))})).apply(this,arguments)}function a(g){let w=$G.create(g);return zk(w).toString()}n.readAsArrayBufferAsync=function t(g){return new Promise((w,W)=>{let ve=new FileReader;ve.onload=me=>{w(ve.result)},ve.onabort=ve.onerror=me=>{W(me)},ve.readAsArrayBuffer(g)})},n.readAsTextAsync=function e(g){return new Promise((w,W)=>{let ve=new FileReader;ve.onload=me=>{w(ve.result)},ve.onabort=ve.onerror=me=>{W(me)},ve.readAsText(g)})},n.calcSHA256Async=function i(g){return r.apply(this,arguments)}}(vl||(vl={}));var Yc,Hr=(()=>(function(n){n[n.NULL=0]="NULL",n[n.THUMBNAIL=1]="THUMBNAIL",n[n.COMPLETE=2]="COMPLETE",n[n.URL=1e3]="URL"}(Hr||(Hr={})),Hr))();class Bt{constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:"",thumbnail:{blob:null,type:"",url:""}}}get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob?this.context.blob:this.context.thumbnail.blob}get url(){return this.context.url?this.context.url:this.context.thumbnail.url}get thumbnail(){return this.context.thumbnail}get state(){return this.url||this.blob?this.url&&!this.blob?Hr.URL:this.blob===this.thumbnail.blob?Hr.THUMBNAIL:Hr.COMPLETE:Hr.NULL}get isEmpty(){return this.state<=Hr.NULL}static createEmpty(t){let e=new Bt;return e.context.identifier=t,e}static create(t){if("string"==typeof t){let e=new Bt;return e.context.identifier=t,e.context.name=t,e.context.url=t,e}{let e=new Bt;return e.apply(t),e}}static createAsync(t){return(0,xn.Z)(function*(){return t instanceof File?yield Bt._createAsync(t,t.name):t instanceof Blob?yield Bt._createAsync(t):void 0})()}static _createAsync(t,e){return(0,xn.Z)(function*(){let i=yield vl.readAsArrayBufferAsync(t),r=new Bt;r.context.identifier=yield vl.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:t.type}),r.context.url=window.URL.createObjectURL(r.context.blob);try{r.context.thumbnail=yield Bt.createThumbnailAsync(r.context)}catch(o){throw o}return null!=r.context.name&&(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(t){!this.context.identifier&&t.identifier&&(this.context.identifier=t.identifier),!this.context.name&&t.name&&(this.context.name=t.name),!this.context.blob&&t.blob&&(this.context.blob=t.blob),!this.context.type&&t.type&&(this.context.type=t.type),!this.context.url&&t.url&&(this.state!==Hr.URL&&window.URL.revokeObjectURL(this.context.url),this.context.url=t.url),!this.context.thumbnail.blob&&t.thumbnail.blob&&(this.context.thumbnail.blob=t.thumbnail.blob),!this.context.thumbnail.type&&t.thumbnail.type&&(this.context.thumbnail.type=t.thumbnail.type),!this.context.thumbnail.url&&t.thumbnail.url&&(this.state!==Hr.URL&&window.URL.revokeObjectURL(this.context.thumbnail.url),this.context.thumbnail.url=t.thumbnail.url),this.createURLs()}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url,thumbnail:{blob:this.context.thumbnail.blob,type:this.context.thumbnail.type,url:this.context.thumbnail.url}}}createURLs(){this.state!==Hr.URL&&(this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob)),this.context.thumbnail.blob&&""===this.context.thumbnail.url&&(this.context.thumbnail.url=window.URL.createObjectURL(this.context.thumbnail.blob)))}revokeURLs(){this.state!==Hr.URL&&(window.URL.revokeObjectURL(this.context.url),window.URL.revokeObjectURL(this.context.thumbnail.url))}static createThumbnailAsync(t){return new Promise((e,i)=>{let r=new Image;r.onload=o=>{let s=Math.min(128/Math.max(r.width,r.height),1),a=r.width*s,g=r.height*s,w=document.createElement("canvas"),W=w.getContext("2d");w.width=r.width,w.height=r.height,W.drawImage(r,0,0),Aw.resize(w,a,g,!0),w.toBlob(ve=>{let me={type:ve.type,blob:ve,url:window.URL.createObjectURL(ve)};e(me)},t.blob.type)},r.onabort=r.onerror=()=>{i()},r.src=t.url})}}Bt.Empty=Bt.createEmpty("null");class St{constructor(){this.imageHash={},console.log("ImageStorage ready...")}static get instance(){return St._instance||(St._instance=new St),St._instance}get images(){let t=[];for(let e in this.imageHash)t.push(this.imageHash[e]);return t}destroy(){for(let t in this.imageHash)this.delete(t)}addAsync(t){var e=this;return(0,xn.Z)(function*(){let i=yield Bt.createAsync(t);return e._add(i)})()}add(t){let e;if("string"==typeof t)e=Bt.create(t);else if(t instanceof Bt)e=t;else{if(this.update(t))return this.imageHash[t.identifier];e=Bt.create(t)}return this._add(e)}_add(t){return Hr.COMPLETE<=t.state&&this.lazySynchronize(100),this.update(t)?this.imageHash[t.identifier]:(this.imageHash[t.identifier]=t,console.log("add Image: "+t.identifier),t)}update(t){let e;e=t instanceof Bt?t.toContext():t;let i=this.imageHash[t.identifier];return!!i&&(i.apply(t),!0)}delete(t){let e=this.imageHash[t];return!!e&&(e.destroy(),delete this.imageHash[t],!0)}get(t){return this.imageHash[t]||null}synchronize(t){this.lazyTimer&&this.lazyTimer.stop(),Qe.call("SYNCHRONIZE_FILE_LIST",this.getCatalog(),t)}lazySynchronize(t,e){null==this.lazyTimer&&(this.lazyTimer=new uc(()=>this.synchronize(e),t)),this.lazyTimer.reset(t)}getCatalog(){let t=[];for(let e of this.images)Hr.COMPLETE<=e.state&&t.push({identifier:e.identifier,state:e.state});return t}}class hc{constructor(){this.constructorMap=new Map,this.aliasMap=new Map,console.log("ObjectFactory ready...")}static get instance(){return hc._instance||(hc._instance=new hc),hc._instance}register(t,e){var i,r,o;e||(e=null!==(i=t.name)&&void 0!==i?i:null!==(o=null===(r=t.toString().match(/function\s*([^(]*)\(/))||void 0===r?void 0:r[1])&&void 0!==o?o:""),this.constructorMap.has(e)?console.error("\u305d\u306e alias<"+e+"> \u306f\u3059\u3067\u306b\u5272\u308a\u5f53\u3066\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f"):this.aliasMap.has(t)?console.error("\u305d\u306e constructor \u306f\u3059\u3067\u306b\u767b\u9332\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f",t):(console.log("addGameObjectFactory -> "+e),this.constructorMap.set(e,t),this.aliasMap.set(t,e))}create(t,e){let i=this.constructorMap.get(t);return i?new i(e):(console.error(t+"\u3068\u3044\u3046\u540d\u306e\uff27ameObject\u30af\u30e9\u30b9\u306f\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),null)}getAlias(t){var e;return null!==(e=this.aliasMap.get(t))&&void 0!==e?e:""}}function bP(n){return t=>{hc.instance.register(t,n)}}function Dp(){return(n,t)=>{Object.defineProperty(n,t,{get:function e(){return this.context.syncData[t]},set:function i(r){this.context.syncData[t]=r,this.update()},enumerable:!0,configurable:!0})}}!function(n){const t=/&|<|>|"|'/g,e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},i=/&amp;|&lt;|&gt;|&quot;|&apos;/g,r={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'"},o=/((?:[\0-\x08\x0B\f\x0E-\x1F\uFFFD\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/g;function W(me){return e[me]}function ve(me){return r[me]}n.xml2element=function s(me){let Se=new DOMParser,Oe=null;try{me=function w(me){return me.replace(o,"").trim()}(me),Oe=Se.parseFromString(me,"application/xml"),Oe.getElementsByTagName("parsererror").length&&(console.error("XML\u306e\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3057\u305f",Oe.documentElement),Oe=null)}catch(Ve){console.error(Ve)}return Oe?Oe.documentElement:null},n.encodeEntityReference=function a(me){return me.replace(t,W)},n.decodeEntityReference=function g(me){return me.replace(i,ve)}}(Yc||(Yc={}));const bG=Object.getOwnPropertyNames(Object.prototype);Object.getOwnPropertyNames(Array.prototype);class er{constructor(){console.log("ObjectSerializer ready...")}static get instance(){return er._instance||(er._instance=new er),er._instance}toXml(t){let e="",i="toAttributes"in t?t.toAttributes():er.toAttributes(t.toContext().syncData),r=t.aliasName,o="";for(let s in i){let a=Yc.encodeEntityReference(i[s]+"");null!=a&&(o+=" "+s+'="'+a+'"')}return e+=`<${r+o}>`,e+="innerXml"in t?t.innerXml():"",e+=`</${r}>`,e}static toAttributes(t){let e={};for(let i in t){let s=er.make2Attributes(t[i],i);for(let a in s)e[a]=s[a]}return e}static make2Attributes(t,e){let i={};if(Array.isArray(t)){let r=er.array2attributes(t,e);for(let o in r)i[o]=r[o]}else if("object"==typeof t){let r=er.object2attributes(t,e);for(let o in r)i[o]=r[o]}else i[e]=t;return i}static object2attributes(t,e){let i={};for(let r in t){let a=er.make2Attributes(t[r],e+"."+r);for(let g in a)i[g]=a[g]}return i}static array2attributes(t,e){let i={},r=t.length;for(let o=0;o<r;o++){let g=er.make2Attributes(t[o],e+"."+o);for(let w in g)i[w]=g[w]}return i}parseXml(t){let e=null;if(e="string"==typeof t?Yc.xml2element(t):t,!e)return console.error("xmlElement\u304c\u7a7a\u3067\u3059"),null;let i=hc.instance.create(e.tagName);if(!i)return null;if("parseAttributes"in i)i.parseAttributes(e.attributes);else{let r=i.toContext();er.parseAttributes(r.syncData,e.attributes),i.apply(r)}return i.initialize(),"parseInnerXml"in i&&i.parseInnerXml(e),i}static parseAttributes(t,e){let i=e.length;for(let r=0;r<i;r++){let o=e[r].value;o=Yc.decodeEntityReference(o);let s=e[r].name.split("."),a=s[0],g=t,w=s.find(ve=>bG.includes(ve));null==w?1<s.length&&(({obj:g,key:a}=er.attributes2object(s,g,a)),null==a)||("string"!=typeof g[a]&&null!=g[a]&&(o=JSON.parse(o)),g[a]=o):console.log(`skip invalid key (${w})`)}return t}static attributes2object(t,e,i){let r=null,o=t.length;for(let s=0;s<o;s++){let a=parseInt(t[s]);if(r&&!Number.isNaN(a)&&!Array.isArray(e)&&Object.keys(r).length&&(r[i]=[],e=r[i]),i=Number.isNaN(a)?t[s]:a,Array.isArray(e)&&"number"!=typeof i)return console.warn("Array\u306b\u306findex\u306e\u633f\u5165\u3057\u304b\u8a31\u53ef\u3057\u306a\u3044"),{obj:e,key:null};s+1<o&&(null==e[i]&&(e[i]="number"==typeof i?[]:{}),r=e,e=e[i])}return{obj:e,key:i}}static parseInnerXml(t){return null}}class Xe{constructor(){this.identifierMap=new Map,this.aliasNameMap=new Map,this.garbageMap=new Map,this.queueMap=new Map,this.updateInterval=null,this.garbageCollectionInterval=null,this.updateCallback=()=>{this.updateQueue()},console.log("ObjectStore ready...")}static get instance(){return Xe._instance||(Xe._instance=new Xe),Xe._instance}add(t,e=!0){return null!=this.get(t.identifier)||this.isDeleted(t.identifier)?null:(this.identifierMap.set(t.identifier,t),(this.aliasNameMap.has(t.aliasName)?this.aliasNameMap.get(t.aliasName):this.aliasNameMap.set(t.aliasName,new Map).get(t.aliasName)).set(t.identifier,t),t.onStoreAdded(),e&&this.update(t.toContext()),t)}remove(t){if(!this.identifierMap.has(t.identifier))return null;this.identifierMap.delete(t.identifier);let e=this.aliasNameMap.get(t.aliasName);return e&&e.delete(t.identifier),t.onStoreRemoved(),t}delete(t,e=!0){let i=null,r=null;return"string"==typeof t?(i=this.get(t),r=t):(i=t,r=t.identifier),this.markForDelete(r),null==i?null:this._delete(i,e)}_delete(t,e){return console.log("\u5186\u67f1\u3000_delete:"+t.aliasName),null===this.remove(t)?null:(e&&Qe.call("DELETE_GAME_OBJECT",{aliasName:t.aliasName,identifier:t.identifier}),t)}markForDelete(t){console.log("\u5186\u67f1\u3000markForDelete"+t),this.garbageMap.set(t,performance.now()),this.garbageCollection(6e5)}get(t){return this.identifierMap.has(t)?this.identifierMap.get(t):null}getObjects(t){if(null==t)return Array.from(this.identifierMap.values());let e="";return e="string"==typeof t?t:t.aliasName,this.aliasNameMap.has(e)?Array.from(this.aliasNameMap.get(e).values()):[]}update(t){let e=null;if("string"==typeof t){let i=this.get(t);i&&(e=i.toContext())}else e=t;if(e){if(this.queueMap.has(e.identifier)){let i=this.queueMap.get(e.identifier);for(let r in e)i[r]=e[r];return}Qe.call("UPDATE_GAME_OBJECT",e),this.queueMap.set(e.identifier,e),null===this.updateInterval&&(this.updateInterval=Yo(this.updateCallback))}}updateQueue(){this.queueMap.clear(),this.updateInterval=null}isDeleted(t){return null!=this.garbageMap.get(t)}getCatalog(){let t=[];for(let e of this.identifierMap.values())t.push({identifier:e.identifier,version:e.version});return t}clearDeleteHistory(){this.garbageMap.clear()}dispGarbageMap(){for(let t of this.garbageMap)console.log("garbageMap \u5c65\u6b74:"+t)}garbageCollection(t){"number"==typeof t?null===this.garbageCollectionInterval&&(this.garbageCollectionInterval=setTimeout(()=>{this.garbageCollectionInterval=null},1e3),this._garbageCollection(t)):this.garbageMap.delete(t.identifier)}_garbageCollection(t){let e=performance.now(),i=this.garbageMap.size-1e5;if(i<1)return;let r=this.garbageMap.entries();for(;i<1;){i--;let o=r.next();if(o.done)break;let s=o.value[0];o.value[1]+t<e||this.garbageMap.delete(s)}}}class ca{constructor(t=fd.generateUuid()){this.context={aliasName:this.constructor.aliasName,identifier:"",majorVersion:0,minorVersion:0,syncData:{}},this.context.identifier=t}static get aliasName(){return hc.instance.getAlias(this)}get aliasName(){return this.context.aliasName}get identifier(){return this.context.identifier}get version(){return this.context.majorVersion+this.context.minorVersion}initialize(){Xe.instance.add(this)}destroy(){Xe.instance.delete(this)}onStoreAdded(){}onStoreRemoved(){}update(){this.versionUp(),Xe.instance.update(this.identifier)}versionUp(){this.context.majorVersion+=1,this.context.minorVersion=Math.random()}apply(t){null!==t&&this.identifier===t.identifier&&(this.context.majorVersion=t.majorVersion,this.context.minorVersion=t.minorVersion,this.context.syncData=t.syncData)}clone(){let t=this.toXml();return er.instance.parseXml(t)}toContext(){return{aliasName:this.context.aliasName,identifier:this.context.identifier,majorVersion:this.context.majorVersion,minorVersion:this.context.minorVersion,syncData:yP(this.context.syncData)}}toXml(){return er.instance.toXml(this)}}function yP(n){if(null==n)return n;let t=Array.isArray(n)?[]:{},e=Object.getOwnPropertyNames(n);for(let i of e){let r=typeof n[i];null!=n[i]&&"object"===r?t[i]=yP(n[i]):"function"!==r&&(t[i]=n[i])}return t}var pc;let Si=pc=class extends ca{constructor(){super(...arguments),this.value="",this.attributes={},this.parentIdentifier="",this.majorIndex=0,this.minorIndex=Math.random(),this._children=[],this.needsSort=!0}get index(){return this.majorIndex+this.minorIndex}set index(t){this.majorIndex=0|t,this.minorIndex=t-this.majorIndex,this.parent&&(this.parent.needsSort=!0)}get parent(){return Xe.instance.get(this.parentIdentifier)}get parentId(){return this.parentIdentifier}get parentIsAssigned(){return 0<this.parentIdentifier.length}get parentIsUnknown(){return this.parentIsAssigned&&null==Xe.instance.get(this.parentIdentifier)}get parentIsDestroyed(){return this.parentIsAssigned&&Xe.instance.isDeleted(this.parentIdentifier)}get children(){return this.needsSort&&(this.needsSort=!1,this._children.sort((t,e)=>t.index-e.index)),this._children.concat()}destroy(){super.destroy();for(let t of this._children.concat())t.destroy();this._children=[]}onStoreAdded(){super.onStoreAdded(),this.initializeChildren()}onStoreRemoved(){super.onStoreRemoved(),this.parent&&this.parent.removeChild(this)}onChildAdded(t){}onChildRemoved(t){}_onChildAdded(t){let e=this;for(;e&&(e.onChildAdded(t),e=e.parent,e!==this););}_onChildRemoved(t){let e=this;for(;e&&(e.onChildRemoved(t),e=e.parent,e!==this););}initializeChildren(){if(null==pc.unknownNodes[this.identifier])return;let t=pc.unknownNodes[this.identifier];for(let e of t)e.parent===this&&this.updateChildren(e);pc.unknownNodes[this.identifier]&&delete pc.unknownNodes[this.identifier]}updateChildren(t=this){let e=this._children.indexOf(t),i=!1,r=t.parent===this;if(e<0&&r)this._children.push(t),e=this._children.length-1,i=!0;else{if(0<=e&&!r)return this._children.splice(e,1),void this._onChildRemoved(t);if(e<0&&!r)return}let o=this._children.length;o&&((this._children[e-1<0?0:e-1].index>t.index||t.index>this._children[o-1<e+1?o-1:e+1].index)&&(this.needsSort=!0),i&&this._onChildAdded(t))}updateIndexs(){let t=this.children;for(let e=0;e<t.length;e++)t[e].majorIndex=e,t[e].minorIndex=Math.random()}appendChild(t){if(t.contains(this))return null;t.parent&&t.parent!==this&&t.parent.removeChild(t);let e=0<this.children.length?this.children[this.children.length-1].majorIndex+1:0;return t.parentIdentifier=this.identifier,t.majorIndex=e,t.minorIndex=Math.random(),this.updateChildren(t),t}insertBefore(t,e){if(t.contains(this))return null;if(t===e&&t.parent===this)return t;t.parent&&t.parent!==this&&t.parent.removeChild(t);let i=this.children.indexOf(e);if(i<0)return this.appendChild(t);t.parentIdentifier=this.identifier;let r=0<i?this.children[i-1].index:0,o=e.index-r,s=r+o*(.45+.1*Math.random());return t.majorIndex=0|s,t.minorIndex=s-t.majorIndex,this.updateChildren(t),o<1e-7&&this.updateIndexs(),t}removeChild(t){return this.children.indexOf(t)<0?null:(t.parentIdentifier="",t.majorIndex=0,t.minorIndex=Math.random(),this.updateChildren(t),t)}contains(t){let e=t.parent;for(;e;){if(e===t)return console.error("\u3042 \u3084\u3063\u3079\u3001\u5faa\u74b0\u53c2\u7167",t),!1;if(e===this)return!0;e=e.parent}return!1}setAttribute(t,e){this.attributes[t]=e,this.update()}getAttribute(t){return null==this.attributes[t]?"":this.attributes[t]}removeAttribute(t){delete this.attributes[t],this.update()}toAttributes(){return er.toAttributes(this.attributes)}parseAttributes(t){er.parseAttributes(this.attributes,t)}innerXml(){let t="";t+=Yc.encodeEntityReference(this.value+"");for(let e of this.children)t+=er.instance.toXml(e);return t}parseInnerXml(t){let e=t.children,i=e.length;if(0<i)for(let r=0;r<i;r++){let o=er.instance.parseXml(e[r]);o instanceof pc&&this.appendChild(o)}else this.value=Yc.decodeEntityReference(t.innerHTML)}apply(t){let e=this.parent;super.apply(t),e&&this.parent!==e&&e.updateChildren(this),this.parent?this.parent.updateChildren(this):this.parentIsAssigned&&(this.parentIdentifier in pc.unknownNodes||(pc.unknownNodes[this.parentIdentifier]=[]),pc.unknownNodes[this.parentIdentifier].push(this))}};function li(n){return t=>{bP(n)(t)}}function lt(){return(n,t)=>{n instanceof Si?function vG(){return(n,t)=>{Object.defineProperty(n,t,{get:function e(){return this.getAttribute(t)},set:function i(r){this.setAttribute(t,r)},enumerable:!0,configurable:!0})}}()(n,t):Dp()(n,t)}}Si.unknownNodes={},xe([Dp()],Si.prototype,"value",void 0),xe([Dp()],Si.prototype,"attributes",void 0),xe([Dp()],Si.prototype,"parentIdentifier",void 0),xe([Dp()],Si.prototype,"majorIndex",void 0),xe([Dp()],Si.prototype,"minorIndex",void 0),Si=pc=xe([bP("node")],Si);let po=class extends Si{constructor(){super(...arguments),this.fixd=!1,this._sendTo=[],this._tags=[]}get tabIdentifier(){return this.parent.identifier}get text(){return this.value}set text(t){this.value=t}get timestamp(){let t=this.getAttribute("timestamp"),e=t?+t:0;return Number.isNaN(e)?1:e}get sendTo(){return this._to!==this.to&&(this._to=this.to,this._sendTo=null!=this.to&&0<this.to.trim().length?this.to.trim().split(/\s+/):[]),this._sendTo}get tags(){return this._tag!==this.tag&&(this._tag=this.tag,this._tags=null!=this.tag&&0<this.tag.trim().length?this.tag.trim().split(/\s+/):[]),this._tags}get image(){return St.instance.get(this.imageIdentifier)}get index(){return this.minorIndex+this.timestamp}get isDirect(){return 0<this.sendTo.length}get isSendFromSelf(){return this.from===bt.peerContext.userId||this.originFrom===bt.peerContext.userId}get isRelatedToMe(){return!!(-1<this.sendTo.indexOf(bt.peerContext.userId)||this.isSendFromSelf)}get isDisplayable(){return!this.isDirect||this.isRelatedToMe}get isSystem(){return-1<this.tags.indexOf("system")}get isDicebot(){return!(!this.isSystem||"System-BCDice"!==this.from)}get isSecret(){return-1<this.tags.indexOf("secret")}get chatTabList(){return Xe.instance.get("ChatTabList")}get isSystemToPL(){return-1<this.tags.indexOf("to-pl-system-message")}get changeable(){return this.from==bt.peerContext.userId&&"\u30b7\u30b9\u30c6\u30e0\u30e1\u30c3\u30bb\u30fc\u30b8"!=this.name}};xe([lt()],po.prototype,"originFrom",void 0),xe([lt()],po.prototype,"from",void 0),xe([lt()],po.prototype,"to",void 0),xe([lt()],po.prototype,"name",void 0),xe([lt()],po.prototype,"tag",void 0),xe([lt()],po.prototype,"dicebot",void 0),xe([lt()],po.prototype,"imageIdentifier",void 0),xe([lt()],po.prototype,"imagePos",void 0),xe([lt()],po.prototype,"messColor",void 0),xe([lt()],po.prototype,"sendFrom",void 0),xe([lt()],po.prototype,"fixd",void 0),po=xe([li("chat")],po);let Va=class extends Si{constructor(){super(...arguments),this.name="\u30bf\u30d6",this.pos_num=-1,this.imageIdentifier=["a","b","c","d","e","f","g","h","i","j","k","l"],this.imageCharactorName=["#0","#1","#2","#3","#4","#5","#6","#7","#8","#9","#10","#11"],this.imageIdentifierZpos=[0,1,2,3,4,5,6,7,8,9,10,11],this.count=0,this.imageIdentifierDummy="test",this._displayableMessageNum=0,this.imageDispFlag=[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],this.chatSimpleDispFlag=0,this.tachieDispFlag=1,this._dispCharctorIcon=!0,this._unreadLength=0}get cutInLauncher(){return Xe.instance.get("CutInLauncher")}displayableMessagesLength(){return this._displayableMessageNum}tachieReset(){this.imageIdentifier=["a","b","c","d","e","f","g","h","i","j","k","l"],this.imageCharactorName=["#0","#1","#2","#3","#4","#5","#6","#7","#8","#9","#10","#11"],this.imageIdentifierZpos=[0,1,2,3,4,5,6,7,8,9,10,11],this.imageIdentifierDummy="test"}get chatMessages(){return this.children}get imageZposList(){return this.imageIdentifierZpos.slice()}getImageCharactorPos(t){for(let e=0;e<this.imageCharactorName.length;e++)if(t==this.imageCharactorName[e])return e;return-1}tachiePosHide(t){this.imageDispFlag[t]=!1,console.log(this.imageDispFlag)}tachiePosIsDisp(t){return this.imageDispFlag[t]}tachieZindex(t){return this.imageIdentifierZpos.indexOf(Number(t))}replaceTachieZindex(t){let e=this.imageIdentifierZpos.indexOf(Number(t));e>=0&&(this.imageIdentifierZpos.splice(e,1),this.imageIdentifierZpos.push(Number(t)))}get dispCharctorIcon(){return this._dispCharctorIcon}set dispCharctorIcon(t){this._dispCharctorIcon=t}get unreadLength(){return this._unreadLength}get hasUnread(){return 0<this.unreadLength}get latestTimeStamp(){let t=this.chatMessages.length-1;return t<0?0:this.chatMessages[t].timestamp}onChildAdded(t){super.onChildAdded(t),t.parent===this&&t instanceof po&&t.isDisplayable&&(1==this.children.length?(this._unreadLength=1,this._displayableMessageNum=1):(this._unreadLength++,this._displayableMessageNum++),null!=t.to&&""!==t.to||(this.imageDispFlag[t.imagePos]=!0),Qe.trigger("MESSAGE_ADDED",{tabIdentifier:this.identifier,messageIdentifier:t.identifier}))}addMessage(t,e){t.tabIdentifier=this.identifier;let i=new po;for(let o in t)if("identifier"!==o&&"tabIdentifier"!==o){if("text"===o){i.value=t[o];continue}if(null!=t[o]&&""!==t[o]){if("imagePos"===o){if(null!=t.to&&""!==t.to)continue;if(this.pos_num=t[o],0<=this.pos_num&&this.pos_num<this.imageIdentifier.length){let s=this.getImageCharactorPos(t.name);s>=0&&(this.imageIdentifier[s]="",this.imageCharactorName[s]="",this.imageDispFlag[s]=!1),""==t.imageIdentifier||(this.imageIdentifier[this.pos_num]=t.imageIdentifier,this.imageCharactorName[this.pos_num]=t.name,this.replaceTachieZindex(this.pos_num),this.imageDispFlag[this.pos_num]=!0,i.setAttribute(o,t[o])),this.imageIdentifierDummy=t.imageIdentifier}continue}i.setAttribute(o,t[o])}}i.initialize(),0>i.tags.indexOf("secret")&&this.cutInLauncher.chatActivateCutIn(i.text,t.to);let r=!1;if(e&&e.length>=1&&(r=!0),r)for(let o of e)Qe.trigger("SEND_MESSAGE",{tabIdentifier:this.identifier,messageIdentifier:i.identifier,messageTrget:o});else Qe.trigger("SEND_MESSAGE",{tabIdentifier:this.identifier,messageIdentifier:i.identifier,messageTrget:null});return Qe.trigger("DICE_TABLE_MESSAGE",{tabIdentifier:this.identifier,messageIdentifier:i.identifier}),Qe.trigger("RESOURCE_EDIT_MESSAGE",{tabIdentifier:this.identifier,messageIdentifier:i.identifier,messageTargetContext:e||null}),Qe.trigger("APRIL_MESSAGE",{tabIdentifier:this.identifier,messageIdentifier:i.identifier}),this.appendChild(i),i}markForRead(){this._unreadLength=0}innerXml(){let t="";for(let e of this.children)e instanceof po&&!e.isDisplayable||(t+=er.instance.toXml(e));return t}messageHtml(t,e,i){let r="";if(i){if(e&&(r+="["+this.escapeHtml(e)+"]"),t){let s=new Date(i.timestamp);r+=("00"+s.getHours()).slice(-2)+":"+("00"+s.getMinutes()).slice(-2)+"\uff1a"}r+="<font color='",i.messColor&&(r+=i.messColor.toLowerCase()),r+="'>",r+="<b>",i.name&&(r+=this.escapeHtml(i.name)),r+="</b>",r+="\uff1a",!i.isSecret||i.isSendFromSelf?i.text&&(r+=this.escapeHtml(i.text).replace(/\n/g,"<br>")):r+="\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09";let o="";i.fixd&&(o=" (\u7de8\u96c6\u6e08)"),r+=o,r+="</font><br>",r+="\n"}return r}messageHtmlCoc(t,e){let i="";if(e){i+='    <p style="color:'+e.messColor.toLowerCase()+';">\n',i+="      <span> ["+t+"]</span>\n",i+="      <span>"+this.escapeHtml(e.name).replace("<","").replace(">","")+"</span>\n",i+="      <span>\n",i+="        ",!e.isSecret||e.isSendFromSelf?e.text&&(i+=this.escapeHtml(e.text).replace(/\n/g,"<br>").replace(/\u2192/g,"\uff1e")):i+="\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09";let r="";e.fixd&&(r=" (\u7de8\u96c6\u6e08)"),i+=r,i+="\n",i+="      </span>\n",i+="    </p>\n",i+="    \n"}return i}escapeHtml(t){return"string"!=typeof t?t:t.replace(/[&'`"<>]/g,function(i){return{"&":"&amp;","'":"&#x27;","`":"&#x60;",'"':"&quot;","<":"&lt;",">":"&gt;"}[i]}).replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g,"<ruby>$1<rt>$2</rt></ruby>").replace(/\\s/g," ")}logHtml(){let t="<?xml version='1.0' encoding='UTF-8'?>\n<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>\n<html xmlns='http://www.w3.org/1999/xhtml' lang='ja'>\n  <head>\n    <meta http-equiv='Content-Type' content='text/html; charset=UTF-8' />\n    <title>\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\uff1a"+this.escapeHtml(this.name)+"</title>\n  </head>\n  <body>\n",i="";for(let o of this.chatMessages){let s=o.to,a=o.from,g=bt.peerContext.userId;console.log("from:"+o.from+" To:"+o.to+"myId:"+g),(!s||s==g||a==g)&&(i+=this.messageHtml(!0,"",o))}return t+i+"\n  </body>\n</html>"}logHtmlCoc(){let i="";for(let o of this.chatMessages){let s=o.to,a=o.from,g=bt.peerContext.userId;console.log("from:"+o.from+" To:"+o.to+"myId:"+g),(!s||s==g||a==g)&&(i+=this.messageHtmlCoc(this.escapeHtml(this.name),o))}return'<!DOCTYPE html>\n<html lang="ja">\n  <head>\n    <meta charset="UTF-8" />\n    <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n    <meta http-equiv="X-UA-Compatible" content="ie=edge" />\n    <title>udonaliumlily - logs</title>\n  </head>\n  <body>\n   \n'+i+"  </body>\n</html>"}parseInnerXml(t){return super.parseInnerXml(t)}};var Ua;xe([lt()],Va.prototype,"name",void 0),xe([lt()],Va.prototype,"pos_num",void 0),xe([lt()],Va.prototype,"imageIdentifier",void 0),xe([lt()],Va.prototype,"imageCharactorName",void 0),xe([lt()],Va.prototype,"imageIdentifierZpos",void 0),xe([lt()],Va.prototype,"count",void 0),xe([lt()],Va.prototype,"imageIdentifierDummy",void 0),Va=xe([li("chat-tab")],Va);let Vs=Ua=class extends Si{constructor(){super(...arguments),this._systemMessageTabIndex=0,this.tachieHeightValue=200,this.minTachieSize=100,this.maxTachieSize=500,this.isTachieInWindow=!1,this.isKeepTachieOutWindow=!1,this.simpleDispFlagTime_=0,this.simpleDispFlagUserId_=0}set systemMessageTabIndex(t){this._systemMessageTabIndex=t}get systemMessageTabIndex(){return this._systemMessageTabIndex}get systemMessageTab(){return this.chatTabs.length>this.systemMessageTabIndex?this.chatTabs[this.systemMessageTabIndex]:null}get reloadCheck(){return Xe.instance.get("ReloadCheck")}static get instance(){return Ua._instance||(Ua._instance=new Ua("ChatTabList"),Ua._instance.initialize()),Ua._instance}get chatTabs(){return this.children}set simpleDispFlagTime(t){this.simpleDispFlagTime_=t}get simpleDispFlagTime(){return this.simpleDispFlagTime_}set simpleDispFlagUserId(t){this.simpleDispFlagUserId_=t}get simpleDispFlagUserId(){return this.simpleDispFlagUserId_}addChatTab(...t){let e=null;if(t[0]instanceof Va)e=t[0];else{let i=t[0];e=new Va(t[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(t){let e=!0;if(e=this.reloadCheck.answerCheck(),e){for(let r of Ua.instance.children)r.destroy();let i=Ua.instance.toContext();i.syncData=this.toContext().syncData,Ua.instance.apply(i),Ua.instance.update(),super.parseInnerXml.apply(Ua.instance,[t]),this.destroy()}}logHtml(){let i="";if(this.chatTabs){let o=this.chatTabs.length,s=[];console.log("tabNum :"+o);for(let w=0;w<o;w++)s.push(0);let a=null,g=null;for(;;){a=-1,g=-1;for(let me=0;me<o;me++)this.chatTabs[me].chatMessages.length<=s[me]||(-1==g&&(g=this.chatTabs[me].chatMessages[s[me]].timestamp,a=me),g>this.chatTabs[me].chatMessages[s[me]].timestamp&&(g=this.chatTabs[me].chatMessages[s[me]].timestamp,a=me));if(-1==a)break;let w=this.chatTabs[a].chatMessages[s[a]].to,W=this.chatTabs[a].chatMessages[s[a]].from,ve=bt.peerContext.userId;w&&w!=ve&&W!=ve?(console.log(" SKIP "+W+" > "+w+" : "+this.chatTabs[a].chatMessages[s[a]].text),s[a]++):(i+=this.chatTabs[a].messageHtml(!!this.simpleDispFlagTime,this.chatTabs[a].name,this.chatTabs[a].chatMessages[s[a]]),s[a]++)}}return"<?xml version='1.0' encoding='UTF-8'?>\n<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>\n<html xmlns='http://www.w3.org/1999/xhtml' lang='ja'>\n  <head>\n    <meta http-equiv='Content-Type' content='text/html; charset=UTF-8' />\n    <title>\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\uff1a\u5168\u30bf\u30d6</title>\n  </head>\n  <body>\n"+i+"\n  </body>\n</html>"}logHtmlCoc(){let i="";if(this.chatTabs){let o=this.chatTabs.length,s=[];console.log("tabNum :"+o);for(let w=0;w<o;w++)s.push(0);let a=null,g=null;for(;;){a=-1,g=-1;for(let me=0;me<o;me++)this.chatTabs[me].chatMessages.length<=s[me]||(-1==g&&(g=this.chatTabs[me].chatMessages[s[me]].timestamp,a=me),g>this.chatTabs[me].chatMessages[s[me]].timestamp&&(g=this.chatTabs[me].chatMessages[s[me]].timestamp,a=me));if(-1==a)break;let w=this.chatTabs[a].chatMessages[s[a]].to,W=this.chatTabs[a].chatMessages[s[a]].from,ve=bt.peerContext.userId;w&&w!=ve&&W!=ve?(console.log(" SKIP "+W+" > "+w+" : "+this.chatTabs[a].chatMessages[s[a]].text),s[a]++):(i+=this.chatTabs[a].messageHtmlCoc(this.chatTabs[a].name,this.chatTabs[a].chatMessages[s[a]]),s[a]++)}}return'<!DOCTYPE html>\n<html lang="ja">\n  <head>\n    <meta charset="UTF-8" />\n    <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n    <meta http-equiv="X-UA-Compatible" content="ie=edge" />\n    <title>udonaliumlily - logs</title>\n  </head>\n  <body>\n   \n'+i+"\n  </body>\n</html>"}};var Xo;xe([lt()],Vs.prototype,"_systemMessageTabIndex",void 0),Vs=Ua=xe([li("chat-tab-list")],Vs),function(n){n.toHalfWidth=function t(e){return e.replace(/[\uff01-\uff5e]/g,i=>String.fromCharCode(i.charCodeAt(0)-65248))}}(Xo||(Xo={}));let bl=class extends Si{constructor(){super(...arguments),this.dicebot="DiceBot",this._palettes=[],this._paletteLines=[],this._paletteVariables=[],this.isAnalized=!1}get paletteLines(){return this.isAnalized||this.parse(this.value),this._paletteLines}get paletteVariables(){return this.isAnalized||this.parse(this.value),this._paletteVariables}isPaletteIndex(t,e){let i={name:"",line:0},r=t.match(/^\/\/--[-]+(.*)$/),o=t.match(/^\u25c6(.*)$/);return r?(i.name=r[1].replace(/-+$/,""),i.line=e,i):o?(i.name=o[1],i.line=e,i):null}get paletteIndex(){let e,t=0,i=[],o=this.value.split("\n");for(let s of o)e=this.isPaletteIndex(s,t),e&&i.push(e),t++;return i}paletteMatch(t){let i=[],o=this.value.split("\n");for(let s of o)s.indexOf(t)>=0&&i.push(s);return i}paletteMatchLine(t,e){let i=0,r=0,s=this.value.split("\n");for(let a of s){if(a.indexOf(t)>=0){if(i==e)return r;i++}r++}return-1}getPalette(){return this.isAnalized||this.parse(this.value),this._palettes}setPalette(t){this.value=t,this.isAnalized=!1}checkTargetCharactor(t){let e=!!t.match(/[tT\uff54\uff34][{\uff5b]\s*([^{}\uff5b\uff5d]+)\s*[}\uff5d]/g);return t.match(/^[sS\uff53\uff33]?[tT\uff54\uff34][:\uff1a]([^:\uff1a]+)/g)&&(e=!0),t.match(/\s[sS\uff53\uff33]?[tT\uff54\uff34][:\uff1a]([^:\uff1a]+)/g)&&(e=!0),t.match(/^[tT\uff54\uff34][&\uff06]([^&\uff06]+)/g)&&(e=!0),t.match(/\s[tT\uff54\uff34][&\uff06]([^&\uff06]+)/g)&&(e=!0),console.log("\u8907\u6570\u5bfe\u8c61\u7528\u30b3\u30de\u30f3\u30c9\uff1a"+e),e}evaluate(t,e,i){let r="";r="string"==typeof t?t:t.palette,console.log(r);let s=0,a=!0;for(;a;)s++,a=!1,r=r.replace(/[tT\uff54\uff34]?[{\uff5b]\s*([^{}\uff5b\uff5d]+)\s*[}\uff5d]/g,(g,w)=>{let W=!1,ve=(w=Xo.toHalfWidth(w)).match(/(.+)([\^\uff3e]$)/);if(ve&&(w=ve[1],W=!0),a=!0,g.match(/^[tT\uff54\uff34].*/)){for(let me of i.chatPalette.paletteVariables)if(me.name==w)return me.value.replace(/[{\uff5b]/g,"t{");if(i){let me=i.rootDataElement.getFirstElementByName(w);if(me){let Se="";return Se=W&&me.isNumberResource?me.value+"":me.isNumberResource?me.currentValue+"":me.value+"",Se.match(/[{\uff5b]\s*([^{}\uff5b\uff5d]+)\s*[}\uff5d]/g)&&(Se=Se.replace(/[{\uff5b]/g,"t{")),Se}}}else{for(let me of this.paletteVariables)if(me.name==w)return me.value;if(e){let me=e.getFirstElementByName(w);if(me)return W&&me.isNumberResource?me.value+"":me.isNumberResource?me.currentValue+"":me.value+""}}return""}),128<s&&(a=!1);return r}parse(t){this._palettes=t.split("\n"),this._paletteLines=[],this._paletteVariables=[];for(let e of this._palettes){let i=this.parseVariable(e);i?this._paletteVariables.push(i):this._paletteLines.push({palette:e})}this.isAnalized=!0}parseVariable(t){let e=/^\s*[/\uff0f]{2}([^=\uff1d{}\uff5b\uff5d\s]+)\s*[=\uff1d]\s*(.+)\s*/gi.exec(t);return e?{name:Xo.toHalfWidth(e[1]),value:e[2]}:null}apply(t){super.apply(t),this.isAnalized=!1}};xe([lt()],bl.prototype,"dicebot",void 0),bl=xe([li("chat-palette")],bl);let Ip=class extends bl{};Ip=xe([li("buff-palette")],Ip);let Gm=class extends bl{};var gd;Gm=xe([li("dice-table-palette")],Gm);let st=gd=class extends Si{get isNumberResource(){return null!=this.type&&"numberResource"===this.type}get isNote(){return null!=this.type&&"note"===this.type}static create(t,e="",i={},r=""){let o;return o=r&&0<r.length?new gd(r):new gd,o.attributes=i,o.name=t,o.value=e,o.initialize(),o}getElementsByName(t){let e=[];for(let i of this.children)i instanceof gd&&(i.getAttribute("name")===t&&e.push(i),Array.prototype.push.apply(e,i.getElementsByName(t)));return e}getElementsByType(t){let e=[];for(let i of this.children)i instanceof gd&&(i.getAttribute("type")===t&&e.push(i),Array.prototype.push.apply(e,i.getElementsByType(t)));return e}getFirstElementByName(t){for(let e of this.children)if(e instanceof gd){if(e.getAttribute("name")===t)return e;let i=e.getFirstElementByName(t);if(i)return i}return null}getElementsByRegExp(t){let e=[];for(let i of this.children)i instanceof gd&&(t.test(i.getAttribute("name"))&&e.push(i),Array.prototype.push.apply(e,i.getElementsByRegExp(t)));return e}get myIdentifer(){return this.identifier}get nowValueColor(){if((this.name.match(/^[Ss\uff33\uff53][Aa\uff21\uff41][Nn\uff2en]$/i)||this.name.match(/^\u6b63\u6c17\u5ea6$/i))&&this.isNumberResource){let t=this.currentValue,e=this.value;if(t<=4*e/5&&t==this.currentValue&&e==this.value)return"#D22"}return"#444"}};xe([lt()],st.prototype,"name",void 0),xe([lt()],st.prototype,"type",void 0),xe([lt()],st.prototype,"currentValue",void 0),xe([lt()],st.prototype,"step",void 0),xe([lt()],st.prototype,"currentLineValue",void 0),xe([lt()],st.prototype,"maxLineValue",void 0),st=gd=xe([li("data")],st);let Qr=class extends Si{constructor(){super(...arguments),this.location={name:"table",x:0,y:0},this.posZ=0,this._imageFile=Bt.Empty,this._dataElements={},this.isAltitudeIndicate=!1}get isVisibleOnTable(){return"table"===this.location.name}get rootDataElement(){for(let t of this.children)if(t.getAttribute("name")===this.aliasName)return t;return null}get imageDataElement(){return this.getElement("image")}get commonDataElement(){return this.getElement("common")}get detailDataElement(){return this.getElement("detail")}get buffDataElement(){return this.getElement("buff")}addBuffDataElement(){this.buffDataElement||this.rootDataElement.appendChild(st.create("buff","",{},"buff_"+this.identifier))}get imageFile(){if(!this.imageDataElement)return this._imageFile;let t=this.imageDataElement.getFirstElementByName("imageIdentifier");if(t&&this._imageFile.identifier!==t.value){let e=St.instance.get(t.value);this._imageFile=e||Bt.Empty}return this._imageFile}get altitude(){let t=this.getElement("altitude",this.commonDataElement);!t&&this.commonDataElement&&this.commonDataElement.appendChild(st.create("altitude",0,{},"altitude_"+this.identifier));let e=t?+t.value:0;return Number.isNaN(e)?0:e}set altitude(t){let e=this.getElement("altitude",this.commonDataElement);e&&(e.value=t)}createDataElements(){this.initialize();let t=this.aliasName;if(!this.rootDataElement){let e=st.create(t,"",{},t+"_"+this.identifier);this.appendChild(e)}this.imageDataElement||(this.rootDataElement.appendChild(st.create("image","",{},"image_"+this.identifier)),this.imageDataElement.appendChild(st.create("imageIdentifier","",{type:"image"},"imageIdentifier_"+this.identifier))),this.commonDataElement||this.rootDataElement.appendChild(st.create("common","",{},"common_"+this.identifier)),this.detailDataElement||this.rootDataElement.appendChild(st.create("detail","",{},"detail_"+this.identifier)),this.buffDataElement||this.rootDataElement.appendChild(st.create("buff","",{},"buff_"+this.identifier))}getElement(t,e=this.rootDataElement){if(!e)return null;let i=this._dataElements[t]?Xe.instance.get(this._dataElements[t]):null;return(!i||!e.contains(i))&&(i=e.getFirstElementByName(t),this._dataElements[t]=i?i.identifier:null),i}getCommonValue(t,e){let i=this.getElement(t,this.commonDataElement);if(!i)return e;if("number"==typeof e){let r=+i.value;return Number.isNaN(r)?e:r}return i.value+""}setCommonValue(t,e){let i=this.getElement(t,this.commonDataElement);!i||(i.value=e)}getImageFile(t){if(!this.imageDataElement)return null;let e=this.getElement(t,this.imageDataElement);return e?St.instance.get(e.value):null}setImageFile(t,e){let i=e?this.getElement(t,this.imageDataElement):null;!i||(i.value=e.identifier)}setLocation(t){this.location.name=t,this.update()}};var ob;xe([lt()],Qr.prototype,"location",void 0),xe([lt()],Qr.prototype,"posZ",void 0),xe([lt()],Qr.prototype,"isAltitudeIndicate",void 0),Qr=xe([li("TabletopObject")],Qr);let Lt=ob=class extends Qr{constructor(t=fd.generateUuid()){super(t),this.isLock=!1,this.rotate=0,this.roll=0,this.isDropShadow=!1,this.hideInventory=!1,this.nonTalkFlag=!1,this.overViewWidth=270,this.overViewMaxHeight=250,this.specifyKomaImageFlag=!1,this.komaImageHeignt=100,this.chatColorCode=["#000000","#FF0000","#0099FF"],this.syncDummyCounter=0,this._targeted=!1,this._selectedTachieNum=0,this.isAltitudeIndicate=!0}get targeted(){return this._targeted}set targeted(t){this._targeted=t}get selectedTachieNum(){return this._selectedTachieNum>this.imageDataElement.children.length-1&&(this._selectedTachieNum=this.imageDataElement.children.length-1),this._selectedTachieNum<0&&(this._selectedTachieNum=0),this._selectedTachieNum}set selectedTachieNum(t){console.log("set selectedTachieNum NUM="+t+" len"+this.imageDataElement.children.length),t>this.imageDataElement.children.length-1&&(t=this.imageDataElement.children.length-1),t<0&&(t=0),this._selectedTachieNum=t,console.log("set selectedTachieNum"+this._selectedTachieNum)}getIconNumElement(){const t=this.detailDataElement.getFirstElementByName("ICON");return t&&t.isNumberResource?t:null}get imageFile(){if(!this.imageDataElement)return Bt.Empty;const t=this.getIconNumElement();if(t){let e=t.currentValue;return e>this.imageDataElement.children.length-1&&(e=this.imageDataElement.children.length-1),St.instance.get(this.imageDataElement.children[e].value)||Bt.Empty}{const e=this.imageDataElement.getFirstElementByName("imageIdentifier");return St.instance.get(e.value)||Bt.Empty}}get name(){return this.getCommonValue("name","")}get size(){return this.getCommonValue("size",1)}get chatPalette(){for(let t of this.children)if(t instanceof bl)return t;return null}set name(t){this.setCommonValue("name",t)}TestExec(){console.log("TestExec")}get remoteController(){for(let t of this.children)if(t instanceof Ip)return t;return null}static create(t,e,i){let r=new ob;return r.createDataElements(),r.initialize(),r.createTestGameDataElement(t,e,i),r}addExtendData(){if(this.addBuffDataElement(),0==this.detailDataElement.getElementsByName("\u7acb\u3061\u7d75\u4f4d\u7f6e").length){let r=st.create("\u7acb\u3061\u7d75\u4f4d\u7f6e","",{},"\u7acb\u3061\u7d75\u4f4d\u7f6e"+this.identifier);this.detailDataElement.appendChild(r),r.appendChild(st.create("POS",11,{type:"numberResource",currentValue:"0"},"POS_"+this.identifier))}if(0==this.detailDataElement.getElementsByName("\u30b3\u30de\u753b\u50cf").length){let r=st.create("\u30b3\u30de\u753b\u50cf","",{},"\u30b3\u30de\u753b\u50cf"+this.identifier);this.detailDataElement.appendChild(r);let o=this.detailDataElement.getElementsByName("\u7acb\u3061\u7d75\u4f4d\u7f6e");if(0!=o.length){let s=o[0].parent,a=s.children.indexOf(o[0]);if(console.log("\u7acb\u3061\u7d75\u306e\u6b21\u306b\u5dee\u3057\u8fbc\u307f INdex"+a),a<s.children.length-1){let g=s.children[a+1];console.log("\u7acb\u3061\u7d75\u306e\u6b21\u306b\u5dee\u3057\u8fbc\u307f nextElement"+g),s.insertBefore(r,g)}}r.appendChild(st.create("ICON",this.imageDataElement.children.length-1,{type:"numberResource",currentValue:0},"ICON_"+this.identifier))}if(0==this.buffDataElement.getElementsByName("\u30d0\u30d5/\u30c7\u30d0\u30d5").length){let r=st.create("\u30d0\u30d5/\u30c7\u30d0\u30d5","",{},"\u30d0\u30d5/\u30c7\u30d0\u30d5"+this.identifier);this.buffDataElement.appendChild(r)}if(null==this.remoteController){let r=new Ip("RemotController_"+this.identifier);r.setPalette("\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u5165\u529b\u4f8b\uff1a\n\u30de\u30c3\u30b9\u30eb\u30d9\u30a2\u30fc DB+2 3\n\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30ec\u30a4 A 18\n\u30bb\u30a4\u30af\u30ea\u30c3\u30c9\u30a6\u30a7\u30dd\u30f3 \u547d+1\u653b+2 18"),r.initialize(),this.appendChild(r)}}clone(){let e,t=super.clone(),i=new RegExp("^(.*)_([0-9]+)$"),r=t.name.match(i),o=0;null!=r&&3==r.length?(e=r[1],o=parseInt(r[2])+1):(e=t.name,o=2);let s=Xe.instance.getObjects(ob);for(let a of s)if("graveyard"!=a.location.name&&(r=a.name.match(i),null!=r&&3==r.length&&r[1]==e)){let g=parseInt(r[2])+1;o<=g&&(o=g)}return t.name=e+"_"+o,t.update(),t}createTestGameDataElement(t,e,i){this.createDataElements();let r=st.create("name",t,{},"name_"+this.identifier),o=st.create("size",e,{},"size_"+this.identifier),s=st.create("altitude",0,{},"altitude_"+this.identifier);this.imageDataElement.getFirstElementByName("imageIdentifier")&&(this.imageDataElement.getFirstElementByName("imageIdentifier").value=i);let a=st.create("\u30ea\u30bd\u30fc\u30b9","",{},"\u30ea\u30bd\u30fc\u30b9"+this.identifier),g=st.create("HP",200,{type:"numberResource",currentValue:"200"},"HP_"+this.identifier),w=st.create("MP",100,{type:"numberResource",currentValue:"100"},"MP_"+this.identifier);this.commonDataElement.appendChild(r),this.commonDataElement.appendChild(o),this.commonDataElement.appendChild(s),this.detailDataElement.appendChild(a),a.appendChild(g),a.appendChild(w);let W=st.create("\u60c5\u5831","",{},"\u60c5\u5831"+this.identifier);this.detailDataElement.appendChild(W),W.appendChild(st.create("\u8aac\u660e","\u3053\u3053\u306b\u8aac\u660e\u3092\u66f8\u304f\n\u3042\u3044\u3046\u3048\u304a",{type:"note"},"\u8aac\u660e"+this.identifier)),W.appendChild(st.create("\u30e1\u30e2","\u4efb\u610f\u306e\u6587\u5b57\u5217\n\uff11\n\uff12\n\uff13\n\uff14\n\uff15",{type:"note"},"\u30e1\u30e2"+this.identifier)),W=st.create("\u80fd\u529b","",{},"\u80fd\u529b"+this.identifier),this.detailDataElement.appendChild(W),W.appendChild(st.create("\u5668\u7528\u5ea6",24,{},"\u5668\u7528\u5ea6"+this.identifier)),W.appendChild(st.create("\u654f\u6377\u5ea6",24,{},"\u654f\u6377\u5ea6"+this.identifier)),W.appendChild(st.create("\u7b4b\u529b",24,{},"\u7b4b\u529b"+this.identifier)),W.appendChild(st.create("\u751f\u547d\u529b",24,{},"\u751f\u547d\u529b"+this.identifier)),W.appendChild(st.create("\u77e5\u529b",24,{},"\u77e5\u529b"+this.identifier)),W.appendChild(st.create("\u7cbe\u795e\u529b",24,{},"\u7cbe\u795e\u529b"+this.identifier)),W=st.create("\u6226\u95d8\u7279\u6280","",{},"\u6226\u95d8\u7279\u6280"+this.identifier),this.detailDataElement.appendChild(W),W.appendChild(st.create("Lv1","\u5168\u529b\u653b\u6483",{},"Lv1"+this.identifier)),W.appendChild(st.create("Lv3","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9",{},"Lv3"+this.identifier)),W.appendChild(st.create("Lv5","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9\u2161",{},"Lv5"+this.identifier)),W.appendChild(st.create("Lv7","\u9811\u5f37",{},"Lv7"+this.identifier)),W.appendChild(st.create("Lv9","\u8599\u304e\u6255\u3044",{},"Lv9"+this.identifier)),W.appendChild(st.create("\u81ea\u52d5","\u6cbb\u7652\u9069\u6b63",{},"\u81ea\u52d5"+this.identifier)),(new DOMParser).parseFromString(this.rootDataElement.toXml(),"application/xml");let Se=new bl("ChatPalette_"+this.identifier);Se.setPalette("\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u5165\u529b\u4f8b\uff1a\n2d6+1 \u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\n\uff11\uff44\uff12\uff10\uff0b{\u654f\u6377}\uff0b\uff5b\u683c\u95d8\uff5d\u3000{name}\u306e\u683c\u95d8\uff01\n\n\u81ea\u5df1\u30d0\u30d5\u3001\u30ea\u30bd\u30fc\u30b9\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\u4f8b\uff1a\n&\u30de\u30c3\u30b9\u30eb\u30d9\u30a2\u30fc/\u7b4bB+2/3\n:MP-3\n&\u30de\u30c3\u30b9\u30eb\u30d9\u30a2\u30fc/\u7b4bB+2/3:MP-3\n\n//\u654f\u6377=10+{\u654f\u6377A}\n//\u654f\u6377A=10\n//\u683c\u95d8\uff1d\uff11"),Se.initialize(),this.appendChild(Se),this.addExtendData()}createTestGameDataElementCheckTable(t,e,i){this.createDataElements();let r=st.create("name",t,{},"name_"+this.identifier),o=st.create("size",e,{},"size_"+this.identifier),s=st.create("altitude",0,{},"altitude_"+this.identifier);this.imageDataElement.getFirstElementByName("imageIdentifier")&&(this.imageDataElement.getFirstElementByName("imageIdentifier").value=i);let a=st.create("\u30ea\u30bd\u30fc\u30b9","",{},"\u30ea\u30bd\u30fc\u30b9"+this.identifier),g=st.create("HP",200,{type:"numberResource",currentValue:"200"},"HP_"+this.identifier),w=st.create("MP",100,{type:"numberResource",currentValue:"100"},"MP_"+this.identifier);this.commonDataElement.appendChild(r),this.commonDataElement.appendChild(o),this.commonDataElement.appendChild(s),this.detailDataElement.appendChild(a),a.appendChild(g),a.appendChild(w);let W=st.create("\u60c5\u5831","",{},"\u60c5\u5831"+this.identifier);this.detailDataElement.appendChild(W),W.appendChild(st.create("\u5fcd\u8853","\u30c6\u30fc\u30d6\u30eb\u8868\n|[]|[]\u5668\u8853|[]|[]\u4f53\u8853|[]|[]\u5fcd\u8853|[]|[]\u8b00\u8853|[]|[]\u6226\u8853|[]|[]\u5996\u8853||\n|\u3000|[]\u7d61\u7e70\u8853|\u3000|[]\u9a0e\u4e57\u8853|\u3000|[]\u751f\u5b58\u8853|\u3000|[]\u533b\u8853|\u3000|[]\u5175\u7ce7\u8853|\u3000|[]\u7570\u5f62\u5316|2|\n|\u3000|[]\u706b\u8853|\u3000|[]\u7832\u8853|\u3000|[]\u6f5c\u4f0f\u8853|\u3000|[]\u6bd2\u8853|\u3000|[]\u9ce5\u7363\u8853|\u3000|[]\u53ec\u559a\u8853|3|\n|\u3000|[]\u6c34\u8853|\u3000|[]\u624b\u88cf\u5263\u8853|\u3000|[]\u9041\u8d70\u8853|\u3000|[]\u7f60\u8853|\u3000|[]\u91ce\u6226\u8853|\u3000|[]\u6b7b\u970a\u8853|4|\n|\u3000|[]\u91dd\u8853|\u3000|[]\u624b\u7df4|\u3000|[]\u76d7\u8074\u8853|\u3000|[]\u8abf\u67fb\u8853|\u3000|[]\u5730\u306e\u5229|\u3000|[]\u7d50\u754c\u8853|5|\n|\u3000|[]\u4ed5\u8fbc\u307f|\u3000|[]\u8eab\u4f53\u64cd\u8853|\u3000|[]\u8179\u8a71\u8853|\u3000|[]\u8a50\u8853|\u3000|[]\u610f\u6c17|\u3000|[]\u5c01\u8853|6|\n|\u3000|[]\u8863\u88c5\u8853|\u3000|[]\u6b69\u6cd5|\u3000|[]\u96a0\u5f62\u8853|\u3000|[]\u5bfe\u4eba\u8853|\u3000|[]\u7528\u5175\u8853|\u3000|[]\u8a00\u970a\u8853|7|\n|\u3000|[]\u7e04\u8853|\u3000|[]\u8d70\u6cd5|\u3000|[]\u5909\u88c5\u8853|\u3000|[]\u904a\u82b8|\u3000|[]\u8a18\u61b6\u8853|\u3000|[]\u5e7b\u8853|8|\n|\u3000|[]\u767b\u8853|\u3000|[]\u98db\u8853|\u3000|[]\u9999\u8853|\u3000|[]\u4e5d\u30ce\u4e00\u306e\u8853|\u3000|[]\u898b\u6575\u8853|\u3000|[]\u77b3\u8853|9|\n|\u3000|[]\u62f7\u554f\u8853|\u3000|[]\u9aa8\u6cd5\u8853|\u3000|[]\u5206\u8eab\u306e\u8853|\u3000|[]\u5080\u5121\u306e\u8853|\u3000|[]\u6697\u53f7\u8853|\u3000|[]\u5343\u91cc\u773c\u306e\u8853|10|\n|\u3000|[]\u58ca\u5668\u8853|\u3000|[]\u5200\u8853|\u3000|[]\u96a0\u853d\u8853|\u3000|[]\u6d41\u8a00\u306e\u8853|\u3000|[]\u4f1d\u9054\u8853|\u3000|[]\u6191\u4f9d\u8853|11|\n|\u3000|[]\u6398\u524a\u8853|\u3000|[]\u602a\u529b|\u3000|[]\u7b2c\u516d\u611f|\u3000|[]\u7d4c\u6e08\u529b|\u3000|[]\u4eba\u8108|\u3000|[]\u546a\u8853|12|\n",{type:"markdown"},"\u5fcd\u8853"+this.identifier)),W.appendChild(st.create("\u30cd\u30af\u30ed\u30cb\u30ab\u7684\u30d1\u30fc\u30c4","|\u640d\u50b7|\u4f7f\u7528|\u30bf\u30a4\u30df\u30f3\u30b0|\u30b3\u30b9\u30c8|\u5c04\u7a0b|\u52b9\u679c|\n|[]\u3053\u3076\u3057|[]|\u30a2\u30af\u30b7\u30e7\u30f3|2|0|\u8089\u5f3e\u653b\u64831|\n|[]\u3046\u3067|[]|\u30b8\u30e3\u30c3\u30b8|1|0|\u652f\u63f41|",{type:"markdown"},"\u30cd\u30af\u30ed\u30cb\u30ab\u7684\u30d1\u30fc\u30c4"+this.identifier)),W.appendChild(st.create("\u5b9d\u7269\u3078\u306e\u4f9d\u5b58","[][][][] \u5e7c\u5150\u9000\u884c",{type:"markdown"},"\u30cd\u30af\u30ed\u30cb\u30ab\u7684\u672a\u7df4"+this.identifier)),this.overViewWidth=800,this.overViewMaxHeight=620,W=st.create("\u80fd\u529b","",{},"\u80fd\u529b"+this.identifier),this.detailDataElement.appendChild(W),W.appendChild(st.create("\u5668\u7528\u5ea6",24,{},"\u5668\u7528\u5ea6"+this.identifier)),W.appendChild(st.create("\u654f\u6377\u5ea6",24,{},"\u654f\u6377\u5ea6"+this.identifier)),W.appendChild(st.create("\u7b4b\u529b",24,{},"\u7b4b\u529b"+this.identifier)),W.appendChild(st.create("\u751f\u547d\u529b",24,{},"\u751f\u547d\u529b"+this.identifier)),W.appendChild(st.create("\u77e5\u529b",24,{},"\u77e5\u529b"+this.identifier)),W.appendChild(st.create("\u7cbe\u795e\u529b",24,{},"\u7cbe\u795e\u529b"+this.identifier)),W=st.create("\u6226\u95d8\u7279\u6280","",{},"\u6226\u95d8\u7279\u6280"+this.identifier),this.detailDataElement.appendChild(W),W.appendChild(st.create("Lv1","\u5168\u529b\u653b\u6483",{},"Lv1"+this.identifier)),W.appendChild(st.create("Lv3","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9",{},"Lv3"+this.identifier)),W.appendChild(st.create("Lv5","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9\u2161",{},"Lv5"+this.identifier)),W.appendChild(st.create("Lv7","\u9811\u5f37",{},"Lv7"+this.identifier)),W.appendChild(st.create("Lv9","\u8599\u304e\u6255\u3044",{},"Lv9"+this.identifier)),W.appendChild(st.create("\u81ea\u52d5","\u6cbb\u7652\u9069\u6b63",{},"\u81ea\u52d5"+this.identifier)),(new DOMParser).parseFromString(this.rootDataElement.toXml(),"application/xml");let Ve=new bl("ChatPalette_"+this.identifier);Ve.setPalette("\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u5165\u529b\u4f8b\uff1a\n2d6+1 \u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\n\uff11\uff44\uff12\uff10\uff0b{\u654f\u6377}\uff0b\uff5b\u683c\u95d8\uff5d\u3000{name}\u306e\u683c\u95d8\uff01\n\n\u81ea\u5df1\u30d0\u30d5\u3001\u30ea\u30bd\u30fc\u30b9\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\u4f8b\uff1a\n&\u30de\u30c3\u30b9\u30eb\u30d9\u30a2\u30fc/\u7b4bB+2/3\n:MP-3\n&\u30de\u30c3\u30b9\u30eb\u30d9\u30a2\u30fc/\u7b4bB+2/3:MP-3\n\n//\u654f\u6377=10+{\u654f\u6377A}\n//\u654f\u6377A=10\n//\u683c\u95d8\uff1d\uff11"),Ve.initialize(),this.appendChild(Ve),this.addExtendData()}createTestGameDataElementExtendSample(t,e,i){this.createDataElements();let r=st.create("name",t,{},"name_"+this.identifier),o=st.create("size",e,{},"size_"+this.identifier),s=st.create("altitude",0,{},"altitude_"+this.identifier);this.imageDataElement.getFirstElementByName("imageIdentifier")&&(this.imageDataElement.getFirstElementByName("imageIdentifier").value=i),this.commonDataElement.appendChild(r),this.commonDataElement.appendChild(o),this.commonDataElement.appendChild(s);let a=st.create("\u60c5\u5831","",{},"\u60c5\u5831"+this.identifier);this.detailDataElement.appendChild(a),a.appendChild(st.create("\u8aac\u660e","\u3053\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306f\u30ad\u30e3\u30e9\u30af\u30bf\u30fcB\u306e\u88dc\u52a9\u7528\u306e\u30b3\u30de\u3092\u4f5c\u308b\u3068\u304d\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u3059\u3002\n\u307e\u305a\u3001\u3053\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306f\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8\u306e\u8a2d\u5b9a\u3067\u300c\u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u975e\u8868\u793a\u300d\u300c\u767a\u8a00\u3092\u3057\u306a\u3044\u300d\u306e\u30c1\u30a7\u30c3\u30af\u304c\u5165\u3063\u3066\u3044\u307e\u3059\u3002\n\u3053\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u305f\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306f\u300c\u975e\u8868\u793a\u300d\u3067\u8db3\u5143\u306e\u30b5\u30fc\u30af\u30eb\u306e\u8272\u304c\u9752\u306b\u5909\u308f\u308a\u3001\u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u3084\u30ea\u30ea\u30a3\u8ffd\u52a0\u6a5f\u80fd\u306e\u30ab\u30a6\u30f3\u30bf\u30fc\u30ea\u30e2\u30b3\u30f3\u306b\u8868\u793a\u3055\u308c\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\u6226\u95d8\u975e\u53c2\u52a0\u30ad\u30e3\u30e9\u3092\u7acb\u3061\u7d75\u3084\u30b3\u30de\u306e\u305f\u3081\u306b\u30c6\u30fc\u30d6\u30eb\u306b\u51fa\u3057\u305f\u3044\u5834\u5408\u306b\u4f7f\u7528\u3067\u304d\u307e\u3059\u3002\n\u307e\u305f\u3001\u30d7\u30ed\u30d5\u7b49\u306e\u8ffd\u52a0\u60c5\u5831\u3092\u8868\u793a\u3059\u308b\u305f\u3081\u306e\u30b3\u30de\u7b49\u3001\u767a\u8a00\u304c\u4e0d\u8981\u306a\u5834\u5408\u3001\u300c\u767a\u8a00\u3092\u3057\u306a\u3044\u300d\u306e\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u308b\u3053\u3068\u3067\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u7b49\u306e\u30ea\u30b9\u30c8\u306b\u8868\u793a\u3055\u308c\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\u90e8\u4f4d\u6570\u304c10\u3042\u308b\u30e2\u30f3\u30b9\u30bf\u30fc\u306e\u99d2\u3092\u51fa\u3057\u305f\u3051\u3069\u982d\u3060\u3051\u558b\u308c\u3070\u3044\u3044\u3001\u7b49\u306e\u5834\u5408\u306b\u4f7f\u3044\u307e\u3059\u3002\u3053\u306e\u30c1\u30a7\u30c3\u30af\u3092ON\u306b\u3059\u308b\u3068\u30b3\u30de\u306e\u4e0a\u306e\u30ad\u30e3\u30e9\u540d\u304c\u767d\u5730\u306b\u9ed2\u6587\u5b57\u306b\u5909\u308f\u308a\u307e\u3059\u3002\n\u6b21\u306b\u3001\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u306e\u30b5\u30a4\u30ba\u8a2d\u5b9a\u3067\u3059\u3002\u30ea\u30ea\u30a3\u3067\u306f\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8\u304b\u3089\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u306e\u6a2a\u5e45\u3001\u6700\u5927\u7e26\u5e45\u3092\u5909\u66f4\u53ef\u80fd\u306a\u69d8\u306b\u62e1\u5f35\u3057\u3066\u3044\u307e\u3059\u3002\n\u3053\u308c\u3067\u904a\u3076\u4ef2\u9593\u304c\u8a31\u3057\u3066\u304f\u308c\u308c\u3070\u3001\u6570\u5343\u6587\u5b57\u306e\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u3092\u66f8\u3044\u3066\u3082\u5927\u4e08\u592b\u3067\u3059\u3002\n\n\u306a\u304a\u3001\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u3059\u308b\u9805\u76ee\u306e\u8a2d\u5b9a\u306f \u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\uff1e\u8a2d\u5b9a\uff1e\u8868\u793a\u9805\u76ee \u3067\u884c\u3044\u307e\u3059\u3002\n\u30ea\u30ea\u30a3\u3067\u306f\u8aac\u660e\u306e\u305f\u3081\u521d\u671f\u306e\u9805\u76ee\u306b\u60c5\u5831\u3092\u306b\u8ffd\u52a0\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u60c5\u5831\u306e\u5b50\u9805\u76ee\u306e\u3053\u306e\u6587\u7ae0\u3067\u3042\u308b\u300c\u8aac\u660e\u300d\u3068\u300c\u6301\u3061\u7269\u300d\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u3066\u3082\u6301\u3063\u3066\u3044\u306a\u3044\u9805\u76ee\u306f\u8868\u793a\u3055\u308c\u306a\u3044\u306e\u3067\u3053\u306e\u30b3\u30de\u304b\u3089\u306fHP\u3084\u80fd\u529b\u5024\u3092\u524a\u3063\u3066\u3044\u307e\u3059\u3002\n\u30b2\u30fc\u30e0\u3054\u3068\u306b\u4f7f\u3044\u3084\u3059\u3044\u3088\u3046\u306b\u4f7f\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n",{type:"note"},"\u8aac\u660e"+this.identifier)),a.appendChild(st.create("\u6301\u3061\u7269","\u3053\u3046\u3044\u3063\u305f\u6587\u7ae0\u3082\u898b\u3084\u3059\u304f\u306a\u308a\u307e\u3059\u3002\n\u30a2\u30a4\u30c6\u30e01\uff1a3\u500b\u3000\u52b9\u679c\u3007\u3007\n\u30a2\u30a4\u30c6\u30e02\uff1a3\u500b\u3000\u52b9\u679c\u30d1\u30fc\u30c6\u30a3\u5185\u4e00\u4eba\u306eHP\u3092XX\u3059\u308b\n\u30a2\u30a4\u30c6\u30e03\uff1a3\u500b\u3000\u52b9\u679c\u6575\u4e00\u4eba\u306e\u9b54\u6cd5\u3092\u25b3\u3059\u308b\n\u30a2\u30a4\u30c6\u30e04\uff1a3\u500b\u3000\u52b9\u679cA\n\u30a2\u30a4\u30c6\u30e05\uff1a3\u500b\u3000\u52b9\u679cB",{type:"note"},"\u6301\u3061\u7269"+this.identifier)),(new DOMParser).parseFromString(this.rootDataElement.toXml(),"application/xml");let W=new bl("ChatPalette_"+this.identifier);W.setPalette("\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u5165\u529b\u4f8b\uff1a\n2d6+1 \u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\n\uff11\uff44\uff12\uff10\uff0b{\u654f\u6377}\uff0b\uff5b\u683c\u95d8\uff5d\u3000{name}\u306e\u683c\u95d8\uff01\n//\u654f\u6377=10+{\u654f\u6377A}\n//\u654f\u6377A=10\n//\u683c\u95d8\uff1d\uff11"),W.initialize(),this.appendChild(W),this.addExtendData()}createTestGameDataElementLineResourceA(t,e,i){this.createDataElements(),this.overViewWidth=300,this.overViewMaxHeight=400;let r=st.create("name",t,{},"name_"+this.identifier),o=st.create("size",e,{},"size_"+this.identifier),s=st.create("altitude",0,{},"altitude_"+this.identifier);this.imageDataElement.getFirstElementByName("imageIdentifier")&&(this.imageDataElement.getFirstElementByName("imageIdentifier").value=i),this.commonDataElement.appendChild(r),this.commonDataElement.appendChild(o),this.commonDataElement.appendChild(s);let a=st.create("AP","",{},"AP"+this.identifier),g=st.create("\u30b3\u30a2AP",50,{type:"lineResource",currentValue:"50",currentLineValue:"3",maxLineValue:"3",step:"10"},"\u30b3\u30a2AP_"+this.identifier),w=st.create("\u53f3\u8155\u90e8AP",50,{type:"lineResource",currentValue:"50",currentLineValue:"2",maxLineValue:"2",step:"10"},"\u53f3\u8155\u90e8AP_"+this.identifier),W=st.create("\u5de6\u8155\u90e8AP",50,{type:"lineResource",currentValue:"50",currentLineValue:"2",maxLineValue:"2",step:"10"},"\u5de6\u8155\u90e8AP_"+this.identifier),ve=st.create("\u811a\u90e8AP",40,{type:"lineResource",currentValue:"40",currentLineValue:"3",maxLineValue:"3",step:"10"},"\u811a\u90e8AP_"+this.identifier);this.detailDataElement.appendChild(a),a.appendChild(g),a.appendChild(w),a.appendChild(W),a.appendChild(ve);let me=st.create("\u6b8b\u5f3e\u6570","",{},"\u6b8b\u5f3e\u6570"+this.identifier),Se=st.create("RA\u6b8b\u5f3e\u6570",6,{type:"lineResource",currentValue:"6",currentLineValue:"2",maxLineValue:"2"},"RA\u6b8b\u5f3e\u6570_"+this.identifier),Oe=st.create("LA\u6b8b\u5f3e\u6570",1,{type:"lineResource",currentValue:"0",currentLineValue:"0",maxLineValue:"0"},"LA\u6b8b\u5f3e\u6570_"+this.identifier),Ve=st.create("RB\u6b8b\u5f3e\u6570",4,{type:"lineResource",currentValue:"4",currentLineValue:"4",maxLineValue:"4"},"RB\u6b8b\u5f3e\u6570_"+this.identifier),We=st.create("LB\u6b8b\u5f3e\u6570",4,{type:"lineResource",currentValue:"4",currentLineValue:"2",maxLineValue:"2"},"LB\u6b8b\u5f3e\u6570_"+this.identifier);this.detailDataElement.appendChild(me),me.appendChild(Se),me.appendChild(Oe),me.appendChild(Ve),me.appendChild(We);let Ze=st.create("\u80fd\u529b","",{},"\u80fd\u529b"+this.identifier);Ze.appendChild(st.create("\u30ec\u30d9\u30eb",10,{},"\u30ec\u30d9\u30eb"+this.identifier)),Ze.appendChild(st.create("\u5bfe\u30b7\u30b9\u30c6\u30e0\u969c\u5bb3",2,{},"\u5bfe\u30b7\u30b9\u30c6\u30e0\u969c\u5bb3"+this.identifier)),Ze.appendChild(st.create("\u30b5\u30fc\u30c1",1,{},"\u30b5\u30fc\u30c1"+this.identifier)),Ze.appendChild(st.create("\u30cf\u30c3\u30ad\u30f3\u30b0",1,{},"\u30cf\u30c3\u30ad\u30f3\u30b0"+this.identifier)),Ze.appendChild(st.create("\u30de\u30cb\u30e5\u30fc\u30d0",0,{},"\u30de\u30cb\u30e5\u30fc\u30d0"+this.identifier)),Ze.appendChild(st.create("\u901a\u5e38\u79fb\u52d5\u30b3\u30b9\u30c8",3,{},"\u901a\u5e38\u79fb\u52d5\u30b3\u30b9\u30c8"+this.identifier)),Ze.appendChild(st.create("\u901a\u5e38\u56de\u907f\u30b3\u30b9\u30c8",2,{},"\u901a\u5e38\u56de\u907f\u30b3\u30b9\u30c8"+this.identifier)),this.detailDataElement.appendChild(Ze),Ze=st.create("\u30b3\u30a2\u9632\u5fa1\u6027\u80fd","",{},"\u30b3\u30a2\u9632\u5fa1\u6027\u80fd"+this.identifier),Ze.appendChild(st.create("\u30b3\u30a2\u5bfe\u5f3e\u9632\u5fa1",0,{},"\u30b3\u30a2\u5bfe\u5f3e\u9632\u5fa1"+this.identifier)),Ze.appendChild(st.create("\u30b3\u30a2\u5bfe\u7206\u9632\u5fa1",0,{},"\u30b3\u30a2\u5bfe\u7206\u9632\u5fa1"+this.identifier)),Ze.appendChild(st.create("\u30b3\u30a2\u5bfeE\u9632\u5fa1",0,{},"\u30b3\u30a2\u5bfeE\u9632\u5fa1"+this.identifier)),this.detailDataElement.appendChild(Ze),Ze=st.create("\u53f3\u8155\u90e8\u9632\u5fa1\u6027\u80fd","",{},"\u53f3\u8155\u90e8\u9632\u5fa1\u6027\u80fd"+this.identifier),Ze.appendChild(st.create("\u53f3\u8155\u90e8\u5bfe\u5f3e\u9632\u5fa1",0,{},"\u53f3\u8155\u90e8\u5bfe\u5f3e\u9632\u5fa1"+this.identifier)),Ze.appendChild(st.create("\u53f3\u8155\u90e8\u5bfe\u7206\u9632\u5fa1",0,{},"\u53f3\u8155\u90e8\u5bfe\u7206\u9632\u5fa1"+this.identifier)),Ze.appendChild(st.create("\u53f3\u8155\u90e8\u5bfeE\u9632\u5fa1",0,{},"\u53f3\u8155\u90e8\u5bfeE\u9632\u5fa1"+this.identifier)),this.detailDataElement.appendChild(Ze),Ze=st.create("\u5de6\u8155\u90e8\u9632\u5fa1\u6027\u80fd","",{},"\u5de6\u8155\u90e8\u9632\u5fa1\u6027\u80fd"+this.identifier),Ze.appendChild(st.create("\u5de6\u8155\u90e8\u5bfe\u5f3e\u9632\u5fa1",0,{},"\u5de6\u8155\u90e8\u5bfe\u5f3e\u9632\u5fa1"+this.identifier)),Ze.appendChild(st.create("\u5de6\u8155\u90e8\u5bfe\u7206\u9632\u5fa1",0,{},"\u5de6\u8155\u90e8\u5bfe\u7206\u9632\u5fa1"+this.identifier)),Ze.appendChild(st.create("\u5de6\u8155\u90e8\u5bfeE\u9632\u5fa1",0,{},"\u5de6\u8155\u90e8\u5bfeE\u9632\u5fa1"+this.identifier)),this.detailDataElement.appendChild(Ze),Ze=st.create("\u811a\u90e8\u9632\u5fa1\u6027\u80fd","",{},"\u811a\u90e8\u9632\u5fa1\u6027\u80fd"+this.identifier),Ze.appendChild(st.create("\u811a\u90e8\u5bfe\u5f3e\u9632\u5fa1",0,{},"\u811a\u90e8\u5bfe\u5f3e\u9632\u5fa1"+this.identifier)),Ze.appendChild(st.create("\u811a\u90e8\u5bfe\u7206\u9632\u5fa1",0,{},"\u811a\u90e8\u5bfe\u7206\u9632\u5fa1"+this.identifier)),Ze.appendChild(st.create("\u811a\u90e8\u5bfeE\u9632\u5fa1",0,{},"\u811a\u90e8\u5bfeE\u9632\u5fa1"+this.identifier)),this.detailDataElement.appendChild(Ze),Ze=st.create("\u30c0\u30e1\u30fc\u30b8\u8a08\u7b97","",{},"\u30c0\u30e1\u30fc\u30b8\u8a08\u7b97"+this.identifier),Ze.appendChild(st.create("\u653b\u6483\u5c5e\u6027","\u7206",{},"\u653b\u6483\u5c5e\u6027"+this.identifier)),Ze.appendChild(st.create("\u88ab\u5f3eHit\u6570",3,{},"\u88ab\u5f3eHit\u6570"+this.identifier)),Ze.appendChild(st.create("\u5a01\u529b\u88dc\u6b63",-10,{},"\u5a01\u529b\u88dc\u6b63"+this.identifier)),Ze.appendChild(st.create("AP\u640d\u5bb3",100,{type:"numberResource",currentValue:"0"},"AP\u640d\u5bb3"+this.identifier)),this.detailDataElement.appendChild(Ze),(new DOMParser).parseFromString(this.rootDataElement.toXml(),"application/xml");let ot=new bl("ChatPalette_"+this.identifier);ot.setPalette("\u25c6\u884c\u52d5\u30ea\u30b9\u30c8\n\u25c6\u3000\u79fb\u52d5\u30a2\u30af\u30b7\u30e7\u30f3\n\u3010\u901a\u5e38\u79fb\u52d5\u3011\u30b3\u30b9\u30c8\uff1a{\u901a\u5e38\u79fb\u52d5\u30b3\u30b9\u30c8}\u20e3\n\u3010\u30a2\u30b5\u30eb\u30c8\u30d6\u30fc\u30b9\u30c8\u79fb\u52d5\u3011\u30b3\u30b9\u30c8\uff1a4\u20e3\n\n\u25c6\u3000\u653b\u6483\u30a2\u30af\u30b7\u30e7\u30f3\uff08Alt+\u30af\u30ea\u30c3\u30af\u3067\u5bfe\u8c61\u3092\u9078\u629e\uff09\n\u25c6\u3000\u3000RA\n\u3010RA:\u30a2\u30b5\u30eb\u30c8\u30e9\u30a4\u30d5\u30eb\uff081Hit\uff09\u3011\\n\u30ec\u30f3\u30b8\uff1a1\u3000\u30b3\u30b9\u30c8\uff1a3\u20e3\u3000\u25c6 :RA\u6b8b\u5f3e\u6570-1\\n\u5f3e\uff5c\u30b9\u30ca\u30a4\u30d7\u30001 Hit\u3000\u5a01\u529b\u88dc\u6b63\uff1a+5\\n\u3000&RA\u30ea\u30ed\u30fc\u30c9/\u3053\u306e\u30bf\u30fc\u30f3RA\u4f7f\u7528\u4e0d\u53ef/1\n\u3000\u3010\u30d2\u30c3\u30c8\u30ec\u30fc\u30c8\u4ed8\u4e0e\u3011t:\u653b\u6483\u5c5e\u6027>\u5f3e t:\u88ab\u5f3eHit\u6570=1 t:\u5a01\u529b\u88dc\u6b63=5\n\u3010RA:\u30a2\u30b5\u30eb\u30c8\u30e9\u30a4\u30d5\u30eb\uff082Hit\uff09\u3011\\n\u30ec\u30f3\u30b8\uff1a1\u3000\u30b3\u30b9\u30c8\uff1a3\u20e34\u20e3\u3000\u25c6\u25c6 :RA\u6b8b\u5f3e\u6570-2\\n\u5f3e\uff5c\u30b9\u30ca\u30a4\u30d7\u30002 Hit\u3000\u5a01\u529b\u88dc\u6b63\uff1a+5\\n\u3000&RA\u30ea\u30ed\u30fc\u30c9/\u3053\u306e\u30bf\u30fc\u30f3RA\u4f7f\u7528\u4e0d\u53ef/1\n\u3000\u3010\u30d2\u30c3\u30c8\u30ec\u30fc\u30c8\u4ed8\u4e0e\u3011t:\u653b\u6483\u5c5e\u6027>\u5f3e t:\u88ab\u5f3eHit\u6570=2 t:\u5a01\u529b\u88dc\u6b63=5\n\u3010RA:\u30a2\u30b5\u30eb\u30c8\u30e9\u30a4\u30d5\u30eb\uff083Hit\uff09\u3011\\n\u30ec\u30f3\u30b8\uff1a1\u3000\u30b3\u30b9\u30c8\uff1a3\u20e34\u20e35\u20e3\u3000\u25c6\u25c6\u25c6 :RA\u6b8b\u5f3e\u6570-3\\n\u5f3e\uff5c\u30b9\u30ca\u30a4\u30d7\u30003 Hit\u3000\u5a01\u529b\u88dc\u6b63\uff1a+5\\n\u3000&RA\u30ea\u30ed\u30fc\u30c9/\u3053\u306e\u30bf\u30fc\u30f3RA\u4f7f\u7528\u4e0d\u53ef/1\n\u3000\u3010\u30d2\u30c3\u30c8\u30ec\u30fc\u30c8\u4ed8\u4e0e\u3011t:\u653b\u6483\u5c5e\u6027>\u5f3e t:\u88ab\u5f3eHit\u6570=3 t:\u5a01\u529b\u88dc\u6b63=5 \n\n\u25c6\u3000\u3000LA\n\u3010LA:\u30d1\u30eb\u30b9\u30d6\u30ec\u30fc\u30c9\uff081Hit\uff09\u3011\\n\u30ec\u30f3\u30b8\uff1a0\u3000\u30b3\u30b9\u30c8\uff1a\u30be\u30ed2\\nE\uff5c\u30e1\u30ec\u30fc\u30001 Hit\u3000\u5a01\u529b\u88dc\u6b63\uff1a0\\n\u3000&LA\u30ea\u30ed\u30fc\u30c9/\u3053\u306e\u30bf\u30fc\u30f3LA\u4f7f\u7528\u4e0d\u53ef/1\n\u3000\u3010\u30d2\u30c3\u30c8\u30ec\u30fc\u30c8\u4ed8\u4e0e\u3011t:\u653b\u6483\u5c5e\u6027>E t:\u88ab\u5f3eHit\u6570=1 t:\u5a01\u529b\u88dc\u6b63=0\n\u3010LA:\u30d1\u30eb\u30b9\u30d6\u30ec\u30fc\u30c9\uff082Hit\uff09\u3011\\n\u30ec\u30f3\u30b8\uff1a0\u3000\u30b3\u30b9\u30c8\uff1a\u30be\u30ed3\\nE\uff5c\u30e1\u30ec\u30fc\u30002 Hit\u3000\u5a01\u529b\u88dc\u6b63\uff1a0\\n\u3000&LA\u30ea\u30ed\u30fc\u30c9/\u3053\u306e\u30bf\u30fc\u30f3LA\u4f7f\u7528\u4e0d\u53ef/1\n\u3000\u3010\u30d2\u30c3\u30c8\u30ec\u30fc\u30c8\u4ed8\u4e0e\u3011t:\u653b\u6483\u5c5e\u6027>E t:\u88ab\u5f3eHit\u6570=2 t:\u5a01\u529b\u88dc\u6b63=0\n\n\u25c6\u3000\u3000RB\n\u3010RB:4\u9023\u88c5\u30df\u30b5\u30a4\u30eb\u3011\\n\u30ec\u30f3\u30b8\uff1a2\u3000\u30b3\u30b9\u30c8\uff1a7\u20e3\u3000\u25c6\u25c6 :RB\u6b8b\u5f3e\u6570-2\\n\u7206\uff5c\u30df\u30b5\u30a4\u30eb\u30002 Hit\u3000\u5a01\u529b\u88dc\u6b63\uff1a+5\\n\u3000&RB\u30ea\u30ed\u30fc\u30c9/\u3053\u306e\u30bf\u30fc\u30f3RB\u4f7f\u7528\u4e0d\u53ef/1\n\u3000\u3010\u30d2\u30c3\u30c8\u30ec\u30fc\u30c8\u4ed8\u4e0e\u3011t:\u653b\u6483\u5c5e\u6027>\u7206 t:\u88ab\u5f3eHit\u6570=2 t:\u5a01\u529b\u88dc\u6b63=5\n\n\u25c6\u3000\u3000LB\n\u3010LB:\u5c0f\u578b2\u9023\u53cc\u5bfe\u30df\u30b5\u30a4\u30eb\uff08\u30ec\u30f3\u30b81\uff09\u3011\\n\u30ec\u30f3\u30b8\uff1a1\u3000\u30b3\u30b9\u30c8\uff1a7\u20e3\u3000\u25c6\u25c6 :RB\u6b8b\u5f3e\u6570-2\\n\u7206\uff5c\u30df\u30b5\u30a4\u30eb\u30002 Hit\u3000\u5a01\u529b\u88dc\u6b63\uff1a+5\\n\u3000&LB\u30ea\u30ed\u30fc\u30c9/\u3053\u306e\u30bf\u30fc\u30f3LB\u4f7f\u7528\u4e0d\u53ef/1\n\u3000\u3010\u30d2\u30c3\u30c8\u30ec\u30fc\u30c8\u4ed8\u4e0e\u3011t:\u653b\u6483\u5c5e\u6027>\u7206 t:\u88ab\u5f3eHit\u6570=2 t:\u5a01\u529b\u88dc\u6b63=5\n\u3010LB:\u5c0f\u578b2\u9023\u53cc\u5bfe\u30df\u30b5\u30a4\u30eb\uff08\u30ec\u30f3\u30b82\uff09\u3011\\n\u30ec\u30f3\u30b8\uff1a2\u3000\u30b3\u30b9\u30c8\uff1a8\u20e3\u3000\u25c6\u25c6 :RB\u6b8b\u5f3e\u6570-2\\n\u7206\uff5c\u30df\u30b5\u30a4\u30eb\u30002 Hit\u3000\u5a01\u529b\u88dc\u6b63\uff1a+5\\n\u3000&LB\u30ea\u30ed\u30fc\u30c9/\u3053\u306e\u30bf\u30fc\u30f3LB\u4f7f\u7528\u4e0d\u53ef/1\n\u3000\u3010\u30d2\u30c3\u30c8\u30ec\u30fc\u30c8\u4ed8\u4e0e\u3011t:\u653b\u6483\u5c5e\u6027>\u7206 t:\u88ab\u5f3eHit\u6570=2 t:\u5a01\u529b\u88dc\u6b63=5\n\n\n\n\u25c6\u88ab\u653b\u6483\u51e6\u7406\n\uff11\uff0e\u76f8\u624b\u306e\u30d2\u30c3\u30c8\u30ec\u30fc\u30c8\u4ed8\u4e0e\u5f8c\u3001\u4efb\u610f\u56de\u6570\u306e\u56de\u907f\u3092\u884c\u3046\n\u3010\u901a\u5e38\u56de\u907f\u3011\u30b3\u30b9\u30c8\uff1a{\u901a\u5e38\u56de\u907f\u30b3\u30b9\u30c8}\u20e3 :\u88ab\u5f3eHit\u6570-1\n\u3010\u30af\u30a4\u30c3\u30af\u30d6\u30fc\u30b9\u30c8\u56de\u907f\u3011\u30b3\u30b9\u30c8\uff1a1\u20e31\u20e3 :\u88ab\u5f3eHit\u6570-2\n\n\uff12\uff0e\u305d\u308c\u4ee5\u4e0a\u56de\u907f\u3092\u884c\u308f\u306a\u3044\u5834\u5408\u3001AP\u640d\u5bb3\u3092\u8a08\u7b97\u3059\u308b\n\u3010AP\u640d\u5bb3\u8a08\u7b97\u3011 :AP\u640d\u5bb3=({\u88ab\u5f3eHit\u6570}+({\u5a01\u529b\u88dc\u6b63})/10U)*10-10L :AP\u640d\u5bb3+10\n\n\uff13\uff0e\u88ab\u5f3e\u3059\u308b\u90e8\u4f4d\u3092\u30e9\u30f3\u30c0\u30e0\u306b\u6c7a\u5b9a\u3059\u308b\u3002\nchoice[1: \u30b3\u30a2, 2: \u30b3\u30a2, 3: \u53f3\u8155\u90e8, 4: \u5de6\u8155\u90e8, 5: \u811a\u90e8, 6: \u811a\u90e8]\\n\u3010\u88ab\u5f3e\u90e8\u4f4d\u6c7a\u5b9a\u3011\n\n\uff14\uff0e\u88ab\u5f3e\u90e8\u4f4d\u306eAP\u3092\u6e1b\u5c11\u3059\u308b\n\u3010\u30b3\u30a2AP\u640d\u5bb3\u3011 :\u30b3\u30a2AP-({AP\u640d\u5bb3}-{\u30b3\u30a2\u5bfe{\u653b\u6483\u5c5e\u6027}\u9632\u5fa1})Z\n\u3010\u53f3\u8155\u90e8AP\u640d\u5bb3\u3011 :\u53f3\u8155\u90e8AP-({AP\u640d\u5bb3}-{\u53f3\u8155\u90e8\u5bfe{\u653b\u6483\u5c5e\u6027}\u9632\u5fa1})Z\n\u3010\u5de6\u8155\u90e8AP\u640d\u5bb3\u3011 :\u5de6\u8155\u90e8AP-({AP\u640d\u5bb3}-{\u5de6\u8155\u90e8\u5bfe{\u653b\u6483\u5c5e\u6027}\u9632\u5fa1})Z\n\u3010PA_AP\u640d\u5bb3\u3011 :\u811a\u90e8AP-({AP\u640d\u5bb3}-{\u811a\u90e8\u5bfe{\u653b\u6483\u5c5e\u6027}\u9632\u5fa1})Z\n\n\uff15\uff0eAP\u640d\u5bb3\u306b\u3088\u308aLine\u3092\u5168\u640d\u3057\u305f\u5834\u5408\u3001\u65e2\u5b9a\u306e\u51e6\u7406\u3092\u884c\u3046\n&\u30b9\u30bf\u30c3\u30ac\u30fc/\u30b3\u30a2\u76f4\u6483+\u884c\u52d5\u4e0d\u53ef/1"),ot.initialize(),this.appendChild(ot);let ft=new Ip("BuffPalette_"+this.identifier);ft.setPalette("\u30ab\u30e1\u30e9\u969c\u5bb3 \u30df\u30b5\u30a4\u30eb\u7cfb\u30a2\u30bf\u30c3\u30af\u4e0d\u53ef 1\nACS\u969c\u5bb3 AP\u640d\u5bb310\u3067\u30b9\u30bf\u30c3\u30ac\u30fc 1\n\u30b9\u30bf\u30c3\u30ac\u30fc \u30b3\u30a2\u76f4\u6483+\u884c\u52d5\u4e0d\u53ef 1\n\u30b3\u30a2\u76f4\u6483 \u30b3\u30a2\u78ba\u5b9aHit+\u9632\u5fa1\u7121\u8996 1"),ft.initialize(),this.appendChild(ft),this.addExtendData()}createTestGameDataElementLineResourceB(t,e,i){this.createDataElements(),this.overViewWidth=300;let r=st.create("name",t,{},"name_"+this.identifier),o=st.create("size",e,{},"size_"+this.identifier),s=st.create("altitude",0,{},"altitude_"+this.identifier);this.imageDataElement.getFirstElementByName("imageIdentifier")&&(this.imageDataElement.getFirstElementByName("imageIdentifier").value=i),this.commonDataElement.appendChild(r),this.commonDataElement.appendChild(o),this.commonDataElement.appendChild(s);let a=st.create("AP","",{},"AP"+this.identifier),g=st.create("\u30b3\u30a2AP",70,{type:"lineResource",currentValue:"70",currentLineValue:"3",maxLineValue:"3",step:"10"},"\u30b3\u30a2AP_"+this.identifier),w=st.create("\u53f3\uff8c\uff9a\uff70\uff91AP",50,{type:"lineResource",currentValue:"50",currentLineValue:"2",maxLineValue:"2",step:"10"},"\u53f3\uff8c\uff9a\uff70\uff91AP_"+this.identifier),W=st.create("\u5de6\uff8c\uff9a\uff70\uff91AP",50,{type:"lineResource",currentValue:"50",currentLineValue:"2",maxLineValue:"2",step:"10"},"\u5de6\uff8c\uff9a\uff70\uff91AP_"+this.identifier),ve=st.create("PA_AP",60,{type:"lineResource",currentValue:"60",currentLineValue:"1",maxLineValue:"1",step:"10"},"PA_AP_"+this.identifier);this.detailDataElement.appendChild(a),a.appendChild(g),a.appendChild(w),a.appendChild(W),a.appendChild(ve);let me=st.create("\u80fd\u529b","",{},"\u80fd\u529b"+this.identifier);me.appendChild(st.create("\u30ec\u30d9\u30eb",20,{},"\u30ec\u30d9\u30eb"+this.identifier)),me.appendChild(st.create("\u89e3\u6790\u76ee\u6a19\u5024",11,{},"\u89e3\u6790\u76ee\u6a19\u5024"+this.identifier)),me.appendChild(st.create("\u5bfe\u30b7\u30b9\u30c6\u30e0\u969c\u5bb3\u5024",11,{},"\u5bfe\u30b7\u30b9\u30c6\u30e0\u969c\u5bb3\u5024"+this.identifier)),this.detailDataElement.appendChild(me),me=st.create("\u30b3\u30a2\u9632\u5fa1\u6027\u80fd","",{},"\u30b3\u30a2\u9632\u5fa1\u6027\u80fd"+this.identifier),me.appendChild(st.create("\u30b3\u30a2\u5bfe\u5f3e\u9632\u5fa1",10,{},"\u30b3\u30a2\u5bfe\u5f3e\u9632\u5fa1"+this.identifier)),me.appendChild(st.create("\u30b3\u30a2\u5bfe\u7206\u9632\u5fa1",10,{},"\u30b3\u30a2\u5bfe\u7206\u9632\u5fa1"+this.identifier)),me.appendChild(st.create("\u30b3\u30a2\u5bfeE\u9632\u5fa1",0,{},"\u30b3\u30a2\u5bfeE\u9632\u5fa1"+this.identifier)),this.detailDataElement.appendChild(me),me=st.create("\u53f3\uff8c\uff9a\uff70\uff91\u9632\u5fa1\u6027\u80fd","",{},"\u53f3\uff8c\uff9a\uff70\uff91\u9632\u5fa1\u6027\u80fd"+this.identifier),me.appendChild(st.create("\u53f3\uff8c\uff9a\uff70\uff91\u5bfe\u5f3e\u9632\u5fa1",10,{},"\u53f3\uff8c\uff9a\uff70\uff91\u5bfe\u5f3e\u9632\u5fa1"+this.identifier)),me.appendChild(st.create("\u53f3\uff8c\uff9a\uff70\uff91\u5bfe\u7206\u9632\u5fa1",10,{},"\u53f3\uff8c\uff9a\uff70\uff91\u5bfe\u7206\u9632\u5fa1"+this.identifier)),me.appendChild(st.create("\u53f3\uff8c\uff9a\uff70\uff91\u5bfeE\u9632\u5fa1",0,{},"\u53f3\uff8c\uff9a\uff70\uff91\u5bfeE\u9632\u5fa1"+this.identifier)),this.detailDataElement.appendChild(me),me=st.create("\u5de6\uff8c\uff9a\uff70\uff91\u9632\u5fa1\u6027\u80fd","",{},"\u5de6\uff8c\uff9a\uff70\uff91\u9632\u5fa1\u6027\u80fd"+this.identifier),me.appendChild(st.create("\u5de6\uff8c\uff9a\uff70\uff91\u5bfe\u5f3e\u9632\u5fa1",10,{},"\u5de6\uff8c\uff9a\uff70\uff91\u5bfe\u5f3e\u9632\u5fa1"+this.identifier)),me.appendChild(st.create("\u5de6\uff8c\uff9a\uff70\uff91\u5bfe\u7206\u9632\u5fa1",10,{},"\u5de6\uff8c\uff9a\uff70\uff91\u5bfe\u7206\u9632\u5fa1"+this.identifier)),me.appendChild(st.create("\u5de6\uff8c\uff9a\uff70\uff91\u5bfeE\u9632\u5fa1",0,{},"\u5de6\uff8c\uff9a\uff70\uff91\u5bfeE\u9632\u5fa1"+this.identifier)),this.detailDataElement.appendChild(me),me=st.create("PA\u9632\u5fa1\u6027\u80fd","",{},"PA\u9632\u5fa1\u6027\u80fd"+this.identifier),me.appendChild(st.create("PA\u5bfe\u5f3e\u9632\u5fa1",10,{},"PA\u5bfe\u5f3e\u9632\u5fa1"+this.identifier)),me.appendChild(st.create("PA\u5bfe\u7206\u9632\u5fa1",10,{},"PA\u5bfe\u7206\u9632\u5fa1"+this.identifier)),me.appendChild(st.create("PA\u5bfeE\u9632\u5fa1",10,{},"PA\u5bfeE\u9632\u5fa1"+this.identifier)),this.detailDataElement.appendChild(me),me=st.create("\u30c0\u30e1\u30fc\u30b8\u8a08\u7b97","",{},"\u30c0\u30e1\u30fc\u30b8\u8a08\u7b97"+this.identifier),me.appendChild(st.create("\u653b\u6483\u5c5e\u6027","\u7206",{},"\u653b\u6483\u5c5e\u6027"+this.identifier)),me.appendChild(st.create("\u88ab\u5f3eHit\u6570",3,{},"\u88ab\u5f3eHit\u6570"+this.identifier)),me.appendChild(st.create("\u5a01\u529b\u88dc\u6b63",-10,{},"\u5a01\u529b\u88dc\u6b63"+this.identifier)),me.appendChild(st.create("AP\u640d\u5bb3",100,{type:"numberResource",currentValue:"0"},"AP\u640d\u5bb3"+this.identifier)),this.detailDataElement.appendChild(me),(new DOMParser).parseFromString(this.rootDataElement.toXml(),"application/xml");let Ve=new bl("ChatPalette_"+this.identifier);Ve.setPalette("\u25c6\u884c\u52d5\u30ea\u30b9\u30c8\n\u3010\u767e\u4e94\u5341\u516d\u9023\u88c5\u30df\u30b5\u30a4\u30eb\uff08\u2191KQJ\uff09\u3011\\n\u30ec\u30f3\u30b8\uff1a1-2\u3000\u5bfe\u8c61\uff1aALL\\n\u7206\uff5c\u30df\u30b5\u30a4\u30eb\u30002 Hit\u3000\u5a01\u529b\u88dc\u6b63\uff1a-10\n\u3000\u3010\u30d2\u30c3\u30c8\u30ec\u30fc\u30c8\u4ed8\u4e0e\u3011t:\u653b\u6483\u5c5e\u6027>\u7206 t:\u88ab\u5f3eHit\u6570=2 t:\u5a01\u529b\u88dc\u6b63=-10\n\u3010\u767e\u4e94\u5341\u516d\u9023\u88c5\u30df\u30b5\u30a4\u30eb\uff0810~6\uff09\u3011\\n\u30ec\u30f3\u30b8\uff1a1-2\u3000\u5bfe\u8c61\uff1aALL\\n\u7206\uff5c\u30df\u30b5\u30a4\u30eb\u30003 Hit\u3000\u5a01\u529b\u88dc\u6b63\uff1a-10\n\u3000\u3010\u30d2\u30c3\u30c8\u30ec\u30fc\u30c8\u4ed8\u4e0e\u3011t:\u653b\u6483\u5c5e\u6027>\u7206 t:\u88ab\u5f3eHit\u6570=3 t:\u5a01\u529b\u88dc\u6b63=-10\n\u3010\u767e\u4e94\u5341\u516d\u9023\u88c5\u30df\u30b5\u30a4\u30eb\uff085~A\u2193\uff09\u3011\\n\u30ec\u30f3\u30b8\uff1a1-2\u3000\u5bfe\u8c61\uff1aALL\\n\u7206\uff5c\u30df\u30b5\u30a4\u30eb\u30004 Hit\u3000\u5a01\u529b\u88dc\u6b63\uff1a-10\n\u3000\u3010\u30d2\u30c3\u30c8\u30ec\u30fc\u30c8\u4ed8\u4e0e\u3011t:\u653b\u6483\u5c5e\u6027>\u7206 t:\u88ab\u5f3eHit\u6570=4 t:\u5a01\u529b\u88dc\u6b63=-10\n\n\u3010\u4e09\u9023\u30ac\u30c8\u30ea\u30f3\u30b0\uff08\u2191KQJ\uff09\u3011\\n\u30ec\u30f3\u30b8\uff1a1\u3000\u5bfe\u8c61\uff1a1\\n\u5f3e\uff5c\u30ac\u30c8\u30ea\u30f3\u30b0\u30002 Hit\u3000\u5a01\u529b\u88dc\u6b63\uff1a+10\n\u3000\u3010\u30d2\u30c3\u30c8\u30ec\u30fc\u30c8\u4ed8\u4e0e\u3011t:\u653b\u6483\u5c5e\u6027>\u5f3e t:\u88ab\u5f3eHit\u6570=2 t:\u5a01\u529b\u88dc\u6b63=10\n\u3010\u4e09\u9023\u30ac\u30c8\u30ea\u30f3\u30b0\uff0810~6\uff09\u3011\\n\u30ec\u30f3\u30b8\uff1a1\u3000\u5bfe\u8c61\uff1a1\\n\u5f3e\uff5c\u30ac\u30c8\u30ea\u30f3\u30b0\u30003 Hit\u3000\u5a01\u529b\u88dc\u6b63\uff1a+10\n\u3000\u3010\u30d2\u30c3\u30c8\u30ec\u30fc\u30c8\u4ed8\u4e0e\u3011t:\u653b\u6483\u5c5e\u6027>\u5f3e t:\u88ab\u5f3eHit\u6570=3 t:\u5a01\u529b\u88dc\u6b63=10\n\u3010\u4e09\u9023\u30ac\u30c8\u30ea\u30f3\u30b0\uff085~A\u2193\uff09\u3011\\n\u30ec\u30f3\u30b8\uff1a1\u3000\u5bfe\u8c61\uff1a1\\n\u5f3e\uff5c\u30ac\u30c8\u30ea\u30f3\u30b0\u30004 Hit\u3000\u5a01\u529b\u88dc\u6b63\uff1a+10\n\u3000\u3010\u30d2\u30c3\u30c8\u30ec\u30fc\u30c8\u4ed8\u4e0e\u3011t:\u653b\u6483\u5c5e\u6027>\u5f3e t:\u88ab\u5f3eHit\u6570=4 t:\u5a01\u529b\u88dc\u6b63=10\n\n\u3010\u56db\u9023\u30b7\u30e7\u30c3\u30c8\u30ac\u30f3\uff08\u2191KQJ\uff09\u3011\\n\u30ec\u30f3\u30b8\uff1a0\u3000\u5bfe\u8c61\uff1a1\u4f53\\n\u5f3e\uff5c\u30b9\u30d7\u30ec\u30c3\u30c9\u30001 Hit\u3000\u5a01\u529b\u88dc\u6b63\uff1a+10\n\u3000\u3010\u30d2\u30c3\u30c8\u30ec\u30fc\u30c8\u4ed8\u4e0e\u3011t:\u653b\u6483\u5c5e\u6027>\u5f3e t:\u88ab\u5f3eHit\u6570=1 t:\u5a01\u529b\u88dc\u6b63=10\n\u3010\u56db\u9023\u30b7\u30e7\u30c3\u30c8\u30ac\u30f3\uff0810~A\u2193\uff09\u3011\\n\u30ec\u30f3\u30b8\uff1a0\u3000\u5bfe\u8c61\uff1a1\u4f53\\n\u5f3e\uff5c\u30b9\u30d7\u30ec\u30c3\u30c9\u30002 Hit\u3000\u5a01\u529b\u88dc\u6b63\uff1a+10\n\u3000\u3010\u30d2\u30c3\u30c8\u30ec\u30fc\u30c8\u4ed8\u4e0e\u3011t:\u653b\u6483\u5c5e\u6027>\u5f3e t:\u88ab\u5f3eHit\u6570=2 t:\u5a01\u529b\u88dc\u6b63=10\n\n\u3010\u53ef\u5909\u5f0f\u8d85\u9ad8\u6e29\u30d0\u30fc\u30ca\u30fc\uff08\u2191K~A\u2193\uff09\u3011\\n\u30ec\u30f3\u30b8\uff1a0-1\u3000\u5bfe\u8c61\uff1a1\u30a8\u30ea\u30a2\\n\u5f3e\uff5c\u30e1\u30ec\u30fc\u30002 Hit\u3000\u5a01\u529b\u88dc\u6b63\uff1a0\n\u3000\u3010\u30d2\u30c3\u30c8\u30ec\u30fc\u30c8\u4ed8\u4e0e\u3011t:\u653b\u6483\u5c5e\u6027>\u5f3e t:\u88ab\u5f3eHit\u6570=2 t:\u5a01\u529b\u88dc\u6b63=0\n\n\u3010\u30d1\u30eb\u30b9\u30a2\u30fc\u30de\u30fc\u518d\u5c55\u958b\u3011 :PA_AP={PA_AP^} :PA_AP~={PA_AP~^}\n\n\n\n\u25c6\u88ab\u653b\u6483\u51e6\u7406\n\uff11\uff0e\u76f8\u624b\u306e\u30d2\u30c3\u30c8\u30ec\u30fc\u30c8\u4ed8\u4e0e\u5f8c\u3001\u4efb\u610f\u56de\u6570\u306e\u56de\u907f\u3092\u884c\u3046\n\u3010\u56de\u907f\u3011 :\u88ab\u5f3eHit\u6570-1\n\n\uff12\uff0e\u305d\u308c\u4ee5\u4e0a\u56de\u907f\u3092\u884c\u308f\u306a\u3044\u5834\u5408\u3001AP\u640d\u5bb3\u3092\u8a08\u7b97\u3059\u308b\n\u3010AP\u640d\u5bb3\u8a08\u7b97\u3011 :AP\u640d\u5bb3=({\u88ab\u5f3eHit\u6570}+({\u5a01\u529b\u88dc\u6b63})/10U)*10-10L :AP\u640d\u5bb3+10\n\n\uff13\uff0e\u88ab\u5f3e\u3059\u308b\u90e8\u4f4d\u3092\u30e9\u30f3\u30c0\u30e0\u306b\u6c7a\u5b9a\u3059\u308b\u3002\uff08\u88ab\u5f3e\u90e8\u4f4d\u6c7a\u5b9a\u306b\u5225\u306e\u6761\u4ef6\u304c\u3042\u308b\u5834\u5408\u30b9\u30ad\u30c3\u30d7\uff09\nchoice[1: \u30b3\u30a2, 2: \u30b3\u30a2, 3: \u53f3\uff8c\uff9a\uff70\uff91, 4: \u53f3\uff8c\uff9a\uff70\uff91, 5: \u5de6\uff8c\uff9a\uff70\uff91, 6: \u5de6\uff8c\uff9a\uff70\uff91]\\n\u3010\u88ab\u5f3e\u90e8\u4f4d\u6c7a\u5b9a\u3011\n\n\uff14\uff0e\u88ab\u5f3e\u90e8\u4f4d\u306eAP\u3092\u6e1b\u5c11\u3059\u308b\n\u3010\u30b3\u30a2AP\u640d\u5bb3\u3011 :\u30b3\u30a2AP-({AP\u640d\u5bb3}-{\u30b3\u30a2\u5bfe{\u653b\u6483\u5c5e\u6027}\u9632\u5fa1})Z\n\u3010\u53f3\uff8c\uff9a\uff70\uff91AP\u640d\u5bb3\u3011 :\u53f3\uff8c\uff9a\uff70\uff91AP-({AP\u640d\u5bb3}-{\u53f3\uff8c\uff9a\uff70\uff91\u5bfe{\u653b\u6483\u5c5e\u6027}\u9632\u5fa1})Z\n\u3010\u5de6\uff8c\uff9a\uff70\uff91AP\u640d\u5bb3\u3011 :\u5de6\uff8c\uff9a\uff70\uff91AP-({AP\u640d\u5bb3}-{\u5de6\uff8c\uff9a\uff70\uff91\u5bfe{\u653b\u6483\u5c5e\u6027}\u9632\u5fa1})Z\n\u3010PA_AP\u640d\u5bb3\u3011 :PA_AP-({AP\u640d\u5bb3}-{PA\u5bfe{\u653b\u6483\u5c5e\u6027}\u9632\u5fa1})Z\n\n\uff15\uff0eAP\u640d\u5bb3\u306b\u3088\u308aLine\u3092\u5168\u640d\u3057\u305f\u5834\u5408\u3001\u65e2\u5b9a\u306e\u51e6\u7406\u3092\u884c\u3046\n\u3010\u30d1\u30eb\u30b9\u30a2\u30fc\u30de\u30fc\u6d88\u5931\u3011 &\u30b9\u30bf\u30c3\u30ac\u30fc/\u30b3\u30a2\u76f4\u6483+\u884c\u52d5\u4e0d\u53ef/1:PA_AP=0 :PA_AP~=0\n&\u30b9\u30bf\u30c3\u30ac\u30fc/\u30b3\u30a2\u76f4\u6483+\u884c\u52d5\u4e0d\u53ef/1"),Ve.initialize(),this.appendChild(Ve);let We=new Ip("BuffPalette_"+this.identifier);We.setPalette("\u30ab\u30e1\u30e9\u969c\u5bb3 \u30df\u30b5\u30a4\u30eb\u7cfb\u30a2\u30bf\u30c3\u30af\u4e0d\u53ef 1\nACS\u969c\u5bb3 AP\u640d\u5bb310\u3067\u30b9\u30bf\u30c3\u30ac\u30fc 1\n\u30b9\u30bf\u30c3\u30ac\u30fc \u30b3\u30a2\u76f4\u6483+\u884c\u52d5\u4e0d\u53ef 1\n\u30b3\u30a2\u76f4\u6483 \u30b3\u30a2\u78ba\u5b9aHit+\u9632\u5fa1\u7121\u8996 1"),We.initialize(),this.appendChild(We),this.addExtendData()}deleteBuff(t){if(this.buffDataElement.children){const i=this.buffDataElement.children[0].getFirstElementByName(t);return!!i&&(i.destroy(),!0)}return!1}decreaseBuffRound(){if(this.buffDataElement.children){const t=this.buffDataElement.children[0];for(const e of t.children){let r,i="";i=e.value,r=parseInt(i),r-=1,e.value=r}}}increaseBuffRound(){if(this.buffDataElement.children){const t=this.buffDataElement.children[0];for(const e of t.children){let r,i="";i=e.value,r=parseInt(i),r+=1,e.value=r}}}deleteZeroRoundBuff(){if(this.buffDataElement.children){const t=this.buffDataElement.children[0];for(const e of t.children){let r,i="";i=e.value,r=parseInt(i),r<=0&&e.destroy()}}}addBuffRound(t,e,i){let r="",o=3;if(e&&(r=e),null!=i&&(o=i),this.buffDataElement.children){let s=this.buffDataElement.children[0],a=this.buffDataElement.getFirstElementByName(t);a?(a.value=o,a.currentValue=r):s.appendChild(st.create(t,o,{type:"numberResource",currentValue:r}))}}chkChangeStatusName(t){const e=this.detailDataElement.getFirstElementByName(t);return!!e&&("numberResource"==e.type||"lineResource"==e.type||""==e.type||"note"==e.type)}chkChangeStatus(t,e,i){const r=this.detailDataElement.getFirstElementByName(t);if(!r)return!1;if("numberResource"==r.type){if(("now"==e||"max"==e)&&!i)return!0}else if("lineResource"==r.type){if("now"==e||"max"==e)return!0}else if(""==r.type){if("now"==e)return!0}else if("note"==r.type&&"now"==e)return!0;return!1}getStatusType(t,e,i){let r="";const o=this.detailDataElement.getFirstElementByName(t);if(!o)return null;if("numberResource"==o.type)if("now"!=e||i){if("max"!=e||i)return null;r="value"}else r="currentValue";else if("lineResource"==o.type)i?"now"==e?r="currentLineValue":"max"==e&&(r="maxLineValue"):"now"==e?r="currentValue":"max"==e&&(r="value");else{if(""!=o.type)return null;if("now"!=e||i)return null;r="value"}return r}getStatusTextType(t){let e="";const i=this.detailDataElement.getFirstElementByName(t);return i?(e="numberResource"==i.type?"currentValue":"value",e):null}getStatusValue(t,e,i){const r=this.detailDataElement.getFirstElementByName(t);if(!r)return null;let o=this.getStatusType(t,e,i);if(null==o)return null;let s="";return console.log("getStatusValue type"+o),"value"==o&&(s=r.value),"currentValue"==o&&(s=r.currentValue),"maxLineValue"==o&&(s=String(r.maxLineValue)),"currentLineValue"==o&&(s=String(r.currentLineValue)),parseInt(s)}setStatusValue(t,e,i,r){const o=this.detailDataElement.getFirstElementByName(t);if(!o)return!1;let s=this.getStatusType(t,e,r);return null!=s&&("value"==s&&(o.value=i),"currentValue"==s&&(o.currentValue=i),"currentLineValue"==s&&(o.currentLineValue=i),"maxLineValue"==s&&(o.maxLineValue=i),!0)}setStatusText(t,e){const i=this.detailDataElement.getFirstElementByName(t);if(!i)return!1;let r=this.getStatusTextType(t);return null!=r&&("value"==r&&(i.value=e),"currentValue"==r&&(i.currentValue=e),!0)}changeStatusValue(t,e,i,r,o,s){const a=this.detailDataElement.getFirstElementByName(t);let g="",w=this.getStatusType(t,e,s);if(!a)return g;let ve=this.getStatusValue(t,e,s);if(null==ve)return g;let me=ve+i,Se="";return"value"==w&&(r&&me<=0&&r&&(Se="(\u6700\u5c0f)",me=0),this.setStatusValue(t,e,me)),"currentValue"==w&&(me>=a.value&&o&&(Se="(\u6700\u5927)",me=this.getStatusValue(t,"max")),r&&me<=0&&r&&(Se="(\u6700\u5c0f)",me=0),this.setStatusValue(t,e,me)),"maxLineValue"==w&&(r&&me<=0&&r&&(Se="(\u6700\u5c0f)",me=0),this.setStatusValue(t,e,me,!0)),"currentLineValue"==w&&(me>=a.maxLineValue&&o&&(Se="(\u6700\u5927)",me=this.getStatusValue(t,"max",!0)),r&&me<=0&&r&&(Se="(\u6700\u5c0f)",me=0),this.setStatusValue(t,e,me,!0)),g=g+"["+this.name+" "+ve+">"+me+Se+"] ",g}};var vr;xe([lt()],Lt.prototype,"isLock",void 0),xe([lt()],Lt.prototype,"rotate",void 0),xe([lt()],Lt.prototype,"roll",void 0),xe([lt()],Lt.prototype,"isDropShadow",void 0),xe([lt()],Lt.prototype,"hideInventory",void 0),xe([lt()],Lt.prototype,"nonTalkFlag",void 0),xe([lt()],Lt.prototype,"overViewWidth",void 0),xe([lt()],Lt.prototype,"overViewMaxHeight",void 0),xe([lt()],Lt.prototype,"specifyKomaImageFlag",void 0),xe([lt()],Lt.prototype,"komaImageHeignt",void 0),xe([lt()],Lt.prototype,"chatColorCode",void 0),xe([lt()],Lt.prototype,"syncDummyCounter",void 0),Lt=ob=xe([li("character")],Lt);let _t=vr=class extends ca{constructor(){super(...arguments),this.userId="",this.peerId="",this.name="",this.imageIdentifier="",this.lastControlImageIdentifier="",this.lastControlCharacterName="",this.lastControlImageIndex=0,this.lastControlSendFrom="",this.voteAnswer=-1,this.voteId=-1,this._reConnectPass="",this._timestampSend=-1,this._timestampReceive=-1,this._timeDiffUp=0,this._timeDiffDown=0,this._timeLatency=99999,this._firstTimeSignNo=-1,this._lastTimeSignNo=-1,this._totalTimeSignNum=0,this._timeout=40,this._isDisConnect=!0,this._debugTimeShift=0,this._debugReceiveDelay=0,this.chatColorCode=["#000000","#FF0000","#0099FF"],this._diceImageType="",this._diceImageIndex=-1}get isDisConnect(){return this._isDisConnect}set isDisConnect(t){this._isDisConnect=t}get timestampSend(){return this._timestampSend}set timestampSend(t){this._timestampSend=t}get timestampReceive(){return this._timestampReceive}set timestampReceive(t){this._timestampReceive=t+this._debugReceiveDelay}get timeDiffUp(){return this._timeDiffUp}set timeDiffUp(t){this._timeDiffUp=t}get timeDiffDown(){return this._timeDiffDown}set timeDiffDown(t){this._timeDiffDown=t}get timeLatency(){return this._timeLatency}set timeLatency(t){this._timeLatency=t}get debugTimeShift(){return this._debugTimeShift}set debugTimeShift(t){this._debugTimeShift=t}get debugReceiveDelay(){return this._debugReceiveDelay}set debugReceiveDelay(t){this._debugReceiveDelay=t}get timeout(){return this._timeout>0?this._timeout:1}set timeout(t){this._timeout=t}get firstTimeSignNo(){return this._firstTimeSignNo}set firstTimeSignNo(t){this._firstTimeSignNo=t}get lastTimeSignNo(){return this._lastTimeSignNo}set lastTimeSignNo(t){this._lastTimeSignNo=t}get totalTimeSignNum(){return this._totalTimeSignNum}set totalTimeSignNum(t){this._totalTimeSignNum=t}get reConnectPass(){return this._reConnectPass}set reConnectPass(t){this._reConnectPass=t}get vote(){return Xe.instance.get("Vote")}get diceImageType(){return this._diceImageType}get diceImageIndex(){return this._diceImageIndex}set diceImageType(t){this._diceImageType=t}set diceImageIndex(t){this._diceImageIndex=t}get diceImageIdentifier(){return""!=this.diceImageType?this.diceImageType+"_dice["+this.diceImageIndex.toString().padStart(2,"0")+"]":""}get isMine(){return vr.myCursor&&vr.myCursor===this}get image(){return St.instance.get(this.imageIdentifier)}get lastControlImage(){return St.instance.get(this.lastControlImageIdentifier)}onStoreAdded(){super.onStoreAdded(),this.isMine||Qe.register(this).on("DISCONNECT_PEER",t=>{t.data.peerId===this.peerId&&setTimeout(()=>{bt.peerIds.includes(this.peerId)||(vr.userIdMap.delete(this.userId),vr.peerIdMap.delete(this.peerId),Xe.instance.remove(this))},3e4)})}onStoreRemoved(){super.onStoreRemoved(),Qe.unregister(this),vr.userIdMap.delete(this.userId),vr.peerIdMap.delete(this.peerId)}static findByUserId(t){return this.find(vr.userIdMap,t,!0)}static findByPeerId(t){return this.find(vr.peerIdMap,t,!1)}static find(t,e,i){let r=t.get(e);if(null!=r&&Xe.instance.get(r))return Xe.instance.get(r);let o=Xe.instance.getObjects(vr);for(let s of o){let a=i?s.userId:s.peerId;if(a===e)return t.set(a,s.identifier),s}return null}static createMyCursor(){return vr.myCursor?(console.warn("It is already created."),vr.myCursor):(vr.myCursor=new vr,vr.myCursor.peerId=bt.peerId,vr.myCursor.initialize(),vr.myCursor)}apply(t){let e=t.syncData.userId,i=t.syncData.peerId;e!==this.userId&&(vr.userIdMap.set(e,this.identifier),vr.userIdMap.delete(this.userId)),i!==this.peerId&&(vr.peerIdMap.set(i,this.identifier),vr.peerIdMap.delete(this.peerId));let r=this.voteId;super.apply(t),r!=this.voteId&&this.vote.chkFinishVote()}isPeerAUdon(){return null!=/u.*d.*o.*n/gi.exec(this.peerId)}};_t.myCursor=null,_t.userIdMap=new Map,_t.peerIdMap=new Map,xe([lt()],_t.prototype,"userId",void 0),xe([lt()],_t.prototype,"peerId",void 0),xe([lt()],_t.prototype,"name",void 0),xe([lt()],_t.prototype,"imageIdentifier",void 0),xe([lt()],_t.prototype,"lastControlImageIdentifier",void 0),xe([lt()],_t.prototype,"lastControlCharacterName",void 0),xe([lt()],_t.prototype,"lastControlImageIndex",void 0),xe([lt()],_t.prototype,"lastControlSendFrom",void 0),xe([lt()],_t.prototype,"voteAnswer",void 0),xe([lt()],_t.prototype,"voteId",void 0),_t=vr=xe([li("PeerCursor")],_t);let go=(()=>{class n{constructor(){this.intervalTimer=null,this.timeOffset=Date.now(),this.performanceOffset=performance.now(),this.ntpApiUrls=["https://worldtimeapi.org/api/ip"],this.gameType="DiceBot",this._ImageIndex=0}get chatTabs(){return Vs.instance.chatTabs}calibrateTimeOffset(){if(null!=this.intervalTimer)return void console.log("calibrateTimeOffset was canceled.");let e=Math.floor(Math.random()*this.ntpApiUrls.length),i=this.ntpApiUrls[e],r=performance.now();fetch(i).then(o=>{if(o.ok)return o.json();throw new Error("Network response was not ok.")}).then(o=>{let s=performance.now(),a=(s-r)/2,w=new Date(o.utc_datetime).getTime();this.timeOffset=w+a,this.performanceOffset=s,console.log("latency: "+a+"ms"),console.log("st: "+w),console.log("timeOffset: "+this.timeOffset),console.log("performanceOffset: "+this.performanceOffset),this.setIntervalTimer()}).catch(o=>{console.warn("There has been a problem with your fetch operation: ",o.message),this.setIntervalTimer()}),this.setIntervalTimer()}setIntervalTimer(){null!=this.intervalTimer&&clearTimeout(this.intervalTimer),this.intervalTimer=setTimeout(()=>{this.intervalTimer=null,this.calibrateTimeOffset()},216e5)}getTime(){return Math.floor(this.timeOffset+(performance.now()-this.performanceOffset))}sendSystemMessageOnePlayer(e,i,r,o){let s;s=o||"#006633";let a={from:this.findId(r),to:this.findId(r),name:"\u30b7\u30b9\u30c6\u30e0\u30e1\u30c3\u30bb\u30fc\u30b8",imageIdentifier:"",timestamp:this.calcTimeStamp(e),tag:"DiceBot to-pl-system-message",text:i,imagePos:-1,messColor:s,sendFrom:null};return e.addMessage(a)}sendSystemMessageLastSendCharactor(e){const r=Xe.instance.get("ChatTabList").systemMessageTab,o=_t.myCursor.lastControlSendFrom?_t.myCursor.lastControlSendFrom:_t.myCursor.identifier;let s=_t.myCursor.lastControlImageIndex;this.findImageIdentifier(o,s)!=_t.myCursor.lastControlImageIdentifier&&(s=0),this.sendMessage(r,e,null,o,null,s,"#006633")}sendMessage(e,i,r,o,s,a,g,w){let ve,me;ve=a>0?a:0,me=g||"#000000";let Oe,Se=Xe.instance.get("DiceBot");Oe=null==r?"":Se.checkSecretDiceCommand(r,i)||Se.checkSecretEditCommand(i)?`${r.ID} secret`:r.ID;let Ve={from:bt.peerContext.userId,to:this.findId(s),name:this.makeMessageName(o,s),imageIdentifier:this.findImageIdentifier(o,ve),timestamp:this.calcTimeStamp(e),tag:Oe,text:i,imagePos:this.findImagePos(o),messColor:me,sendFrom:o};console.log(i+" "+o+" "+s+" "+a),this.setLastControlInfoToPeer(o,this.findImageIdentifier(o,ve),a,s);let Ze=(" "+i).match(/\s[@\uff20](\S+)\s*$/i);if(Ze){console.log(Ze);const je=Ze[1].match(/^[hH\uff48\uff28][iI\uff49\uff29][dD\uff44\uff24][eE\uff45\uff25]$/),ut=Ze[1].match(/(\d+)$/);if(je)Ve.imageIdentifier="",Ve.text=i.replace(/([@\uff20]\S+\s*)$/i,"");else if(ut){const ot=parseInt(ut[1]),ft=this.findImageIdentifier(o,ot);if(ft){Ve.imageIdentifier=ft,Ve.text=i.replace(/([@\uff20]\S+\s*)$/i,"");let Ot=Xe.instance.get(o);Ot instanceof Lt&&(Ot.selectedTachieNum=parseInt(ut[1]))}}else{const ft=this.findImageIdentifierName(o,Ze[1]);if(ft){Ve.imageIdentifier=ft,Ve.text=i.replace(/([@\uff20]\S+\s*)$/i,"");let Ot=Xe.instance.get(o);Ot instanceof Lt&&(Ot.selectedTachieNum=this._ImageIndex)}}}return e.addMessage(Ve,w||null)}findId(e){let i=Xe.instance.get(e);return i instanceof Lt?i.identifier:i instanceof _t?i.userId:null}findObjectName(e){let i=Xe.instance.get(e);return i instanceof Lt||i instanceof _t?i.name:e}makeMessageName(e,i){let r=this.findObjectName(e);return null==i||i.length<1?r:r+" > "+this.findObjectName(i)}setLastControlInfoToPeer(e,i,r,o){const s=this.findObjectName(e),a=_t.myCursor;!a||(console.log("peerCursor:"+a),(null==o||o.length<1)&&(a.lastControlImageIdentifier!=i&&(a.lastControlImageIdentifier=i),a.lastControlCharacterName!=s&&(a.lastControlCharacterName=s),a.lastControlSendFrom=e,a.lastControlImageIndex=r))}findImageIdentifierName(e,i){let r=Xe.instance.get(e);if(this._ImageIndex=0,r instanceof Lt){let o=r.imageDataElement;for(let s of o.children){if(s instanceof st&&s.getAttribute("currentValue")==i){console.log("HIT!!"+s.getAttribute("currentValue")+"="+i);const a=St.instance.get(s.value);if(a)return a.identifier}this._ImageIndex++}this._ImageIndex=0;for(let s of o.children){if(s instanceof st&&(console.log("child"+s.getAttribute("currentValue")),0==s.getAttribute("currentValue").indexOf(i))){console.log("HIT!!"+s.getAttribute("currentValue")+"="+i);const a=St.instance.get(s.value);if(a)return a.identifier}this._ImageIndex++}}return""}findImageIdentifier(e,i){let r=Xe.instance.get(e);if(r instanceof Lt){if(r.imageDataElement.children.length>i){let o=St.instance.get(r.imageDataElement.children[i].value);if(o)return o.identifier}return""}return r instanceof _t?r.imageIdentifier:""}findImagePos(e){let i=Xe.instance.get(e);if(i instanceof Lt){let r=i.detailDataElement.getFirstElementByName("POS");return r&&0<=r.currentValue&&r.currentValue<=11?r.currentValue:0}return-1}calcTimeStamp(e){let i=this.getTime(),r=e.latestTimeStamp;return i<=r?r+1:i}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();var sb=(()=>(function(n){n.ACTION="action",n.SEPARATOR="separator"}(sb||(sb={})),sb))();const xi={name:"",enabled:!0,type:sb.SEPARATOR};let To=(()=>{class n{constructor(e){this.componentFactoryResolver=e,this.title="",this.actions=[],this.position={x:0,y:0}}get isShow(){return!!this.panelComponentRef}open(e,i,r,o){let s;this.close(),o||(o=n.defaultParentViewContainerRef,console.log("Context Open"));const a=o.injector,g=this.componentFactoryResolver.resolveComponentFactory(n.ContextMenuComponentClass);s=o.createComponent(g,o.length,a);const w=s.injector.get(n);w.panelComponentRef=s,i&&(w.actions=i),e&&(w.position.x=e.x,w.position.y=e.y),w.title=null!=r?r:"",s.onDestroy(()=>{w.panelComponentRef=null})}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}return n.ContextMenuComponentClass=null,n.\u0275fac=function(e){return new(e||n)(In(ju))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();var gc,_d=(()=>(function(n){n.ASC="ASC",n.DESC="DESC"}(_d||(_d={})),_d))();let ja=gc=class extends ca{constructor(){super(...arguments),this.sortTag="\u30ec\u30d9\u30eb",this.sortOrder=_d.DESC,this.sortTag2nd="\u30b3\u30a2AP",this.sortOrder2nd=_d.ASC,this.dataTag="\u30ec\u30d9\u30eb AP \u6b8b\u5f3e\u6570"}static get instance(){return gc._instance||(gc._instance=new gc("DataSummarySetting"),gc._instance.initialize()),gc._instance}get dataTags(){return this._dataTag!==this.dataTag&&(this._dataTag=this.dataTag,this._dataTags=null!=this.dataTag&&0<this.dataTag.trim().length?this.dataTag.trim().split(/\s+/):[]),this._dataTags}innerXml(){return""}parseInnerXml(t){let e=gc.instance.toContext();e.syncData=this.toContext().syncData,gc.instance.apply(e),gc.instance.update(),this.destroy()}};xe([lt()],ja.prototype,"sortTag",void 0),xe([lt()],ja.prototype,"sortOrder",void 0),xe([lt()],ja.prototype,"sortTag2nd",void 0),xe([lt()],ja.prototype,"sortOrder2nd",void 0),xe([lt()],ja.prototype,"dataTag",void 0),ja=gc=xe([li("summary-setting")],ja);let ab=(()=>{class n{constructor(){this.tableInventory=new lb(e=>"table"===e.location.name),this.commonInventory=new lb(e=>!this.isAnyLocation(e.location.name)),this.privateInventory=new lb(e=>e.location.name===bt.peerId),this.graveyardInventory=new lb(e=>"graveyard"===e.location.name),this.locationMap=new Map,this.tagNameMap=new Map,this.newLineString="/",this.newLineDataElement=st.create(this.newLineString),this.initialize()}get summarySetting(){return ja.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(e){this.summarySetting.sortTag=e}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(e){this.summarySetting.sortOrder=e}get sortTag2nd(){return this.summarySetting.sortTag2nd}set sortTag2nd(e){this.summarySetting.sortTag2nd=e}get sortOrder2nd(){return this.summarySetting.sortOrder2nd}set sortOrder2nd(e){this.summarySetting.sortOrder2nd=e}get dataTag(){return this.summarySetting.dataTag}set dataTag(e){this.summarySetting.dataTag=e}get dataTags(){return this.summarySetting.dataTags}initialize(){Qe.register(this).on("OPEN_NETWORK",e=>{this.refresh()}).on("CONNECT_PEER",e=>{this.refresh()}).on("DISCONNECT_PEER",e=>{this.refresh()}).on("UPDATE_GAME_OBJECT",e=>{let i=Xe.instance.get(e.data.identifier);if(i)if(i instanceof Lt){let r=this.locationMap.get(i.identifier);i.location.name!==r&&(this.locationMap.set(i.identifier,i.location.name),this.refresh())}else if(i instanceof st){if(!this.containsInGameCharacter(i))return;let r=this.tagNameMap.get(i.identifier);(this.dataTags.includes(r)||this.dataTags.includes(i.name))&&i.name!==r&&(this.tagNameMap.set(i.identifier,i.name),this.refreshDataElements()),(this.sortTag===i.name||this.sortTag2nd===i.name)&&this.refreshSort(),0<i.children.length&&(this.refreshDataElements(),this.refreshSort()),this.callInventoryUpdate()}else i instanceof ja&&(this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate())}).on("DELETE_GAME_OBJECT",e=>{this.locationMap.delete(e.data.identifier),this.tagNameMap.delete(e.data.identifier),this.refresh()}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.callInventoryUpdate()})}containsInGameCharacter(e){let i=e.parent,r=Lt.aliasName;for(;i;){if(i.aliasName===r)return!0;i=i.parent}return!1}refresh(){this.refreshObjects(),this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate()}refreshObjects(){this.tableInventory.refreshObjects(),this.commonInventory.refreshObjects(),this.privateInventory.refreshObjects(),this.graveyardInventory.refreshObjects()}refreshDataElements(){this.tableInventory.refreshDataElements(),this.commonInventory.refreshDataElements(),this.privateInventory.refreshDataElements(),this.graveyardInventory.refreshDataElements()}refreshSort(){this.tableInventory.refreshSort(),this.commonInventory.refreshSort(),this.privateInventory.refreshSort(),this.graveyardInventory.refreshSort()}callInventoryUpdate(){Qe.trigger("UPDATE_INVENTORY",null)}isAnyLocation(e){if("table"===e||e===bt.peerId||"graveyard"===e)return!0;for(let i of bt.peerContexts)if(i.isOpen&&e===i.peerId)return!0;return!1}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class lb{constructor(t){this.classifier=t,this.newLineString="/",this.newLineDataElement=st.create(this.newLineString),this._tabletopObjects=[],this._dataElementMap=new Map,this.needsRefreshObjects=!0,this.needsRefreshElements=!0,this.needsSort=!0}get summarySetting(){return ja.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(t){this.summarySetting.sortTag=t}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(t){this.summarySetting.sortOrder=t}get sortTag2nd(){return this.summarySetting.sortTag2nd}set sortTag2nd(t){this.summarySetting.sortTag2nd=t}get sortOrder2nd(){return this.summarySetting.sortOrder2nd}set sortOrder2nd(t){this.summarySetting.sortOrder2nd=t}get dataTag(){return this.summarySetting.dataTag}set dataTag(t){this.summarySetting.dataTag=t}get dataTags(){return this.summarySetting.dataTags}get tabletopObjects(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this.needsSort&&(this._tabletopObjects=this.sortTabletopObjects(this._tabletopObjects),this.needsSort=!1),this._tabletopObjects}get length(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this._tabletopObjects.length}get dataElementMap(){if(this.needsRefreshElements){this._dataElementMap.clear();let t=this.tabletopObjects;for(let e of t){if(!e.rootDataElement)continue;let i=[];this.dataTags.forEach(r=>{if(r.includes("*")||r.includes("?")){const o=new RegExp(`^${r.replace(/\*/g,".*").replace(/\?/g,".")}$`);i=i.concat(e.rootDataElement.getElementsByRegExp(o))}else i.push(r===this.newLineString?this.newLineDataElement:e.rootDataElement.getFirstElementByName(r))}),this._dataElementMap.set(e.identifier,i)}this.needsRefreshElements=!1}return this._dataElementMap}refreshObjects(){this.needsRefreshObjects=!0}refreshDataElements(){this.needsRefreshElements=!0}refreshSort(){this.needsSort=!0}searchTabletopObjects(){let t=Xe.instance.getObjects(Lt),e=[];for(let i of t)this.classifier(i)&&e.push(i);return e}sortTabletopObjects(t){let e=this.sortTag.length?this.sortTag.trim():"",i=this.sortTag2nd.length?this.sortTag2nd.trim():"",r="ASC"===this.sortOrder?-1:1,o="ASC"===this.sortOrder2nd?-1:1;return e.length<1||t.sort((s,a)=>{var g,w;let W=null===(g=s.rootDataElement)||void 0===g?void 0:g.getFirstElementByName(e),ve=null===(w=a.rootDataElement)||void 0===w?void 0:w.getFirstElementByName(e);if(!W&&!ve)return 0;if(!ve)return-1;if(!W)return 1;let me=this.convertToSortableValue(W),Se=this.convertToSortableValue(ve);if(me<Se)return r;if(me>Se)return-1*r;let Oe=s.rootDataElement.getFirstElementByName(i),Ve=a.rootDataElement.getFirstElementByName(i);if(!Oe&&!Ve)return 0;if(!Ve)return-1;if(!Oe)return 1;let We=this.convertToSortableValue(Oe),Ze=this.convertToSortableValue(Ve);return We<Ze?o:We>Ze?-1*o:0}),t}convertToSortableValue(t){let i=Xo.toHalfWidth(((t.isNumberResource?t.currentValue:t.value)+"").trim()),r=+i;return Number.isNaN(r)?i:r}}class CG{constructor(t,e,i){this._resolve=t,this._reject=e,this.option=i}resolve(t){this._resolve(t),this._resolve=null}reject(t){this._reject(t),this._reject=null}}let pi=(()=>{class n{constructor(e){this.componentFactoryResolver=e,this.modalContext=null,this.count=0,this.title="\u7121\u540d\u306e\u30e2\u30fc\u30c0\u30eb"}get option(){return this.modalContext?this.modalContext.option:null}get isShow(){return this.count>0}open(e,i,r){let o;return r||(r=n.defaultParentViewContainerRef),new Promise((s,a)=>{const W=new n(this.componentFactoryResolver);W.modalContext=new CG(Ve=>{o&&(o.destroy(),s(Ve),this.count--)},Ve=>{o&&(o.destroy(),a(Ve),this.count--)},i);const me=Ne.create([{provide:n,useValue:W}],r.injector),Se=this.componentFactoryResolver.resolveComponentFactory(n.ModalComponentClass),Oe=this.componentFactoryResolver.resolveComponentFactory(e);o=r.createComponent(Se,r.length,me),o.instance.content.createComponent(Oe),o.onDestroy(()=>{this.count--}),this.count++})}resolve(e){this.modalContext&&(this.modalContext.resolve(e),this.modalContext=null)}reject(e){this.modalContext&&(this.modalContext.reject(e),this.modalContext=null)}}return n.ModalComponentClass=null,n.\u0275fac=function(e){return new(e||n)(In(ju))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})(),$n=(()=>{class n{constructor(e){this.componentFactoryResolver=e,this.title="\u7121\u540d\u306e\u30d1\u30cd\u30eb",this.left=0,this.top=0,this.width=100,this.height=100,this.isCutIn=!1,this.cutInIdentifier="",this.chatTab=null,this.cardStack=null,this.scrollablePanel=null}get isShow(){return!!this.panelComponentRef}open(e,i,r){let o;r||(r=n.defaultParentViewContainerRef);const s=r.injector,a=this.componentFactoryResolver.resolveComponentFactory(n.UIPanelComponentClass),g=this.componentFactoryResolver.resolveComponentFactory(e);o=r.createComponent(a,r.length,s);let w=o.instance.content.createComponent(g);const W=o.injector.get(n);return W.panelComponentRef=o,i&&(i.title&&(W.title=i.title),i.top&&(W.top=i.top),i.left&&(W.left=i.left),i.width&&(W.width=i.width),i.height&&(W.height=i.height),i.isCutIn&&(W.isCutIn=i.isCutIn),i.cutInIdentifier&&(W.cutInIdentifier=i.cutInIdentifier)),o.onDestroy(()=>{W.panelComponentRef=null}),w.instance}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}return n.UIPanelComponentClass=null,n.\u0275fac=function(e){return new(e||n)(In(ju))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})(),Di=(()=>{class n{constructor(e){this.ngZone=e,this.callbackOnPointerDown=i=>this.onPointerDown(i),this.callbackOnPointerMove=i=>this.onPointerMove(i),this.callbackOnPointerUp=i=>this.onPointerUp(i),this.callbackOnContextMenu=i=>this.onContextMenu(i),this._isAllowedToOpenContextMenu=!1,this.pointers=[{x:0,y:0,z:0,identifier:-1}],this.startPostion=this.pointers[0],this.primaryPointer=this.pointers[0],this._isDragging=!1}get isAllowedToOpenContextMenu(){return this._isAllowedToOpenContextMenu}get pointer(){return this.primaryPointer}get pointerX(){return this.primaryPointer.x}get pointerY(){return this.primaryPointer.y}get isDragging(){return this._isDragging}set isDragging(e){e!==this._isDragging&&this.ngZone.run(()=>this._isDragging=e)}initialize(){this.addEventListeners()}destroy(){this.removeEventListeners()}onPointerDown(e){this.onPointerMove(e),this._isAllowedToOpenContextMenu=!0,this.startPostion=this.pointers[0]}onPointerMove(e){e.touches?this.onTouchMove(e):this.onMouseMove(e),this.targetElement=e.target}onPointerUp(e){this.onPointerMove(e)}onMouseMove(e){let i={x:e.pageX,y:e.pageY,z:0,identifier:-9999};this.isSyntheticEvent(i)||(this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(i),this.pointers=[i],this.primaryPointer=i)}onTouchMove(e){let i=e.touches.length;if(!(i<1)){this.pointers=[];for(let r=0;r<i;r++){let o=e.touches[r],s={x:o.pageX,y:o.pageY,z:0,identifier:o.identifier};this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(s),this.pointers.push(s)}this.primaryPointer=this.pointers[0]}}onContextMenu(e){this._isAllowedToOpenContextMenu=!0,this.onPointerUp(e)}preventContextMenuIfNeeded(e,i=3){i**2<(e.x-this.startPostion.x)**2+(e.y-this.startPostion.y)**2&&(this._isAllowedToOpenContextMenu=!1)}isSyntheticEvent(e,i=15){for(let r of this.pointers)if(r.identifier!==e.identifier&&(e.x-r.x)**2+(e.y-r.y)**2<i**2)return!0;return!1}addEventListeners(){this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.addEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.addEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.addEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.addEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.addEventListener("touchend",this.callbackOnPointerUp,!0),document.body.addEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.addEventListener("drop",this.callbackOnPointerUp,!0),document.body.addEventListener("contextmenu",this.callbackOnContextMenu,!0)})}removeEventListeners(){document.body.removeEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.removeEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.removeEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.removeEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.removeEventListener("touchend",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.removeEventListener("drop",this.callbackOnPointerUp,!0),document.body.removeEventListener("contextmenu",this.callbackOnContextMenu,!0)}}return n.\u0275fac=function(e){return new(e||n)(In(An))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Pw(n,t=[]){let e=Xe.instance.getObjects(n.aliasName);t.forEach(o=>e=e.concat(Xe.instance.getObjects(o))),e=e.filter(o=>o.isVisibleOnTable);let i=-1,r=!1;for(let o=0;o<e.length;o++)i===e[o].zindex?r=!0:i<e[o].zindex&&(i=e[o].zindex,r=!1);if((i!==n.zindex||r)&&(n.zindex=i+1,!(n.zindex<e.length+256))){e.sort((o,s)=>o.zindex-s.zindex);for(let o=0;o<e.length;o++)e[o].zindex=o}}var cb,Kc=(()=>(function(n){n[n.FRONT=0]="FRONT",n[n.BACK=1]="BACK"}(Kc||(Kc={})),Kc))();let Jr=cb=class extends Qr{constructor(){super(...arguments),this.isLock=!1,this.dispLockMark=!0,this.state=Kc.FRONT,this.rotate=0,this.owner="",this.zindex=0,this.overViewWidth=250,this.overViewMaxHeight=250}get isVisibleOnTable(){return"table"===this.location.name&&(!this.parentIsAssigned||this.parentIsDestroyed)}get name(){return this.getCommonValue("name","")}get size(){return this.getCommonValue("size",2)}set size(t){this.setCommonValue("size",t)}get frontImage(){return this.getImageFile("front")}get backImage(){return this.getImageFile("back")}get imageFile(){return this.isVisible?this.frontImage:this.backImage}get ownerName(){let t=_t.findByUserId(this.owner);return t?t.name:""}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return this.hasOwner&&bt.peerContexts.some(t=>t.userId===this.owner&&t.isOpen)}get isHand(){return bt.peerContext.userId===this.owner}get isFront(){return this.state===Kc.FRONT}get isVisible(){return this.isHand||this.isFront}faceUp(){this.state=Kc.FRONT,this.owner=""}faceDown(){this.state=Kc.BACK,this.owner=""}toTopmost(){Pw(this,["card-stack"])}static create(t,e,i,r=2,o){let s=null;return s=o?new cb(o):new cb,s.createDataElements(),s.commonDataElement.appendChild(st.create("name",t,{},"name_"+s.identifier)),s.commonDataElement.appendChild(st.create("size",r,{},"size_"+s.identifier)),s.imageDataElement.appendChild(st.create("front",e,{type:"image"},"front_"+s.identifier)),s.imageDataElement.appendChild(st.create("back",i,{type:"image"},"back_"+s.identifier)),s.initialize(),s}};var ub;xe([lt()],Jr.prototype,"isLock",void 0),xe([lt()],Jr.prototype,"dispLockMark",void 0),xe([lt()],Jr.prototype,"state",void 0),xe([lt()],Jr.prototype,"rotate",void 0),xe([lt()],Jr.prototype,"owner",void 0),xe([lt()],Jr.prototype,"zindex",void 0),xe([lt()],Jr.prototype,"overViewWidth",void 0),xe([lt()],Jr.prototype,"overViewMaxHeight",void 0),Jr=cb=xe([li("card")],Jr);let wr=ub=class extends Qr{constructor(){super(...arguments),this.isLock=!1,this.rotate=0,this.zindex=0,this.owner="",this.isShowTotal=!0,this.overViewWidth=250,this.overViewMaxHeight=250}get name(){return this.getCommonValue("name","")}get ownerName(){let t=_t.findByUserId(this.owner);return t?t.name:""}get hasOwner(){return 0<this.owner.length}get cardRoot(){for(let t of this.children)if("cardRoot"===t.getAttribute("name"))return t;return null}get cards(){return this.cardRoot?this.cardRoot.children:[]}get topCard(){return this.isEmpty?null:this.cards[0]}get isEmpty(){return this.cards.length<1}get imageFile(){return this.topCard?this.topCard.imageFile:null}onChildRemoved(t){super.onChildRemoved(t),t instanceof Jr&&Qe.trigger("CARD_STACK_DECREASED",{cardStackIdentifier:this.identifier,cardIdentifier:t.identifier})}shuffle(){if(!this.cardRoot)return;let t=this.cardRoot.children.length;for(let e of this.cards)e.index=Math.random()*t,e.rotate=180*Math.floor(2*Math.random()),this.setSamePositionFor(e);return this.cards}drawCard(){let t=this.topCard?this.cardRoot.removeChild(this.topCard):null;return t&&(t.rotate+=this.rotate,360<t.rotate&&(t.rotate-=360),this.setSamePositionFor(t),t.toTopmost()),t}drawCardAll(){let t=this.cards;for(let e of t)this.cardRoot.removeChild(e),e.rotate+=this.rotate,this.setSamePositionFor(e),360<e.rotate&&(e.rotate-=360);return t}faceUp(){this.topCard&&(this.topCard.faceUp(),this.setSamePositionFor(this.topCard))}faceDown(){this.topCard&&(this.topCard.faceDown(),this.setSamePositionFor(this.topCard))}faceUpAll(){for(let t of this.cards)t.faceUp(),this.setSamePositionFor(t)}faceDownAll(){for(let t of this.cards)t.faceDown(),this.setSamePositionFor(t)}uprightAll(){for(let t of this.cards)t.rotate=0,this.setSamePositionFor(t)}unifyCardsSize(t){for(const e of this.cards)e.size!==t&&(e.size=t)}putOnTop(t){if(!this.cardRoot)return null;if(!this.topCard)return this.putOnBottom(t);t.owner="",t.zindex=0;let e=Math.abs(t.rotate-this.rotate);return 180<e&&(e=360-e),t.rotate=e<=90?0:180,this.setSamePositionFor(t),this.cardRoot.insertBefore(t,this.topCard)}putOnBottom(t){if(!this.cardRoot)return null;t.owner="",t.zindex=0;let e=Math.abs(t.rotate-this.rotate);return 180<e&&(e=360-e),t.rotate=e<=90?0:180,this.setSamePositionFor(t),this.cardRoot.appendChild(t)}toTopmost(){Pw(this,["card"])}setLocation(t){super.setLocation(t);let e=this.cards;for(let i of e)i.setLocation(t)}setSamePositionFor(t){t.location.name=this.location.name,t.location.x=this.location.x,t.location.y=this.location.y,t.posZ=this.posZ}static create(t,e){let i=null;i=e?new ub(e):new ub,i.createDataElements(),i.commonDataElement.appendChild(st.create("name",t,{},"name_"+i.identifier));let r=new Si("cardRoot_"+i.identifier);return r.setAttribute("name","cardRoot"),r.initialize(),i.appendChild(r),i.initialize(),i}};xe([lt()],wr.prototype,"isLock",void 0),xe([lt()],wr.prototype,"rotate",void 0),xe([lt()],wr.prototype,"zindex",void 0),xe([lt()],wr.prototype,"owner",void 0),xe([lt()],wr.prototype,"isShowTotal",void 0),xe([lt()],wr.prototype,"overViewWidth",void 0),xe([lt()],wr.prototype,"overViewMaxHeight",void 0),wr=ub=xe([li("card-stack")],wr);var db,eo=(()=>(function(n){n[n.D2=0]="D2",n[n.D4=1]="D4",n[n.D6=2]="D6",n[n.D8=3]="D8",n[n.D10=4]="D10",n[n.D10_10TIMES=5]="D10_10TIMES",n[n.D12=6]="D12",n[n.D20=7]="D20"}(eo||(eo={})),eo))();let vs=db=class extends Qr{constructor(){super(...arguments),this.isLock=!1,this.face="0",this.owner="",this.rotate=0,this.specifyKomaImageFlag=!1,this.komaImageHeignt=100,this.isEnDice=!1}get name(){return this.getCommonValue("name","")}set name(t){this.setCommonValue("name",t)}get size(){return this.getCommonValue("size",1)}set size(t){this.setCommonValue("size",t)}get faces(){return this.imageDataElement.children.map(t=>t.name)}get imageFile(){return this.isVisible?this.getImageFile(this.face):this.faces.length?this.getImageFile(this.faces[0]):null}get ownerName(){let t=_t.findByUserId(this.owner);return t?t.name:""}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return this.hasOwner&&bt.peerContexts.some(t=>t.userId===this.owner&&t.isOpen)}get isMine(){return bt.peerContext.userId===this.owner}get isVisible(){return!this.hasOwner||this.isMine}diceRoll(){let t=this.faces;return this.face=0<t.length?t[Math.floor(Math.random()*t.length)]:"",this.face}setDicetype(t){this.makeDiceFace(t)}makeDiceFace(t,e){let i=1,r=[],o=s=>s+1+"";switch(t){case eo.D2:i=2;break;case eo.D4:i=4;break;case eo.D6:i=6;break;case eo.D8:i=8;break;case eo.D10_10TIMES:o=s=>s+1+"0";case eo.D10:i=10;break;case eo.D12:i=12;break;case eo.D20:i=20;break;default:i=2}for(let s=0;s<i;s++){let a=o(s);r.push(st.create(a,"",{type:"image"},null!=e?a+"_"+e:null))}return this.imageDataElement.children.forEach(s=>s.destroy()),r.forEach(s=>this.imageDataElement.appendChild(s)),this.face=r[0].name,r}static create(t,e,i,r,o,s){let a=r?new db(r):new db;return a.createDataElements(),a.commonDataElement.appendChild(st.create("name",t,{},"name_"+a.identifier)),a.commonDataElement.appendChild(st.create("size",i,{},"size_"+a.identifier)),a.makeDiceFace(e,a.identifier),a.isEnDice=o,a.initialize(),o&&!s&&a.diceRoll(),s&&(a.face=s),a}};var fb;xe([lt()],vs.prototype,"isLock",void 0),xe([lt()],vs.prototype,"face",void 0),xe([lt()],vs.prototype,"owner",void 0),xe([lt()],vs.prototype,"rotate",void 0),xe([lt()],vs.prototype,"specifyKomaImageFlag",void 0),xe([lt()],vs.prototype,"komaImageHeignt",void 0),xe([lt()],vs.prototype,"isEnDice",void 0),vs=db=xe([li("dice-symbol")],vs);let So=fb=class extends Qr{constructor(){super(...arguments),this.isLock=!1,this.dispLockMark=!0,this.owner="",this.scratchingGrids="",this.scratchedGrids="",this.isPreview=!1}get name(){return this.getCommonValue("name","")}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get opacity(){let t=this.getElement("opacity",this.commonDataElement),e=t?t.currentValue/t.value:1;return Number.isNaN(e)?1:e}get color(){let t=this.getElement("color",this.commonDataElement);return t?t.value+"":"#555555"}set color(t){this.setCommonValue("color",t)}get bgcolor(){let t=this.getElement("color",this.commonDataElement);return t?t.currentValue+"":"#0a0a0a"}set bgcolor(t){let e=this.getElement("color",this.commonDataElement);e&&(e.currentValue=t)}get ownerName(){let t=_t.findByUserId(this.owner);return t?t.name:""}get ownerColor(){return"#444444"}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return!!this.hasOwner&&(bt.peerContext.userId===this.owner&&bt.peerContext.isOpen||bt.peerContexts.some(t=>{const e=_t.findByPeerId(t.peerId);return e&&e.userId===this.owner&&t.isOpen}))}get isMine(){return bt.peerContext.userId===this.owner}complement(){}static create(t,e,i,r,o){let s=null;return s=o?new fb(o):new fb,s.createDataElements(),s.commonDataElement.appendChild(st.create("name",t,{},"name_"+s.identifier)),s.commonDataElement.appendChild(st.create("width",e,{},"width_"+s.identifier)),s.commonDataElement.appendChild(st.create("height",i,{},"height_"+s.identifier)),s.commonDataElement.appendChild(st.create("opacity",r,{type:"numberResource",currentValue:r},"opacity_"+s.identifier)),s.initialize(),s}};var hb;xe([lt()],So.prototype,"isLock",void 0),xe([lt()],So.prototype,"dispLockMark",void 0),xe([lt()],So.prototype,"owner",void 0),xe([lt()],So.prototype,"scratchingGrids",void 0),xe([lt()],So.prototype,"scratchedGrids",void 0),xe([lt()],So.prototype,"isPreview",void 0),So=fb=xe([li("table-mask")],So);let Do=hb=class extends Qr{constructor(){super(...arguments),this.isLock=!1,this.isScratch=!1,this.dispLockMark=!0,this.color="#404040",this.changeColor="#FF5050",this.owner="",this.M=[],this.fillMapBack=[],this.scratchingGrids="",this.scratchedGrids="",this.dummy=0,this.maxSize=50}getMaxSize(){return this.maxSize}getMapXY(t,e,i){return i?this.fillMapBack.length<this.M.length?(console.log("\u30b9\u30af\u30e9\u30c3\u30c1\u30de\u30b9\u30af\u4f5c\u696d\u9818\u57df\u672a\u78ba\u4fdd getMapXY:"+this.fillMapBack.length),!1):this.fillMapBack[this.maxSize*e+t]:this.M[this.maxSize*e+t]}setMapXY(t,e,i){this.fillMapBack.length<this.M.length?console.log("\u30b9\u30af\u30e9\u30c3\u30c1\u30de\u30b9\u30af\u4f5c\u696d\u9818\u57df\u672a\u78ba\u4fdd setMapXY:"+this.fillMapBack.length):this.fillMapBack[this.maxSize*e+t]=i}copyBack2MainMap(){this.M=this.fillMapBack.concat(),console.log("\u30b9\u30af\u30e9\u30c3\u30c1\u30de\u30b9\u30af\uff1a\u30c7\u30fc\u30bf\u3092\u7de8\u96c6\u9818\u57df\u304b\u3089\u53cd\u6620:"+this.fillMapBack.length),this.dummy++,this.dummy>=100&&(this.dummy=0)}copyMain2BackMap(){this.fillMapBack=this.M.concat(),console.log("\u30b9\u30af\u30e9\u30c3\u30c1\u30de\u30b9\u30af\uff1a\u30c7\u30fc\u30bf\u3092\u7de8\u96c6\u9818\u57df\u306b\u8907\u88fd:"+this.fillMapBack.length)}reverseMapXY(t,e){this.fillMapBack.length<this.M.length?console.log("\u30b9\u30af\u30e9\u30c3\u30c1\u30de\u30b9\u30af\u4f5c\u696d\u9818\u57df\u672a\u78ba\u4fdd reverseMapXY:"+this.fillMapBack.length):this.fillMapBack[this.maxSize*e+t]=!this.fillMapBack[this.maxSize*e+t]}isMapXYChange(t,e){return this.fillMapBack.length<this.M.length?(console.log("\u30b9\u30af\u30e9\u30c3\u30c1\u30de\u30b9\u30af\u4f5c\u696d\u9818\u57df\u672a\u78ba\u4fdd isMapXYChange:"+this.fillMapBack.length),!1):this.M[this.maxSize*e+t]!=this.fillMapBack[this.maxSize*e+t]}get name(){return this.getCommonValue("name","")}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get ownerName(){let t=_t.findByUserId(this.owner);return t?t.name:""}get hasOwner(){return 0<this.owner.length}get isMine(){return bt.peerContext.userId===this.owner}get ownerIsOnline(){return this.hasOwner&&bt.peerContexts.some(t=>t.userId===this.owner&&t.isOpen)}static create(t,e,i,r,o){let s=null;return s=o?new hb(o):new hb,s.M=new Array(s.maxSize*s.maxSize).fill(1),s.createDataElements(),s.commonDataElement.appendChild(st.create("name",t,{},"name_"+s.identifier)),s.commonDataElement.appendChild(st.create("width",e,{},"width_"+s.identifier)),s.commonDataElement.appendChild(st.create("height",i,{},"height_"+s.identifier)),s.initialize(),s}};xe([lt()],Do.prototype,"isLock",void 0),xe([lt()],Do.prototype,"isScratch",void 0),xe([lt()],Do.prototype,"dispLockMark",void 0),xe([lt()],Do.prototype,"color",void 0),xe([lt()],Do.prototype,"changeColor",void 0),xe([lt()],Do.prototype,"owner",void 0),xe([lt()],Do.prototype,"M",void 0),xe([lt()],Do.prototype,"scratchingGrids",void 0),xe([lt()],Do.prototype,"scratchedGrids",void 0),xe([lt()],Do.prototype,"dummy",void 0),Do=hb=xe([li("table-scratch-mask")],Do);var pb,md=(()=>(function(n){n[n.NULL=0]="NULL",n[n.FLOOR=1]="FLOOR",n[n.WALL=2]="WALL",n[n.ALL=3]="ALL"}(md||(md={})),md))(),Gi=(()=>(function(n){n[n.NONE=0]="NONE",n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=3]="LEFT",n[n.RIGHT=4]="RIGHT"}(Gi||(Gi={})),Gi))();let _o=pb=class extends Qr{constructor(){super(...arguments),this.isLocked=!1,this.mode=md.ALL,this.rotate=0,this.isDropShadow=!0,this.isSlope=!1,this.isSurfaceShading=!0,this.slopeDirection=Gi.NONE,this.isGrid=!1}get width(){return this.getCommonValue("width",1)}set width(t){this.setCommonValue("width",t)}get height(){return this.getCommonValue("height",1)}set height(t){this.setCommonValue("height",t)}get depth(){return this.getCommonValue("depth",1)}set depth(t){this.setCommonValue("depth",t)}get name(){return this.getCommonValue("name","")}set name(t){this.setCommonValue("name",t)}get wallImage(){return this.getImageFile("wall")}get floorImage(){return this.getImageFile("floor")}get hasWall(){return!!(this.mode&md.WALL)}get hasFloor(){return!!(this.mode&md.FLOOR)}static create(t,e,i,r,o,s,a){let g=null;return g=a?new pb(a):new pb,g.createDataElements(),g.commonDataElement.appendChild(st.create("name",t,{},"name_"+g.identifier)),g.commonDataElement.appendChild(st.create("width",e,{},"width_"+g.identifier)),g.commonDataElement.appendChild(st.create("height",r,{},"height_"+g.identifier)),g.commonDataElement.appendChild(st.create("depth",i,{},"depth_"+g.identifier)),g.imageDataElement.appendChild(st.create("wall",o,{type:"image"},"wall_"+g.identifier)),g.imageDataElement.appendChild(st.create("floor",s,{type:"image"},"floor_"+g.identifier)),g.initialize(),g}};xe([lt()],_o.prototype,"isLocked",void 0),xe([lt()],_o.prototype,"mode",void 0),xe([lt()],_o.prototype,"rotate",void 0),xe([lt()],_o.prototype,"isDropShadow",void 0),xe([lt()],_o.prototype,"isSlope",void 0),xe([lt()],_o.prototype,"isSurfaceShading",void 0),xe([lt()],_o.prototype,"slopeDirection",void 0),xe([lt()],_o.prototype,"isGrid",void 0),_o=pb=xe([li("terrain")],_o);var bs=(()=>(function(n){n[n.NONE=-1]="NONE",n[n.SQUARE=0]="SQUARE",n[n.HEX_VERTICAL=1]="HEX_VERTICAL",n[n.HEX_HORIZONTAL=2]="HEX_HORIZONTAL"}(bs||(bs={})),bs))(),gb=(()=>(function(n){n.NONE="",n.WHITE="white",n.BLACK="black"}(gb||(gb={})),gb))();let to=class extends Si{constructor(){super(...arguments),this.name="\u30c6\u30fc\u30d6\u30eb",this.width=20,this.height=20,this.gridSize=50,this.imageIdentifier="imageIdentifier",this.backgroundImageIdentifier="imageIdentifier",this.backgroundFilterType=gb.NONE,this.selected=!1,this.gridType=bs.SQUARE,this.gridColor="#000000e6",this.gridClipRect=null}get terrains(){let t=[];return this.children.forEach(e=>{e instanceof _o&&t.push(e)}),t}get masks(){let t=[];return this.children.forEach(e=>{e instanceof So&&t.push(e)}),t}get scratchMasks(){let t=[];return this.children.forEach(e=>{e instanceof Do&&t.push(e)}),t}onStoreAdded(){super.onStoreAdded(),this.selected&&Qe.trigger("SELECT_GAME_TABLE",{identifier:this.identifier})}};xe([lt()],to.prototype,"name",void 0),xe([lt()],to.prototype,"width",void 0),xe([lt()],to.prototype,"height",void 0),xe([lt()],to.prototype,"gridSize",void 0),xe([lt()],to.prototype,"imageIdentifier",void 0),xe([lt()],to.prototype,"backgroundImageIdentifier",void 0),xe([lt()],to.prototype,"backgroundFilterType",void 0),xe([lt()],to.prototype,"selected",void 0),xe([lt()],to.prototype,"gridType",void 0),xe([lt()],to.prototype,"gridColor",void 0),to=xe([li("game-table")],to);var Io=(()=>(function(n){n[n.NULL=0]="NULL",n[n.THUMBNAIL=1]="THUMBNAIL",n[n.COMPLETE=2]="COMPLETE",n[n.URL=1e3]="URL"}(Io||(Io={})),Io))();class ua{constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:""},this.isHidden=!1}get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob}get url(){return this.context.url}get isReady(){return Io.NULL<this.state}get state(){return this.url||this.blob?this.url&&!this.blob?Io.URL:Io.COMPLETE:Io.NULL}static createEmpty(t){let e=new ua;return e.context.identifier=t,e}static create(t){if("string"==typeof t){let e=new ua;return e.context.identifier=t,e.context.name=t,e.context.url=t,e}{let e=new ua;return e.apply(t),e}}static createAsync(t){return(0,xn.Z)(function*(){return t instanceof File?yield ua._createAsync(t,t.name):t instanceof Blob?yield ua._createAsync(t):void 0})()}static _createAsync(t,e){return(0,xn.Z)(function*(){let i=yield vl.readAsArrayBufferAsync(t),r=new ua;return r.context.identifier=yield vl.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:t.type}),r.context.type=r.context.blob.type,r.context.url=window.URL.createObjectURL(r.context.blob),r.context.name||(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(t){!this.context.identifier&&t.identifier&&(this.context.identifier=t.identifier),t.name&&(this.context.name=t.name),!this.context.blob&&t.blob&&(this.context.blob=t.blob),!this.context.type&&t.type&&(this.context.type=t.type),!this.context.url&&t.url&&(this.state!==Io.URL&&window.URL.revokeObjectURL(this.context.url),this.context.url=t.url),this.createURLs()}createURLs(){this.state!==Io.URL&&this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob))}revokeURLs(){this.state!==Io.URL&&window.URL.revokeObjectURL(this.context.url)}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url}}}var kp,Rf=(()=>(function(n){n[n.MASTER=0]="MASTER",n[n.AUDITION=1]="AUDITION"}(Rf||(Rf={})),Rf))();class Jt{constructor(t){this.volumeType=Rf.MASTER,this.audio=t}static get audioContext(){return Jt._audioContext||(Jt._audioContext=new(window.AudioContext||window.webkitAudioContext)),Jt._audioContext}static get volume(){return Jt._volume}static set volume(t){Jt._volume=t,Jt.masterGainNode.gain.setTargetAtTime(Jt._volume,Jt.audioContext.currentTime,.01)}static get auditionVolume(){return Jt._auditionVolume}static set auditionVolume(t){Jt._auditionVolume=t,Jt.auditionGainNode.gain.setTargetAtTime(Jt._auditionVolume,Jt.audioContext.currentTime,.01)}static get masterGainNode(){if(!Jt._masterGainNode){let t=Jt.audioContext.createGain();t.gain.setValueAtTime(Jt._volume,Jt.audioContext.currentTime),t.connect(Jt.audioContext.destination),Jt._masterGainNode=t}return Jt._masterGainNode}static get auditionGainNode(){if(!Jt._auditionGainNode){let t=Jt.audioContext.createGain();t.gain.setValueAtTime(Jt._auditionVolume,Jt.audioContext.currentTime),t.connect(Jt.audioContext.destination),Jt._auditionGainNode=t}return Jt._auditionGainNode}static get rootNode(){return Jt.masterGainNode}static get auditionNode(){return Jt.auditionGainNode}get audioElm(){return this._audioElm||(this._audioElm=new Audio,this._audioElm.onplay=()=>{},this._audioElm.onpause=()=>{this.mediaElementSource.disconnect()},this._audioElm.onended=()=>{this.mediaElementSource.disconnect()}),this._audioElm}get mediaElementSource(){return this._mediaElementSource||(this._mediaElementSource=Jt.audioContext.createMediaElementSource(this.audioElm)),this._mediaElementSource}get volume(){return this.audioElm.volume}set volume(t){this.audioElm.volume=t}get loop(){return this.audioElm.loop}set loop(t){this.audioElm.loop=t}get paused(){return this.audioElm.paused}static play(t,e=1){this.playBufferAsync(t,e)}play(t=this.audio){if(this.stop(),this.audio=t,!this.audio)return;let e=this.audio.url;t.state===Io.URL&&(Jt.cacheMap.has(t.identifier)?e=Jt.cacheMap.get(t.identifier).url:Jt.createCacheAsync(t)),this.mediaElementSource.connect(this.getConnectingAudioNode()),this.audioElm.src=e,this.audioElm.load(),this.audioElm.play().catch(i=>{console.warn(i)})}pause(){this.audioElm.pause()}stop(){!this.audioElm||(this.pause(),this.audioElm.currentTime=0,this.audioElm.src="",this.audioElm.load(),this.mediaElementSource.disconnect())}getConnectingAudioNode(){return this.volumeType===Rf.AUDITION?Jt.auditionNode:Jt.rootNode}static playBufferAsync(t,e=1){return(0,xn.Z)(function*(){let i=yield Jt.createBufferSourceAsync(t);if(!i)return;let r=Jt.audioContext.createGain();r.gain.setValueAtTime(e,Jt.audioContext.currentTime),r.connect(Jt.rootNode),i.connect(r),i.onended=()=>{i.stop(),i.disconnect(),r.disconnect(),i.buffer=null},i.start()})()}static createBufferSourceAsync(t){var e=this;return(0,xn.Z)(function*(){if(!t)return null;try{let i=t.blob;if(t.state===Io.URL)if(Jt.cacheMap.has(t.identifier))i=Jt.cacheMap.get(t.identifier).blob;else{let s=yield Jt.createCacheAsync(t);i=s&&s.blob?s.blob:null}if(!i)return null;let r=yield e.decodeAudioDataAsync(i),o=Jt.audioContext.createBufferSource();return o.buffer=r,o}catch(i){return console.warn(i),null}})()}static decodeAudioDataAsync(t){return new Promise(function(){var e=(0,xn.Z)(function*(i,r){Jt.audioContext.decodeAudioData(yield vl.readAsArrayBufferAsync(t),o=>i(o),o=>r(o))});return function(i,r){return e.apply(this,arguments)}}())}static getBlobAsync(t){return(0,xn.Z)(function*(){if(t.blob)return t.blob;if(t.url.length<1)throw new Error("\u3048\u3063 \u306a\u306b\u305d\u308c\u6016\u3044");try{let e=yield fetch(t.url);if(!e.ok)throw new Error("Network response was not ok.");return yield e.blob()}catch(e){throw console.warn("There has been a problem with your fetch operation: ",e.message),e}})()}static createCacheAsync(t){return(0,xn.Z)(function*(){let e={url:t.url,blob:null};try{e.blob=yield Jt.getBlobAsync(t)}catch(i){return console.error(i),e}return Jt.cacheMap.has(t.identifier)?Jt.cacheMap.get(t.identifier):(e.url=URL.createObjectURL(e.blob),Jt.cacheMap.set(t.identifier,e),e)})()}static resumeAudioContext(){Jt.audioContext.resume();let t=()=>{Jt.audioContext.resume(),document.removeEventListener("touchstart",t,!0),document.removeEventListener("mousedown",t,!0),console.log("resumeAudioContext")};document.addEventListener("touchstart",t,!0),document.addEventListener("mousedown",t,!0)}}Jt._volume=.5,Jt._auditionVolume=.5,Jt.cacheMap=new Map;class en{constructor(){this.hash={},console.log("AudioStorage ready...")}static get instance(){return en._instance||(en._instance=new en),en._instance}get audios(){let t=[];for(let e in this.hash)t.push(this.hash[e]);return t}destroy(){for(let t in this.hash)this.delete(t)}addAsync(t){var e=this;return(0,xn.Z)(function*(){let i=yield ua.createAsync(t);return e._add(i)})()}add(t){let e;if("string"==typeof t)e=ua.create(t);else if(t instanceof ua)e=t;else{if(this.update(t))return this.hash[t.identifier];e=ua.create(t)}return this._add(e)}_add(t){return Io.COMPLETE<=t.state&&this.lazySynchronize(100),this.update(t)?this.hash[t.identifier]:(this.hash[t.identifier]=t,console.log("add Audio: "+t.identifier),t)}update(t){let e;e=t instanceof ua?t.toContext():t;let i=this.hash[t.identifier];return!!i&&(i.apply(t),!0)}delete(t){let e=this.hash[t];return!!e&&(e.destroy(),delete this.hash[t],!0)}get(t){return this.hash[t]||null}synchronize(t){this.lazyTimer&&this.lazyTimer.stop(),Qe.call("SYNCHRONIZE_AUDIO_LIST",this.getCatalog(),t)}lazySynchronize(t,e){null==this.lazyTimer&&(this.lazyTimer=new uc(()=>this.synchronize(e),t)),this.lazyTimer.reset(t)}getCatalog(){let t=[];for(let e of en.instance.audios)Io.COMPLETE<=e.state&&t.push({identifier:e.identifier,state:e.state});return t}}let dt=(()=>{class n{}return n.dicePick="",n.dicePut="",n.diceRoll1="",n.diceRoll2="",n.cardDraw="",n.cardPick="",n.cardPut="",n.cardShuffle="",n.piecePick="",n.piecePut="",n.blockPick="",n.blockPut="",n.lock="",n.unlock="",n.sweep="",n.alarm="",n})(),$t=kp=class extends ca{onStoreAdded(){super.onStoreAdded(),Qe.register(this).on("SOUND_EFFECT",t=>{Jt.play(en.instance.get(t.data),.5)}).on("SEND_MESSAGE",t=>{let e=Xe.instance.get(t.data.messageIdentifier);!e||!e.isSendFromSelf||!e.isDicebot||(Math.random()<.5?kp.play(dt.diceRoll1):kp.play(dt.diceRoll2))})}onStoreRemoved(){super.onStoreRemoved(),Qe.unregister(this)}play(t){kp.play(t)}static play(t){let e="";e="string"==typeof t?t:t.identifier,kp._play(e)}static _play(t){Qe.call("SOUND_EFFECT",t)}};var Nf;$t=kp=xe([li("sound-effect")],$t);let da=Nf=class extends ca{constructor(){super(...arguments),this.viewTableIdentifier="",this.tableGridDummy=!1,this.gridShow=!1,this.gridSnap=!0}static get instance(){return Nf._instance||(Nf._instance=new Nf("TableSelecter"),Nf._instance.initialize()),Nf._instance}onStoreAdded(){super.onStoreAdded(),Qe.register(this).on("SELECT_GAME_TABLE",t=>{console.log("SELECT_GAME_TABLE "+this.identifier),this.viewTable&&(this.viewTable.selected=!1),this.viewTableIdentifier=t.data.identifier,this.viewTable&&(this.viewTable.selected=!0)})}onStoreRemoved(){super.onStoreRemoved(),Qe.unregister(this)}get viewTable(){let t=Xe.instance.get(this.viewTableIdentifier);return t||(t=Xe.instance.getObjects(to)[0],t&&(this.viewTableIdentifier.length<1||Xe.instance.isDeleted(this.viewTableIdentifier))&&(this.viewTableIdentifier=t.identifier,Qe.trigger("SELECT_GAME_TABLE",{identifier:t.identifier}))),t}};var _b;xe([lt()],da.prototype,"viewTableIdentifier",void 0),xe([lt()],da.prototype,"tableGridDummy",void 0),da=Nf=xe([li("TableSelecter")],da);let or=_b=class extends Qr{constructor(t=fd.generateUuid()){super(t),this.isLock=!1,this.rotate=0,this.followingCharctorIdentifier=null,this.followingCounterDummy=0,this.offSetX=!1,this.offSetY=!1,this.gridColor="#FFFF00",this.rangeColor="#000000",this.type="CORN",this.fillOutLine=!1,this.subDivisionSnapPolygonal=!0,this.gridSize=50,this.isAltitudeIndicate=!0,this.followingCharctorIdentifier=null}get name(){return this.getCommonValue("name","")}get length(){return this.getCommonValue("length",1)}get width(){return this.getCommonValue("width",1)}get opacity(){let t=this.getElement("opacity",this.commonDataElement),e=t?t.currentValue/t.value:1;return Number.isNaN(e)?1:e}followingCounterDummyCount(){this.followingCounterDummy++,this.followingCounterDummy>=50&&(this.followingCounterDummy=0),console.log(this.followingCounterDummy)}following(){let t=Xe.instance.get(this.followingCharctorIdentifier);if(!t)return console.log("\u8ffd\u5f93\u5bfe\u8c61\u898b\u5931\u3044"),void(this.followingCharctorIdentifier=null);console.log("following x:"+t.location.x+" y:"+t.location.y),this.location.x=t.location.x+this.gridSize*t.size/2,this.location.y=t.location.y+this.gridSize*t.size/2,this.followingCounterDummyCount()}static create(t,e,i,r,o){let s=null;return s=o?new _b(o):new _b,s.createDataElements(),s.commonDataElement.appendChild(st.create("name",t,{},"name_"+s.identifier)),s.commonDataElement.appendChild(st.create("length",i,{},"length_"+s.identifier)),s.commonDataElement.appendChild(st.create("width",e,{},"width_"+s.identifier)),s.commonDataElement.appendChild(st.create("opacity",r,{type:"numberResource",currentValue:r},"opacity_"+s.identifier)),s.initialize(),s}};var mb;xe([lt()],or.prototype,"isLock",void 0),xe([lt()],or.prototype,"rotate",void 0),xe([lt()],or.prototype,"followingCharctorIdentifier",void 0),xe([lt()],or.prototype,"followingCounterDummy",void 0),xe([lt()],or.prototype,"offSetX",void 0),xe([lt()],or.prototype,"offSetY",void 0),xe([lt()],or.prototype,"gridColor",void 0),xe([lt()],or.prototype,"rangeColor",void 0),xe([lt()],or.prototype,"type",void 0),xe([lt()],or.prototype,"fillOutLine",void 0),xe([lt()],or.prototype,"subDivisionSnapPolygonal",void 0),or=_b=xe([li("range")],or);let Qo=mb=class extends Qr{constructor(){super(...arguments),this.isLock=!1,this.rotate=0,this.zindex=0,this.password="",this.isUpright=!0,this.limitHeight=!1,this.overViewWidth=250,this.overViewMaxHeight=250}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get fontSize(){return this.getCommonValue("fontsize",1)}get title(){return this.getCommonValue("title","")}get text(){return this.getCommonValue("text","")}set text(t){this.setCommonValue("text",t)}toTopmost(){Pw(this)}static create(t,e,i=16,r=1,o=1,s){let a=s?new mb(s):new mb;return a.createDataElements(),a.commonDataElement.appendChild(st.create("width",r,{},"width_"+a.identifier)),a.commonDataElement.appendChild(st.create("height",o,{},"height_"+a.identifier)),a.commonDataElement.appendChild(st.create("fontsize",i,{},"fontsize_"+a.identifier)),a.commonDataElement.appendChild(st.create("title",t,{},"title_"+a.identifier)),a.commonDataElement.appendChild(st.create("text",e,{type:"note",currentValue:e},"text_"+a.identifier)),a.initialize(),a}};var Er;xe([lt()],Qo.prototype,"isLock",void 0),xe([lt()],Qo.prototype,"rotate",void 0),xe([lt()],Qo.prototype,"zindex",void 0),xe([lt()],Qo.prototype,"password",void 0),xe([lt()],Qo.prototype,"isUpright",void 0),xe([lt()],Qo.prototype,"limitHeight",void 0),xe([lt()],Qo.prototype,"overViewWidth",void 0),xe([lt()],Qo.prototype,"overViewMaxHeight",void 0),Qo=mb=xe([li("text-note")],Qo),function(n){function e(i,r=0){return i=parseFloat(i),isNaN(i)?r:i}n.relation=function t(i,r,o=0){return"number"==typeof i?i:"string"==typeof i?(i=i.trim().toLowerCase()).indexOf("%")>0?e(i.replace("%",""),o)/100*r:i.indexOf("px")>0||i.indexOf("pt")>0?e(i.replace("px",""),o):i.indexOf("vw")>0?e(i.replace("vw",""),o)/100*window.innerWidth:i.indexOf("vh")>0?e(i.replace("vh",""),o)/100*window.innerHeight:i.indexOf("vm")>0?e(i.replace("vm",""),o)/100*Math.min(window.innerWidth,window.innerHeight):i.indexOf("em")>0?e(i.replace("em",""),o):"top"===i||"left"===i?0:"center"===i||"middle"===i?.5*r:"bottom"===i||"right"===i?r:o:o},n.parse=e}(Er||(Er={}));class no{constructor(){this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1}static create(t,e=null,i=new no){return t&&t.ownerDocument?i.setCSS((e||window.getComputedStyle(t)).transform):i.identity()}setData(t){if(null==t)return;let e=t.length;return 16==e?(this.m11=t[0],this.m12=t[1],this.m13=t[2],this.m14=t[3],this.m21=t[4],this.m22=t[5],this.m23=t[6],this.m24=t[7],this.m31=t[8],this.m32=t[9],this.m33=t[10],this.m34=t[11],this.m41=t[12],this.m42=t[13],this.m43=t[14],this.m44=t[15]):6==e?(this.m11=t[0],this.m12=t[1],this.m13=0,this.m14=0,this.m21=t[2],this.m22=t[3],this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=t[4],this.m42=t[5],this.m43=0,this.m44=1):9==e&&(this.m11=t[0],this.m12=t[1],this.m13=0,this.m14=t[2],this.m21=t[3],this.m22=t[4],this.m23=0,this.m24=t[5],this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=t[6],this.m42=t[7],this.m43=0,this.m44=t[8]),this}identity(){return this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1,this}scalar(t){return this.m11*=t,this.m12*=t,this.m13*=t,this.m14*=t,this.m21*=t,this.m22*=t,this.m23*=t,this.m24*=t,this.m31*=t,this.m32*=t,this.m33*=t,this.m34*=t,this.m41*=t,this.m42*=t,this.m43*=t,this.m44*=t,this}unproject(t,e={x:0,y:0,z:0,w:1}){let i=t.x*this.m11+t.y*this.m21+this.m41,r=t.x*this.m12+t.y*this.m22+this.m42,o=t.x*this.m13+t.y*this.m23+this.m43,s=t.x*this.m14+t.y*this.m24+this.m44,a=i+this.m31,g=r+this.m32,w=o+this.m33,W=s+this.m34;0==s&&(s=1e-4),i/=s,r/=s,o/=s,0==W&&(W=1e-4),a/=W,g/=W,w/=W;let ve=w-o;if(0==ve)return e.x=i,e.y=r,e.z=o,e.w=o,e;let me=-o/ve;return i+=me*(a-i),r+=me*(g-r),e.x=i,e.y=r,e.z=o,e.w=o,e}project(t,e={x:0,y:0,z:0,w:1}){let i=t.z,r=t.x*this.m14+t.y*this.m24+i*this.m34+this.m44,o=t.x*this.m11+t.y*this.m21+i*this.m31+this.m41,s=t.x*this.m12+t.y*this.m22+i*this.m32+this.m42;return 0==r&&(r=1e-4),o/=r,s/=r,r<0&&(o-=this.m41,s-=this.m42,o*=1/r,s*=1/r,o+=this.m41,s+=this.m42),e.x=o,e.y=s,e.z=i,e.w=i,e}append(t){return no.multiply(this,t,this)}setPosition(t){return this.m41=t.x,this.m42=t.y,this.m43=t.z,this}getPosition(t={x:0,y:0,z:0,w:1}){return t.x=this.m41,t.y=this.m42,t.z=this.m43,t}static makePosition(t,e=new no){return e.identity(),e.setPosition(t),e}appendPosition(...t){let e;return e=1===t.length?t[0]:{x:t[0],y:t[1],z:t[2],w:1},this.append(no.makePosition(e,no.MATRIX3D))}static makePerspective(t,e=new no){return e.identity(),e.m34=t?-1/t:0,e}appendPerspective(t){return t?this.append(no.makePerspective(t,no.MATRIX3D)):this}invert(t){t=t||this;let e=[],i=this.m11,r=this.m12,o=this.m13,s=this.m14,a=this.m21,g=this.m22,w=this.m23,W=this.m24,ve=this.m31,me=this.m32,Se=this.m33,Oe=this.m34,Ve=this.m41,We=this.m42,Ze=this.m43,je=this.m44;e[0]=w*Oe*We-W*Se*We+W*me*Ze-g*Oe*Ze-w*me*je+g*Se*je,e[1]=s*Se*We-o*Oe*We-s*me*Ze+r*Oe*Ze+o*me*je-r*Se*je,e[2]=o*W*We-s*w*We+s*g*Ze-r*W*Ze-o*g*je+r*w*je,e[3]=s*w*me-o*W*me-s*g*Se+r*W*Se+o*g*Oe-r*w*Oe;let ut=i*e[0]+a*e[1]+ve*e[2]+Ve*e[3];return 0==ut?(console.warn("Can not invert matrix, determinant is 0"),this):(e[4]=W*Se*Ve-w*Oe*Ve-W*ve*Ze+a*Oe*Ze+w*ve*je-a*Se*je,e[5]=o*Oe*Ve-s*Se*Ve+s*ve*Ze-i*Oe*Ze-o*ve*je+i*Se*je,e[6]=s*w*Ve-o*W*Ve-s*a*Ze+i*W*Ze+o*a*je-i*w*je,e[7]=o*W*ve-s*w*ve+s*a*Se-i*W*Se-o*a*Oe+i*w*Oe,e[8]=g*Oe*Ve-W*me*Ve+W*ve*We-a*Oe*We-g*ve*je+a*me*je,e[9]=s*me*Ve-r*Oe*Ve-s*ve*We+i*Oe*We+r*ve*je-i*me*je,e[10]=r*W*Ve-s*g*Ve+s*a*We-i*W*We-r*a*je+i*g*je,e[11]=s*g*ve-r*W*ve-s*a*me+i*W*me+r*a*Oe-i*g*Oe,e[12]=w*me*Ve-g*Se*Ve-w*ve*We+a*Se*We+g*ve*Ze-a*me*Ze,e[13]=r*Se*Ve-o*me*Ve+o*ve*We-i*Se*We-r*ve*Ze+i*me*Ze,e[14]=o*g*Ve-r*w*Ve-o*a*We+i*w*We+r*a*Ze-i*g*Ze,e[15]=r*w*ve-o*g*ve+o*a*me-i*w*me-r*a*Se+i*g*Se,t.setData(e),t.scalar(1/ut),t)}setCSS(t){if(!t||"none"==t)return this.identity();let e=t.replace("matrix3d(","").replace("matrix(","").replace(")","").split(","),i=e.length;for(let r=0;r<i;++r)e[r]=Er.parse(e[r]);return this.setData(e)}appendCSS(t,e=!1){return t&&"none"!=t?e&&t.indexOf("matrix3d")>=0?this.append(no.MATRIX3D.setCSS(t).flatten()):this.append(no.MATRIX3D.setCSS(t)):this}flatten(){return this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m44=1,this.m14=0,this.m24=0,this.m43=0,this}static multiply(t,e,i=new no){let o=t.m11*e.m12+t.m12*e.m22+t.m13*e.m32+t.m14*e.m42,s=t.m11*e.m13+t.m12*e.m23+t.m13*e.m33+t.m14*e.m43,a=t.m11*e.m14+t.m12*e.m24+t.m13*e.m34+t.m14*e.m44,g=t.m21*e.m11+t.m22*e.m21+t.m23*e.m31+t.m24*e.m41,w=t.m21*e.m12+t.m22*e.m22+t.m23*e.m32+t.m24*e.m42,W=t.m21*e.m13+t.m22*e.m23+t.m23*e.m33+t.m24*e.m43,ve=t.m21*e.m14+t.m22*e.m24+t.m23*e.m34+t.m24*e.m44,me=t.m31*e.m11+t.m32*e.m21+t.m33*e.m31+t.m34*e.m41,Se=t.m31*e.m12+t.m32*e.m22+t.m33*e.m32+t.m34*e.m42,Oe=t.m31*e.m13+t.m32*e.m23+t.m33*e.m33+t.m34*e.m43,Ve=t.m31*e.m14+t.m32*e.m24+t.m33*e.m34+t.m34*e.m44,We=t.m41*e.m11+t.m42*e.m21+t.m43*e.m31+t.m44*e.m41,Ze=t.m41*e.m12+t.m42*e.m22+t.m43*e.m32+t.m44*e.m42,je=t.m41*e.m13+t.m42*e.m23+t.m43*e.m33+t.m44*e.m43,ut=t.m41*e.m14+t.m42*e.m24+t.m43*e.m34+t.m44*e.m44;return i.m11=t.m11*e.m11+t.m12*e.m21+t.m13*e.m31+t.m14*e.m41,i.m12=o,i.m13=s,i.m14=a,i.m21=g,i.m22=w,i.m23=W,i.m24=ve,i.m31=me,i.m32=Se,i.m33=Oe,i.m34=Ve,i.m41=We,i.m42=Ze,i.m43=je,i.m44=ut,i}toString(t=3){return"m11="+this.m11.toFixed(t)+"\tm21="+this.m21.toFixed(t)+"\tm31="+this.m31.toFixed(t)+"\tm41="+this.m41.toFixed(t)+"\nm12="+this.m12.toFixed(t)+"\tm22="+this.m22.toFixed(t)+"\tm32="+this.m32.toFixed(t)+"\tm42="+this.m42.toFixed(t)+"\nm13="+this.m13.toFixed(t)+"\tm23="+this.m23.toFixed(t)+"\tm33="+this.m33.toFixed(t)+"\tm43="+this.m43.toFixed(t)+"\nm14="+this.m14.toFixed(t)+"\tm24="+this.m24.toFixed(t)+"\tm34="+this.m34.toFixed(t)+"\tm44="+this.m44.toFixed(t)}}no.MATRIX3D=new no;class qm{constructor(t){this.matrix=new no,this.sceneTransform=new no,this.inverseSceneTransform=new no,this.initialize(t)}clear(){return this.element=null,this.matrix.identity(),this}initialize(t){if(!t)return;this.element=t;let e=window.getComputedStyle(t),i=0,r=0;return this.element.parentElement?(i=this.element.parentElement.clientWidth,r=this.element.parentElement.clientHeight):(i=window.innerWidth,r=window.innerHeight),this.paddingLeft=Er.relation(e.paddingTop,i),this.paddingTop=Er.relation(e.paddingTop,r),this.marginLeft=Er.relation(e.marginLeft,i),this.marginTop=Er.relation(e.marginTop,r),this.borderLeft=Er.relation(e.borderLeft,i),this.borderTop=Er.relation(e.borderTop,r),this.matrix.setCSS(e.transform),this.sceneTransform.identity(),this.extract(this,this.sceneTransform),this.sceneTransform.invert(this.inverseSceneTransform),this}globalToLocal(t,e,i=0){let r={x:t,y:e,z:i,w:1};return this.inverseSceneTransform.unproject(r,r),this.fromBorderBox(r),r}localToGlobal(t,e,i=0){let r={x:t,y:e,z:i,w:1};return this.sceneTransform.project(r,r),this.fromBorderBox(r),r}localToLocal(t,e,i,r){let o_x=t,o_y=e,o_z=i,s=new qm(r),a=no.multiply(this.sceneTransform,s.inverseSceneTransform),g={x:0,y:0,z:0,w:1};return g.x=o_x*a.m11+o_y*a.m21+o_z*a.m31+1*a.m41,g.y=o_x*a.m12+o_y*a.m22+o_z*a.m32+1*a.m42,g.z=o_x*a.m13+o_y*a.m23+o_z*a.m33+1*a.m43,g.w=o_x*a.m14+o_y*a.m24+o_z*a.m34+1*a.m44,s.clear(),this.toBorderBox(g),g}extract(t,e){let r=t.element;for(;r;)this.extractMatrix(r,e),r&&"fixed"===r.style.position&&(console.warn("fixed\u9818\u57df\u306f\u8a08\u7b97\u304c\u4e0d\u6b63\u78ba"),e.appendPosition(window.pageXOffset,window.pageYOffset,0)),r=r.parentElement}extractMatrix(t,e=null){if(e||(e=new no),!t)return e;let i=t,r=window.getComputedStyle(t);if("none"!=r.transform){let a=r.transformOrigin?r.transformOrigin.split(" "):[],g=Er.relation(a[0],i.offsetWidth,.5*i.offsetWidth),w=Er.relation(a[1],i.offsetHeight,.5*i.offsetHeight),W=Er.relation(a[2],0,0);e.appendPosition(-g,-w,-W),e.appendCSS(r.transform),e.appendPosition(g,w,W)}let o=this.getPosition(t);e.appendPosition(o.x,o.y,0);let s=0;if(t.parentElement){let a=window.getComputedStyle(t.parentElement);s=Er.parse(a.perspective)}if(t.parentElement&&s){let g=window.getComputedStyle(t.parentElement).perspectiveOrigin.split(" "),w=Er.relation(g[0],i.parentElement.offsetWidth),W=Er.relation(g[1],i.parentElement.offsetHeight);e.appendPosition(-w,-W,0),e.appendPerspective(s),e.appendPosition(w,W,0)}return e}getPosition(t){let e={x:0,y:0};return e.x=t.offsetParent?t.parentElement===t.offsetParent?t.offsetLeft:t.parentElement.offsetParent===t.offsetParent?t.offsetLeft-t.parentElement.offsetLeft:0:t.offsetLeft,e.y=t.offsetParent?t.parentElement===t.offsetParent?t.offsetTop:t.parentElement.offsetParent===t.offsetParent?t.offsetTop-t.parentElement.offsetTop:0:t.offsetTop,e.x+=t.offsetParent?t.offsetParent.clientLeft:0,e.y+=t.offsetParent?t.offsetParent.clientTop:0,e}fromBorderBox(t){t.x+=this.paddingLeft,t.y+=this.paddingTop,t.x-=this.marginLeft,t.y-=this.marginTop,t.x-=this.borderLeft,t.y-=this.borderTop}toBorderBox(t){t.x-=this.paddingLeft,t.y-=this.paddingTop,t.x+=this.marginLeft,t.y+=this.marginTop,t.x+=this.borderLeft,t.y+=this.borderTop}}let $d=(()=>{class n{constructor(e){this.pointerDeviceService=e,this.tabletopOriginElement=document.body}convertToLocal(e,i=document.body){let r=new qm(i),o=r.globalToLocal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:o.x,y:o.y,z:o.z}}convertToGlobal(e,i=document.body){let r=new qm(i),o=r.localToGlobal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:o.x,y:o.y,z:o.z}}convertLocalToLocal(e,i,r){let o=new qm(i),s=o.globalToLocal(e.x,e.y,e.z?e.z:0),a=o.localToLocal(s.x,s.y,0,r);return o.clear(),{x:a.x,y:a.y,z:a.z}}calcTabletopLocalCoordinate(e={x:this.pointerDeviceService.pointers[0].x,y:this.pointerDeviceService.pointers[0].y,z:0},i=this.pointerDeviceService.targetElement){return i.contains(this.tabletopOriginElement)?(e=this.convertToLocal(e,this.tabletopOriginElement)).z=0:e=this.convertLocalToLocal(e,i,this.tabletopOriginElement),{x:e.x,y:e.y,z:0<e.z?e.z:0}}}return n.\u0275fac=function(e){return new(e||n)(In(Di))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Wm=(()=>{class n{constructor(e){this.coordinateService=e,this._emptyTable=new to(""),this.locationMap=new Map,this.parentMap=new Map,this.characterCache=new Xc(()=>Xe.instance.getObjects(Lt).filter(i=>i.isVisibleOnTable)),this.cardCache=new Xc(()=>Xe.instance.getObjects(Jr).filter(i=>i.isVisibleOnTable)),this.cardStackCache=new Xc(()=>Xe.instance.getObjects(wr).filter(i=>i.isVisibleOnTable)),this.tableMaskCache=new Xc(()=>{let i=this.tableSelecter.viewTable;return i?i.masks:[]}),this.tableScratchMaskCache=new Xc(()=>{let i=this.tableSelecter.viewTable;return i?i.scratchMasks:[]}),this.rangeCache=new Xc(()=>Xe.instance.getObjects(or).filter(i=>i.isVisibleOnTable)),this.terrainCache=new Xc(()=>{let i=this.tableSelecter.viewTable;return i?i.terrains:[]}),this.textNoteCache=new Xc(()=>Xe.instance.getObjects(Qo)),this.diceSymbolCache=new Xc(()=>Xe.instance.getObjects(vs)),this.initialize()}get tableSelecter(){return da.instance}get currentTable(){return this.tableSelecter.viewTable||this._emptyTable}get characters(){return this.characterCache.objects}get cards(){return this.cardCache.objects}get cardStacks(){return this.cardStackCache.objects}get tableMasks(){return this.tableMaskCache.objects}get tableScratchMasks(){return this.tableScratchMaskCache.objects}get ranges(){return this.rangeCache.objects}get terrains(){return this.terrainCache.objects}get textNotes(){return this.textNoteCache.objects}get diceSymbols(){return this.diceSymbolCache.objects}get peerCursors(){return Xe.instance.getObjects(_t)}initialize(){this.refreshCacheAll(),Qe.register(this).on("UPDATE_GAME_OBJECT",e=>{if(e.data.identifier===this.currentTable.identifier||e.data.identifier===this.tableSelecter.identifier)return this.refreshCache(So.aliasName),this.refreshCache(Do.aliasName),void this.refreshCache(_o.aliasName);let i=Xe.instance.get(e.data.identifier);i&&i instanceof Qr?this.shouldRefreshCache(i)&&(this.refreshCache(e.data.aliasName),this.updateMap(i)):this.refreshCache(e.data.aliasName)}).on("DELETE_GAME_OBJECT",e=>{let i=e.data.aliasName;i?this.refreshCache(i):this.refreshCacheAll()}).on("XML_LOADED",e=>{let i=e.data.xmlElement;console.log("parseXml todo:\u7acb\u4f53\u5730\u5f62\u306e\u4e0a\u306b\u30c9\u30ed\u30c3\u30d7\u3057\u305f\u6642\u306e\u6319\u52d5");let r=er.instance.parseXml(i);if(r instanceof Qr){console.log("TabletopObject \u8ffd\u52a0");let s=this.coordinateService.calcTabletopLocalCoordinate();r.location.x=s.x-25,r.location.y=s.y-25,r.posZ=s.z,this.placeToTabletop(r),$t.play(dt.piecePut)}else r instanceof Va&&Vs.instance.addChatTab(r);let o=Xe.instance.getObjects(Lt);for(let s of o)s instanceof Lt&&(console.log("GameCharacter Load \u8ffd\u52a0\u30c7\u30fc\u30bf\u78ba\u8a8d"),s.addExtendData())})}findCache(e){switch(e){case Lt.aliasName:return this.characterCache;case Jr.aliasName:return this.cardCache;case wr.aliasName:return this.cardStackCache;case So.aliasName:return this.tableMaskCache;case Do.aliasName:return this.tableScratchMaskCache;case or.aliasName:return this.rangeCache;case _o.aliasName:return this.terrainCache;case Qo.aliasName:return this.textNoteCache;case vs.aliasName:return this.diceSymbolCache;default:return null}}refreshCache(e){let i=this.findCache(e);i&&i.refresh()}refreshCacheAll(){this.characterCache.refresh(),this.cardCache.refresh(),this.cardStackCache.refresh(),this.tableMaskCache.refresh(),this.tableScratchMaskCache.refresh(),this.rangeCache.refresh(),this.terrainCache.refresh(),this.textNoteCache.refresh(),this.diceSymbolCache.refresh(),this.clearMap()}shouldRefreshCache(e){return this.locationMap.get(e.identifier)!==e.location.name||this.parentMap.get(e.identifier)!==e.parentId}updateMap(e){this.locationMap.set(e.identifier,e.location.name),this.parentMap.set(e.identifier,e.parentId)}clearMap(){this.locationMap.clear(),this.parentMap.clear()}placeToTabletop(e){switch(e.aliasName){case So.aliasName:e instanceof So&&(e.isLock=!1);case _o.aliasName:if(e instanceof _o&&(e.isLocked=!1),!this.tableSelecter||!this.tableSelecter.viewTable)return;this.tableSelecter.viewTable.appendChild(e);break;default:e.setLocation("table")}}}return n.\u0275fac=function(e){return new(e||n)(In($d))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();class Xc{constructor(t){this.refreshCollector=t,this.needsRefresh=!0,this._objects=[]}get objects(){return this.needsRefresh&&(this._objects=this.refreshCollector(),this._objects=this._objects?this._objects:[],this.needsRefresh=!1),this._objects}refresh(){this.needsRefresh=!0}}var yl;let Of=yl=class extends Si{constructor(){super(...arguments),this._defaultDiceBot="DiceBot",this._roomVolume=1,this._roomGridDispAlways=!1}get defaultDiceBot(){return""==this._defaultDiceBot?"DiceBot":this._defaultDiceBot}set defaultDiceBot(t){this._defaultDiceBot=t}get roomVolume(){return this._roomVolume}set roomVolume(t){this._roomVolume=t}get jukebox(){return Xe.instance.get("Jukebox")}get roomGridDispAlways(){return this._roomGridDispAlways}set roomGridDispAlways(t){this._roomGridDispAlways=t}static get instance(){return yl._instance||(yl._instance=new yl("Config"),yl._instance.initialize()),yl._instance}parseInnerXml(t){let e=yl.instance.toContext();e.syncData=this.toContext().syncData,yl.instance.apply(e),yl.instance.update(),super.parseInnerXml.apply(yl.instance,[t]),this.destroy()}apply(t){let e=this._roomVolume,i=this._defaultDiceBot;super.apply(t),i!==this._defaultDiceBot&&console.log("this._defaultDiceBot\u5909\u66f4"),e!==this._roomVolume&&(this.jukebox.setNewVolume(),console.log("\u5168\u4f53\u30dc\u30ea\u30e5\u30fc\u30e0\u5909\u66f4"))}};xe([lt()],Of.prototype,"_defaultDiceBot",void 0),xe([lt()],Of.prototype,"_roomVolume",void 0),xe([lt()],Of.prototype,"_roomGridDispAlways",void 0),Of=yl=xe([li("config")],Of);class Bf{constructor(t,e,i){this.chanks=[],this.chankSize=32768,this.chankReceiveCount=0,this.sentChankIndex=0,this.bufferingChankRange=4,this.completedChankIndex=0,this.startTime=0,this.isCanceled=!1,this.identifier=t,this.sendTo=e,this.data=i}static createSendTask(t,e,i){let r=new Bf(t,e,i);return r.onstart=()=>r.initializeSend(),r}static createReceiveTask(t){let e=new Bf(t);return e.onstart=()=>e.initializeReceive(),e}start(t){this.onstart?(this.data=t,this.onstart(),this.onstart=null):console.warn("\u518d\u8d77\u52d5\u3059\u308b\u4ed5\u69d8\u306a\u3069\u7121\u3044\u3002")}progress(t,e){this.onprogress&&this.onprogress(this,t,e)}finish(){this.isCanceled||(this.isCanceled=!0,this.onfinish&&this.onfinish(this,this.data),this.dispose())}timeout(){this.isCanceled||(this.isCanceled=!0,this.ontimeout&&this.ontimeout(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}cancel(){this.isCanceled||(null!=this.sendTo&&Qe.call("CANCEL_TASK_"+this.identifier,null,this.sendTo),this._cancel())}_cancel(){this.isCanceled||(this.isCanceled=!0,this.oncancel&&this.oncancel(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}dispose(){Qe.unregister(this),this.sendChankTimer&&function q9(n){ym.delete(n)}(this.sendChankTimer),this.timeoutTimer&&this.timeoutTimer.clear(),this.sendChankTimer=null,this.timeoutTimer=null,this.onprogress=this.onfinish=this.ontimeout=this.oncancel=null}initializeSend(){this.uint8Array=la.encode(this.data);let t=Math.ceil(this.uint8Array.byteLength/this.chankSize);this.chanks=new Array(t),console.log("\u30c1\u30e3\u30f3\u30af\u5206\u5272 "+this.identifier,this.chanks.length),Qe.register(this).on("FILE_MORE_CHANK_"+this.identifier,e=>{this.sendTo===e.sendFrom&&(this.completedChankIndex=e.data,null==this.sendChankTimer&&this.sentChankIndex+1<this.chanks.length&&this.sendChank(this.sentChankIndex+1),this.resetTimeout())}).on("DISCONNECT_PEER",e=>{e.data.peerId===this.sendTo&&(console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,e.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,e=>{console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,e.sendFrom),this._cancel()}),this.sentChankIndex=this.completedChankIndex=0,this.startTime=performance.now(),Yo(()=>this.sendChank(0))}sendChank(t){let e=this.uint8Array.slice(t*this.chankSize,(t+1)*this.chankSize);Qe.call("FILE_SEND_CHANK_"+this.identifier,{index:t,length:this.chanks.length,chank:e},this.sendTo),this.sentChankIndex=t,this.sendChankTimer=null,this.chanks.length<=t+1?(console.log("\u30d0\u30c3\u30d5\u30a1\u9001\u4fe1\u5b8c\u4e86",this.identifier),this.outputTransferRate(this.uint8Array.byteLength),Yo(()=>this.finish())):this.completedChankIndex+this.bufferingChankRange<=t?this.resetTimeout():this.sendChankTimer=Yo(()=>{this.sendChank(this.sentChankIndex+1)})}initializeReceive(){this.resetTimeout(),this.startTime=performance.now(),this.chankReceiveCount=0,Qe.register(this).on("FILE_SEND_CHANK_"+this.identifier,t=>{this.chanks.length<1&&(this.chanks=new Array(t.data.length)),null==this.chanks[t.data.index]?(this.chankReceiveCount++,this.chanks[t.data.index]=t.data.chank,this.progress(t.data.index,t.data.length),this.chanks.length<=this.chankReceiveCount?this.finishReceive():(this.resetTimeout(),Qe.call("FILE_MORE_CHANK_"+this.identifier,t.data.index,t.sendFrom))):console.log(`already received. [${t.data.index}] <${this.identifier}>`)}).on("DISCONNECT_PEER",t=>{t.data.peerId===this.sendTo&&(console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,t.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,t=>{console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,t.sendFrom),this._cancel()})}finishReceive(){console.log("\u30d0\u30c3\u30d5\u30a1\u53d7\u4fe1\u5b8c\u4e86",this.identifier);let t=0;for(let r of this.chanks)t+=r.byteLength;this.outputTransferRate(t);let e=new Uint8Array(t),i=0;for(let r of this.chanks)e.set(r,i),i+=r.byteLength;this.data=la.decode(e),this.finish()}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new uc(()=>this.timeout(),1e4)),this.timeoutTimer.reset()}outputTransferRate(t){let e=performance.now()-this.startTime,i=t/1024/1024/(e/1e3);console.log(`${(t/1024).toFixed(2)}KB ${(e/1e3).toFixed(2)}\u79d2 \u8ee2\u9001\u901f\u5ea6: ${i.toFixed(2)}MB/s`)}}class Mp{constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4}static get instance(){return Mp._instance||(Mp._instance=new Mp),Mp._instance}initialize(){console.log("AudioSharingSystem ready..."),this.destroy(),Qe.register(this).on("CONNECT_PEER",-1,t=>{!t.isSendFromSelf||(console.log("CONNECT_PEER AudioStorageService !!!",t.data.peerId),en.instance.synchronize())}).on("SYNCHRONIZE_AUDIO_LIST",t=>{if(t.isSendFromSelf)return;console.log("SYNCHRONIZE_AUDIO_LIST "+t.sendFrom);let e=t.data,i=[];console.log("SYNCHRONIZE_AUDIO_LIST active tasks ",this.sendTaskMap.size+this.receiveTaskMap.size);for(let o of e){let s=en.instance.get(o.identifier);null===s&&(s=ua.createEmpty(o.identifier),en.instance.add(s)),s.state<Io.COMPLETE&&!this.receiveTaskMap.has(o.identifier)&&i.push({identifier:o.identifier,state:s.state})}if(i.length<1&&!this.hasActiveTask()&&e.length<en.instance.getCatalog().length&&en.instance.synchronize(t.sendFrom),i.length<1||this.isLimitReceiveTask())return;let r=Math.floor(Math.random()*i.length);this.request([i[r]],t.sendFrom)}).on("REQUEST_AUDIO_RESOURE",t=>{if(t.isSendFromSelf)return;let e=t.data.identifiers,i=[];for(let r of e){let o=en.instance.get(r.identifier);o&&r.state<o.state&&i.push({identifier:r.identifier,state:r.state})}if(!1===this.isLimitSendTask()&&0<i.length&&!this.existsSendTask(t.data.receiver)){console.log("REQUEST_AUDIO_RESOURE Send!!! "+t.data.receiver+" -> "+i);let r=Math.floor(Math.random()*i.length),s=en.instance.get(i[r].identifier);this.startSendTask(s,t.data.receiver)}else{let r=t.data.candidatePeers,o=r.indexOf(bt.peerId);-1<o&&r.splice(o,1);for(let s of r)return console.log("REQUEST_AUDIO_RESOURE AudioStorageService Relay!!! "+s+" -> "+t.data.identifiers),void Qe.call(t,s);console.log("REQUEST_FILE_RESOURE AudioStorageService \u3042\u3076\u308c\u305f..."+t.data.receiver,i.length)}}).on("UPDATE_AUDIO_RESOURE",1e3,t=>{let e=t.data;console.log("UPDATE_AUDIO_RESOURE AudioStorageService "+t.sendFrom+" -> ",e);for(let i of e)i.blob&&(i.blob=new Blob([i.blob],{type:i.type})),en.instance.add(i)}).on("START_AUDIO_TRANSMISSION",t=>{console.log("START_AUDIO_TRANSMISSION "+t.data.fileIdentifier);let e=t.data.fileIdentifier,i=en.instance.get(e);this.receiveTaskMap.has(e)||i&&Io.COMPLETE<=i.state?(console.warn("CANCEL_TASK_ "+e),Qe.call("CANCEL_TASK_"+e,null,t.sendFrom)):this.startReceiveTask(e)})}destroy(){Qe.unregister(this)}startSendTask(t,e){var i=this;return(0,xn.Z)(function*(){let r=Bf.createSendTask(t.identifier,e);i.sendTaskMap.set(t.identifier,r),Qe.call("START_AUDIO_TRANSMISSION",{fileIdentifier:t.identifier},e);let o={identifier:t.identifier,name:t.name,blob:null,type:"",url:null};t.state===Io.URL?o.url=t.url:(o.blob=yield vl.readAsArrayBufferAsync(t.blob),o.type=t.blob.type),r.onfinish=()=>{i.stopSendTask(r.identifier),en.instance.synchronize()},r.start(o)})()}startReceiveTask(t){let e=en.instance.get(t),i=Bf.createReceiveTask(t);this.receiveTaskMap.set(t,i),i.onprogress=(r,o,s)=>{let a=e.toContext();a.name=(100*o/s).toFixed(1)+"%",e.apply(a)},i.onfinish=(r,o)=>{this.stopReceiveTask(r.identifier),o&&Qe.trigger("UPDATE_AUDIO_RESOURE",[o]),en.instance.synchronize()},i.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(t){let e=this.sendTaskMap.get(t);e&&e.cancel(),this.sendTaskMap.delete(t),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(t){let e=this.receiveTaskMap.get(t);e&&e.cancel(),this.receiveTaskMap.delete(t),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(t,e){console.log("requestFile() "+e);let i=bt.peerIds;i.splice(i.indexOf(bt.peerId),1),Qe.call("REQUEST_AUDIO_RESOURE",{identifiers:t,receiver:bt.peerId,candidatePeers:i},e)}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(t){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===t)return!0;return!1}}var Lf,Zm=Ce(4327),CP=Ce(5650);!function(n){const t={avif:"image/avif",gif:"image/gif",jpg:"image/jpeg",jpeg:"image/jpeg",jpe:"image/jpeg",jfif:"image/jpeg",pjpeg:"image/jpeg",pjp:"image/jpeg",png:"image/png",apng:"image/apng",webp:"image/webp",svg:"image/svg+xml",svgz:"image/svg+xml",ico:"image/x-icon",cur:"image/x-icon",bmp:"image/bmp",html:"text/html",htm:"text/html",shtml:"text/html",xml:"text/xml",yml:"text/yaml",yaml:"text/yaml",json:"application/json",map:"application/json",zip:"application/zip",mp3:"audio/mp3",wav:"audio/wav",m4a:"audio/aac",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",mp4:"video/mp4",webm:"video/webm"};n.type=function e(r){let o=r.replace(/.*[\.\/\\]/,"").toLowerCase();return t[o]?t[o]:""},n.extension=function i(r){for(let o in t)if(t[o]===r)return o;return r.split("/")[1]}}(Lf||(Lf={}));class Cl{constructor(){this.networkService=bt,this.maxImageSize=2097152,this.maxAudioeSize=10485760,console.log("FileArchiver ready...")}static get instance(){return Cl._instance||(Cl._instance=new Cl),Cl._instance}get reloadCheck(){return Xe.instance.get("ReloadCheck")}initialize(){this.destroy(),this.addEventListeners()}destroy(){this.removeEventListeners()}addEventListeners(){this.removeEventListeners(),this.callbackOnDragEnter=t=>this.onDragEnter(t),this.callbackOnDragOver=t=>this.onDragOver(t),this.callbackOnDrop=t=>this.onDrop(t),document.body.addEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.addEventListener("dragover",this.callbackOnDragOver,!1),document.body.addEventListener("drop",this.callbackOnDrop,!1)}removeEventListeners(){document.body.removeEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.removeEventListener("dragover",this.callbackOnDragOver,!1),document.body.removeEventListener("drop",this.callbackOnDrop,!1),this.callbackOnDragEnter=null,this.callbackOnDragOver=null,this.callbackOnDrop=null}onDragEnter(t){t.preventDefault()}onDragOver(t){t.preventDefault()}onDrop(t){t.preventDefault(),this.reloadCheck.reloadCheckStart(""!=this.networkService.peerContext.roomName),console.log("onDrop",t.dataTransfer),this.load(t.dataTransfer.files)}load(t){var e=this;return(0,xn.Z)(function*(){if(!t)return;let i=t instanceof FileList?wP(t):t;for(let r of i)yield e.handleImage(r),yield e.handleAudio(r),yield e.handleText(r),yield e.handleZip(r),Qe.trigger("FILE_LOADED",{file:r})})()}handleImage(t){var e=this;return(0,xn.Z)(function*(){if(!(t.type.indexOf("image/")<0)&&e.reloadCheck.isLoadOk()){if(e.maxImageSize<t.size)return void console.warn(`File size limit exceeded. -> ${t.name} (${(t.size/1024/1024).toFixed(2)}MB)`);console.log(t.name+" type:"+t.type),yield St.instance.addAsync(t)}})()}handleAudio(t){var e=this;return(0,xn.Z)(function*(){if(!(t.type.indexOf("audio/")<0)){if(e.maxAudioeSize<t.size)return void console.warn(`File size limit exceeded. -> ${t.name} (${(t.size/1024/1024).toFixed(2)}MB)`);console.log(t.name+" type:"+t.type),yield en.instance.addAsync(t)}})()}handleText(t){var e=this;return(0,xn.Z)(function*(){if(t.type.indexOf("text/")<0)return;let i=!0;if(("config.xml"==t.name||"imagetag.xml"==t.name||"summary.xml"==t.name)&&(i=e.reloadCheck.isLoadOk()),i){console.log(t.name+" type:"+t.type);try{let r=Yc.xml2element(yield vl.readAsTextAsync(t));r&&Qe.trigger("XML_LOADED",{xmlElement:r})}catch(r){console.warn(r)}}})()}handleZip(t){var e=this;return(0,xn.Z)(function*(){if(!(0<=t.type.indexOf("application/")||t.type.length<1))return;let i=new CP;try{i=yield i.loadAsync(t)}catch(o){return void console.warn(o)}let r=[];i.forEach((o,s)=>r.push(s));for(let o of r)try{let s=yield o.async("arraybuffer");console.log(o.name+" \u89e3\u51cd..."),yield e.load([new File([s],o.name,{type:Lf.type(o.name)})])}catch(s){console.warn(s)}})()}saveAsync(t,e,i){return(0,xn.Z)(function*(){if(!t)return;let r=t instanceof FileList?wP(t):t,o=new CP;for(let a of r)o.file(a.name,a);let s=yield o.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}},i);(0,Zm.saveAs)(s,e+".zip")})()}}function wP(n){let t=[],e=n.length;for(let i=0;i<e;i++)t.push(n[i]);return t}class Ap{constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4,console.log("FileSharingSystem ready...")}static get instance(){return Ap._instance||(Ap._instance=new Ap),Ap._instance}initialize(){var t=this;Qe.register(this).on("CONNECT_PEER",1,e=>{!e.isSendFromSelf||(console.log("CONNECT_PEER ImageStorageService !!!",e.data.peerId),St.instance.synchronize())}).on("XML_LOADED",e=>{!function wG(n){let t=[],e=n.querySelectorAll('*[type="image"]');for(let i=0;i<e.length;i++){let r=e[i].innerHTML;!St.instance.get(r)&&0<Lf.type(r).length&&t.push(r)}e=n.querySelectorAll("*[imageIdentifier]");for(let i=0;i<e.length;i++){let r=e[i].getAttribute("imageIdentifier");!St.instance.get(r)&&0<Lf.type(r).length&&t.push(r)}for(let i of t)St.instance.add(i)}(e.data.xmlElement)}).on("SYNCHRONIZE_FILE_LIST",e=>{if(e.isSendFromSelf)return;console.log("SYNCHRONIZE_FILE_LIST ImageStorageService "+e.sendFrom);let i=e.data,r=[];for(let o of i){let s=St.instance.get(o.identifier);null===s&&(s=Bt.createEmpty(o.identifier),St.instance.add(s)),s.state<Hr.COMPLETE&&!this.receiveTaskMap.has(o.identifier)&&r.push({identifier:o.identifier,state:s.state})}r.length<1&&!this.hasActiveTask()&&i.length<St.instance.getCatalog().length&&St.instance.synchronize(e.sendFrom),!(r.length<1||this.isLimitReceiveTask())&&this.request(r,e.sendFrom)}).on("REQUEST_FILE_RESOURE",function(){var e=(0,xn.Z)(function*(i){if(i.isSendFromSelf)return;let r=i.data.identifiers,o=[];for(let s of r){let a=St.instance.get(s.identifier);a&&s.state<a.state&&o.push({identifier:s.identifier,state:s.state})}if(!1===t.isLimitSendTask()&&0<o.length&&!t.existsSendTask(i.data.receiver)){let s=t.makeSendUpdateImages(o);console.log("REQUEST_FILE_RESOURE ImageStorageService Send!!! "+i.data.receiver+" -> "+s.length),t.startSendTask(s,i.data.receiver)}else{let s=i.data.candidatePeers,a=s.indexOf(bt.peerId);-1<a&&s.splice(a,1);for(let g of s)return console.log("REQUEST_FILE_RESOURE ImageStorageService Relay!!! "+g+" -> "+i.data.identifiers),void Qe.call(i,g);console.log("REQUEST_FILE_RESOURE ImageStorageService \u3042\u3076\u308c\u305f..."+i.data.receiver,o.length)}});return function(i){return e.apply(this,arguments)}}()).on("UPDATE_FILE_RESOURE",1e3,e=>{let i=e.data.updateImages;console.log("UPDATE_FILE_RESOURE ImageStorageService "+e.sendFrom+" -> ",i);for(let r of i)r.blob&&(r.blob=new Blob([r.blob],{type:r.type})),r.thumbnail.blob&&(r.thumbnail.blob=new Blob([r.thumbnail.blob],{type:r.thumbnail.type})),St.instance.add(r)}).on("START_FILE_TRANSMISSION",e=>{console.log("START_FILE_TRANSMISSION "+e.data.taskIdentifier);let i=e.data.taskIdentifier,r=St.instance.get(i);this.receiveTaskMap.has(i)||r&&Hr.COMPLETE<=r.state?(console.warn("CANCEL_TASK_ "+i),Qe.call("CANCEL_TASK_"+i,null,e.sendFrom)):this.startReceiveTask(i)})}destroy(){Qe.unregister(this)}startSendTask(t,e){var i=this;return(0,xn.Z)(function*(){let r=1===t.length?t[0].identifier:fd.generateUuid(),o=Bf.createSendTask(r,e);i.sendTaskMap.set(o.identifier,o),Qe.call("START_FILE_TRANSMISSION",{taskIdentifier:r},e);for(let s of t)s.thumbnail.blob?s.thumbnail.blob=yield vl.readAsArrayBufferAsync(s.thumbnail.blob):s.blob&&(s.blob=yield vl.readAsArrayBufferAsync(s.blob));o.onfinish=(s,a)=>{i.stopSendTask(s.identifier),St.instance.synchronize()},o.start(t)})()}startReceiveTask(t){let e=Bf.createReceiveTask(t);this.receiveTaskMap.set(t,e),e.onfinish=(i,r)=>{this.stopReceiveTask(i.identifier),r&&Qe.trigger("UPDATE_FILE_RESOURE",{identifier:i.identifier,updateImages:r}),St.instance.synchronize()},e.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(t){let e=this.sendTaskMap.get(t);e&&e.cancel(),this.sendTaskMap.delete(t),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(t){let e=this.receiveTaskMap.get(t);e&&e.cancel(),this.receiveTaskMap.delete(t),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(t,e){console.log("requestFile() "+e);let i=bt.peerIds;i.splice(i.indexOf(bt.peerId),1),Qe.call("REQUEST_FILE_RESOURE",{identifiers:t,receiver:bt.peerId,candidatePeers:i},e)}makeSendUpdateImages(t,e=524288){let i=[],r=0;for(let o=t.length-1;0<=o;o--){let s=Math.floor(Math.random()*(o+1));[t[o],t[s]]=[t[s],t[o]]}t.sort((o,s)=>o.state<s.state?-1:o.state>s.state?1:0);for(let o=0;o<t.length;o++){let s=t[o],a=St.instance.get(s.identifier),g={identifier:a.identifier,name:a.name,type:"",blob:null,url:null,thumbnail:{type:"",blob:null,url:null}};a.state===Hr.URL?g.url=a.url:s.state===Hr.NULL?(g.thumbnail.blob=a.thumbnail.blob,g.thumbnail.type=a.thumbnail.type):(g.blob=a.blob,g.type=a.blob.type);let w=g.blob?g.blob.size:g.thumbnail.blob?g.thumbnail.blob.size:100;if(i.push(g),r+=w,e<r)break}return i}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(t){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===t)return!0;return!1}}const Fw=new Map,Rw=new Set;let Nw=!1;function EP(n,t=bt.peerId){Fw.set(n.identifier,{object:n,originFrom:t}),n instanceof Si&&function EG(n){let t=n;for(;t&&(Rw.add(t.identifier),t=t.parent,t!==n););TP()}(n.parent),TP()}function TP(){Nw||(queueMicrotask(TG),Nw=!0)}const TG=()=>{Nw=!1;let n=Array.from(Fw.values()),t=Array.from(Rw.values());Fw.clear(),Rw.clear();for(let e of n){let i={aliasName:e.object.aliasName,identifier:e.object.identifier};Qe.trigger(new Cp(`UPDATE_GAME_OBJECT/aliasName/${i.aliasName}`,i,e.originFrom)),Qe.trigger(new Cp(`UPDATE_GAME_OBJECT/identifier/${i.identifier}`,i,e.originFrom))}for(let e of t)Qe.trigger(`UPDATE_OBJECT_CHILDREN/identifier/${e}`,{identifier:e})};class Tr{constructor(t){this.peerId=t,this.requestMap=new Map}static create(t,e){Tr.tasksMap.size<1&&Qe.register(Tr.key).on("DISCONNECT_PEER",r=>{Tr.onDisconnect(r.data.peerId)}).on("UPDATE_GAME_OBJECT",r=>{r.isSendFromSelf||Tr.onUpdate(r.data.identifier)}).on("DELETE_GAME_OBJECT",r=>{r.isSendFromSelf||Tr.onUpdate(r.data.identifier)});let i=new Tr(t);return i.initialize(e),i}cancel(){this.timeoutTimer&&this.timeoutTimer.clear(),this.timeoutTimer=null,this.onsynchronize=this.onfinish=this.ontimeout=null;for(let t of this.requestMap.values())this.deleteTasksMap(t.identifier);this.requestMap.clear()}initialize(t){for(let e of t){e.ttl--,this.requestMap.set(e.identifier,e);let i=Tr.tasksMap.get(e.identifier);null==i&&(i=[]),i.push(this),Tr.tasksMap.set(e.identifier,i);let r=null!=this.peerId&&e.holderIds.includes(this.peerId)?this.peerId:null;Qe.call("REQUEST_GAME_OBJECT",e.identifier,r)}this.requestMap.size<1?setTimeout(()=>this.finish()):this.resetTimeout()}finish(){this.onfinish&&this.onfinish(this),this.cancel()}timeout(){this.ontimeout&&this.ontimeout(this,Array.from(this.requestMap.values()).filter(t=>0<=t.ttl)),this.finish()}static onDisconnect(t){for(let e of Tr.tasksMap.values())for(let i of e.concat())i.peerId===t&&i.timeout();Tr.tasksMap.size<1&&Qe.unregister(Tr.key)}static onUpdate(t){if(!Tr.tasksMap.has(t))return;let e=Tr.tasksMap.get(t);for(let i of e.concat())i.onUpdate(t);Tr.tasksMap.size<1&&Qe.unregister(Tr.key)}onUpdate(t){this.requestMap.delete(t),this.onsynchronize&&this.onsynchronize(this,t),this.requestMap.size<1?this.finish():this.resetTimeout()}deleteTasksMap(t){let e=Tr.tasksMap.get(t),i=e.indexOf(this);-1<i&&e.splice(i,1),e.length<1&&Tr.tasksMap.delete(t)}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new uc(()=>this.timeout(),3e4)),this.timeoutTimer.reset()}}Tr.key={},Tr.tasksMap=new Map;class Pp{constructor(){this.requestMap=new Map,this.peerMap=new Map,this.tasks=[]}static get instance(){return Pp._instance||(Pp._instance=new Pp),Pp._instance}initialize(){this.destroy(),console.log("ObjectSynchronizer ready..."),Qe.register(this).on("CONNECT_PEER",2,t=>{!t.isSendFromSelf||(console.log("CONNECT_PEER GameRoomService !!!",t.data.peerId),this.sendCatalog(t.data.peerId))}).on("DISCONNECT_PEER",t=>{this.removePeerMap(t.data.peerId)}).on("SYNCHRONIZE_GAME_OBJECT",t=>{if(t.isSendFromSelf)return;console.log("SYNCHRONIZE_GAME_OBJECT "+t.sendFrom);let e=t.data;for(let i of e)Xe.instance.isDeleted(i.identifier)?Qe.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:i.identifier},t.sendFrom):this.addRequestMap(i,t.sendFrom);this.synchronize()}).on("REQUEST_GAME_OBJECT",t=>{if(!t.isSendFromSelf)if(Xe.instance.isDeleted(t.data))Qe.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:t.data},t.sendFrom);else{let e=Xe.instance.get(t.data);e&&Qe.call("UPDATE_GAME_OBJECT",e.toContext(),t.sendFrom)}}).on("UPDATE_GAME_OBJECT",1e3,t=>{let e=t.data,i=Xe.instance.get(e.identifier);i?(t.isSendFromSelf||(i=this.updateObject(i,e)),EP(i,t.sendFrom)):Xe.instance.isDeleted(e.identifier)?Qe.call("DELETE_GAME_OBJECT",{aliasName:e.aliasName,identifier:e.identifier},t.sendFrom):(i=this.createObject(e),EP(i,t.sendFrom))}).on("DELETE_GAME_OBJECT",1e3,t=>{Xe.instance.delete(t.data.identifier,!1)})}destroy(){Qe.unregister(this)}updateObject(t,e){return e.majorVersion+e.minorVersion>t.version&&t.apply(e),t}createObject(t){let e=hc.instance.create(t.aliasName,t.identifier);if(e)return Xe.instance.add(e,!1),e.apply(t),e;console.warn(t.aliasName+" is Unknown...?",t)}sendCatalog(t){let e=Xe.instance.getCatalog(),i=setInterval(()=>{Qe.call("SYNCHRONIZE_GAME_OBJECT",e.splice(0,e.length<2048?e.length:2048),t),e.length<1&&clearInterval(i)})}addRequestMap(t,e){let i=this.requestMap.get(t.identifier);i&&i.version===t.version?(i.holderIds.push(e),this.addPeerMap(e)):(!i||i.version<t.version)&&(this.requestMap.set(t.identifier,{identifier:t.identifier,version:t.version,holderIds:[e],ttl:2}),this.addPeerMap(e))}addPeerMap(t){this.peerMap.has(t)||this.peerMap.set(t,[])}removePeerMap(t){this.peerMap.delete(t)}synchronize(){for(;0<this.requestMap.size&&this.tasks.length<32;)this.runSynchronizeTask()}runSynchronizeTask(){let t=this.getTargetPeerId(),e=this.makeRequestList(t);if(e.length<1)return void this.removePeerMap(t);let i=Tr.create(t,e);this.tasks.push(i);let r=this.peerMap.get(t);r&&r.push(i),i.onfinish=o=>{this.tasks.splice(this.tasks.indexOf(o),1);let s=this.peerMap.get(t);s&&s.splice(s.indexOf(o),1),this.synchronize()},i.ontimeout=(o,s)=>{console.log("GameObject synchronize \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8"),s.forEach(a=>this.requestMap.set(a.identifier,a))}}makeRequestList(t,e=32){let i=[];for(let[r,o]of this.requestMap){if(e<=i.length)break;if(!o.holderIds.includes(t))continue;let s=Xe.instance.get(o.identifier);(!s||s.version<o.version)&&i.push(o),this.requestMap.delete(r)}return i}getTargetPeerId(){let t=9999,e=null,i=bt.peerContexts;for(let r=i.length-1;0<=r;r--){let o=Math.floor(Math.random()*(r+1));[i[r],i[o]]=[i[o],i[r]]}for(let r of i){let o=this.peerMap.get(r.peerId);r.isOpen&&o&&o.length<t&&(t=o.length,e=r.peerId)}return e}}class SP{constructor(t="Queue"){this.name=t,this.queue=Promise.resolve(),this._length=0}get length(){return this._length}add(t){this._length++,console.log(`${this.name} add: ${this._length}`),this.queue=this.queue.then("function"==typeof t.then?()=>t:0<t.length?()=>new Promise(t):t);let e=this.queue;return this.queue=this.queue.catch(i=>{console.error(i)}),this.queue=this.queue.then(()=>{this._length--,console.log(`${this.name} done: ${this._length}`)}),e}}var Ow;let _c=Ow=class extends Si{constructor(){super(...arguments),this.name="\u30c0\u30a4\u30b9\u8868",this.command="SAMPLE",this.dice="1d6",this.text=""}get diceTablePalette(){for(let t of this.children)if(t instanceof Gm)return t;return null}static create(){let t=new Ow;t.name="\u767d\u7d19\u306e\u30c0\u30a4\u30b9\u8868",t.initialize();let e=new Gm("table_"+t.identifier);return e.setPalette("\u30c0\u30a4\u30b9\u8868\u5165\u529b\u4f8b\uff1a\n1:\u30c0\u30a4\u30b9\u8868\u30c1\u30e3\u30fc\u30c8\u4f8b\u3010\u68ee\u3011\n2:\u30c0\u30a4\u30b9\u8868\u30c1\u30e3\u30fc\u30c8\u4f8b\u3010\u6d77\u3011\n3:\u30c0\u30a4\u30b9\u8868\u30c1\u30e3\u30fc\u30c8\u4f8b\u3010\u5e73\u5730\u3011\n4:\u30c0\u30a4\u30b9\u8868\u30c1\u30e3\u30fc\u30c8\u4f8b\u3010\u6cbc\u3011\n5:\u30c0\u30a4\u30b9\u8868\u30c1\u30e3\u30fc\u30c8\u4f8b\u3010\u7a7a\u3011\n6:\u30c0\u30a4\u30b9\u8868\u30c1\u30e3\u30fc\u30c8\u4f8b\u3010\u5c71\u3011"),e.initialize(),t.appendChild(e),t}apply(t){super.apply(t)}};xe([lt()],_c.prototype,"name",void 0),xe([lt()],_c.prototype,"command",void 0),xe([lt()],_c.prototype,"dice",void 0),_c=Ow=xe([li("dice-table")],_c);var Sr,DP=Ce(5904);class Qc extends DP.default{constructor(t,e){const i=t.replace(/^repeat/i,"x").replace(/^rep/i,"x").match(/^x([0-9]+)\s+(.*)/i);let r,o;null!==i?(o=parseInt(i[1],10),o<=0&&(o=1),r=i[2]):(o=1,r=t);const s=r.replace(/^KD/i,"2D6").replace(/^SKD/i,"S2D6");super(o>1?`x${o} ${s}`:s,e),this.command=t,this.commandWithoutRepeat=r,this.repeat=o}static eval(t){return new Qc(t).eval()}eval(){return this.commandWithoutRepeat.match(/^KD/i)||this.commandWithoutRepeat.match(/^SKD/i)?this.custom_dice():super.eval()}custom_dice(){const t=super.eval();if(null==t)return null;let i,e=0;for(let o=0;o<this.repeat;o++)t.detailedRands[2*o].value===t.detailedRands[2*o+1].value&&(e+=1);i=1==this.repeat&&1==e?" \uff1e \u30be\u30ed\u76ee\uff01":e>=1?`\n\n\uff1e \u30be\u30ed\u76ee${e}\u500b\uff01`:"";const r=t.text+i;return Object.assign(Object.assign({},t),{text:r})}}Qc.ID="KariDice",Qc.NAME="\u4eee\u30c0\u30a4\u30b9",Qc.SORT_KEY="\u304b\u308a\u305f\u3044\u3059",Qc.COMMAND_PATTERN=/^S?([+\-(]*\d+|\d+B\d+|C[+\-(]*\d+|choice|D66|(repeat|rep|x)\d+|\d+R\d+|\d+U\d+|BCDiceVersion|KD)/i,Qc.HELP_MESSAGE="\n\u30fbKD\n\u30be\u30ed\u76ee\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3057\u307e\u3059\n".trim();class Jc extends DP.default{constructor(t,e){const i=t.replace(/^repeat/i,"x").replace(/^rep/i,"x").match(/^x([0-9]+)\s+(.*)$/i);let r,o;null!==i?(o=parseInt(i[1],10),o<=0&&(o=1),r=i[2]):(o=1,r=t);let s="",g=r.match(/^([S]?)ID(\d*)<=([\d\-\+\*\/\(\)CR]+)(.*)$/i);if(g){let me=""==g[2]?"1":g[2],Se=g[2];return parseInt(me,10)<1&&(me="1",Se=""),s=g[1]+me+"b100<="+g[3],super(o>1?`x${o} ${s}`:s,e),console.log("matchResult"+g),this.commandWithoutRepeat=r,this.repeat=o,this.dicenum=parseInt(me,10),this.option=g[4].split(/\s/)[0],this.optionCommand(this.option),void(this.dispCommandId=g[1]+"ID"+Se+"<=")}if(g=r.match(/^([S]?)1d100<=([\d\-\+\*\/\(\)CR]+)(.*)$/i),g&&""==g[3].split(/\s/)[0])return console.log("matchResult"+g),s=g[1]+"1d100<="+g[2],super(o>1?`x${o} ${s}`:s,e),console.log("matchResult"+g),this.commandWithoutRepeat=g[1]+"1d100<="+g[2],this.repeat=o,this.dicenum=1,void(this.dispCommandId="1d100<=");if(g=r.match(/^([S]?)RES\(([\d\-\+\*\/\(\)CR]+)\)(.*)$/i),g&&""==g[3].split(/\s/)[0])return s=g[1]+"1d100<=("+g[2]+")*5+50",super(o>1?`x${o} ${s}`:s,e),console.log("matchResult"+g),this.commandWithoutRepeat=r,void(this.repeat=o);if(g=r.match(/^([S]?)CBR\((\d+),(\d+)\)(.*)$/i),g&&""==g[4].split(/\s/)[0]){const me=parseInt(g[2],10),Se=parseInt(g[3],10);return s=g[1]+"1d100<="+(me<Se?me:Se),console.log("val1:"+me+" val2:"+Se+" text:"+s),super(o>1?`x${o} ${s}`:s,e),console.log("matchResult"+g),this.commandWithoutRepeat=r,this.repeat=o,void(this.dispCommandCbr="1d100<="+g[2]+","+g[3])}s=r,super(o>1?`x${o} ${s}`:s,e),this.commandWithoutRepeat=r,this.repeat=o,this.dispCommandId=""}static eval(t){return new Jc(t).eval()}eval(){return this.commandWithoutRepeat.match(/^S?ID/i)?this.chkOptionCommand(this.option)?this.custom_dice_id():null:this.dispCommandId.match(/^1d100<=/i)?this.custom_dice_d100():this.commandWithoutRepeat.match(/^S?RES/i)?this.custom_dice_res():this.commandWithoutRepeat.match(/^S?CBR/i)?this.custom_dice_cbr():super.eval()}chkOptionCommand(t){return""==t.replace(/P/i,"S4C10").replace(/S\d+/i,"").replace(/C\d+/i,"").replace(/F\d+|B/i,"")}optionCommand(t){this.critical=5,this.famble=96,this.special=5;const e=t.match(/C(\d+)/i);e&&(this.critical=parseInt(e[1],10));const i=t.match(/F(\d+)/i);i&&(this.famble=parseInt(i[1],10));const r=t.match(/S(\d+)/i);r&&(this.special=parseInt(r[1],10)),t.match(/B/i)&&(this.famble=100),t.match(/P/i)&&(this.special=4,this.critical=10),console.log("C:"+this.critical+" F:"+this.famble+" S:"+this.special)}diceResultTextSingleId(t){let e="("+this.dispCommandId.toUpperCase()+this.target+")";if(5!=this.special&&(e+=" S"+this.special),5!=this.critical&&(e+=" C"+this.critical),96!=this.famble&&(e+=" F"+this.famble),e+=" \uff1e ",1==t.length)e+=t[0]+" \uff1e ",e+=t[0]>=this.famble?"\u81f4\u547d\u7684\u5931\u6557":t[0]>this.target?"\u5931\u6557":t[0]<=this.critical&&t[0]<=this.target/this.special?"\u6c7a\u5b9a\u7684\u6210\u529f/\u30b9\u30da\u30b7\u30e3\u30eb":t[0]<=this.critical?"\u6c7a\u5b9a\u7684\u6210\u529f":t[0]<=this.target/this.special?"\u30b9\u30da\u30b7\u30e3\u30eb":"\u6210\u529f";else{for(let i=0;i<t.length;i++)0!=i&&(e+=","),e+=t[i];e+=" \uff1e ";for(let i=0;i<t.length;i++)0!=i&&(e+=","),e+=t[i]>=100?"100F":t[i]>=this.famble?"F":t[i]>this.target?"X":t[i]<=1?"1C":t[i]<=this.critical?"C":t[i]<=this.target/this.special?"S":"N"}return e}custom_dice_id(){const t=super.eval();if(null==t)return null;console.log("result:"+t.text);const e=t.text.match(/b100<=(\d+)/i);if(!e)return null;this.target=parseInt(e[1],10);let i="";for(let o=0;o<this.repeat;o++){const s=[];for(let a=0;a<this.dicenum;a++)s.push(t.detailedRands[this.dicenum*o+a].value);this.repeat>1?(o>0&&(i+="\n\n"),i+="#"+(o+1)+"\n"+this.diceResultTextSingleId(s)):i+=this.diceResultTextSingleId(s)}const r=i;return Object.assign(Object.assign({},t),{text:r})}diceResultTextSingleD100(t){let e="("+this.dispCommandId.toUpperCase()+this.target+")";return this.critical=5,this.famble=96,this.special=5,e+=" \uff1e "+t+" \uff1e ",e+=t>=this.famble?"\u81f4\u547d\u7684\u5931\u6557":t>this.target?"\u5931\u6557":t<=this.critical&&t<=this.target/this.special?"\u6c7a\u5b9a\u7684\u6210\u529f/\u30b9\u30da\u30b7\u30e3\u30eb":t<=this.critical?"\u6c7a\u5b9a\u7684\u6210\u529f":t<=this.target/this.special?"\u30b9\u30da\u30b7\u30e3\u30eb":"\u6210\u529f",e}custom_dice_d100(){const t=super.eval();if(null==t)return null;console.log("result:"+t.text);const e=t.text.match(/1d100<=(\d+)/i);if(!e)return null;this.target=parseInt(e[1],10),console.log("target:"+e);let i="";for(let o=0;o<this.repeat;o++){let s;s=t.detailedRands[o].value,this.repeat>1?(o>0&&(i+="\n\n"),i+="#"+(o+1)+"\n"+this.diceResultTextSingleD100(s)):i+=this.diceResultTextSingleD100(s)}const r=i;return Object.assign(Object.assign({},t),{text:r})}diceResultTextSingleRes(t,e){let i="(1D100<="+e+") \uff1e ";return e>=100?i+="\u81ea\u52d5\u6210\u529f":e<=0?i+="\u81ea\u52d5\u5931\u6557":t<=e?(i+=t+" \uff1e ",i+="\u6210\u529f"):(i+=t+" \uff1e ",i+="\u5931\u6557"),i}custom_dice_res(){const t=super.eval();if(null==t)return null;console.log("result:"+t.text);const e=t.text.match(/1d100<=(\d+)/i);if(!e)return null;const i=parseInt(e[1],10);let r="";for(let s=0;s<this.repeat;s++){const a=t.detailedRands[s].value;console.log("dice value:"+a),this.repeat>1?(s>0&&(r+="\n\n"),r+="#"+(s+1)+"\n"+this.diceResultTextSingleRes(a,i)):r+=this.diceResultTextSingleRes(a,i)}const o=r;return Object.assign(Object.assign({},t),{text:o})}diceResultTextSingleCbr(t,e){let i="("+this.dispCommandCbr+") \uff1e ";return this.target=e,this.critical=5,this.special=5,this.famble=96,i+=t+" \uff1e ",i+=t>=this.famble?"\u81f4\u547d\u7684\u5931\u6557":t>this.target?"\u5931\u6557":t<=this.critical&&t<=this.target/this.special?"\u6c7a\u5b9a\u7684\u6210\u529f/\u30b9\u30da\u30b7\u30e3\u30eb":t<=this.critical?"\u6c7a\u5b9a\u7684\u6210\u529f":t<=this.target/this.special?"\u30b9\u30da\u30b7\u30e3\u30eb":"\u6210\u529f",i}custom_dice_cbr(){const t=super.eval();if(null==t)return null;console.log("result:"+t.text);const e=t.text.match(/1d100<=(\d+)/i);if(!e)return null;const i=parseInt(e[1],10);let r="";for(let s=0;s<this.repeat;s++){const a=t.detailedRands[s].value;console.log("dice value:"+a),this.repeat>1?(s>0&&(r+="\n\n"),r+="#"+(s+1)+"\n"+this.diceResultTextSingleCbr(a,i)):r+=this.diceResultTextSingleCbr(a,i)}const o=r;return Object.assign(Object.assign({},t),{text:o})}}Jc.ID="IdoDice",Jc.NAME="\u30a4\u30c9\u306e\u8a3c\u660e",Jc.SORT_KEY="\u3044\u3068\u306e\u3057\u3087\u3046\u3081\u3044",Jc.COMMAND_PATTERN=/^S?([+\-(]*\d+|\d+B\d+|C[+\-(]*\d+|choice|D66|(repeat|rep|x)\d+|\d+R\d+|\d+U\d+|BCDiceVersion|ID\d*<=[+\-(]*\d+|RES\([\+\-\d\(\)\/\*CR]+\)|CBR\(\d+,\d+\))/i,Jc.HELP_MESSAGE="\n\u30fb\u5186\u67f1\u306e\u8eab\u5185\u7528\u306b\u4f5c\u6210\u3057\u305f\u30ab\u30b9\u30bf\u30e0\u30c0\u30a4\u30b9\n1d100\u3068\u76ee\u6a19\u5024\u306b\u3088\u308b\u6210\u529f\u5ea6\u3092\u7b97\u51fa\u3057\u307e\u3059\u3002\n\n\u30fbCoC\u3068\u306f\u4f3c\u3066\u3044\u307e\u3059\u304c\u5224\u5b9a\u57fa\u6e96\u7d30\u90e8\u304c\u7570\u306a\u308a\u307e\u3059\u3002\n\n\u30fbF\u5024(\u6a19\u6e9696)\u4ee5\u4e0a\uff1e\u30d5\u30a1\u30f3\u30d6\u30eb\n\u30fb\u76ee\u6a19\u5024\u3092\u8d85\u3048\u308b\uff1e\u5931\u6557\n\u30fb\u76ee\u6a19\u5024\u3092\u4ee5\u4e0b\uff1e\u6210\u529f\n\u30fb1/S\u5024(\u6a19\u6e961/5)\u4ee5\u4e0b\uff1e\u30b9\u30da\u30b7\u30e3\u30eb\n\u30fbC\u5024(\u6a19\u6e965)\u4ee5\u4e0b\uff1e\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\n\n\u30fb\u5c02\u7528\u547d\u4ee4(ID<=x(\u30aa\u30d7\u30b7\u30e7\u30f3\u6587\u5b57\uff1a\u7701\u7565\u53ef))\n  \u4f7f\u7528\u4f8b)\u6280\u80fd\u5024200\u3067\u5224\u5b9a\u3059\u308b\u5834\u5408\n  ID<=200 :1d100<=200\u3068\u540c\u3058\n  (ID<=200) \u2192 31 \u2192 \u30b9\u30da\u30b7\u30e3\u30eb\n  \u25a0\u8ffd\u52a0\u6587\u5b57\u5b9a\u7fa9\n    Fn\uff1aF\u5024n\u3067\u5224\u5b9a \u7121\u6307\u5b9a\u306fn=96\u6271\u3044\n      ID<=200F90\n      (ID<=200F90) F90 \u2192 91 \u2192 \u81f4\u547d\u7684\u5931\u6557\n    Sn\uff1aS\u5024\u30921/n\u306b\u5909\u66f4\u3059\u308b \u7121\u6307\u5b9an=5\u6271\u3044\n      ID<=200S3\n      (ID<=200S3) S3 \u2192 65 \u2192 \u30b9\u30da\u30b7\u30e3\u30eb\n    Cn\uff1aC\u5024\u3092n\u306b\u5909\u66f4\u3059\u308b \u7121\u6307\u5b9an=5\u6271\u3044\n      ID<=200C10\n      (ID<=200C10) C10 \u2192 10 \u2192 \u6c7a\u5b9a\u7684\u6210\u529f/\u30b9\u30da\u30b7\u30e3\u30eb\n    P\uff1a\u30d1\u30fc\u30d5\u30a7\u30af\u30c8\u30aa\u30fc\u30c0\u30fc\u72b6\u614bS\u50241/4\u3001C10\u3067\u5224\u5b9a(S4C10\u3068\u540c\u3058)\n      ID<=200P\n      (ID<=200P) S4 C10 \u2192 41 \u2192 \u30b9\u30da\u30b7 \u30e3\u30eb\n    B\uff1a\u30dc\u30b9\u30d5\u30e9\u30b0F\u5024100\u3067\u5224\u5b9a(F100\u3068\u540c\u3058)\n    ID<=200B\n    (ID<=200B) F100 \u2192 99 \u2192 \u6210\u529f\n    \u8907\u6570\u7a2e\u540c\u6642\u5b9a\u7fa9\u53ef\u80fd\n      ID<=200BC20S3\u3000\u30dc\u30b9\u304cC\u502420S1/3\u3067\u5224\u5b9a\n      (ID<=200BC20S3) S3 C20 F100 \u2192 15 \u2192 \u6c7a\u5b9a\u7684\u6210\u529f/\u30b9\u30da\u30b7\u30e3\u30eb\n\n\u30fb\u8907\u6570\u5224\u5b9a(IDy<=x(\u30aa\u30d7\u30b7\u30e7\u30f3\u6587\u5b57\uff1a\u7701\u7565\u53ef)):\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u524d\u8ff0\u306e\u66f8\u5f0f\u3068\u540c\u69d8\n\n    y\u56de\u306e\u5224\u5b9a\u7d50\u679c\u3092\n    C\uff08\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\uff09S\uff08\u30b9\u30da\u30b7\u30e3\u30eb\uff091C\uff081\u30af\u30ea\uff09F\uff08\u30d5\u30a1\u30f3\u30d6\u30eb\uff09\n    100F\uff08100\u30d5\u30a1\u30f3\u30d6\u30eb\uff09N\uff08\u901a\u5e38\u6210\u529f\uff09X\uff08\u5931\u6557\uff09\u3067\u8868\u793a\n\n    IDy<=x \u3067\u76ee\u6a19\u5024x\u3067y\u56de\u5224\u5b9a\n      ID4<=85\u3000\u3000\u4fee\u9a13\u5f8b\u52d54\u4eba\u639b\u3051\u7b49\n      (ID4<=85) \u2192 73,60,12,64 \u2192 N,N,S,N\n\n    \u30aa\u30d7\u30b7\u30e7\u30f3\u6587\u5b57\u6307\u5b9a\u4f8b\n      ID3<=120PB \u30d1\u30d5\u30a7\u30aa\u30dc\u30b9\u4e71\u69cd\n      (ID3<=120PB) S4 C10 F100 \u2192 4,81,21 \u2192 C,N,S\n".trim();let sr=Sr=class extends ca{static getCustomGameSystemInfo(t,e){return{id:t.ID,name:t.NAME,className:t.ID,sortKey:t.SORT_KEY,locale:e,superClassName:"Base"}}static listAvailableGameSystems(){const t=Sr.loader.listAvailableGameSystems();return t.push(this.getCustomGameSystemInfo(Qc,"ja_jp")),t.push(this.getCustomGameSystemInfo(Jc,"ja_jp")),t}static diceRollAsync(t,e){return(0,xn.Z)(function*(){return Sr.queue.add(()=>{try{const i=e.eval(t);if(i)return console.log("diceRoll!!!",i.text),console.log("isSecret!!!",i.secret),{id:e.ID,result:`${e.ID} : ${i.text}`.replace(/\n?(#\d+)\n/gi,"$1 "),isSecret:i.secret}}catch(i){console.error(i)}return{id:e.ID,result:"",isSecret:!1}})})()}static getHelpMessage(t){return(0,xn.Z)(function*(){try{return(yield Sr.loadGameSystemAsync(t)).HELP_MESSAGE}catch(e){console.error(e)}return""})()}static loadCustomGameSystem(t){return"KariDice"==t?Qc:"IdoDice"==t?Jc:null}static loadGameSystemAsync(t){var e=this;return(0,xn.Z)(function*(){return yield Sr.queue.add(()=>{let i=e.loadCustomGameSystem(t);if(i)return i;const r=e.diceBotInfos.some(o=>o.id===t)?t:"DiceBot";try{return Sr.loader.getGameSystemClass(r)}catch(o){return Sr.loader.dynamicLoad(r)}})})()}static initializeDiceBotQueue(){let t=new SP("DiceBotQueue");return t.add((0,xn.Z)(function*(){Sr.loader=new((yield Ce.e(2460).then(Ce.bind(Ce,383))).default),Sr.diceBotInfos=Sr.listAvailableGameSystems().sort((e,i)=>e.sortKey<i.sortKey?-1:e.sortKey>i.sortKey?1:0)})),t}getDiceTables(){return Xe.instance.getObjects(_c)}static deleteMyselfResourceBuff(t){let e=!0,i=!1,r=!1,o=!1,s="";for(let a=0;a<t.length;a++){let g=t[a];e&&g.match(/[tT\uff54\uff34]/)?(e=!1,i=!0,o=!1,r=!1,console.log("sendChat\u6587\u5b57\u7f6e\u63dbmatch(/[tT\uff54\uff34]/)"),s+=t[a]):i&&g.match(/[:\uff1a&\uff06]/)?(e=!1,i=!1,o=!1,r=!0,console.log("sendChat\u6587\u5b57\u7f6e\u63dbmatch(/[:\uff1a&\uff06]/)"),s+=t[a]):(r||e||o)&&g.match(/[:\uff1a&\uff06]/)?(e=!1,i=!1,o=!0,r=!1):g.match(/\s/)?(e=!0,i=!1,o=!1,r=!1,s+=t[a],console.log("sendChat\u6587\u5b57\u7f6e\u63dbmatch(/\\s/)")):(e=!1,o||(s+=t[a]))}return s}checkSecretEditCommand(t){let r=(" "+Xo.toHalfWidth(t).toLowerCase()).replace("\uff1a",":").match(/\sST?:/i);return console.log(r),!!r}checkSecretDiceCommand(t,e){const r=Xo.toHalfWidth(e).toLowerCase().replace(/^(\d+)?\s+/,"repeat1 ").replace(/^x(\d+)?\s+/,"repeat1 ").replace(/repeat(\d+)?\s+/,""),o=/^s(.*)?/gi.exec(r);return console.log("checkSecretDiceCommand:"+e+" gameSystem.name:"+t.name),t.COMMAND_PATTERN?o&&t.COMMAND_PATTERN.test(o[1]):(console.log("checkSecretDiceCommand:"+!1),!1)}onStoreAdded(){var t=this;super.onStoreAdded(),Qe.register(this).on("SEND_MESSAGE",function(){var e=(0,xn.Z)(function*(i){const r=Xe.instance.get(i.data.messageIdentifier);if(!r||!r.isSendFromSelf||r.isSystem)return;let o;o=Xo.toHalfWidth(i.data.messageTrget?i.data.messageTrget.text:r.text);const s=r.tags?r.tags[0]:"";try{const a=/^((\d+)?\s+)?(.*)?/gi.exec(o),g=null!=a[2]?Number(a[2]):1;let w=null!=a[3]?a[3]:o;console.log("SEND_MESSAGE gameType :"+s);const W=yield Sr.loadGameSystemAsync(s);if(W.COMMAND_PATTERN&&!W.COMMAND_PATTERN.test(w)||!w||g<1)return;g>1&&(w=`x${g} ${w}`);const ve=yield Sr.diceRollAsync(w,W);if(!ve.result)return;i.data.messageTrget&&i.data.messageTrget.object?t.sendResultMessage(ve,r," ["+i.data.messageTrget.object.name+"]"):t.sendResultMessage(ve,r)}catch(a){console.error(a)}});return function(i){return e.apply(this,arguments)}}()).on("DICE_TABLE_MESSAGE",function(){var e=(0,xn.Z)(function*(i){console.log("\u30c0\u30a4\u30b9\u8868\u5224\u5b9a");const r=Xe.instance.get(i.data.messageIdentifier);if(!r||!r.isSendFromSelf||r.isSystem)return;const o=Xo.toHalfWidth(r.text).trim(),s=o.split(/\s/),a=t.getDiceTables();if(!a||0==s.length)return;console.log("\u30b3\u30de\u30f3\u30c9\u5019\u88dc:"+s[0]);let w=null;for(const W of a)W.command==s[0]&&(w=W);if(w)try{const W=/^((\d+)?\s+)?(.*)?/gi.exec(w.dice),ve=null!=W[2]?Number(W[2]):1,me=null!=W[3]?W[3]:o,Se={id:null,result:"",isSecret:!1};for(let We=0;We<ve&&We<32;We++){const Ze=yield Sr.loadGameSystemAsync(w.diceTablePalette.dicebot),je=yield Sr.diceRollAsync(me,Ze);if(je.result.length<1)break;Se.result+=je.result,Se.isSecret=Se.isSecret||je.isSecret,1<ve&&(Se.result+=` #${We+1}`)}const Oe=Se.result.match(/\d+$/);let Ve="\u30c0\u30a4\u30b9\u76ee\u306e\u756a\u53f7\u304c\u8868\u306b\u3042\u308a\u307e\u305b\u3093";if(Oe){console.log("rolledDiceNum:"+Oe[0]);const We=w.diceTablePalette.getPalette();console.log("tablePalette:"+We);for(const Ze in We)console.log("oneTable:"+We[Ze]),We[Ze].split(/[:\uff1a,\uff0c\s]/)[0]==Oe[0]&&(Ve=We[Ze].replace(/\\n/g,"\n"))}Se.result+="\n"+Ve,t.sendResultMessage(Se,r)}catch(W){console.error(W)}});return function(i){return e.apply(this,arguments)}}()).on("RESOURCE_EDIT_MESSAGE",function(){var e=(0,xn.Z)(function*(i){const r=Xe.instance.get(i.data.messageIdentifier);r&&r.isSendFromSelf&&!r.isSystem&&(Xo.toHalfWidth(r.text),console.log("\u30ea\u30bd\u30fc\u30b9\u64cd\u4f5c\u5224\u5b9a"),t.checkResourceEditCommand(r,i.data.messageTargetContext?i.data.messageTargetContext:[]))});return function(i){return e.apply(this,arguments)}}()).on("APRIL_MESSAGE",function(){var e=(0,xn.Z)(function*(i){const r=Xe.instance.get(i.data.messageIdentifier);if(!r||!r.isSendFromSelf||r.isSystem)return;const o=Xo.toHalfWidth(r.text),s=o.split(/\s/),a=yield Sr.loadGameSystemAsync(r.tags?r.tags[0]:"");if(!t.getDiceTables()||0==s.length)return;if("#\u307e\u305d\u3063\u3077"==s[0]||"#\u30a8\u30a4\u30d7\u30ea\u30eb"==s[0])return void setTimeout(()=>{t.alertAprilMessage(r)},10);if("#\u3048\u3044\u3077\u308a\u308b"!=s[0])return;console.log("\u3048\u3044\u3077\u308a\u308b\u5b9f\u884c:"+s[0]+":"+s[1]+":"+s.length);let w="2d6",W="d6";if(s.length>=2){const je=s[1].toLowerCase();("1d4"==je||"4"==je)&&(w="1d4",W="d4"),("1d6"==je||"6"==je)&&(w="1d6",W="d6"),"2d6"==je&&(w="2d6",W="d6"),("1d8"==je||"8"==je)&&(w="1d8",W="d8"),("1d10"==je||"10"==je)&&(w="1d10",W="d10"),("1d12"==je||"12"==je)&&(w="1d12",W="d12"),("1d20"==je||"20"==je)&&(w="1d20",W="d20"),("1d100"==je||"100"==je)&&(w="1d100",W="d100"),"0"==je&&(w="")}console.log("\u3048\u3044\u3077\u308a\u308b \u30c0\u30a4\u30b9\u30bf\u30a4\u30d7:"+w);const ve=_t.myCursor.diceImageIndex;let me=0;if(ve<0?me=Math.floor(4*Math.random()):(me=Math.floor(3*Math.random()),ve<=me&&me++),_t.myCursor.diceImageType=w,""==w)return _t.myCursor.diceImageIndex=-1,void setTimeout(()=>{t.unDispDiceAprilMessage(r)},10);_t.myCursor.diceImageIndex=me;let Ve=Math.floor(100*Math.random())+1;Ve<1&&(Ve=1),Ve>100&&(Ve=100);let We=Math.floor(100*Math.random())+1;We<1&&(We=1),We>100&&(We=100);let Ze="";Ze="2d6"==w?100+W+"+100"+W+"+"+Ve+W+"+"+Ve+W+"+"+We+W+"+"+We+W:100+W+"+"+Ve+W+"+"+We+W;try{const je=/^((\d+)?\s+)?([^\s]*)?/gi.exec(Ze),ut=null!=je[3]?je[3]:o,ot=yield Sr.diceRollAsync(ut,a);if(!ot.result)return;t.sendAprilMessage(ot,100+Ve+We,r)}catch(je){console.error(je)}});return function(i){return e.apply(this,arguments)}}())}alertAprilMessage(t){const i={identifier:"",tabIdentifier:t.tabIdentifier,originFrom:t.from,from:"System",timestamp:t.timestamp+1,imageIdentifier:"april[01]",tag:"system",name:"<\u3048\u3044\u3077\u308a\u308b>",text:"\u300c\u3061\u3083\u3093\u3068\u300e#\u3048\u3044\u3077\u308a\u308b\u300f\u3063\u3066\u3088\u3093\u3067\u304f\u3060\u3055\u3044\uff01\u30c0\u30a4\u30b9\u904b\u4e0b\u3052\u307e\u3059\u3088\u3063\uff01\uff1f\u300d",messColor:t.messColor,imagePos:t.imagePos?t.imagePos:null},r=Xe.instance.get(t.tabIdentifier);r&&r.addMessage(i)}unDispDiceAprilMessage(t){const i={identifier:"",tabIdentifier:t.tabIdentifier,originFrom:t.from,from:"System",timestamp:t.timestamp+1,imageIdentifier:"april[00]",tag:"system",name:"<\u3048\u3044\u3077\u308a\u308b>",text:"\u30c0\u30a4\u30b9\u753b\u50cf\u3092\u30c7\u30d5\u30a9\u30eb\u30c8(\u975e\u8868\u793a)\u306b\u3057\u307e\u3057\u305f",messColor:t.messColor},r=Xe.instance.get(t.tabIdentifier);r&&r.addMessage(i)}sendAprilMessage(t,e,i){const r=t.result;if(r.length<1)return;console.log("result.length:"+r.length);const s=r.match(/\d+$/),g={identifier:"",tabIdentifier:i.tabIdentifier,originFrom:i.from,from:"System-BCDice",timestamp:i.timestamp+1,imageIdentifier:"april[00]",tag:"system",name:"<BCDice\uff1a\u3048\u3044\u3077\u308a\u308b>",text:"\u300c\u307e\u305d\u3063\u3077\uff01\u300d\u3048\u3044\u3077\u308a\u308b\u306f\u708e\u306e\u5263\u3067 "+e+" \u9023\u7d9a\u3067\u30c0\u30a4\u30b9\u3092\u7a81\u3044\u305f \u2192 "+s+" \u904b\u547d\u304c\u5909\u308f\u3063\u305f\u304b\u3082\u3057\u308c\u306a\u3044",messColor:i.messColor,imagePos:i.imagePos?i.imagePos:null};null!=i.to&&0<i.to.length&&(g.to=i.to,i.to.indexOf(i.from)<0&&(g.to+=" "+i.from));const w=Xe.instance.get(i.tabIdentifier);w&&w.addMessage(g)}targeted(t){return t.targeted}targetedGameCharacterList(){let t=[];return t=Xe.instance.getObjects(Lt).filter(e=>this.targeted(e)),t}messageSendGameCharacter(t){let e=Xe.instance.get(t);return e instanceof Lt?e:(console.log("\u30ad\u30e3\u30e9\u30af\u30bf\u304b\u3089\u306e\u767a\u4fe1\u3058\u3083\u3042\u308a\u307e\u305b\u3093"),null)}checkResourceEditCommand(t,e){let i=[],r=[],o=this.messageSendGameCharacter(t.sendFrom),s=!1;for(const a of e){let g=" "+a.text;g.match(/(\s[sS\uff53\uff33][tT\uff54\uff34]?[:\uff1a&\uff06])/i)&&(s=!0);let We=g.replace(/(\s[sS\uff53\uff33][tT\uff54\uff34][:\uff1a])/i," t:").replace(/(\s[sS\uff53\uff33][:\uff1a])/i," :").replace(/([tT\uff54\uff34][:\uff1a])/gi,"t:").replace(/([tT\uff54\uff34][&\uff06])/gi,"t&").replace(/([:\uff1a])/gi,":").replace(/([&\uff06])/gi,"&").split(/\s/);for(const ot of We){if(console.log("chktxt="+ot),!ot.match(/^(t?[:&][^:\uff1a&\uff06])+/gi))continue;let ft=ot.match(/t?:[^:\uff1a&\uff06]+/gi),Ot=ot.match(/t?&[^:\uff1a&\uff06]+/gi);if(ft)for(let Et of ft){console.log(Et);let Ut={resourceCommand:"",object:null};Ut.resourceCommand=Et,Ut.object=a.object,i.push(Ut)}if(Ot)for(let Et of Ot){let Ut={buffCommand:"",object:null};Ut.buffCommand=Et,Ut.object=a.object,r.push(Ut)}}}this.resourceEditProcess(o,i,r,t,s)}resourceEditParseOption(t){let e={limitMinMax:!1,zeroLimit:!1,isErr:!1};const i=Xo.toHalfWidth(t).match(/([A-CE-Z]+)$/i);if(!i)return e;let r=i[1];return r.match(/L/i)&&(r=r.replace(/L/i,""),e.limitMinMax=!0),r.match(/Z/i)?(r=r.replace(/Z/i,""),e.zeroLimit=!0):e.zeroLimit=!1,0!=r.length&&(e.isErr=!0),e}resourceCommandToEdit(t,e,i,r){console.log("\u30ea\u30bd\u30fc\u30b9\u5909\u66f4\u30b3\u30de\u30f3\u30c9\u51e6\u7406\u958b\u59cb"),t.object=i,t.targeted=r;const o=" "+e.replace("\uff1a",":").replace("\uff0b","+").replace("\uff0d","-").replace("\uff1d","=").replace("\uff1e",">");console.log("\u30ea\u30bd\u30fc\u30b9\u5909\u66f4\uff1a"+o);const a=o.match(/[:]([^-+=>]+)([-+=>])(.*)/);if(">"!=a[2]&&""==a[3])return!1;let w,W,ve=a[1].match(/(.+)([\^\uff3e]$)/);ve?(w=ve[1],t.nowOrMax="max"):(w=a[1],t.nowOrMax="now");let me=w.match(/(.+)([~\uff5e]$)/);me?(w=me[1],t.isLine=!0):t.isLine=!1,W=Xo.toHalfWidth(w);const Se=a[2];if(t.operator=Se,i.chkChangeStatusName(w))t.target=w;else{if(!i.chkChangeStatusName(W))return!1;t.target=W}if(">"==t.operator){if(t.isLine)return!1;t.replace=a[3]}else{let Oe=a[3].replace(/[A-CE-Z\uff21-\uff23\uff25-\uff3a]+$/i,"");t.command=("-"==t.operator?"-":"")+Xo.toHalfWidth(Oe)+"+(1d1-1)",console.log(w+"/"+Se+"/"+Oe),Oe=Oe.replace(/[A-CE-Z\uff21-\uff23\uff25-\uff3a]+$/i,"");const We=this.resourceEditParseOption(a[3]);if(We.isErr)return!1;t.option=We,t.isDiceRoll=!!Xo.toHalfWidth(Oe).match(/\d[dD]/)}return!0}defaultResourceEdit(){return{target:"",operator:"",diceResult:"",command:"",replace:"",isDiceRoll:!1,calcAns:0,nowOrMax:"now",isLine:!1,option:null,object:null,targeted:!1}}resourceEditProcess(t,e,i,r,o){var s=this;return(0,xn.Z)(function*(){const a=[],g=yield Sr.loadGameSystemAsync(r.tags?r.tags[0]:"");console.log("resourceEditProcess");for(const ve of e){let Oe,me=ve.resourceCommand,Se=!!me.match(/^t:/i);if(Se){let Ve=ve.object,We=s.defaultResourceEdit();if(!s.resourceCommandToEdit(We,me,Ve,Se))return;if(">"!=We.operator)try{const Ze=yield Sr.diceRollAsync(We.command,g);if(!Ze.result)return null;const je=Ze.result.split(" \uff1e ");We.diceResult=je[je.length-2].replace(/\+\(1\[1\]\-1\)$/,"");const ut=Ze.result.match(/([-+]?\d+)$/);We.calcAns=parseInt(ut[1],10)}catch(Ze){console.error(Ze)}a.push(We)}else{if(null==t)return Oe=null,void console.log("\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u306a\u3044\u30ea\u30bd\u30fc\u30b9\u306f\u64cd\u4f5c\u3067\u304d\u307e\u305b\u3093");{Oe=t;let Ve=s.defaultResourceEdit();if(!s.resourceCommandToEdit(Ve,me,Oe,Se))return;if(">"!=Ve.operator)try{const We=yield Sr.diceRollAsync(Ve.command,g);if(!We.result)return null;const Ze=We.result.split(" \uff1e ");Ve.diceResult=Ze[Ze.length-2].replace(/\+\(1\[1\]\-1\)$/,"");const je=We.result.match(/([-+]?\d+)$/);Ve.calcAns=parseInt(je[1],10)}catch(We){console.error(We)}a.push(Ve)}}}let W=[];for(const ve of i){let Oe,me=ve.buffCommand,Se=!!me.match(/^t&/i);if(Se){let Ve=ve.object,Ze={command:me.replace("\uff06","&").replace(/\uff0b$/,"+").replace(/\uff0d$/,"-"),object:Ve,targeted:Se};W.push(Ze)}else{if(null==t)return Oe=null,void console.log("\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u306a\u3044\u3082\u306e\u306b\u5bfe\u3057\u3066\u30d0\u30d5\u64cd\u4f5c\u306f\u3067\u304d\u307e\u305b\u3093");{let We={command:me.replace("\uff06","&").replace(/\uff0b$/,"+").replace(/\uff0d$/,"-"),object:t,targeted:Se};W.push(We)}}}s.resourceBuffEdit(a,W,r,o)})()}resourceTextEdit(t,e){return e.setStatusText(t.target,t.replace),t.target+"\uff1e"+t.replace+"    "}resourceEdit(t,e){let i="",r=0,o=0,s=null,a=null,g=t.nowOrMax,w=t.isLine;if(a=e.getStatusValue(t.target,g,!0),w&&null==a&&(w=!1),s=e.getStatusValue(t.target,"max",w),"max"==g&&null==s&&(g="now"),r=e.getStatusValue(t.target,g,w),"="==t.operator)o=t.calcAns;else{const Oe=t.option.zeroLimit;Oe&&"+"==t.operator&&t.calcAns<0||Oe&&"-"==t.operator&&t.calcAns>0?(o=r+0,i="(0\u5236\u9650)"):o=r+t.calcAns}return t.option.limitMinMax&&null!=s&&(o>s&&"now"==g&&(o=s,i="(\u6700\u5927)"),o<0&&(o=0,i="(\u6700\u5c0f)")),e.setStatusValue(t.target,g,o,w),t.target+(w?"(Line)":"")+("max"==g?"(\u6700\u5927\u5024)":"")+":"+r+("-"==t.operator?"":t.operator)+t.diceResult+"\uff1e"+o+i+"    "}buffEdit(t,e){let i=t.command,r="";if(t.targeted&&(r+="["+e.name+"] "),i.match(/^[tT\uff54\uff34]?&[R\uff32r\uff52]-$/i))e.decreaseBuffRound(),r+="\u30d0\u30d5R\u3092\u6e1b\u5c11",r+="    ";else if(i.match(/^[tT\uff54\uff34]?&[R\uff32r\uff52][+]$/i))e.increaseBuffRound(),r+="\u30d0\u30d5R\u3092\u5897\u52a0",r+="    ";else if(i.match(/^[tT\uff54\uff34]?&[D\uff24d\uff44]$/i))e.deleteZeroRoundBuff(),r+="0R\u4ee5\u4e0b\u306e\u30d0\u30d5\u3092\u6d88\u53bb",r+="    ";else if(i.match(/^[tT\uff54\uff34]?&.+-$/i)){let o=i.match(/^[tT\uff54\uff34]?&(.+)-$/i);console.log("match"+o);const s=o[1];e.deleteBuff(s)&&(r+=s+"\u3092\u6d88\u53bb",r+="    ")}else{const o=i.replace(/^[tT\uff54\uff34]?&/i,"").split("/");let s=null,a="",g="",w="";g=o[0],w=o[0],o.length>1&&(a=o[1],w=w+"/"+o[1]),o.length>2&&(o[2]?(s=parseInt(o[2]),Number.isNaN(s)&&(s=3)):s=3,w=w+"/"+s+"R"),e.addBuffRound(g,a,s),r+="\u30d0\u30d5\u3092\u4ed8\u4e0e "+w,r+="    "}return r}resourceBuffEdit(t,e,i,r){let g,w,W,s="",a=!1;for(let Se of t)g=Se.object,Se.targeted&&(s+="["+g.name+"] "),s+=">"==Se.operator?this.resourceTextEdit(Se,g):this.resourceEdit(Se,g),Se.isDiceRoll&&(a=!0);for(let Se of e)g=Se.object,s+=this.buffEdit(Se,g);if(s=s.replace(/\s\s\s\s$/,""),""==s)return;a?(w="System-BCDice",W="<BCDice\uff1a"+i.name+">"):(w="System",W=i.name);const ve={identifier:"",tabIdentifier:i.tabIdentifier,originFrom:i.from,from:w,timestamp:i.timestamp+2,imageIdentifier:_t.myCursor.diceImageIdentifier,tag:r?"system secret":"system",name:W,text:s,messColor:i.messColor},me=Xe.instance.get(i.tabIdentifier);me&&me.addMessage(ve)}sendResultMessage(t,e,i){let r=t.result;const o=t.isSecret;if(r.length<1)return;console.log("result.length:"+r.length),r=r.replace(/[\uff1e]/g,g=>"\u2192").trim();const s={identifier:"",tabIdentifier:e.tabIdentifier,originFrom:e.from,from:"System-BCDice",timestamp:e.timestamp+1,imageIdentifier:_t.myCursor.diceImageIdentifier,tag:o?"system secret":"system",name:o?"<Secret-BCDice\uff1a"+e.name+">":"<BCDice\uff1a"+e.name+">",text:i?r+i:r,messColor:e.messColor};null!=e.to&&0<e.to.length&&(s.to=e.to,e.to.indexOf(e.from)<0&&(s.to+=" "+e.from));const a=Xe.instance.get(e.tabIdentifier);a&&a.addMessage(s)}onStoreRemoved(){super.onStoreRemoved(),Qe.unregister(this)}};sr.queue=Sr.initializeDiceBotQueue(),sr.diceBotInfos=[],sr=Sr=xe([li("dice-bot")],sr);let zf=class extends ca{constructor(){super(...arguments),this.audioIdentifier="",this.startTime=0,this.isLoop=!1,this.isPlaying=!1,this.audioPlayer=new Jt,this._volume=.5,this._auditionVolume=.5}get audio(){return en.instance.get(this.audioIdentifier)}get config(){return Xe.instance.get("Config")}get volume(){return this._volume}set volume(t){this._volume=t}get auditionVolume(){return this._auditionVolume}set auditionVolume(t){this._auditionVolume=t}onStoreAdded(){super.onStoreAdded(),this.unlockAfterUserInteraction()}onStoreRemoved(){super.onStoreRemoved(),this._stop()}setNewVolume(){Jt.volume=this.volume*this.config.roomVolume,Jt.auditionVolume=this.auditionVolume*this.config.roomVolume}play(t,e=!1){let i=en.instance.get(t);!i||!i.isReady||(this.audioIdentifier=t,this.isPlaying=!0,this.isLoop=e,this._play())}_play(){this._stop(),this.audio&&this.audio.isReady?(this.audioPlayer.loop=!0,this.audioPlayer.play(this.audio)):this.playAfterFileUpdate()}stop(){this.audioIdentifier="",this.isPlaying=!1,this._stop()}_stop(){this.unregisterEvent(),this.audioPlayer.stop()}playAfterFileUpdate(){Qe.register(this).on("UPDATE_AUDIO_RESOURE",t=>{this._play()})}unlockAfterUserInteraction(){let t=()=>{document.body.removeEventListener("touchstart",t,!0),document.body.removeEventListener("mousedown",t,!0),this.audioPlayer.stop(),this.isPlaying&&this._play()};document.body.addEventListener("touchstart",t,!0),document.body.addEventListener("mousedown",t,!0)}unregisterEvent(){Qe.unregister(this,"UPDATE_AUDIO_RESOURE")}apply(t){let e=this.audioIdentifier,i=this.isPlaying;super.apply(t),e===this.audioIdentifier&&i||!this.isPlaying?i!==this.isPlaying&&!this.isPlaying&&this._stop():this._play()}};xe([lt()],zf.prototype,"audioIdentifier",void 0),xe([lt()],zf.prototype,"startTime",void 0),xe([lt()],zf.prototype,"isLoop",void 0),xe([lt()],zf.prototype,"isPlaying",void 0),zf=xe([li("jukebox")],zf);let Bw=class extends Qr{constructor(){super(...arguments),this.reloadOK=!0,this.isAnswer=!1}reloadCheckStart(t){t?(this.reloadOK=!0,this.isAnswer=!1):(this.reloadOK=!0,this.isAnswer=!0)}answerCheck(){return 0==this.isAnswer&&(this.reloadOK=window.confirm("\u30d7\u30ec\u30a4\u4e2d\u306b\u30eb\u30fc\u30e0\u6839\u5e79\u8a2d\u5b9a\u3092\u542b\u3080\u30c7\u30fc\u30bf\u304c\u5165\u529b\u3055\u308c\u307e\u3057\u305f\n\u3053\u306e\u30c7\u30fc\u30bf\u3092\u672c\u5f53\u306b\u8aad\u307f\u8fbc\u3093\u3067\u3044\u3044\u3067\u3059\u304b\uff1f \u53e4\u3044\u30c7\u30fc\u30bf\u306f\u4e0a\u66f8\u304d\u3055\u308c\u307e\u3059"),this.isAnswer=!0),this.reloadOK}isLoadOk(){return console.log("isLoadOk :"+this.reloadOK),this.reloadOK}};Bw=xe([li("reload-check")],Bw);let Lw=class extends ca{constructor(){super(...arguments),this.clickTimeStamp=0}changeMarkDownCheckBox(t,e){let i=t.match(/^(.*)_mark_(\d{8})$/);if(!i)return;let o=i[2],s=Xe.instance.get(i[1]);if(!s||this.clickTimeStamp==e)return;this.clickTimeStamp=e;let a=s.value,g=parseInt(o),w=a.split(/[\[\uff3b][xX\uff58\uff38]?[\]\uff3d]/g),W=a.match(/[\[\uff3b][xX\uff58\uff38]?[\]\uff3d]/g),ve=W[g];ve=ve.match(/[\[\uff3b][xX\uff58\uff38][\]\uff3d]/)?"[]":"[x]";let Se,me="";for(Se=0;Se<W.length;Se++)me+=Se!=g?w[Se]+W[Se]:w[Se]+ve;for(;Se<w.length;Se++)me+=w[Se];s.value=me}markDownCheckBox(t,e){let i="",s=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/[\[\uff3b][xX\uff58\uff38][\]\uff3d]/g,'<input type="checkbox" checked="checked" class="markDounBox" />').replace(/[\[\uff3b][\]\uff3d]/g,'<input type="checkbox" class="markDounBox" />').split("<input ");for(let a=0;a<s.length&&(i+=s[a],a<s.length-1&&(i+='<input id="'+e+"_mark_"+("00000000"+a).slice(-8)+'" '),!(a>=99999999));a++);return i}markDownTable(t){let e=t.split("\n"),i="",r=!1;for(let o=0;o<e.length;o++){let s=e[o].split(/[|\uff5c]/);if(1==s.length)0==r?i+=e[o]+"\n":(i+="</div>",i+=e[o]+"\n",r=!1);else if(0==r){i+=s[0],i+='<div class="markdown_table" style="display: table; table-layout: fixed; border: 1px solid #000000;">',i+='  <div class="markdown_table_row" style="display: table-row; border: 1px solid #000000;">';for(let a=1;a<s.length-1;a++)i+='    <div class="markdown_table_cell" style="display: table-cell; border: 1px solid #000000;">'+s[a]+"</div>";i+="  </div>",r=!0}else{i+='  <div class="markdown_table_row" style="display: table-row; border: 1px solid #000000;">';for(let a=1;a<s.length-1;a++)i+='    <div class="markdown_table_cell" style="display: table-cell; border: 1px solid #000000;">'+s[a]+"</div>";i+="  </div>"}}return 1==r&&(i+="</div>"),i}onStoreAdded(){super.onStoreAdded()}onStoreRemoved(){super.onStoreRemoved()}};Lw=xe([li("markdown")],Lw);let Yi=class extends ca{constructor(){super(...arguments),this.name="\u30ab\u30c3\u30c8\u30a4\u30f3",this.width=480,this.height=320,this.originalSize=!0,this.x_pos=50,this.y_pos=50,this.imageIdentifier="imageIdentifier",this.audioIdentifier="",this.audioName="",this.startTime=0,this.tagName="",this.selected=!1,this.isLoop=!1,this.chatActivate=!1,this.outTime=0,this.isPlaying=!1,this.keepImageAspect=!1,this.isVideoCutIn=!1,this.videoUrl="",this.normalMinSizeWidth=10,this.normalMinSizeHeight=10,this.normalMaxSizeWidth=1200,this.normalMaxSizeHeight=1200,this.videoMinSizeWidth=448,this.videoMinSizeHeight=252,this.videoMaxSizeWidth=1920,this.videoMaxSizeHeight=1080,this._defVideoSizeWidth=640,this._defVideoSizeHeight=360,this.audioPlayer=new Jt}get defVideoSizeWidth(){return this._defVideoSizeWidth}get defVideoSizeHeight(){return this._defVideoSizeHeight}minSizeWidth(t){return t?this.videoMinSizeWidth:this.normalMinSizeWidth}maxSizeWidth(t){return t?this.videoMaxSizeWidth:this.normalMaxSizeWidth}minSizeHeight(t){return t?this.videoMinSizeHeight:this.normalMinSizeHeight}maxSizeHeight(t){return t?this.videoMaxSizeHeight:this.normalMaxSizeHeight}get audio(){return en.instance.get(this.audioIdentifier)}get cutInImage(){return this.imageIdentifier&&St.instance.get(this.imageIdentifier)||Bt.Empty}validUrl(t){if(!t)return!1;try{new URL(t.trim())}catch(e){return!1}return/^https?\:\/\//.test(t.trim())}get videoId(){if(!this.isVideoCutIn||!this.videoUrl)return"";let t="";if(!this.validUrl(this.videoUrl))return"";{const e=new URL(this.videoUrl).hostname;if("youtube.com"==e||"www.youtube.com"==e){let i=this.videoUrl.split("v=");i[1]&&(t=encodeURI(i[1].split(/[\?\&\#\/]/)[0]))}else{if("youtu.be"!=e)return"";{let i=this.videoUrl.split("youtu.be/");i[1]&&(t=encodeURI(i[1].split(/[\?\&\#\/]/)[0]))}}}return t.replace(/[\<\>\/\:\s\r\n]/g,"")}get videoStart(){if(!this.isVideoCutIn||!this.videoUrl||!this.videoId)return null;const t=/[\&\?](?:start|t)\=([\dhms]+)/i.exec(this.videoUrl);return t&&t[1]?this._sec(t[1]):null}_sec(t){if(!t)return null;let e=null;if(e=/^(\d+)$/.exec(t))return e[1];if(e=/^(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s)?$/i.exec(t)){let i=0;return e[1]&&(i+=60*+e[1]*60),e[2]&&(i+=60*+e[2]),e[3]&&(i+=+e[3]),""+i}return null}get playListId(){if(!this.isVideoCutIn||!this.videoId)return"";let t="";if(!this.validUrl(this.videoUrl))return"";{let e=this.videoUrl.split("list=");e[1]&&(t=encodeURI(e[1].split(/[\&\#\/]/)[0]))}return t.replace(/[\<\>\/\:\s\r\n]/g,"")}get isValidAudio(){return 0==this.audioName.length||0==this.audioIdentifier.length||!!en.instance.get(this.audioIdentifier)}onStoreAdded(){super.onStoreAdded()}onStoreRemoved(){super.onStoreRemoved()}};xe([lt()],Yi.prototype,"name",void 0),xe([lt()],Yi.prototype,"width",void 0),xe([lt()],Yi.prototype,"height",void 0),xe([lt()],Yi.prototype,"originalSize",void 0),xe([lt()],Yi.prototype,"x_pos",void 0),xe([lt()],Yi.prototype,"y_pos",void 0),xe([lt()],Yi.prototype,"imageIdentifier",void 0),xe([lt()],Yi.prototype,"audioIdentifier",void 0),xe([lt()],Yi.prototype,"audioName",void 0),xe([lt()],Yi.prototype,"startTime",void 0),xe([lt()],Yi.prototype,"tagName",void 0),xe([lt()],Yi.prototype,"selected",void 0),xe([lt()],Yi.prototype,"isLoop",void 0),xe([lt()],Yi.prototype,"chatActivate",void 0),xe([lt()],Yi.prototype,"outTime",void 0),xe([lt()],Yi.prototype,"isPlaying",void 0),xe([lt()],Yi.prototype,"keepImageAspect",void 0),xe([lt()],Yi.prototype,"isVideoCutIn",void 0),xe([lt()],Yi.prototype,"videoUrl",void 0),Yi=xe([li("cut-in")],Yi);let mc=class extends ca{constructor(){super(...arguments),this.test="test001",this.launchCutInIdentifier="",this.launchTimeStamp=0,this.launchMySelf=!1,this.launchIsStart=!1,this.stopBlankTagCutInTimeStamp=0,this.sendTo="",this.reloadDummy=5}get jukebox(){return Xe.instance.get("Jukebox")}isCutInBgmUploaded(t){return!!en.instance.get(t)}chatActivateCutIn(t,e){let o="";if((" "+t).match(/\s(\S+)$/i)){o=RegExp.$1;const s=this.getCutIns();for(const a of s)if(a.chatActivate&&a.name==o)return this.isCutInBgmUploaded(a.audioIdentifier)&&""==a.tagName&&this.jukebox.stop(),void this.startCutIn(a,e)}}startCutInMySelf(t){this.launchCutInIdentifier=t.identifier,this.launchIsStart=!0,this.launchTimeStamp=this.launchTimeStamp+1,this.launchMySelf=!0,this.sendTo="",this.startSelfCutIn()}startCutIn(t,e){this.launchCutInIdentifier=t.identifier,this.launchIsStart=!0,this.launchTimeStamp=this.launchTimeStamp+1,this.launchMySelf=!1,this.sendTo=e||"",this.startSelfCutIn()}stopCutIn(t){this.launchCutInIdentifier=t.identifier,this.launchIsStart=!1,this.launchTimeStamp=this.launchTimeStamp+1,this.launchMySelf=!1,this.stopSelfCutIn()}stopBlankTagCutIn(){this.stopBlankTagCutInTimeStamp=this.stopBlankTagCutInTimeStamp+1,Qe.trigger("STOP_CUT_IN_BY_BGM",{})}sameTagCutIn(t){const e=this.getCutIns(),i=t.tagName,r=[];for(const o of e)o.tagName==i&&o.identifier!==t.identifier&&r.push(o);return r}startSelfCutIn(){const t=Xe.instance.get(this.launchCutInIdentifier);Qe.trigger("START_CUT_IN",{cutIn:t})}stopSelfCutIn(){const t=Xe.instance.get(this.launchCutInIdentifier);Qe.trigger("STOP_CUT_IN",{cutIn:t})}stopSelfCutInByIdentifier(t){const e=Xe.instance.get(t);Qe.trigger("STOP_CUT_IN",{cutIn:e})}getCutIns(){return Xe.instance.getObjects(Yi)}onStoreAdded(){super.onStoreAdded()}onStoreRemoved(){super.onStoreRemoved()}apply(t){console.log("CutInLauncher apply() CALL");const e=this.launchCutInIdentifier,i=this.launchIsStart,r=this.launchTimeStamp,o=this.stopBlankTagCutInTimeStamp;super.apply(t),!this.launchMySelf&&(console.log("this.sendTo :"+this.sendTo),o!==this.stopBlankTagCutInTimeStamp&&(console.log("\u30c7\u30fc\u30bf\u4f1d\u642c\u3067\u691c\u77e5 \u7121\u30bf\u30b0\u30ab\u30c3\u30c8\u30a4\u30f3\u505c\u6b62\u306e\u30c8\u30ea\u30ac\u30fc"),Qe.trigger("STOP_CUT_IN_BY_BGM",{})),(""==this.sendTo||this.sendTo==bt.peerContext.userId)&&(e!==this.launchCutInIdentifier||i!==this.launchIsStart||r!==this.launchTimeStamp)&&(this.launchIsStart?this.startSelfCutIn():this.stopSelfCutIn()))}};xe([lt()],mc.prototype,"test",void 0),xe([lt()],mc.prototype,"launchCutInIdentifier",void 0),xe([lt()],mc.prototype,"launchTimeStamp",void 0),xe([lt()],mc.prototype,"launchMySelf",void 0),xe([lt()],mc.prototype,"launchIsStart",void 0),xe([lt()],mc.prototype,"stopBlankTagCutInTimeStamp",void 0),xe([lt()],mc.prototype,"sendTo",void 0),mc=xe([li("cut-in-launcher")],mc);let xl=class extends ca{constructor(){super(...arguments),this.initTimeStamp=0,this.voteTitle="",this.targetPeerId=[],this.choices=[],this.chairId="",this.isRollCall=!1,this.isFinish=!1,this.voteId=0}voteAnswerByPeerId(t){let e=_t.findByPeerId(t);return e?e.voteId==this.voteId?e.voteAnswer:-1:-2}get voteAnswer(){let t=[];for(let e of this.targetPeerId)t.push(this.voteAnswerByPeerId(e));return t}makeVote(t,e,i,r,o){this.isRollCall=o,this.chairId=t,this.choices=r,this.voteTitle=e,this.voteId++,this.targetPeerId=i,this.initTimeStamp=Date.now()}isVoteEnd(t){for(let e of this.targetPeerId)if(e==t){let i=_t.findByPeerId(t);if(!i||i.voteId==this.voteId)return!0}return!1}voting(t,e){_t.myCursor.voteAnswer=t?this.choices.indexOf(t):-2,_t.myCursor.voteId=this.voteId,this.chkFinishVote()}chkFinishVote(){if(this.chairId==_t.myCursor.peerId&&this.votedTotalNum()==this.targetPeerId.length){let t;if(this.isRollCall)t="\u70b9\u547c\u7d42\u4e86("+this.votedTotalNum()+"/"+this.targetPeerId.length+")",0!=this.votedNumByIndex(-2)&&(t+=" \u68c4\u6a29\uff1a"+this.votedNumByIndex(-2));else{t="\u6295\u7968\u7d42\u4e86("+this.voteTitle+") ";for(let e of this.choices)t+=" "+e+"\uff1a"+this.votedNumByChoice(e);0!=this.votedNumByIndex(-2)&&(t+=" \u68c4\u6a29\uff1a"+this.votedNumByIndex(-2))}setTimeout(()=>{Qe.trigger("FINISH_VOTE",{text:t})},1)}}votedTotalNum(){const t=this.voteAnswer;let e=0;for(let i of t)(i>=0||-2==i)&&e++;return e}votedNumByIndex(t){const e=this.voteAnswer;let i=0;for(let r of e)r==t&&i++;return i}votedNumByChoice(t){const e=this.choices.indexOf(t);return this.votedNumByIndex(e)}indexToChoice(t){return t<0||t>=this.choices.length?"":this.choices[t]}chkToMe(){for(let t of this.targetPeerId)if(_t.myCursor.peerId==t)return!0;return!1}startVote(){Qe.trigger("END_OLD_VOTE",{}),Qe.trigger("START_VOTE",{})}onStoreAdded(){super.onStoreAdded()}onStoreRemoved(){super.onStoreRemoved()}apply(t){console.log("Vote apply() CALL");const e=this.initTimeStamp;super.apply(t),e!==this.initTimeStamp&&this.startVote(),this.chkFinishVote()}};xe([lt()],xl.prototype,"initTimeStamp",void 0),xe([lt()],xl.prototype,"voteTitle",void 0),xe([lt()],xl.prototype,"targetPeerId",void 0),xe([lt()],xl.prototype,"choices",void 0),xe([lt()],xl.prototype,"chairId",void 0),xe([lt()],xl.prototype,"isRollCall",void 0),xe([lt()],xl.prototype,"isFinish",void 0),xe([lt()],xl.prototype,"voteId",void 0),xl=xe([li("Vote")],xl);let Ga=class extends ca{constructor(){super(...arguments),this.initTimeStamp=0,this.alarmTitle="",this.targetPeerId=[],this.alarmTime=0,this.alarmId=0,this.alarmPeerId="",this.targetText="",this.isSound=!1,this.isPopUp=!1}get myPeer(){return _t.myCursor}makeAlarm(t,e,i,r,o,s,a){this.alarmTitle=e,this.alarmTime=t,this.alarmId++,this.alarmPeerId=r,this.targetPeerId=i,this.targetText=o,this.initTimeStamp=Date.now(),this.isSound=s,this.isPopUp=a}chkToMe(){for(let t of this.targetPeerId)if(_t.myCursor.peerId==t)return!0;return!1}startAlarm(){this.chkToMe()&&setTimeout(()=>{this.isSound&&(Qe.trigger("ALARM_TIMEUP_ORIGIN",{text:"\u30a2\u30e9\u30fc\u30e0("+this.alarmTime+"\u79d2)\u7d4c\u904e"+this.targetText+this.alarmTitle}),Jt.play(en.instance.get(dt.alarm),.5),console.log("\u30a2\u30e9\u30fc\u30e0\u97f3\u518d\u751f")),this.isPopUp&&(console.log("\u30a2\u30e9\u30fc\u30e0 \u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u518d\u751f"),Qe.trigger("ALARM_POP",{title:this.alarmTitle,time:this.alarmTime}))},1e3*this.alarmTime)}onStoreAdded(){super.onStoreAdded()}onStoreRemoved(){super.onStoreRemoved()}apply(t){console.log("Alarm timer apply() CALL");const e=this.initTimeStamp;super.apply(t),e!==this.initTimeStamp&&this.startAlarm()}};xe([lt()],Ga.prototype,"initTimeStamp",void 0),xe([lt()],Ga.prototype,"alarmTitle",void 0),xe([lt()],Ga.prototype,"targetPeerId",void 0),xe([lt()],Ga.prototype,"alarmTime",void 0),xe([lt()],Ga.prototype,"alarmId",void 0),xe([lt()],Ga.prototype,"alarmPeerId",void 0),xe([lt()],Ga.prototype,"targetText",void 0),xe([lt()],Ga.prototype,"isSound",void 0),xe([lt()],Ga.prototype,"isPopUp",void 0),Ga=xe([li("Alarm")],Ga);let zw=class extends ca{onStoreAdded(){super.onStoreAdded(),Xe.instance.remove(this)}get reloadCheck(){return Xe.instance.get("ReloadCheck")}innerXml(){let t="",e=[];e=e.concat(Xe.instance.getObjects(to)),e=e.concat(Xe.instance.getObjects(Lt)),e=e.concat(Xe.instance.getObjects(or)),e=e.concat(Xe.instance.getObjects(Qo)),e=e.concat(Xe.instance.getObjects(wr)),e=e.concat(Xe.instance.getObjects(Jr).filter(i=>null===i.parent)),e=e.concat(Xe.instance.getObjects(vs)),e=e.concat(Xe.instance.getObjects(Yi)),e=e.concat(Xe.instance.getObjects(_c));for(let i of e)t+=i.toXml();return t}parseInnerXml(t){let e=[];e=e.concat(Xe.instance.getObjects(to)),e=e.concat(Xe.instance.getObjects(So)),e=e.concat(Xe.instance.getObjects(Do)),e=e.concat(Xe.instance.getObjects(_o)),e=e.concat(Xe.instance.getObjects(Lt)),e=e.concat(Xe.instance.getObjects(or)),e=e.concat(Xe.instance.getObjects(Qo)),e=e.concat(Xe.instance.getObjects(wr)),e=e.concat(Xe.instance.getObjects(Jr)),e=e.concat(Xe.instance.getObjects(vs)),e=e.concat(Xe.instance.getObjects(Yi)),e=e.concat(Xe.instance.getObjects(_c));let i=!0;if(i=this.reloadCheck.answerCheck(),i){for(let r of e)r.destroy();for(let r=0;r<t.children.length;r++)er.instance.parseXml(t.children[r])}}};zw=xe([li("room")],zw);var Fp,SG=Ce(1203);let rn=Fp=class extends Si{constructor(){super(...arguments),this.imageIdentifier="",this.tag=""}containsWords(t){return t.every(e=>this.tag.indexOf(e)>=0)}static searchImages(t){return Xe.instance.getObjects(Fp).filter(e=>e.containsWords(t)).map(e=>St.instance.get(e.imageIdentifier)).filter(e=>e)}static get(t){return Xe.instance.get(`imagetag_${t}`)}static create(t){const e=new Fp(`imagetag_${t}`);return e.imageIdentifier=t,e.initialize(),e}parseInnerXml(t){let e=Fp.get(this.imageIdentifier);e||(e=Fp.create(this.imageIdentifier));const i=e.toContext();i.syncData=this.toContext().syncData,e.apply(i),e.update(),this.destroy()}};var Hw;xe([lt()],rn.prototype,"imageIdentifier",void 0),xe([lt()],rn.prototype,"tag",void 0),rn=Fp=xe([li("image-tag")],rn);let $b=Hw=class extends Si{constructor(){super(...arguments),this.identifiers=[]}onStoreAdded(){super.onStoreAdded(),Xe.instance.remove(this)}innerXml(){return Array.from(new Set(this.identifiers)).map(t=>rn.get(t)).filter(t=>t).map(t=>t.toXml()).join("")}static create(t){const e=new Hw;return e.identifiers=t.map(i=>i.identifier),e}};$b=Hw=xe([li("image-tag-list")],$b);class ko{constructor(t){this.ngZone=t}saveRoomAsync(t="\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){return ko.queue.add((i,r)=>i(this._saveRoomAsync(t,e)))}_saveRoomAsync(t="\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){let i=[],r=this.convertToXml(new zw),o=this.convertToXml(Vs.instance),s=this.convertToXml(Of.instance),a=this.convertToXml(ja.instance);i.push(new File([r],"data.xml",{type:"text/plain"})),i.push(new File([o],"chat.xml",{type:"text/plain"})),i.push(new File([s],"config.xml",{type:"text/plain"})),i.push(new File([a],"summary.xml",{type:"text/plain"}));let g=[];g=g.concat(this.searchImageFiles(r)),g=g.concat(this.searchImageFiles(o));for(const W of g)W.state===Hr.COMPLETE&&i.push(new File([W.blob],W.identifier+"."+Lf.extension(W.blob.type),{type:W.blob.type}));let w=this.convertToXml($b.create(g));return i.push(new File([w],"imagetag.xml",{type:"text/plain"})),this.saveAsync(i,this.appendTimestamp(t),e)}saveGameObjectAsync(t,e="xml_data",i){return ko.queue.add((r,o)=>r(this._saveGameObjectAsync(t,e,i)))}_saveGameObjectAsync(t,e="xml_data",i){let r=[],o=this.convertToXml(t);r.push(new File([o],"data.xml",{type:"text/plain"}));let s=[];s=s.concat(this.searchImageFiles(o));for(const g of s)g.state===Hr.COMPLETE&&r.push(new File([g.blob],g.identifier+"."+Lf.extension(g.blob.type),{type:g.blob.type}));let a=this.convertToXml($b.create(s));return r.push(new File([a],"imagetag.xml",{type:"text/plain"})),this.saveAsync(r,this.appendTimestamp(e),i)}saveAsync(t,e,i){let r=-1;return Cl.instance.saveAsync(t,e,o=>{let s=0|o.percent;s<=r||(r=s,this.ngZone.run(()=>i(r)))})}convertToXml(t){return'<?xml version="1.0" encoding="UTF-8"?>\n'+SG.xml(t.toXml(),2)}searchImageFiles(t){let e=Yc.xml2element(t),i=[];if(!e)return i;let r={},o=e.ownerDocument.querySelectorAll('*[type="image"]');for(let s=0;s<o.length;s++){let a=o[s].innerHTML;r[a]=St.instance.get(a)}o=e.ownerDocument.querySelectorAll("*[imageIdentifier], *[backgroundImageIdentifier]");for(let s=0;s<o.length;s++){let a=o[s].getAttribute("imageIdentifier");a&&(r[a]=St.instance.get(a));let g=o[s].getAttribute("backgroundImageIdentifier");g&&(r[g]=St.instance.get(g))}for(let s in r){let a=r[s];a&&i.push(a)}return i}saveHtmlChatLog(t,e){let i=t.logHtml(),r=new Blob([i],{type:"text/plain;charset=utf-8"});(0,Zm.saveAs)(r,e+".html")}saveHtmlChatLogAll(t){let e=Vs.instance.logHtml(),i=new Blob([e],{type:"text/plain;charset=utf-8"});(0,Zm.saveAs)(i,t+".html")}saveHtmlChatLogCoc(t,e){let i=t.logHtmlCoc(),r=new Blob([i],{type:"text/plain;charset=utf-8"});(0,Zm.saveAs)(r,e+".html")}saveHtmlChatLogAllCoc(t){let e=Vs.instance.logHtmlCoc(),i=new Blob([e],{type:"text/plain;charset=utf-8"});(0,Zm.saveAs)(i,t+".html")}appendTimestamp(t){let e=new Date;return t+`_${e.getFullYear()}-${("00"+(e.getMonth()+1)).slice(-2)}-${("00"+e.getDate()).slice(-2)}_${("00"+e.getHours()).slice(-2)}${("00"+e.getMinutes()).slice(-2)}`}}function DG(n,t){if(1&n&&(J(0,"option",9),we(1),oe()),2&n){const e=t.$implicit;Ht("value",e.identifier),j(1),xt(e.name)}}function IG(n,t){if(1&n&&(J(0,"div",19),we(1),oe()),2&n){const e=$e(3);j(1),sn("",e.progresPercent,"%")}}ko.queue=new SP("SaveDataServiceQueue"),ko.\u0275fac=function(t){return new(t||ko)(In(An))},ko.\u0275prov=Tn({token:ko,factory:ko.\u0275fac,providedIn:"root"});const kG=function(n){return{"is-hidden":n}};function MG(n,t){if(1&n){const e=pt();Je(0),J(1,"div",11),we(2," \u30bf\u30d6\u524a\u9664\u3092\u6709\u52b9\u306b\u3059\u308b"),J(3,"input",12),Re("ngModelChange",function(r){return Le(e),$e(2).allowDeleteTab=r}),oe()(),J(4,"button",2),Re("click",function(){return Le(e),$e(2).upTabIndex()}),we(5,"\u2191"),oe(),J(6,"button",2),Re("click",function(){return Le(e),$e(2).downTabIndex()}),we(7,"\u2193"),oe(),J(8,"button",13),Re("click",function(){return Le(e),$e(2).save()}),J(9,"div",14)(10,"div",15),we(11,"\u4fdd\u5b58"),oe(),Ee(12,IG,2,1,"div",16),oe()(),it(13,"span",17),J(14,"button",18),Re("click",function(){return Le(e),$e(2).delete()}),we(15,"\u9078\u629e\u30bf\u30d6\u524a\u9664"),oe(),it(16,"br"),et()}if(2&n){const e=$e(2);j(3),ie("ngModel",e.allowDeleteTab),j(5),ie("disabled",e.isSaveing),j(2),ie("ngClass",Nt(6,kG,e.isSaveing)),j(2),ie("ngIf",e.isSaveing),j(2),Yt("disabled",e.chatTabs.length<=1?"":null)("disabled",e.allowDeleteTab?null:"")}}function AG(n,t){if(1&n){const e=pt();Je(0),J(1,"button",2),Re("click",function(){return Le(e),$e(2).restore()}),we(2,"\u5143\u306b\u623b\u3059"),oe(),et()}}function PG(n,t){if(1&n){const e=pt();Je(0),it(1,"hr"),J(2,"button",20),Re("click",function(){return Le(e),$e(2).saveLog()}),we(3,"\u30ed\u30b0\u4fdd\u5b58"),oe(),J(4,"span",5),we(5,"\u30ea\u30b9\u30c8\u304b\u3089\u9078\u3093\u3060\u30ed\u30b0\u3092\u4fdd\u5b58"),oe(),it(6,"br"),J(7,"button",20),Re("click",function(){return Le(e),$e(2).saveAllLog()}),we(8,"\u5168\u30bf\u30d6\u30ed\u30b0\u4fdd\u5b58"),oe(),J(9,"span",5),we(10,"\u6642\u7cfb\u5217\u9806\u306b\u307e\u3068\u3081\u3066\u4fdd\u5b58"),oe(),it(11,"br"),J(12,"span"),we(13,"\u306b\u308f\u3068\u308a\u3055\u3093\u98a8\u306e\u5f62\u5f0f\u306b\u3059\u308b"),oe(),J(14,"input",21),Re("ngModelChange",function(r){return Le(e),$e(2).modeCocLog=r}),oe(),it(15,"br"),et()}if(2&n){const e=$e(2);j(14),ie("ngModel",e.modeCocLog)}}function FG(n,t){if(1&n){const e=pt();Je(0),we(1," \u30ed\u30b0\u306e\u6d88\u53bb\u6a5f\u80fd\u3092\u6709\u52b9\u306b\u3059\u308b"),J(2,"input",22),Re("ngModelChange",function(r){return Le(e),$e(2).allowDeleteLog=r}),oe(),it(3,"br"),J(4,"button",23),Re("click",function(){return Le(e),$e(2).deleteLog()}),we(5,"\u9078\u629e\u30ed\u30b0\u6d88\u53bb"),oe(),J(6,"button",23),Re("click",function(){return Le(e),$e(2).deleteLogALL()}),we(7,"\u5168\u30ed\u30b0\u6d88\u53bb"),oe(),et()}if(2&n){const e=$e(2);j(2),ie("ngModel",e.allowDeleteLog),j(2),Yt("disabled",e.chatTabs.length<=1?"":null)("disabled",e.allowDeleteLog?null:""),j(2),Yt("disabled",e.chatTabs.length<=1?"":null)("disabled",e.allowDeleteLog?null:"")}}function RG(n,t){if(1&n){const e=pt();Je(0),J(1,"div"),we(2,"\u30bf\u30d6\u540d : "),J(3,"input",10),Re("ngModelChange",function(r){return Le(e),$e().tabName=r}),oe()(),it(4,"hr"),J(5,"div"),Ee(6,MG,17,8,"ng-container",8),Ee(7,AG,3,0,"ng-container",8),Ee(8,PG,16,1,"ng-container",8),it(9,"hr")(10,"br")(11,"br"),Ee(12,FG,8,5,"ng-container",8),oe(),et()}if(2&n){const e=$e();j(3),ie("ngModel",e.tabName),Yt("disabled",e.isEditable?null:""),j(3),ie("ngIf",!e.isDeleted),j(1),ie("ngIf",e.isDeleted),j(1),ie("ngIf",!e.isDeleted),j(4),ie("ngIf",!e.isDeleted)}}function NG(n,t){1&n&&(Je(0),J(1,"div",5),we(2,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b\u300d\u304b\u3089\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),oe(),et())}let OG=(()=>{class n{constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=o,this.selectedTab=null,this.selectedTabXml="",this.isSaveing=!1,this.progresPercent=0,this.allowDeleteLog=!1,this.allowDeleteTab=!1,this.modeCocLog=!1}get chatTabList(){return Xe.instance.get("ChatTabList")}get systemTabIndex(){return this.chatTabList.systemMessageTabIndex}set systemTabIndex(e){this.chatTabList.systemMessageTabIndex=e}systemTab(){return this.chatTabList.systemMessageTab}get tabName(){return this.selectedTab.name}set tabName(e){this.isEditable&&(this.selectedTab.name=e)}get chatTabs(){return this.chatMessageService.chatTabs}get isEmpty(){return this.chatMessageService.chatTabs.length<1}get isDeleted(){return!!this.selectedTab&&null==Xe.instance.get(this.selectedTab.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u8a2d\u5b9a"),Qe.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTab||e.data.identifier!==this.selectedTab.identifier)return;let i=Xe.instance.get(e.data.identifier);null!==i&&(this.selectedTabXml=i.toXml())})}ngOnDestroy(){Qe.unregister(this)}onChangeSelectTab(e){this.selectedTab=Xe.instance.get(e),this.selectedTabXml=""}onChangeSystemTab(){if(this.selectedTab){const i=this.selectedTab.parent.children.indexOf(this.selectedTab);this.chatTabList.systemMessageTabIndex=i}else this.chatTabList.systemMessageTabIndex=0}create(){Vs.instance.addChatTab("\u30bf\u30d6")}save(){var e=this;return(0,xn.Z)(function*(){if(!e.selectedTab||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="chat_"+e.selectedTab.name;yield e.saveDataService.saveGameObjectAsync(e.selectedTab,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}get roomName(){return bt.peerContext&&0<bt.peerContext.roomName.length?bt.peerContext.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf"}appendTimestamp(e){let i=new Date;return e+`_${i.getFullYear()}-${("00"+(i.getMonth()+1)).slice(-2)}-${("00"+i.getDate()).slice(-2)}_${("00"+i.getHours()).slice(-2)}${("00"+i.getMinutes()).slice(-2)}`}saveLog(){if(!this.selectedTab)return;let i=this.appendTimestamp(this.roomName+"_log_"+this.selectedTab.name);console.log("this.modeCocLog:"+this.modeCocLog),this.modeCocLog?this.saveDataService.saveHtmlChatLogCoc(this.selectedTab,i):this.saveDataService.saveHtmlChatLog(this.selectedTab,i)}saveAllLog(){let i=this.appendTimestamp(this.roomName+"_log_\u5168\u30bf\u30d6");console.log("this.modeCocLog:"+this.modeCocLog),this.modeCocLog?this.saveDataService.saveHtmlChatLogAllCoc(i):this.saveDataService.saveHtmlChatLogAll(i)}delete(){if(!this.isEmpty&&this.selectedTab){let i=this.selectedTab.parent.children.indexOf(this.selectedTab);this.selectedTabXml=this.selectedTab.toXml(),this.selectedTab.destroy(),this.systemTabIndex>i&&this.systemTabIndex--,this.chkSystemTabIndex()}}get myPeer(){return _t.myCursor}deleteLog(){if(this.allowDeleteLog){if(!this.isEmpty&&this.selectedTab){for(;this.selectedTab.children.length>0;)this.selectedTab.children[0].destroy();this.selectedTab.tachieReset()}this.chatMessageService.sendMessage(this.selectedTab,"\u30ed\u30b0\u3092\u30af\u30ea\u30a2\u3057\u307e\u3057\u305f",null,this.myPeer.identifier,"",0,"#000000")}}deleteLogALL(){if(this.allowDeleteLog)for(let o of Vs.instance.chatTabs){for(;o.children.length>0;)o.children[0].destroy();o.tachieReset(),this.chatMessageService.sendMessage(o,"\u30ed\u30b0\u3092\u30af\u30ea\u30a2\u3057\u307e\u3057\u305f",null,this.myPeer.identifier,"",0,"#000000")}}restore(){if(this.selectedTab&&this.selectedTabXml){let e=er.instance.parseXml(this.selectedTabXml);Vs.instance.addChatTab(e),this.selectedTabXml=""}}chkSystemTabIndex(){let e=this.chatTabList;this.systemTabIndex>=e.children.length&&(this.systemTabIndex=e.children.length-1),this.systemTabIndex<0&&(this.systemTabIndex=0)}upTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);0<i&&(e.insertBefore(this.selectedTab,e.children[i-1]),this.systemTabIndex==i?this.systemTabIndex--:this.systemTabIndex==i-1&&this.systemTabIndex++,this.chkSystemTabIndex())}downTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);i<e.children.length-1&&(e.insertBefore(e.children[i+1],this.selectedTab),this.systemTabIndex==i?this.systemTabIndex++:this.systemTabIndex==i+1&&this.systemTabIndex--,this.chkSystemTabIndex())}}return n.\u0275fac=function(e){return new(e||n)(Be(pi),Be($n),Be(go),Be(ko))},n.\u0275cmp=Qt({type:n,selectors:[["app-chat-tab-setting"]],decls:17,vars:5,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[3,"click"],["size","10",2,"width","10em",3,"ngModel","change"],[3,"value",4,"ngFor","ngForOf"],[2,"font-size","12px"],[2,"width","10em","overflow","hidden","font-size","14px"],[1,"flex-item"],[4,"ngIf"],[3,"value"],["placeholder","Name",1,"is-caret",3,"ngModel","ngModelChange"],[2,"padding-left","45px"],["type","checkbox","value","allowDeleteTab",3,"ngModel","ngModelChange"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[2,"display","inline-block","width","2em"],[1,"danger",3,"click"],[1,"progress"],[2,"width","9em",3,"click"],["type","checkbox","value","modeCocLog",3,"ngModel","ngModelChange"],["type","checkbox","value","allowDeleteLog",3,"ngModel","ngModelChange"],[1,"danger",2,"width","9em",3,"click"]],template:function(e,i){if(1&e&&(J(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Re("click",function(){return i.create()}),we(4,"\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b"),oe()(),J(5,"select",3),Re("change",function(o){return i.onChangeSelectTab(o.target.value)}),Ee(6,DG,2,2,"option",4),oe(),J(7,"div",5)(8,"button",2),Re("click",function(){return i.onChangeSystemTab()}),we(9,"\u30b7\u30b9\u30c6\u30e0\u8868\u793a\u5148\u6307\u5b9a"),oe()(),J(10,"div",6),we(11," \u73fe\u5728\u30b7\u30b9\u30c6\u30e0\u8868\u793a\u5148\uff1a"),it(12,"br"),we(13),oe()(),J(14,"div",7),Ee(15,RG,13,6,"ng-container",8),oe()(),Ee(16,NG,3,0,"ng-container",8)),2&e){let r;j(5),ie("ngModel",null==i.selectedTab?null:i.selectedTab.identifier),j(1),ie("ngForOf",i.chatTabs),j(7),sn("",null==(r=i.systemTab())?null:r.name," "),j(2),ie("ngIf",!i.isEmpty&&i.selectedTab),j(1),ie("ngIf",i.isEmpty)}},directives:[nc,Ti,yi,si,ic,rc,Sn,Fi,ra,ir],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();function BG(n,t){if(1&n&&(J(0,"option",19),we(1),oe()),2&n){const e=t.$implicit;Ht("value",e.identifier),j(1),xt(e.name)}}function LG(n,t){if(1&n&&(J(0,"ng-option",19),we(1),oe()),2&n){const e=t.$implicit;ie("value",e.id),j(1),xt(e.name)}}function zG(n,t){1&n&&(J(0,"div",20)(1,"i",21),we(2,"info_outline"),oe(),we(3," \u30c0\u30a4\u30b9\u8868\u7de8\u96c6\u4e2d\u3067\u3059 "),oe())}function HG(n,t){if(1&n&&(J(0,"option",19),we(1),oe()),2&n){const e=t.$implicit;Ht("value",e),j(1),xt(e)}}function VG(n,t){if(1&n&&(Je(0),Ee(1,HG,2,2,"option",4),et()),2&n){const e=$e(3);j(1),ie("ngForOf",e.selectedTable.diceTablePalette.getPalette())}}function UG(n,t){if(1&n&&(Je(0),Ee(1,VG,2,1,"ng-container",18),et()),2&n){const e=$e(2);j(1),ie("ngIf",e.selectedTable.diceTablePalette)}}function jG(n,t){if(1&n&&(J(0,"div",22)(1,"select",23),Ee(2,UG,2,1,"ng-container",18),oe()()),2&n){const e=$e();j(2),ie("ngIf",e.selectedTable)}}function GG(n,t){if(1&n){const e=pt();J(0,"div",22)(1,"textarea",24),Re("ngModelChange",function(r){return Le(e),$e().editPalette=r}),oe()()}if(2&n){const e=$e();j(1),ie("ngModel",e.editPalette)}}function qG(n,t){1&n&&(J(0,"span"),we(1,"\u30c0\u30a4\u30b9\u8868\u306e\u7de8\u96c6"),oe())}function WG(n,t){1&n&&(J(0,"span"),we(1,"\u30c0\u30a4\u30b9\u8868\u3092\u78ba\u5b9a"),oe())}function ZG(n,t){if(1&n){const e=pt();Je(0),J(1,"button",2),Re("click",function(){return Le(e),$e().save()}),we(2,"\u4fdd\u5b58"),oe(),J(3,"button",25),Re("click",function(){return Le(e),$e().delete()}),we(4,"\u524a\u9664"),oe(),et()}if(2&n){const e=$e();j(3),Yt("disabled",e.getDiceTables().length<=0?"":null)}}function YG(n,t){1&n&&(Je(0),J(1,"div",26),we(2,"\u203b\u30c0\u30a4\u30b9\u8868\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u65b0\u3057\u3044\u8868\u3092\u4f5c\u308b\u300d\u304b\u3089\u65b0\u3057\u3044\u30c0\u30a4\u30b9\u8868\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),oe(),et())}const KG=function(){return{standalone:!0}};let XG=(()=>{class n{constructor(e,i,r){this.modalService=e,this.saveDataService=i,this.panelService=r,this._gameType="",this.gameTypeChange=new Xt,this.isEdit=!1,this.selectedTable=null,this.editPalette="",this.isSaveing=!1,this.progresPercent=0}get gameType(){return this.isEditable?this.selectedTable.diceTablePalette.dicebot:""}set gameType(e){this.isEditable&&(this.selectedTable.diceTablePalette.dicebot=e,this._gameType=e,this.gameTypeChange.emit(e))}loadDiceBot(e){console.log("onChangeGameType ready"),sr.getHelpMessage(e).then(i=>{console.log("onChangeGameType done\n"+i)})}get diceBotInfos(){return sr.diceBotInfos}get tableName(){return this.isEditable?this.selectedTable.name:""}set tableName(e){this.isEditable&&(this.selectedTable.name=e)}get tableDice(){return this.isEditable?this.selectedTable.dice:""}set tableDice(e){this.isEditable&&(this.selectedTable.dice=e)}get tableCommand(){return this.isEditable?this.selectedTable.command:""}set tableCommand(e){this.isEditable&&(this.selectedTable.command=e)}get tableText(){return this.isEditable?this.selectedTable.text:""}set tableText(e){this.isEditable&&console.log(e),this.isEditable&&(this.selectedTable.text=e+"")}get diceTablePalette(){if(!this.isEditable)return null;for(let e of this.selectedTable.children)if(e instanceof Gm)return e;return null}get isEmpty(){return!1}get isSelected(){return!!this.selectedTable}get isDeleted(){return!this.selectedTable||null==Xe.instance.get(this.selectedTable.identifier)}get isEditable(){return!this.isEmpty&&this.isSelected&&!this.isDeleted}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30c0\u30a4\u30b9\u8868\u8a2d\u5b9a")}ngAfterViewInit(){}ngOnDestroy(){}selectDiceTable(e){this.selectedTable=Xe.instance.get(e)}getDiceTables(){return Xe.instance.getObjects(_c)}createDiceTable(){let e=_c.create();this.selectDiceTable(e.identifier)}save(){var e=this;return(0,xn.Z)(function*(){if(!e.selectedTable)return;e.isSaveing=!0,e.progresPercent=0;let i="dice_table_"+e.selectedTable.name;yield e.saveDataService.saveGameObjectAsync(e.selectedTable,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}delete(){!this.isEmpty&&this.selectedTable&&this.selectedTable.destroy()}toggleEditMode(){this.isEdit=!this.isEdit,this.isEdit?this.editPalette=this.selectedTable.diceTablePalette.value+"":this.selectedTable.diceTablePalette.setPalette(this.editPalette)}}return n.\u0275fac=function(e){return new(e||n)(Be(pi),Be(ko),Be($n))},n.\u0275cmp=Qt({type:n,selectors:[["dice-table-setting"]],inputs:{_gameType:["gameType","_gameType"]},outputs:{gameTypeChange:"gameTypeChange"},decls:41,vars:24,consts:[[1,"table"],[1,"table-cell",2,"width","13em"],[3,"click"],["size","15;padding-right:5px",2,"width","100%",3,"ngModel","change"],[3,"value",4,"ngFor","ngForOf"],[1,"table-cell",2,"width","5px","max-width","5px"],[1,"table-cell"],[1,"table-cell",2,"width","7em"],[2,"width","7em","display","inline-block"],[1,"table-cell",2,"width","100%","padding-right","10px"],["placeholder","Name",1,"is-caret",2,"width","100%",3,"ngModel","ngModelChange"],["placeholder","Dice",1,"is-caret",2,"width","100%",3,"ngModel","ngModelChange"],["placeholder","Command",1,"is-caret",2,"width","100%",3,"ngModel","ngModelChange"],[1,"ud-select","is-caret",2,"width","12em",3,"ngModel","ngModelOptions","clearable","change","ngModelChange"],["class","edit-info",4,"ngIf"],["style","flex-grow: 1; height: 0; min-height: 150px;",4,"ngIf"],[2,"flex-grow","0"],["type","submit",3,"click"],[4,"ngIf"],[3,"value"],[1,"edit-info"],[1,"material-icons",2,"vertical-align","bottom","size","0.8rem"],[2,"flex-grow","1","height","0","min-height","150px"],["size","5",1,"palette",2,"overflow-y","auto"],["placeholder","\u30c0\u30a4\u30b9\u8868",1,"palette","is-caret",2,"resize","none",3,"ngModel","ngModelChange"],[1,"danger",3,"click"],[2,"font-size","12px"]],template:function(e,i){1&e&&(J(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Re("click",function(){return i.createDiceTable()}),we(4,"\u65b0\u3057\u3044\u8868\u3092\u4f5c\u308b"),oe()(),J(5,"select",3),Re("change",function(o){return i.selectDiceTable(o.target.value)}),Ee(6,BG,2,2,"option",4),oe()(),it(7,"div",5),J(8,"div",6)(9,"div",0)(10,"div",7)(11,"span",8),we(12,"\u8868\u30bf\u30a4\u30c8\u30eb :"),oe()(),J(13,"div",9)(14,"input",10),Re("ngModelChange",function(o){return i.tableName=o}),oe()()(),J(15,"div",0)(16,"div",7)(17,"span",8),we(18,"\u30c0\u30a4\u30b9 :"),oe()(),J(19,"div",9)(20,"input",11),Re("ngModelChange",function(o){return i.tableDice=o}),oe()()(),J(21,"div")(22,"div",7)(23,"span",8),we(24,"\u30b3\u30de\u30f3\u30c9 :"),oe()(),J(25,"div",9)(26,"input",12),Re("ngModelChange",function(o){return i.tableCommand=o}),oe()()(),J(27,"div")(28,"ng-select",13),Re("change",function(o){return i.loadDiceBot(o)})("ngModelChange",function(o){return i.gameType=o}),Ee(29,LG,2,2,"ng-option",4),oe()(),Ee(30,zG,4,0,"div",14),Ee(31,jG,3,1,"div",15),Ee(32,GG,2,1,"div",15),J(33,"div",16)(34,"button",17),Re("click",function(){return i.toggleEditMode()}),Ee(35,qG,2,0,"span",18),Ee(36,WG,2,0,"span",18),oe()(),it(37,"hr"),J(38,"div"),Ee(39,ZG,5,1,"ng-container",18),oe(),Ee(40,YG,3,0,"ng-container",18),oe()()),2&e&&(j(3),Yt("disabled",i.isEdit?"":null),j(2),ie("ngModel",null==i.selectedTable?null:i.selectedTable.identifier),Yt("disabled",i.isEdit?"":null),j(1),ie("ngForOf",i.getDiceTables()),j(8),ie("ngModel",i.tableName),Yt("disabled",i.isEditable?null:""),j(6),ie("ngModel",i.tableDice),Yt("disabled",i.isEditable?null:""),j(6),ie("ngModel",i.tableCommand),Yt("disabled",i.isEditable?null:""),j(2),ie("ngModel",i.gameType)("ngModelOptions",$r(23,KG))("clearable",!1),Yt("disabled",i.isEditable?null:""),j(1),ie("ngForOf",i.diceBotInfos),j(1),ie("ngIf",i.isEdit),j(1),ie("ngIf",!i.isEdit),j(1),ie("ngIf",i.isEdit),j(2),Yt("disabled",i.isEditable?null:""),j(1),ie("ngIf",!i.isEdit),j(1),ie("ngIf",i.isEdit),j(3),ie("ngIf",!i.isDeleted),j(1),ie("ngIf",i.isEmpty))},directives:[nc,Ti,yi,si,ic,rc,Fi,gp,wf,Sn],styles:[".edit-info[_ngcontent-%COMP%]{width:100%;text-align:center;color:#ccc;background-color:#1e1e1ecc}.palette[_ngcontent-%COMP%]{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;width:100%;height:100%}.flex-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}.dice-table[_ngcontent-%COMP%]{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;width:100%;height:15em}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.images-select[_ngcontent-%COMP%]{display:flex}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-cell[_ngcontent-%COMP%]{display:table-cell;vertical-align:top;box-sizing:border-box}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})(),Ii=(()=>{class n{constructor(e){this._sanitizer=e}transform(e,i="html"){switch(i){case"html":return this._sanitizer.bypassSecurityTrustHtml(e);case"style":return this._sanitizer.bypassSecurityTrustStyle(e);case"script":return this._sanitizer.bypassSecurityTrustScript(e);case"url":return this._sanitizer.bypassSecurityTrustUrl(e);case"resourceUrl":return this._sanitizer.bypassSecurityTrustResourceUrl(e);default:throw new Error(`Invalid safe type specified: ${i}`)}}}return n.\u0275fac=function(e){return new(e||n)(Be(Q1,16))},n.\u0275pipe=jr({name:"safe",type:n,pure:!0}),n})();function QG(n,t){1&n&&pn(0)}function JG(n,t){1&n&&(J(0,"div"),we(1,"\u81ea\u5206\u3057\u304b\u90e8\u5c4b\u306b\u3044\u307e\u305b\u3093"),oe())}function eq(n,t){1&n&&pn(0)}const tq=function(){return{box:!0}},nq=function(n){return{peer:n}};function iq(n,t){if(1&n&&(J(0,"div",6),Ee(1,eq,1,0,"ng-container",7),oe()),2&n){const e=t.$implicit;$e();const i=ln(7);ie("ngClass",$r(3,tq)),j(1),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",Nt(4,nq,e))}}function rq(n,t){if(1&n){const e=pt();J(0,"form",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"input",12),Re("ngModelChange",function(r){return Le(e),$e().includSelf=r})("click",function(){return Le(e),$e().changeIncludSelf()}),oe(),J(5,"span"),we(6,"\u81ea\u5206\u3092\u542b\u3081\u308b"),oe(),J(7,"input",13),Re("change",function(){return Le(e),$e().onChangeType()}),oe(),J(8,"span"),we(9,"\u70b9\u547c"),oe(),J(10,"input",14),Re("change",function(){return Le(e),$e().onChangeType()}),oe(),J(11,"span"),we(12,"\u6295\u7968"),oe()(),J(13,"div",11)(14,"span",15),we(15,"\u30bf\u30a4\u30c8\u30eb:"),oe(),J(16,"input",16),Re("ngModelChange",function(r){return Le(e),$e().voteTitle=r}),oe(),it(17,"br"),J(18,"span",15),we(19,"\u9078\u629e\u80a2:"),oe(),J(20,"input",17),Re("ngModelChange",function(r){return Le(e),$e().voteContentsText=r}),oe()(),J(21,"div",11)(22,"button",18),Re("click",function(){return Le(e),$e().send()}),we(23,"\u9001\u4fe1"),oe(),it(24,"br"),J(25,"span",19),we(26),oe()()()()()}if(2&n){const e=$e();j(4),na("id","includSelf_",e.initTimestamp,""),ie("ngModel",e.includSelf),j(3),na("id","rollcall_",e.initTimestamp,""),ie("checked",!0),j(3),na("id","vote_",e.initTimestamp,""),j(6),ie("ngModel",e.voteTitle),Yt("disabled",e.isRollCall?"":null),j(4),ie("ngModel",e.voteContentsText),Yt("disabled",e.isRollCall?"":null),j(2),Yt("disabled",0==e.selectedNum()?"":null),j(4),sn("\u4eba\u6570:",e.selectedNum(),"")}}function oq(n,t){if(1&n&&(J(0,"div",31),At(1,"safe"),oe()),2&n){const e=$e().peer;un("background-image",Ft(1,2,"url("+$e().findPeerImage(e.peerId).url+")","style"))}}function sq(n,t){if(1&n&&(Je(0),we(1),et()),2&n){const e=$e().peer,i=$e();j(1),xt(i.findPeerLastControlName(e.peerId))}}function aq(n,t){1&n&&(Je(0),we(1,"\u64cd\u4f5c\u30ad\u30e3\u30e9\u306a\u3057"),et())}function lq(n,t){if(1&n&&(J(0,"div",31),At(1,"safe"),oe()),2&n){const e=$e().peer;un("background-image",Ft(1,2,"url("+$e().findPeerLastControlImage(e.peerId).url+")","style"))}}function cq(n,t){1&n&&it(0,"div",32)}function uq(n,t){if(1&n){const e=pt();J(0,"div",20),Re("click",function(){const o=Le(e).peer;return $e().voteBlockClick(o.peerId)}),J(1,"div",21)(2,"div",22)(3,"div",23),we(4," \u9001\u4fe1\u5bfe\u8c61 "),oe(),J(5,"div",24)(6,"div")(7,"input",25),Re("change",function(){const o=Le(e).peer;return $e().onChange(o.peerId)}),oe()()()(),J(8,"div",22)(9,"div",26),we(10),oe(),J(11,"div",27),Ee(12,oq,2,5,"div",28),oe()(),J(13,"div",22)(14,"div",26),Ee(15,sq,2,1,"ng-container",2),Ee(16,aq,2,0,"ng-container",2),oe(),J(17,"div",27),Ee(18,lq,2,5,"div",28),Ee(19,cq,1,0,"div",28),oe()(),J(20,"div",29)(21,"div",30),we(22," \u73fe\u5728\u63a5\u7d9a\u304c\u5207\u308c\u3066\u3044\u308b\u3068\u8003\u3048\u3089\u308c\u308b\u76f8\u624b\u3067\u3059 "),oe()()()()}if(2&n){const e=t.peer,i=$e();j(7),tp("id","",e.peerId,"_",i.initTimestamp,""),j(3),sn(" ",i.findPeerName(e.peerId)," "),j(2),ie("ngIf",i.findPeerImage(e.peerId)),j(3),ie("ngIf",i.findPeerLastControlName(e.peerId)),j(1),ie("ngIf",!i.findPeerLastControlName(e.peerId)),j(2),ie("ngIf",i.findPeerLastControlImage(e.peerId)),j(1),ie("ngIf",!i.findPeerLastControlImage(e.peerId)),j(2),ie("hidden",!i.isPeerIsDisConnect(e.peerId))}}let dq=(()=>{class n{constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=o,this.initTimestamp=0,this.networkService=bt,this.voteContentsText="",this.voteTitle="\u6295\u7968",this.isRollCall=!0,this.includSelf=!1,this.initTimestamp=Date.now()}get peerList(){return this.networkService.peerContexts}get myPeer(){return _t.myCursor}get vote(){return Xe.instance.get("Vote")}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u70b9\u547c/\u6295\u7968\u8a2d\u5b9a"),this.setDefaultCheck()}ngAfterViewInit(){setTimeout(()=>{this.setDefaultCheck()},0)}isPeerIsDisConnect(e){return!_t.findByPeerId(e)||_t.findByPeerId(e).isDisConnect}setDefaultCheck(){const e=this.peerList;for(let i of e){let r=document.getElementById(i.peerId+"_"+this.initTimestamp);r&&(r.checked=!this.isPeerIsDisConnect(i.peerId))}}selectedNum(){return this.selectedList().length}selectedList(){const i=this.peerList;let r=[];for(let o of i){let s=document.getElementById(o.peerId+"_"+this.initTimestamp);s&&s.checked&&r.push(o.peerId)}return this.includSelf&&r.push(this.myPeer.peerId),r}send(){let i,o,e=this.vote,r=this.voteContentsText.replace(/\s*$/i,"").replace(/^\s*/i,"");this.isRollCall?(r="\u6e96\u5099\u5b8c\u4e86",o="\u70b9\u547c\u958b\u59cb\uff01",i="\u70b9\u547c"):(r=0==r.length?"\u8cdb\u6210 \u53cd\u5bfe":r,o="\u6295\u7968\u958b\u59cb\uff01("+this.voteTitle+")",i=this.voteTitle);let s=r.split(/\s+/i),a=this.selectedList();e.makeVote(_t.myCursor.peerId,i,a,s,this.isRollCall),e.startVote(),this.chatMessageService.sendSystemMessageLastSendCharactor(o),this.panelService.close()}changeIncludSelf(){}onChangeType(e){let i=document.getElementById("rollcall_"+this.initTimestamp);this.isRollCall=i.checked}voteBlockClick(e){let i=document.getElementById(e+"_"+this.initTimestamp);i.checked=!i.checked}onChange(e){this.voteBlockClick(e)}findUserId(e){const i=_t.findByPeerId(e);return i?i.userId:""}findPeerName(e){const i=_t.findByPeerId(e);return i?i.name:""}findPeerLastControlName(e){const i=_t.findByPeerId(e);return i?i.lastControlCharacterName:""}findPeerImage(e){const i=_t.findByPeerId(e);return i?i.image:null}findPeerLastControlImage(e){const i=_t.findByPeerId(e);return i?i.lastControlImage:null}ngOnDestroy(){Qe.unregister(this)}}return n.\u0275fac=function(e){return new(e||n)(Be(pi),Be($n),Be(go),Be(ko))},n.\u0275cmp=Qt({type:n,selectors:[["app-vote-menu"]],decls:8,vars:3,consts:[[1,"component"],[4,"ngTemplateOutlet"],[4,"ngIf"],["style","font-size: 15px;",3,"ngClass",4,"ngFor","ngForOf"],["voteTop",""],["voteTargets",""],[2,"font-size","15px",3,"ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"is-sticky-top"],[1,"tab"],[2,"display","table"],[2,"display","table-cell"],["type","checkbox","value","includSelf","name","includSelf",3,"ngModel","id","ngModelChange","click"],["type","radio","name","vote_rollcall","value","rollcall",3,"checked","id","change"],["type","radio","name","vote_rollcall","value","vote",3,"id","change"],[2,"display","inline-block","width","5em","margin-left","0.5em"],["placeholder","","name","voteTitle",1,"is-caret",2,"width","15em",3,"ngModel","ngModelChange"],["placeholder","\u30b9\u30da\u30fc\u30b9\u533a\u5207 \u672a\u5165\u529b\u3067\u8cdb\u6210/\u53cd\u5bfe","name","voteContents",1,"is-caret",2,"width","15em",3,"ngModel","ngModelChange"],[3,"click"],[2,"display","inline-block","margin-left","0.5em"],[1,"inventory-object",3,"click"],[1,"object-tags-box"],[1,"table-cell"],[1,"object-name",2,"width","6em"],[1,"message",2,"height","64px"],["type","checkbox","name","vote_chk",3,"id","change"],[1,"object-name"],[1,"image-box"],["class","image cover",3,"background-image",4,"ngIf"],[1,"table-cell","message"],[3,"hidden"],[1,"image","cover"],[1,"image","cover",3,"background-image"]],template:function(e,i){if(1&e&&(J(0,"div",0),Ee(1,QG,1,0,"ng-container",1),Ee(2,JG,2,0,"div",2),Ee(3,iq,2,6,"div",3),oe(),Ee(4,rq,27,11,"ng-template",null,4,Ln),Ee(6,uq,23,9,"ng-template",null,5,Ln)),2&e){const r=ln(5);j(1),ie("ngTemplateOutlet",r),j(1),ie("ngIf",i.peerList.length<1),j(1),ie("ngForOf",i.peerList)}},directives:[Ra,Sn,si,ir,_s,gs,xo,ra,Ti,yi,Fi],pipes:[Ii],styles:[".component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border:transparent 2px solid;border-left:transparent 6px solid;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border:1px dotted #666}.message[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;vertical-align:middle}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #444}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.tab[_ngcontent-%COMP%]{padding:0;border:solid 1px #555;border-radius:.3em;overflow:hidden;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;background-color:#f0dabde6}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin-left:10px;margin-top:-3px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.is-sticky-top[_ngcontent-%COMP%]{position:sticky;top:0}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table-cell[_ngcontent-%COMP%]{display:table-cell}.image-box[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;max-width:64px;max-height:64px;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:table-cell;vertical-align:top}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.image-cover[_ngcontent-%COMP%]{width:100%;height:100%}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em;width:120px;overflow:hidden;white-space:nowrap}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();function fq(n,t){1&n&&pn(0)}function hq(n,t){1&n&&(J(0,"div"),we(1,"\u81ea\u5206\u3057\u304b\u90e8\u5c4b\u306b\u3044\u307e\u305b\u3093"),oe())}function pq(n,t){1&n&&pn(0)}const gq=function(){return{box:!0}},_q=function(n){return{peer:n}};function mq(n,t){if(1&n&&(J(0,"div",6),Ee(1,pq,1,0,"ng-container",7),oe()),2&n){const e=t.$implicit;$e();const i=ln(7);ie("ngClass",$r(3,gq)),j(1),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",Nt(4,_q,e))}}function $q(n,t){if(1&n){const e=pt();J(0,"form",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"input",12),Re("ngModelChange",function(r){return Le(e),$e().includSelf=r})("click",function(){return Le(e),$e().changeIncludSelf()}),oe(),J(5,"span"),we(6,"\u81ea\u5206\u3092\u542b\u3081\u308b"),oe()(),J(7,"div",13)(8,"div",14)(9,"span",15),we(10,"\u30bf\u30a4\u30c8\u30eb:"),oe(),J(11,"input",16),Re("ngModelChange",function(r){return Le(e),$e().alarmTitle=r}),oe(),it(12,"br"),J(13,"span",15),we(14,"\u6642\u9593:"),oe(),J(15,"input",17),Re("ngModelChange",function(r){return Le(e),$e().alarmTime=r})("change",function(){return Le(e),$e().changeAlarmTime()}),oe(),we(16,"\u79d2 "),oe()(),J(17,"div",11)(18,"button",18),Re("click",function(){return Le(e),$e().send()}),we(19,"\u9001\u4fe1"),oe(),it(20,"br"),J(21,"span",19),we(22),oe()(),J(23,"div",13)(24,"input",20),Re("ngModelChange",function(r){return Le(e),$e().isSound=r})("click",function(){return Le(e),$e().changeIsSound()}),oe(),J(25,"span"),we(26,"\u97f3"),oe(),J(27,"input",21),Re("ngModelChange",function(r){return Le(e),$e().isPopUp=r})("click",function(){return Le(e),$e().changeIsPopUp()}),oe(),J(28,"span"),we(29,"\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7"),oe()()()()()}if(2&n){const e=$e();j(4),na("id","includSelf_",e.initTimestamp,""),ie("ngModel",e.includSelf),j(7),ie("ngModel",e.alarmTitle),j(4),ie("ngModel",e.alarmTime),j(3),Yt("disabled",0==e.selectedNum()?"":null),j(4),sn("\u4eba\u6570:",e.selectedNum(),""),j(2),na("id","isSound_",e.initTimestamp,""),ie("ngModel",e.isSound),j(3),na("id","isPopUp_",e.initTimestamp,""),ie("ngModel",e.isPopUp)}}function vq(n,t){if(1&n&&(J(0,"div",33),At(1,"safe"),oe()),2&n){const e=$e().peer;un("background-image",Ft(1,2,"url("+$e().findPeerImage(e.peerId).url+")","style"))}}function bq(n,t){if(1&n&&(Je(0),we(1),et()),2&n){const e=$e().peer,i=$e();j(1),xt(i.findPeerLastControlName(e.peerId))}}function yq(n,t){1&n&&(Je(0),we(1,"\u64cd\u4f5c\u30ad\u30e3\u30e9\u306a\u3057"),et())}function Cq(n,t){if(1&n&&(J(0,"div",33),At(1,"safe"),oe()),2&n){const e=$e().peer;un("background-image",Ft(1,2,"url("+$e().findPeerLastControlImage(e.peerId).url+")","style"))}}function xq(n,t){1&n&&it(0,"div",34)}function wq(n,t){if(1&n){const e=pt();J(0,"div",22),Re("click",function(){const o=Le(e).peer;return $e().voteBlockClick(o.peerId)}),J(1,"div",23)(2,"div",24)(3,"div",25),we(4," \u9001\u4fe1\u5bfe\u8c61 "),oe(),J(5,"div",26)(6,"div")(7,"input",27),Re("change",function(){const o=Le(e).peer;return $e().onChange(o.peerId)}),oe()()()(),J(8,"div",24)(9,"div",28),we(10),oe(),J(11,"div",29),Ee(12,vq,2,5,"div",30),oe()(),J(13,"div",24)(14,"div",28),Ee(15,bq,2,1,"ng-container",2),Ee(16,yq,2,0,"ng-container",2),oe(),J(17,"div",29),Ee(18,Cq,2,5,"div",30),Ee(19,xq,1,0,"div",30),oe()(),J(20,"div",31)(21,"div",32),we(22," \u73fe\u5728\u63a5\u7d9a\u304c\u5207\u308c\u3066\u3044\u308b\u3068\u8003\u3048\u3089\u308c\u308b\u76f8\u624b\u3067\u3059 "),oe()()()()}if(2&n){const e=t.peer,i=$e();j(7),tp("id","",e.peerId,"_",i.initTimestamp,""),j(3),sn(" ",i.findPeerName(e.peerId)," "),j(2),ie("ngIf",i.findPeerImage(e.peerId)),j(3),ie("ngIf",i.findPeerLastControlName(e.peerId)),j(1),ie("ngIf",!i.findPeerLastControlName(e.peerId)),j(2),ie("ngIf",i.findPeerLastControlImage(e.peerId)),j(1),ie("ngIf",!i.findPeerLastControlImage(e.peerId)),j(2),ie("hidden",!i.isPeerIsDisConnect(e.peerId))}}let Eq=(()=>{class n{constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=o,this.initTimestamp=0,this.networkService=bt,this.voteContentsText="",this.alarmTitle="\u30bf\u30a4\u30de",this.alarmTime=60,this.isRollCall=!0,this.includSelf=!0,this.isSound=!0,this.isPopUp=!0,this.initTimestamp=Date.now()}get peerList(){return this.networkService.peerContexts}get myPeer(){return _t.myCursor}get alarm(){return Xe.instance.get("Alarm")}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30a2\u30e9\u30fc\u30e0\u30bf\u30a4\u30de"),this.setDefaultCheck()}ngAfterViewInit(){setTimeout(()=>{this.setDefaultCheck()},0)}isPeerIsDisConnect(e){return!_t.findByPeerId(e)||_t.findByPeerId(e).isDisConnect}setDefaultCheck(){const e=this.peerList;for(let i of e){let r=document.getElementById(i.peerId+"_"+this.initTimestamp);r&&(r.checked=!this.isPeerIsDisConnect(i.peerId))}}selectedNum(){return this.selectedList().length}selectedList(){const i=this.peerList;let r=[];for(let o of i){let s=document.getElementById(o.peerId+"_"+this.initTimestamp);s&&s.checked&&r.push(o.peerId)}return this.includSelf&&r.push(this.myPeer.peerId),r}send(){this.changeAlarmTime();let r,o,e=this.alarm,i=this.alarmTitle,s=this.selectedList();if(r="\u30a2\u30e9\u30fc\u30e0\u30bb\u30c3\u30c8 "+this.alarmTime+"\u79d2",this.peerList.length+1==this.selectedNum())o=" >\u5168\u54e1 ";else{o=" >";for(let a of s)o+=this.findPeerName(a)+" "}r+=o,e.makeAlarm(this.alarmTime,i,s,this.myPeer.peerId,o,this.isSound,this.isPopUp),this.chatMessageService.sendSystemMessageLastSendCharactor(r),e.startAlarm(),this.panelService.close()}changeAlarmTime(){this.alarmTime<=0&&(this.alarmTime=0),this.alarmTime>=3600&&(this.alarmTime=3600)}changeIncludSelf(){}changeIsSound(){}changeIsPopUp(){}onChangeType(e){let i=document.getElementById("rollcall_"+this.initTimestamp);this.isRollCall=i.checked}voteBlockClick(e){let i=document.getElementById(e+"_"+this.initTimestamp);i.checked=!i.checked}onChange(e){this.voteBlockClick(e)}findUserId(e){const i=_t.findByPeerId(e);return i?i.userId:""}findPeerName(e){const i=_t.findByPeerId(e);return i?i.name:""}findPeerLastControlName(e){const i=_t.findByPeerId(e);return i?i.lastControlCharacterName:""}findPeerImage(e){const i=_t.findByPeerId(e);return i?i.image:null}findPeerLastControlImage(e){const i=_t.findByPeerId(e);return i?i.lastControlImage:null}ngOnDestroy(){Qe.unregister(this)}}return n.\u0275fac=function(e){return new(e||n)(Be(pi),Be($n),Be(go),Be(ko))},n.\u0275cmp=Qt({type:n,selectors:[["app-alarm-menu"]],decls:8,vars:3,consts:[[1,"component"],[4,"ngTemplateOutlet"],[4,"ngIf"],["style","font-size: 15px;",3,"ngClass",4,"ngFor","ngForOf"],["alarmTop",""],["alarmTargets",""],[2,"font-size","15px",3,"ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"is-sticky-top"],[1,"tab"],[2,"display","table"],[2,"display","table-cell"],["type","checkbox","value","includSelf","name","includSelf",3,"ngModel","id","ngModelChange","click"],[2,"display","table-cell","align","left"],[2,"text-align","left"],[2,"display","inline-block","width","5em","margin-left","0.5em"],["placeholder","\u30a2\u30e9\u30fc\u30e0","name","alarmTitle",1,"is-caret",2,"width","15em",3,"ngModel","ngModelChange"],["type","number","placeholder","","name","alarmTime",1,"is-caret",2,"width","5em",3,"ngModel","ngModelChange","change"],[3,"click"],[2,"display","inline-block","margin-left","0.5em"],["type","checkbox","value","isSound","name","isSound",3,"ngModel","id","ngModelChange","click"],["type","checkbox","value","isPopUp","name","isPopUp",3,"ngModel","id","ngModelChange","click"],[1,"inventory-object",3,"click"],[1,"object-tags-box"],[1,"table-cell"],[1,"object-name",2,"width","6em"],[1,"message",2,"height","64px"],["type","checkbox","name","vote_chk",3,"id","change"],[1,"object-name"],[1,"image-box"],["class","image cover",3,"background-image",4,"ngIf"],[1,"table-cell","message"],[3,"hidden"],[1,"image","cover"],[1,"image","cover",3,"background-image"]],template:function(e,i){if(1&e&&(J(0,"div",0),Ee(1,fq,1,0,"ng-container",1),Ee(2,hq,2,0,"div",2),Ee(3,mq,2,6,"div",3),oe(),Ee(4,$q,30,10,"ng-template",null,4,Ln),Ee(6,wq,23,9,"ng-template",null,5,Ln)),2&e){const r=ln(5);j(1),ie("ngTemplateOutlet",r),j(1),ie("ngIf",i.peerList.length<1),j(1),ie("ngForOf",i.peerList)}},directives:[Ra,Sn,si,ir,_s,gs,xo,ra,Ti,yi,Fi,ms],pipes:[Ii],styles:[".component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border:transparent 2px solid;border-left:transparent 6px solid;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border:1px dotted #666}.message[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;vertical-align:middle}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #444}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.tab[_ngcontent-%COMP%]{padding:0;border:solid 1px #555;border-radius:.3em;overflow:hidden;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;background-color:#f0dabde6}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin-left:10px;margin-top:-3px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.is-sticky-top[_ngcontent-%COMP%]{position:sticky;top:0}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table-cell[_ngcontent-%COMP%]{display:table-cell}.image-box[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;max-width:64px;max-height:64px;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:table-cell;vertical-align:top}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.image-cover[_ngcontent-%COMP%]{width:100%;height:100%}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em;width:120px;overflow:hidden;white-space:nowrap}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})(),Rp=(()=>{class n{constructor(e){this.ngZone=e,this.batchTask=new Map,this.batchTaskTimer=null,this.needsChangeDetection=!1}add(e,i={}){this.batchTask.set(i,e),this.startTimer()}remove(e={}){this.batchTask.delete(e)}requireChangeDetection(){this.needsChangeDetection=!0,this.startTimer()}startTimer(){null==this.batchTaskTimer&&this.ngZone.runOutsideAngular(()=>{Yo(()=>this.execBatch()),this.batchTaskTimer=setInterval(()=>{0<this.batchTask.size?this.execBatch():(clearInterval(this.batchTaskTimer),this.batchTaskTimer=null)},66)})}execBatch(){this.batchTask.forEach(e=>e()),this.batchTask.clear(),this.needsChangeDetection&&(this.needsChangeDetection=!1,this.ngZone.run(()=>{}))}}return n.\u0275fac=function(e){return new(e||n)(In(An))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Tq=["textArea"],Sq=function(){return{standalone:!0}};let Dq=(()=>{class n{constructor(e,i,r,o,s){this.ngZone=e,this.chatMessageService=i,this.batchService=r,this.panelService=o,this.pointerDeviceService=s,this._autoCompleteListLen=-1,this._text="",this.chat=new Xt,this.initTimestamp=0,this.previousWritingLength=0,this.calcFitHeightInterval=null,this.history=new Array,this.currentHistoryIndex=-1,this.initTimestamp=Date.now()}get text(){return this._text}set text(e){this._text=e}get diceBotInfos(){return sr.diceBotInfos}get myPeer(){return _t.myCursor}get otherPeers(){return Xe.instance.getObjects(_t)}ngOnInit(){this.kickCalcFitHeight()}ngOnDestroy(){}onInput(){this.previousWritingLength=this.text.length,this.calcFitHeight()}kickCalcFitHeight(){null==this.calcFitHeightInterval&&(this.calcFitHeightInterval=setTimeout(()=>{this.calcFitHeightInterval=null,this.calcFitHeight(),document.getElementById("messageFix_"+this.initTimestamp).focus()},0))}calcFitHeight(){let e=this.textAreaElementRef.nativeElement;console.log("calcFitHeight"),e.style.height="",e.scrollHeight>=e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}fix(e){e&&e.preventDefault(),(!e||13===e.keyCode)&&(this.chatMessage.text!=this.text&&(this.chatMessage.text=this.text,this.chatMessage.fixd=!0),this.panelService.close())}cancel(){this.panelService.close()}}return n.MAX_HISTORY_NUM=1e3,n.\u0275fac=function(e){return new(e||n)(Be(An),Be(go),Be(Rp),Be($n),Be(Di))},n.\u0275cmp=Qt({type:n,selectors:[["chat-message-fix"]],viewQuery:function(e,i){if(1&e&&Gn(Tq,7),2&e){let r;yn(r=Cn())&&(i.textAreaElementRef=r.first)}},inputs:{_autoCompleteListLen:["autoCompleteListLen","_autoCompleteListLen"],_text:["text","_text"]},outputs:{chat:"chat"},decls:7,vars:4,consts:[[1,"table"],[1,"chat-input","is-caret",3,"id","ngModel","ngModelOptions","ngModelChange","input","keydown.enter"],["textArea",""],["type","submit",3,"click"]],template:function(e,i){1&e&&(J(0,"div",0)(1,"textarea",1,2),Re("ngModelChange",function(o){return i.text=o})("input",function(){return i.onInput()})("keydown.enter",function(o){return i.fix(o)}),oe(),J(3,"button",3),Re("click",function(){return i.fix(null)}),we(4,"\u5909\u66f4"),oe(),J(5,"button",3),Re("click",function(){return i.cancel()}),we(6,"\u30ad\u30e3\u30f3\u30bb\u30eb"),oe()()),2&e&&(j(1),na("id","messageFix_",i.initTimestamp,""),ie("ngModel",i.text)("ngModelOptions",$r(3,Sq)))},directives:[Fi,Ti,yi],styles:[".small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table-cell[_ngcontent-%COMP%]{display:table-cell}.chat-input[_ngcontent-%COMP%]{font-family:inherit;font-size:13px;width:calc(100% - 180px);height:calc(1em + 4px);min-height:calc(1em + 7px);max-height:calc(6em + 7px);resize:none;overflow:auto;padding:1px;margin:5px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;vertical-align:bottom}.writing-info[_ngcontent-%COMP%]{font-size:8px;height:1.3em}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();function Iq(n,t){if(1&n&&(it(0,"img",14),At(1,"safe")),2&n){const e=$e(2);ie("src",Ft(1,1,null==e.imageFile?null:e.imageFile.url,"resourceUrl"),hn)}}function kq(n,t){1&n&&pn(0)}function Mq(n,t){1&n&&(Je(0),we(1,"\xa0(\u7de8\u96c6\u6e08)"),et())}function Aq(n,t){if(1&n){const e=pt();Je(0),J(1,"div",15),Re("click",function(){return Le(e),$e(2).clickFix()}),we(2,"\xa0[\u7de8\u96c6]"),oe(),et()}}const IP=function(n,t,e){return{"direct-message":n,"system-message":t,"dicebot-message":e}},kP=function(n){return{color:n}};function Pq(n,t){if(1&n&&(Je(0),J(1,"div",4)(2,"div",5),Ee(3,Iq,2,4,"img",6),oe(),J(4,"div",7)(5,"div",8)(6,"span",9),we(7),oe(),J(8,"span",10),we(9),oe(),J(10,"span",11),we(11),At(12,"date"),oe()(),J(13,"div",12),Ee(14,kq,1,0,"ng-container",13),Ee(15,Mq,2,0,"ng-container",1),Ee(16,Aq,3,0,"ng-container",1),oe()()(),et()),2&n){const e=$e(),i=ln(5),r=ln(7);j(1),ie("ngClass",Wo(14,IP,(e.chatMessage.isDirect||e.chatMessage.isSecret)&&!e.chatMessage.isSystemToPL,e.chatMessage.isSystem,e.chatMessage.isDicebot)),j(2),ie("ngIf",0<(null==e.imageFile||null==e.imageFile.url?null:e.imageFile.url.length)),j(1),ie("ngStyle",Nt(18,kP,e.chatMessage.messColor)),j(3),xt(e.chatMessage.name),j(2),xt(e.chatMessage.from),j(2),xt(Ft(12,11,e.chatMessage.timestamp,"y/M/d H:mm")),j(3),ie("ngIf",!e.chatMessage.isSecret||e.chatMessage.isSendFromSelf)("ngIfThen",i)("ngIfElse",r),j(1),ie("ngIf",e.chatMessage.fixd),j(1),ie("ngIf",e.chatMessage.changeable)}}function Fq(n,t){if(1&n&&(J(0,"font",10),we(1),oe()),2&n){const e=$e(2);j(1),xt(e.chatMessage.from)}}function Rq(n,t){if(1&n&&(J(0,"font",11),we(1),At(2,"date"),oe()),2&n){const e=$e(2);j(1),xt(Ft(2,1,e.chatMessage.timestamp,"H:mm"))}}function Nq(n,t){1&n&&pn(0)}function Oq(n,t){1&n&&(Je(0),we(1,"\xa0(\u7de8\u96c6\u6e08)"),et())}function Bq(n,t){if(1&n){const e=pt();Je(0),J(1,"div",15),Re("click",function(){return Le(e),$e(2).clickFix()}),we(2,"\xa0[\u7de8\u96c6]"),oe(),et()}}function Lq(n,t){if(1&n&&(Je(0),J(1,"div",16)(2,"div",7)(3,"span",8)(4,"font",9),we(5),oe(),we(6,"\uff1a "),Ee(7,Fq,2,1,"font",17),Ee(8,Rq,3,4,"font",18),J(9,"font",12),Ee(10,Nq,1,0,"ng-container",13),Ee(11,Oq,2,0,"ng-container",1),Ee(12,Bq,3,0,"ng-container",1),oe()()()(),et()),2&n){const e=$e(),i=ln(5),r=ln(7);j(1),ie("ngClass",Wo(10,IP,(e.chatMessage.isDirect||e.chatMessage.isSecret)&&!e.chatMessage.isSystemToPL,e.chatMessage.isSystem,e.chatMessage.isDicebot)),j(1),ie("ngStyle",Nt(14,kP,e.chatMessage.messColor)),j(3),xt(e.chatMessage.name),j(2),ie("ngIf",e.simpleDispFlagUserId),j(1),ie("ngIf",e.simpleDispFlagTime),j(2),ie("ngIf",!e.chatMessage.isSecret||e.chatMessage.isSendFromSelf)("ngIfThen",i)("ngIfElse",r),j(1),ie("ngIf",e.chatMessage.fixd),j(1),ie("ngIf",e.chatMessage.changeable)}}function zq(n,t){if(1&n){const e=pt();J(0,"button",21),Re("click",function(){return Le(e),$e(2).discloseMessage()}),we(1,"\u5185\u5bb9\u3092\u516c\u958b"),oe()}}const Hq=function(){return{stripPrefix:!1}};function Vq(n,t){if(1&n&&(it(0,"span",19),At(1,"safe"),At(2,"linky"),Ee(3,zq,2,0,"button",20)),2&n){const e=$e();ie("innerHTML",function z3(n,t,e){const i=n+20,r=Tt(),o=$a(r,i);return em(r,i)?R3(r,vo(),t,o.transform,e,o):o.transform(e)}(1,2,Ft(2,4,e.escapeHtmlAndRuby(e.chatMessage.text),$r(7,Hq))),Lc),j(3),ie("ngIf",e.chatMessage.isSecret)}}function Uq(n,t){1&n&&(J(0,"span"),we(1,"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09"),oe())}let jq=(()=>{class n{constructor(e,i,r){this.chatMessageService=e,this.pointerDeviceService=i,this.panelService=r,this.simpleDispFlagTime=!1,this.simpleDispFlagUserId=!1,this.chatSimpleDispFlag=!1,this.imageFile=Bt.Empty,this.animeState="inactive"}get chatTabList(){return Xe.instance.get("ChatTabList")}ngOnInit(){let e=this.chatMessage.image;e&&(this.imageFile=e),this.chatMessageService.getTime()-1e4<this.chatMessage.timestamp&&(this.animeState="active")}ngAfterViewInit(){}discloseMessage(){this.chatMessage.tag=this.chatMessage.tag.replace("secret","")}clickFix(){console.log("clickFix");let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(Dq,{width:700,height:120,left:e.x,top:e.y,title:"\u30c1\u30e3\u30c3\u30c8\u7de8\u96c6"});r.chatMessage=this.chatMessage,r.text=this.chatMessage.text}escapeHtmlAndRuby(e){return this.escapeHtml(e).replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g,'<ruby style="white-space:normal;">$1<rt>$2</rt></ruby>').replace(/\\s/g," ")}escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}}return n.\u0275fac=function(e){return new(e||n)(Be(go),Be(Di),Be($n))},n.\u0275cmp=Qt({type:n,selectors:[["chat-message"]],inputs:{chatMessage:"chatMessage",simpleDispFlagTime:"simpleDispFlagTime",simpleDispFlagUserId:"simpleDispFlagUserId",chatSimpleDispFlag:"chatSimpleDispFlag"},decls:8,vars:3,consts:[[1,"container"],[4,"ngIf"],["visible",""],["secret",""],[1,"message",3,"ngClass"],[1,"image"],[3,"src",4,"ngIf"],[1,"body",3,"ngStyle"],[1,"title"],[1,"msg-name"],[1,"tip","msg-from"],[1,"tip","msg-timestamp"],[1,"text","msg-text"],[4,"ngIf","ngIfThen","ngIfElse"],[3,"src"],[1,"fix",3,"click"],[1,"message-small",3,"ngClass"],["class","tip msg-from",4,"ngIf"],["class","tip msg-timestamp",4,"ngIf"],[3,"innerHTML"],[3,"click",4,"ngIf"],[3,"click"]],template:function(e,i){1&e&&(J(0,"div",0)(1,"div"),Ee(2,Pq,17,20,"ng-container",1),Ee(3,Lq,13,16,"ng-container",1),oe()(),Ee(4,Vq,4,8,"ng-template",null,2,Ln),Ee(6,Uq,2,0,"ng-template",null,3,Ln)),2&e&&(j(1),ie("@flyInOut",i.animeState),j(1),ie("ngIf",!i.chatSimpleDispFlag),j(1),ie("ngIf",i.chatSimpleDispFlag))},directives:[Sn,ir,Co],pipes:[Ii,D2,Rx],styles:["[_nghost-%COMP%]{display:block}.container[_ngcontent-%COMP%]{width:100%;overflow-x:hidden}.message[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;box-sizing:border-box;padding:5px;width:100%;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;border-bottom:1px dotted #999}.message-small[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;box-sizing:border-box;padding:2px;width:100%;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;border-bottom:1px dotted #999}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{padding:0;width:50px;height:50px;flex-shrink:0;vertical-align:top}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.message[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%], .message-small[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{flex-grow:1}.message[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .message-small[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{vertical-align:top;font-size:14px;padding-left:12px}.message[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .message-small[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{vertical-align:top;padding:2px 12px 0;font-size:14px}.message[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%], .message-small[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{font-size:8px;padding-left:12px}.msg-name[_ngcontent-%COMP%]{font-weight:700}.msg-text[_ngcontent-%COMP%]{white-space:pre-wrap}.dicebot-message[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%]{font-size:8px}.fix[_ngcontent-%COMP%]{display:none;opacity:0}.container[_ngcontent-%COMP%]:hover   .fix[_ngcontent-%COMP%]{display:inline-block;opacity:1}"],data:{animation:[Na("flyInOut",[Lr("* => active",[Br("200ms ease-out",Ls([mn({transform:"translateX(100px)",opacity:"0",offset:0}),mn({transform:"translateX(0)",opacity:"1",offset:1})]))]),Lr("void => *",[Br("200ms ease-out",Ls([mn({opacity:"0",offset:0}),mn({opacity:"1",offset:1})]))])])]}}),n})();const Gq=["logContainer"],qq=["messageContainer"];function Wq(n,t){if(1&n&&it(0,"chat-message",7),2&n){const e=$e().$implicit,i=$e(2);ie("chatMessage",e)("simpleDispFlagTime",i.chatTabList.simpleDispFlagTime)("simpleDispFlagUserId",i.chatTabList.simpleDispFlagUserId)("chatSimpleDispFlag",i.chatTab.chatSimpleDispFlag)}}function Zq(n,t){if(1&n&&(Je(0),Ee(1,Wq,1,4,"chat-message",6),et()),2&n){const e=t.$implicit;j(1),ie("ngIf",e.isDisplayable)}}function Yq(n,t){if(1&n&&(Je(0),Ee(1,Zq,2,1,"ng-container",5),et()),2&n){const e=$e();j(1),ie("ngForOf",e.chatMessages)("ngForTrackBy",e.trackByChatMessage)}}function Kq(n,t){1&n&&it(0,"chat-message",7),2&n&&ie("chatMessage",t.$implicit)("simpleDispFlagTime",!1)("simpleDispFlagUserId",!1)("chatSimpleDispFlag",!1)}function Xq(n,t){if(1&n&&(Je(0),Ee(1,Kq,1,4,"chat-message",8),et()),2&n){const e=$e();j(1),ie("ngForOf",e.sampleMessages)}}const Vw=window.navigator.userAgent.toLowerCase(),MP=Vw.indexOf("iphone")>-1||Vw.indexOf("ipad")>-1||Vw.indexOf("macintosh")>-1&&"ontouchend"in document;let Qq=(()=>{class n{constructor(e,i,r){this.ngZone=e,this.changeDetector=i,this.panelService=r,this.sampleMessages=[{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u672c\u30bd\u30d5\u30c8\u306b\u4f7f\u7528\u3057\u3066\u3044\u308b 3rdpartylicenses \u306b\u3064\u3044\u3066\u306f\u3053\u3061\u3089\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044 "+location.href.replace("/index.html","").replace(/\/$/,"")+"/3rdpartylicenses.txt"},{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u672c\u30bd\u30d5\u30c8\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u958b\u767a\u306b\u5bc4\u4e0e\u3057\u3066\u304f\u3060\u3055\u3063\u305f\u65b9\u306b\u3064\u3044\u3066\u306f\u3053\u3061\u3089\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044 https://github.com/entyu/udonarium_lily"},{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u30b5\u30fc\u30d0\u30fc\u3092\u4f7f\u7528\u3057\u306a\u3044TRPG\u30aa\u30f3\u30bb\u30c4\u30fc\u30eb\u3067\u3059\u3002\u53c2\u52a0\u8005\u540c\u58eb\u3067\u63a5\u7d9a\u3057\u3001\u30b3\u30de\u3084\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u3092\u540c\u671f\u3057\u307e\u3059\u3002"},{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u5168\u3066\u306e\u30c7\u30fc\u30bf\u304c\u5404\u53c2\u52a0\u8005\u306e\u30d6\u30e9\u30a6\u30b6\u5185\u306b\u3042\u308b\u305f\u3081\u3001\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3092\u5b9f\u884c\u3057\u3066\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u3092\u751f\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4fdd\u5b58\u3057\u305fzip\u306e\u8aad\u307f\u8fbc\u307f\u306f\u30d6\u30e9\u30a6\u30b6\u753b\u9762\u3078\u306e\u30d5\u30a1\u30a4\u30eb\u30c9\u30ed\u30c3\u30d7\u3067\u884c\u3048\u307e\u3059\u3002"},{from:"System",to:"???",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb > \u30d7\u30ec\u30a4\u30e4\u30fc",text:"\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\uff08\u79d8\u5bc6\u4f1a\u8a71\uff09\u306f\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\u306b\u8a18\u9332\u3055\u308c\u307e\u305b\u3093\u3002"},{from:"System",to:"???",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb > \u30d7\u30ec\u30a4\u30e4\u30fc",text:"\u307e\u305f\u3001\u904e\u53bb\u306e\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u3042\u306a\u305f\u306eID\u304c\u66f4\u65b0\u3055\u308c\u308b\u3068\u540c\u3058\u30eb\u30fc\u30e0\u5185\u3067\u3042\u3063\u3066\u3082\u898b\u3048\u306a\u304f\u306a\u308a\u307e\u3059\u3002\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002"},{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u52d5\u4f5c\u63a8\u5968\u74b0\u5883\u306f\u30c7\u30b9\u30af\u30c8\u30c3\u30d7Chrome\u3067\u3059\u3002\u4eca\u306e\u3068\u3053\u308d\u3001\u30b9\u30de\u30db\u304b\u3089\u3060\u3068\u4e0a\u624b\u304f\u64cd\u4f5c\u3067\u304d\u307e\u305b\u3093\u3002"},{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u30ea\u30ea\u30a3\u8ffd\u52a0\u6a5f\u80fd\uff1a\u30c1\u30e3\u30c3\u30c8\u7c21\u6613\u8868\u793a\u6a5f\u80fd\u306f\u6700\u521d\u306e\u30c1\u30e3\u30c3\u30c8\u5165\u529b\u3092\u5165\u529b\u3059\u308b\u3068\u4f7f\u7528\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002"},{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u4ee5\u4e0a\u3067\u3059\u3002\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u6700\u521d\u306e\u30c1\u30e3\u30c3\u30c8\u3092\u5165\u529b\u3059\u308b\u3068\u975e\u8868\u793a\u306b\u306a\u308a\u307e\u3059\u3002"}],this.topTimestamp=0,this.botomTimestamp=0,this.needUpdate=!0,this.topElm=null,this.bottomElm=null,this.topElmBox=null,this.bottomElmBox=null,this.topIndex=0,this.bottomIndex=0,this._minMessageHeight=26,this._minMessageHeightNormal=61,this.preScrollTop=0,this.scrollSpeed=0,this._chatMessages=[],this.scrollEventShortTimer=null,this.scrollEventLongTimer=null,this.addMessageEventTimer=null,this.callbackOnScroll=()=>this.onScroll(),this.callbackOnScrollToBottom=()=>this.resetMessages(),this.addMessage=new Xt}get minMessageHeight(){return this.chatTab&&this.chatTab.chatSimpleDispFlag?this._minMessageHeight:this._minMessageHeightNormal}get chatMessages(){if(!this.chatTab)return[];if(this.needUpdate){this.needUpdate=!1;let e=this.chatTab?this.chatTab.chatMessages:[];this.adjustIndex(),this._chatMessages=e.slice(this.topIndex,this.bottomIndex+1),this.topTimestamp=0<this._chatMessages.length?this._chatMessages[0].timestamp:0,this.botomTimestamp=0<this._chatMessages.length?this._chatMessages[this._chatMessages.length-1].timestamp:0}return this._chatMessages}chatMessagesDisplayableTopIndex(e,i){let o=0,s=e.length-1;for(;s>=0;s--)if(e[s].isDisplayable&&o++,o>=i)return s;return s}get minScrollHeight(){let e=this.chatTab?this.chatTab.displayableMessagesLength():this.sampleMessages.length;return console.log("minScrollHeight"+e),(e<1e4?e:1e4)*this.minMessageHeight}get topSpace(){return this.minScrollHeight-this.bottomSpace}get bottomSpace(){return 0<this.chatMessages.length?(this.chatTab.chatMessages.length-this.bottomIndex-1)*this.minMessageHeight:0}get chatTabList(){return Xe.instance.get("ChatTabList")}ngOnInit(){let e=[];for(let i of this.sampleMessages){let r=new po;for(let o in i)if("identifier"!==o&&"tabIdentifier"!==o){if("text"===o){r.value=i[o];continue}null==i[o]||""===i[o]||r.setAttribute(o,i[o])}e.push(r)}this.sampleMessages=e,Qe.register(this).on("MESSAGE_ADDED",i=>{let r=Xe.instance.get(i.data.messageIdentifier);!r||!this.chatTab.contains(r)||this.topTimestamp<=r.timestamp&&(this.changeDetector.markForCheck(),this.needUpdate=!0,this.onMessageInit())}).on("UPDATE_GAME_OBJECT",i=>{let r=Xe.instance.get(i.data.identifier);r&&r instanceof po&&this.topTimestamp<=r.timestamp&&r.timestamp<=this.botomTimestamp&&this.chatTab.contains(r)&&this.changeDetector.markForCheck()}).on("RE_DRAW_CHAT",i=>{console.log("\u30c1\u30e3\u30c3\u30c8\u518d\u63cf\u753b"),setTimeout(()=>this.redraw(),0)})}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.scrollEventShortTimer=new uc(()=>this.lazyScrollUpdate(),33),this.scrollEventLongTimer=new uc(()=>this.lazyScrollUpdate(!1),66),this.onScroll(),this.panelService.scrollablePanel.addEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.addEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1)})}ngOnDestroy(){Qe.unregister(this),this.panelService.scrollablePanel.removeEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.removeEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1),this.scrollEventShortTimer.clear(),this.scrollEventLongTimer.clear(),this.addMessageEventTimer&&clearTimeout(this.addMessageEventTimer),this.addMessageEventTimer=null}ngOnChanges(){Promise.resolve().then(()=>this.resetMessages())}ngAfterViewChecked(){!this.topElm||!this.bottomElm||this.ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>this.adjustScrollPosition())})}onMessageInit(){null==this.addMessageEventTimer&&this.ngZone.runOutsideAngular(()=>{this.addMessageEventTimer=setTimeout(()=>{this.addMessageEventTimer=null,this.ngZone.run(()=>this.addMessage.emit())},0)})}resetMessages(){let e=this.chatTab.chatMessages.length-1;this.topIndex=this.chatMessagesDisplayableTopIndex(this.chatTab.chatMessages,Math.floor(this.panelService.scrollablePanel.clientHeight/this.minMessageHeight)+1),this.bottomIndex=e,this.needUpdate=!0,this.preScrollTop=-1,this.scrollSpeed=0,this.topElm=this.bottomElm=null,this.adjustIndex(),console.log("resetMessages top:"+this.topIndex+" bottom:"+this.bottomIndex),this.changeDetector.markForCheck()}trackByChatMessage(e,i){return i.identifier}adjustIndex(){let e=this.chatTab?this.chatTab.chatMessages:[],i=0<e.length?e.length-1:0;this.topIndex<0&&(this.topIndex=0),i<this.bottomIndex&&(this.bottomIndex=i),this.topIndex<0&&(this.topIndex=0),this.bottomIndex<0&&(this.bottomIndex=0),i<this.topIndex&&(this.topIndex=i),i<this.bottomIndex&&(this.bottomIndex=i)}getScrollPosition(){let e=this.panelService.scrollablePanel.scrollTop,i=this.panelService.scrollablePanel.clientHeight,r=this.panelService.scrollablePanel.scrollHeight;return e<0&&(e=0),r-i<e&&(e=r-i),{top:e,bottom:e+i,clientHeight:i,scrollHeight:r}}adjustScrollPosition(){if(!this.topElm||!this.bottomElm)return;let e=this.logContainerRef.nativeElement.contains(this.topElm),i=this.logContainerRef.nativeElement.contains(this.bottomElm),{hasTopBlank:r,hasBotomBlank:o}=this.checkBlank(e,i);this.topElm=this.bottomElm=null,(r||o||!e&&!i)&&Yo(()=>this.lazyScrollUpdate())}checkBlank(e,i){let r=!e,o=!i;if(!e&&!i)return{hasTopBlank:r,hasBotomBlank:o};let s=null,a=null,g=null,w=0;i?(s=this.bottomElm,a=this.bottomElmBox):e&&(s=this.topElm,a=this.topElmBox),g=s.getBoundingClientRect(),w=a.top-g.top-this.scrollSpeed,(!r||!o)&&.25<w**2&&(this.panelService.scrollablePanel.scrollTop-=w);let W=this.logContainerRef.nativeElement.getBoundingClientRect(),ve=this.messageContainerRef.nativeElement.getBoundingClientRect(),me=ve.top-W.top,Se=me+ve.height,Oe=this.getScrollPosition();return r=Oe.top<me,o=Se<Oe.bottom&&Oe.bottom<Oe.scrollHeight,{hasTopBlank:r,hasBotomBlank:o}}markForReadIfNeeded(){if(!this.chatTab.hasUnread)return;let e=this.getScrollPosition();e.scrollHeight<=e.bottom+100&&Yo(()=>{this.chatTab.markForRead(),this.changeDetector.markForCheck(),this.ngZone.run(()=>{})})}onScroll(){this.scrollEventShortTimer.reset(),this.scrollEventLongTimer.isActive||this.scrollEventLongTimer.reset()}lazyScrollUpdate(e=!0){this.scrollEventShortTimer.stop(),this.scrollEventLongTimer.stop();let i=this.messageContainerRef.nativeElement.querySelectorAll("chat-message"),r=this.messageContainerRef.nativeElement.offsetTop,o=r+this.messageContainerRef.nativeElement.clientHeight,s=this.topIndex,a=this.bottomIndex,g=this.getScrollPosition();this.scrollSpeed=g.top-this.preScrollTop,this.preScrollTop=g.top;let w=g.top<r,W=o<g.bottom&&g.bottom<g.scrollHeight;if(e||this.scrollEventShortTimer.reset(),!e&&!w&&!W)return;let ve=g.top-(!e&&w?100:1200),me=g.bottom+(!e&&W?100:1200);this.markForReadIfNeeded(),this.calcItemIndexRange(r,o,ve,me,g,i),(this.topIndex!=s||this.bottomIndex!=a)&&(this.needUpdate=!0,this.topElm=i[0],this.bottomElm=i[i.length-1],this.topElmBox=this.topElm.getBoundingClientRect(),this.bottomElmBox=this.bottomElm.getBoundingClientRect(),Yo(()=>{let Oe=this.getScrollPosition();this.scrollSpeed=Oe.top-this.preScrollTop,this.preScrollTop=Oe.top,this.changeDetector.markForCheck(),this.ngZone.run(()=>{})}))}redraw(){this.changeDetector.detectChanges()}calcElementMaxHeight(e){let i=this.minMessageHeight;for(let r=e.length-1;0<=r;r--){let o=e[r].clientHeight;i<o&&(i=o)}return i}calcItemIndexRange(e,i,r,o,s,a){if(r>=i||e>=o)this.bottomIndex=this.chatTab.chatMessages.length-1-Math.floor((s.scrollHeight-s.top-s.clientHeight)/this.minMessageHeight),this.topIndex=this.bottomIndex-Math.floor(s.clientHeight/this.minMessageHeight),this.bottomIndex+=1,this.topIndex-=1;else{let g=this.calcElementMaxHeight(a);r<e?this.topIndex-=Math.floor((e-r)/g)+1:r>e&&(MP||(this.topIndex+=Math.floor((r-e)/g))),i>o?MP||(this.bottomIndex-=Math.floor((i-o)/g)):i<o&&(this.bottomIndex+=Math.floor((o-i)/g)+1)}this.adjustIndex()}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(bi),Be($n))},n.\u0275cmp=Qt({type:n,selectors:[["chat-tab"]],viewQuery:function(e,i){if(1&e&&(Gn(Gq,7),Gn(qq,7)),2&e){let r;yn(r=Cn())&&(i.logContainerRef=r.first),yn(r=Cn())&&(i.messageContainerRef=r.first)}},inputs:{chatTab:"chatTab"},outputs:{addMessage:"addMessage"},features:[br],decls:6,vars:6,consts:[[1,"log"],["logContainer",""],[1,"virtual-scroll-container"],["messageContainer",""],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"chatMessage","simpleDispFlagTime","simpleDispFlagUserId","chatSimpleDispFlag",4,"ngIf"],[3,"chatMessage","simpleDispFlagTime","simpleDispFlagUserId","chatSimpleDispFlag"],[3,"chatMessage","simpleDispFlagTime","simpleDispFlagUserId","chatSimpleDispFlag",4,"ngFor","ngForOf"]],template:function(e,i){1&e&&(J(0,"div",0,1)(2,"div",2,3),Ee(4,Yq,2,2,"ng-container",4),Ee(5,Xq,2,1,"ng-container",4),oe()()),2&e&&(un("min-height",i.minScrollHeight,"px"),j(2),un("margin-bottom",i.bottomSpace,"px"),j(2),ie("ngIf",0<i.chatMessages.length),j(1),ie("ngIf",i.chatMessages.length<=0))},directives:[Sn,si,jq],styles:["[_nghost-%COMP%]{display:block}.log[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:flex-end;align-items:flex-end;width:100%;height:100%}.virtual-scroll-container[_ngcontent-%COMP%]{flex-shrink:0;width:100%}"],changeDetection:0}),n})(),Jq=(()=>{class n{constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this.isAllowedEmpty=!1,this.tabletopObject=null}get myPeer(){return _t.myCursor}get chatTabList(){return Xe.instance.get("ChatTabList")}changeDispFlagTime(){Qe.trigger("RE_DRAW_CHAT",{})}changeDispFlagUserId(){Qe.trigger("RE_DRAW_CHAT",{})}changeTachieInWindow(){}changeKeepTachieOutWindow(){}ngOnInit(){}ngAfterViewInit(){}ngOnDestroy(){}}return n.\u0275fac=function(e){return new(e||n)(Be(bi),Be($n),Be(pi))},n.\u0275cmp=Qt({type:n,selectors:[["chat-message-setting"]],inputs:{isAllowedEmpty:"isAllowedEmpty",tabletopObject:"tabletopObject"},decls:23,vars:5,consts:[["id","file-list"],[1,"table"],[1,"table-cell",2,"width","16em"],[1,"table-cell"],["type","checkbox","value","isTachieInWindow","name","tachieInWindow",3,"ngModel","ngModelChange","click"],["type","checkbox","value","isKeepTachieOutWindow","name","isKeepTachieOutWindow",3,"ngModel","ngModelChange","click"],["type","checkbox","value","simpleDispFlagTime","name","hideInventory",3,"ngModel","ngModelChange","click"],["type","checkbox","value","simpleDispFlagUserId","name","hideInventory",3,"ngModel","ngModelChange","click"]],template:function(e,i){1&e&&(J(0,"div",0)(1,"div",1)(2,"div",2),we(3," \u7acb\u3061\u7d75\u3092\u30a6\u30a3\u30f3\u30c9\u30a6\u5185\u306b\u8868\u793a: "),oe(),J(4,"div",3)(5,"input",4),Re("ngModelChange",function(o){return i.chatTabList.isTachieInWindow=o})("click",function(){return i.changeTachieInWindow()}),oe()()(),J(6,"div",1)(7,"div",2),we(8," \u30de\u30a6\u30b9\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u96e2\u8131\u6642"),it(9,"br"),we(10," \u30a6\u30a3\u30f3\u30c9\u30a6\u5916\u306e\u7acb\u3061\u7d75\u3092\u4fdd\u6301: "),oe(),J(11,"div",3)(12,"input",5),Re("ngModelChange",function(o){return i.chatTabList.isKeepTachieOutWindow=o})("click",function(){return i.changeKeepTachieOutWindow()}),oe()()(),J(13,"div",1)(14,"div",2),we(15," \u7c21\u6613\u8868\u793a\u3067\u6642\u9593\u3092\u8868\u793a: "),oe(),J(16,"div",3)(17,"input",6),Re("ngModelChange",function(o){return i.chatTabList.simpleDispFlagTime=o})("click",function(){return i.changeDispFlagTime()}),oe()()(),J(18,"div",1)(19,"div",2),we(20," \u7c21\u6613\u8868\u793a\u3067ID\u3092\u8868\u793a: "),oe(),J(21,"div",3)(22,"input",7),Re("ngModelChange",function(o){return i.chatTabList.simpleDispFlagUserId=o})("click",function(){return i.changeDispFlagUserId()}),oe()()()()),2&e&&(j(5),ie("ngModel",i.chatTabList.isTachieInWindow),j(7),ie("ngModel",i.chatTabList.isKeepTachieOutWindow),Yt("disabled",i.chatTabList.isTachieInWindow?"":null),j(5),ie("ngModel",i.chatTabList.simpleDispFlagTime),j(5),ie("ngModel",i.chatTabList.simpleDispFlagUserId))},directives:[ra,Ti,yi],styles:[".table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table[_ngcontent-%COMP%]   .table-cell[_ngcontent-%COMP%]{display:table-cell}input[_ngcontent-%COMP%]{width:5em}"],changeDetection:0}),n})();const eW=["tachieArea"],qa=function(n,t,e,i){return{transform:n,"z-index":t,opacity:e,height:i}};function tW(n,t){if(1&n){const e=pt();J(0,"img",16,17),Re("mousedown",function(){return Le(e),$e(4).tachieClick(0)}),At(2,"safe"),oe()}if(2&n){const e=$e(4);ie("src",Ft(2,2,e.imageFileUrl_00,"resourceUrl"),hn)("ngStyle",Rr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 0  ) ) translateY( "+e.tachieY_Pos+"px)",e.zIndex_00,e.opacity_00,e.tachieAreaHeight00+"px"))}}function nW(n,t){if(1&n){const e=pt();J(0,"img",18,19),Re("mousedown",function(){return Le(e),$e(4).tachieClick(1)}),At(2,"safe"),oe()}if(2&n){const e=$e(4);ie("src",Ft(2,2,e.imageFileUrl_01,"resourceUrl"),hn)("ngStyle",Rr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 1  ) ) translateY("+e.tachieY_Pos+"px)",e.zIndex_01,e.opacity_01,e.tachieAreaHeight01+"px"))}}function iW(n,t){if(1&n){const e=pt();J(0,"img",20,21),Re("mousedown",function(){return Le(e),$e(4).tachieClick(2)}),At(2,"safe"),oe()}if(2&n){const e=$e(4);ie("src",Ft(2,2,e.imageFileUrl_02,"resourceUrl"),hn)("ngStyle",Rr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 2  ) ) translateY("+e.tachieY_Pos+"px)",e.zIndex_02,e.opacity_02,e.tachieAreaHeight02+"px"))}}function rW(n,t){if(1&n){const e=pt();J(0,"img",22,23),Re("mousedown",function(){return Le(e),$e(4).tachieClick(3)}),At(2,"safe"),oe()}if(2&n){const e=$e(4);ie("src",Ft(2,2,e.imageFileUrl_03,"resourceUrl"),hn)("ngStyle",Rr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 3  ) ) translateY("+e.tachieY_Pos+"px)",e.zIndex_03,e.opacity_03,e.tachieAreaHeight03+"px"))}}function oW(n,t){if(1&n){const e=pt();J(0,"img",24,25),Re("mousedown",function(){return Le(e),$e(4).tachieClick(4)}),At(2,"safe"),oe()}if(2&n){const e=$e(4);ie("src",Ft(2,2,e.imageFileUrl_04,"resourceUrl"),hn)("ngStyle",Rr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 4  ) ) translateY("+e.tachieY_Pos+"px)",e.zIndex_04,e.opacity_04,e.tachieAreaHeight04+"px"))}}function sW(n,t){if(1&n){const e=pt();J(0,"img",26,27),Re("mousedown",function(){return Le(e),$e(4).tachieClick(5)}),At(2,"safe"),oe()}if(2&n){const e=$e(4);ie("src",Ft(2,2,e.imageFileUrl_05,"resourceUrl"),hn)("ngStyle",Rr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 5  ) ) translateY("+e.tachieY_Pos+"px)",e.zIndex_05,e.opacity_05,e.tachieAreaHeight05+"px"))}}function aW(n,t){if(1&n){const e=pt();J(0,"img",28,29),Re("mousedown",function(){return Le(e),$e(4).tachieClick(6)}),At(2,"safe"),oe()}if(2&n){const e=$e(4);ie("src",Ft(2,2,e.imageFileUrl_06,"resourceUrl"),hn)("ngStyle",Rr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 6  ) ) translateY("+e.tachieY_Pos+"px)",e.zIndex_06,e.opacity_06,e.tachieAreaHeight06+"px"))}}function lW(n,t){if(1&n){const e=pt();J(0,"img",30,31),Re("mousedown",function(){return Le(e),$e(4).tachieClick(7)}),At(2,"safe"),oe()}if(2&n){const e=$e(4);ie("src",Ft(2,2,e.imageFileUrl_07,"resourceUrl"),hn)("ngStyle",Rr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 7  ) ) translateY("+e.tachieY_Pos+"px)",e.zIndex_07,e.opacity_07,e.tachieAreaHeight07+"px"))}}function cW(n,t){if(1&n){const e=pt();J(0,"img",32,33),Re("mousedown",function(){return Le(e),$e(4).tachieClick(8)}),At(2,"safe"),oe()}if(2&n){const e=$e(4);ie("src",Ft(2,2,e.imageFileUrl_08,"resourceUrl"),hn)("ngStyle",Rr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 8  ) ) translateY("+e.tachieY_Pos+"px)",e.zIndex_08,e.opacity_08,e.tachieAreaHeight08+"px"))}}function uW(n,t){if(1&n){const e=pt();J(0,"img",34,35),Re("mousedown",function(){return Le(e),$e(4).tachieClick(9)}),At(2,"safe"),oe()}if(2&n){const e=$e(4);ie("src",Ft(2,2,e.imageFileUrl_09,"resourceUrl"),hn)("ngStyle",Rr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 9  ) ) translateY("+e.tachieY_Pos+"px)",e.zIndex_09,e.opacity_09,e.tachieAreaHeight09+"px"))}}function dW(n,t){if(1&n){const e=pt();J(0,"img",36,37),Re("mousedown",function(){return Le(e),$e(4).tachieClick(10)}),At(2,"safe"),oe()}if(2&n){const e=$e(4);ie("src",Ft(2,2,e.imageFileUrl_10,"resourceUrl"),hn)("ngStyle",Rr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 10  ) ) translateY("+e.tachieY_Pos+"px)",e.zIndex_10,e.opacity_10,e.tachieAreaHeight10+"px"))}}function fW(n,t){if(1&n){const e=pt();J(0,"img",38,39),Re("mousedown",function(){return Le(e),$e(4).tachieClick(11)}),At(2,"safe"),oe()}if(2&n){const e=$e(4);ie("src",Ft(2,2,e.imageFileUrl_11,"resourceUrl"),hn)("ngStyle",Rr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 11  ) ) translateY("+e.tachieY_Pos+"px)",e.zIndex_11,e.opacity_11,e.tachieAreaHeight11+"px"))}}function hW(n,t){if(1&n&&(Je(0),Ee(1,tW,3,10,"img",4),Ee(2,nW,3,10,"img",5),Ee(3,iW,3,10,"img",6),Ee(4,rW,3,10,"img",7),Ee(5,oW,3,10,"img",8),Ee(6,sW,3,10,"img",9),Ee(7,aW,3,10,"img",10),Ee(8,lW,3,10,"img",11),Ee(9,cW,3,10,"img",12),Ee(10,uW,3,10,"img",13),Ee(11,dW,3,10,"img",14),Ee(12,fW,3,10,"img",15),et()),2&n){const e=$e(3);j(1),ie("ngIf",0<e.imageFileUrl_00.length),j(1),ie("ngIf",0<e.imageFileUrl_01.length),j(1),ie("ngIf",0<e.imageFileUrl_02.length),j(1),ie("ngIf",0<e.imageFileUrl_03.length),j(1),ie("ngIf",0<e.imageFileUrl_04.length),j(1),ie("ngIf",0<e.imageFileUrl_05.length),j(1),ie("ngIf",0<e.imageFileUrl_06.length),j(1),ie("ngIf",0<e.imageFileUrl_07.length),j(1),ie("ngIf",0<e.imageFileUrl_08.length),j(1),ie("ngIf",0<e.imageFileUrl_09.length),j(1),ie("ngIf",0<e.imageFileUrl_10.length),j(1),ie("ngIf",0<e.imageFileUrl_11.length)}}function pW(n,t){if(1&n&&(Je(0),Ee(1,hW,13,12,"ng-container",3),et()),2&n){const e=$e(2);j(1),ie("ngIf",e.isTachieDispMode)}}function gW(n,t){if(1&n&&(Je(0),Ee(1,pW,2,1,"ng-container",3),et()),2&n){const e=$e();j(1),ie("ngIf",e.chatTab.tachieDispFlag)}}let AP=(()=>{class n{constructor(e,i,r,o){this.chatMessageService=e,this.changeDetectionRef=i,this.panelService=r,this.pointerDeviceService=o,this.chatTabidentifier="",this.isTilteTop=!1,this.dispByMouse=!1,this._tachieAreaWidth=0,this._zindexOffset=10,this._opacity=.66}get chatTab(){return Xe.instance.get(this.chatTabidentifier)}get tachieY_Pos(){return this.chatTabList.isTachieInWindow?0:-this.chatTabList.tachieHeightValue-26}get tachieAreaWidth(){return this._tachieAreaWidth}get chatTabList(){return Xe.instance.get("ChatTabList")}get dispFlag(){return!!(this.isTilteTop&&!this.chatTabList.isTachieInWindow||!this.isTilteTop&&this.chatTabList.isTachieInWindow)}get isTachieDispMode(){return this.chatTabList.isKeepTachieOutWindow?this.dispFlag:this.dispFlag&&this.dispByMouse}tachieAreaHeight(e){return this.chatTab&&this.chatTab.tachieDispFlag&&this.chatTab.tachiePosIsDisp(e)?this.chatTabList.tachieHeightValue:0}get tachieAreaHeight00(){return this.tachieAreaHeight(0)}get tachieAreaHeight01(){return this.tachieAreaHeight(1)}get tachieAreaHeight02(){return this.tachieAreaHeight(2)}get tachieAreaHeight03(){return this.tachieAreaHeight(3)}get tachieAreaHeight04(){return this.tachieAreaHeight(4)}get tachieAreaHeight05(){return this.tachieAreaHeight(5)}get tachieAreaHeight06(){return this.tachieAreaHeight(6)}get tachieAreaHeight07(){return this.tachieAreaHeight(7)}get tachieAreaHeight08(){return this.tachieAreaHeight(8)}get tachieAreaHeight09(){return this.tachieAreaHeight(9)}get tachieAreaHeight10(){return this.tachieAreaHeight(10)}get tachieAreaHeight11(){return this.tachieAreaHeight(11)}ngAfterViewInit(){this._tachieAreaWidth=this.tachieArea.nativeElement.offsetWidth,this.changeDetectionRef.detectChanges()}ngAfterViewChecked(){this._tachieAreaWidth=this.tachieArea.nativeElement.offsetWidth,this.changeDetectionRef.detectChanges()}get zIndex_00(){return this.chatTab.tachieZindex(0)+this._zindexOffset}get zIndex_01(){return this.chatTab.tachieZindex(1)+this._zindexOffset}get zIndex_02(){return this.chatTab.tachieZindex(2)+this._zindexOffset}get zIndex_03(){return this.chatTab.tachieZindex(3)+this._zindexOffset}get zIndex_04(){return this.chatTab.tachieZindex(4)+this._zindexOffset}get zIndex_05(){return this.chatTab.tachieZindex(5)+this._zindexOffset}get zIndex_06(){return this.chatTab.tachieZindex(6)+this._zindexOffset}get zIndex_07(){return this.chatTab.tachieZindex(7)+this._zindexOffset}get zIndex_08(){return this.chatTab.tachieZindex(8)+this._zindexOffset}get zIndex_09(){return this.chatTab.tachieZindex(9)+this._zindexOffset}get zIndex_10(){return this.chatTab.tachieZindex(10)+this._zindexOffset}get zIndex_11(){return this.chatTab.tachieZindex(11)+this._zindexOffset}get opacity_00(){return 11==this.chatTab.tachieZindex(0)?1:this._opacity}get opacity_01(){return 11==this.chatTab.tachieZindex(1)?1:this._opacity}get opacity_02(){return 11==this.chatTab.tachieZindex(2)?1:this._opacity}get opacity_03(){return 11==this.chatTab.tachieZindex(3)?1:this._opacity}get opacity_04(){return 11==this.chatTab.tachieZindex(4)?1:this._opacity}get opacity_05(){return 11==this.chatTab.tachieZindex(5)?1:this._opacity}get opacity_06(){return 11==this.chatTab.tachieZindex(6)?1:this._opacity}get opacity_07(){return 11==this.chatTab.tachieZindex(7)?1:this._opacity}get opacity_08(){return 11==this.chatTab.tachieZindex(8)?1:this._opacity}get opacity_09(){return 11==this.chatTab.tachieZindex(9)?1:this._opacity}get opacity_10(){return 11==this.chatTab.tachieZindex(10)?1:this._opacity}get opacity_11(){return 11==this.chatTab.tachieZindex(11)?1:this._opacity}get imageFileUrl_00(){if(!this.chatTab.imageIdentifier)return"";let e=St.instance.get(this.chatTab.imageIdentifier[0]);return e?e.url:""}get imageFileUrl_01(){if(!this.chatTab.imageIdentifier)return"";let e=St.instance.get(this.chatTab.imageIdentifier[1]);return e?e.url:""}get imageFileUrl_02(){if(!this.chatTab.imageIdentifier)return"";let e=St.instance.get(this.chatTab.imageIdentifier[2]);return e?e.url:""}get imageFileUrl_03(){if(!this.chatTab.imageIdentifier)return"";let e=St.instance.get(this.chatTab.imageIdentifier[3]);return e?e.url:""}get imageFileUrl_04(){if(!this.chatTab.imageIdentifier)return"";let e=St.instance.get(this.chatTab.imageIdentifier[4]);return e?e.url:""}get imageFileUrl_05(){if(!this.chatTab.imageIdentifier)return"";let e=St.instance.get(this.chatTab.imageIdentifier[5]);return e?e.url:""}get imageFileUrl_06(){if(!this.chatTab.imageIdentifier)return"";let e=St.instance.get(this.chatTab.imageIdentifier[6]);return e?e.url:""}get imageFileUrl_07(){if(!this.chatTab.imageIdentifier)return"";let e=St.instance.get(this.chatTab.imageIdentifier[7]);return e?e.url:""}get imageFileUrl_08(){if(!this.chatTab.imageIdentifier)return"";let e=St.instance.get(this.chatTab.imageIdentifier[8]);return e?e.url:""}get imageFileUrl_09(){if(!this.chatTab.imageIdentifier)return"";let e=St.instance.get(this.chatTab.imageIdentifier[9]);return e?e.url:""}get imageFileUrl_10(){if(!this.chatTab.imageIdentifier)return"";let e=St.instance.get(this.chatTab.imageIdentifier[10]);return e?e.url:""}get imageFileUrl_11(){if(!this.chatTab.imageIdentifier)return"";let e=St.instance.get(this.chatTab.imageIdentifier[11]);return e?e.url:""}tachieClick(e){console.log("tachieClick"+e),this.chatTab.tachiePosHide(e)}ngOnInit(){}ngOnDestroy(){Qe.unregister(this)}trackByChatTab(e,i){return i.identifier}}return n.\u0275fac=function(e){return new(e||n)(Be(go),Be(bi),Be($n),Be(Di))},n.\u0275cmp=Qt({type:n,selectors:[["chat-tachie-img"]],viewQuery:function(e,i){if(1&e&&Gn(eW,5,fi),2&e){let r;yn(r=Cn())&&(i.tachieArea=r.first)}},inputs:{chatTabidentifier:"chatTabidentifier",isTilteTop:"isTilteTop",dispByMouse:"dispByMouse"},decls:5,vars:1,consts:[["id","tachie-component_"],[1,"tachie-image-box",2,"height","0px,width:100%"],["tachieArea",""],[4,"ngIf"],["class","tachie-image pos00",3,"src","ngStyle","mousedown",4,"ngIf"],["class","tachie-image pos01",3,"src","ngStyle","mousedown",4,"ngIf"],["class","tachie-image pos02",3,"src","ngStyle","mousedown",4,"ngIf"],["class","tachie-image pos03",3,"src","ngStyle","mousedown",4,"ngIf"],["class","tachie-image pos04",3,"src","ngStyle","mousedown",4,"ngIf"],["class","tachie-image pos05",3,"src","ngStyle","mousedown",4,"ngIf"],["class","tachie-image pos06",3,"src","ngStyle","mousedown",4,"ngIf"],["class","tachie-image pos07",3,"src","ngStyle","mousedown",4,"ngIf"],["class","tachie-image pos08",3,"src","ngStyle","mousedown",4,"ngIf"],["class","tachie-image pos09",3,"src","ngStyle","mousedown",4,"ngIf"],["class","tachie-image pos10",3,"src","ngStyle","mousedown",4,"ngIf"],["class","tachie-image pos11",3,"src","ngStyle","mousedown",4,"ngIf"],[1,"tachie-image","pos00",3,"src","ngStyle","mousedown"],["tachie00",""],[1,"tachie-image","pos01",3,"src","ngStyle","mousedown"],["tachie01",""],[1,"tachie-image","pos02",3,"src","ngStyle","mousedown"],["tachie02",""],[1,"tachie-image","pos03",3,"src","ngStyle","mousedown"],["tachie03",""],[1,"tachie-image","pos04",3,"src","ngStyle","mousedown"],["tachie04",""],[1,"tachie-image","pos05",3,"src","ngStyle","mousedown"],["tachie05",""],[1,"tachie-image","pos06",3,"src","ngStyle","mousedown"],["tachie06",""],[1,"tachie-image","pos07",3,"src","ngStyle","mousedown"],["tachie07",""],[1,"tachie-image","pos08",3,"src","ngStyle","mousedown"],["tachie08",""],[1,"tachie-image","pos09",3,"src","ngStyle","mousedown"],["tachie09",""],[1,"tachie-image","pos10",3,"src","ngStyle","mousedown"],["tachie10",""],[1,"tachie-image","pos11",3,"src","ngStyle","mousedown"],["tachie11",""]],template:function(e,i){1&e&&(J(0,"div")(1,"div",0)(2,"div",1,2),Ee(4,gW,2,1,"ng-container",3),oe()()()),2&e&&(j(4),ie("ngIf",i.chatTab))},directives:[Sn,Co],pipes:[Ii],styles:[".message-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 4px;border-radius:5px;cursor:pointer}.message-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.tachie-image[_ngcontent-%COMP%]{position:absolute;height:250px;padding:0;vertical-align:bottom;z-index:1}"]}),n})();const _W=["tachieArea"];function mW(n,t){if(1&n){const e=pt();Je(0),J(1,"input",7),Re("ngModelChange",function(r){return Le(e),$e().chatTab.tachieDispFlag=r}),oe(),et()}if(2&n){const e=$e();j(1),ie("ngModel",e.chatTab.tachieDispFlag)}}function $W(n,t){1&n&&(Je(0),it(1,"input",8),et())}function vW(n,t){if(1&n){const e=pt();Je(0),J(1,"input",9),Re("ngModelChange",function(r){return Le(e),$e().chatTab.chatSimpleDispFlag=r})("click",function(){return Le(e),$e().changeSimpleDisp()}),oe(),et()}if(2&n){const e=$e();j(1),ie("ngModel",e.chatTab.chatSimpleDispFlag)}}const bW=function(n){return{height:n}};let yW=(()=>{class n{constructor(e,i,r,o){this.chatMessageService=e,this.changeDetectionRef=i,this.panelService=r,this.pointerDeviceService=o,this.chatTabidentifier="",this._tachieAreaWidth=0}get chatTab(){return Xe.instance.get(this.chatTabidentifier)}get chatTabList(){return Xe.instance.get("ChatTabList")}get tachieAreaWidth(){return this._tachieAreaWidth}chkHeight(e){e<=this.chatTabList.minTachieSize&&(this.chatTabList.tachieHeightValue=this.chatTabList.minTachieSize),e>=this.chatTabList.maxTachieSize&&(this.chatTabList.tachieHeightValue=this.chatTabList.maxTachieSize)}get tachieAreaHeight(){return this.chatTab&&this.chatTab.tachieDispFlag&&this.chatTabList.isTachieInWindow?this.chatTabList.tachieHeightValue:0}ngAfterViewInit(){}ngAfterViewChecked(){}shoeMessageSetting(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(Jq,{title:"\u30c1\u30e3\u30c3\u30c8\u8a73\u7d30\u8a2d\u5b9a",left:e.x+50,top:e.y-200,width:340,height:220})}ngOnInit(){}ngOnDestroy(){Qe.unregister(this)}trackByChatTab(e,i){return i.identifier}changeSimpleDisp(){Qe.trigger("RE_DRAW_CHAT",{})}}return n.\u0275fac=function(e){return new(e||n)(Be(go),Be(bi),Be($n),Be(Di))},n.\u0275cmp=Qt({type:n,selectors:[["chat-tachie"]],viewQuery:function(e,i){if(1&e&&Gn(_W,5,fi),2&e){let r;yn(r=Cn())&&(i.tachieArea=r.first)}},inputs:{chatTabidentifier:"chatTabidentifier"},decls:17,vars:12,consts:[["id","tachie-component_",3,"ngStyle"],["tachieArea",""],[3,"chatTabidentifier","isTilteTop","dispByMouse"],[4,"ngIf"],["type","number","name","tachieHeight",1,"is-caret",3,"ngModel","min","max","ngModelChange","change"],[1,"message-setting","small-font",3,"click"],[1,"material-icons","small-font"],["type","checkbox","value","tachieDispFlag","name","tachieDispFlag",3,"ngModel","ngModelChange"],["type","checkbox"],["type","checkbox","value","chatSimpleDispFlag","name","chatSimpleDispFlag",3,"ngModel","ngModelChange","click"]],template:function(e,i){1&e&&(J(0,"div")(1,"form")(2,"div",0,1),it(4,"chat-tachie-img",2),oe(),J(5,"div"),we(6," \u7acb\u3061\u7d75\u8868\u793a: "),Ee(7,mW,2,1,"ng-container",3),Ee(8,$W,2,0,"ng-container",3),we(9," /\u30b5\u30a4\u30ba: "),J(10,"input",4),Re("ngModelChange",function(o){return i.chatTabList.tachieHeightValue=o})("change",function(o){return i.chkHeight(o.target.value)}),oe(),we(11," \u30c1\u30e3\u30c3\u30c8\u7c21\u6613\u8868\u793a: "),Ee(12,vW,2,1,"ng-container",3),J(13,"button",5),Re("click",function(){return i.shoeMessageSetting()}),J(14,"i",6),we(15,"settings"),oe(),we(16,"\u8a73\u7d30"),oe()()()()),2&e&&(j(2),ie("ngStyle",Nt(10,bW,i.tachieAreaHeight+"px")),j(2),ie("chatTabidentifier",i.chatTabidentifier)("isTilteTop",0)("dispByMouse",!0),j(3),ie("ngIf",i.chatTab),j(1),ie("ngIf",!i.chatTab),j(2),Ht("min",i.chatTabList.minTachieSize),Ht("max",i.chatTabList.maxTachieSize),ie("ngModel",i.chatTabList.tachieHeightValue),j(2),ie("ngIf",i.chatTab))},directives:[_s,gs,xo,Co,AP,Sn,ra,Ti,yi,ms,Vc,Ju,Fi],styles:[".message-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 4px;border-radius:5px;cursor:pointer}.message-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.tachie-image[_ngcontent-%COMP%]{position:absolute;height:250px;padding:0;vertical-align:bottom;z-index:1}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})(),PP=(()=>{class n{constructor(){this.count=0,this.animeState="active"}ngOnChanges(){this.animeState="inactive",setTimeout(()=>{this.animeState="active"})}animationShuffleDone(e){this.animeState="inactive"}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Qt({type:n,selectors:[["badge"]],inputs:{count:"count"},features:[br],decls:2,vars:2,consts:[[1,"badge"]],template:function(e,i){1&e&&(J(0,"div",0),we(1),oe()),2&e&&(ie("@bounce",i.animeState),j(1),xt(i.count))},styles:[".badge[_ngcontent-%COMP%]{min-width:8px;min-height:8px;font-size:8px;padding:2px 4px;border-radius:100px;text-align:center;color:#eee;background-color:#cf5252}"],data:{animation:[Na("bounce",[ox("active",mn({transform:""})),Lr("* => active",[Br("600ms ease",Ls([mn({transform:"scale3d(0.5, 0.5, 0.5)",offset:0}),mn({transform:"scale3d(2, 2, 2)",offset:.5}),mn({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),mn({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),mn({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])])]}}),n})(),Uw=(()=>{class n{constructor(e,i){this.panelService=e,this.modalService=i,this.text="",this.title=""}ngOnInit(){Promise.resolve().then(()=>{this.panelService.title=this.title,this.modalService.option&&null!=this.modalService.option.title&&(this.modalService.title=this.modalService.option.title?this.modalService.option.title:"",this.text=this.modalService.option.text?this.modalService.option.text:"")})}}return n.\u0275fac=function(e){return new(e||n)(Be($n),Be(pi))},n.\u0275cmp=Qt({type:n,selectors:[["text-view"]],inputs:{text:"text",title:"title"},decls:3,vars:1,consts:[[1,"text"]],template:function(e,i){1&e&&(J(0,"span")(1,"pre",0),we(2),oe()()),2&e&&(j(2),xt(i.text))},styles:["[_nghost-%COMP%]{display:block}.text[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;font-size:12px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}"]}),n})(),jw=(()=>{class n{constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this.isAllowedEmpty=!1,this.tabletopObject=null,this.isAllowedEmpty=!(!this.modalService.option||!this.modalService.option.isAllowedEmpty)}get myPeer(){return _t.myCursor}changeColor(e,i){this.tabletopObject?(this.tabletopObject.chatColorCode[i]=e,this.tabletopObject.syncDummyCounter=this.tabletopObject.syncDummyCounter<2?this.tabletopObject.syncDummyCounter+1:0,console.log("changeColor:count:"+this.tabletopObject.syncDummyCounter)):this.myPeer.chatColorCode[i]=e}ngOnInit(){}chatColorCode(e){return this.tabletopObject?this.tabletopObject.chatColorCode[e]:this.myPeer.chatColorCode[e]}ngAfterViewInit(){}ngOnDestroy(){}}return n.\u0275fac=function(e){return new(e||n)(Be(bi),Be($n),Be(pi))},n.\u0275cmp=Qt({type:n,selectors:[["chat-color-setting"]],inputs:{isAllowedEmpty:"isAllowedEmpty",tabletopObject:"tabletopObject"},decls:14,vars:3,consts:[["id","file-list"],[1,"table"],[1,"table-cell"],["type","color","name","color01","list","color-list_01",3,"value","change"],["type","color","name","color02","list","color-list_02",3,"value","change"],["type","color","name","color03","list","color-list_03",3,"value","change"]],template:function(e,i){1&e&&(J(0,"div",0)(1,"div",1)(2,"div",2)(3,"div"),we(4,"\u7b2c1\u8272"),oe(),J(5,"input",3),Re("change",function(o){return i.changeColor(o.target.value,0)}),oe()(),J(6,"div",2)(7,"div"),we(8,"\u7b2c2\u8272"),oe(),J(9,"input",4),Re("change",function(o){return i.changeColor(o.target.value,1)}),oe()(),J(10,"div",2)(11,"div"),we(12,"\u7b2c3\u8272"),oe(),J(13,"input",5),Re("change",function(o){return i.changeColor(o.target.value,2)}),oe()()()()),2&e&&(j(5),Ht("value",i.chatColorCode(0)),j(4),Ht("value",i.chatColorCode(1)),j(4),Ht("value",i.chatColorCode(2)))},styles:[".table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table[_ngcontent-%COMP%]   .table-cell[_ngcontent-%COMP%]{display:table-cell}input[_ngcontent-%COMP%]{width:5em}"],changeDetection:0}),n})();const CW=["textArea"];function xW(n,t){1&n&&(it(0,"img",23),At(1,"safe")),2&n&&ie("src",Ft(1,1,$e().imageFile.url,"resourceUrl"),hn)}function wW(n,t){if(1&n&&(J(0,"ng-option",8),we(1),oe()),2&n){const e=$e();ie("value",null==e.myPeer?null:e.myPeer.identifier),j(1),sn("",null==e.myPeer?null:e.myPeer.name,"\uff08\u3042\u306a\u305f\uff09")}}function EW(n,t){if(1&n&&(J(0,"ng-option",8),we(1),oe()),2&n){const e=t.$implicit;ie("value",e.identifier),j(1),sn("",e.name," ")}}function TW(n,t){1&n&&(Je(0),we(1,"\uff08\u3042\u306a\u305f\uff09"),et())}function SW(n,t){if(1&n&&(J(0,"ng-option",8),we(1),Ee(2,TW,2,0,"ng-container",11),oe()),2&n){const e=t.$implicit,i=$e();ie("value",e.identifier),j(1),sn("",e.name," "),j(1),ie("ngIf",e===i.myPeer)}}function DW(n,t){if(1&n&&(J(0,"ng-option",8),we(1),oe()),2&n){const e=t.$implicit;ie("value",e.id),j(1),xt(e.name)}}function IW(n,t){1&n&&(Je(0),J(1,"font",24),we(2,"\u203b\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093(\u304a\u305d\u3089\u304f\u30d0\u30fc\u30b8\u30e7\u30f3\u9055\u3044\u3067\u3059)\u518d\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),oe(),et())}const Np=function(n,t,e){return{"background-color":n,border:t,"border-radius":e}};function kW(n,t){if(1&n){const e=pt();Je(0),J(1,"div",25),Re("click",function(){return Le(e),$e().setColorNum(0)}),oe(),J(2,"div",25),Re("click",function(){return Le(e),$e().setColorNum(1)}),oe(),J(3,"div",25),Re("click",function(){return Le(e),$e().setColorNum(2)}),oe(),et()}if(2&n){const e=$e();j(1),ie("ngStyle",Wo(3,Np,e.playerChatColor_0,"solid "+e.colorSelectorBoxBorder_0+" #666666",e.colorSelectorRadius_0)),j(1),ie("ngStyle",Wo(7,Np,e.playerChatColor_1,"solid "+e.colorSelectorBoxBorder_1+" #666666",e.colorSelectorRadius_1)),j(1),ie("ngStyle",Wo(11,Np,e.playerChatColor_2,"solid "+e.colorSelectorBoxBorder_2+" #666666",e.colorSelectorRadius_2))}}function MW(n,t){if(1&n){const e=pt();Je(0),J(1,"div",25),Re("click",function(){return Le(e),$e().setColorNum(0)}),oe(),J(2,"div",25),Re("click",function(){return Le(e),$e().setColorNum(1)}),oe(),J(3,"div",25),Re("click",function(){return Le(e),$e().setColorNum(2)}),oe(),et()}if(2&n){const e=$e();j(1),ie("ngStyle",Wo(3,Np,e.charactorChatColor_0,"solid "+e.colorSelectorBoxBorder_0+" #666666",e.colorSelectorRadius_0)),j(1),ie("ngStyle",Wo(7,Np,e.charactorChatColor_1,"solid "+e.colorSelectorBoxBorder_1+" #666666",e.colorSelectorRadius_1)),j(1),ie("ngStyle",Wo(11,Np,e.charactorChatColor_2,"solid "+e.colorSelectorBoxBorder_2+" #666666",e.colorSelectorRadius_2))}}function AW(n,t){if(1&n){const e=pt();Je(0),J(1,"input",26),Re("ngModelChange",function(r){return Le(e),$e().tachieNum=r}),At(2,"safe"),oe(),we(3," 0/0 \u7acb\u3061\u7d75 "),et()}if(2&n){const e=$e();j(1),Qn(Ft(2,3,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),ie("ngModel",e.tachieNum)}}function PW(n,t){if(1&n&&(Je(0),we(1),et()),2&n){const e=$e(3);j(1),sn(" ",e.selectCharacterTachie.currentValue," ")}}function FW(n,t){if(1&n&&(Je(0),Ee(1,PW,2,1,"ng-container",11),et()),2&n){const e=$e(2);j(1),ie("ngIf",e.selectCharacterTachie.currentValue.length>0)}}function RW(n,t){if(1&n){const e=pt();Je(0),J(1,"input",27),Re("ngModelChange",function(r){return Le(e),$e().tachieNum=r}),At(2,"safe"),oe(),we(3),Ee(4,FW,2,1,"ng-container",11),et()}if(2&n){const e=$e();j(1),Qn(Ft(2,7,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),Ht("max",e.selectCharacterTachieNum-1),ie("ngModel",e.tachieNum),j(2),Os(" ",e.tachieNum,"/",e.selectCharacterTachieNum-1," \u7acb\u3061\u7d75\n"),j(1),ie("ngIf",e.selectCharacterTachie)}}function NW(n,t){1&n&&(J(0,"span"),we(1,", "),oe())}function OW(n,t){if(1&n&&(J(0,"span",29),we(1),Ee(2,NW,2,0,"span",11),oe()),2&n){const e=t.$implicit,i=t.index,r=$e(2);j(1),xt(e),j(1),ie("ngIf",r.writingPeerNames.length!==i+1)}}function BW(n,t){if(1&n&&(Je(0),Ee(1,OW,3,2,"span",28),J(2,"span"),we(3," \u304c\u5165\u529b\u4e2d..."),oe(),et()),2&n){const e=$e();j(1),ie("ngForOf",e.writingPeerNames)}}const LW=function(n){return{"direct-message":n}},FP=function(){return{standalone:!0}};let RP=(()=>{class n{constructor(e,i,r,o,s){this.ngZone=e,this.chatMessageService=i,this.batchService=r,this.panelService=o,this.pointerDeviceService=s,this.onlyCharacters=!1,this.chatTabidentifier="",this.autoCompleteIndex=-1,this._gameType="",this.gameTypeChange=new Xt,this._isGameTypeByUser=0,this._sendFrom=this.myPeer?this.myPeer.identifier:"",this.sendFromChange=new Xt,this._sendTo="",this.sendToChange=new Xt,this._autoCompleteListLen=-1,this._text="",this.textChange=new Xt,this.chat=new Xt,this.tabSwitch=new Xt,this.autoCompleteSwitch=new Xt,this.autoCompleteDo=new Xt,this.gameHelp="",this.loadDiceName="",this.colorSelectNo_=0,this.shouldUpdateCharacterList=!0,this._gameCharacters=[],this.writingEventInterval=null,this.previousWritingLength=0,this.writingPeers=new Map,this.writingPeerNames=[],this.calcFitHeightInterval=null,this.history=new Array,this.currentHistoryIndex=-1}get gameType(){return"DiceBot"==this._gameType&&0==this._isGameTypeByUser?this.config.defaultDiceBot:this._gameType}set gameType(e){this._isGameTypeByUser=1,this._gameType=e,this.gameTypeChange.emit(e)}get sendFrom(){return this._sendFrom}set sendFrom(e){this._sendFrom=e,this.sendFromChange.emit(e)}get sendTo(){return this._sendTo}set sendTo(e){this._sendTo=e,this.sendToChange.emit(e)}get text(){return this._text}set text(e){this._text=e,this.textChange.emit(e)}get config(){return Xe.instance.get("Config")}get tachieNum(){let e=Xe.instance.get(this.sendFrom);return e instanceof Lt?e.selectedTachieNum:0}set tachieNum(e){let i=Xe.instance.get(this.sendFrom);i instanceof Lt&&(i.selectedTachieNum=e)}get isDirect(){return!(null==this.sendTo||!this.sendTo.length)}get isGameCharacter(){return Xe.instance.get(this.sendFrom)instanceof Lt}get colorSelectNo(){return this.colorSelectNo_}set colorSelectNo(e){this.colorSelectNo_=e<0?0:e>2?2:e}get colorSelectorBoxBorder_0(){return 0==this.colorSelectNo?"3px":"1px"}get colorSelectorBoxBorder_1(){return 1==this.colorSelectNo?"3px":"1px"}get colorSelectorBoxBorder_2(){return 2==this.colorSelectNo?"3px":"1px"}get colorSelectorRadius_0(){return 0==this.colorSelectNo?"9px":"0px"}get colorSelectorRadius_1(){return 1==this.colorSelectNo?"9px":"0px"}get colorSelectorRadius_2(){return 2==this.colorSelectNo?"9px":"0px"}charactorChatColor(e){let i=Xe.instance.get(this.sendFrom);return i instanceof Lt?i.chatColorCode[e]:"#000000"}get selectChatColor(){return Xe.instance.get(this.sendFrom)instanceof Lt?this.charactorChatColor(this.colorSelectNo):this.playerChatColor(this.colorSelectNo)}get charactorChatColor_0(){return this.charactorChatColor(0)}get charactorChatColor_1(){return this.charactorChatColor(1)}get charactorChatColor_2(){return this.charactorChatColor(2)}playerChatColor(e){return this.myPeer.chatColorCode[e]}get playerChatColor_0(){return this.playerChatColor(0)}get playerChatColor_1(){return this.playerChatColor(1)}get playerChatColor_2(){return this.playerChatColor(2)}setColorNum(e){this.colorSelectNo=e}get selectCharacterTachie(){let e=Xe.instance.get(this.sendFrom);return e instanceof Lt&&e.imageDataElement.children.length>this.tachieNum?e.imageDataElement.children[this.tachieNum]:null}get selectCharacterTachieNum(){let e=Xe.instance.get(this.sendFrom);return e instanceof Lt?e.imageDataElement.children.length:0}get imageFile(){if(this.selectCharacterTachie)return St.instance.get(this.selectCharacterTachie.value)||Bt.Empty;let e=Xe.instance.get(this.sendFrom),i=null;return e instanceof Lt?i=e.imageFile:e instanceof _t&&(i=e.image),i||Bt.Empty}get gameCharacters(){return this.shouldUpdateCharacterList&&(this.shouldUpdateCharacterList=!1,this._gameCharacters=Xe.instance.getObjects(Lt).filter(e=>this.allowsChat(e))),this._gameCharacters}get diceBotInfos(){return sr.diceBotInfos}get myPeer(){return _t.myCursor}get otherPeers(){return Xe.instance.getObjects(_t)}ngOnInit(){Qe.register(this).on("MESSAGE_ADDED",e=>{if(e.data.tabIdentifier!==this.chatTabidentifier)return;let i=Xe.instance.get(e.data.messageIdentifier),r=Xe.instance.getObjects(_t).find(s=>s.userId===i.from),o=r?r.peerId:"?";this.writingPeers.has(o)&&(this.writingPeers.get(o).stop(),this.writingPeers.delete(o),this.updateWritingPeerNames())}).on("UPDATE_GAME_OBJECT",e=>{if(e.data.aliasName!==Lt.aliasName||(this.shouldUpdateCharacterList=!0,e.data.identifier!==this.sendFrom))return;let i=Xe.instance.get(e.data.identifier);i&&!this.allowsChat(i)&&(this.sendFrom=0<this.gameCharacters.length&&this.onlyCharacters?this.gameCharacters[0].identifier:this.myPeer.identifier)}).on("DISCONNECT_PEER",e=>{let i=Xe.instance.get(this.sendTo);i instanceof _t&&i.peerId===e.data.peerId&&(this.sendTo="")}).on("WRITING_A_MESSAGE",e=>{e.isSendFromSelf||e.data!==this.chatTabidentifier||(this.writingPeers.has(e.sendFrom)||this.writingPeers.set(e.sendFrom,new uc(()=>{this.writingPeers.delete(e.sendFrom),this.updateWritingPeerNames(),this.ngZone.run(()=>{})},2e3)),this.writingPeers.get(e.sendFrom).reset(),this.updateWritingPeerNames(),this.batchService.requireChangeDetection())})}ngOnDestroy(){Qe.unregister(this),this.batchService.remove(this)}updateWritingPeerNames(){this.writingPeerNames=Array.from(this.writingPeers.keys()).map(e=>{let i=_t.findByPeerId(e);return i?i.name:""})}onInput(){if(null===this.writingEventInterval&&this.previousWritingLength<=this.text.length){let e=null;if(this.isDirect){let i=Xe.instance.get(this.sendTo);if(i instanceof _t){let r=zi.parse(i.peerId);r&&(e=r.peerId)}}Qe.call("WRITING_A_MESSAGE",this.chatTabidentifier,e),this.writingEventInterval=setTimeout(()=>{this.writingEventInterval=null},200)}this.previousWritingLength=this.text.length,this.calcFitHeight()}moveHistory(e,i){let r;e&&e.preventDefault(),this.currentHistoryIndex=i<0&&this.currentHistoryIndex<0?this.history.length-1:i>0&&this.currentHistoryIndex>=this.history.length-1?-1:this.currentHistoryIndex+i,r=this.currentHistoryIndex<0?"":this.history[this.currentHistoryIndex],this.text=r,this.previousWritingLength=this.text.length,this.kickCalcFitHeight()}selectAutoComplete(e,i){this._autoCompleteListLen>1&&e&&e.preventDefault(),this.autoCompleteSwitch.emit(i)}tabSwitchAction(e,i){e&&e.preventDefault(),this.tabSwitch.emit(i)}sendChat(e){if(e&&e.preventDefault(),!this.text.length||e&&13!==e.keyCode)return;if(this.autoCompleteIndex>=0)return console.log("\u30aa\u30fc\u30c8\u30b3\u30f3\u30d7\u30ea\u30fc\u30c8\u51e6\u7406\u5b9f\u884c INDEX:"+this.autoCompleteIndex),void this.autoCompleteDo.emit(this.autoCompleteIndex);this.sendFrom.length||(this.sendFrom=this.myPeer.identifier),this.history.length>=n.MAX_HISTORY_NUM&&this.history.shift(),this.history.push(this.text),this.currentHistoryIndex=-1;const i={text:this.text,sendFrom:this.sendFrom,sendTo:this.sendTo,tachieNum:this.tachieNum,messColor:this.selectChatColor};sr.loadGameSystemAsync(this.gameType).then(r=>{this.chat.emit({text:i.text,gameSystem:r,sendFrom:i.sendFrom,sendTo:i.sendTo,tachieNum:i.tachieNum,messColor:i.messColor})}),this.text="",this.previousWritingLength=this.text.length,this.kickCalcFitHeight()}kickCalcFitHeight(){null==this.calcFitHeightInterval&&(this.calcFitHeightInterval=setTimeout(()=>{this.calcFitHeightInterval=null,this.calcFitHeight()},0))}calcFitHeight(){let e=this.textAreaElementRef.nativeElement;e.style.height="",e.scrollHeight>=e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}loadDiceBot(e){console.log("onChangeGameType ready"),sr.getHelpMessage(e).then(i=>{console.log("onChangeGameType done\n"+i)})}isGameTypeInList(){for(let e of this.diceBotInfos)if(e.id===this.gameType)return!0;return!1}showDicebotHelp(){sr.getHelpMessage(this.gameType).then(e=>{this.gameHelp=e;let i="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8";for(let a of sr.diceBotInfos)a.id===this.gameType&&(i="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8<"+a.name+"\uff1e");i+="\u306e\u8aac\u660e";let r=this.pointerDeviceService.pointers[0],s=this.panelService.open(Uw,{left:r.x,top:r.y,width:600,height:500});s.title=i,s.text="\u3010\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3011\u30c1\u30e3\u30c3\u30c8\u306b\u30c0\u30a4\u30b9\u7528\u306e\u6587\u5b57\u3092\u5165\u529b\u3059\u308b\u3068\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u304c\u53ef\u80fd\n\u5165\u529b\u4f8b\uff09\uff12\uff44\uff16\uff0b\uff11\u3000\u653b\u6483\uff01\n\u51fa\u529b\u4f8b\uff092d6+1\u3000\u653b\u6483\uff01\n\u3000\u3000\u3000\u3000  diceBot: (2d6) \u2192 7\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u30c0\u30a4\u30b9\u6587\u5b57\u306e\u5f8c\u308d\u306b\u7a7a\u767d\u3092\u5165\u308c\u3066\u767a\u8a00\u3059\u308b\u4e8b\u3082\u53ef\u80fd\u3002\n\u4ee5\u4e0b\u3001\u4f7f\u7528\u4f8b\n\u30003D6+1>=9 \uff1a3d6+1\u3067\u76ee\u6a19\u50249\u4ee5\u4e0a\u304b\u306e\u5224\u5b9a\n\u30001D100<=50 \uff1aD100\u306750\uff05\u76ee\u6a19\u306e\u4e0b\u65b9\u30ed\u30fc\u30eb\u306e\u4f8b\n\u30003U6[5] \uff1a3d6\u306e\u30c0\u30a4\u30b9\u76ee\u304c5\u4ee5\u4e0a\u306e\u5834\u5408\u306b\u632f\u308a\u8db3\u3057\u3057\u3066\u5408\u8a08\u3059\u308b(\u4e0a\u65b9\u7121\u9650)\n\u30003B6 \uff1a3d6\u306e\u30c0\u30a4\u30b9\u76ee\u3092\u30d0\u30e9\u30d0\u30e9\u306e\u307e\u307e\u51fa\u529b\u3059\u308b\uff08\u5408\u8a08\u3057\u306a\u3044\uff09\n\u300010B6>=4 \uff1a10d6\u3092\u632f\u308a4\u4ee5\u4e0a\u306e\u30c0\u30a4\u30b9\u76ee\u306e\u500b\u6570\u3092\u6570\u3048\u308b\n\u30002R6[>3]>=5 \uff1a2D6\u306e\u30c0\u30a4\u30b9\u76ee\u304c3\u3088\u308a\u5927\u304d\u3044\u5834\u5408\u306b\u632f\u308a\u8db3\u3057\u3066\u30015\u4ee5\u4e0a\u306e\u30c0\u30a4\u30b9\u76ee\u306e\u500b\u6570\u3092\u6570\u3048\u308b\n\u3000(8/2)D(4+6)<=(5*3)\uff1a\u500b\u6570\u30fb\u30c0\u30a4\u30b9\u30fb\u9054\u6210\u5024\u306b\u306f\u56db\u5247\u6f14\u7b97\u3082\u4f7f\u7528\u53ef\u80fd\n\u3000c(10-4*3/2+2)\uff1ac(\u8a08\u7b97\u5f0f\uff09\u3067\u8a08\u7b97\u3060\u3051\u306e\u5b9f\u884c\u3082\u53ef\u80fd\n\u3000choice[a,b,c]\uff1a\u5217\u6319\u3057\u305f\u8981\u7d20\u304b\u3089\u4e00\u3064\u3092\u9078\u629e\u8868\u793a\u3002\u30e9\u30f3\u30c0\u30e0\u653b\u6483\u5bfe\u8c61\u6c7a\u5b9a\u306a\u3069\u306b\n\u3000S3d6 \uff1a \u5404\u30b3\u30de\u30f3\u30c9\u306e\u5148\u982d\u306b\u300cS\u300d\u3092\u4ed8\u3051\u308b\u3068\u4ed6\u4eba\u7d50\u679c\u306e\u898b\u3048\u306a\u3044\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ed\u30fc\u30eb\n\u30003d6/2 \uff1a \u30c0\u30a4\u30b9\u51fa\u76ee\u3092\u5272\u308a\u7b97\uff08\u7aef\u6570\u51e6\u7406\u306f\u30b2\u30fc\u30e0\u30b7\u30b9\u30c6\u30e0\u4f9d\u5b58\uff09\u3002\u5207\u308a\u4e0a\u3052\u306f /2C\u3001\u56db\u6368\u4e94\u5165\u306f /2R\u3001\u5207\u308a\u6368\u3066\u306f /2F\n\u3000D66 \uff1a D66\u30c0\u30a4\u30b9\u3002\u9806\u5e8f\u306f\u30b2\u30fc\u30e0\u306b\u4f9d\u5b58\u3002D66N\uff1a\u305d\u306e\u307e\u307e\u3001D66A\uff1a\u6607\u9806\u3001D66D\uff1a\u964d\u9806\n\n\u8a73\u7d30\u306f\u4e0b\u8a18URL\u306e\u30b3\u30de\u30f3\u30c9\u30ac\u30a4\u30c9\u3092\u53c2\u7167\nhttps://docs.bcdice.org/\n===================================\n"+this.gameHelp})}shoeColorSetting(){let e=Xe.instance.get(this.sendFrom);if(e instanceof Lt){let i=this.pointerDeviceService.pointers[0],r="\u8272\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(jw,{title:r,left:i.x+50,top:i.y-300,width:300,height:170}).tabletopObject=e}else{let i=this.pointerDeviceService.pointers[0];this.panelService.open(jw,{title:"\u8272\u8a2d\u5b9a",left:i.x+50,top:i.y-150,width:300,height:120}).tabletopObject=null}}allowsChat(e){switch(e.location.name){case"table":case this.myPeer.peerId:return!e.nonTalkFlag;case"graveyard":return!1;default:if(e.nonTalkFlag)return!1;for(const i of bt.peerContexts)if(i.isOpen&&e.location.name===i.peerId)return!1;return!0}}}return n.MAX_HISTORY_NUM=1e3,n.\u0275fac=function(e){return new(e||n)(Be(An),Be(go),Be(Rp),Be($n),Be(Di))},n.\u0275cmp=Qt({type:n,selectors:[["chat-input"]],viewQuery:function(e,i){if(1&e&&Gn(CW,7),2&e){let r;yn(r=Cn())&&(i.textAreaElementRef=r.first)}},inputs:{onlyCharacters:"onlyCharacters",chatTabidentifier:"chatTabidentifier",autoCompleteIndex:"autoCompleteIndex",_gameType:["gameType","_gameType"],_sendFrom:["sendFrom","_sendFrom"],_sendTo:["sendTo","_sendTo"],_autoCompleteListLen:["autoCompleteListLen","_autoCompleteListLen"],_text:["text","_text"]},outputs:{gameTypeChange:"gameTypeChange",sendFromChange:"sendFromChange",sendToChange:"sendToChange",textChange:"textChange",chat:"chat",tabSwitch:"tabSwitch",autoCompleteSwitch:"autoCompleteSwitch",autoCompleteDo:"autoCompleteDo"},decls:40,vars:26,consts:[[1,"table",3,"ngClass"],[1,"table-cell","imagebox"],["class","image",3,"src",4,"ngIf"],[1,"table-cell",2,"width","100%"],[1,"ud-select","is-caret",2,"width","12em",3,"ngModel","clearable","ngModelChange"],[3,"value",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[1,"ud-select","is-caret",2,"width","10em",3,"ngModel","clearable","ngModelChange"],[3,"value"],[1,"ud-select","is-caret",2,"width","15em","margin-left",".1em",3,"ngModel","ngModelOptions","clearable","change","ngModelChange"],[3,"click"],[4,"ngIf"],[1,"table"],[1,"table-cell","color-box-tag"],[1,"table-cell","color-setting-tag"],[1,"color-setting","small-font",3,"click"],[1,"material-icons","small-font"],[1,"table-cell","tachie-tag"],[1,"table-cell"],["placeholder","Enter:\u9001\u4fe1 Shift+Enter:\u6539\u884c Ctrl+\u4e0a\u4e0b:\u5c65\u6b74 Ctrl+\u5de6\u53f3:\u30bf\u30d6\u5207\u66ff",1,"chat-input","is-caret",3,"ngModel","ngModelOptions","ngModelChange","input","keydown.enter","keydown.control.arrowup","keydown.control.arrowdown","keydown.arrowup","keydown.arrowdown","keydown.control.arrowleft","keydown.control.arrowright"],["textArea",""],["type","submit",3,"click"],[1,"writing-info"],[1,"image",3,"src"],["size","1.5","color","#FF0000"],[1,"color",3,"ngStyle","click"],["type","range","min","0","max","0",3,"ngModel","ngModelChange"],["type","range","min","0",3,"max","ngModel","ngModelChange"],["style","font-weight: bold;",4,"ngFor","ngForOf"],[2,"font-weight","bold"]],template:function(e,i){1&e&&(J(0,"div",0)(1,"div",1),Ee(2,xW,2,4,"img",2),oe(),J(3,"div",3)(4,"div")(5,"ng-select",4),Re("ngModelChange",function(o){return i.sendFrom=o}),Ee(6,wW,2,2,"ng-option",5),Ee(7,EW,2,2,"ng-option",6),oe(),we(8," \uff1e "),J(9,"ng-select",7),Re("ngModelChange",function(o){return i.sendTo=o}),J(10,"ng-option",8),we(11,"\u5168\u54e1"),oe(),Ee(12,SW,3,3,"ng-option",6),oe(),J(13,"ng-select",9),Re("change",function(o){return i.loadDiceBot(o)})("ngModelChange",function(o){return i.gameType=o}),Ee(14,DW,2,2,"ng-option",6),oe(),J(15,"button",10),Re("click",function(){return i.showDicebotHelp()}),we(16,"?"),oe()(),J(17,"div"),Ee(18,IW,3,0,"ng-container",11),oe(),J(19,"div",12)(20,"div",13),Ee(21,kW,4,15,"ng-container",11),Ee(22,MW,4,15,"ng-container",11),oe(),J(23,"div",14)(24,"button",15),Re("click",function(){return i.shoeColorSetting()}),J(25,"i",16),we(26,"settings"),oe(),we(27,"\u8272\u8a2d\u5b9a"),oe()(),J(28,"div",17),Ee(29,AW,4,6,"ng-container",11),Ee(30,RW,5,10,"ng-container",11),oe(),it(31,"div",18),oe(),J(32,"div")(33,"form")(34,"textarea",19,20),Re("ngModelChange",function(o){return i.text=o})("input",function(){return i.onInput()})("keydown.enter",function(o){return i.sendChat(o)})("keydown.control.arrowup",function(o){return i.moveHistory(o,-1)})("keydown.control.arrowdown",function(o){return i.moveHistory(o,1)})("keydown.arrowup",function(o){return i.selectAutoComplete(o,-1)})("keydown.arrowdown",function(o){return i.selectAutoComplete(o,1)})("keydown.control.arrowleft",function(o){return i.tabSwitchAction(o,-1)})("keydown.control.arrowright",function(o){return i.tabSwitchAction(o,1)}),oe(),J(36,"button",21),Re("click",function(){return i.sendChat(null)}),we(37,"SEND"),oe()()(),J(38,"div",22),Ee(39,BW,4,1,"ng-container",11),oe()()()),2&e&&(ie("ngClass",Nt(22,LW,i.isDirect)),j(2),ie("ngIf",0<i.imageFile.url.length),j(3),ie("ngModel",i.sendFrom)("clearable",!1),j(1),ie("ngIf",!i.onlyCharacters),j(1),ie("ngForOf",i.gameCharacters),j(2),ie("ngModel",i.sendTo)("clearable",!1),j(1),ie("value",""),j(2),ie("ngForOf",i.otherPeers),j(1),ie("ngModel",i.gameType)("ngModelOptions",$r(24,FP))("clearable",!1),j(1),ie("ngForOf",i.diceBotInfos),j(4),ie("ngIf",!i.isGameTypeInList()),j(3),ie("ngIf",!i.isGameCharacter),j(1),ie("ngIf",i.isGameCharacter),j(7),ie("ngIf",1>i.selectCharacterTachieNum),j(1),ie("ngIf",1<=i.selectCharacterTachieNum),j(4),ie("ngModel",i.text)("ngModelOptions",$r(25,FP)),j(5),ie("ngIf",0<i.writingPeerNames.length))},directives:[ir,Sn,gp,Ti,yi,wf,si,Co,oa,Fi,_s,gs,xo],pipes:[Ii],styles:[".color-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 4px;border-radius:5px;cursor:pointer}.color-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}div.color[_ngcontent-%COMP%]{display:inline-block;border:solid 1px #000;box-sizing:border-box;position:relative;top:4px;width:18px;height:18px;margin-left:2px;margin-right:2px;background-color:#888;cursor:pointer}button.color[_ngcontent-%COMP%]:focus{outline:none}.table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table-cell[_ngcontent-%COMP%]{display:table-cell}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.chat-input[_ngcontent-%COMP%]{font-family:inherit;font-size:13px;width:calc(100% - 100px);height:calc(1em + 4px);min-height:calc(1em + 7px);max-height:calc(6em + 7px);resize:none;overflow:auto;padding:1px;margin:5px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;vertical-align:bottom}.writing-info[_ngcontent-%COMP%]{font-size:8px;height:1.3em}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.color-box-tag[_ngcontent-%COMP%], .color-setting-tag[_ngcontent-%COMP%]{width:4.5em;max-width:4.5em;min-width:4.5em}.tachie-tag[_ngcontent-%COMP%]{vertical-align:bottom;overflow:hidden;max-width:10em;white-space:nowrap}.tachie-num[_ngcontent-%COMP%]{font-weight:700;width:4em;text-align:right;font-family:inherit}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();function zW(n,t){if(1&n){const e=pt();J(0,"chat-tab",11),Re("addMessage",function(){return Le(e),$e().scrollToBottom()}),oe()}2&n&&ie("chatTab",$e().chatTab)}function HW(n,t){1&n&&(J(0,"div"),we(1,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u306e\u5185\u5bb9\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\u3002\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u9078\u629e\u3057\u306a\u304a\u3059\u304b\u3001\u3053\u306e\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u958b\u304d\u306a\u304a\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),oe())}function VW(n,t){1&n&&it(0,"badge",14),2&n&&ie("count",$e().$implicit.unreadLength)}function UW(n,t){if(1&n){const e=pt();J(0,"label")(1,"input",12),Re("ngModelChange",function(r){return Le(e),$e().chatTabidentifier=r}),oe(),J(2,"div"),we(3),Ee(4,VW,1,1,"badge",13),oe()()}if(2&n){const e=t.$implicit,i=$e();j(1),Ht("value",e.identifier),ie("ngModel",i.chatTabidentifier),j(2),xt(e.name),j(1),ie("ngIf",e.hasUnread)}}let NP=(()=>{class n{constructor(e,i,r){this.chatMessageService=e,this.panelService=i,this.pointerDeviceService=r,this.sendFrom="Guest",this._chatTabidentifier="",this.testcount=0,this.isAutoScroll=!0,this.scrollToBottomTimer=null}get gameType(){return this.chatMessageService.gameType?this.chatMessageService.gameType:"DiceBot"}set gameType(e){this.chatMessageService.gameType=e}get chatTabidentifier(){return this._chatTabidentifier}set chatTabidentifier(e){let i=this._chatTabidentifier!==e;this._chatTabidentifier=e,this.updatePanelTitle(),i&&this.scrollToBottom(!0)}chatTabSwitchRelative(e){let o,i=this.chatMessageService.chatTabs,r=i.findIndex(s=>s.identifier==this.chatTabidentifier);r<0||(o=r==i.length-1&&1==e?0:0==r&&-1==e?i.length-1:r+e,this.chatTabidentifier=i[o].identifier)}get chatTab(){return Xe.instance.get(this.chatTabidentifier)}testadd(){this.chatTab.count++}get testmess(){return this.chatTab.imageIdentifier}ngOnInit(){this.sendFrom=_t.myCursor.identifier,this._chatTabidentifier=0<this.chatMessageService.chatTabs.length?this.chatMessageService.chatTabs[0].identifier:"",Qe.register(this).on("MESSAGE_ADDED",e=>{if(e.data.tabIdentifier!==this.chatTabidentifier)return;let i=Xe.instance.get(e.data.messageIdentifier);i&&i.isSendFromSelf?this.isAutoScroll=!0:this.checkAutoScroll(),this.isAutoScroll&&this.chatTab&&this.chatTab.markForRead()}),Promise.resolve().then(()=>this.updatePanelTitle())}ngAfterViewInit(){queueMicrotask(()=>this.scrollToBottom(!0))}ngOnDestroy(){Qe.unregister(this)}scrollToBottom(e=!1){if(e&&(this.isAutoScroll=!0),!this.isAutoScroll)return;let i=new CustomEvent("scrolltobottom",{});this.panelService.scrollablePanel.dispatchEvent(i),null==this.scrollToBottomTimer&&(this.scrollToBottomTimer=setTimeout(()=>{this.chatTab&&this.chatTab.markForRead(),this.scrollToBottomTimer=null,this.isAutoScroll=!1,this.panelService.scrollablePanel&&(this.panelService.scrollablePanel.scrollTop=this.panelService.scrollablePanel.scrollHeight)},0))}checkAutoScroll(){this.panelService.scrollablePanel&&(this.isAutoScroll=this.panelService.scrollablePanel.scrollHeight-this.panelService.scrollablePanel.clientHeight-150<=this.panelService.scrollablePanel.scrollTop)}updatePanelTitle(){this.chatTab?(this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6 - "+this.chatTab.name,this.panelService.chatTab=this.chatTab):(this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6",this.panelService.chatTab=null)}onSelectedTab(e){this.updatePanelTitle()}showTabSetting(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(OG,{left:e.x-250,top:e.y-175,width:500,height:380}).selectedTab=this.chatTab}showDiceTableSetting(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(XG,{left:e.x+50,top:e.y-450,width:650,height:400})}showVoteMenu(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(dq,{left:e.x+50,top:e.y-450,width:650,height:400})}showAlarmMenu(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(Eq,{left:e.x+50,top:e.y-450,width:650,height:400})}checkTargetCharactor(e){let i=!1;return e.match(/^[sS\uff53\uff33]?[tT\uff54\uff34][:\uff1a]([^:\uff1a]+)/g)&&(i=!0),e.match(/\s[sS\uff53\uff33]?[tT\uff54\uff34][:\uff1a]([^:\uff1a]+)/g)&&(i=!0),e.match(/^[tT\uff54\uff34][&\uff06]([^&\uff06]+)/g)&&(i=!0),e.match(/\s[tT\uff54\uff34][&\uff06]([^&\uff06]+)/g)&&(i=!0),i}targeted(e){return"table"==e.location.name&&e.targeted}targetedGameCharacterList(){let e=[];return e=Xe.instance.getObjects(Lt).filter(i=>this.targeted(i)),e}sendChat(e){if(this.chatTab){let i="",r=[],o=[];if(console.log(e.text+":"+this.checkTargetCharactor(e.text)),this.checkTargetCharactor(e.text)){r=this.targetedGameCharacterList();let s=!0;0==r.length&&(i+="\u5bfe\u8c61\u304c\u672a\u9078\u629e\u3067\u3059");for(let a of r){i+=s?"":"\n";let g=e.text,w="";w=s?g:sr.deleteMyselfResourceBuff(g),i+=w,i+=" ["+a.name+"]",s=!1;let W={text:"",object:null};W.text=w,W.object=a,o.push(W)}}else{i=e.text;let s={text:"",object:null};s.text=e.text,s.object=null,o.push(s)}this.chatMessageService.sendMessage(this.chatTab,i,e.gameSystem,e.sendFrom,e.sendTo,e.tachieNum,e.messColor,o)}}trackByChatTab(e,i){return i.identifier}}return n.\u0275fac=function(e){return new(e||n)(Be(go),Be($n),Be(Di))},n.\u0275cmp=Qt({type:n,selectors:[["chat-window"]],decls:25,vars:8,consts:[[1,"component"],[1,"log"],[3,"chatTab","addMessage",4,"ngIf"],[4,"ngIf"],[1,"sticky-bottom"],[3,"chatTabidentifier"],[1,"chat-tab"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[3,"chatTabidentifier","gameType","sendFrom","gameTypeChange","sendFromChange","chat","tabSwitch"],[3,"chatTab","addMessage"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","badge",3,"count",4,"ngIf"],[1,"badge",3,"count"]],template:function(e,i){1&e&&(J(0,"div",0)(1,"div",1),Ee(2,zW,1,1,"chat-tab",2),Ee(3,HW,2,0,"div",3),oe(),J(4,"div",4)(5,"form"),it(6,"chat-tachie",5),J(7,"div",6),Ee(8,UW,5,4,"label",7),J(9,"button",8),Re("click",function(){return i.showTabSetting()}),J(10,"i",9),we(11,"settings"),oe(),we(12,"\u30bf\u30d6\u8a2d\u5b9a"),oe(),J(13,"button",8),Re("click",function(){return i.showDiceTableSetting()}),J(14,"i",9),we(15,"settings"),oe(),we(16,"\u30c0\u30a4\u30b9\u8868\u8a2d\u5b9a"),oe(),J(17,"button",8),Re("click",function(){return i.showVoteMenu()}),J(18,"i",9),we(19,"group"),oe(),we(20,"\u70b9\u547c"),oe(),J(21,"button",8),Re("click",function(){return i.showAlarmMenu()}),J(22,"i",9),we(23,"alarm"),oe()()()(),J(24,"chat-input",10),Re("gameTypeChange",function(o){return i.gameType=o})("sendFromChange",function(o){return i.sendFrom=o})("chat",function(o){return i.sendChat(o)})("tabSwitch",function(o){return i.chatTabSwitchRelative(o)}),oe()()()),2&e&&(j(2),ie("ngIf",i.chatTab),j(1),ie("ngIf",!i.chatTab),j(3),ie("chatTabidentifier",i.chatTabidentifier),j(2),ie("ngForOf",i.chatMessageService.chatTabs)("ngForTrackBy",i.trackByChatTab),j(16),ie("chatTabidentifier",i.chatTabidentifier)("gameType",i.gameType)("sendFrom",i.sendFrom))},directives:[Sn,Qq,_s,gs,xo,yW,si,Qu,Fi,Ti,yi,PP,RP],styles:[".loop-anime[_ngcontent-%COMP%]{animation:anime1 1.3s infinite ease-in-out}.component[_ngcontent-%COMP%]{min-height:100%;display:flex;flex-direction:column;justify-content:space-between;align-content:space-between}.sticky-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;width:100%;background-color:#f0dabdcc;border-top:1px dotted #666;margin-bottom:0}.chat-tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 4px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}"]}),n})();const jW=["root"];function GW(n,t){if(1&n&&(J(0,"div",11),we(1),oe()),2&n){const e=$e();j(1),xt(e.title)}}function qW(n,t){1&n&&(J(0,"div",12)(1,"div",13),we(2,"\u9ad8"),oe(),J(3,"div",14),we(4,"0"),oe(),J(5,"div",15),we(6,"\u4f4e"),oe()())}function WW(n,t){if(1&n){const e=pt();J(0,"div",16)(1,"input",17,18),Re("ngModelChange",function(r){return Le(e),$e().altitudeHande.altitude=r}),oe()()}if(2&n){const e=$e();j(1),Ht("title",e.altitudeHande.altitude),ie("ngModel",e.altitudeHande.altitude)}}function ZW(n,t){if(1&n){const e=pt();J(0,"span",20),we(1," (\u9ad8\u5ea6 "),J(2,"input",21),Re("ngModelChange",function(r){return Le(e),$e(2).altitudeHande.altitude=r}),oe(),we(3,")"),oe()}if(2&n){const e=$e(2);j(2),ie("ngModel",e.altitudeHande.altitude)}}function YW(n,t){if(1&n&&(J(0,"div")(1,"div",11),Ee(2,ZW,4,1,"span",19),oe()()),2&n){const e=$e();j(1),un("color",e.titleColor)("font-weight",e.titleBold?"bolder":"normal"),j(1),ie("ngIf",e.altitudeHande)}}function KW(n,t){1&n&&pn(0)}const OP=function(n){return{action:n}};function XW(n,t){if(1&n&&(Je(0),Ee(1,KW,1,0,"ng-container",23),et()),2&n){const e=t.$implicit;$e(2);const i=ln(16),r=ln(14);j(1),ie("ngTemplateOutlet","separator"===(null==e?null:e.type)?i:r)("ngTemplateOutletContext",Nt(2,OP,e))}}function QW(n,t){if(1&n&&(Je(0),Ee(1,XW,2,4,"ng-container",22),et()),2&n){const e=$e();j(1),ie("ngForOf",e.actions)}}function JW(n,t){1&n&&pn(0)}function eZ(n,t){if(1&n&&(Je(0),Ee(1,JW,1,0,"ng-container",23),et()),2&n){const e=t.$implicit;$e(2);const i=ln(16),r=ln(12);j(1),ie("ngTemplateOutlet","separator"===(null==e?null:e.type)?i:r)("ngTemplateOutletContext",Nt(2,OP,e))}}function tZ(n,t){if(1&n&&(Je(0),Ee(1,eZ,2,4,"ng-container",22),et()),2&n){const e=$e();j(1),ie("ngForOf",e.actions)}}function nZ(n,t){if(1&n){const e=pt();J(0,"li",24),Re("click",function(){const o=Le(e).action;return $e().indexAction(o.line,o.id)}),J(1,"div",25),we(2),oe()()}if(2&n){const e=t.action;j(2),Os("",e.line,":",e.name,"")}}function iZ(n,t){1&n&&it(0,"input",33),2&n&&ie("disabled",$e().action.disabled)}function rZ(n,t){1&n&&it(0,"input",34),2&n&&ie("disabled",$e().action.disabled)}function oZ(n,t){1&n&&it(0,"input",35),2&n&&ie("disabled",$e().action.disabled)}function sZ(n,t){1&n&&it(0,"input",36),2&n&&ie("disabled",$e().action.disabled)}function aZ(n,t){1&n&&(J(0,"div",37)(1,"i",38),we(2,"arrow_forward_ios"),oe()())}function lZ(n,t){if(1&n&&it(0,"context-menu",39),2&n){const e=$e().action,i=$e();ie("title",e.name)("actions",i.subMenu)("isSubmenu",!0)}}function cZ(n,t){if(1&n){const e=pt();J(0,"li",26),Re("click",function(){const o=Le(e).action;return $e().doAction(o)})("mouseenter",function(){const o=Le(e).action;return $e().showSubMenu(o)}),J(1,"div",25),Ee(2,iZ,1,1,"input",27),Ee(3,rZ,1,1,"input",28),Ee(4,oZ,1,1,"input",29),Ee(5,sZ,1,1,"input",30),we(6),oe(),Ee(7,aZ,3,0,"div",31),Ee(8,lZ,1,3,"context-menu",32),oe()}if(2&n){const e=t.action,i=$e();j(2),ie("ngIf",e.name&&0==e.name.indexOf("\u2611")),j(1),ie("ngIf",e.name&&0==e.name.indexOf("\u2610")),j(1),ie("ngIf",e.name&&0==e.name.indexOf("\u25c9")),j(1),ie("ngIf",e.name&&0==e.name.indexOf("\u25cb")),j(1),sn(" ",e.name.replace("\u2611","").replace("\u2610","").replace("\u25c9","").replace("\u25cb","")," "),j(1),ie("ngIf",e.subActions),j(1),ie("ngIf",i.subMenu&&i.parentMenu===e)}}function uZ(n,t){1&n&&(J(0,"li"),it(1,"hr",40),oe())}const dZ=function(n,t,e){return{"submenu-panel":n,"is-max-limit":t,"pointer-events-none":e}};let fZ=(()=>{class n{constructor(e,i,r){this.elementRef=e,this.contextMenuService=i,this.pointerDeviceService=r,this.title="",this.actions=[],this.isSubmenu=!1,this.callbackOnOutsideClick=o=>this.onOutsideClick(o)}get isPointerDragging(){return this.pointerDeviceService.isDragging}get altitudeHande(){for(let e of this.actions)if(e&&e.altitudeHande)return e.altitudeHande;return null}ngOnInit(){this.isSubmenu||(this.title=this.contextMenuService.title,this.actions=this.contextMenuService.actions)}ngAfterViewInit(){this.isSubmenu?this.adjustPositionSub():(this.adjustPositionRoot(),document.addEventListener("touchstart",this.callbackOnOutsideClick,!0),document.addEventListener("mousedown",this.callbackOnOutsideClick,!0)),this.indexMenuPosion()}ngOnDestroy(){document.removeEventListener("touchstart",this.callbackOnOutsideClick,!0),document.removeEventListener("mousedown",this.callbackOnOutsideClick,!0)}onOutsideClick(e){!1===this.rootElementRef.nativeElement.contains(e.target)&&this.close()}onContextMenu(e){e.stopPropagation(),e.preventDefault()}indexMenuPosion(){if("\u30a4\u30f3\u30c7\u30c3\u30af\u30b9"!=this.title)return;let e=this.rootElementRef.nativeElement,i=e.getBoundingClientRect();console.log("\u4f4d\u7f6e\u4fee\u6b63 lr:"+i.left+" "+i.right),e.style.left=i.left-(i.right-i.left)+"px"}adjustPositionRoot(){let e=this.rootElementRef.nativeElement;e.style.left=this.contextMenuService.position.x+"px",e.style.top=this.contextMenuService.position.y+"px";let i=e.getBoundingClientRect(),r=0,o=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+o&&(o+=window.innerHeight-(i.bottom+o)),i.top+o<0&&(o+=0-(i.top+o)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+o+"px"}adjustPositionSub(){let i=this.rootElementRef.nativeElement,r=this.elementRef.nativeElement.parentElement.getBoundingClientRect(),o=i.getBoundingClientRect(),s=0,a=0;window.innerWidth<o.right+s&&(s-=r.width+o.width,s+=8),o.left+s<0&&(s+=0-(o.left+s)),window.innerHeight<o.bottom+a&&(a+=window.innerHeight-(o.bottom+a)),o.top+a<0&&(a+=0-(o.top+a)),i.style.left=i.offsetLeft+s+"px",i.style.top=i.offsetTop+a+"px"}indexAction(e,i){Qe.trigger("JUMP_INDEX",{lineNo:e,targetId:i})}doAction(e){this.showSubMenu(e),null!=e.action&&(e.action(),this.close())}showSubMenu(e){this.hideSubMenu(),clearTimeout(this.showSubMenuTimer),!(null==e.subActions||e.subActions.length<1)&&(this.showSubMenuTimer=setTimeout(()=>{this.parentMenu=e,this.subMenu=e.subActions,clearTimeout(this.hideSubMenuTimer)},250))}hideSubMenu(){clearTimeout(this.hideSubMenuTimer),this.hideSubMenuTimer=setTimeout(()=>{this.subMenu=null},1200)}close(){this.contextMenuService&&this.contextMenuService.close()}}return n.\u0275fac=function(e){return new(e||n)(Be(fi),Be(To),Be(Di))},n.\u0275cmp=Qt({type:n,selectors:[["context-menu"]],viewQuery:function(e,i){if(1&e&&Gn(jW,7),2&e){let r;yn(r=Cn())&&(i.rootElementRef=r.first)}},hostBindings:function(e,i){1&e&&Re("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{title:"title",actions:"actions",isSubmenu:"isSubmenu"},decls:17,vars:11,consts:[[1,"component",3,"ngClass","mouseleave"],["root",""],["class","title",4,"ngIf"],[2,"display","flex","align-items","top"],["class","altitude ruler","style","display: flex; align-self: stretch; flex-direction: column; align-content: center",4,"ngIf"],["class","altitude",4,"ngIf"],[2,"flex-grow","1"],[4,"ngIf"],["indexMenu",""],["actionMenu",""],["separator",""],[1,"title"],[1,"altitude","ruler",2,"display","flex","align-self","stretch","flex-direction","column","align-content","center"],[2,"margin-top","2em"],[2,"align-self","center","margin-top","auto","margin-bottom","auto"],[2,"margin-bottom","2em"],[1,"altitude"],["type","range","max","12","min","-12","step","0.5","orient","vertical",1,"altitude",3,"title","ngModel","ngModelChange"],["altitudeSlider",""],["style","font-size: small;",4,"ngIf"],[2,"font-size","small"],["type","number","step","0.1",2,"font-size","small","width","3.6em","text-align","right",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"hasHighlight",3,"click"],[1,"menu-title"],[1,"hasHighlight",3,"click","mouseenter"],["type","checkbox","checked","",3,"disabled",4,"ngIf"],["type","checkbox",3,"disabled",4,"ngIf"],["type","radio","checked","",3,"disabled",4,"ngIf"],["type","radio",3,"disabled",4,"ngIf"],["class","sub-menu-arrow",4,"ngIf"],[3,"title","actions","isSubmenu",4,"ngIf"],["type","checkbox","checked","",3,"disabled"],["type","checkbox",3,"disabled"],["type","radio","checked","",3,"disabled"],["type","radio",3,"disabled"],[1,"sub-menu-arrow"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[3,"title","actions","isSubmenu"],[1,"separator"]],template:function(e,i){1&e&&(J(0,"div",0,1),Re("mouseleave",function(){return i.hideSubMenu()}),Ee(2,GW,2,1,"div",2),J(3,"div",3),Ee(4,qW,7,0,"div",4),Ee(5,WW,3,2,"div",5),J(6,"div",6),Ee(7,YW,3,5,"div",7),J(8,"ul"),Ee(9,QW,2,1,"ng-container",7),Ee(10,tZ,2,1,"ng-container",7),oe()()()(),Ee(11,nZ,3,2,"ng-template",null,8,Ln),Ee(13,cZ,9,7,"ng-template",null,9,Ln),Ee(15,uZ,2,0,"ng-template",null,10,Ln)),2&e&&(ie("ngClass",Wo(7,dZ,i.isSubmenu,!i.isSubmenu,i.isPointerDragging)),j(2),ie("ngIf",0<i.title.length),j(2),ie("ngIf",i.altitudeHande),j(1),ie("ngIf",i.altitudeHande),j(2),ie("ngIf",i.altitudeHande),j(2),ie("ngIf","\u30a4\u30f3\u30c7\u30c3\u30af\u30b9"!=i.title),j(1),ie("ngIf","\u30a4\u30f3\u30c7\u30c3\u30af\u30b9"==i.title))},directives:[ir,Sn,oa,Fi,Ti,yi,ms,si,Ra,n],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;padding:0;white-space:nowrap;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;z-index:9900}.submenu-panel[_ngcontent-%COMP%]{position:absolute;left:calc(100% - 4px);top:-16px}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-max-limit[_ngcontent-%COMP%]{max-height:100%;max-width:100%}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em;font-size:12px;text-align:center;padding:4px 16px;margin:0 2px;color:#444;border-bottom:1px solid #AAA}.menu-title[_ngcontent-%COMP%]{display:inline-block}td.altitude[_ngcontent-%COMP%]{vertical-align:middle;height:100%}input.altitude[_ngcontent-%COMP%]{writing-mode:bt-lr;-webkit-appearance:slider-vertical;appearance:slider-vertical;width:8px;height:200px;padding:3px}.disabled[_ngcontent-%COMP%]   .menu-title[_ngcontent-%COMP%], .disabled[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:gray}.altitude-view[_ngcontent-%COMP%]{color:#000;vertical-align:top;width:3em;text-align:right}.ruler[_ngcontent-%COMP%]{color:#444;font-size:small;padding-left:4px;padding-right:2px}hr.separator[_ngcontent-%COMP%]{margin:.1em -12px;height:1px;border:0;background-color:#aaa}.sub-menu-arrow[_ngcontent-%COMP%]{display:inline-block;position:absolute;top:2px;bottom:0;right:1px}ul[_ngcontent-%COMP%]{list-style:none;padding:2px 0;margin:0}ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:2px 20px;font-size:12px;color:#444}ul[_ngcontent-%COMP%] > li.hasHighlight[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}"]}),n})();function hZ(n,t){1&n&&(J(0,"div"),we(1,"\u672a\u8a2d\u5b9a"),oe())}function pZ(n,t){if(1&n&&(J(0,"div"),we(1),oe()),2&n){const e=$e().$implicit;j(1),xt(e)}}function gZ(n,t){if(1&n){const e=pt();J(0,"label")(1,"input",11),Re("ngModelChange",function(r){return Le(e),$e().selectTag=r})("change",function(){return Le(e),$e().resetBtn()}),oe(),Ee(2,hZ,2,0,"div",12),Ee(3,pZ,2,1,"div",12),oe()}if(2&n){const e=t.$implicit,i=$e();j(1),Ht("value",e),ie("ngModel",i.selectTag),j(1),ie("ngIf",0==e.length),j(1),ie("ngIf",e.length>0)}}function _Z(n,t){if(1&n){const e=pt();J(0,"img",18),Re("click",function(){Le(e);const r=$e().$implicit;return $e().onSelectedFile(r)}),At(1,"safe"),oe()}if(2&n){const e=$e().$implicit;ie("src",Ft(1,2,e.url,"resourceUrl"),hn)("alt",e.name)}}function mZ(n,t){1&n&&it(0,"img",19),2&n&&Ht("alt",$e().$implicit.name)}function $Z(n,t){if(1&n){const e=pt();J(0,"input",20),Re("change",function(){Le(e);const r=$e().$implicit;return $e().onChange(r.identifier)}),oe()}if(2&n){const e=$e().$implicit,i=$e();tp("id","",e.identifier,"_",i.initTimestamp,"")}}function vZ(n,t){if(1&n){const e=pt();J(0,"span",13)(1,"div",14),Re("click",function(){const o=Le(e).$implicit;return $e().imgBlockClick(o.identifier)}),Ee(2,_Z,2,5,"img",15),Ee(3,mZ,1,1,"img",16),Ee(4,$Z,1,2,"input",17),oe()()}if(2&n){const e=t.$implicit;j(2),ie("ngIf",0<e.url.length),j(1),ie("ngIf",e.url.length<=0),j(1),ie("ngIf",0<e.url.length)}}let bZ=(()=>{class n{constructor(e,i){this.changeDetector=e,this.panelService=i,this.initTimestamp=0,this.searchWord="",this.selectedFile=null,this.fileStorageService=St.instance,this.selectTag="",this.newTagName="",this.initTimestamp=Date.now()}get searchWords(){return this._searchWord!==this.searchWord&&(this._searchWord=this.searchWord,this._searchWords=null!=this.searchWord&&0<this.searchWord.trim().length?this.searchWord.trim().split(/\s+/):[]),this._searchWords}getAllImage(){let e=[];for(let i of this.fileStorageService.images){let r=i.context.identifier,o="";rn.get(r)&&(o=rn.get(r).tag),"\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04"!=o&&e.push(i)}return e}get images(){let e=[];if("\u5168\u3066"==this.selectTag)return this.getAllImage();for(let i of this.fileStorageService.images){let r=i.context.identifier;rn.get(r)?rn.get(r).tag==this.selectTag&&e.push(i):""==this.selectTag&&e.push(i)}return e}get isSelected(){return null!=this.selectedFile}get selectedImageTag(){return this.isSelected?rn.get(this.selectedFile.identifier)||rn.create(this.selectedFile.identifier):null}get tagList(){let e=[];for(let r of this.fileStorageService.images){let s=rn.get(r.context.identifier);s&&s.tag&&"\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04"!=s.tag&&e.push(s.tag)}let i=Array.from(new Set(e));return i.unshift("\u5168\u3066"),i.unshift(""),i}inputNewTag(e){this.newTagName=e}changeTag(){if("\u5168\u3066"==this.newTagName||"\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04"==this.newTagName)return;let e=this.images;console.log("this.newTagName"+this.newTagName);for(let i of e){let r=document.getElementById(i.context.identifier+"_"+this.initTimestamp);if(r&&r.checked){let o=rn.get(i.context.identifier);o=o||rn.create(i.context.identifier),o.tag="\u672a\u8a2d\u5b9a"==this.newTagName?"":this.newTagName}}}resetBtn(){}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7")}ngAfterViewInit(){Qe.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){Qe.unregister(this)}handleFileSelect(e){let i=e.target,r=i.files;r.length&&Cl.instance.load(r),i.value=""}onSelectedFile(e){console.log("onSelectedFile",e),Qe.call("SELECT_FILE",{fileIdentifier:e.identifier},bt.peerId),this.selectedFile=e}imgBlockClick(e){console.log("identifier:"+e);let i=document.getElementById(e+"_"+this.initTimestamp);i.checked=!i.checked}onChange(e){this.imgBlockClick(e)}}return n.\u0275fac=function(e){return new(e||n)(Be(bi),Be($n))},n.\u0275cmp=Qt({type:n,selectors:[["file-storage"]],decls:23,vars:2,consts:[[1,"image-chg"],[4,"ngFor","ngForOf"],[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","image/*",2,"display","none",3,"change"],[1,"sticky-top"],[3,"click"],["maxlength","12","placeholder","\u65b0\u30bf\u30b0\u540d",1,"input","is-caret",3,"input"],["id","file-list"],["class","image_",4,"ngFor","ngForOf"],["name","image-chg","type","radio",3,"value","ngModel","ngModelChange","change"],[4,"ngIf"],[1,"image_"],[1,"img-box",2,"float","left",3,"click"],["height","120",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif",3,"alt",4,"ngIf"],["class","img-chk","name","tag_chg_chk","type","checkbox",3,"id","change",4,"ngIf"],["height","120",3,"src","alt","click"],["src","assets/images/loading.gif",3,"alt"],["name","tag_chg_chk","type","checkbox",1,"img-chk",3,"id","change"]],template:function(e,i){1&e&&(J(0,"form")(1,"div",0),Ee(2,gZ,4,4,"label",1),oe()(),J(3,"label")(4,"div",2)(5,"div")(6,"i",3),we(7,"add_photo_alternate"),oe()(),J(8,"div"),we(9,"\u3053\u3053\u306b\u753b\u50cf\u3092\u30c9\u30ed\u30c3\u30d7"),oe(),J(10,"div",4),we(11,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),oe(),J(12,"input",5),Re("change",function(o){return i.handleFileSelect(o)}),oe(),J(13,"div",4),it(14,"br"),we(15,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d2MB\u307e\u3067"),oe()()(),J(16,"div",6)(17,"div")(18,"button",7),Re("click",function(){return i.changeTag()}),we(19,"\u30bf\u30b0\u3092\u5909\u66f4"),oe(),J(20,"input",8),Re("input",function(o){return i.inputNewTag(o.target.value)}),oe()()(),J(21,"div",9),Ee(22,vZ,5,3,"span",10),oe()),2&e&&(j(2),ie("ngForOf",i.tagList),j(20),ie("ngForOf",i.images))},directives:[_s,gs,xo,si,Qu,Fi,Ti,yi,Sn],pipes:[Ii],styles:['[_nghost-%COMP%]{display:block}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer;margin-bottom:5px}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.image[_ngcontent-%COMP%]{font-size:0;display:inline-block;padding:2px;border:transparent 2px solid;border-top:transparent 6px solid}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom}.img-chk[_ngcontent-%COMP%]{height:1em;margin-left:0}.img-box[_ngcontent-%COMP%]{border:2px dotted #666}.selected[_ngcontent-%COMP%]{border:2px dotted #666;border-top:6px solid #444}.sticky-top[_ngcontent-%COMP%]{padding:5px;position:sticky;top:0;background-color:#f0dabdcc;border-top:1px dotted #666;border-bottom:1px dotted #666}.sticky-top[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:calc(100% - 75px)}.image-chg[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.image-chg[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.image-chg[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.image-chg[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer}.image-chg[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.image-chg[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}'],changeDetection:0}),n})();function yZ(n,t){1&n&&(J(0,"div"),we(1,"\u672a\u8a2d\u5b9a"),oe())}function CZ(n,t){if(1&n&&(J(0,"div"),we(1),oe()),2&n){const e=$e().$implicit;j(1),xt(e)}}function xZ(n,t){if(1&n){const e=pt();J(0,"label")(1,"input",5),Re("ngModelChange",function(r){return Le(e),$e().selectTag=r})("change",function(){return Le(e),$e().resetBtn()}),oe(),Ee(2,yZ,2,0,"div",6),Ee(3,CZ,2,1,"div",6),oe()}if(2&n){const e=t.$implicit,i=$e();j(1),Ht("value",e),ie("ngModel",i.selectTag),j(1),ie("ngIf",0==e.length),j(1),ie("ngIf",e.length>0)}}function wZ(n,t){if(1&n){const e=pt();J(0,"span",7)(1,"button",8),Re("click",function(){Le(e);const r=$e();return r.onSelectedFile(r.empty)}),we(2,"\u753b\u50cf\u306a\u3057"),oe()()}}function EZ(n,t){if(1&n){const e=pt();J(0,"img",13),Re("click",function(){Le(e);const r=$e().$implicit;return $e().onSelectedFile(r)}),At(1,"safe"),oe()}if(2&n){const e=$e().$implicit;ie("src",Ft(1,2,e.url,"resourceUrl"),hn)("alt",e.name)}}function TZ(n,t){1&n&&it(0,"img",14),2&n&&Ht("alt",$e().$implicit.name)}function SZ(n,t){if(1&n&&(J(0,"span",9)(1,"div",10),Ee(2,EZ,2,5,"img",11),Ee(3,TZ,1,1,"img",12),oe()()),2&n){const e=t.$implicit;j(2),ie("ngIf",0<e.url.length),j(1),ie("ngIf",e.url.length<=0)}}let Hf=(()=>{class n{constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this.searchWord="",this.isAllowedEmpty=!1,this.selectedFile=null,this.selectTag="",this.fileStorageService=St.instance,this.identifierList=[],this.newTagName="",this.isAllowedEmpty=!(!this.modalService.option||!this.modalService.option.isAllowedEmpty)}get searchWords(){return this._searchWord!==this.searchWord&&(this._searchWord=this.searchWord,this._searchWords=null!=this.searchWord&&0<this.searchWord.trim().length?this.searchWord.trim().split(/\s+/):[]),this._searchWords}getAllImage(){let e=[];for(let i of this.fileStorageService.images){let r=i.context.identifier,o="";rn.get(r)&&(o=rn.get(r).tag),"\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04"!=o&&e.push(i)}return e}get images(){let e=[];if("\u5168\u3066"==this.selectTag)return this.getAllImage();for(let i of this.fileStorageService.images){let r=i.context.identifier;if(rn.get(r)){let o=rn.get(r).tag;this.selectTag==o&&e.push(i)}else""==this.selectTag&&e.push(i)}return e}get isSelected(){return null!=this.selectedFile}get selectedImageTag(){return this.isSelected?rn.get(this.selectedFile.identifier)||rn.create(this.selectedFile.identifier):null}get tagList(){let e=[];for(let r of this.fileStorageService.images){let s=rn.get(r.context.identifier);s&&s.tag&&"\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04"!=s.tag&&e.push(s.tag)}let i=Array.from(new Set(e));return i.unshift("\u5168\u3066"),i.unshift(""),i}resetBtn(){}onChange(e,i){rn.get(e)||rn.create(e),i?this.identifierList.indexOf(e)<0&&this.identifierList.push(e):this.identifierList.indexOf(e)>-1&&this.identifierList.splice(this.identifierList.indexOf(e),1)}get empty(){return Bt.Empty}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7")}ngAfterViewInit(){Qe.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){Qe.unregister(this)}onSelectedFile(e){Qe.call("SELECT_FILE",{fileIdentifier:e.identifier},bt.peerId),this.modalService.resolve(e.identifier)}}return n.\u0275fac=function(e){return new(e||n)(Be(bi),Be($n),Be(pi))},n.\u0275cmp=Qt({type:n,selectors:[["file-selector"]],inputs:{isAllowedEmpty:"isAllowedEmpty"},decls:6,vars:3,consts:[[1,"image-chg"],[4,"ngFor","ngForOf"],["id","file-list"],["class","empty",4,"ngIf"],["class","image",4,"ngFor","ngForOf"],["name","image-chg","type","radio",3,"value","ngModel","ngModelChange","change"],[4,"ngIf"],[1,"empty"],[3,"click"],[1,"image"],[2,"float","left"],["height","120",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif",3,"alt",4,"ngIf"],["height","120",3,"src","alt","click"],["src","assets/images/loading.gif",3,"alt"]],template:function(e,i){1&e&&(J(0,"form")(1,"div",0),Ee(2,xZ,4,4,"label",1),oe()(),J(3,"div",2),Ee(4,wZ,3,0,"span",3),Ee(5,SZ,4,2,"span",4),oe()),2&e&&(j(2),ie("ngForOf",i.tagList),j(2),ie("ngIf",i.isAllowedEmpty),j(1),ie("ngForOf",i.images))},directives:[_s,gs,xo,si,Qu,Fi,Ti,yi,Sn],pipes:[Ii],styles:["[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{font-size:0}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom}.empty[_ngcontent-%COMP%]{line-height:120px;vertical-align:middle}.empty[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:100px}.sticky-top[_ngcontent-%COMP%]{padding:5px;position:sticky;top:0;background-color:#f0dabdcc;border-top:1px dotted #666;border-bottom:1px dotted #666}.sticky-top[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:calc(100% - 75px)}.image-chg[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.image-chg[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.image-chg[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.image-chg[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer}.image-chg[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.image-chg[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}"],changeDetection:0}),n})(),DZ=(()=>{class n{constructor(e,i,r){this.viewContainerRef=e,this.modalService=i,this.panelService=r,this.name="\u30b2\u30fc\u30e0\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",this.size=1,this.xml="",this.minSize=1,this.maxSize=20,this.tableBackgroundImage=Bt.createEmpty("null")}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30fc"),Qe.register(this).on("SELECT_FILE",e=>{console.log("SELECT_FILE GameCharacterGeneratorComponent "+e.data.fileIdentifier);let r=St.instance.get(e.data.fileIdentifier);r&&(this.tableBackgroundImage=r)})}ngAfterViewInit(){}ngOnDestroy(){Qe.unregister(this)}createGameCharacter(){Lt.create(this.name,this.size,this.tableBackgroundImage.identifier)}createGameTableMask(){let e=da.instance.viewTable;if(!e)return;let i=So.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);e.appendChild(i)}createGameCharacterForXML(e){er.instance.parseXml(e)}openModal(){this.modalService.open(Hf)}}return n.\u0275fac=function(e){return new(e||n)(Be(ds),Be(pi),Be($n))},n.\u0275cmp=Qt({type:n,selectors:[["game-character-generator"]],decls:15,vars:11,consts:[[3,"click"],["height","120",3,"src"],["placeholder","Name","name","name",3,"ngModel","ngModelChange"],["type","range","name","size",3,"ngModel","min","max","ngModelChange"],["type","number",3,"ngModel","min","max","ngModelChange"]],template:function(e,i){1&e&&(J(0,"button",0),Re("click",function(){return i.openModal()}),we(1,"\u753b\u50cf\u3092\u9078\u3076"),oe(),J(2,"div"),it(3,"img",1),At(4,"safe"),oe(),J(5,"input",2),Re("ngModelChange",function(o){return i.name=o}),oe(),J(6,"div")(7,"div")(8,"input",3),Re("ngModelChange",function(o){return i.size=o}),oe(),we(9," Size : "),J(10,"input",4),Re("ngModelChange",function(o){return i.size=o}),oe()(),J(11,"button",0),Re("click",function(){return i.createGameCharacter()}),we(12,"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u308b"),oe(),J(13,"button",0),Re("click",function(){return i.createGameTableMask()}),we(14,"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u308b"),oe()()),2&e&&(j(3),ie("src",Ft(4,8,i.tableBackgroundImage.url,"resourceUrl"),hn),j(2),ie("ngModel",i.name),j(3),Ht("min",i.minSize),Ht("max",i.maxSize),ie("ngModel",i.size),j(2),Ht("min",i.minSize),Ht("max",i.maxSize),ie("ngModel",i.size))},directives:[Fi,Ti,yi,oa,ms,Vc,Ju],pipes:[Ii],styles:[""]}),n})();function IZ(n,t){if(1&n&&(J(0,"ng-option",10),we(1),oe()),2&n){const e=t.$implicit;ie("value",e.identifier),j(1),sn("",e.name," ")}}function kZ(n,t){1&n&&(it(0,"img",11),At(1,"safe")),2&n&&ie("src",Ft(1,1,$e().imageFile.url,"resourceUrl"),hn)}let MZ=(()=>{class n{constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this.tabletopObject=null,this.shouldUpdateCharacterList=!0,this._gameCharacters=[]}get sendFrom(){return this._sendFrom}set sendFrom(e){this._sendFrom=e}get gameCharacters(){return this.shouldUpdateCharacterList&&(this.shouldUpdateCharacterList=!1,this._gameCharacters=Xe.instance.getObjects(Lt).filter(e=>this.allowsChat(e))),this._gameCharacters}allowsChat(e){return"table"===e.location.name&&!e.nonTalkFlag}get imageFile(){let e=Xe.instance.get(this._sendFrom);return e instanceof Lt&&St.instance.get(e.imageDataElement.children[0].value)||Bt.Empty}get selectCharacterTachieNum(){let e=Xe.instance.get(this._sendFrom);return e instanceof Lt?e.imageDataElement.children.length:0}importImages(){let e=Xe.instance.get(this._sendFrom);if(e instanceof Lt&&Lt){console.log(this.tabletopObject.name+"\u30a4\u30f3\u30dd\u30fc\u30c8\u5b9f\u884c"),console.log(e.name+"\u30a4\u30f3\u30dd\u30fc\u30c8\u5b9f\u884c");let o,i=this.tabletopObject.imageDataElement,r=e.imageDataElement;for(;i.children.length<r.children.length;)console.log("\u30a4\u30e1\u30fc\u30b8\u8ffd\u52a0"),i.appendChild(st.create("imageIdentifier","",{type:"image"},""));for(;i.children.length>r.children.length&&i.children.length>=2;)console.log("\u30a4\u30e1\u30fc\u30b8\u524a\u9664"),i.children[i.children.length-1].destroy();for(o=0;o<r.children.length;o++){let g=i.children[o],w=r.children[o];g.currentValue=w.currentValue,g.name=w.name,g.value=w.value}let a=i.parent.getElementsByName("ICON");a&&(a[0].value=i.children.length-1,a[0].currentValue>a[0].value&&(a[0].currentValue=a[0].value))}}cancel(){this.panelService.close()}ngOnInit(){this._sendFrom=this.gameCharacters.length>=1?this.gameCharacters[0].identifier:""}ngAfterViewInit(){}ngOnDestroy(){}}return n.\u0275fac=function(e){return new(e||n)(Be(bi),Be($n),Be(pi))},n.\u0275cmp=Qt({type:n,selectors:[["import-character-img"]],inputs:{tabletopObject:"tabletopObject"},decls:18,vars:5,consts:[[1,"table"],[1,"table-cell",2,"width","7em"],[2,"text-align","center"],[1,"table-cell"],[1,"ud-select","is-caret",2,"width","12em",3,"ngModel","clearable","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"table-cell","imagebox"],["class","image",3,"src",4,"ngIf"],[2,"width","9em",3,"click"],[2,"width","9em","margin-left","3em",3,"click"],[3,"value"],[1,"image",3,"src"]],template:function(e,i){1&e&&(J(0,"div",0)(1,"div",1)(2,"div",2),we(3," \u8907\u88fd\u5143\uff1e "),oe()(),J(4,"div",3)(5,"ng-select",4),Re("ngModelChange",function(o){return i.sendFrom=o}),Ee(6,IZ,2,2,"ng-option",5),oe()()(),J(7,"div",0)(8,"div",6),Ee(9,kZ,2,4,"img",7),oe(),J(10,"div",3),we(11),oe()(),it(12,"br"),J(13,"div",0)(14,"button",8),Re("click",function(){return i.importImages()}),we(15,"\u30a4\u30f3\u30dd\u30fc\u30c8\u5b9f\u884c"),oe(),J(16,"button",9),Re("click",function(){return i.cancel()}),we(17,"\u30ad\u30e3\u30f3\u30bb\u30eb"),oe()()),2&e&&(j(5),ie("ngModel",i.sendFrom)("clearable",!1),j(1),ie("ngForOf",i.gameCharacters),j(3),ie("ngIf",0<i.imageFile.url.length),j(2),sn(" \u767b\u9332\u679a\u6570:",i.selectCharacterTachieNum," "))},directives:[gp,Ti,yi,si,wf,Sn],pipes:[Ii],styles:[".flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table-cell[_ngcontent-%COMP%]{display:table-cell}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:100px;height:100px;max-width:50px;max-height:50px;vertical-align:top;text-align:center}.image[_ngcontent-%COMP%]{height:100%;vertical-align:bottom;object-fit:cover}input[_ngcontent-%COMP%]{width:5em}"],changeDetection:0}),n})();function AZ(n,t){1&n&&pn(0)}function PZ(n,t){if(1&n){const e=pt();Je(0),Ee(1,AZ,1,0,"ng-container",11),J(2,"select",12),Re("change",function(r){return Le(e),$e(4).setElementType(r.target.value)}),J(3,"option",13),we(4,"\u901a\u5e38"),oe(),J(5,"option",14),we(6,"\u30ea\u30bd\u30fc\u30b9"),oe(),J(7,"option",15),we(8,"Line\u30ea\u30bd\u30fc\u30b9"),oe(),J(9,"option",16),we(10,"\u30ce\u30fc\u30c8"),oe(),J(11,"option",17),we(12,"\u30c1\u30a7\u30c3\u30af/\u8868"),oe(),J(13,"option",18),we(14,"\u5358\u4e00\u30c1\u30a7\u30c3\u30af"),oe()(),et()}if(2&n){const e=$e(4),i=ln(2);j(1),ie("ngTemplateOutlet",i),j(1),ie("ngModel",e.gameDataElement.type)}}function FZ(n,t){1&n&&pn(0)}function RZ(n,t){if(1&n&&(Je(0),Ee(1,FZ,1,0,"ng-container",11),et()),2&n){$e(4);const e=ln(4);j(1),ie("ngTemplateOutlet",e)}}function NZ(n,t){1&n&&pn(0)}function OZ(n,t){if(1&n&&(Je(0),Ee(1,NZ,1,0,"ng-container",11),et()),2&n){$e(4);const e=ln(6);j(1),ie("ngTemplateOutlet",e)}}function BZ(n,t){if(1&n&&(J(0,"div",6),Ee(1,PZ,15,2,"ng-container",0),Ee(2,RZ,2,1,"ng-container",0),Ee(3,OZ,2,1,"ng-container",0),oe()),2&n){const e=$e(3);j(1),ie("ngIf",!e.isImage),j(1),ie("ngIf",e.isImage&&e.indexNum>=1),j(1),ie("ngIf",e.isImage&&e.indexNum<1)}}function LZ(n,t){if(1&n&&(Je(0),J(1,"div",19),we(2),oe(),et()),2&n){const e=$e(4);j(2),xt(e.name)}}function zZ(n,t){if(1&n&&(Je(0),Ee(1,LZ,3,1,"ng-container",0),et()),2&n){const e=$e(3);j(1),ie("ngIf",!e.isImage)}}function HZ(n,t){if(1&n){const e=pt();Je(0),J(1,"div",20),we(2),oe(),J(3,"input",21),Re("ngModelChange",function(r){return Le(e),$e(4).name=r}),oe(),et()}if(2&n){const e=$e(4);j(2),xt(e.name),j(1),ie("ngModel",e.name)}}function VZ(n,t){if(1&n&&(Je(0),Ee(1,HZ,4,2,"ng-container",0),et()),2&n){const e=$e(3);j(1),ie("ngIf",!e.isImage)}}function UZ(n,t){if(1&n){const e=pt();Je(0),J(1,"input",22),Re("ngModelChange",function(r){return Le(e),$e(3).currentValue=r}),At(2,"safe"),oe(),it(3,"br"),J(4,"input",23),Re("ngModelChange",function(r){return Le(e),$e(3).currentValue=r}),oe(),we(5," / "),J(6,"input",24),Re("ngModelChange",function(r){return Le(e),$e(3).value=r}),oe(),J(7,"span",19),we(8,"Step"),oe(),J(9,"input",25),Re("ngModelChange",function(r){return Le(e),$e(3).step=r}),oe(),et()}if(2&n){const e=$e(3);j(1),Qn(Ft(2,10,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),Ht("max",e.value),Ht("step",e.step),ie("ngModel",e.currentValue),j(3),Ht("step",e.step),ie("ngModel",e.currentValue),j(2),Ht("step",e.step),ie("ngModel",e.value),j(3),ie("ngModel",e.step)}}function jZ(n,t){if(1&n){const e=pt();Je(0),J(1,"input",22),Re("ngModelChange",function(r){return Le(e),$e(3).currentValue=r}),At(2,"safe"),oe(),it(3,"br"),J(4,"input",26),Re("ngModelChange",function(r){return Le(e),$e(3).currentValue=r}),oe(),we(5," / "),J(6,"input",27),Re("ngModelChange",function(r){return Le(e),$e(3).value=r}),oe(),J(7,"span",28),we(8,"Line"),oe(),J(9,"input",29),Re("ngModelChange",function(r){return Le(e),$e(3).currentLineValue=r}),oe(),we(10," / "),J(11,"input",30),Re("ngModelChange",function(r){return Le(e),$e(3).maxLineValue=r}),oe(),J(12,"span",19),we(13,"Step"),oe(),J(14,"input",25),Re("ngModelChange",function(r){return Le(e),$e(3).step=r}),oe(),et()}if(2&n){const e=$e(3);j(1),Qn(Ft(2,12,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),Ht("max",e.value),Ht("step",e.step),ie("ngModel",e.currentValue),j(3),Ht("step",e.step),ie("ngModel",e.currentValue),j(2),Ht("step",e.step),ie("ngModel",e.value),j(3),ie("ngModel",e.currentLineValue),j(2),ie("ngModel",e.maxLineValue),j(3),ie("ngModel",e.step)}}const GZ=function(){return{stripPrefix:!1}};function qZ(n,t){if(1&n){const e=pt();Je(0),J(1,"span",31),we(2," \xa0\xa0URL\u7de8\u96c6:"),J(3,"input",32),Re("change",function(){return Le(e),$e(3).changeChk()}),oe()(),J(4,"textarea",33),Re("ngModelChange",function(r){return Le(e),$e(3).value=r})("focus",function(){Le(e);const r=$e(3);return r.textFocus(r.gameDataElement.myIdentifer+"_elm")}),we(5,"          "),oe(),J(6,"div",34),it(7,"span",35),At(8,"linky"),oe(),et()}if(2&n){const e=$e(3);j(1),ie("hidden",!e.isUrlText(e.value)),j(2),Ht("id",e.gameDataElement.myIdentifer+"_elm"),j(1),ie("ngModel",e.value)("hidden",!e.isEditUrl(e.gameDataElement.myIdentifer+"_elm")&&e.isUrlText(e.gameDataElement.value)),j(2),ie("hidden",e.isEditUrl(e.gameDataElement.myIdentifer+"_elm")||!e.isUrlText(e.gameDataElement.value)),j(1),ie("innerHTML",Ft(8,6,e.escapeHtml(e.value),$r(9,GZ)),Lc)}}function WZ(n,t){if(1&n){const e=pt();Je(0),J(1,"span",36),we(2," \xa0\xa0\u5185\u5bb9\u7de8\u96c6:"),J(3,"input",32),Re("change",function(){return Le(e),$e(3).changeChk()}),oe()(),J(4,"textarea",37),Re("ngModelChange",function(r){return Le(e),$e(3).value=r})("focus",function(){Le(e);const r=$e(3);return r.textFocus(r.gameDataElement.myIdentifer+"_elm")}),we(5,"          "),oe(),J(6,"div",34),it(7,"div",38),oe(),et()}if(2&n){const e=$e(3);j(3),Ht("id",e.gameDataElement.myIdentifer+"_elm"),j(1),ie("ngModel",e.value)("hidden",!e.isEditMarkDown(e.gameDataElement.myIdentifer+"_elm")),j(2),ie("hidden",e.isEditMarkDown(e.gameDataElement.myIdentifer+"_elm")),j(1),ie("innerHTML",e.escapeHtmlMarkDown(e.gameDataElement.value,e.gameDataElement.myIdentifer),Lc)}}function ZZ(n,t){if(1&n){const e=pt();J(0,"input",41),Re("click",function(){return Le(e),$e(4).gameDataElement.value=0}),oe()}}function YZ(n,t){if(1&n){const e=pt();J(0,"input",42),Re("click",function(){return Le(e),$e(4).gameDataElement.value=1}),oe()}}function KZ(n,t){if(1&n&&(Je(0),Ee(1,ZZ,1,0,"input",39),Ee(2,YZ,1,0,"input",40),et()),2&n){const e=$e(3);j(1),ie("ngIf",0!=e.gameDataElement.value),j(1),ie("ngIf",0==e.gameDataElement.value)}}function XZ(n,t){if(1&n){const e=pt();Je(0),J(1,"div",43),we(2),oe(),J(3,"input",44),Re("ngModelChange",function(r){return Le(e),$e(4).value=r}),oe(),et()}if(2&n){const e=$e(4);j(2),xt(e.value),j(1),ie("ngModel",e.value)}}function QZ(n,t){if(1&n&&(it(0,"img",51),At(1,"safe")),2&n){const e=$e(5);ie("src",Ft(1,2,e.imageFileUrl,"resourceUrl"),hn)("alt",e.gameDataElement.value)}}function JZ(n,t){if(1&n){const e=pt();Je(0),J(1,"div",45)(2,"div",46),Ee(3,QZ,2,5,"img",47),oe(),J(4,"div",48)(5,"span"),we(6),oe(),J(7,"input",49),Re("ngModelChange",function(r){return Le(e),$e(4).currentValue=r}),oe(),J(8,"button",50),Re("click",function(){return Le(e),$e(4).openModal("imageIdentifier",!0)}),we(9,"\u753b\u50cf\u5909\u66f4"),oe()()(),et()}if(2&n){const e=$e(4);j(3),ie("ngIf",e.imageFileUrl),j(3),sn("\u7acb\u3061\u7d75\u756a\u53f7",e.indexNum,": "),j(1),ie("ngModel",e.currentValue)}}function eY(n,t){if(1&n&&(Je(0),Ee(1,XZ,4,2,"ng-container",0),Ee(2,JZ,10,3,"ng-container",0),et()),2&n){const e=$e(3);j(1),ie("ngIf",!e.isImage),j(1),ie("ngIf",e.isImage)}}function tY(n,t){if(1&n&&(Je(0),Ee(1,BZ,4,3,"div",5),J(2,"div",6),Ee(3,zZ,2,1,"ng-container",0),Ee(4,VZ,2,1,"ng-container",0),oe(),J(5,"div",7),Je(6,8),Ee(7,UZ,10,13,"ng-container",9),Ee(8,jZ,15,15,"ng-container",9),Ee(9,qZ,9,10,"ng-container",9),Ee(10,WZ,8,5,"ng-container",9),Ee(11,KZ,3,2,"ng-container",9),Ee(12,eY,3,2,"ng-container",10),et(),oe(),et()),2&n){const e=$e(2);j(1),ie("ngIf",e.isEdit),j(2),ie("ngIf",e.isTagLocked),j(1),ie("ngIf",!e.isTagLocked),j(2),ie("ngSwitch",e.gameDataElement.type),j(1),ie("ngSwitchCase","numberResource"),j(1),ie("ngSwitchCase","lineResource"),j(1),ie("ngSwitchCase","note"),j(1),ie("ngSwitchCase","markdown"),j(1),ie("ngSwitchCase","check")}}function nY(n,t){1&n&&pn(0)}function iY(n,t){if(1&n&&(Je(0),Ee(1,nY,1,0,"ng-container",11),et()),2&n){$e(4);const e=ln(8);j(1),ie("ngTemplateOutlet",e)}}function rY(n,t){1&n&&pn(0)}function oY(n,t){if(1&n&&(Je(0),Ee(1,rY,1,0,"ng-container",11),et()),2&n){$e(4);const e=ln(2);j(1),ie("ngTemplateOutlet",e)}}function sY(n,t){if(1&n&&(J(0,"div",57),Ee(1,iY,2,1,"ng-container",0),Ee(2,oY,2,1,"ng-container",0),oe()),2&n){const e=$e(3);j(1),ie("ngIf",e.isImage),j(1),ie("ngIf",!e.isImage)}}function aY(n,t){if(1&n&&(Je(0),J(1,"div",58),we(2),oe(),et()),2&n){const e=$e(3);j(2),xt(e.name)}}function lY(n,t){if(1&n){const e=pt();Je(0),J(1,"input",59),Re("ngModelChange",function(r){return Le(e),$e(3).name=r}),oe(),et()}if(2&n){const e=$e(3);j(1),ie("ngModel",e.name)}}function cY(n,t){if(1&n&&it(0,"div",62),2&n){const e=t.$implicit,i=t.index,r=$e(4);ie("gameDataElement",e)("isEdit",r.isEdit)("isTagLocked",r.isTagLocked)("isImage",r.isImage)("indexNum",i)}}function uY(n,t){if(1&n&&(J(0,"div",60),Ee(1,cY,1,5,"div",61),oe()),2&n){const e=$e(3);j(1),ie("ngForOf",e.gameDataElement.children)}}function dY(n,t){if(1&n&&(Je(0),Ee(1,sY,3,2,"div",52),it(2,"div",53),J(3,"div",54)(4,"div",55),Ee(5,aY,3,1,"ng-container",0),Ee(6,lY,2,1,"ng-container",0),oe(),Ee(7,uY,2,1,"div",56),oe(),et()),2&n){const e=$e(2);j(1),ie("ngIf",e.isEdit),j(4),ie("ngIf",e.isTagLocked),j(1),ie("ngIf",!e.isTagLocked),j(1),ie("ngIf",0<e.gameDataElement.children.length)}}function fY(n,t){if(1&n&&(Je(0),Ee(1,tY,13,9,"ng-container",0),Ee(2,dY,8,4,"ng-container",0),et()),2&n){const e=$e();j(1),ie("ngIf",e.gameDataElement.children.length<1),j(1),ie("ngIf",0<e.gameDataElement.children.length)}}function hY(n,t){if(1&n){const e=pt();J(0,"button",63),Re("click",function(){return Le(e),$e().addElement()}),J(1,"i",64),we(2,"add_circle"),oe()(),J(3,"button",63),Re("click",function(){return Le(e),$e().upElement()}),J(4,"i",64),we(5,"arrow_upward"),oe()(),it(6,"br"),J(7,"button",63),Re("click",function(){return Le(e),$e().deleteElement()}),J(8,"i",64),we(9,"remove_circle_outline"),oe()(),J(10,"button",63),Re("click",function(){return Le(e),$e().downElement()}),J(11,"i",64),we(12,"arrow_downward"),oe()()}}function pY(n,t){if(1&n){const e=pt();J(0,"button",65)(1,"i",64),we(2,"remove_circle_outline"),oe()(),J(3,"button",63),Re("click",function(){return Le(e),$e().upElement()}),J(4,"i",64),we(5,"arrow_upward"),oe()(),it(6,"br"),J(7,"button",63),Re("click",function(){return Le(e),$e().deleteImageElement()}),J(8,"i",64),we(9,"remove_circle_outline"),oe()(),J(10,"button",63),Re("click",function(){return Le(e),$e().downElement()}),J(11,"i",64),we(12,"arrow_downward"),oe()()}}function gY(n,t){if(1&n){const e=pt();J(0,"button",65)(1,"i",64),we(2,"remove_circle_outline"),oe()(),J(3,"button",63),Re("click",function(){return Le(e),$e().upElement()}),J(4,"i",64),we(5,"arrow_upward"),oe()(),it(6,"br"),J(7,"button",65)(8,"i",64),we(9,"remove_circle_outline"),oe()(),J(10,"button",63),Re("click",function(){return Le(e),$e().downElement()}),J(11,"i",64),we(12,"arrow_downward"),oe()()}}function _Y(n,t){if(1&n){const e=pt();J(0,"button",63),Re("click",function(){return Le(e),$e().addImageElement()}),J(1,"i",64),we(2,"add_circle"),oe()()}}let mY=(()=>{class n{constructor(e,i,r,o){this.panelService=e,this.modalService=i,this.changeDetector=r,this.domSanitizer=o,this.gameDataElement=null,this.isEdit=!1,this.isTagLocked=!1,this.isValueLocked=!1,this.isImage=!1,this.indexNum=0,this._name="",this._value=0,this._currentValue=0,this._step=1,this._currentLineValue=0,this._maxLineValue=0,this.updateTimer=null}get name(){return this._name}set name(e){this._name=e,this.setUpdateTimer()}get value(){return this._value}set value(e){this._value=e,this.setUpdateTimer()}get currentValue(){return this._currentValue}set currentValue(e){this._currentValue=e,this.setUpdateTimer()}get step(){return this._step}set step(e){this._step=e,this.setUpdateTimer()}get currentLineValue(){return this._currentLineValue}set currentLineValue(e){this._currentLineValue=e,this.setUpdateTimer()}get maxLineValue(){return this._maxLineValue}set maxLineValue(e){this._maxLineValue=e,this.setUpdateTimer()}ngOnInit(){this.gameDataElement&&this.setValues(this.gameDataElement),Qe.register(this).on("UPDATE_GAME_OBJECT",e=>{this.gameDataElement&&e.data.identifier===this.gameDataElement.identifier&&(this.setValues(this.gameDataElement),this.changeDetector.markForCheck())}).on("DELETE_GAME_OBJECT",e=>{this.gameDataElement&&this.gameDataElement.identifier===e.data.identifier&&this.changeDetector.markForCheck()})}ngOnDestroy(){Qe.unregister(this)}ngAfterViewInit(){}get imageFileUrl(){let e=St.instance.get(this.gameDataElement.value);return e?e.url:""}openModal(e="",i=!1){this.modalService.open(Hf,{isAllowedEmpty:i}).then(r=>{if(!r)return;let o=this.gameDataElement;!o||(o.value=r)})}updateKomaIconMaxValue(e){let i=e.getFirstElementByName("image"),r=e.getElementsByName("ICON");r&&(r[0].value=i.children.length-1,r[0].currentValue>r[0].value&&(r[0].currentValue=r[0].value))}addImageElement(){this.gameDataElement.appendChild(st.create("imageIdentifier","",{type:"image"})),this.updateKomaIconMaxValue(this.gameDataElement.parent)}addElement(){this.gameDataElement.appendChild(st.create("\u30bf\u30b0","",{}))}deleteElement(){this.gameDataElement.destroy()}deleteImageElement(){const e=this.gameDataElement.parent.parent;this.gameDataElement.parent.children[0]!=this.gameDataElement&&(this.gameDataElement.destroy(),this.updateKomaIconMaxValue(e))}upElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);0<i&&e.insertBefore(this.gameDataElement,e.children[i-1])}downElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);i<e.children.length-1&&e.insertBefore(this.gameDataElement,i<e.children.length-2?e.children[i+2]:null)}setElementType(e){this.gameDataElement.setAttribute("type",e)}setValues(e){this._name=e.name,this._currentValue=e.currentValue,this._value=e.value,this._step=e.step,this._currentLineValue=e.currentLineValue,this._maxLineValue=e.maxLineValue}setUpdateTimer(){clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>{this.gameDataElement.name!==this.name&&(this.gameDataElement.name=this.name),this.gameDataElement.currentValue!==this.currentValue&&(this.gameDataElement.currentValue=this.currentValue),this.gameDataElement.value!==this.value&&(this.gameDataElement.value=this.value),this.gameDataElement.step!==this.step&&(this.gameDataElement.step=this.step),this.gameDataElement.currentLineValue!==this.currentLineValue&&(this.gameDataElement.currentLineValue=this.currentLineValue),this.gameDataElement.maxLineValue!==this.maxLineValue&&(this.gameDataElement.maxLineValue=this.maxLineValue),this.updateTimer=null},66)}escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}clickMarkDownBox(e){console.log("\u30de\u30fc\u30af\u30c0\u30a6\u30f3\u30af\u30ea\u30c3\u30af:"+e)}get markdown(){return Xe.instance.get("markdwon")}escapeHtmlMarkDown(e,i){let r=this.markdown.markDownCheckBox(e,i),o=this.markdown.markDownTable(r);return this.domSanitizer.bypassSecurityTrustHtml("<div>"+o+"</div>")}click(e){this.markdown&&(console.log("event.timeStamp:"+e.timeStamp),this.markdown.changeMarkDownCheckBox(e.target.id,e.timeStamp))}isEditLineTrigger(e){let i=document.getElementById(e);return!!i&&i.checked}isEditMarkDown(e){let i=document.getElementById(e);return!!i&&i.checked}isEditUrl(e){let i=document.getElementById(e);return!!i&&i.checked}isUrlText(e){return!(!e.match(/^https:\/\//)&&!e.match(/^http:\/\//))}changeChk(){}textFocus(e){document.getElementById(e).checked=!0}}return n.\u0275fac=function(e){return new(e||n)(Be($n),Be(pi),Be(bi),Be(Q1))},n.\u0275cmp=Qt({type:n,selectors:[["game-data-element"],["","game-data-element",""]],hostBindings:function(e,i){1&e&&Re("click",function(o){return i.click(o)})},inputs:{gameDataElement:"gameDataElement",isEdit:"isEdit",isTagLocked:"isTagLocked",isValueLocked:"isValueLocked",isImage:"isImage",indexNum:"indexNum"},decls:9,vars:1,consts:[[4,"ngIf"],["editButtons",""],["editButtonsImageTop",""],["editButtonsImageMiddle",""],["editButtonsImageTitle",""],["class","table-cell table-cell_solid",4,"ngIf"],[1,"table-cell","table-cell_solid"],[1,"table-cell"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngTemplateOutlet"],[3,"ngModel","change"],["value",""],["value","numberResource"],["value","lineResource"],["value","note"],["value","markdown"],["value","check"],[2,"font-family","Cambria, Georgia","font-size","0.9rem"],[1,"hidden-spacer",2,"font-family","Cambria, Georgia","font-size","0.9rem"],["size","1","placeholder","Value",1,"is-caret",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","0.9rem",3,"ngModel","ngModelChange"],["type","range","min","0",3,"ngModel","max","step","ngModelChange"],["size","1","type","number","placeholder","Value",1,"is-caret",2,"width","5em","text-align","right",3,"ngModel","step","ngModelChange"],["size","1","type","number","placeholder","Value",1,"is-caret",2,"width","5em",3,"ngModel","step","ngModelChange"],["size","1","type","number","min","1","placeholder","1",1,"is-caret",2,"width","3em","text-align","right",3,"ngModel","ngModelChange"],["size","1","type","number","placeholder","Value",1,"is-caret",2,"width","3.5em","text-align","right",3,"ngModel","step","ngModelChange"],["size","1","type","number","placeholder","Value",1,"is-caret",2,"width","3.5em",3,"ngModel","step","ngModelChange"],[2,"font-family","Cambria, Georgia","font-size","0.9rem","margin-right","0.5em"],["size","1","type","number","placeholder","Value",1,"is-caret",2,"width","3.5em","text-align","right",3,"ngModel","ngModelChange"],["size","1","type","number","value","1","placeholder","Value",1,"is-caret",2,"width","3.5em",3,"ngModel","ngModelChange"],[2,"font-size","0.8em",3,"hidden"],["type","checkbox",3,"id","change"],["placeholder","Note",1,"textarea-url","is-caret",2,"width","100%","height","5em","min-width","50px","resize","none","font-size","0.8em",3,"ngModel","hidden","ngModelChange","focus"],[2,"width","100%","max-width","200px","min-width","50px",3,"hidden"],[1,"textarea-url",2,"width","100%","min-width","50px","font-size","0.8em",3,"innerHTML"],[2,"font-size","0.8em"],["placeholder","Note",1,"textarea-markdown","is-caret",2,"width","100%","height","5em","min-width","50px","resize","none","font-size","0.8em",3,"ngModel","hidden","ngModelChange","focus"],[1,"textarea-markdown",2,"width","100%","min-width","50px","font-size","0.8em",3,"innerHTML"],["type","checkbox","checked","",3,"click",4,"ngIf"],["type","checkbox",3,"click",4,"ngIf"],["type","checkbox","checked","",3,"click"],["type","checkbox",3,"click"],[1,"hidden-spacer",2,"font-size","1.0em","font-family","Cambria, Georgia"],["size","1","placeholder","Value",1,"is-caret",2,"width","100%","min-width","10px",3,"ngModel","ngModelChange"],[1,"table-2"],[1,"table-cell-2","sub-image-box"],["class","sub-image",3,"src","alt",4,"ngIf"],[1,"table-cell-2","sub-table"],["size","1","placeholder","\u7acb\u3061\u7d75\u540d",1,"is-caret",2,"width","100%","min-width","10px",3,"ngModel","ngModelChange"],[1,"tachie-button",2,"font-size","1.0em",3,"click"],[1,"sub-image",3,"src","alt"],["class","table-cell table-cell_solid","style","vertical-align: top;",4,"ngIf"],[1,"table-cell","table-cell_inner-table",2,"padding","0","width","0"],[1,"table-cell_inner-table"],[1,"table-cell_inner-table-title"],["class","table",4,"ngIf"],[1,"table-cell","table-cell_solid",2,"vertical-align","top"],[2,"padding","2px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold"],["size","1","placeholder","Value",1,"is-caret",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold",3,"ngModel","ngModelChange"],[1,"table"],["game-data-element","","class","table-row",3,"gameDataElement","isEdit","isTagLocked","isImage","indexNum",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","isEdit","isTagLocked","isImage","indexNum"],[3,"click"],[1,"material-icons"],[1,"dummy",2,"visibility","hidden"]],template:function(e,i){1&e&&(Ee(0,fY,3,2,"ng-container",0),Ee(1,hY,13,0,"ng-template",null,1,Ln),Ee(3,pY,13,0,"ng-template",null,2,Ln),Ee(5,gY,13,0,"ng-template",null,3,Ln),Ee(7,_Y,3,0,"ng-template",null,4,Ln)),2&e&&ie("ngIf",i.gameDataElement)},directives:[Sn,Ra,nc,Ti,yi,ic,rc,Fi,tc,Wu,oa,ms,Vc,gf,si,n],pipes:[Ii,Rx],styles:[".tachie-button[_ngcontent-%COMP%]{background-color:#eee;color:#444;font-size:1em;margin:5px 0;padding:10px;box-sizing:border-box;width:6em}.tachie-button[_ngcontent-%COMP%]:hover{background-color:#ccc;color:#444}.sub-image[_ngcontent-%COMP%]{height:120px;display:inline-block;max-height:120px;vertical-align:top;text-align:center}.sub-image-box[_ngcontent-%COMP%]{width:120px;height:120px}.sub-table[_ngcontent-%COMP%]{width:calc(100% - 120px)}.table-cell-2[_ngcontent-%COMP%]{display:table-cell}.table-2[_ngcontent-%COMP%]{display:table;width:100%}.game-data-element[_ngcontent-%COMP%]{margin-left:10px}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{padding-top:10px;display:table-row;box-sizing:border-box}.table-cell[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.5em 0 .1em .5em;border-bottom:1px dotted #888;box-sizing:border-box}.table-cell_solid[_ngcontent-%COMP%]{width:10px;white-space:nowrap}.table-cell_inner-table[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.2em 0 .1em .5em;border:none;box-sizing:border-box}.table-cell_inner-table-title[_ngcontent-%COMP%]{border-bottom:1px solid #444;border-left:8px solid #444;padding-left:8px}.box[_ngcontent-%COMP%]{display:inline-block;margin:10px}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;max-width:20em;overflow:hidden;padding:0 3px;box-sizing:border-box}.textarea-url[_ngcontent-%COMP%], .textarea-markdown[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;padding:2px;box-sizing:border-box;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}input[_ngcontent-%COMP%], button[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}input[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:hover, select[_ngcontent-%COMP%]:hover{background:#EEE}input[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{background:#FFF}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}.table-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.5rem}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"],changeDetection:0}),n})();function $Y(n,t){1&n&&pn(0)}function vY(n,t){if(1&n){const e=pt();Je(0),J(1,"button",1),Re("click",function(){return Le(e),$e().openModal("front")}),we(2,"\u8868\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),oe(),J(3,"button",1),Re("click",function(){return Le(e),$e().openModal("back")}),we(4,"\u88cf\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),oe(),et()}}function bY(n,t){1&n&&pn(0)}function yY(n,t){if(1&n){const e=pt();Je(0),J(1,"button",1),Re("click",function(){return Le(e),$e().openModal("floor")}),we(2,"\u5e8a\u306e\u753b\u50cf\u3092\u5909\u66f4"),oe(),J(3,"button",1),Re("click",function(){return Le(e),$e().openModal("wall")}),we(4,"\u58c1\u306e\u753b\u50cf\u3092\u5909\u66f4"),oe(),et()}}function CY(n,t){if(1&n){const e=pt();Je(0),J(1,"button",7),Re("click",function(){Le(e);const r=$e();return r.openModal(r.tabletopObject.face)}),we(2,"\u30c0\u30a4\u30b9\u76ee\u306e\u753b\u50cf\u3092\u5909\u66f4"),oe(),et()}if(2&n){const e=$e();j(1),ie("disabled",!e.tabletopObject.isVisible)}}function xY(n,t){1&n&&pn(0)}function wY(n,t){1&n&&pn(0)}function EY(n,t){if(1&n){const e=pt();Je(0),J(1,"button",1),Re("click",function(){return Le(e),$e().openModal("imageIdentifier",!0)}),we(2,"\u753b\u50cf\u5909\u66f4"),oe(),et()}}function TY(n,t){if(1&n){const e=pt();Je(0),J(1,"div",8)(2,"div",9),we(3," \u30b3\u30de\u753b\u50cf\u306e\u9ad8\u3055\u3092\u6307\u5b9a "),J(4,"input",10),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.specifyKomaImageFlag=r})("click",function(){return Le(e),$e().clickImageFlag()}),oe(),J(5,"div"),we(6," \u30b3\u30de\u753b\u50cf\u306e\u9ad8\u3055 "),J(7,"input",11),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.komaImageHeignt=r}),At(8,"safe"),oe(),J(9,"input",12),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.komaImageHeignt=r})("change",function(r){return Le(e),$e().chkDiceKomaSize(r.target.value)}),oe()()()(),et()}if(2&n){const e=$e();j(4),ie("ngModel",e.tabletopObject.specifyKomaImageFlag),j(3),Qn(Ft(8,7,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:1;","style")),ie("ngModel",e.tabletopObject.komaImageHeignt)("disabled",!e.tabletopObject.specifyKomaImageFlag),j(2),ie("ngModel",e.tabletopObject.komaImageHeignt)("disabled",!e.tabletopObject.specifyKomaImageFlag)}}function SY(n,t){if(1&n){const e=pt();Je(0),J(1,"div",13)(2,"div"),we(3," \u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u6a2a\u5e45 "),J(4,"input",14),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.overViewWidth=r}),At(5,"safe"),oe(),J(6,"input",15),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.overViewWidth=r})("change",function(r){return Le(e),$e().chkPopWidth(r.target.value)}),oe()(),J(7,"div"),we(8," \u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u7e26\u5e45\u6700\u5927 "),J(9,"input",14),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.overViewMaxHeight=r}),At(10,"safe"),oe(),J(11,"input",15),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.overViewMaxHeight=r})("change",function(r){return Le(e),$e().chkPopMaxHeight(r.target.value)}),oe()()(),et()}if(2&n){const e=$e();j(4),Qn(Ft(5,8,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),ie("ngModel",e.tabletopObject.overViewWidth),j(2),ie("ngModel",e.tabletopObject.overViewWidth),j(3),Qn(Ft(10,11,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),ie("ngModel",e.tabletopObject.overViewMaxHeight),j(2),ie("ngModel",e.tabletopObject.overViewMaxHeight)}}function DY(n,t){if(1&n){const e=pt();Je(0),J(1,"div",13)(2,"div"),we(3," \u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u6a2a\u5e45 "),J(4,"input",14),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.overViewWidth=r}),At(5,"safe"),oe(),J(6,"input",15),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.overViewWidth=r})("change",function(r){return Le(e),$e().chkPopWidth(r.target.value)}),oe()(),J(7,"div"),we(8," \u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u7e26\u5e45\u6700\u5927 "),J(9,"input",14),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.overViewMaxHeight=r}),At(10,"safe"),oe(),J(11,"input",15),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.overViewMaxHeight=r})("change",function(r){return Le(e),$e().chkPopMaxHeight(r.target.value)}),oe()()(),et()}if(2&n){const e=$e();j(4),Qn(Ft(5,8,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),ie("ngModel",e.tabletopObject.overViewWidth),j(2),ie("ngModel",e.tabletopObject.overViewWidth),j(3),Qn(Ft(10,11,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),ie("ngModel",e.tabletopObject.overViewMaxHeight),j(2),ie("ngModel",e.tabletopObject.overViewMaxHeight)}}function IY(n,t){if(1&n){const e=pt();Je(0),J(1,"div",8),it(2,"div",16),J(3,"div",17),we(4," \u5e8a\u306b\u30b0\u30ea\u30c3\u30c9\u3092\u8868\u793a "),J(5,"input",18),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.isGrid=r})("click",function(){return Le(e),$e().clickGrid()}),oe(),it(6,"br"),oe()(),et()}if(2&n){const e=$e();j(5),ie("ngModel",e.tabletopObject.isGrid)}}function kY(n,t){if(1&n){const e=pt();J(0,"select",25),Re("change",function(r){return Le(e),$e(2).setLocation(r.target.value)}),J(1,"option",26),we(2,"\u30c6\u30fc\u30d6\u30eb"),oe(),J(3,"option",27),we(4,"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),oe(),J(5,"option",28),we(6,"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),oe(),J(7,"option",29),we(8,"\u5893\u5730"),oe()()}if(2&n){const e=$e(2);ie("ngModel",e.tabletopObject.location.name),j(5),Ht("value",e.networkService.peerId)}}function MY(n,t){if(1&n){const e=pt();Je(0),Ee(1,kY,9,2,"select",19),J(2,"div",8)(3,"div",9)(4,"div"),we(5," \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u975e\u8868\u793a "),J(6,"input",20),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.hideInventory=r})("click",function(){return Le(e),$e().clickHide()}),oe()(),J(7,"div"),we(8," \u767a\u8a00\u3092\u3057\u306a\u3044 "),J(9,"input",21),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.nonTalkFlag=r})("click",function(){return Le(e),$e().clickNoTalk()}),oe()(),J(10,"div"),we(11," \u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u6a2a\u5e45 "),J(12,"input",22),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.overViewWidth=r}),At(13,"safe"),oe(),J(14,"input",23),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.overViewWidth=r})("change",function(r){return Le(e),$e().chkPopWidth(r.target.value)}),oe()(),J(15,"div"),we(16," \u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u7e26\u5e45\u6700\u5927 "),J(17,"input",14),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.overViewMaxHeight=r}),At(18,"safe"),oe(),J(19,"input",24),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.overViewMaxHeight=r})("change",function(r){return Le(e),$e().chkPopMaxHeight(r.target.value)}),oe()()(),J(20,"div",9),we(21," \u30b3\u30de\u753b\u50cf\u306e\u9ad8\u3055\u3092\u6307\u5b9a "),J(22,"input",10),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.specifyKomaImageFlag=r})("click",function(){return Le(e),$e().clickImageFlag()}),oe(),J(23,"div"),we(24," \u30b3\u30de\u753b\u50cf\u306e\u9ad8\u3055 "),J(25,"input",11),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.komaImageHeignt=r}),At(26,"safe"),oe(),J(27,"input",12),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.komaImageHeignt=r})("change",function(r){return Le(e),$e().chkKomaSize(r.target.value)}),oe()()()(),et()}if(2&n){const e=$e();j(1),ie("ngIf",e.tabletopObject),j(5),ie("ngModel",e.tabletopObject.hideInventory),j(3),ie("ngModel",e.tabletopObject.nonTalkFlag),j(3),Qn(Ft(13,18,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),ie("ngModel",e.tabletopObject.overViewWidth),j(2),ie("ngModel",e.tabletopObject.overViewWidth),j(3),Qn(Ft(18,21,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),ie("ngModel",e.tabletopObject.overViewMaxHeight),j(2),ie("ngModel",e.tabletopObject.overViewMaxHeight),j(3),ie("ngModel",e.tabletopObject.specifyKomaImageFlag),j(3),Qn(Ft(26,24,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:1;","style")),ie("ngModel",e.tabletopObject.komaImageHeignt)("disabled",!e.tabletopObject.specifyKomaImageFlag),j(2),ie("ngModel",e.tabletopObject.komaImageHeignt)("disabled",!e.tabletopObject.specifyKomaImageFlag)}}function AY(n,t){if(1&n){const e=pt();Je(0),J(1,"div",13)(2,"div"),we(3," height\u8a2d\u5b9a\u5024\u306b\u9ad8\u3055\u3092\u5236\u9650 "),J(4,"input",30),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.limitHeight=r})("click",function(){return Le(e),$e().clickLimitHeight()}),oe()(),J(5,"div"),we(6," \u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u6a2a\u5e45 "),J(7,"input",14),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.overViewWidth=r}),At(8,"safe"),oe(),J(9,"input",15),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.overViewWidth=r})("change",function(r){return Le(e),$e().chkPopWidth(r.target.value)}),oe()(),J(10,"div"),we(11," \u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u7e26\u5e45\u6700\u5927 "),J(12,"input",14),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.overViewMaxHeight=r}),At(13,"safe"),oe(),J(14,"input",15),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.overViewMaxHeight=r})("change",function(r){return Le(e),$e().chkPopMaxHeight(r.target.value)}),oe()()(),et()}if(2&n){const e=$e();j(4),ie("ngModel",e.tabletopObject.limitHeight),j(3),Qn(Ft(8,9,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),ie("ngModel",e.tabletopObject.overViewWidth),j(2),ie("ngModel",e.tabletopObject.overViewWidth),j(3),Qn(Ft(13,12,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),ie("ngModel",e.tabletopObject.overViewMaxHeight),j(2),ie("ngModel",e.tabletopObject.overViewMaxHeight)}}function PY(n,t){if(1&n){const e=pt();Je(0),J(1,"div"),we(2," \u30ab\u30e9\u30fc "),J(3,"input",31),Re("change",function(r){return Le(e),$e().changeMaskFillColor(r.target.value)}),oe(),we(4," \u66f4\u65b0\u90e8\u30ab\u30e9\u30fc "),J(5,"input",32),Re("change",function(r){return Le(e),$e().changeMaskChangeColor(r.target.value)}),oe()(),it(6,"br"),we(7," \u203bwidth\u3001height\u9805\u76ee\u306f\u6700\u592750 "),et()}if(2&n){const e=$e();j(3),Ht("value",e.tabletopObject.color),j(2),Ht("value",e.tabletopObject.changeColor)}}function FY(n,t){if(1&n){const e=pt();J(0,"div"),we(1," \u56de\u8ee2\u89d2\u5ea6\u306e\u30b9\u30ca\u30c3\u30d7\u3092\u7d30\u304b\u304f\u3059\u308b:"),J(2,"input",38),Re("ngModelChange",function(r){return Le(e),$e(2).tabletopObject.subDivisionSnapPolygonal=r})("click",function(){return Le(e),$e(2).subDivisionSnapPolygonal()}),oe()()}if(2&n){const e=$e(2);j(2),ie("ngModel",e.tabletopObject.subDivisionSnapPolygonal)}}function RY(n,t){1&n&&(J(0,"div"),it(1,"br"),we(2," \u203b\u3053\u306e\u5f62\u72b6\u306fwidth\u9805\u76ee\u306f\u4e0d\u4f7f\u7528 "),oe())}function NY(n,t){if(1&n){const e=pt();Je(0),J(1,"div"),we(2," \u5883\u754c\u7dda "),J(3,"input",33),Re("change",function(r){return Le(e),$e().changeRangeColor(r.target.value)}),oe(),we(4," \u5857\u308a\u3064\u3076\u3057 "),J(5,"input",34),Re("change",function(r){return Le(e),$e().changeGridColor(r.target.value)}),oe()(),Ee(6,FY,3,1,"div",5),J(7,"div"),we(8," \u8f2a\u90ed\u306b\u6cbf\u3063\u3066\u5857\u308b:"),J(9,"input",35),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.fillOutLine=r})("click",function(){return Le(e),$e().fillOutLine()}),oe(),it(10,"br"),we(11," \u30b9\u30af\u30a8\u30a2\u306e\u5857\u308a\u3092\u534a\u30de\u30b9\u305a\u3089\u305a \u6a2a:"),J(12,"input",36),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.offSetX=r})("click",function(){return Le(e),$e().clickRangeOffSetX()}),oe(),we(13," \xa0\u7e26:"),J(14,"input",37),Re("ngModelChange",function(r){return Le(e),$e().tabletopObject.offSetY=r})("click",function(){return Le(e),$e().clickRangeOffSetY()}),oe(),it(15,"br"),Ee(16,RY,3,0,"div",5),oe(),et()}if(2&n){const e=$e();j(3),Ht("value",e.tabletopObject.rangeColor),j(2),Ht("value",e.tabletopObject.gridColor),j(1),ie("ngIf","CIRCLE"!=e.tabletopObject.type),j(3),ie("ngModel",e.tabletopObject.fillOutLine),j(3),ie("ngModel",e.tabletopObject.offSetX),j(2),ie("ngModel",e.tabletopObject.offSetY),j(2),ie("ngIf","CIRCLE"==e.tabletopObject.type||"SQUARE"==e.tabletopObject.type||"DIAMOND"==e.tabletopObject.type)}}function OY(n,t){if(1&n&&(J(0,"div",41),it(1,"img",42),At(2,"safe"),oe()),2&n){const e=$e(2);j(1),ie("src",Ft(2,2,e.tabletopObject.imageFile.url,"resourceUrl"),hn)("alt",e.tabletopObject.imageFile.name)}}function BY(n,t){if(1&n&&(Je(0),J(1,"div",43)(2,"div",44),it(3,"div",45),oe()(),et()),2&n){const e=$e(2);j(3),ie("gameDataElement",e.tabletopObject.commonDataElement)("isTagLocked",!0)}}function LY(n,t){if(1&n&&(J(0,"div",43)(1,"div",44),it(2,"div",47),oe()()),2&n){const e=t.$implicit,i=$e(3);j(2),ie("gameDataElement",e)("isEdit",i.isEdit)}}function zY(n,t){if(1&n&&(Je(0),Ee(1,LY,3,2,"div",46),et()),2&n){const e=$e(2);j(1),ie("ngForOf",e.tabletopObject.detailDataElement.children)}}function HY(n,t){1&n&&pn(0)}function VY(n,t){1&n&&pn(0)}function UY(n,t){1&n&&pn(0)}function jY(n,t){1&n&&pn(0)}function GY(n,t){1&n&&pn(0)}function qY(n,t){1&n&&pn(0)}function WY(n,t){if(1&n){const e=pt();Je(0),J(1,"button",49),Re("click",function(){return Le(e),$e(4).showImportImages()}),we(2,"\u753b\u50cf\u3092\u4ed6\u306e\u30b3\u30de\u304b\u3089\u30a4\u30f3\u30dd\u30fc\u30c8"),oe(),et()}}function ZY(n,t){if(1&n&&(Je(0),J(1,"div",43)(2,"div",44),it(3,"div",48),oe(),Ee(4,WY,3,0,"ng-container",5),oe(),et()),2&n){const e=$e(3);j(3),ie("gameDataElement",e.tabletopObject.imageDataElement)("isTagLocked",!0)("isEdit",e.isEdit)("isImage",!0),j(1),ie("ngIf","character"===e.tabletopObject.aliasName)}}function YY(n,t){if(1&n&&(Je(0),Ee(1,ZY,5,5,"ng-container",5),et()),2&n){const e=$e(2);j(1),ie("ngIf",e.tabletopObject.imageDataElement)}}function KY(n,t){if(1&n){const e=pt();Je(0),J(1,"div",43)(2,"button",50),Re("click",function(){return Le(e),$e(2).addDataElement()}),we(3,"\u65b0\u3057\u3044\u9805\u76ee\u3092\u8ffd\u52a0"),oe()(),et()}}function XY(n,t){if(1&n&&(J(0,"div",39),Ee(1,OY,3,5,"div",40),Ee(2,BY,4,2,"ng-container",5),Ee(3,zY,2,1,"ng-container",5),Je(4,2),Ee(5,HY,1,0,"ng-container",3),Ee(6,VY,1,0,"ng-container",3),Ee(7,UY,1,0,"ng-container",3),Ee(8,jY,1,0,"ng-container",3),Ee(9,GY,1,0,"ng-container",3),Ee(10,qY,1,0,"ng-container",3),Ee(11,YY,2,1,"ng-container",4),et(),Ee(12,KY,4,0,"ng-container",5),oe()),2&n){const e=$e();j(1),ie("ngIf",0<(null==e.tabletopObject.imageFile?null:e.tabletopObject.imageFile.url.length)),j(1),ie("ngIf",e.tabletopObject.commonDataElement),j(1),ie("ngIf",e.tabletopObject.detailDataElement),j(1),ie("ngSwitch",e.tabletopObject.aliasName),j(1),ie("ngSwitchCase","numberResource"),j(1),ie("ngSwitchCase","card"),j(1),ie("ngSwitchCase","card-stack"),j(1),ie("ngSwitchCase","terrain"),j(1),ie("ngSwitchCase","dice-symbol"),j(1),ie("ngSwitchCase","table-scratch-mask"),j(2),ie("ngIf",e.isEdit)}}let wl=(()=>{class n{constructor(e,i,r,o){this.saveDataService=e,this.panelService=i,this.modalService=r,this.pointerDeviceService=o,this.tabletopObject=null,this.isEdit=!1,this.networkService=bt,this.isSaveing=!1,this.progresPercent=0}ngOnInit(){Qe.register(this).on("DELETE_GAME_OBJECT",e=>{this.tabletopObject&&this.tabletopObject.identifier===e.data.identifier&&this.panelService.close()})}ngAfterViewInit(){}ngOnDestroy(){Qe.unregister(this)}toggleEditMode(){this.isEdit=!this.isEdit}addDataElement(){if(this.tabletopObject.detailDataElement){let e=st.create("\u898b\u51fa\u3057","",{}),i=st.create("\u30bf\u30b0","",{});e.appendChild(i),this.tabletopObject.detailDataElement.appendChild(e)}}clone(){let e=this.tabletopObject.clone();switch(e.location.x+=50,e.location.y+=50,this.tabletopObject.parent&&this.tabletopObject.parent.appendChild(e),e.update(),this.tabletopObject.aliasName){case"terrain":$t.play(dt.blockPut),e.isLocked=!1;break;case"card":case"card-stack":e.owner="",e.toTopmost();case"table-mask":e.isLock=!1,$t.play(dt.cardPut);break;case"text-note":e.toTopmost(),$t.play(dt.cardPut);break;case"dice-symbol":$t.play(dt.dicePut);default:$t.play(dt.piecePut)}}clickHide(){}clickNoTalk(){}clickImageFlag(){}clickGrid(){}showImportImages(){let e=this.pointerDeviceService.pointers[0],i={left:e.x-250,top:e.y-175,width:350,height:250};i.title=this.tabletopObject.name+"\u3078\u306e\u753b\u50cf\u8907\u88fd",this.panelService.open(MZ,i).tabletopObject=this.tabletopObject}clickRangeOffSetX(){}clickRangeOffSetY(){}fillOutLine(){}subDivisionSnapPolygonal(){}clickLimitHeight(){setTimeout(()=>{Qe.trigger("RESIZE_NOTE_OBJECT",{identifier:this.tabletopObject.identifier})},100)}chkKomaSize(e){e<50&&(e=50),e>750&&(e=750),this.tabletopObject.komaImageHeignt=e}chkDiceKomaSize(e){e<50&&(e=50),e>750&&(e=750),this.tabletopObject.komaImageHeignt=e}chkPopWidth(e){e<270&&(e=270),e>800&&(e=800),this.tabletopObject.overViewWidth=e}chkPopMaxHeight(e){e<250&&(e=250),e>1e3&&(e=1e3),this.tabletopObject.overViewMaxHeight=e}saveToXML(){var e=this;return(0,xn.Z)(function*(){if(!e.tabletopObject||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=e.tabletopObject.commonDataElement.getFirstElementByName("name"),r=i?i.value:"";yield e.saveDataService.saveGameObjectAsync(e.tabletopObject,"xml_"+r,o=>{e.progresPercent=o}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}setLocation(e){this.tabletopObject.setLocation(e)}openModal(e="",i=!1){this.modalService.open(Hf,{isAllowedEmpty:i}).then(r=>{if(!this.tabletopObject||!this.tabletopObject.imageDataElement||!r)return;let o=this.tabletopObject.imageDataElement.getFirstElementByName(e);!o||(o.value=r)})}changeMaskFillColor(e){this.tabletopObject&&(this.tabletopObject.color=e)}changeMaskChangeColor(e){this.tabletopObject&&(this.tabletopObject.changeColor=e)}changeGridColor(e){this.tabletopObject&&(this.tabletopObject.gridColor=e)}changeRangeColor(e){this.tabletopObject&&(this.tabletopObject.rangeColor=e)}}return n.\u0275fac=function(e){return new(e||n)(Be(ko),Be($n),Be(pi),Be(Di))},n.\u0275cmp=Qt({type:n,selectors:[["game-character-sheet"]],inputs:{tabletopObject:"tabletopObject"},decls:25,vars:17,consts:[[1,"top-header"],[3,"click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf"],["class","flex-container",4,"ngIf"],[3,"disabled","click"],[1,"extra-setting",2,"display","table"],[1,"extra-setting",2,"width","50%","display","table-cell"],["type","checkbox","value","hideInventory","name","specifyKomaImageFlag",3,"ngModel","ngModelChange","click"],["type","range","min","50","max","750",3,"ngModel","disabled","ngModelChange"],["type","number","min","50","max","750","name","popWidth",1,"is-caret",2,"color","#555",3,"ngModel","disabled","ngModelChange","change"],[1,"extra-setting",2,"width","400px"],["type","range","min","250","max","1000",3,"ngModel","ngModelChange"],["type","number","min","250","max","1000","name","popWidth",1,"is-caret",2,"color","#555",3,"ngModel","ngModelChange","change"],[1,"extra-setting",2,"width","30%","display","table-cell","align","right"],[1,"extra-setting",2,"width","70%","display","table-cell","align","right"],["type","checkbox","value","isGrid","name","isGrid",3,"ngModel","ngModelChange","click"],[3,"ngModel","change",4,"ngIf"],["type","checkbox","value","hideInventory","name","hideInventory",3,"ngModel","ngModelChange","click"],["type","checkbox","value","hideInventory","name","nonTalkFlag",3,"ngModel","ngModelChange","click"],["type","range","min","270","max","1000",3,"ngModel","ngModelChange"],["type","number","min","270","max","1000","name","popWidth",1,"is-caret",2,"color","#555",3,"ngModel","ngModelChange","change"],["type","number","min","250","max","1000","name","popHeight",1,"is-caret",2,"color","#555",3,"ngModel","ngModelChange","change"],[3,"ngModel","change"],["value","table"],["value","common"],[3,"value"],["value","graveyard"],["type","checkbox","value","limitHeight","name","limitHeight",3,"ngModel","ngModelChange","click"],["type","color","name","color11","list","color-list_11",3,"value","change"],["type","color","name","color12","list","color-list_12",3,"value","change"],["type","color","name","color01","list","color-list_01",3,"value","change"],["type","color","name","color02","list","color-list_02",3,"value","change"],["type","checkbox","value","fillOutLine","name","fillOutLine",3,"ngModel","ngModelChange","click"],["type","checkbox","value","offSetX","name","offSetX",3,"ngModel","ngModelChange","click"],["type","checkbox","value","offSetY","name","offSetY",3,"ngModel","ngModelChange","click"],["type","checkbox","value","noSnapPolygonal","name","subDivisionSnapPolygonal",3,"ngModel","ngModelChange","click"],[1,"flex-container"],["class","box main-image-box",4,"ngIf"],[1,"box","main-image-box"],[1,"main-image",3,"src","alt"],[1,"flex-item"],[1,"table"],["game-data-element","",1,"table-row",3,"gameDataElement","isTagLocked"],["class","flex-item",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","isEdit"],["game-data-element","",1,"table-row",3,"gameDataElement","isTagLocked","isEdit","isImage"],[2,"width","300px","color","#555",3,"click"],[2,"width","100%","color","#555",3,"click"]],template:function(e,i){1&e&&(J(0,"div",0)(1,"button",1),Re("click",function(){return i.toggleEditMode()}),we(2,"\u7de8\u96c6\u5207\u308a\u66ff\u3048"),oe(),Je(3,2),Ee(4,$Y,1,0,"ng-container",3),Ee(5,vY,5,0,"ng-container",3),Ee(6,bY,1,0,"ng-container",3),Ee(7,yY,5,0,"ng-container",3),Ee(8,CY,3,1,"ng-container",3),Ee(9,xY,1,0,"ng-container",3),Ee(10,wY,1,0,"ng-container",3),Ee(11,EY,3,0,"ng-container",4),et(),J(12,"button",1),Re("click",function(){return i.clone()}),we(13,"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b"),oe(),J(14,"button",1),Re("click",function(){return i.saveToXML()}),we(15,"\u4fdd\u5b58"),oe(),Ee(16,TY,10,10,"ng-container",5),Ee(17,SY,12,14,"ng-container",5),Ee(18,DY,12,14,"ng-container",5),Ee(19,IY,7,1,"ng-container",5),Ee(20,MY,28,27,"ng-container",5),Ee(21,AY,15,15,"ng-container",5),Ee(22,PY,8,2,"ng-container",5),Ee(23,NY,17,7,"ng-container",5),oe(),Ee(24,XY,13,11,"div",6)),2&e&&(j(3),ie("ngSwitch",i.tabletopObject.aliasName),j(1),ie("ngSwitchCase","numberResource"),j(1),ie("ngSwitchCase","card"),j(1),ie("ngSwitchCase","card-stack"),j(1),ie("ngSwitchCase","terrain"),j(1),ie("ngSwitchCase","dice-symbol"),j(1),ie("ngSwitchCase","range"),j(1),ie("ngSwitchCase","table-scratch-mask"),j(6),ie("ngIf","dice-symbol"===i.tabletopObject.aliasName),j(1),ie("ngIf","card-stack"===i.tabletopObject.aliasName),j(1),ie("ngIf","card"===i.tabletopObject.aliasName),j(1),ie("ngIf","terrain"===i.tabletopObject.aliasName),j(1),ie("ngIf","character"===i.tabletopObject.aliasName),j(1),ie("ngIf","text-note"===i.tabletopObject.aliasName),j(1),ie("ngIf","table-scratch-mask"===i.tabletopObject.aliasName),j(1),ie("ngIf","range"===i.tabletopObject.aliasName),j(1),ie("ngIf",i.tabletopObject))},directives:[tc,Wu,gf,Sn,ra,Ti,yi,oa,Fi,Vc,Ju,ms,nc,ic,rc,mY,si],pipes:[Ii],styles:["[_nghost-%COMP%]{display:block}.main-image-box[_ngcontent-%COMP%]{width:250px;height:250px}.main-image[_ngcontent-%COMP%]{width:250px}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{display:table-row;box-sizing:border-box}.table-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:table-cell;border:1px solid #FFF;vertical-align:top;box-sizing:border-box}.box[_ngcontent-%COMP%]{display:inline-block;margin:5px;box-sizing:border-box}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px 0;padding:10px;flex:1 0 auto;box-sizing:border-box;min-width:25px;background-color:#eac99dcc;background-color:#f0dabdcc;color:#444}.flex-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{color:#ccc}.top-header[_ngcontent-%COMP%]{display:table;width:100%}.extra-setting[_ngcontent-%COMP%]{text-align:right}.table-cell[_ngcontent-%COMP%]{display:table-cell}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();const QY=["root"],JY=["chatInput"],eK=["chatPalette"];function tK(n,t){1&n&&it(0,"badge",20),2&n&&ie("count",$e().$implicit.unreadLength)}function nK(n,t){if(1&n){const e=pt();J(0,"label")(1,"input",18),Re("ngModelChange",function(r){return Le(e),$e().chatTabidentifier=r}),oe(),J(2,"div"),we(3),Ee(4,tK,1,1,"badge",19),oe()()}if(2&n){const e=t.$implicit,i=$e();j(1),Ht("value",e.identifier),ie("ngModel",i.chatTabidentifier),j(2),xt(e.name),j(1),ie("ngIf",e.hasUnread)}}function iK(n,t){1&n&&(J(0,"div",21)(1,"i",22),we(2,"info_outline"),oe(),we(3," \u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u7de8\u96c6\u4e2d\u3067\u3059"),oe())}function rK(n,t){if(1&n&&(J(0,"option",25),we(1),oe()),2&n){const e=t.$implicit;Ht("value",e),j(1),xt(e)}}function oK(n,t){if(1&n){const e=pt();Je(0),J(1,"select",23),Re("input",function(r){Le(e);const o=$e();return o.selectAutoComplete(o.text,r.target.value)})("click",function(r){Le(e);const o=$e();return o.selectAutoComplete(o.text,r.target.value)}),Ee(2,rK,2,2,"option",24),oe(),et()}if(2&n){const e=$e();j(1),na("id","",e._timeId,"_complete"),j(1),ie("ngForOf",e.autoCompleteList())}}function sK(n,t){if(1&n&&(J(0,"option",25),we(1),oe()),2&n){const e=t.$implicit;Ht("value",e),j(1),xt(e)}}function aK(n,t){if(1&n&&(Je(0),Ee(1,sK,2,2,"option",24),et()),2&n){const e=$e();j(1),ie("ngForOf",e.palette.getPalette())}}function lK(n,t){1&n&&(J(0,"span"),we(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u7de8\u96c6"),oe())}function cK(n,t){1&n&&(J(0,"span"),we(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u78ba\u5b9a"),oe())}let BP=(()=>{class n{constructor(e,i,r,o){this.contextMenuService=e,this.pointerDeviceService=i,this.chatMessageService=r,this.panelService=o,this.character=null,this._gameType="",this._paletteIndex=[],this._timeId="",this._autoCompleteEnable=!1,this.chatTabidentifier="",this.text="",this.sendTo="",this.isEdit=!1,this.isIndexOpen=!1,this.editPalette="",this.doubleClickTimer=null}get palette(){return this.character.chatPalette}get gameType(){return this._gameType}set gameType(e){this._gameType=e,this.character.chatPalette&&(this.character.chatPalette.dicebot=e)}get sendFrom(){return this.character.identifier}set sendFrom(e){this.onSelectedCharacter(e)}get diceBotInfos(){return sr.diceBotInfos}get chatTab(){return Xe.instance.get(this.chatTabidentifier)}get myPeer(){return _t.myCursor}get otherPeers(){return Xe.instance.getObjects(_t)}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"",this.gameType=this.character.chatPalette?this.character.chatPalette.dicebot:"",this._timeId=Date.now()+"_chat-palette",Qe.register(this).on("DELETE_GAME_OBJECT",e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close(),this.chatTabidentifier===e.data.identifier&&(this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"")}).on("JUMP_INDEX",-1e3,e=>{this._timeId==e.data.targetId&&this.japmIndex(e.data.lineNo)})}ngOnDestroy(){Qe.unregister(this),this.isEdit&&this.toggleEditMode()}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8"}onSelectedCharacter(e){this.isEdit&&this.toggleEditMode();let i=Xe.instance.get(e);if(i instanceof Lt){this.character=i;let r=this.character.chatPalette?this.character.chatPalette.dicebot:"";0<r.length&&(this.gameType=r)}this.updatePanelTitle()}resizeChatInput(){this.chatInputComponent.kickCalcFitHeight()}chatTabSwitchRelative(e){let o,i=this.chatMessageService.chatTabs,r=i.findIndex(s=>s.identifier==this.chatTabidentifier);r<0||(o=r==i.length-1&&1==e?0:0==r&&-1==e?i.length-1:r+e,this.chatTabidentifier=i[o].identifier)}autoCompleteSwitchRelative(e){console.log("selectAutoComplete :"+e);const i=document.getElementById(this._timeId+"_complete");if(!i)return;const r=i.length;let o=i.selectedIndex;o+=e,!(o<=-1)&&(o>=r&&(o=r-1),i.selectedIndex=o)}autoCompleteDoRelative(e){const i=document.getElementById(this._timeId+"_complete");e==i.selectedIndex&&this.selectAutoComplete(this.text,i.value)}selectPalette(e){let i=e.replace(/\\n/g,"\n");this.text=i;const r=document.getElementById(this._timeId+"_complete");r&&(r.selectedIndex=-1)}selectAutoComplete(e,i){const r=document.getElementById(this._timeId+"_complete");let o=this.palette.paletteMatchLine(e,r.selectedIndex);console.log(e+" "+i+" index:"+r.selectedIndex+" lineNo"+o),this.japmIndex(o),this.selectPalette(i)}completeIndex(){let e=document.getElementById(this._timeId+"_complete");return e?e.selectedIndex:-1}autoCompleteList(){let e=new Array;return this.text.length>1&&(e=this.palette.paletteMatch(this.text)),e}clickPalette(e){let i=e.replace(/\\n/g,"\n");this.doubleClickTimer&&this.text===i?(clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.chatInputComponent.sendChat(null)):(this.text=i,this.doubleClickTimer=setTimeout(()=>{this.doubleClickTimer=null},400))}targeted(e){return"table"==e.location.name&&e.targeted}targetedGameCharacterList(){let e=[];return e=Xe.instance.getObjects(Lt).filter(i=>this.targeted(i)),e}sendChat(e){if(this.chatTab){let i="",r=[],o=[];if(this.palette.checkTargetCharactor(e.text)){r=this.targetedGameCharacterList();let s=!0;0==r.length&&(i+="\u5bfe\u8c61\u304c\u672a\u9078\u629e\u3067\u3059");for(let a of r){i+=s?"":"\n";let g=e.text,w="";w=s?g:sr.deleteMyselfResourceBuff(g),i+=this.palette.evaluate(w,this.character.rootDataElement,a),i+=" ["+a.name+"]",s=!1;let W={text:"",object:null};W.text=this.palette.evaluate(w,this.character.rootDataElement,a),W.object=a,o.push(W)}}else{r=[],i=this.palette.evaluate(e.text,this.character.rootDataElement);let s={text:"",object:null};s.text=i,s.object=null,o.push(s)}this.chatMessageService.sendMessage(this.chatTab,i,e.gameSystem,e.sendFrom,e.sendTo,e.tachieNum,e.messColor,o)}}resetPaletteSelect(){!this.chatPaletteElementRef.nativeElement||(this.chatPaletteElementRef.nativeElement.selectedIndex=-1)}toggleEditMode(){if(this.isEdit=!this.isEdit,this.isEdit){const e=document.getElementById(this._timeId+"_select"),i=document.getElementById(this._timeId+"_text");console.log("selectObj.clientHeight:"+e.clientHeight),console.log("selectObj.scrollHeight:"+e.scrollHeight),console.log("selectObj.scrollTop:"+e.scrollTop),this.editPalette=this.palette.value+"";const r=e.scrollTop,o=e.scrollHeight;setTimeout(()=>{console.log("textObj.clientHeight:"+i.clientHeight),console.log("textObj.scrollHeight:"+i.scrollHeight),console.log("textObj.scrollTop:"+i.scrollTop),i.scrollTop=r*i.scrollHeight/o},10)}else this.palette.setPalette(this.editPalette)}moveTest(){const e=document.getElementById(this._timeId+"_text");e.focus(),setTimeout(()=>{e.setSelectionRange(600,600)},10)}japmIndex(e){console.log("JUMP_INDEX:"+e);let i=document.getElementById(this._timeId+"_select");i&&(i.scrollTop=i.scrollHeight,i.options[e].selected=!1,i.options[e].selected=!0)}indexBtn(){let i=this.rootElementRef.nativeElement.getBoundingClientRect(),r=this.pointerDeviceService.pointers[0];console.log(this.panelService.left+" "+this.panelService.top),r.x=i.left-8,r.y=i.top-8,this._paletteIndex=this.palette.paletteIndex;let o=new Array;for(let a of this._paletteIndex)o.push({name:a.name,line:a.line,id:this._timeId,action:()=>{}});this.contextMenuService.open(r,o,"\u30a4\u30f3\u30c7\u30c3\u30af\u30b9")}}return n.\u0275fac=function(e){return new(e||n)(Be(To),Be(Di),Be(go),Be($n))},n.\u0275cmp=Qt({type:n,selectors:[["chat-palette"]],viewQuery:function(e,i){if(1&e&&(Gn(QY,7),Gn(JY,7),Gn(eK,5)),2&e){let r;yn(r=Cn())&&(i.rootElementRef=r.first),yn(r=Cn())&&(i.chatInputComponent=r.first),yn(r=Cn())&&(i.chatPaletteElementRef=r.first)}},inputs:{character:"character"},decls:26,vars:18,consts:[[1,"flex-container"],["root",""],[2,"flex-grow","0"],[1,"chat-tab"],[4,"ngFor","ngForOf"],[1,"is-caret",3,"onlyCharacters","chatTabidentifier","gameType","sendFrom","autoCompleteIndex","autoCompleteListLen","text","gameTypeChange","sendFromChange","textChange","chat","autoCompleteSwitch","autoCompleteDo","tabSwitch"],["chatInput",""],[2,"position","absolute","margin-top","-2em"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],["class","edit-info",4,"ngIf"],[1,"complete-box"],[4,"ngIf"],[2,"flex-grow","1","height","0","min-height","100px",3,"hidden"],["size","5",1,"palette",2,"overflow-y","auto",3,"id","input","click","focusout"],["chatPalette",""],["placeholder","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8",1,"palette","is-caret",2,"resize","none",3,"id","ngModel","ngModelChange"],["type","submit",3,"click"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","badge",3,"count",4,"ngIf"],[1,"badge",3,"count"],[1,"edit-info"],[1,"material-icons",2,"vertical-align","bottom","size","0.8rem"],["size","5",1,"complete",2,"overflow-y","auto",3,"id","input","click"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,i){1&e&&(J(0,"div",0,1)(2,"div",2)(3,"form")(4,"div",3),Ee(5,nK,5,4,"label",4),oe()(),J(6,"chat-input",5,6),Re("gameTypeChange",function(o){return i.gameType=o})("sendFromChange",function(o){return i.sendFrom=o})("textChange",function(o){return i.text=o})("chat",function(o){return i.sendChat(o)})("autoCompleteSwitch",function(o){return i.autoCompleteSwitchRelative(o)})("autoCompleteDo",function(o){return i.autoCompleteDoRelative(o)})("tabSwitch",function(o){return i.chatTabSwitchRelative(o)}),oe(),J(8,"div",7)(9,"button",8),Re("click",function(){return i.indexBtn()}),we(10,"\uff1c"),J(11,"i",9),we(12,"bookmarks"),oe()()(),Ee(13,iK,4,0,"div",10),J(14,"div",11),Ee(15,oK,3,2,"ng-container",12),oe()(),J(16,"div",13)(17,"select",14,15),Re("input",function(o){return i.selectPalette(o.target.value)})("click",function(o){return i.clickPalette(o.target.value)})("focusout",function(){return i.resizeChatInput()}),Ee(19,aK,2,1,"ng-container",12),oe()(),J(20,"div",13)(21,"textarea",16),Re("ngModelChange",function(o){return i.editPalette=o}),oe()(),J(22,"div",2)(23,"button",17),Re("click",function(){return i.toggleEditMode()}),Ee(24,lK,2,0,"span",12),Ee(25,cK,2,0,"span",12),oe()()()),2&e&&(j(5),ie("ngForOf",i.chatMessageService.chatTabs),j(1),ie("onlyCharacters",!0)("chatTabidentifier",i.chatTabidentifier)("gameType",i.gameType)("sendFrom",i.sendFrom)("autoCompleteIndex",i.completeIndex())("autoCompleteListLen",i.autoCompleteList().length)("text",i.text),j(7),ie("ngIf",i.isEdit),j(2),ie("ngIf",1==i.autoCompleteList().length&&i.autoCompleteList()[0]!=i.text||i.autoCompleteList().length>1),j(1),ie("hidden",i.isEdit),j(1),na("id","",i._timeId,"_select"),j(2),ie("ngIf",i.palette),j(1),ie("hidden",!i.isEdit),j(1),na("id","",i._timeId,"_text"),ie("ngModel",i.editPalette),j(3),ie("ngIf",!i.isEdit),j(1),ie("ngIf",i.isEdit))},directives:[_s,gs,xo,si,Qu,Fi,Ti,yi,Sn,PP,RP,ic,rc],styles:["[_nghost-%COMP%]{display:block;height:100%}.edit-info[_ngcontent-%COMP%]{width:100%;text-align:center;color:#ccc;background-color:#1e1e1ecc}.palette[_ngcontent-%COMP%]{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;width:100%;height:100%}.flex-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.chat-tab[_ngcontent-%COMP%]{padding:0 5px 5px;-webkit-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:8px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.complete-box[_ngcontent-%COMP%]{position:relative;width:100%;height:0px}.complete[_ngcontent-%COMP%]{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;width:calc(100% - 155px);resize:none;position:absolute;top:-20px;left:60px;min-width:220px;z-index:10;opacity:.8}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();function uK(n,t){if(1&n){const e=pt();Je(0),J(1,"div",14),we(2),oe(),J(3,"input",15),Re("ngModelChange",function(r){return Le(e),$e(5).name=r}),oe(),et()}if(2&n){const e=$e(5);j(2),xt(e.name),j(1),ie("ngModel",e.name)}}function dK(n,t){if(1&n){const e=pt();Je(0),J(1,"div",5)(2,"button",6),Re("click",function(){Le(e);const r=$e(4);return r.deletBuff(r.gameDataElement)}),we(3,"\u524a\u9664"),oe()(),J(4,"div",7)(5,"div",8),Ee(6,uK,4,2,"ng-container",0),oe(),J(7,"div",9),we(8,"/"),oe(),J(9,"div",10)(10,"input",11),Re("ngModelChange",function(r){return Le(e),$e(4).currentValue=r}),oe()(),J(11,"div",9),we(12,"/"),oe(),J(13,"div",12)(14,"input",13),Re("ngModelChange",function(r){return Le(e),$e(4).value=r}),oe()(),J(15,"div",12),we(16,"R"),oe()(),et()}if(2&n){const e=$e(4);j(6),ie("ngIf",!e.isTagLocked),j(4),ie("ngModel",e.currentValue),j(4),ie("ngModel",e.value)}}function fK(n,t){if(1&n&&(Je(0),J(1,"div",18),we(2),oe(),et()),2&n){const e=$e(5);j(2),xt(e.gameDataElement.name)}}function hK(n,t){if(1&n&&(Je(0),J(1,"div",16)(2,"div",17),Ee(3,fK,3,1,"ng-container",0),oe()(),et()),2&n){const e=$e(4);j(3),ie("ngIf",!e.isTagLocked)}}function pK(n,t){if(1&n&&(Je(0)(1,2),Ee(2,dK,17,3,"ng-container",3),Ee(3,hK,4,1,"ng-container",4),et()()),2&n){const e=$e(3);j(1),ie("ngSwitch",e.gameDataElement.type),j(1),ie("ngSwitchCase","numberResource")}}function gK(n,t){if(1&n&&(Je(0),J(1,"div",18),we(2),oe(),et()),2&n){const e=$e(4);j(2),xt(e.gameDataElement.name)}}function _K(n,t){if(1&n&&it(0,"div",22),2&n){const e=t.$implicit,i=$e(5);ie("gameDataElement",e)("isEdit",i.isEdit)("isTagLocked",i.isTagLocked)}}function mK(n,t){if(1&n&&(J(0,"div",20),Ee(1,_K,1,3,"div",21),oe()),2&n){const e=$e(4);j(1),ie("ngForOf",e.gameDataElement.children)}}function $K(n,t){if(1&n&&(Je(0),J(1,"div",16)(2,"div",17),Ee(3,gK,3,1,"ng-container",0),oe(),Ee(4,mK,2,1,"div",19),oe(),et()),2&n){const e=$e(3);j(3),ie("ngIf",!e.isTagLocked),j(1),ie("ngIf",0<e.gameDataElement.children.length)}}function vK(n,t){if(1&n&&(Je(0),Ee(1,pK,4,2,"ng-container",0),Ee(2,$K,5,2,"ng-container",0),et()),2&n){const e=$e(2);j(1),ie("ngIf",e.gameDataElement.children.length<1),j(1),ie("ngIf",0<e.gameDataElement.children.length)}}function bK(n,t){if(1&n&&(Je(0),Ee(1,vK,3,2,"ng-container",0),et()),2&n){const e=$e();j(1),ie("ngIf",e.gameDataElement)}}function yK(n,t){if(1&n&&(Je(0),J(1,"span",23),we(2),oe(),et()),2&n){const e=$e(3);j(2),y1(" ",e.gameDataElement.name," / ",e.gameDataElement.currentValue," / ",e.gameDataElement.value,"R ")}}function CK(n,t){if(1&n&&(Je(0)(1,2),Ee(2,yK,3,3,"ng-container",3),et()()),2&n){const e=$e(2);j(1),ie("ngSwitch",e.gameDataElement.type),j(1),ie("ngSwitchCase","numberResource")}}function xK(n,t){if(1&n&&it(0,"div",25),2&n){const e=t.$implicit,i=$e(3);ie("gameDataElement",e)("isEdit",i.isEdit)("isTagLocked",i.isTagLocked)("isPieceMode",i.isPieceMode)}}function wK(n,t){if(1&n&&(Je(0),Ee(1,xK,1,4,"div",24),et()),2&n){const e=$e(2);j(1),ie("ngForOf",e.gameDataElement.children)}}function EK(n,t){if(1&n&&(Je(0),Ee(1,CK,3,2,"ng-container",0),Ee(2,wK,2,1,"ng-container",0),et()),2&n){const e=$e();j(1),ie("ngIf",e.gameDataElement.children.length<1),j(1),ie("ngIf",0<e.gameDataElement.children.length)}}function TK(n,t){if(1&n){const e=pt();J(0,"button",26),Re("click",function(){return Le(e),$e().addElement()}),J(1,"i",27),we(2,"add_circle"),oe()(),J(3,"button",26),Re("click",function(){return Le(e),$e().upElement()}),J(4,"i",27),we(5,"arrow_upward"),oe()(),it(6,"br"),J(7,"button",26),Re("click",function(){return Le(e),$e().deleteElement()}),J(8,"i",27),we(9,"remove_circle_outline"),oe()(),J(10,"button",26),Re("click",function(){return Le(e),$e().downElement()}),J(11,"i",27),we(12,"arrow_downward"),oe()()}}let LP=(()=>{class n{constructor(e){this.changeDetector=e,this.gameDataElement=null,this.isEdit=!1,this.isTagLocked=!1,this.isValueLocked=!1,this.isPieceMode=!1,this._name="",this._value=0,this._currentValue=0,this.updateTimer=null}get name(){return this._name}set name(e){this._name=e,this.setUpdateTimer()}get value(){return this._value}set value(e){this._value=e,this.setUpdateTimer()}get currentValue(){return this._currentValue}set currentValue(e){this._currentValue=e,this.setUpdateTimer()}ngOnInit(){this.gameDataElement&&this.setValues(this.gameDataElement),Qe.register(this).on("UPDATE_GAME_OBJECT",-1e3,e=>{this.gameDataElement&&e.data.identifier===this.gameDataElement.identifier&&(this.setValues(this.gameDataElement),this.changeDetector.markForCheck())}).on("DELETE_GAME_OBJECT",-1e3,e=>{this.gameDataElement&&this.gameDataElement.identifier===e.data.identifier&&this.changeDetector.markForCheck()})}ngOnDestroy(){Qe.unregister(this)}ngAfterViewInit(){}addElement(){this.gameDataElement.appendChild(st.create("TEST",8,{type:"numberResource",currentValue:"001"},"TEST"))}deleteElement(){this.gameDataElement.destroy()}upElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);0<i&&e.insertBefore(this.gameDataElement,e.children[i-1])}downElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.gameDataElement)}setElementType(e){this.gameDataElement.setAttribute("type",e)}setValues(e){this._name=e.name,this._currentValue=e.currentValue,this._value=e.value}setUpdateTimer(){clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>{this.gameDataElement.name!==this.name&&(this.gameDataElement.name=this.name),this.gameDataElement.currentValue!==this.currentValue&&(this.gameDataElement.currentValue=this.currentValue),this.gameDataElement.value!==this.value&&(this.gameDataElement.value=this.value),this.updateTimer=null},66)}deletBuff(e){e.destroy()}}return n.\u0275fac=function(e){return new(e||n)(Be(bi))},n.\u0275cmp=Qt({type:n,selectors:[["game-data-element-buff"],["","game-data-element-buff",""]],inputs:{gameDataElement:"gameDataElement",isEdit:"isEdit",isTagLocked:"isTagLocked",isValueLocked:"isValueLocked",isPieceMode:"isPieceMode"},decls:4,vars:2,consts:[[4,"ngIf"],["editButtons",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"table-cell",2,"border-bottom","none"],[2,"width","5em",3,"click"],[1,"table","table-cell",2,"border-bottom","none"],[1,"table-cell",2,"width","60%"],[1,"table-cell",2,"width","0px"],[1,"table-cell",2,"width","30%"],["size","1","type","string","placeholder","Value",1,"is-caret",2,"width","100%",3,"ngModel","ngModelChange"],[1,"table-cell"],["size","1","type","number","placeholder","Value",1,"is-caret",2,"width","3em",3,"ngModel","ngModelChange"],[1,"hidden-spacer",2,"font-family","Cambria, Georgia","font-size","0.9rem"],["size","1","placeholder","Value",1,"is-caret",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","0.9rem",3,"ngModel","ngModelChange"],[1,"table",2,"width","100%"],[1,"table-cell_inner-table-title"],[1,"inputLock"],["class","table",4,"ngIf"],[1,"table"],["game-data-element-buff","","class","table-row",3,"gameDataElement","isEdit","isTagLocked",4,"ngFor","ngForOf"],["game-data-element-buff","",1,"table-row",3,"gameDataElement","isEdit","isTagLocked"],[2,"font-family","Cambria, Georgia","font-size","12px"],["game-data-element-buff","","class","table-row",3,"gameDataElement","isEdit","isTagLocked","isPieceMode",4,"ngFor","ngForOf"],["game-data-element-buff","",1,"table-row",3,"gameDataElement","isEdit","isTagLocked","isPieceMode"],[3,"click"],[1,"material-icons"]],template:function(e,i){1&e&&(Ee(0,bK,2,1,"ng-container",0),Ee(1,EK,3,2,"ng-container",0),Ee(2,TK,13,0,"ng-template",null,1,Ln)),2&e&&(ie("ngIf",!i.isPieceMode),j(1),ie("ngIf",i.isPieceMode))},directives:[Sn,tc,Wu,Fi,Ti,yi,ms,gf,si,n],styles:[".game-data-element[_ngcontent-%COMP%]{margin-left:10px}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{padding-top:10px;display:table-row;box-sizing:border-box}.table-cell-2[_ngcontent-%COMP%]{display:table-cell;vertical-align:middle;padding:0}.table-cell[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.5em 0 .1em .5em;border-bottom:1px dotted #888;box-sizing:border-box}.table-cell_solid[_ngcontent-%COMP%]{width:10px;white-space:nowrap}.table-cell_inner-table[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.2em 0 .1em .5em;border:none;box-sizing:border-box}.table-cell_inner-table-title[_ngcontent-%COMP%]{border-bottom:1px solid #444;border-left:8px solid #444;padding-left:8px}.box[_ngcontent-%COMP%]{display:inline-block;margin:10px}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;max-width:20em;overflow:hidden;padding:0 3px;box-sizing:border-box}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}.inputLock[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box;width:100%;min-width:10px;font-weight:700}input[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:hover, select[_ngcontent-%COMP%]:hover{background:#EEE}input[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{background:#FFF}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}.table-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.5rem}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();function SK(n,t){if(1&n&&(J(0,"div",4),it(1,"div",5),oe()),2&n){const e=t.$implicit,i=$e(3);j(1),ie("gameDataElement",e)("isEdit",i.isEdit)("isPieceMode",!1)}}function DK(n,t){if(1&n&&(Je(0),J(1,"div",2),Ee(2,SK,2,3,"div",3),oe(),et()),2&n){const e=$e(2);j(2),ie("ngForOf",e.character.buffDataElement.children)}}function IK(n,t){if(1&n&&(Je(0),J(1,"div",1),Ee(2,DK,3,1,"ng-container",0),oe(),et()),2&n){const e=$e();j(2),ie("ngIf",e.character.buffDataElement)}}let zP=(()=>{class n{constructor(e,i){this.panelService=e,this.modalService=i,this.character=null}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)(Be($n),Be(pi))},n.\u0275cmp=Qt({type:n,selectors:[["game-character-buff-view"]],inputs:{character:"character"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"controller"],[1,"table"],["class","flex-item",4,"ngFor","ngForOf"],[1,"flex-item"],["game-data-element-buff","",1,"table-row",3,"gameDataElement","isEdit","isPieceMode"]],template:function(e,i){1&e&&Ee(0,IK,3,1,"ng-container",0),2&e&&ie("ngIf",i.character)},directives:[Sn,si,LP],styles:[".text[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;font-size:12px}"]}),n})();const kK=["textArea"];function MK(n,t){1&n&&(it(0,"img",22),At(1,"safe")),2&n&&ie("src",Ft(1,1,$e().imageFile.url,"resourceUrl"),hn)}function AK(n,t){if(1&n&&(J(0,"ng-option",23),we(1),oe()),2&n){const e=$e();ie("value",null==e.myPeer?null:e.myPeer.identifier),j(1),sn("",null==e.myPeer?null:e.myPeer.name,"\uff08\u3042\u306a\u305f\uff09")}}function PK(n,t){if(1&n&&(J(0,"ng-option",23),we(1),oe()),2&n){const e=t.$implicit;ie("value",e.identifier),j(1),sn("",e.name," ")}}function FK(n,t){1&n&&(Je(0),we(1," \u5168\u89e3\u9664\u53e3\u2192 "),et())}function RK(n,t){1&n&&(Je(0),we(1," \u5168\u9078\u629e\u3006\u2192 "),et())}function NK(n,t){if(1&n){const e=pt();Je(0),J(1,"input",24),Re("ngModelChange",function(r){return Le(e),$e().tachieNum=r}),At(2,"safe"),oe(),we(3," 0/0 \u7acb\u3061\u7d75 "),et()}if(2&n){const e=$e();j(1),Qn(Ft(2,3,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),ie("ngModel",e.tachieNum)}}function OK(n,t){if(1&n&&(Je(0),we(1),et()),2&n){const e=$e(2);j(1),sn(" ",e.selectCharacterTachie.currentValue," ")}}function BK(n,t){1&n&&pn(0)}function LK(n,t){if(1&n){const e=pt();Je(0),J(1,"input",25),Re("ngModelChange",function(r){return Le(e),$e().tachieNum=r}),At(2,"safe"),oe(),we(3),Ee(4,OK,2,1,"ng-container",13),Ee(5,BK,1,0,"ng-container",13),et()}if(2&n){const e=$e();j(1),Qn(Ft(2,8,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),Ht("max",e.selectCharacterTachieNum-1),ie("ngModel",e.tachieNum),j(2),Os(" ",e.tachieNum,"/",e.selectCharacterTachieNum-1," \u7acb\u3061\u7d75 "),j(1),ie("ngIf",e.selectCharacterTachie.currentValue.length>0),j(1),ie("ngIf",e.selectCharacterTachie.currentValue.length<=0)}}const zK=function(n){return{"direct-message":n}},Gw=function(n,t,e){return{"background-color":n,border:t,"border-radius":e}},HK=function(){return{standalone:!0}};let VK=(()=>{class n{constructor(e,i,r,o,s){this.ngZone=e,this.chatMessageService=i,this.batchService=r,this.panelService=o,this.pointerDeviceService=s,this.onlyCharacters=!1,this.chatTabidentifier="",this._gameType="",this.gameTypeChange=new Xt,this._sendFrom=this.myPeer?this.myPeer.identifier:"",this.sendFromChange=new Xt,this._sendTo="",this.sendToChange=new Xt,this._text="",this.textChange=new Xt,this._selectNum=0,this.chat=new Xt,this.allBox=new Xt,this.hideChkEvent=new Xt,this.gameHelp="",this.colorSelectNo_=0,this.shouldUpdateCharacterList=!0,this._gameCharacters=[],this.writingEventInterval=null,this.previousWritingLength=0,this.writingPeers=new Map,this.writingPeerNames=[],this.buffHideIsChk=!1}get gameType(){return this._gameType}set gameType(e){this._gameType=e,this.gameTypeChange.emit(e)}get sendFrom(){return this._sendFrom}set sendFrom(e){this._sendFrom=e,this.sendFromChange.emit(e)}get sendTo(){return this._sendTo}set sendTo(e){this._sendTo=e,this.sendToChange.emit(e)}get text(){return this._text}set text(e){this._text=e,this.textChange.emit(e)}get selectNum(){return this._selectNum}get tachieNum(){const e=Xe.instance.get(this.sendFrom);return e instanceof Lt?e.selectedTachieNum:0}set tachieNum(e){const i=Xe.instance.get(this.sendFrom);i instanceof Lt&&(i.selectedTachieNum=e)}get isDirect(){return!(null==this.sendTo||!this.sendTo.length)}get colorSelectNo(){return this.colorSelectNo_}set colorSelectNo(e){this.colorSelectNo_=e<0?0:e>2?2:e}get colorSelectorBoxBorder_0(){return 0===this.colorSelectNo?"3px":"1px"}get colorSelectorBoxBorder_1(){return 1===this.colorSelectNo?"3px":"1px"}get colorSelectorBoxBorder_2(){return 2===this.colorSelectNo?"3px":"1px"}get colorSelectorRadius_0(){return 0===this.colorSelectNo?"9px":"0px"}get colorSelectorRadius_1(){return 1===this.colorSelectNo?"9px":"0px"}get colorSelectorRadius_2(){return 2===this.colorSelectNo?"9px":"0px"}get selectChatColor(){return console.log("selectChatColor :"+this.charactorChatColor(this.colorSelectNo)),this.charactorChatColor(this.colorSelectNo)}get charactorChatColor_0(){return this.charactorChatColor(0)}get charactorChatColor_1(){return this.charactorChatColor(1)}get charactorChatColor_2(){return this.charactorChatColor(2)}get selectCharacterTachie(){const e=Xe.instance.get(this.sendFrom);return e instanceof Lt&&e.imageDataElement.children.length>this.tachieNum?e.imageDataElement.children[this.tachieNum]:null}get selectCharacterTachieNum(){const e=Xe.instance.get(this.sendFrom);return e instanceof Lt?e.imageDataElement.children.length:0}get imageFile(){if(this.selectCharacterTachie)return St.instance.get(this.selectCharacterTachie.value)||Bt.Empty;const e=Xe.instance.get(this.sendFrom);let i=null;return e instanceof Lt?i=e.imageFile:e instanceof _t&&(i=e.image),i||Bt.Empty}get gameCharacters(){return this.shouldUpdateCharacterList&&(this.shouldUpdateCharacterList=!1,this._gameCharacters=Xe.instance.getObjects(Lt).filter(e=>this.allowsChat(e))),this._gameCharacters}get diceBotInfos(){return sr.diceBotInfos}get myPeer(){return _t.myCursor}get otherPeers(){return Xe.instance.getObjects(_t)}setColorNum(e){this.colorSelectNo=e}charactorChatColor(e){const i=Xe.instance.get(this.sendFrom);return i instanceof Lt?i.chatColorCode[e]:"#000000"}shoeColorSetting(){const e=Xe.instance.get(this.sendFrom);if(e instanceof Lt){const i=this.pointerDeviceService.pointers[0];let r="\u8272\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(jw,{title:r,left:i.x+50,top:i.y-150,width:300,height:120}).tabletopObject=e}}ngOnInit(){Qe.register(this).on("MESSAGE_ADDED",e=>{if(e.data.tabIdentifier!==this.chatTabidentifier)return;const i=Xe.instance.get(e.data.messageIdentifier),r=Xe.instance.getObjects(_t).find(s=>s.userId===i.from),o=r?r.peerId:"?";this.writingPeers.has(o)&&(this.writingPeers.get(o).stop(),this.writingPeers.delete(o),this.updateWritingPeerNames())}).on("UPDATE_GAME_OBJECT",-1e3,e=>{if(e.data.aliasName!==Lt.aliasName||(this.shouldUpdateCharacterList=!0,e.data.identifier!==this.sendFrom))return;const i=Xe.instance.get(e.data.identifier);i&&!this.allowsChat(i)&&(this.sendFrom=0<this.gameCharacters.length&&this.onlyCharacters?this.gameCharacters[0].identifier:this.myPeer.identifier)}).on("DISCONNECT_PEER",e=>{const i=Xe.instance.get(this.sendTo);i instanceof _t&&i.peerId===e.data.peerId&&(this.sendTo="")}).on("WRITING_A_MESSAGE",e=>{e.isSendFromSelf||e.data!==this.chatTabidentifier||(this.writingPeers.has(e.sendFrom)||this.writingPeers.set(e.sendFrom,new uc(()=>{this.writingPeers.delete(e.sendFrom),this.updateWritingPeerNames(),this.ngZone.run(()=>{})},2e3)),this.writingPeers.get(e.sendFrom).reset(),this.updateWritingPeerNames(),this.batchService.add(()=>this.ngZone.run(()=>{}),this))})}ngOnDestroy(){Qe.unregister(this),this.batchService.remove(this)}updateWritingPeerNames(){this.writingPeerNames=Array.from(this.writingPeers.keys()).map(e=>{const i=_t.findByPeerId(e);return i?i.name:""})}onInput(){if(null===this.writingEventInterval&&this.previousWritingLength<=this.text.length){let e=null;if(this.isDirect){const i=Xe.instance.get(this.sendTo);if(i instanceof _t){const r=zi.parse(i.peerId);r&&(e=r.peerId)}}Qe.call("WRITING_A_MESSAGE",this.chatTabidentifier,e),this.writingEventInterval=setTimeout(()=>{this.writingEventInterval=null},200)}this.previousWritingLength=this.text.length,this.calcFitHeight()}sendChat(e){if(e&&e.preventDefault(),!this.text.length||e&&13!==e.keyCode)return;this.sendFrom.length||(this.sendFrom=this.myPeer.identifier);const i={text:this.text,sendFrom:this.sendFrom,sendTo:this.sendTo,tachieNum:this.tachieNum,messColor:this.selectChatColor};sr.loadGameSystemAsync(this.gameType).then(o=>{this.chat.emit({text:i.text,gameSystem:o,sendFrom:i.sendFrom,sendTo:i.sendTo,tachieNum:i.tachieNum,messColor:i.messColor})}),this.text="",this.previousWritingLength=this.text.length,this.textAreaElementRef.nativeElement.value="",this.calcFitHeight()}allBoxCheck(){this.allBox.emit(this.selectNum>0?{check:!1}:{check:!0})}calcFitHeight(){const e=this.textAreaElementRef.nativeElement;e.style.height="",e.scrollHeight>=e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}loadDiceBot(e){console.log("onChangeGameType ready"),sr.getHelpMessage(e).then(i=>{console.log("onChangeGameType done\n"+i)})}buffHideChkChange(e){console.log("buffHideChkChange:"+e),this.hideChkEvent.emit(e),this.buffHideIsChk=e}allowsChat(e){switch(e.location.name){case"table":return!e.hideInventory;case this.myPeer.peerId:return!0;case"graveyard":return!1;default:for(const i of bt.peerContexts)if(i.isOpen&&e.location.name===i.peerId)return!1;return!0}}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(go),Be(Rp),Be($n),Be(Di))},n.\u0275cmp=Qt({type:n,selectors:[["controller-input"]],viewQuery:function(e,i){if(1&e&&Gn(kK,7),2&e){let r;yn(r=Cn())&&(i.textAreaElementRef=r.first)}},inputs:{onlyCharacters:"onlyCharacters",chatTabidentifier:"chatTabidentifier",_gameType:["gameType","_gameType"],_sendFrom:["sendFrom","_sendFrom"],_sendTo:["sendTo","_sendTo"],_text:["text","_text"],_selectNum:["selectNum","_selectNum"]},outputs:{gameTypeChange:"gameTypeChange",sendFromChange:"sendFromChange",sendToChange:"sendToChange",textChange:"textChange",chat:"chat",allBox:"allBox",hideChkEvent:"hideChkEvent"},decls:41,vars:33,consts:[[1,"table",3,"ngClass"],[1,"table"],[1,"table-cell","imagebox"],["class","image",3,"src",4,"ngIf"],[1,"table-cell"],[1,"ud-select",2,"width","10em",3,"ngModel","searchable","clearable","ngModelChange"],[3,"value",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[1,"color",3,"ngStyle","click"],[1,"color-setting","small-font",3,"click"],[1,"material-icons","small-font"],[2,"font-size","0.8em","text-align","right"],[1,"color-setting","small-font",2,"width","7em",3,"click"],[4,"ngIf"],[1,"tachie-tag"],[2,"width","100%"],[2,"float","right","text-align","right"],["name","buff_hide_chk","type","checkbox",3,"change"],[3,"hidden"],["placeholder","Enter\u3067\u9001\u4fe1",1,"controller-input",3,"ngModel","ngModelOptions","ngModelChange","input","keydown.enter"],["textArea",""],["type","submit",3,"click"],[1,"image",3,"src"],[3,"value"],["type","range","min","0","max","0",3,"ngModel","ngModelChange"],["type","range","min","0",3,"max","ngModel","ngModelChange"]],template:function(e,i){1&e&&(J(0,"div",0)(1,"div",1)(2,"div",2),Ee(3,MK,2,4,"img",3),oe(),J(4,"div",4)(5,"div",1)(6,"div",4)(7,"div")(8,"ng-select",5),Re("ngModelChange",function(o){return i.sendFrom=o}),Ee(9,AK,2,2,"ng-option",6),Ee(10,PK,2,2,"ng-option",7),oe()(),J(11,"div")(12,"div",8),Re("click",function(){return i.setColorNum(0)}),oe(),J(13,"div",8),Re("click",function(){return i.setColorNum(1)}),oe(),J(14,"div",8),Re("click",function(){return i.setColorNum(2)}),oe(),J(15,"button",9),Re("click",function(){return i.shoeColorSetting()}),J(16,"i",10),we(17,"settings"),oe(),we(18,"\u8272\u8a2d\u5b9a"),oe()()(),J(19,"div",4)(20,"div",11),we(21),it(22,"br"),J(23,"button",12),Re("click",function(){return i.allBoxCheck()}),Ee(24,FK,2,0,"ng-container",13),Ee(25,RK,2,0,"ng-container",13),oe()()()(),J(26,"div",14),Ee(27,NK,4,6,"ng-container",13),Ee(28,LK,6,11,"ng-container",13),oe()()(),it(29,"hr"),J(30,"div",15),we(31,"\u30d0\u30d5/\u30c7\u30d0\u30c3\u30d5\u30a1\u30fc "),J(32,"div",16),we(33,"\u96a0\u3059 "),J(34,"input",17),Re("change",function(o){return i.buffHideChkChange(o.target.checked)}),oe()(),J(35,"form")(36,"div",18)(37,"textarea",19,20),Re("ngModelChange",function(o){return i.text=o})("input",function(){return i.onInput()})("keydown.enter",function(o){return i.sendChat(o)}),oe(),J(39,"button",21),Re("click",function(){return i.sendChat(null)}),we(40,"\u5b9f\u884c"),oe()()()()()),2&e&&(ie("ngClass",Nt(18,zK,i.isDirect)),j(3),ie("ngIf",0<i.imageFile.url.length),j(5),ie("ngModel",i.sendFrom)("searchable",!1)("clearable",!1),j(1),ie("ngIf",!i.onlyCharacters),j(1),ie("ngForOf",i.gameCharacters),j(2),ie("ngStyle",Wo(20,Gw,i.charactorChatColor_0,"solid "+i.colorSelectorBoxBorder_0+" #666666",i.colorSelectorRadius_0)),j(1),ie("ngStyle",Wo(24,Gw,i.charactorChatColor_1,"solid "+i.colorSelectorBoxBorder_1+" #666666",i.colorSelectorRadius_1)),j(1),ie("ngStyle",Wo(28,Gw,i.charactorChatColor_2,"solid "+i.colorSelectorBoxBorder_2+" #666666",i.colorSelectorRadius_2)),j(7),sn(" \u9078\u629e\u6570\uff1a",i.selectNum,""),j(3),ie("ngIf",0!=i.selectNum),j(1),ie("ngIf",0==i.selectNum),j(2),ie("ngIf",1>=i.selectCharacterTachieNum),j(1),ie("ngIf",1<i.selectCharacterTachieNum),j(8),ie("hidden",i.buffHideIsChk),j(1),ie("ngModel",i.text)("ngModelOptions",$r(32,HK)))},directives:[ir,Sn,gp,Ti,yi,wf,si,Co,oa,Fi,_s,gs,xo],pipes:[Ii],styles:["div.color[_ngcontent-%COMP%]{display:inline-block;border:solid 1px #000;box-sizing:border-box;position:relative;top:4px;width:18px;height:18px;margin-left:2px;margin-right:2px;background-color:#888;cursor:pointer}button.color[_ngcontent-%COMP%]:focus{outline:none}.table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table[_ngcontent-%COMP%]   .table-cell[_ngcontent-%COMP%]{display:table-cell}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.controller-input[_ngcontent-%COMP%]{font-family:inherit;font-size:13px;width:calc(100% - 100px);height:calc(1em + 4px);min-height:calc(1em + 7px);max-height:calc(6em + 7px);resize:none;overflow:auto;padding:1px;margin:5px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;vertical-align:bottom}.writing-info[_ngcontent-%COMP%]{font-size:8px;height:1.3em}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}"]}),n})();const UK=["controllerInput"],jK=["chatPalette"];function GK(n,t){if(1&n){const e=pt();J(0,"label")(1,"input",16),Re("ngModelChange",function(r){return Le(e),$e().chatTabidentifier=r}),oe(),J(2,"div"),we(3),oe()()}if(2&n){const e=t.$implicit,i=$e();j(1),Ht("value",e.identifier),ie("ngModel",i.chatTabidentifier),j(2),xt(e.name)}}function qK(n,t){if(1&n&&(J(0,"div"),we(1),oe()),2&n){const e=$e(2);j(1),sn("",e.errorMessageBuff," ")}}function WK(n,t){1&n&&(J(0,"div",22)(1,"i",23),we(2,"info_outline"),oe(),we(3," \u30d0\u30d5\u7de8\u96c6\u4e2d\u3067\u3059"),oe())}const ZK=function(){return{standalone:!0}};function YK(n,t){if(1&n){const e=pt();Je(0),J(1,"textarea",27,28),Re("ngModelChange",function(r){return Le(e),$e(3).text=r})("input",function(){return Le(e),$e(3).onInput()})("keydown.enter",function(r){return Le(e),$e(3).sendChat(r)}),oe(),J(3,"button",29),Re("click",function(){return Le(e),$e(3).sendChat(null)}),we(4,"\u5b9f\u884c"),oe(),et()}if(2&n){const e=$e(3);j(1),ie("ngModel",e.text)("ngModelOptions",$r(2,ZK))}}function KK(n,t){if(1&n&&(J(0,"option",31),we(1),oe()),2&n){const e=t.$implicit;Ht("value",e),j(1),xt(e)}}function XK(n,t){if(1&n&&(Je(0),Ee(1,KK,2,2,"option",30),et()),2&n){const e=$e(3);j(1),ie("ngForOf",e.palette.getPalette())}}function QK(n,t){if(1&n){const e=pt();J(0,"div",24)(1,"select",25,26),Re("input",function(r){return Le(e),$e(2).selectPalette(r.target.value)})("click",function(r){return Le(e),$e(2).clickPalette(r.target.value)}),J(3,"form"),Ee(4,YK,5,3,"ng-container",8),oe(),Ee(5,XK,2,1,"ng-container",8),oe()()}if(2&n){const e=$e(2);j(4),ie("ngIf",!e.buffHideIsChk),j(1),ie("ngIf",e.palette)}}function JK(n,t){if(1&n){const e=pt();J(0,"div",24)(1,"textarea",32),Re("ngModelChange",function(r){return Le(e),$e(2).editPalette=r}),oe()()}if(2&n){const e=$e(2);j(1),ie("ngModel",e.editPalette)}}function eX(n,t){1&n&&(J(0,"span"),we(1,"\u30d0\u30d5\u30d1\u30ec\u30c3\u30c8\u7de8\u96c6"),oe())}function tX(n,t){1&n&&(J(0,"span"),we(1,"\u30d0\u30d5\u30d1\u30ec\u30c3\u30c8\u78ba\u5b9a"),oe())}function nX(n,t){if(1&n){const e=pt();Je(0),Ee(1,qK,2,1,"div",8),Ee(2,WK,4,0,"div",17),Ee(3,QK,6,2,"div",18),Ee(4,JK,2,1,"div",18),J(5,"div",19)(6,"button",20),Re("click",function(){return Le(e),$e().toggleEditMode()}),Ee(7,eX,2,0,"span",8),Ee(8,tX,2,0,"span",8),oe(),it(9,"BR"),J(10,"button",21),Re("click",function(){return Le(e),$e().decBuffRoundSelect()}),J(11,"span"),we(12,"\u30d0\u30d5R\u6e1b\u5c11/\u9078\u629e"),oe()(),J(13,"button",21),Re("click",function(){return Le(e),$e().decBuffRoundAll()}),J(14,"span"),we(15,"\u30d0\u30d5R\u6e1b\u5c11/\u5168\u54e1"),oe()(),J(16,"button",21),Re("click",function(){return Le(e),$e().deleteZeroRoundBuffSelect()}),J(17,"span"),we(18,"0R\u4ee5\u4e0b\u6d88\u53bb/\u9078\u629e"),oe()(),J(19,"button",21),Re("click",function(){return Le(e),$e().deleteZeroRoundBuffAll()}),J(20,"span"),we(21,"0R\u4ee5\u4e0b\u6d88\u53bb/\u5168\u54e1"),oe()()(),et()}if(2&n){const e=$e();j(1),ie("ngIf",e.errorMessageBuff.length>0),j(1),ie("ngIf",e.isEdit),j(1),ie("ngIf",!e.isEdit),j(1),ie("ngIf",e.isEdit),j(3),ie("ngIf",!e.isEdit),j(1),ie("ngIf",e.isEdit)}}function iX(n,t){if(1&n&&(J(0,"div"),we(1),oe()),2&n){const e=$e(2);j(1),sn("",e.errorMessageController," ")}}function rX(n,t){if(1&n){const e=pt();J(0,"div")(1,"label")(2,"input",42),Re("click",function(){Le(e);const r=$e(2).$implicit;return $e(4).remoteSelect(r.name,"now",r.name+"\u73fe\u5728\u5024")}),oe(),J(3,"div"),we(4),oe()(),J(5,"label")(6,"input",42),Re("click",function(){Le(e);const r=$e(2).$implicit;return $e(4).remoteSelect(r.name,"max",r.name+"\u6700\u5927\u5024")}),oe(),J(7,"div"),we(8),oe()()()}if(2&n){const e=$e(2).$implicit;j(2),Ht("value",e.name+"\u73fe\u5728\u5024"),j(2),xt(e.name+"\u73fe\u5728\u5024"),j(2),Ht("value",e.name+"\u6700\u5927\u5024"),j(2),xt(e.name+"\u6700\u5927\u5024")}}function oX(n,t){if(1&n){const e=pt();J(0,"label")(1,"input",42),Re("click",function(){Le(e);const r=$e(2).$implicit;return $e(4).remoteSelect(r.name,"now",r.name)}),oe(),J(2,"div"),we(3),oe()()}if(2&n){const e=$e(2).$implicit;j(1),Ht("value",e.name),j(2),xt(e.name)}}function sX(n,t){if(1&n&&(Je(0)(1,39),Ee(2,rX,9,4,"div",40),Ee(3,oX,4,2,"label",41),et()()),2&n){const e=$e().$implicit;j(1),ie("ngSwitch",e.attributes.type),j(1),ie("ngSwitchCase","numberResource")}}function aX(n,t){if(1&n&&(Je(0),Ee(1,sX,4,2,"ng-container",8),et()),2&n){const e=t.$implicit,i=$e(4);j(1),ie("ngIf",e&&i.dataTags.includes(e.name))}}function lX(n,t){if(1&n&&(Je(0),Ee(1,aX,2,1,"ng-container",5),et()),2&n){const e=t.$implicit;j(1),ie("ngForOf",e.children)}}function cX(n,t){if(1&n&&(J(0,"div")(1,"div",38),Ee(2,lX,2,1,"ng-container",5),oe()()),2&n){const e=$e(2);j(2),ie("ngForOf",e.character.detailDataElement.children)}}function uX(n,t){if(1&n){const e=pt();Je(0),J(1,"div"),we(2," \u5909\u66f4\u91cf "),J(3,"input",33),Re("ngModelChange",function(r){return Le(e),$e().remoteNumber=r}),oe(),J(4,"button",34),Re("click",function(){return Le(e),$e().reverseValue()}),J(5,"span"),we(6," \xb1 "),oe()(),J(7,"button",29),Re("click",function(){return Le(e),$e().remoteChangeValue()}),J(8,"span"),we(9,"\u64cd\u4f5c"),oe()(),J(10,"div",35),we(11," \u6700\u5927\u5236\u9650 "),J(12,"input",36),Re("ngModelChange",function(r){return Le(e),$e().recoveryLimitFlag=r})("change",function(r){return Le(e),$e().recoveryLimitFlagChange(r.target.checked)}),oe(),it(13,"br"),we(14," 0\u5236\u9650 "),J(15,"input",37),Re("ngModelChange",function(r){return Le(e),$e().recoveryLimitFlagMin=r})("change",function(r){return Le(e),$e().recoveryLimitFlagChange(r.target.checked)}),oe()()(),Ee(16,iX,2,1,"div",8),Ee(17,cX,3,1,"div",8),et()}if(2&n){const e=$e();j(3),ie("ngModel",e.remoteNumber),j(9),ie("ngModel",e.recoveryLimitFlag),j(3),ie("ngModel",e.recoveryLimitFlagMin),j(1),ie("ngIf",e.errorMessageController.length>0),j(1),ie("ngIf",e.character.rootDataElement)}}function dX(n,t){if(1&n&&(J(0,"div"),we(1),oe()),2&n){const e=$e();j(1),sn("",e.getTabTitle(e.selectTab),"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306f\u7a7a\u3067\u3059")}}function fX(n,t){1&n&&pn(0)}const hX=function(){return{box:!0,selected:0}},pX=function(n){return{gameObject:n}};function gX(n,t){if(1&n&&(J(0,"div",43),Ee(1,fX,1,0,"ng-container",44),oe()),2&n){const e=t.$implicit;$e();const i=ln(21);ie("ngClass",$r(3,hX)),j(1),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",Nt(4,pX,e))}}function _X(n,t){1&n&&(it(0,"img",55),At(1,"safe")),2&n&&ie("src",Ft(1,1,$e().gameObject.imageFile.url,"resourceUrl"),hn)}function mX(n,t){1&n&&pn(0)}const $X=function(n){return{dataElm:n}};function vX(n,t){if(1&n&&(Je(0),Ee(1,mX,1,0,"ng-container",44),et()),2&n){const e=t.$implicit;$e(3);const i=ln(23);j(1),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",Nt(2,$X,e))}}function bX(n,t){if(1&n&&(J(0,"div"),Ee(1,vX,2,4,"ng-container",56),oe()),2&n){const e=$e().gameObject,i=$e();j(1),ie("ngForOf",i.getInventoryTags(e))("ngForTrackBy",i.trackByGameObject)}}function yX(n,t){if(1&n){const e=pt();J(0,"div",45)(1,"div",46)(2,"div")(3,"span",47),we(4),oe(),J(5,"button",48),Re("click",function(){const o=Le(e).gameObject;return $e().buffEdit(o)}),we(6,"\u30d0\u30d5\u7de8\u96c6"),oe()(),J(7,"div",49)(8,"div",50),Re("click",function(){const o=Le(e).gameObject;return $e().targetBlockClick(o)}),J(9,"div",51),Ee(10,_X,2,4,"img",52),oe(),it(11,"input",53),oe(),J(12,"div",54),Ee(13,bX,2,2,"div",8),oe()()()()}if(2&n){const e=t.gameObject,i=$e();j(4),xt(e.name),j(6),ie("ngIf",e.imageFile.url),j(1),tp("id","",e.identifier,"_",i.initTimestamp,""),j(2),ie("ngIf",e.rootDataElement)}}function CX(n,t){1&n&&(Je(0),it(1,"br"),et())}function xX(n,t){if(1&n){const e=pt();Je(0),J(1,"div",59),we(2),oe(),J(3,"div",60)(4,"div",61)(5,"div",62)(6,"div",63),we(7),oe(),J(8,"div",63),we(9),oe(),J(10,"div",49)(11,"div",64)(12,"div",65),we(13,"\xa0"),oe(),J(14,"div",65),we(15,"/"),oe()(),J(16,"div",54)(17,"input",66),Re("ngModelChange",function(r){return Le(e),$e(2).dataElm.currentValue=r}),oe(),J(18,"input",66),Re("ngModelChange",function(r){return Le(e),$e(2).dataElm.value=r}),oe()()()()()(),et()}if(2&n){const e=$e(2).dataElm;j(2),xt(e.name),j(5),sn("\xa0\xa0",e.value,""),j(2),sn("\xa0\xa0",e.currentValue,""),j(8),Qn("color:"+e.nowValueColor+";"),ie("ngModel",e.currentValue),j(1),ie("ngModel",e.value)}}function wX(n,t){if(1&n){const e=pt();J(0,"input",70),Re("click",function(){return Le(e),$e(3).dataElm.value=0}),oe()}}function EX(n,t){if(1&n){const e=pt();J(0,"input",71),Re("click",function(){return Le(e),$e(3).dataElm.value=1}),oe()}}function TX(n,t){if(1&n&&(Je(0),J(1,"div",59),we(2),oe(),J(3,"div",67)(4,"div",61)(5,"div",62),Ee(6,wX,1,0,"input",68),Ee(7,EX,1,0,"input",69),oe()()(),et()),2&n){const e=$e(2).dataElm;j(2),xt(e.name),j(4),ie("ngIf",0!=e.value),j(1),ie("ngIf",0==e.value)}}function SX(n,t){1&n&&pn(0)}function DX(n,t){1&n&&pn(0)}function IX(n,t){if(1&n){const e=pt();Je(0),J(1,"div",59),we(2),oe(),J(3,"div",60)(4,"div",61)(5,"div",62)(6,"div",63),we(7),oe(),J(8,"input",66),Re("ngModelChange",function(r){return Le(e),$e(2).dataElm.value=r}),oe()()()(),et()}if(2&n){const e=$e(2).dataElm;j(2),xt(e.name),j(5),xt(e.value),j(1),ie("ngModel",e.value)}}function kX(n,t){if(1&n&&(J(0,"div",58),Je(1,39),Ee(2,xX,19,7,"ng-container",40),Ee(3,TX,8,3,"ng-container",40),Ee(4,SX,1,0,"ng-container",40),Ee(5,DX,1,0,"ng-container",40),Ee(6,IX,9,3,"ng-container",41),et(),oe()),2&n){const e=$e().dataElm;j(1),ie("ngSwitch",e.attributes.type),j(1),ie("ngSwitchCase","numberResource"),j(1),ie("ngSwitchCase","check"),j(1),ie("ngSwitchCase","note"),j(1),ie("ngSwitchCase","markdown")}}function MX(n,t){if(1&n&&(Ee(0,CX,2,0,"ng-container",8),Ee(1,kX,7,5,"div",57)),2&n){const e=t.dataElm,i=$e();ie("ngIf",(null==e?null:e.name)===i.newLineString),j(1),ie("ngIf",e&&e.name!==i.newLineString)}}let HP=(()=>{class n{constructor(e,i,r,o,s,a){this.chatMessageService=e,this.panelService=i,this.changeDetector=r,this.inventoryService=o,this.contextMenuService=s,this.pointerDeviceService=a,this.character=null,this.errorMessageBuff="",this.errorMessageController="",this._gameType="",this.initTimestamp=0,this.text="",this.buffAreaIsHide=!1,this.controllerAreaIsHide=!1,this.chatTabidentifier="",this.remoteNumber=0,this.recoveryLimitFlag=!1,this.recoveryLimitFlagMin=!1,this.disptimer=null,this.selectCharacter=null,this.remoteControllerSelect={name:"",nowOrMax:"",dispName:""},this.remoteControllerRadio="",this.remoteControlleridentifier=["test01","test02"],this.inputText="",this.isEdit=!1,this.editPalette="",this.doubleClickTimer=null,this.charList=[],this.inventoryTypes=["table","common","graveyard"],this.selectTab="table",this.selectedIdentifier="",this.initTimestamp=Date.now(),console.log("this.initTimestamp "+this.initTimestamp)}get palette(){return this.character.remoteController}get gameType(){return null==this._gameSystem?"":this._gameSystem.ID}set gameType(e){sr.loadGameSystemAsync(e).then(i=>{this._gameSystem=i,this.character.remoteController&&(this.character.remoteController.dicebot=i.ID)})}get sendFrom(){return this.character.identifier}set sendFrom(e){this.onSelectedCharacter(e)}get diceBotInfos(){return sr.diceBotInfos}get chatTab(){return Xe.instance.get(this.chatTabidentifier)}get myPeer(){return _t.myCursor}get otherPeers(){return Xe.instance.getObjects(_t)}get sortTag(){return this.inventoryService.sortTag}set sortTag(e){this.inventoryService.sortTag=e}get sortOrder(){return this.inventoryService.sortOrder}set sortOrder(e){this.inventoryService.sortOrder=e}get dataTag(){return this.inventoryService.dataTag}set dataTag(e){this.inventoryService.dataTag=e}get dataTags(){return this.inventoryService.dataTags}get sortOrderName(){return this.sortOrder===_d.ASC?"\u6607\u9806":"\u964d\u9806"}get newLineString(){return this.inventoryService.newLineString}hideChkBoxEvent(e){this.buffAreaIsHide=e}controllerHideChkChange(e){this.controllerAreaIsHide=e}recoveryLimitFlagChange(e){}reverseValue(){this.remoteNumber=-this.remoteNumber}remoteSelect(e,i,r){this.remoteControllerSelect.name=e,this.remoteControllerSelect.nowOrMax=i,this.remoteControllerSelect.dispName=r}charListChange(e,i){i?this.charList.indexOf(e)<0&&this.charList.push(e):this.charList.indexOf(e)>-1&&this.charList.splice(this.charList.indexOf(e),1)}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"",this.gameType=this.character.remoteController?this.character.remoteController.dicebot:"",Qe.register(this).on("DELETE_GAME_OBJECT",-1e3,e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close(),this.chatTabidentifier===e.data.identifier&&(this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"")}),Qe.register(this).on("SELECT_TABLETOP_OBJECT",-1e3,e=>{Xe.instance.get(e.data.identifier)instanceof Qr&&(this.selectedIdentifier=e.data.identifier,this.changeDetector.markForCheck())}).on("CHK_TARGET_CHANGE",-1e3,e=>{Xe.instance.get(e.data.identifier)instanceof Lt&&(this.targetSetChkBox(Xe.instance.get(e.data.identifier)),console.log("REC CHK_TARGET_CHANGE"))}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("UPDATE_INVENTORY",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("OPEN_NETWORK",e=>{this.inventoryTypes=["table","common",bt.peerId,"graveyard"],this.inventoryTypes.includes(this.selectTab)||(this.selectTab=bt.peerId)}),this.inventoryTypes=["table","common",bt.peerId,"graveyard"],this.disptimer=setInterval(()=>{this.changeDetector.detectChanges();const e=this.getGameObjects(this.selectTab);for(const i of e)i instanceof Lt&&this.targetSetChkBox(i)},200)}ngOnDestroy(){Qe.unregister(this),this.disptimer=null,this.isEdit&&this.toggleEditMode()}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30ea\u30e2\u30b3\u30f3"}onSelectedCharacter(e){this.isEdit&&this.toggleEditMode();const i=Xe.instance.get(e);if(i instanceof Lt){this.character=i;const r=this.character.remoteController?this.character.remoteController.dicebot:"";0<r.length&&(this.gameType=r)}this.updatePanelTitle()}selectPalette(e){this.text=e}clickPalette(e){this.doubleClickTimer&&this.text===e?(clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.controllerInputComponent.sendChat(null)):(this.text=e,this.doubleClickTimer=setTimeout(()=>{this.doubleClickTimer=null},400))}resetPaletteSelect(){!this.chatPaletteElementRef.nativeElement||(this.chatPaletteElementRef.nativeElement.selectedIndex=-1)}toggleEditMode(){this.isEdit=!this.isEdit,this.isEdit?this.editPalette=this.palette.value+"":this.palette.setPalette(this.editPalette)}ngAfterViewInit(){}getTabTitle(e){switch(e){case"table":return"\u30c6\u30fc\u30d6\u30eb";case bt.peerId:return"\u500b\u4eba";case"graveyard":return"\u5893\u5834";default:return"\u5171\u6709"}}getInventory(e){switch(e){case"table":return this.inventoryService.tableInventory;case bt.peerId:return this.inventoryService.privateInventory;case"graveyard":return this.inventoryService.graveyardInventory;default:return this.inventoryService.commonInventory}}getGameObjects(e){if("table"===e){const i=[],r=this.inventoryService.tableInventory.tabletopObjects;for(const o of r)o.hideInventory||i.push(o);return i}}getInventoryTags(e){return this.getInventory(e.location.name).dataElementMap.get(e.identifier)}toggleEdit(){this.isEdit=!this.isEdit}selectGameObject(e){Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName}),this.selectCharacter=e}getTargetCharacters(e){const i=new Array,r=this.getGameObjects(this.selectTab);for(const o of r)if(o instanceof Lt){if(o.hideInventory)continue;const s=document.getElementById(o.identifier+"_"+this.initTimestamp);s&&(s.checked||!e)&&i.push(o)}return i}remoteDecBuffRound(e){let i="";const r=this.getTargetCharacters(e);if(!(r.length<=0)&&this.chatTab&&r.length>0){for(const a of r)a.decreaseBuffRound(),i=i+"["+a.name+"]";this.chatMessageService.sendMessage(this.chatTab,"\u30d0\u30d5\u306eR\u3092\u6e1b\u5c11 "+i,this._gameSystem,this.sendFrom,"",this.controllerInputComponent.tachieNum)}}decBuffRoundSelect(){this.remoteDecBuffRound(!0)}decBuffRoundAll(){this.remoteDecBuffRound(!1)}remoteBuffDeleteZeroRound(e){let i="";const r=this.getTargetCharacters(e);if(r.length>0){for(const a of r)a.deleteZeroRoundBuff(),i=i+"["+a.name+"]";this.chatMessageService.sendMessage(this.chatTab,"0R\u4ee5\u4e0b\u306e\u30d0\u30d5\u3092\u6d88\u53bb "+i,this._gameSystem,this.sendFrom,"",this.controllerInputComponent.tachieNum)}}deleteZeroRoundBuffSelect(){this.remoteBuffDeleteZeroRound(!0)}deleteZeroRoundBuffAll(){this.remoteBuffDeleteZeroRound(!1)}remoteAddBuffRound(e,i,r,o){if(!(e.length<=0))for(const a of e)a.addBuffRound(i,r,o)}sendChat(e){let i="";const r=this.getTargetCharacters(!0),o=e.text.split(/\s+/);let s=null,a="",g="",w="";if(0!=o.length&&""!=o[0])if(g=o[0],w=o[0],o.length>1&&(a=o[1],w=w+"/"+o[1]),o.length>2?(s=parseInt(o[2]),Number.isNaN(s)&&(s=3)):s=3,w=w+"/"+s+"R",r.length>0){for(const ve of r)i=i+"["+ve.name+"]";this.remoteAddBuffRound(r,g,a,s),this.chatMessageService.sendMessage(this.chatTab,"\u30d0\u30d5\u3092\u4ed8\u4e0e "+w+" > "+i,this._gameSystem,this.sendFrom,"",e.tachieNum,e.messColor),this.errorMessageBuff=""}else this.errorMessageBuff="\u5bfe\u8c61\u304c\u672a\u9078\u629e\u3067\u3059"}remoteChangeValue(){let e="";const i=this.getTargetCharacters(!0);if(""!=this.remoteControllerSelect.name){for(const r of i)e+=r.changeStatusValue(this.remoteControllerSelect.name,this.remoteControllerSelect.nowOrMax,this.remoteNumber,this.recoveryLimitFlagMin,this.recoveryLimitFlag);if(""!=e){let r="+";this.remoteNumber<0&&(r=""),this.chatMessageService.sendMessage(this.chatTab,"["+this.remoteControllerSelect.dispName+"]\u5909\u66f4["+r+this.remoteNumber+"]\uff1e"+e,this._gameSystem,this.sendFrom,"",this.controllerInputComponent.tachieNum,this.controllerInputComponent.selectChatColor),this.errorMessageController=""}else this.errorMessageController="\u5bfe\u8c61\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c\u672a\u9078\u629e\u3067\u3059"}else this.errorMessageController="\u5909\u66f4\u9805\u76ee\u304c\u672a\u9078\u629e\u3067\u3059"}trackByGameObject(e,i){return i?i.identifier:e}buffEdit(e){const i=this.pointerDeviceService.pointers[0],r={left:i.x,top:i.y,width:420,height:300};r.title=e.name+"\u306e\u30d0\u30d5\u7de8\u96c6",this.panelService.open(zP,r).character=e}allBoxCheck(e){const i=this.getGameObjects(this.selectTab);for(const r of i)if(r instanceof Lt){const o=document.getElementById(r.identifier+"_"+this.initTimestamp);r.targeted=e.check,o&&(o.checked=r.targeted,Qe.trigger("CHK_TARGET_CHANGE",{identifier:r.identifier,className:r.aliasName}))}}targetSetChkBox(e){const i=document.getElementById(e.identifier+"_"+this.initTimestamp);i&&(i.checked=e.targeted)}targetBlockClick(e){console.log("targetBlockClick"),e.targeted=!e.targeted,this.targetSetChkBox(e),Qe.trigger("CHK_TARGET_CHANGE",{identifier:e.identifier,className:e.aliasName})}onChange(e){console.log("onChange"),this.targetBlockClick(e)}}return n.\u0275fac=function(e){return new(e||n)(Be(go),Be($n),Be(bi),Be(ab),Be(To),Be(Di))},n.\u0275cmp=Qt({type:n,selectors:[["remote-controller"]],viewQuery:function(e,i){if(1&e&&(Gn(UK,7),Gn(jK,5)),2&e){let r;yn(r=Cn())&&(i.controllerInputComponent=r.first),yn(r=Cn())&&(i.chatPaletteElementRef=r.first)}},inputs:{character:"character"},decls:24,vars:12,consts:[[1,"remote-controller-wrapper"],[1,"sticky-top-left","is-caret"],[1,"flex-container","is-caret"],[1,"is-caret",2,"flex-grow","0"],[1,"chat-tab"],[4,"ngFor","ngForOf"],[3,"onlyCharacters","chatTabidentifier","gameType","sendFrom","text","selectNum","gameTypeChange","sendFromChange","textChange","selectNumChange","allBox","chat","hideChkEvent"],["controllerInput",""],[4,"ngIf"],[2,"width","100%"],[2,"float","right","text-align","right"],["name","buff_hide_chk","type","checkbox",3,"change"],[1,"controller-right"],[3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["gameObjectTags",""],["dataElmTag",""],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","edit-info",4,"ngIf"],["style","flex-grow: 1; height: 0; min-height: 100px;",4,"ngIf"],[2,"flex-grow","0"],["type","submit",2,"width","20em",3,"click"],["type","submit",2,"width","10em",3,"click"],[1,"edit-info"],[1,"material-icons",2,"vertical-align","bottom","size","0.8rem"],[2,"flex-grow","1","height","0","min-height","100px"],["size","5",1,"palette",2,"overflow-y","auto",3,"input","click"],["chatPalette",""],["placeholder","Enter\u3067\u9001\u4fe1",1,"controller-input","is-caret",3,"ngModel","ngModelOptions","ngModelChange","input","keydown.enter"],["textArea",""],["type","submit",3,"click"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placeholder","\u30d0\u30d5\u30d1\u30ec\u30c3\u30c8",1,"palette","is-caret",2,"resize","none",3,"ngModel","ngModelChange"],["size","1","type","number","placeholder","Value",2,"width","3.0em","font-size","1.2em",3,"ngModel","ngModelChange"],[3,"click"],[2,"float","right","text-align","right","margin-top","5px"],["name","max_limit_chk","type","checkbox",3,"ngModel","ngModelChange","change"],["name","min_limit_chk","type","checkbox",3,"ngModel","ngModelChange","change"],[1,"controller"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["name","controller","type","radio","ng-control","options",3,"value","click"],[3,"ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"inventory-object"],[1,"object-tags-box"],[1,"object-name"],[1,"tab-setting","small-font",3,"click"],[1,"table"],[1,"table-cell","click-area",3,"click"],[1,"image-box"],[3,"src",4,"ngIf"],["name","target_chk","value","object.targeted","type","checkbox",1,"target_chk",3,"id"],[1,"table-cell"],[3,"src"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","object-tag",4,"ngIf"],[1,"object-tag"],[1,"tag-name"],[2,"text-align","center"],[2,"display","inline-block"],[1,"tag-value-box"],[1,"hidden-spacer",2,"font-weight","bold"],[1,"table-cell","tag-slash"],[2,"padding","2px"],["size","1","placeholder","",1,"input","tag-value","is-caret",3,"ngModel","ngModelChange"],[2,"text-align","center","margin","2px 0px 0px 0px"],["type","checkbox","checked","",3,"click",4,"ngIf"],["type","checkbox",3,"click",4,"ngIf"],["type","checkbox","checked","",3,"click"],["type","checkbox",3,"click"]],template:function(e,i){1&e&&(J(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"form")(5,"div",4),Ee(6,GK,4,3,"label",5),oe()(),J(7,"controller-input",6,7),Re("gameTypeChange",function(o){return i.gameType=o})("sendFromChange",function(o){return i.sendFrom=o})("textChange",function(o){return i.text=o})("selectNumChange",function(o){return i.getTargetCharacters(!0).length=o})("allBox",function(o){return i.allBoxCheck(o)})("chat",function(o){return i.sendChat(o)})("hideChkEvent",function(o){return i.hideChkBoxEvent(o)}),oe(),Ee(9,nX,22,6,"ng-container",8),oe()(),it(10,"hr"),J(11,"div",9),we(12,"\u30ab\u30a6\u30f3\u30bf\u30fc\u30ea\u30e2\u30b3\u30f3 "),J(13,"div",10),we(14,"\u96a0\u3059 "),J(15,"input",11),Re("change",function(o){return i.controllerHideChkChange(o.target.checked)}),oe()()(),Ee(16,uX,18,5,"ng-container",8),oe(),J(17,"div",12),Ee(18,dX,2,1,"div",8),Ee(19,gX,2,6,"div",13),Ee(20,yX,14,5,"ng-template",null,14,Ln),Ee(22,MX,2,2,"ng-template",null,15,Ln),oe()()),2&e&&(j(6),ie("ngForOf",i.chatMessageService.chatTabs),j(1),ie("onlyCharacters",!0)("chatTabidentifier",i.chatTabidentifier)("gameType",i.gameType)("sendFrom",i.sendFrom)("text",i.text)("selectNum",i.getTargetCharacters(!0).length),j(2),ie("ngIf",!i.buffAreaIsHide),j(7),ie("ngIf",!i.controllerAreaIsHide),j(2),ie("ngIf",i.getGameObjects(i.selectTab).length<1),j(1),ie("ngForOf",i.getGameObjects(i.selectTab))("ngForTrackBy",i.trackByGameObject))},directives:[_s,gs,xo,si,Qu,Fi,Ti,yi,VK,Sn,ic,rc,ms,ra,tc,Wu,gf,ir,Ra],pipes:[Ii],styles:[".edit-info[_ngcontent-%COMP%]{width:100%;text-align:center;color:#ccc;background-color:#1e1e1ecc}.palette[_ngcontent-%COMP%]{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;width:100%;height:100%}.remote-controller-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:100%}.flex-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.chat-tab[_ngcontent-%COMP%]{padding:0 5px 5px;-webkit-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:8px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.controller[_ngcontent-%COMP%]{padding:0 5px 5px;-webkit-user-select:none;user-select:none}.controller[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.controller[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.controller[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer}.controller[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.controller[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border:transparent 2px solid;border-left:transparent 6px solid;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border-bottom:1px dotted #666}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #444}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.input[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;padding:2px;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#EEE}.input[_ngcontent-%COMP%]:focus{background:#FFF}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.tab[_ngcontent-%COMP%]{padding:0;border:solid 1px #555;border-radius:.3em;overflow:hidden;display:flex;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;max-width:500px;background-color:#f0dabde6}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;flex:1 0 auto;flex-grow:1}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:checked{background:#555;color:#ccc}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin:0;padding:2px 8px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table[_ngcontent-%COMP%]{display:table;width:100%}.table-cell[_ngcontent-%COMP%]{display:table-cell}.click-area[_ngcontent-%COMP%]{border:1px dotted #666}.image-box[_ngcontent-%COMP%]{padding:0;width:32px;height:32px;max-width:32px;max-height:32px;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}.resource-tag[_ngcontent-%COMP%]{text-align:center;vertical-align:bottom;overflow:hidden;white-space:nowrap}.resource-value[_ngcontent-%COMP%]{font-weight:700;width:4em;text-align:right;font-family:inherit}.tag-name[_ngcontent-%COMP%]{font-size:.8em;text-align:left;vertical-align:bottom;min-width:1em;max-width:12em;overflow:hidden;white-space:nowrap}.tag-value-box[_ngcontent-%COMP%]{display:table-cell;width:10px}.tag-slash[_ngcontent-%COMP%]{font-size:1em;min-width:.1em;max-width:.1em;text-align:center;font-family:inherit}.tag-value[_ngcontent-%COMP%]{font-size:1em;font-weight:700;width:100%;min-width:1em;max-width:12em;text-align:center;font-family:inherit}.flex-item[_ngcontent-%COMP%]{margin:5px 0;padding:10px;flex:1 0 auto;box-sizing:border-box;min-width:25px;background-color:#eac99dcc;background-color:#f0dabdcc;color:#444}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{display:table-row;box-sizing:border-box}.table-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:table-cell;border:1px solid #FFF;vertical-align:top;box-sizing:border-box}.sticky-top-left[_ngcontent-%COMP%]{flex:1;max-width:21em;height:calc(100% - 11px);overflow-y:scroll;background-color:#f0dabdcc;border-top:1px dotted #666;padding:5px;margin-top:0}.controller-right[_ngcontent-%COMP%]{flex:1;height:100%;overflow-y:scroll}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();function AX(n,t){1&n&&pn(0)}function PX(n,t){1&n&&pn(0)}function FX(n,t){1&n&&pn(0)}function RX(n,t){if(1&n&&(J(0,"div"),we(1),oe()),2&n){const e=$e();j(1),sn("",e.getTabTitle(e.selectTab),"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306f\u7a7a\u3067\u3059")}}function NX(n,t){1&n&&pn(0)}const OX=function(n){return{box:!0,selected:n}},BX=function(n){return{gameObject:n}};function LX(n,t){if(1&n){const e=pt();J(0,"div",10),Re("contextmenu",function(r){const s=Le(e).$implicit;return $e().onContextMenu(r,s)})("click",function(){const o=Le(e).$implicit;return $e().selectGameObject(o)})("dblclick",function(r){const s=Le(e).$implicit;return $e().focusToObject(r,s)}),Ee(1,NX,1,0,"ng-container",11),oe()}if(2&n){const e=t.$implicit,i=$e(),r=ln(14);ie("ngClass",Nt(3,OX,i.selectedIdentifier===e.identifier)),j(1),ie("ngTemplateOutlet",r)("ngTemplateOutletContext",Nt(5,BX,e))}}function zX(n,t){if(1&n){const e=pt();J(0,"div",12)(1,"button",13),Re("click",function(){return Le(e),$e().cleanInventory()}),we(2,"\u5893\u5834\u3092\u7a7a\u306b\u3059\u308b"),oe()()}if(2&n){const e=$e();j(1),Yt("disabled",e.getGameObjects(e.selectTab).length<1?"":null)}}function HX(n,t){if(1&n){const e=pt();J(0,"label")(1,"input",17),Re("ngModelChange",function(r){return Le(e),$e(2).selectTab=r}),oe(),J(2,"div"),we(3),oe()()}if(2&n){const e=t.$implicit,i=$e(2);j(1),Ht("value",e),ie("ngModel",i.selectTab),j(2),Os("",i.getTabTitle(e)," (",i.getInventory(e).length,")")}}function VX(n,t){if(1&n&&(J(0,"form",14)(1,"div",15),Ee(2,HX,4,4,"label",16),oe()()),2&n){const e=$e();j(2),ie("ngForOf",e.inventoryTypes)}}function UX(n,t){if(1&n){const e=pt();Je(0),J(1,"div")(2,"div",18),we(3,"\u4e26\u3073\u9806\u7b2c1"),oe(),J(4,"input",19),Re("ngModelChange",function(r){return Le(e),$e(2).sortTag=r}),oe(),J(5,"select",20),Re("ngModelChange",function(r){return Le(e),$e(2).sortOrder=r}),J(6,"option",21),we(7,"\u6607\u9806"),oe(),J(8,"option",22),we(9,"\u964d\u9806"),oe()()(),J(10,"div")(11,"div",18),we(12,"\u4e26\u3073\u9806\u7b2c2"),oe(),J(13,"input",19),Re("ngModelChange",function(r){return Le(e),$e(2).sortTag2nd=r}),oe(),J(14,"select",20),Re("ngModelChange",function(r){return Le(e),$e(2).sortOrder2nd=r}),J(15,"option",21),we(16,"\u6607\u9806"),oe(),J(17,"option",22),we(18,"\u964d\u9806"),oe()()(),J(19,"div",23),we(20,"\u8868\u793a\u9805\u76ee"),oe(),J(21,"input",24),Re("ngModelChange",function(r){return Le(e),$e(2).dataTag=r}),oe(),J(22,"div",12)(23,"button",25),Re("click",function(){return Le(e),$e(2).toggleEdit()}),J(24,"i",26),we(25,"settings"),oe(),we(26,"\u5b8c\u4e86"),oe()(),et()}if(2&n){const e=$e(2);j(4),ie("ngModel",e.sortTag),j(1),ie("ngModel",e.sortOrder),j(8),ie("ngModel",e.sortTag2nd),j(1),ie("ngModel",e.sortOrder2nd),j(7),ie("ngModel",e.dataTag)}}function jX(n,t){if(1&n&&(Je(0),we(1),et()),2&n){const e=$e(3);j(1),Os("",e.sortTag," (",e.sortOrderName,")")}}function GX(n,t){1&n&&(Je(0),we(1,"-"),et())}function qX(n,t){if(1&n&&(Je(0),we(1),et()),2&n){const e=$e(3);j(1),Os("",e.sortTag2nd," (",e.sortOrderName2nd,")")}}function WX(n,t){1&n&&(Je(0),we(1,"-"),et())}function ZX(n,t){if(1&n){const e=pt();Je(0),J(1,"table",27)(2,"tr")(3,"th",28),we(4,"\u4e26\u3073\u9806 \u7b2c1:"),oe(),J(5,"td",28),Ee(6,jX,2,2,"ng-container",2),Ee(7,GX,2,0,"ng-container",2),oe(),J(8,"th",28),we(9," \u7b2c2:"),oe(),J(10,"td",28),Ee(11,qX,2,2,"ng-container",2),Ee(12,WX,2,0,"ng-container",2),oe(),J(13,"td")(14,"button",25),Re("click",function(){return Le(e),$e(2).toggleEdit()}),J(15,"i",26),we(16,"settings"),oe(),we(17,"\u8a2d\u5b9a"),oe()()()(),et()}if(2&n){const e=$e(2);j(6),ie("ngIf",0<e.sortTag.length),j(1),ie("ngIf",e.sortTag.length<1),j(4),ie("ngIf",0<e.sortTag2nd.length),j(1),ie("ngIf",e.sortTag2nd.length<1)}}function YX(n,t){if(1&n&&(Ee(0,UX,27,5,"ng-container",2),Ee(1,ZX,18,4,"ng-container",2)),2&n){const e=$e();ie("ngIf",e.isEdit),j(1),ie("ngIf",!e.isEdit)}}function KX(n,t){1&n&&(Je(0),we(1,"\u5168\u89e3\u9664\u53e3\u2193"),et())}function XX(n,t){1&n&&we(0,"\u5168\u9078\u629e\u3006\u2193")}function QX(n,t){if(1&n){const e=pt();Je(0),J(1,"div",27)(2,"span",29),we(3,"\u4e00\u62ec\u79fb\u52d5:"),oe(),J(4,"button",25),Re("click",function(){return Le(e),$e(2).allTabBoxCheck()}),Ee(5,KX,2,0,"ng-container",30),Ee(6,XX,1,0,"ng-template",null,31,Ln),oe(),J(8,"button",25),Re("click",function(){return Le(e),$e(2).onMultiMoveContextMenu()}),J(9,"i",26),we(10,"settings"),oe(),we(11,"\u5b9f\u884c"),oe(),J(12,"button",25),Re("click",function(){return Le(e),$e(2).toggleMultiMove()}),J(13,"i",26),we(14,"settings"),oe(),we(15,"\u30ad\u30e3\u30f3\u30bb\u30eb"),oe()(),et()}if(2&n){const e=ln(7),i=$e(2);j(5),ie("ngIf",i.existsMultiMoveSelectedInTab())("ngIfElse",e)}}function JX(n,t){if(1&n){const e=pt();Je(0),J(1,"div")(2,"button",25),Re("click",function(){return Le(e),$e(2).toggleMultiMove()}),J(3,"i",26),we(4,"settings"),oe(),we(5,"\u4e00\u62ec\u79fb\u52d5"),oe()(),et()}}function eQ(n,t){if(1&n&&(Ee(0,QX,16,2,"ng-container",2),Ee(1,JX,6,0,"ng-container",2)),2&n){const e=$e();ie("ngIf",e.isMultiMove),j(1),ie("ngIf",!e.isMultiMove)}}function tQ(n,t){if(1&n){const e=pt();J(0,"button",40),Re("click",function(r){Le(e);const o=$e().gameObject;return $e().onContextMenu(r,o)}),J(1,"i",41),we(2,"settings"),oe()()}}function nQ(n,t){if(1&n){const e=pt();J(0,"div",37)(1,"input",42),Re("change",function(r){Le(e);const o=$e().gameObject;return $e().toggleMultiMoveTarget(r,o)}),oe()()}if(2&n){const e=$e().gameObject,i=$e();j(1),ie("checked",i.multiMoveTargets.has(e.identifier))}}function iQ(n,t){1&n&&(it(0,"img",43),At(1,"safe")),2&n&&ie("src",Ft(1,1,$e().gameObject.imageFile.url,"resourceUrl"),hn)}function rQ(n,t){1&n&&pn(0)}const oQ=function(n){return{dataElm:n}};function sQ(n,t){if(1&n&&(Je(0),Ee(1,rQ,1,0,"ng-container",11),et()),2&n){const e=t.$implicit;$e(3);const i=ln(16);j(1),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",Nt(2,oQ,e))}}function aQ(n,t){if(1&n&&(J(0,"div"),Ee(1,sQ,2,4,"ng-container",44),oe()),2&n){const e=$e().gameObject,i=$e();j(1),ie("ngForOf",i.getInventoryTags(e))("ngForTrackBy",i.trackByGameObject)}}function lQ(n,t){if(1&n&&(J(0,"div",32)(1,"div",33),we(2),Ee(3,tQ,3,0,"button",34),oe(),J(4,"div",35),Ee(5,nQ,2,1,"div",36),J(6,"div",37)(7,"div",38),Ee(8,iQ,2,4,"img",39),oe()(),J(9,"div",37),Ee(10,aQ,2,2,"div",2),oe()()()),2&n){const e=t.gameObject,i=$e();j(2),sn("",e.name," "),j(1),ie("ngIf",i.selectedIdentifier===e.identifier),j(2),ie("ngIf",i.isMultiMove),j(3),ie("ngIf",e.imageFile.url),j(2),ie("ngIf",e.rootDataElement)}}function cQ(n,t){1&n&&(Je(0),it(1,"br"),et())}function uQ(n,t){if(1&n){const e=pt();Je(0),J(1,"div",50)(2,"div",51),we(3),oe(),J(4,"input",52),Re("ngModelChange",function(r){return Le(e),$e(2).dataElm.currentValue=r}),oe()(),J(5,"div",50)(6,"input",53),Re("ngModelChange",function(r){return Le(e),$e(2).dataElm.currentValue=r}),At(7,"safe"),oe()(),et()}if(2&n){const e=$e(2).dataElm;j(3),xt(e.name),j(1),Qn("color:"+e.nowValueColor+";"),Ht("step",e.step),ie("ngModel",e.currentValue),j(2),Qn(Ft(7,10,"font-size: 0.8em; min-width: 1em; width:"+(e.name.length+4.5)+"em; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),Ht("max",e.value),Ht("step",e.step),ie("ngModel",e.currentValue)}}function dQ(n,t){if(1&n){const e=pt();Je(0),J(1,"div",50)(2,"div",51),we(3),oe(),J(4,"input",52),Re("ngModelChange",function(r){return Le(e),$e(2).dataElm.currentValue=r}),oe(),J(5,"div",51),we(6),oe()(),J(7,"div",50)(8,"input",53),Re("ngModelChange",function(r){return Le(e),$e(2).dataElm.currentValue=r}),At(9,"safe"),oe()(),et()}if(2&n){const e=$e(2).dataElm;j(3),xt(e.name),j(1),Qn("color:"+e.nowValueColor+";"),Ht("step",e.step),ie("ngModel",e.currentValue),j(2),Os("",e.currentLineValue,"/",e.maxLineValue,""),j(2),Qn(Ft(9,12,"font-size: 0.8em; min-width: 1em; width:"+(e.name.length+6.5)+"em; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),Ht("max",e.value),Ht("step",e.step),ie("ngModel",e.currentValue)}}function fQ(n,t){if(1&n){const e=pt();J(0,"input",60),Re("click",function(){return Le(e),$e(3).dataElm.value=0}),oe()}}function hQ(n,t){if(1&n){const e=pt();J(0,"input",61),Re("click",function(){return Le(e),$e(3).dataElm.value=1}),oe()}}function pQ(n,t){if(1&n&&(Je(0),J(1,"div",54),we(2),oe(),J(3,"div",55)(4,"div",56)(5,"div",57),Ee(6,fQ,1,0,"input",58),Ee(7,hQ,1,0,"input",59),oe()()(),et()),2&n){const e=$e(2).dataElm;j(2),xt(e.name),j(4),ie("ngIf",0!=e.value),j(1),ie("ngIf",0==e.value)}}function gQ(n,t){1&n&&pn(0)}function _Q(n,t){if(1&n){const e=pt();Je(0),J(1,"div",54),we(2),oe(),J(3,"div",62)(4,"div",56)(5,"div",57)(6,"div",63),we(7),oe(),J(8,"input",64),Re("ngModelChange",function(r){return Le(e),$e(2).dataElm.value=r}),oe()()()(),et()}if(2&n){const e=$e(2).dataElm;j(2),xt(e.name),j(5),xt(e.value),j(1),ie("ngModel",e.value)}}function mQ(n,t){if(1&n&&(J(0,"div",46),Je(1,47),Ee(2,uQ,8,13,"ng-container",48),Ee(3,dQ,10,15,"ng-container",48),Ee(4,pQ,8,3,"ng-container",48),Ee(5,gQ,1,0,"ng-container",48),Ee(6,_Q,9,3,"ng-container",49),et(),oe()),2&n){const e=$e().dataElm;j(1),ie("ngSwitch",e.attributes.type),j(1),ie("ngSwitchCase","numberResource"),j(1),ie("ngSwitchCase","lineResource"),j(1),ie("ngSwitchCase","check"),j(1),ie("ngSwitchCase","markdown")}}function $Q(n,t){if(1&n&&(Ee(0,cQ,2,0,"ng-container",2),Ee(1,mQ,7,5,"div",45)),2&n){const e=t.dataElm,i=$e();ie("ngIf",(null==e?null:e.name)===i.newLineString),j(1),ie("ngIf",e&&e.name!==i.newLineString)}}let vQ=(()=>{class n{constructor(e,i,r,o,s){this.changeDetector=e,this.panelService=i,this.inventoryService=r,this.contextMenuService=o,this.pointerDeviceService=s,this.inventoryTypes=["table","common","graveyard"],this.selectTab="table",this.selectedIdentifier="",this.multiMoveTargets=new Set,this.isEdit=!1,this.isMultiMove=!1,this.disptimer=null}get sortTag(){return this.inventoryService.sortTag}set sortTag(e){this.inventoryService.sortTag=e}get sortOrder(){return this.inventoryService.sortOrder}set sortOrder(e){this.inventoryService.sortOrder=e}get sortTag2nd(){return this.inventoryService.sortTag2nd}set sortTag2nd(e){this.inventoryService.sortTag2nd=e}get sortOrder2nd(){return this.inventoryService.sortOrder2nd}set sortOrder2nd(e){this.inventoryService.sortOrder2nd=e}get dataTag(){return this.inventoryService.dataTag}set dataTag(e){this.inventoryService.dataTag=e}get dataTags(){return this.inventoryService.dataTags}get sortOrderName(){return this.sortOrder===_d.ASC?"\u6607\u9806":"\u964d\u9806"}get sortOrderName2nd(){return this.sortOrder2nd===_d.ASC?"\u6607\u9806":"\u964d\u9806"}get newLineString(){return this.inventoryService.newLineString}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),Qe.register(this).on("SELECT_TABLETOP_OBJECT",e=>{Xe.instance.get(e.data.identifier)instanceof Qr&&(this.selectedIdentifier=e.data.identifier,this.changeDetector.markForCheck())}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("UPDATE_INVENTORY",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("OPEN_NETWORK",e=>{this.inventoryTypes=["table","common",bt.peerId,"graveyard"],this.inventoryTypes.includes(this.selectTab)||(this.selectTab=bt.peerId)}),this.inventoryTypes=["table","common",bt.peerId,"graveyard"]}ngAfterViewInit(){this.disptimer=setInterval(()=>{this.changeDetector.detectChanges()},200)}ngOnDestroy(){Qe.unregister(this),this.disptimer=null}getTabTitle(e){switch(e){case"table":return"\u30c6\u30fc\u30d6\u30eb";case bt.peerId:return"\u500b\u4eba";case"graveyard":return"\u5893\u5834";default:return"\u5171\u6709"}}getInventory(e){switch(e){case"table":return this.inventoryService.tableInventory;case bt.peerId:return this.inventoryService.privateInventory;case"graveyard":return this.inventoryService.graveyardInventory;default:return this.inventoryService.commonInventory}}getGameObjects(e){if("table"===e){let i=[],r=this.inventoryService.tableInventory.tabletopObjects;for(let o of r)o.hideInventory||i.push(o);return i}return this.getInventory(e).tabletopObjects}getInventoryTags(e){return this.getInventory(e.location.name).dataElementMap.get(e.identifier)}onContextMenu(e,i){if(document.activeElement instanceof HTMLInputElement&&"range"!==document.activeElement.getAttribute("type")||(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;this.selectGameObject(i);let r=this.pointerDeviceService.pointers[0],o=[];o.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(i)}}),"graveyard"!==i.location.name&&(o.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(i)}}),o.push({name:"\u30ea\u30e2\u30b3\u30f3\u3092\u8868\u793a",action:()=>{this.showRemoteController(i)}})),o.push(xi);let s=[{name:"table",alias:"\u30c6\u30fc\u30d6\u30eb\u306b\u79fb\u52d5"},{name:"common",alias:"\u5171\u6709\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5"},{name:bt.peerId,alias:"\u500b\u4eba\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5"},{name:"graveyard",alias:"\u5893\u5834\u306b\u79fb\u52d5"}];for(let a of s)i.location.name!==a.name&&o.push({name:a.alias,action:()=>{i.setLocation(a.name),$t.play(dt.piecePut)}});"graveyard"===i.location.name&&o.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.deleteGameObject(i),$t.play(dt.sweep)}}),o.push(xi),o.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{this.cloneGameObject(i),$t.play(dt.piecePut)}}),this.contextMenuService.open(r,o,i.name)}toggleEdit(){this.isEdit=!this.isEdit}toggleMultiMove(){this.isMultiMove&&this.multiMoveTargets.clear(),this.isMultiMove=!this.isMultiMove}cleanInventory(){let e=this.getTabTitle(this.selectTab),i=this.getGameObjects(this.selectTab);if(confirm(`${e}\u306b\u5b58\u5728\u3059\u308b${i.length}\u500b\u306e\u8981\u7d20\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f`)){for(const r of i)this.deleteGameObject(r);$t.play(dt.sweep)}}existsMultiMoveSelectedInTab(){return this.getGameObjects(this.selectTab).some(e=>this.multiMoveTargets.has(e.identifier))}toggleMultiMoveTarget(e,i){e.target instanceof HTMLInputElement&&(e.target.checked?this.multiMoveTargets.add(i.identifier):this.multiMoveTargets.delete(i.identifier),console.log(`multimove selected ${[...this.multiMoveTargets]}`))}allTabBoxCheck(){this.existsMultiMoveSelectedInTab()?this.getGameObjects(this.selectTab).forEach(e=>this.multiMoveTargets.delete(e.identifier)):this.getGameObjects(this.selectTab).forEach(e=>this.multiMoveTargets.add(e.identifier))}onMultiMoveContextMenu(){if(!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let e=this.pointerDeviceService.pointers[0],i=[],r=[{name:"table",alias:"\u30c6\u30fc\u30d6\u30eb\u306b\u79fb\u52d5"},{name:"common",alias:"\u5171\u6709\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5"},{name:bt.peerId,alias:"\u500b\u4eba\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5"},{name:"graveyard",alias:"\u5893\u5834\u306b\u79fb\u52d5"}];for(let o of r)this.selectTab!==o.name&&i.push({name:o.alias,action:()=>{this.multiMove(o.name),this.toggleMultiMove(),$t.play(dt.piecePut)}});"graveyard"==this.selectTab&&i.push({name:"\u5893\u5834\u304b\u3089\u524a\u9664",action:()=>{this.multiDelete(),this.toggleMultiMove(),$t.play(dt.sweep)}}),this.contextMenuService.open(e,i,"\u4e00\u62ec\u79fb\u52d5")}multiMove(e){for(const i of this.multiMoveTargets){let r=Xe.instance.get(i);r instanceof Lt&&r.setLocation(e)}}multiDelete(){let e=new Set;for(const i of this.multiMoveTargets){let r=Xe.instance.get(i);r instanceof Lt&&"graveyard"==r.location.name&&e.add(r)}if(!(e.size<1)&&confirm(`\u9078\u629e\u3057\u305f\u3082\u306e\u306e\u3046\u3061\u5893\u5834\u306b\u5b58\u5728\u3059\u308b${e.size}\u500b\u306e\u8981\u7d20\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f`))for(const i of e)this.deleteGameObject(i)}cloneGameObject(e){e.clone()}showDetail(e){Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(wl,{title:r,left:i.x-800,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(BP,{left:i.x-250,top:i.y-175,width:615,height:350}).character=e}showRemoteController(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(HP,{left:i.x-250,top:i.y-175,width:700,height:600}).character=e}focusToObject(e,i){e.target instanceof HTMLElement&&(new Set(["input","button"]).has(e.target.tagName.toLowerCase())||"table"==i.location.name&&Qe.trigger("FOCUS_TO_TABLETOP_COORDINATE",{x:i.location.x,y:i.location.y}))}selectGameObject(e){this.isMultiMove&&(this.multiMoveTargets.has(e.identifier)?this.multiMoveTargets.delete(e.identifier):this.multiMoveTargets.add(e.identifier),console.log(`multimove selected ${[...this.multiMoveTargets]}`)),Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName}),Qe.trigger("HIGHTLIGHT_TABLETOP_OBJECT",{identifier:e.identifier})}deleteGameObject(e){e.destroy(),this.changeDetector.markForCheck()}trackByGameObject(e,i){return i?i.identifier:e}}return n.\u0275fac=function(e){return new(e||n)(Be(bi),Be($n),Be(ab),Be(To),Be(Di))},n.\u0275cmp=Qt({type:n,selectors:[["game-object-inventory"]],decls:17,vars:7,consts:[[1,"component"],[4,"ngTemplateOutlet"],[4,"ngIf"],[3,"ngClass","contextmenu","click","dblclick",4,"ngFor","ngForOf","ngForTrackBy"],["style","padding-top: 6px;",4,"ngIf"],["inventoryTab",""],["inventoryViewSetting",""],["inventoryMultiMove",""],["gameObjectTags",""],["dataElmTag",""],[3,"ngClass","contextmenu","click","dblclick"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[2,"padding-top","6px"],[1,"danger",3,"click"],[1,"is-sticky-top"],[1,"tab"],[4,"ngFor","ngForOf"],["name","tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],[2,"font-size","12px"],["placeholder","\u30bf\u30b0\u540d",1,"is-caret",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],["value","ASC"],["value","DESC"],[2,"font-size","12px","padding-top","6px"],["placeholder","\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u3067\u30bf\u30b0\u540d \u30b9\u30e9\u30c3\u30b7\u30e5\u3067\u6539\u884c ex.\u300cHP MP / \u30e1\u30e2\u300d",1,"is-caret",2,"width","100%","box-sizing","border-box",3,"ngModel","ngModelChange"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[2,"font-size","0.8em"],[2,"vertical-align","middle"],[2,"font-weight","bold"],[4,"ngIf","ngIfElse"],["selectAll",""],[1,"inventory-object"],[1,"object-name"],["style","font-size: 0.8em; padding: 2px 5px;",3,"click",4,"ngIf"],[1,"object-tags-box"],["class","table-cell",4,"ngIf"],[1,"table-cell"],[1,"image-box"],[3,"src",4,"ngIf"],[2,"font-size","0.8em","padding","2px 5px",3,"click"],[1,"material-icons",2,"font-size","1em"],["type","checkbox",3,"checked","change"],[3,"src"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","object-tag",4,"ngIf"],[1,"object-tag"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"resource-tag"],[2,"font-size","0.8em","display","inline-block","margin-right","0.5em"],["type","number","size","1","placeholder","Value",1,"input","resource-value","is-caret",3,"ngModel","step","ngModelChange"],["type","range","min","0",3,"max","step","ngModel","ngModelChange"],[1,"tag-name"],[2,"text-align","center","margin","2px 0px 0px 0px"],[2,"display","inline-block"],[1,"tag-value-box"],["type","checkbox","checked","",3,"click",4,"ngIf"],["type","checkbox",3,"click",4,"ngIf"],["type","checkbox","checked","",3,"click"],["type","checkbox",3,"click"],[2,"text-align","center"],[1,"hidden-spacer",2,"font-weight","bold"],["size","1","placeholder","",1,"input","tag-value","is-caret",3,"ngModel","ngModelChange"]],template:function(e,i){if(1&e&&(J(0,"div",0),Ee(1,AX,1,0,"ng-container",1),Ee(2,PX,1,0,"ng-container",1),Ee(3,FX,1,0,"ng-container",1),Ee(4,RX,2,1,"div",2),Ee(5,LX,2,7,"div",3),Ee(6,zX,3,1,"div",4),oe(),Ee(7,VX,3,1,"ng-template",null,5,Ln),Ee(9,YX,2,2,"ng-template",null,6,Ln),Ee(11,eQ,2,2,"ng-template",null,7,Ln),Ee(13,lQ,11,5,"ng-template",null,8,Ln),Ee(15,$Q,2,2,"ng-template",null,9,Ln)),2&e){const r=ln(8),o=ln(10),s=ln(12);j(1),ie("ngTemplateOutlet",r),j(1),ie("ngTemplateOutlet",o),j(1),ie("ngTemplateOutlet",s),j(1),ie("ngIf",i.getGameObjects(i.selectTab).length<1),j(1),ie("ngForOf",i.getGameObjects(i.selectTab))("ngForTrackBy",i.trackByGameObject),j(1),ie("ngIf","graveyard"===i.selectTab)}},directives:[Ra,Sn,si,ir,_s,gs,xo,Qu,Fi,Ti,yi,nc,ic,rc,tc,Wu,ms,oa,gf],pipes:[Ii],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border:transparent 2px solid;border-left:transparent 6px solid;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border-bottom:1px dotted #666}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #444}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.input[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;padding:2px;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#EEE}.input[_ngcontent-%COMP%]:focus{background:#FFF}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.tab[_ngcontent-%COMP%]{padding:0;border:solid 1px #555;border-radius:.3em;overflow:hidden;display:flex;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;max-width:500px;background-color:#f0dabde6}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;flex:1 0 auto;flex-grow:1}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:checked{background:#555;color:#ccc}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin:0;padding:2px 8px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.is-sticky-top[_ngcontent-%COMP%]{position:sticky;top:0}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table-cell[_ngcontent-%COMP%]{display:table-cell}.image-box[_ngcontent-%COMP%]{padding:0;width:32px;height:32px;max-width:32px;max-height:32px;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}.resource-tag[_ngcontent-%COMP%]{text-align:center;vertical-align:bottom;overflow:hidden;white-space:nowrap}.resource-value[_ngcontent-%COMP%]{font-weight:700;width:4em;text-align:right;font-family:inherit}.tag-name[_ngcontent-%COMP%]{font-size:.8em;text-align:left;vertical-align:bottom;min-width:1em;max-width:12em;overflow:hidden;white-space:nowrap}.tag-value-box[_ngcontent-%COMP%]{display:table-cell;width:10px}.tag-value[_ngcontent-%COMP%]{font-size:1em;font-weight:700;width:100%;min-width:1em;max-width:12em;text-align:center;font-family:inherit}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"],changeDetection:0}),n})();const bQ=Bt.create("./assets/images/skeleton.png");let Op=(()=>{class n{constructor(){}getSkeletonOr(e){let i=e instanceof Bt?e:St.instance.get(e);return i&&!i.isEmpty?i:bQ}getEmptyOr(e){let i=e instanceof Bt?e:St.instance.get(e);return i&&!i.isEmpty?i:Bt.Empty}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function yQ(n,t){if(1&n&&(J(0,"option",8),we(1),oe()),2&n){const e=t.$implicit;Ht("value",e.identifier),j(1),xt(e.name)}}function CQ(n,t){if(1&n){const e=pt();J(0,"div")(1,"button",29),Re("click",function(){return Le(e),$e(2).openDistanceViewImageModal()}),we(2,"\u80cc\u666f\u753b\u50cf\u3092\u8ffd\u52a0"),oe()()}}function xQ(n,t){if(1&n){const e=pt();J(0,"div",2),Re("click",function(){return Le(e),$e(2).openDistanceViewImageModal()}),it(1,"img",10),At(2,"safe"),oe()}if(2&n){const e=$e(2);j(1),ie("src",Ft(2,1,e.tableDistanceviewImage.url,"resourceUrl"),hn)}}function wQ(n,t){if(1&n&&(J(0,"div",35),we(1),oe()),2&n){const e=$e(3);j(1),sn("",e.progresPercent,"%")}}const EQ=function(n){return{"is-hidden":n}};function TQ(n,t){if(1&n){const e=pt();Je(0),J(1,"button",30),Re("click",function(){return Le(e),$e(2).save()}),J(2,"div",31)(3,"div",32),we(4,"\u4fdd\u5b58"),oe(),Ee(5,wQ,2,1,"div",33),oe()(),J(6,"button",34),Re("click",function(){return Le(e),$e(2).delete()}),we(7,"\u524a\u9664"),oe(),et()}if(2&n){const e=$e(2);j(1),ie("disabled",e.isSaveing),j(2),ie("ngClass",Nt(4,EQ,e.isSaveing)),j(2),ie("ngIf",e.isSaveing),j(1),Yt("disabled",e.getGameTables().length<=1?"":null)}}function SQ(n,t){if(1&n){const e=pt();Je(0),J(1,"button",2),Re("click",function(){return Le(e),$e(2).restore()}),we(2,"\u5143\u306b\u623b\u3059"),oe(),et()}}function DQ(n,t){if(1&n){const e=pt();Je(0),J(1,"div",9)(2,"div"),we(3," \u753b\u50cf "),J(4,"div",2),Re("click",function(){return Le(e),$e().openBgImageModal()}),it(5,"img",10),At(6,"safe"),oe()(),J(7,"div"),we(8," \u80cc\u666f "),Ee(9,CQ,3,0,"div",6),Ee(10,xQ,3,4,"div",11),oe()(),J(11,"div"),we(12,"Name : "),J(13,"input",12),Re("ngModelChange",function(r){return Le(e),$e().tableName=r}),oe()(),J(14,"div")(15,"input",13),Re("ngModelChange",function(r){return Le(e),$e().tableWidth=r}),oe(),we(16," Width : "),J(17,"input",14),Re("ngModelChange",function(r){return Le(e),$e().tableWidth=r}),oe()(),J(18,"div")(19,"input",15),Re("ngModelChange",function(r){return Le(e),$e().tableHeight=r}),oe(),we(20," Height : "),J(21,"input",14),Re("ngModelChange",function(r){return Le(e),$e().tableHeight=r}),oe()(),J(22,"div"),we(23," \u30b0\u30ea\u30c3\u30c9: "),J(24,"select",16),Re("ngModelChange",function(r){return Le(e),$e().tableGridType=r}),J(25,"option",17),we(26,"\u306a\u3057"),oe(),J(27,"option",18),we(28,"\u30b9\u30af\u30a8\u30a2"),oe(),J(29,"option",19),we(30,"\u30d8\u30af\u30b9\uff08\u7e26\u63c3\u3048\uff09"),oe(),J(31,"option",20),we(32,"\u30d8\u30af\u30b9\uff08\u6a2a\u63c3\u3048\uff09"),oe()(),we(33," \u30b0\u30ea\u30c3\u30c9\u8272: "),J(34,"input",21),Re("ngModelChange",function(r){return Le(e),$e().tableGridColor=r}),oe()(),J(35,"div"),we(36," \u80cc\u666f\u30d5\u30a3\u30eb\u30bf "),J(37,"select",22),Re("ngModelChange",function(r){return Le(e),$e().tableDistanceviewFilter=r}),J(38,"option",23),we(39,"\u306a\u3057"),oe(),J(40,"option",24),we(41,"\u30db\u30ef\u30a4\u30c8"),oe(),J(42,"option",25),we(43,"\u30d6\u30e9\u30c3\u30af"),oe()()(),it(44,"hr"),J(45,"div")(46,"label"),we(47,"\u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u306b\u8868\u793a: "),J(48,"input",26),Re("ngModelChange",function(r){return Le(e),$e().tableGridShow=r}),oe()(),J(49,"label"),we(50,"\u30b9\u30ca\u30c3\u30d7: "),J(51,"input",27),Re("ngModelChange",function(r){return Le(e),$e().tableGridSnap=r}),oe()(),it(52,"hr"),J(53,"label"),we(54,"\u5168\u54e1\u306e\u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u6642\u5f37\u5236ON: "),J(55,"input",28),Re("ngModelChange",function(r){return Le(e),$e().roomGridDispAlways=r}),oe(),it(56,"br"),we(57," \u203b\u30c6\u30fc\u30d6\u30eb\u6bce\u306e\u8a2d\u5b9a\u3067\u306f\u306a\u304f\u90e8\u5c4b\u5168\u4f53\u306e\u8a2d\u5b9a\u3067\u3059\u3002 "),oe(),it(58,"hr"),Ee(59,TQ,8,6,"ng-container",6),Ee(60,SQ,3,0,"ng-container",6),oe(),et()}if(2&n){const e=$e();j(5),ie("src",Ft(6,32,e.tableBackgroundImage.url,"resourceUrl"),hn),j(4),ie("ngIf",!e.tableDistanceviewImage.url),j(1),ie("ngIf",e.tableDistanceviewImage.url),j(3),ie("ngModel",e.tableName),Yt("disabled",e.isEditable?null:""),j(2),Ht("min",e.minSize),Ht("max",e.maxSize),ie("ngModel",e.tableWidth),Yt("disabled",e.isEditable?null:""),j(2),Ht("min",e.minSize),Ht("max",e.maxSize),ie("ngModel",e.tableWidth),Yt("disabled",e.isEditable?null:""),j(2),Ht("min",e.minSize),Ht("max",e.maxSize),ie("ngModel",e.tableHeight),Yt("disabled",e.isEditable?null:""),j(2),Ht("min",e.minSize),Ht("max",e.maxSize),ie("ngModel",e.tableHeight),Yt("disabled",e.isEditable?null:""),j(3),ie("ngModel",e.tableGridType),Yt("disabled",e.isEditable?null:""),j(10),ie("ngModel",e.tableGridColor),Yt("disabled",e.isEditable?null:""),j(3),ie("ngModel",e.tableDistanceviewFilter),Yt("disabled",e.isEditable?null:""),j(11),ie("ngModel",e.tableGridShow),j(3),ie("ngModel",e.tableGridSnap),j(4),ie("ngModel",e.roomGridDispAlways),j(4),ie("ngIf",!e.isDeleted),j(1),ie("ngIf",e.isDeleted)}}function IQ(n,t){1&n&&(Je(0),J(1,"div",36),we(2,"\u203b\u30c6\u30fc\u30d6\u30eb\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u300d\u304b\u3089\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),oe(),et())}function kQ(n,t){if(1&n&&(J(0,"ng-option",8),we(1),oe()),2&n){const e=t.$implicit;ie("value",e.id),j(1),xt(e.name)}}const MQ=function(){return{standalone:!0}};let VP=(()=>{class n{constructor(e,i,r,o){this.modalService=e,this.saveDataService=i,this.imageService=r,this.panelService=o,this._gameType="",this.gameTypeChange=new Xt,this.minSize=1,this.maxSize=100,this.selectedTable=null,this.selectedTableXml="",this.isSaveing=!1,this.progresPercent=0}get gameType(){return this.config.defaultDiceBot}set gameType(e){this.config.defaultDiceBot=e}loadDiceBot(e){console.log("changeDiceBot ready"),sr.getHelpMessage(e).then(i=>{console.log("onChangeGameType done\n"+i)})}get roomGridDispAlways(){let e=Xe.instance.get("Config");return!!e&&e.roomGridDispAlways}set roomGridDispAlways(e){let i=Xe.instance.get("Config");this.tableGridDummy=!this.tableGridDummy,i&&(i.roomGridDispAlways=e)}get config(){return Xe.instance.get("Config")}get diceBotInfos(){return sr.diceBotInfos}get tableBackgroundImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.imageIdentifier:null)}get tableDistanceviewImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.backgroundImageIdentifier:null)}get tableGridDummy(){return this.tableSelecter.tableGridDummy}set tableGridDummy(e){this.tableSelecter.tableGridDummy=e}get tableName(){return this.selectedTable.name}set tableName(e){this.isEditable&&(this.selectedTable.name=e)}get tableWidth(){return this.selectedTable.width}set tableWidth(e){this.isEditable&&(this.selectedTable.width=e)}get tableHeight(){return this.selectedTable.height}set tableHeight(e){this.isEditable&&(this.selectedTable.height=e)}get tableGridColor(){return this.selectedTable.gridColor.substring(0,7)}set tableGridColor(e){this.isEditable&&(this.selectedTable.gridColor=e+"e6")}get tableGridShow(){return this.tableSelecter.gridShow}set tableGridShow(e){this.tableSelecter.gridShow=e,e&&(this.tableSelecter.viewTable.gridClipRect=null),Qe.trigger("UPDATE_GAME_OBJECT",this.tableSelecter.toContext())}get tableGridSnap(){return this.tableSelecter.gridSnap}set tableGridSnap(e){this.tableSelecter.gridSnap=e}get tableGridType(){return this.selectedTable.gridType}set tableGridType(e){this.isEditable&&(this.selectedTable.gridType=Number(e))}get tableDistanceviewFilter(){return this.selectedTable.backgroundFilterType}set tableDistanceviewFilter(e){this.isEditable&&(this.selectedTable.backgroundFilterType=e)}get tableSelecter(){return da.instance}get isEmpty(){return!this.tableSelecter||!this.tableSelecter.viewTable}get isDeleted(){return!this.selectedTable||null==Xe.instance.get(this.selectedTable.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"),this.selectedTable=this.tableSelecter.viewTable,Qe.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTable||e.data.identifier!==this.selectedTable.identifier)return;let i=Xe.instance.get(e.data.identifier);null!==i&&(this.selectedTableXml=i.toXml())})}ngAfterViewInit(){}ngOnDestroy(){Qe.unregister(this)}selectGameTable(e){Qe.call("SELECT_GAME_TABLE",{identifier:e},bt.peerId),this.selectedTable=Xe.instance.get(e),this.selectedTableXml=""}getGameTables(){return Xe.instance.getObjects(to)}createGameTable(){let e=new to;e.name="\u767d\u7d19\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier="testTableBackgroundImage_image",e.initialize(),this.selectGameTable(e.identifier)}save(){var e=this;return(0,xn.Z)(function*(){!e.selectedTable||e.isSaveing||(e.isSaveing=!0,e.progresPercent=0,e.selectedTable.selected=!0,yield e.saveDataService.saveGameObjectAsync(e.selectedTable,"map_"+e.selectedTable.name,i=>{e.progresPercent=i}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500))})()}delete(){!this.isEmpty&&this.selectedTable&&(this.selectedTableXml=this.selectedTable.toXml(),this.selectedTable.destroy())}restore(){if(this.selectedTable&&this.selectedTableXml){let e=er.instance.parseXml(this.selectedTableXml);this.selectGameTable(e.identifier),this.selectedTableXml=""}}openBgImageModal(){this.isDeleted||this.modalService.open(Hf).then(e=>{!this.selectedTable||!e||(this.selectedTable.imageIdentifier=e)})}openDistanceViewImageModal(){this.isDeleted||this.modalService.open(Hf,{isAllowedEmpty:!0}).then(e=>{!this.selectedTable||!e||(this.selectedTable.backgroundImageIdentifier=e)})}}return n.\u0275fac=function(e){return new(e||n)(Be(pi),Be(ko),Be(Op),Be($n))},n.\u0275cmp=Qt({type:n,selectors:[["game-table-setting"]],inputs:{_gameType:["gameType","_gameType"]},outputs:{gameTypeChange:"gameTypeChange"},decls:17,vars:9,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[3,"click"],["size","10",2,"width","10em",3,"ngModel","change"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[1,"ud-select","is-caret",2,"width","15em","margin-left",".1em",3,"ngModel","ngModelOptions","clearable","change","ngModelChange"],[3,"value"],[1,"images-select"],["height","120",3,"src"],[3,"click",4,"ngIf"],["placeholder","Name",1,"is-caret",3,"ngModel","ngModelChange"],["type","range","name","tableWidth",3,"ngModel","min","max","ngModelChange"],["type","number",1,"is-caret",2,"width","5em",3,"ngModel","min","max","ngModelChange"],["type","range","name","tableHeight",3,"ngModel","min","max","ngModelChange"],["name","tableGridType",3,"ngModel","ngModelChange"],["value","-1"],["value","0"],["value","1"],["value","2"],["type","color","name","tableGridColor","list","table-grid-color-list",3,"ngModel","ngModelChange"],["name","tableDistanceviewFilter",3,"ngModel","ngModelChange"],["value",""],["value","white"],["value","black"],["type","checkbox","name","tableGridShow",3,"ngModel","ngModelChange"],["type","checkbox","name","tableGridSnap",3,"ngModel","ngModelChange"],["type","checkbox","name","roomGridDispAlways",3,"ngModel","ngModelChange"],[2,"height","120px",3,"click"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,i){1&e&&(J(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Re("click",function(){return i.createGameTable()}),we(4,"\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b"),oe()(),J(5,"select",3),Re("change",function(o){return i.selectGameTable(o.target.value)}),Ee(6,yQ,2,2,"option",4),oe()(),J(7,"div",5),Ee(8,DQ,61,35,"ng-container",6),oe()(),Ee(9,IQ,3,0,"ng-container",6),J(10,"div"),it(11,"hr"),we(12," \u6a19\u6e96\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8(\u90e8\u5c4b\u63a5\u7d9a\u6642\u306b\u9078\u629e\u3055\u308c\u308b\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u306b\u306a\u308a\u307e\u3059)\u3002"),it(13,"br"),we(14," \u203b\u30c6\u30fc\u30d6\u30eb\u6bce\u306e\u8a2d\u5b9a\u3067\u306f\u306a\u304f\u90e8\u5c4b\u5168\u4f53\u306e\u8a2d\u5b9a\u3067\u3059\u3002 "),J(15,"ng-select",7),Re("change",function(o){return i.loadDiceBot(o)})("ngModelChange",function(o){return i.gameType=o}),Ee(16,kQ,2,2,"ng-option",4),oe()()),2&e&&(j(5),ie("ngModel",null==i.selectedTable?null:i.selectedTable.identifier),j(1),ie("ngForOf",i.getGameTables()),j(2),ie("ngIf",!i.isEmpty||i.selectedTable),j(1),ie("ngIf",i.isEmpty),j(6),ie("ngModel",i.gameType)("ngModelOptions",$r(8,MQ))("clearable",!1),j(1),ie("ngForOf",i.diceBotInfos))},directives:[nc,Ti,yi,si,ic,rc,Sn,Fi,oa,ms,Vc,Ju,ra,ir,gp,wf],pipes:[Ii],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.images-select[_ngcontent-%COMP%]{display:flex}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}.chat-input[_ngcontent-%COMP%]{font-family:inherit;font-size:13px;width:calc(100% - 100px);height:calc(1em + 4px);min-height:calc(1em + 7px);max-height:calc(6em + 7px);resize:none;overflow:auto;padding:1px;margin:5px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;vertical-align:bottom}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();function AQ(n,t){if(1&n){const e=pt();J(0,"button",5),Re("click",function(){Le(e);const r=$e().$implicit;return $e().play(r)}),we(1,"\u8a66\u8074/\u518d\u751f"),oe()}2&n&&ie("disabled",!$e().$implicit.isReady)}function PQ(n,t){if(1&n){const e=pt();J(0,"button",5),Re("click",function(){return Le(e),$e(2).stop()}),we(1,"\u8a66\u8074/\u505c\u6b62"),oe()}2&n&&ie("disabled",!$e().$implicit.isReady)}function FQ(n,t){1&n&&(J(0,"span"),we(1,"\u3010\u8a66\u8074\u4e2d\u3011"),oe())}function RQ(n,t){if(1&n){const e=pt();J(0,"div",2)(1,"button",3),Re("click",function(){const o=Le(e).$implicit;return $e().selectBgm(o)}),we(2,"\u767b\u9332"),oe(),Ee(3,AQ,2,1,"button",4),Ee(4,PQ,2,1,"button",4),Ee(5,FQ,2,0,"span",1),J(6,"span"),we(7),oe()()}if(2&n){const e=t.$implicit,i=$e();j(3),ie("ngIf",e!==(null==i.auditionPlayer?null:i.auditionPlayer.audio)||(null==i.auditionPlayer?null:i.auditionPlayer.paused)),j(1),ie("ngIf",e===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused)),j(1),ie("ngIf",e===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused)),j(2),xt(e.name)}}function NQ(n,t){1&n&&(J(0,"div"),we(1,"\u97f3\u697d\u304c\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002"),oe())}let OQ=(()=>{class n{constructor(e,i,r){this.modalService=e,this.panelService=i,this.ngZone=r,this.auditionPlayer=new Jt,this.lazyUpdateTimer=null}get audios(){return en.instance.audios.filter(e=>!e.isHidden)}get jukebox(){return Xe.instance.get("Jukebox")}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30ab\u30c3\u30c8\u30a4\u30f3BGM\u9078\u629e"),this.auditionPlayer.volumeType=Rf.AUDITION,Qe.register(this).on("*",e=>{})}ngOnDestroy(){Qe.unregister(this),this.stop()}play(e){this.auditionPlayer.play(e)}stop(){this.auditionPlayer.stop()}selectBgm(e){!e||(console.log("onSelectedFile",e),console.log("file.identifier"+e.identifier),console.log("file.name"+e.name),this.modalService.resolve(e.identifier))}handleFileSelect(e){let i=e.target.files;i.length&&Cl.instance.load(i)}lazyNgZoneUpdate(){null===this.lazyUpdateTimer&&(this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,this.ngZone.run(()=>{})},100))}}return n.\u0275fac=function(e){return new(e||n)(Be(pi),Be($n),Be(An))},n.\u0275cmp=Qt({type:n,selectors:[["app-cut-in-bgm"]],decls:3,vars:2,consts:[["class","box",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"box"],[3,"click"],[3,"disabled","click",4,"ngIf"],[3,"disabled","click"]],template:function(e,i){1&e&&(J(0,"div"),Ee(1,RQ,8,4,"div",0),Ee(2,NQ,2,0,"div",1),oe()),2&e&&(j(1),ie("ngForOf",i.audios),j(1),ie("ngIf",i.audios.length<1))},directives:[si,Sn],styles:['.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}']}),n})();const BQ=function(n){return{outer:n}};function LQ(n,t){if(1&n&&(J(0,"div",5),we(1),J(2,"span",6),we(3),oe(),we(4),J(5,"span",7),we(6),oe()()),2&n){const e=$e();j(1),sn("",e.urlObj.protocol,"//"),j(1),ie("ngClass",Nt(6,BQ,e.isOuter)),j(1),xt(e.urlObj.host),j(1),xt(e.urlObj.pathname),j(2),Os("",e.urlObj.search,"",e.urlObj.hash,"")}}function zQ(n,t){if(1&n&&(J(0,"div",5),we(1),oe()),2&n){const e=$e();j(1),xt(e.url)}}function HQ(n,t){1&n&&(J(0,"div"),we(1,"\u3053\u306eURL\u3092\u958b\u304d\u307e\u3059\u304b\uff1f\uff08\u5225\u30a6\u30a3\u30f3\u30c9\u30a6\u3067\u958b\u304d\u307e\u3059\u3001\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u3092\u8a31\u53ef\u3057\u3066\u304f\u3060\u3055\u3044\uff09"),oe())}function VQ(n,t){1&n&&(J(0,"div"),we(1,"\u26a0\ufe0fURL\u304c\u4e0d\u6b63\u3067\u3059\u3002"),oe())}let UQ=(()=>{class n{constructor(e,i){this.panelService=e,this.modalService=i,this.url="",this.title="",this.subTitle="",this.url=i.option.url?i.option.url:"",this.title=i.option.title?i.option.title:"",this.subTitle=i.option.subTitle?i.option.subTitle:"",this.urlObj=this.isValid?new URL(this.url):null}get isValid(){return this.validUrl(this.url.trim())}get isOuter(){return!!this.isValid&&window.location.origin!=this.urlObj.origin}ngOnInit(){Promise.resolve().then(()=>{let e="\u5916\u90e8URL\u3092\u958b\u304f";this.title?e+="\u3008"+this.title+(this.subTitle?`\uff1a${this.subTitle}`:"")+"\u3009":this.subTitle&&(e+=`\u3008${this.subTitle}\u3009`),this.modalService.title=this.panelService.title=e}),Qe.register(this)}validUrl(e){if(!e)return!1;try{new URL(e.trim())}catch(i){return!1}return/^https?\:\/\//.test(e.trim())}ngOnDestroy(){Qe.unregister(this)}openUrl(){window.open(this.url.trim(),"_blank","noopener"),this.modalService.resolve(!0)}cancel(){this.modalService.resolve(!1)}}return n.\u0275fac=function(e){return new(e||n)(Be($n),Be(pi))},n.\u0275cmp=Qt({type:n,selectors:[["open-url"]],decls:11,vars:5,consts:[["class","url",4,"ngIf"],[1,"help"],[4,"ngIf"],["type","submit",3,"disabled","click"],["type","button",3,"click"],[1,"url"],[3,"ngClass"],[1,"opt"]],template:function(e,i){1&e&&(J(0,"div"),Ee(1,LQ,7,8,"div",0),Ee(2,zQ,2,1,"div",0),it(3,"hr"),J(4,"div",1),Ee(5,HQ,2,0,"div",2),Ee(6,VQ,2,0,"div",2),oe()(),J(7,"button",3),Re("click",function(){return i.openUrl()}),we(8,"\u958b\u304f"),oe(),J(9,"button",4),Re("click",function(){return i.cancel()}),we(10,"\u30ad\u30e3\u30f3\u30bb\u30eb"),oe()),2&e&&(j(1),ie("ngIf",i.isValid),j(1),ie("ngIf",!i.isValid),j(3),ie("ngIf",i.isValid),j(1),ie("ngIf",!i.isValid),j(1),ie("disabled",!i.isValid))},directives:[Sn,ir],styles:[".url[_ngcontent-%COMP%]{word-break:break-all}.url[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]{font-weight:700}.opt[_ngcontent-%COMP%]{color:gray}.help[_ngcontent-%COMP%]{font-size:smaller}"]}),n})();function jQ(n,t){if(1&n&&(J(0,"option",7),we(1),oe()),2&n){const e=t.$implicit;Ht("value",e.identifier),j(1),xt(e.name)}}function GQ(n,t){1&n&&(J(0,"span"),we(1,"\uff1aYouTube\u6709\u52b9"),oe())}function qQ(n,t){if(1&n&&(Je(0),Ee(1,GQ,2,0,"span",6),et()),2&n){const e=$e(2);j(1),ie("ngIf",e.isYouTubeCutIn)}}function WQ(n,t){1&n&&(J(0,"span"),we(1,"OK\uff1a"),oe())}function ZQ(n,t){1&n&&(J(0,"span"),we(1,"NG\uff1a"),oe())}function YQ(n,t){1&n&&(J(0,"span"),we(1,"\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u304c\u30a2\u30c3\u30d7\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),oe())}function KQ(n,t){1&n&&(J(0,"span"),we(1,"\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),oe())}function XQ(n,t){if(1&n&&(Je(0),Ee(1,YQ,2,0,"span",6),Ee(2,KQ,2,0,"span",6),et()),2&n){const e=$e(2);j(1),ie("ngIf",e.cutInAudioName.length>0),j(1),ie("ngIf",e.cutInAudioName.length<=0)}}function QQ(n,t){if(1&n&&(J(0,"span"),we(1),oe()),2&n){const e=$e(3);j(1),xt(e.cutInAudioName)}}function JQ(n,t){1&n&&it(0,"span")}function eJ(n,t){if(1&n&&(Je(0),Ee(1,QQ,2,1,"span",6),Ee(2,JQ,1,0,"span",6),et()),2&n){const e=$e(2);j(1),ie("ngIf",e.isEditable),j(1),ie("ngIf",!e.isEditable)}}function tJ(n,t){1&n&&(J(0,"span"),we(1,"\u6a19\u6e96\u30b5\u30a4\u30ba\u3067\u8868\u793a\uff1a"),oe())}function nJ(n,t){1&n&&(J(0,"span"),we(1,"\u5143\u30b5\u30a4\u30ba\u3067\u8868\u793a\uff1a"),oe())}function iJ(n,t){if(1&n&&(Je(0),Ee(1,tJ,2,0,"span",6),Ee(2,nJ,2,0,"span",6),et()),2&n){const e=$e(2);j(1),ie("ngIf",e.selectedCutIn.videoId),j(1),ie("ngIf",!e.selectedCutIn.videoId)}}function rJ(n,t){if(1&n){const e=pt();Je(0),J(1,"button",2),Re("click",function(){return Le(e),$e(2).save()}),we(2,"\u4fdd\u5b58"),oe(),J(3,"button",28),Re("click",function(){return Le(e),$e(2).delete()}),we(4,"\u524a\u9664"),oe(),et()}if(2&n){const e=$e(2);j(3),Yt("disabled",e.getCutIns().length<=0?"":null)}}function oJ(n,t){if(1&n){const e=pt();Je(0),J(1,"div",8)(2,"div"),we(3," \u753b\u50cf "),Ee(4,qQ,2,1,"ng-container",6),J(5,"div",9),Re("click",function(){return Le(e),$e().openCutInImageModal()}),it(6,"img",10),At(7,"safe"),J(8,"i",11),we(9),oe()()()(),J(10,"div"),we(11,"\u540d\u79f0 : "),J(12,"input",12),Re("ngModelChange",function(r){return Le(e),$e().cutInName=r}),oe()(),J(13,"div")(14,"button",13),Re("click",function(){return Le(e),$e().playCutIn()}),we(15,"\u30ab\u30c3\u30c8\u30a4\u30f3\u518d\u751f"),oe(),J(16,"button",13),Re("click",function(){return Le(e),$e().stopCutIn()}),we(17,"\u30ab\u30c3\u30c8\u30a4\u30f3\u505c\u6b62"),oe(),J(18,"button",13),Re("click",function(){return Le(e),$e().previewCutIn()}),we(19,"\u81ea\u5206\u3060\u3051\u518d\u751f"),oe(),it(20,"br"),oe(),J(21,"div",14),we(22," \u97f3\u697d\u30c7\u30fc\u30bf : "),J(23,"button",2),Re("click",function(){return Le(e),$e().openCutInBgmModal()}),we(24,"\u8a2d\u5b9a"),oe(),it(25,"br"),we(26," LINK:"),Ee(27,WQ,2,0,"span",6),Ee(28,ZQ,2,0,"span",6),it(29,"br"),Ee(30,XQ,3,2,"ng-container",6),Ee(31,eJ,3,2,"ng-container",6),oe(),J(32,"div"),Ee(33,iJ,3,2,"ng-container",6),J(34,"input",15),Re("ngModelChange",function(r){return Le(e),$e().cutInOriginalSize=r}),oe()(),J(35,"div"),we(36," Width :"),J(37,"input",16),Re("ngModelChange",function(r){return Le(e),$e().cutInWidth=r}),oe(),we(38," \u7e26\u6a2a\u6bd4\u3092\u7dad\u6301 :"),J(39,"input",17),Re("ngModelChange",function(r){return Le(e),$e().keepImageAspect=r})("click",function(){return Le(e),$e().chkImageAspect()}),oe()(),J(40,"div"),we(41," Height :"),J(42,"input",16),Re("ngModelChange",function(r){return Le(e),$e().cutInHeight=r}),oe()(),J(43,"div")(44,"input",18),Re("ngModelChange",function(r){return Le(e),$e().cutInX_Pos=r}),oe(),we(45," X\u4f4d\u7f6e :"),J(46,"input",19),Re("ngModelChange",function(r){return Le(e),$e().cutInX_Pos=r}),oe()(),J(47,"div")(48,"input",18),Re("ngModelChange",function(r){return Le(e),$e().cutInY_Pos=r}),oe(),we(49," Y\u4f4d\u7f6e :"),J(50,"input",19),Re("ngModelChange",function(r){return Le(e),$e().cutInY_Pos=r}),oe()(),J(51,"div"),we(52," \u30eb\u30fc\u30d7\u518d\u751f\uff1a"),J(53,"input",20),Re("ngModelChange",function(r){return Le(e),$e().cutInIsLoop=r}),oe()(),J(54,"div"),we(55," \u518d\u751f\u6642\u9593 :"),J(56,"input",21),Re("ngModelChange",function(r){return Le(e),$e().cutInOutTime=r}),oe()(),J(57,"div"),we(58," \u30bf\u30b0\u540d\u79f0 :"),J(59,"input",22),Re("ngModelChange",function(r){return Le(e),$e().cutInTagName=r}),oe(),we(60," \u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u767a\u52d5\uff1a"),J(61,"input",23),Re("ngModelChange",function(r){return Le(e),$e().chatActivate=r}),oe()(),J(62,"div"),we(63," YouTube\u518d\u751f :"),J(64,"input",24),Re("ngModelChange",function(r){return Le(e),$e().cutInIsVideo=r})("change",function(){return Le(e),$e().changeYouTubeInfo()}),oe(),we(65," URL :"),J(66,"input",25),Re("ngModelChange",function(r){return Le(e),$e().cutInVideoURL=r})("input",function(){return Le(e),$e().changeYouTubeInfo()}),oe(),it(67,"br"),J(68,"a",26),Re("click",function(){return Le(e),$e().openYouTubeTerms()}),we(69,"YouTube \u5229\u7528\u898f\u7d04"),oe(),we(70," :\u6a5f\u80fd\u4f7f\u7528\u524d\u306b\u78ba\u8a8d\u304f\u3060\u3055\u3044 "),oe(),J(71,"div")(72,"p",27),we(73,"\u203b\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u6319\u52d5"),it(74,"br"),we(75,"\n\u30bf\u30b0\u540d\u79f0\u304c\u540c\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u5148\u306b\u518d\u751f\u3057\u3066\u3044\u308b\u3082\u306e\u3092\u505c\u6b62\u3057\u307e\u3059(\u30bf\u30b0\u7a7a\u6b04\u542b\u3080)"),it(76,"br"),we(77,"\n\u30bf\u30b0\u540d\u79f0\u304c\u7a7a\u6b04\u3067\u97f3\u697d\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9\u306eBGM\u3092\u505c\u6b62\u3057\u307e\u3059"),it(78,"br"),we(79,"\n\u307e\u305f\u3001\u305d\u306e\u3088\u3046\u306a\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9\u3067BGM\u3092\u518d\u751f\u3059\u308b\u3068\u505c\u6b62\u3057\u307e\u3059"),it(80,"br"),we(81,"\n\u9283\u6483\u97f3\u306eSE\u7b49\u3001BGM\u3068\u540c\u6642\u518d\u751f\u3057\u305f\u3044\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u30bf\u30b0\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044"),it(82,"br"),oe()(),it(83,"hr"),J(84,"div"),Ee(85,rJ,5,1,"ng-container",6),oe(),et()}if(2&n){const e=$e();j(4),ie("ngIf",e.isEditable),j(2),ie("src",Ft(7,43,e.cutInImageUrl,"resourceUrl"),hn),j(3),xt(e.isYouTubeCutIn?"movie":""),j(3),ie("ngModel",e.cutInName),Yt("disabled",e.isEditable?null:""),j(15),ie("ngIf",e.isCutInBgmUploaded()),j(1),ie("ngIf",!e.isCutInBgmUploaded()),j(2),ie("ngIf",!e.isCutInBgmUploaded()),j(1),ie("ngIf",e.isCutInBgmUploaded()),j(2),ie("ngIf",e.isEditable),j(1),ie("ngModel",e.cutInOriginalSize),Yt("disabled",e.isEditable?null:""),j(3),Ht("min",e.minSizeWidth),Ht("max",e.maxSizeWidth),ie("ngModel",e.cutInWidth),Yt("disabled",!e.isEditable||e.cutInOriginalSize?"":null),j(2),ie("ngModel",e.keepImageAspect),Yt("disabled",!e.isEditable||e.cutInOriginalSize?"":null),j(3),Ht("min",e.minSizeHeight),Ht("max",e.maxSizeHeight),ie("ngModel",e.cutInHeight),Yt("disabled",!e.isEditable||e.cutInOriginalSize?"":null),j(2),ie("ngModel",e.cutInX_Pos),Yt("disabled",e.isEditable?null:""),j(2),ie("ngModel",e.cutInX_Pos),Yt("disabled",e.isEditable?null:""),j(2),ie("ngModel",e.cutInY_Pos),Yt("disabled",e.isEditable?null:""),j(2),ie("ngModel",e.cutInY_Pos),Yt("disabled",e.isEditable?null:""),j(3),ie("ngModel",e.cutInIsLoop),Yt("disabled",e.isEditable?null:""),j(3),ie("ngModel",e.cutInOutTime),Yt("disabled",e.isEditable?null:""),j(3),ie("ngModel",e.cutInTagName),Yt("disabled",e.isEditable?null:""),j(2),ie("ngModel",e.chatActivate),Yt("disabled",e.isEditable?null:""),j(3),ie("ngModel",e.cutInIsVideo),Yt("disabled",e.isEditable?null:""),j(2),ie("ngModel",e.cutInVideoURL),Yt("disabled",e.isEditable?null:""),j(19),ie("ngIf",!e.isDeleted)}}function sJ(n,t){1&n&&(Je(0),J(1,"div",29),we(2,"\u203b\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u65b0\u3057\u3044\u30ab\u30c3\u30c8\u30a4\u30f3\u3092\u4f5c\u308b\u300d\u304b\u3089\u65b0\u3057\u3044\u30ab\u30c3\u30c8\u30a4\u30f3\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),oe(),et())}let aJ=(()=>{class n{constructor(e,i,r,o,s){this.pointerDeviceService=e,this.modalService=i,this.saveDataService=r,this.panelService=o,this.ngZone=s,this._minSizeWidth=10,this._maxSizeWidth=10,this._minSizeHeight=1200,this._maxSizeHeight=1200,this.lazyUpdateTimer=null,this.selectedCutIn=null,this.isYouTubeCutIn=!1,this.isSaveing=!1,this.progresPercent=0}get cutInLauncher(){return Xe.instance.get("CutInLauncher")}get cutInName(){return this.isEditable?this.selectedCutIn.name:""}set cutInName(e){this.isEditable&&(this.selectedCutIn.name=e)}set cutInWidth(e){this.isEditable&&(this.selectedCutIn.width=e),this.keepImageAspect&&(this.selectedCutIn.height=this.isYouTubeCutIn?Math.floor(e*this.selectedCutIn.defVideoSizeHeight/this.selectedCutIn.defVideoSizeWidth):Math.floor(e*this.originalImgHeight()/this.originalImgWidth()),console.log(" this.keepImageAspect H"+this.selectedCutIn.height))}set cutInHeight(e){this.isEditable&&(this.selectedCutIn.height=e),this.keepImageAspect&&(this.selectedCutIn.width=this.isYouTubeCutIn?Math.floor(e*this.selectedCutIn.defVideoSizeWidth/this.selectedCutIn.defVideoSizeHeight):Math.floor(e*this.originalImgWidth()/this.originalImgHeight()),console.log(" this.keepImageAspect W"+this.selectedCutIn.width))}get cutInWidth(){if(!this.isEditable||!this.selectedCutIn)return 0;if(this.cutInOriginalSize)if(this.isYouTubeCutIn){const e=this.selectedCutIn.defVideoSizeWidth;this.selectedCutIn.width!=e&&(this.selectedCutIn.width=e,console.log(" setCutInYouTubeSize w:"+e))}else{const e=this.originalImgWidth();this.selectedCutIn.width!=e&&(this.selectedCutIn.width=e,console.log(" setCutInOriginalSize w"+e))}return this.selectedCutIn.width}get cutInHeight(){if(!this.isEditable||!this.selectedCutIn)return 0;if(this.cutInOriginalSize)if(this.isYouTubeCutIn){const e=this.selectedCutIn.defVideoSizeHeight;this.selectedCutIn.height!=e&&(this.selectedCutIn.height=e,console.log(" setCutInYouTubeSize h:"+e))}else{const e=this.originalImgHeight();this.selectedCutIn.height!=e&&(this.selectedCutIn.height=e,console.log(" setCutInOriginalSize h"+e))}return this.selectedCutIn.height}get keepImageAspect(){return!(!this.isEditable||!this.selectedCutIn)&&this.selectedCutIn.keepImageAspect}set keepImageAspect(e){!this.isEditable||!this.selectedCutIn||(this.selectedCutIn.keepImageAspect=e)}chkImageAspect(){if(!this.isEditable||!this.selectedCutIn)return 0;setTimeout(()=>{if(this.keepImageAspect){let e=this.selectedCutIn.cutInImage.url;if(e.length>0){let i=new Image;i.src=e,console.log("img.height /  img.width "+i.height+" "+i.width),this.selectedCutIn.height=this.isYouTubeCutIn?Math.floor(this.selectedCutIn.width*this.selectedCutIn.defVideoSizeHeight/this.selectedCutIn.defVideoSizeWidth):Math.floor(this.selectedCutIn.width*i.height/i.width)}}})}get cutInX_Pos(){return this.isEditable?this.selectedCutIn.x_pos:0}set cutInX_Pos(e){this.isEditable&&(this.selectedCutIn.x_pos=e)}get cutInY_Pos(){return this.isEditable?this.selectedCutIn.y_pos:0}set cutInY_Pos(e){this.isEditable&&(this.selectedCutIn.y_pos=e)}get cutInOriginalSize(){return!!this.isEditable&&this.selectedCutIn.originalSize}set cutInOriginalSize(e){this.isEditable&&(this.selectedCutIn.originalSize=e)}get cutInIsLoop(){return!!this.isEditable&&this.selectedCutIn.isLoop}set cutInIsLoop(e){this.isEditable&&(this.selectedCutIn.isLoop=e)}get chatActivate(){return!!this.isEditable&&this.selectedCutIn.chatActivate}set chatActivate(e){this.isEditable&&(this.selectedCutIn.chatActivate=e)}get cutInOutTime(){return this.isEditable?this.selectedCutIn.outTime:0}set cutInOutTime(e){this.isEditable&&(this.selectedCutIn.outTime=e)}get cutInIsVideo(){return!!this.isEditable&&this.selectedCutIn.isVideoCutIn}set cutInIsVideo(e){this.isEditable&&(this.selectedCutIn.isVideoCutIn=e)}get cutInVideoURL(){return this.isEditable?this.selectedCutIn.videoUrl:""}set cutInVideoURL(e){this.isEditable&&(this.selectedCutIn.videoUrl=e)}get cutInTagName(){return this.isEditable?this.selectedCutIn.tagName:""}set cutInTagName(e){this.isEditable&&(this.selectedCutIn.tagName=e)}get cutInAudioName(){return this.isEditable?this.selectedCutIn.audioName:""}set cutInAudioName(e){this.isEditable&&(this.selectedCutIn.audioName=e)}get cutInAudioIdentifier(){return this.isEditable?this.selectedCutIn.audioIdentifier:""}set cutInAudioIdentifier(e){this.isEditable&&(this.selectedCutIn.audioIdentifier=e)}get audios(){return en.instance.audios.filter(e=>!e.isHidden)}get jukebox(){return Xe.instance.get("Jukebox")}get cutInImage(){return this.selectedCutIn&&St.instance.get(this.selectedCutIn.imageIdentifier)||Bt.Empty}get isSelected(){return!!this.selectedCutIn}get isEditable(){return!this.isEmpty&&this.isSelected}get isEmpty(){return!1}get cutInImageUrl(){return this.selectedCutIn?this.selectedCutIn.videoId?`https://img.youtube.com/vi/${this.selectedCutIn.videoId}/hqdefault.jpg`:this.cutInImage.url:Bt.Empty.url}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30ab\u30c3\u30c8\u30a4\u30f3\u30ea\u30b9\u30c8")}ngOnDestroy(){Qe.unregister(this)}selectCutIn(e){this.selectedCutIn=Xe.instance.get(e),this.isYouTubeCutIn=!!this.selectedCutIn.videoId}getCutIns(){return Xe.instance.getObjects(Yi)}createCutIn(){let e=new Yi;e.name="\u672a\u8a2d\u5b9a\u306e\u30ab\u30c3\u30c8\u30a4\u30f3",e.imageIdentifier="testTableBackgroundImage_image",e.initialize(),this.selectCutIn(e.identifier)}save(){var e=this;return(0,xn.Z)(function*(){if(!e.selectedCutIn)return;e.isSaveing=!0,e.progresPercent=0,e.selectedCutIn.selected=!0;let i="cut_"+e.selectedCutIn.name;yield e.saveDataService.saveGameObjectAsync(e.selectedCutIn,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}delete(){!this.isEmpty&&this.selectedCutIn&&(this.selectedCutIn.destroy(),this.selectedCutIn=null)}openCutInImageModal(){!this.isSelected||this.modalService.open(Hf).then(e=>{!this.selectedCutIn||!e||(this.selectedCutIn.imageIdentifier=e)})}openCutInBgmModal(){!this.isSelected||this.modalService.open(OQ).then(e=>{if(console.log("CUTIN "+e),!this.selectedCutIn||!e)return;this.cutInAudioIdentifier=e;let i=en.instance.get(e);i&&(this.cutInAudioName=i.name,console.log("cutInAudioName"+this.cutInAudioName))})}isCutInBgmUploaded(){return!!this.isSelected&&!!en.instance.get(this.cutInAudioIdentifier)}stoppreviewCutIn(){}originalImgWidth(){if(!this.isSelected||!this.selectedCutIn||!this.selectedCutIn.cutInImage)return 0;let e=this.selectedCutIn.cutInImage.url;if(e.length>0){let i=new Image;return i.src=e,i.width}return 0}originalImgHeight(){if(!this.isSelected||!this.selectedCutIn||!this.selectedCutIn.cutInImage)return 0;let e=this.selectedCutIn.cutInImage.url;if(e.length>0){let i=new Image;return i.src=e,i.height}return 0}openYouTubeTerms(){return this.modalService.open(UQ,{url:"https://www.youtube.com/terms",title:"YouTube \u5229\u7528\u898f\u7d04"}),!1}changeYouTubeInfo(){if(console.log("changeYouTubeInfo"),!this.selectedCutIn)return;const e=!!this.selectedCutIn.videoId;(!this.isYouTubeCutIn&&e||this.isYouTubeCutIn&&!e)&&this.setDefaultControl(e),this.isYouTubeCutIn=e}get minSizeWidth(){return this.selectedCutIn&&(this._minSizeWidth=this.selectedCutIn.minSizeWidth(this.isYouTubeCutIn)),this._minSizeWidth}get maxSizeWidth(){return this.selectedCutIn&&(this._maxSizeWidth=this.selectedCutIn.maxSizeWidth(this.isYouTubeCutIn)),this._maxSizeWidth}get minSizeHeight(){return this.selectedCutIn&&(this._minSizeHeight=this.selectedCutIn.minSizeHeight(this.isYouTubeCutIn)),this._minSizeHeight}get maxSizeHeight(){return this.selectedCutIn&&(this._maxSizeHeight=this.selectedCutIn.maxSizeHeight(this.isYouTubeCutIn)),this._maxSizeHeight}setDefaultControl(e){if(!this.isEditable||!this.selectedCutIn)return 0;console.log("setDefaultControl"),e?(console.log("setDefaultControl isVideo"),this.selectedCutIn.width=this.selectedCutIn.defVideoSizeWidth,this.selectedCutIn.height=this.selectedCutIn.defVideoSizeHeight):(console.log("setDefaultControl ! isVideo"),this.selectedCutIn.width=this.originalImgWidth(),this.selectedCutIn.height=this.originalImgHeight())}previewCutIn(){if(this.selectedCutIn.originalSize){let e=this.selectedCutIn.cutInImage.url;e.length>0&&((new Image).src=e,this.selectedCutIn.width=this.originalImgWidth(),this.selectedCutIn.height=this.originalImgHeight())}this.cutInLauncher.startCutInMySelf(this.selectedCutIn)}playCutIn(){if(this.selectedCutIn.originalSize){let e=this.selectedCutIn.cutInImage.url;e.length>0&&((new Image).src=e,this.selectedCutIn.width=this.originalImgWidth(),this.selectedCutIn.height=this.originalImgHeight())}this.isCutInBgmUploaded()&&""==this.cutInTagName&&this.jukebox.stop(),this.cutInLauncher.startCutIn(this.selectedCutIn)}stopCutIn(){!this.isSelected||this.cutInLauncher.stopCutIn(this.selectedCutIn)}}return n.\u0275fac=function(e){return new(e||n)(Be(Di),Be(pi),Be(ko),Be($n),Be(An))},n.\u0275cmp=Qt({type:n,selectors:[["app-cut-in-list"]],decls:10,vars:4,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[3,"click"],["size","20",2,"width","15em",3,"ngModel","change"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item",2,"width","380px"],[4,"ngIf"],[3,"value"],[1,"images-select"],[1,"grow",2,"height","120px",3,"click"],["height","120",3,"src"],[1,"material-icons",2,"font-size","32px","margin-left","-28px"],["placeholder","Name",1,"is-caret",3,"ngModel","ngModelChange"],[3,"disabled","click"],[2,"margin-left","20px"],["type","checkbox","name","cutInOriginalSize",3,"ngModel","ngModelChange"],["type","number",1,"is-caret",2,"width","5em",3,"ngModel","min","max","ngModelChange"],["type","checkbox","name","keepImageAspect",3,"ngModel","ngModelChange","click"],["type","range","min","0","max","100","name","cutInX_PosWidth",3,"ngModel","ngModelChange"],["type","number","min","0","max","100",1,"is-caret",2,"width","5em",3,"ngModel","ngModelChange"],["type","checkbox","name","cutInIsLoop",3,"ngModel","ngModelChange"],["type","number","min","0",1,"is-caret",2,"width","5em",3,"ngModel","ngModelChange"],["placeholder","",1,"is-caret",2,"width","5em",3,"ngModel","ngModelChange"],["type","checkbox","name","chatActivate",3,"ngModel","ngModelChange"],["type","checkbox","name","cutInIsVideo",3,"ngModel","ngModelChange","change"],["placeholder","URL",1,"is-caret",3,"ngModel","ngModelChange","input"],["href","https://www.youtube.com/terms","target","_blank",1,"outer-link",3,"click"],[2,"font-size","0.4em"],[1,"danger",3,"click"],[2,"font-size","12px"]],template:function(e,i){1&e&&(J(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Re("click",function(){return i.createCutIn()}),we(4,"\u65b0\u3057\u3044\u30ab\u30c3\u30c8\u30a4\u30f3\u3092\u4f5c\u308b"),oe()(),J(5,"select",3),Re("change",function(o){return i.selectCutIn(o.target.value)}),Ee(6,jQ,2,2,"option",4),oe()(),J(7,"div",5),Ee(8,oJ,86,46,"ng-container",6),oe()(),Ee(9,sJ,3,0,"ng-container",6)),2&e&&(j(5),ie("ngModel",null==i.selectedCutIn?null:i.selectedCutIn.identifier),j(1),ie("ngForOf",i.getCutIns()),j(2),ie("ngIf",!i.isEmpty||i.selectedCutIn),j(1),ie("ngIf",i.isEmpty))},directives:[nc,Ti,yi,si,ic,rc,Sn,Fi,ra,ms,Vc,Ju,oa],pipes:[Ii],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.images-select[_ngcontent-%COMP%]{display:flex}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();function lJ(n,t){if(1&n){const e=pt();J(0,"button",11),Re("click",function(){return Le(e),$e().openCutInList()}),we(1,"\u30ab\u30c3\u30c8\u30a4\u30f3\u7de8\u96c6"),oe()}2&n&&ie("disabled",0)}function cJ(n,t){if(1&n){const e=pt();J(0,"button",11),Re("click",function(){Le(e);const r=$e().$implicit;return $e().play(r)}),we(1,"\u8a66\u8074/\u518d\u751f"),oe()}2&n&&ie("disabled",!$e().$implicit.isReady)}function uJ(n,t){if(1&n){const e=pt();J(0,"button",11),Re("click",function(){return Le(e),$e(2).stop()}),we(1,"\u8a66\u8074/\u505c\u6b62"),oe()}2&n&&ie("disabled",!$e().$implicit.isReady)}function dJ(n,t){if(1&n){const e=pt();J(0,"button",11),Re("click",function(){Le(e);const r=$e().$implicit;return $e().playBGM(r)}),we(1,"BGM/\u518d\u751f"),oe()}2&n&&ie("disabled",!$e().$implicit.isReady)}function fJ(n,t){if(1&n){const e=pt();J(0,"button",11),Re("click",function(){Le(e);const r=$e().$implicit;return $e().stopBGM(r)}),we(1,"BGM/\u505c\u6b62"),oe()}2&n&&ie("disabled",!$e().$implicit.isReady)}function hJ(n,t){1&n&&(J(0,"span"),we(1,"\u3010\u8a66\u8074\u4e2d\u3011"),oe())}function pJ(n,t){1&n&&(J(0,"span"),we(1,"\u3010BGM\u3011"),oe())}function gJ(n,t){if(1&n&&(J(0,"div",12),Ee(1,cJ,2,1,"button",4),Ee(2,uJ,2,1,"button",4),Ee(3,dJ,2,1,"button",4),Ee(4,fJ,2,1,"button",4),Ee(5,hJ,2,0,"span",6),Ee(6,pJ,2,0,"span",6),J(7,"span"),we(8),oe(),it(9,"br"),oe()),2&n){const e=t.$implicit,i=$e();j(1),ie("ngIf",e!==(null==i.auditionPlayer?null:i.auditionPlayer.audio)||(null==i.auditionPlayer?null:i.auditionPlayer.paused)),j(1),ie("ngIf",e===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused)),j(1),ie("ngIf",e!==(null==i.jukebox?null:i.jukebox.audio)),j(1),ie("ngIf",e===(null==i.jukebox?null:i.jukebox.audio)),j(1),ie("ngIf",e===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused)),j(1),ie("ngIf",e===(null==i.jukebox?null:i.jukebox.audio)),j(2),xt(e.name)}}function _J(n,t){1&n&&(J(0,"div"),we(1,"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u3053\u3053\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002"),oe())}let mJ=(()=>{class n{constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.pointerDeviceService=r,this.ngZone=o,this.roomVolumeChange=!1,this.auditionPlayer=new Jt,this.lazyUpdateTimer=null}get roomVolume(){let e=Xe.instance.get("Config");return e?e.roomVolume:1}set roomVolume(e){let i=Xe.instance.get("Config");i&&(i.roomVolume=e),this.jukebox.setNewVolume()}get volume(){return this.jukebox.volume}set volume(e){this.jukebox.volume=e,Jt.volume=e*this.roomVolume,Qe.trigger("CHANGE_JUKEBOX_VOLUME",null)}get auditionVolume(){return this.jukebox.auditionVolume}set auditionVolume(e){this.jukebox.auditionVolume=e,Jt.auditionVolume=e*this.roomVolume,Qe.trigger("CHANGE_JUKEBOX_VOLUME",null)}get audios(){return en.instance.audios.filter(e=>!e.isHidden)}get jukebox(){return Xe.instance.get("Jukebox")}get cutInLauncher(){return Xe.instance.get("CutInLauncher")}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9"),this.auditionPlayer.volumeType=Rf.AUDITION,Qe.register(this).on("*",e=>{e.eventName.startsWith("FILE_")&&this.lazyNgZoneUpdate()})}ngOnDestroy(){Qe.unregister(this),this.stop()}play(e){this.auditionPlayer.play(e)}stop(){this.auditionPlayer.stop()}playBGM(e){this.cutInLauncher.stopBlankTagCutIn(),this.jukebox.play(e.identifier,!0)}stopBGM(e){this.jukebox.audio===e&&this.jukebox.stop()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&Cl.instance.load(r),i.value=""}lazyNgZoneUpdate(){null===this.lazyUpdateTimer&&(this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,this.ngZone.run(()=>{})},100))}openCutInList(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(aJ,{left:e.x+25,top:e.y+25,width:650,height:740})}}return n.\u0275fac=function(e){return new(e||n)(Be(pi),Be($n),Be(Di),Be(An))},n.\u0275cmp=Qt({type:n,selectors:[["app-jukebox"]],decls:39,vars:8,consts:[["type","range","min","0","max","1","step","0.01",3,"ngModel","ngModelChange"],["type","range","min","0","max","2","step","0.01",3,"ngModel","disabled","ngModelChange"],[2,"font-size","12px"],["type","checkbox","id","roomVolumeChange","value","roomVolumeChange",3,"ngModel","ngModelChange"],[3,"disabled","click",4,"ngIf"],["class","box",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","audio/*",2,"display","none",3,"change"],[3,"disabled","click"],[1,"box"]],template:function(e,i){1&e&&(J(0,"div"),we(1,"\u8a66\u8074\u97f3\u91cf\uff1a"),J(2,"input",0),Re("ngModelChange",function(o){return i.auditionVolume=o}),oe()(),J(3,"div"),we(4,"BGM\u97f3\u91cf\uff1a"),J(5,"input",0),Re("ngModelChange",function(o){return i.volume=o}),oe()(),it(6,"hr"),J(7,"div"),we(8,"\u5168\u4f53\u97f3\u91cf\uff1a"),J(9,"input",1),Re("ngModelChange",function(o){return i.roomVolume=o}),oe(),it(10,"br"),J(11,"font",2),we(12,"\u203b\u5168\u30d7\u30ec\u30a4\u30e4\u30fc\u5171\u901a GM\u5236\u5fa1\u7528\uff1a\u5909\u66f4\u3092\u6709\u52b9\u306b\u3059\u308b"),J(13,"input",3),Re("ngModelChange",function(o){return i.roomVolumeChange=o}),oe()()(),it(14,"hr"),Ee(15,lJ,2,1,"button",4),it(16,"hr"),J(17,"div"),Ee(18,gJ,10,7,"div",5),Ee(19,_J,2,0,"div",6),oe(),J(20,"label")(21,"div",7)(22,"div")(23,"i",8),we(24,"playlist_add"),oe()(),J(25,"div"),we(26,"\u3053\u3053\u306b\u97f3\u697d\u3092\u30c9\u30ed\u30c3\u30d7"),oe(),J(27,"div",9),we(28,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),oe(),J(29,"input",10),Re("change",function(o){return i.handleFileSelect(o)}),oe(),J(30,"div",9),it(31,"br"),we(32,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d10MB\u307e\u3067"),oe()()(),J(33,"div",2),we(34,"\u203b\u300c\u8a66\u8074\u300d\u306f\u81ea\u5206\u306e\u30b9\u30d4\u30fc\u30ab\u30fc\u3060\u3051\u3067\u97f3\u697d\u30921\u56de\u518d\u751f\u3057\u307e\u3059\u3002"),oe(),J(35,"div",2),we(36,"\u203b\u300cBGM\u300d\u306f\u30eb\u30fc\u30e0\u5185\u306e\u5168\u54e1\u30671\u3064\u306e\u97f3\u697d\u3092\u30eb\u30fc\u30d7\u518d\u751f\u3057\u307e\u3059\u3002"),oe(),J(37,"div",2),we(38,"\u203b\u73fe\u884c\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u306b\u306f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u3002\uff08\u6bce\u56de\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u5fc5\u8981\u3067\u3059\uff09"),oe()),2&e&&(j(2),ie("ngModel",i.auditionVolume),j(3),ie("ngModel",i.volume),j(4),Ht("disabled",!i.roomVolumeChange),ie("ngModel",i.roomVolume),j(4),ie("ngModel",i.roomVolumeChange),j(2),ie("ngIf",1),j(3),ie("ngForOf",i.audios),j(1),ie("ngIf",i.audios.length<1))},directives:[oa,Fi,Ti,yi,ra,Sn,si],styles:['[_nghost-%COMP%]{display:block}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}']}),n})();const $J=["content"],vJ=["*"];let bJ=(()=>{class n{constructor(e){this.modalService=e}clickBackground(e){e.target===e.currentTarget&&this.resolve()}resolve(){this.modalService.resolve(null)}reject(){this.modalService.reject()}}return n.\u0275fac=function(e){return new(e||n)(Be(pi))},n.\u0275cmp=Qt({type:n,selectors:[["modal"]],viewQuery:function(e,i){if(1&e&&Gn($J,7,ds),2&e){let r;yn(r=Cn())&&(i.content=r.first)}},ngContentSelectors:vJ,decls:13,vars:3,consts:[[1,"component"],[1,"modal-background",3,"click"],[1,"modal-panel"],[1,"title"],[1,"title-button"],[3,"click"],[1,"material-icons",2,"font-size","14px"],[1,"scrollable-panel"],["content",""]],template:function(e,i){1&e&&(j_(),J(0,"div",0)(1,"div",1),Re("click",function(o){return i.clickBackground(o)}),oe(),J(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5),Re("click",function(){return i.resolve()}),J(6,"i",6),we(7,"close"),oe()()(),we(8),oe(),J(9,"div",7),G_(10),it(11,"div",null,8),oe()()()),2&e&&(j(1),ie("@bgInOut","in"),j(1),ie("@flyInOut","in"),j(6),sn(" ",i.modalService.title," "))},styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;top:0;bottom:0;left:0;right:0;z-index:1899999;display:flex;align-items:center;justify-content:center;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.modal-background[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;color:#ccc;background-color:#1e1e1e4d;top:0;bottom:0;left:0;right:0;z-index:-1}.modal-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:hidden;color:#444;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;height:auto;max-height:calc(100% - 10px);width:800px;max-width:100%}.title[_ngcontent-%COMP%]{position:relative;overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#ccc;color:#444}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#444}.header[_ngcontent-%COMP%], .content[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]{padding:10px}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;max-height:calc(100vh - 41px);width:100%;padding:8px}"],data:{animation:[Na("flyInOut",[Lr("void => *",[Br("100ms ease-out",Ls([mn({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),mn({transform:"scale(1.0, 1.0)",opacity:"1.0",offset:1})]))]),Lr("* => void",[Br(100,mn({transform:"scale(0, 0)"}))])]),Na("bgInOut",[ox("in",mn({"background-color":"rgba(30, 30, 30, 0.4)"})),Lr("void => *",[mn({"background-color":"rgba(30, 30, 30, 0.0)"}),Br(200)]),Lr("* => void",[Br(200,mn({"background-color":"rgba(30, 30, 30, 0.0)"}))])])]}}),n})();const yJ=["passwordInput"],CJ=function(){return{standalone:!0}};let xJ=(()=>{class n{constructor(e,i){this.panelService=e,this.modalService=i,this.password="",this.help="",this.targetPeerContext=null,this.title="",this.targetPeerContext=zi.parse(i.option.peerId?i.option.peerId:"???"),this.title=i.option.title?i.option.title:""}get peerId(){return bt.peerId}get isConnected(){return!(bt.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title=`\u30d1\u30b9\u30ef\u30fc\u30c9 \uff1c${this.title}\uff1e`),Qe.register(this)}ngAfterViewInit(){this.passwordInputElementRef.nativeElement.focus()}ngOnDestroy(){Qe.unregister(this)}onInputChange(e){this.help=""}submit(){this.targetPeerContext.verifyPassword(this.password)&&this.modalService.resolve(this.password),this.help="\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9055\u3044\u307e\u3059"}}return n.\u0275fac=function(e){return new(e||n)(Be($n),Be(pi))},n.\u0275cmp=Qt({type:n,selectors:[["password-check"]],viewQuery:function(e,i){if(1&e&&Gn(yJ,7),2&e){let r;yn(r=Cn())&&(i.passwordInputElementRef=r.first)}},decls:11,vars:4,consts:[["passwordForm","ngForm"],["placeholder","\u30d1\u30b9\u30ef\u30fc\u30c9",1,"is-caret",3,"ngModel","ngModelOptions","ngModelChange","input"],["passwordInput",""],["type","submit",3,"click"],[2,"font-size","12px"]],template:function(e,i){1&e&&(J(0,"form",null,0)(2,"div"),we(3,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),J(4,"input",1,2),Re("ngModelChange",function(o){return i.password=o})("input",function(o){return i.onInputChange(o.target.value)}),oe()(),J(6,"button",3),Re("click",function(){return i.submit()}),we(7,"\u5165\u5ba4"),oe()(),J(8,"div")(9,"span",4),we(10),oe()()),2&e&&(j(4),ie("ngModel",i.password)("ngModelOptions",$r(3,CJ)),j(6),xt(i.help))},directives:[_s,gs,xo,Fi,Ti,yi],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();function wJ(n,t){if(1&n&&(J(0,"div")(1,"div",9),we(2," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),oe(),J(3,"div",9),we(4," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),oe(),J(5,"div",9),we(6," \u30eb\u30fc\u30e0\u540d\u524d\u306e\u9577\u3055\u306f128\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),oe()()),2&n){$e();const e=ln(4);j(1),ie("hidden",!e.errors.required),j(2),ie("hidden",!e.errors.minlength),j(2),ie("hidden",!e.errors.maxlength)}}function EJ(n,t){if(1&n&&(J(0,"div")(1,"div",9),we(2," \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u306f12\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),oe()()),2&n){$e();const e=ln(8);j(1),ie("hidden",!e.errors.maxlength)}}function TJ(n,t){1&n&&(J(0,"div"),we(1," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5408\u8a08\u304c\u9577\u3059\u304e\u308b\u3088\u3046\u3067\u3059\u3002\u3069\u3061\u3089\u304b\u3092\u5c11\u3057\u77ed\u304f\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002 "),oe())}function SJ(n,t){if(1&n){const e=pt();J(0,"div")(1,"div"),we(2,"\u30eb\u30fc\u30e0\u540d : "),J(3,"input",3,4),Re("input",function(r){Le(e);const o=$e();return o.calcPeerId(r.target.value,o.password)})("ngModelChange",function(r){return Le(e),$e().roomName=r}),oe()(),J(5,"div"),we(6,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),J(7,"input",5,6),Re("input",function(r){Le(e);const o=$e();return o.calcPeerId(o.roomName,r.target.value)})("ngModelChange",function(r){return Le(e),$e().password=r}),oe()(),it(9,"hr"),Ee(10,wJ,7,3,"div",7),Ee(11,EJ,3,1,"div",7),Ee(12,TJ,2,0,"div",7),J(13,"div")(14,"button",8),Re("click",function(){return Le(e),$e().createRoom()}),we(15,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210"),oe()()()}if(2&n){const e=ln(4),i=ln(8),r=$e();j(3),ie("ngModel",r.roomName),j(4),ie("ngModel",r.password),j(3),ie("ngIf",e.errors&&(e.dirty||e.touched)),j(1),ie("ngIf",i.errors&&(i.dirty||i.touched)),j(1),ie("ngIf",!r.validateLength),j(2),ie("disabled",!e.valid||!i.valid||!r.validateLength)}}function DJ(n,t){1&n&&(J(0,"span",1),we(1,"\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u63a5\u7d9a\u3057\u305f\u307e\u307e\u3067\u306f\u30eb\u30fc\u30e0\u4f5c\u6210\u3092\u884c\u3048\u307e\u305b\u3093\u3002"),it(2,"br"),we(3,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),it(4,"br"),we(5,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),oe())}let IJ=(()=>{class n{constructor(e,i){this.panelService=e,this.modalService=i,this.peers=[],this.isReloading=!1,this.roomName="\u3075\u3064\u3046\u306e\u90e8\u5c4b",this.password="",this.isPrivate=!1,this.validateLength=!1}get peerId(){return bt.peerId}get isConnected(){return!(bt.peerIds.length<=1)}get myPeer(){return _t.myCursor}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30eb\u30fc\u30e0\u4f5c\u6210"),Qe.register(this),this.calcPeerId(this.roomName,this.password)}ngOnDestroy(){Qe.unregister(this)}calcPeerId(e,i){let r=bt.peerContext?bt.peerContext.userId:zi.generateId(),o=zi.create(r,zi.generateId("***"),e,i);this.validateLength=o.peerId.length<64,this.myPeer.reConnectPass=i}createRoom(){let e=bt.peerContext?bt.peerContext.userId:zi.generateId();bt.open(e,zi.generateId("***"),this.roomName,this.password),_t.myCursor.peerId=bt.peerId,this.myPeer.reConnectPass=this.password,this.modalService.resolve()}}return n.\u0275fac=function(e){return new(e||n)(Be($n),Be(pi))},n.\u0275cmp=Qt({type:n,selectors:[["room-setting"]],decls:6,vars:2,consts:[[4,"ngIf","ngIfElse"],[2,"font-size","12px"],["other_content",""],["required","","minlength","1","maxlength","128","placeholder","\u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808",1,"input",3,"ngModel","input","ngModelChange"],["roomNameValidation","ngModel"],["maxlength","12","placeholder","\u7a7a\u306a\u3089\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u3057",1,"input",3,"ngModel","input","ngModelChange"],["passwordValidation","ngModel"],[4,"ngIf"],[3,"disabled","click"],[3,"hidden"]],template:function(e,i){if(1&e&&(Ee(0,SJ,16,6,"div",0),J(1,"div")(2,"span",1),we(3,"\u203b\u4f5c\u6210\u3057\u305f\u30eb\u30fc\u30e0\u306f\u53c2\u52a0\u8005\u304c0\u4eba\u306b\u306a\u3063\u305f\u6642\u70b9\u3067\u89e3\u6563\u3057\u307e\u3059\u3002\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),oe()(),Ee(4,DJ,6,0,"ng-template",null,2,Ln)),2&e){const r=ln(5);ie("ngIf",!i.isConnected)("ngIfElse",r)}},directives:[Sn,Fi,lv,ix,rx,Ti,yi],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.input[_ngcontent-%COMP%]{width:100%}"]}),n})();function kJ(n,t){1&n&&(J(0,"td")(1,"i",11),we(2,"lock"),oe()())}function MJ(n,t){1&n&&(J(0,"td"),we(1,"-"),oe())}function AJ(n,t){if(1&n){const e=pt();J(0,"button",12),Re("click",function(){Le(e);const r=$e().$implicit;return $e(3).connect(r.peerContexts)}),we(1,"\u63a5\u7d9a"),oe()}if(2&n){const e=$e().$implicit,i=$e(3);ie("disabled",(null==e.peerContexts[0]?null:e.peerContexts[0].roomId)===i.currentRoom)}}function PJ(n,t){if(1&n&&(Je(0),J(1,"tr")(2,"td",9),we(3),oe(),J(4,"td",7),we(5),oe(),Ee(6,kJ,3,0,"td",4),Ee(7,MJ,2,0,"td",4),J(8,"td"),we(9),oe(),J(10,"td"),Ee(11,AJ,2,1,"button",10),oe()(),et()),2&n){const e=t.$implicit;j(3),xt(null==e.peerContexts[0]?null:e.peerContexts[0].roomId),j(2),xt(e.roomName),j(1),ie("ngIf",e.peerContexts[0].hasPassword),j(1),ie("ngIf",!e.peerContexts[0].hasPassword),j(2),sn("",e.peerContexts.length,"\u4eba"),j(2),ie("ngIf",0<e.alias.length)}}function FJ(n,t){if(1&n&&(Je(0),J(1,"table",6)(2,"tr")(3,"th"),we(4,"\u30eb\u30fc\u30e0ID"),oe(),J(5,"th",7),we(6,"\u30eb\u30fc\u30e0\u540d"),oe(),J(7,"th"),we(8,"\u30d1\u30b9\u30ef\u30fc\u30c9"),oe(),J(9,"th"),we(10,"\u53c2\u52a0\u8005"),oe(),it(11,"th"),oe(),Ee(12,PJ,12,6,"ng-container",8),oe(),et()),2&n){const e=$e(2);j(12),ie("ngForOf",e.rooms)}}function RJ(n,t){if(1&n&&(J(0,"span",13),we(1),oe()),2&n){const e=$e(2);j(1),xt(e.help)}}function NJ(n,t){if(1&n){const e=pt();J(0,"div")(1,"button",2),Re("click",function(){return Le(e),$e().reload()}),we(2,"\u4e00\u89a7\u3092\u66f4\u65b0"),oe(),J(3,"button",3),Re("click",function(){return Le(e),$e().showRoomSetting()}),we(4,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b"),oe(),it(5,"hr"),Ee(6,FJ,13,1,"ng-container",4),Ee(7,RJ,2,1,"span",5),oe()}if(2&n){const e=$e();j(1),ie("disabled",e.isReloading),j(5),ie("ngIf",e.rooms.length),j(1),ie("ngIf",e.rooms.length<1)}}function OJ(n,t){1&n&&(J(0,"span",13),we(1,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),it(2,"br"),we(3,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),oe())}let BJ=(()=>{class n{constructor(e,i){this.panelService=e,this.modalService=i,this.rooms=[],this.isReloading=!1,this.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"}get currentRoom(){return bt.peerContext.roomId}get peerId(){return bt.peerId}get isConnected(){return!(bt.peerIds.length<=1)}get myPeer(){return _t.myCursor}ngOnInit(){Promise.resolve().then(()=>this.changeTitle()),Qe.register(this).on("OPEN_NETWORK",e=>{this.changeTitle()}).on("CONNECT_PEER",e=>{this.changeTitle()}),this.reload()}changeTitle(){this.modalService.title=this.panelService.title="\u30ed\u30d3\u30fc",bt.peerContext.roomName.length&&(this.modalService.title=this.panelService.title="\uff1c"+bt.peerContext.roomName+"/"+bt.peerContext.roomId+"\uff1e")}ngOnDestroy(){Qe.unregister(this)}reload(){var e=this;return(0,xn.Z)(function*(){e.isReloading=!0,e.help="\u691c\u7d22\u4e2d...",e.rooms=[];let i={},r=yield bt.listAllPeers();for(let o of r){let s=zi.parse(o);if(s.isRoom){let a=s.roomId+s.roomName;a in i||(i[a]=[]),i[a].push(s)}}for(let o in i)e.rooms.push({alias:o,roomName:i[o][0].roomName,peerContexts:i[o]});e.rooms.sort((o,s)=>o.alias<s.alias?-1:o.alias>s.alias?1:0),e.help="\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u300c\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b\u300d\u3067\u65b0\u898f\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002",e.isReloading=!1})()}connect(e){var i=this;return(0,xn.Z)(function*(){let r=e[0],o="";if(r.hasPassword&&(o=yield i.modalService.open(xJ,{peerId:r.peerId,title:`${r.roomName}/${r.roomId}`}),null==o&&(o=""),i.myPeer.reConnectPass=o),!r.verifyPassword(o))return;let s=bt.peerContext?bt.peerContext.userId:zi.generateId();bt.open(s,r.roomId,r.roomName,o),_t.myCursor.peerId=bt.peerId;let a=[];Qe.register(a).on("OPEN_NETWORK",g=>{console.log("LobbyComponent OPEN_PEER",g.data.peerId),Qe.unregister(a),Xe.instance.clearDeleteHistory();for(let w of e)bt.connect(w.peerId);Qe.register(a).on("CONNECT_PEER",w=>{console.log("\u63a5\u7d9a\u6210\u529f\uff01",w.data.peerId),a.push(w.data.peerId),console.log("\u63a5\u7d9a\u6210\u529f "+a.length+"/"+e.length),e.length<=a.length&&(i.resetNetwork(),Qe.unregister(a),i.closeIfConnected())}).on("DISCONNECT_PEER",w=>{console.warn("\u63a5\u7d9a\u5931\u6557",w.data.peerId),a.push(w.data.peerId),console.warn("\u63a5\u7d9a\u5931\u6557 "+a.length+"/"+e.length),e.length<=a.length&&(i.resetNetwork(),Qe.unregister(a),i.closeIfConnected())})})})()}resetNetwork(){bt.peerContexts.length<1&&(bt.open(),_t.myCursor.peerId=bt.peerId)}closeIfConnected(){0<bt.peerContexts.length&&this.modalService.resolve()}showRoomSetting(){var e=this;return(0,xn.Z)(function*(){yield e.modalService.open(IJ,{width:700,height:400,left:0,top:400}),e.reload(),e.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"})()}}return n.\u0275fac=function(e){return new(e||n)(Be($n),Be(pi))},n.\u0275cmp=Qt({type:n,selectors:[["lobby"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["other_content",""],[3,"disabled","click"],[3,"click"],[4,"ngIf"],["style","font-size: 12px;",4,"ngIf"],[1,"room-list"],[1,"room-name"],[4,"ngFor","ngForOf"],[1,"is-small-font"],["type","submit",3,"disabled","click",4,"ngIf"],[1,"material-icons",2,"vertical-align","middle","font-size","0.9rem"],["type","submit",3,"disabled","click"],[2,"font-size","12px"]],template:function(e,i){if(1&e&&(Ee(0,NJ,8,3,"div",0),Ee(1,OJ,4,0,"ng-template",null,1,Ln)),2&e){const r=ln(2);ie("ngIf",!i.isConnected)("ngIfElse",r)}},directives:[Sn,si],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.room-list[_ngcontent-%COMP%]{font-size:12px;border:0;border-spacing:0;padding:0;width:100%;max-width:100%;white-space:nowrap}.room-list[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:1px .5em;text-align:center}.room-name[_ngcontent-%COMP%]{white-space:normal;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;min-width:50%}.is-small-font[_ngcontent-%COMP%]{font-size:10px}"]}),n})();function LJ(n,t){1&n&&(J(0,"span",6),we(1,"STEP1"),oe())}function zJ(n,t){1&n&&(J(0,"span",7),we(1,"STEP1"),oe())}function HJ(n,t){1&n&&(J(0,"span",6),we(1,"STEP2"),oe())}function VJ(n,t){1&n&&(J(0,"span",7),we(1,"STEP2"),oe())}let UJ=(()=>{class n{constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this.rooms=[],this.isReloading=!1,this.isDisconnect=!1,this.networkService=bt,this.roomName="",this.roomId=""}get myPeer(){return _t.myCursor}get currentRoom(){return bt.peerContext.roomId}get peerId(){return bt.peerId}get isConnected(){return!(bt.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.changeTitle()),this.networkService.peerContext.isRoom&&(this.roomName=this.networkService.peerContext.roomName,this.roomId=this.networkService.peerContext.roomId),this.reload()}changeTitle(){this.modalService.title=this.panelService.title="\u518d\u63a5\u7d9a",this.modalService.title=this.panelService.title="\uff1c"+this.roomName+"/"+this.roomId+"\uff1e"}ngOnDestroy(){}reConnect(){this.disConnect(),this.deleteObject(),this.isDisconnect=!0}reConnect2(){if(this.isDisconnect){for(let e of this.rooms)if(e.alias==this.roomId+this.roomName)return this.connect(e.peerContexts),void console.log("\u518d\u63a5\u7d9a\u6210\u529f");console.log("\u518d\u63a5\u7d9a\u5931\u6557")}}reload(){var e=this;return(0,xn.Z)(function*(){console.log("async reload()"),e.isReloading=!0,e.rooms=[];let i={},r=yield bt.listAllPeers();for(let o of r){let s=zi.parse(o);if(s.isRoom){let a=s.roomId+s.roomName;a in i||(i[a]=[]),i[a].push(s)}}for(let o in i)e.rooms.push({alias:o,roomName:i[o][0].roomName,peerContexts:i[o]});e.rooms.sort((o,s)=>o.alias<s.alias?-1:o.alias>s.alias?1:0),e.isReloading=!1})()}connect(e){var i=this;return(0,xn.Z)(function*(){let r=e[0],o="";if(r.hasPassword&&(o=i.myPeer.reConnectPass,null==o&&(o="")),!r.verifyPassword(o))return;let s=bt.peerContext?bt.peerContext.userId:zi.generateId();bt.open(s,r.roomId,r.roomName,o),_t.myCursor.peerId=bt.peerId;let a=[];Qe.register(a).on("OPEN_NETWORK",g=>{console.log("LobbyComponent OPEN_PEER",g.data.peerId),Qe.unregister(a),Xe.instance.clearDeleteHistory();for(let w of e)bt.connect(w.peerId);Qe.register(a).on("CONNECT_PEER",w=>{console.log("\u63a5\u7d9a\u6210\u529f\uff01",w.data.peerId),a.push(w.data.peerId),console.log("\u63a5\u7d9a\u6210\u529f "+a.length+"/"+e.length),e.length<=a.length&&(i.resetNetwork(),Qe.unregister(a),i.closeIfConnected())}).on("DISCONNECT_PEER",w=>{console.warn("\u63a5\u7d9a\u5931\u6557",w.data.peerId),a.push(w.data.peerId),console.warn("\u63a5\u7d9a\u5931\u6557 "+a.length+"/"+e.length),e.length<=a.length&&(i.resetNetwork(),Qe.unregister(a),i.closeIfConnected())})})})()}cancel(){this.modalService.resolve()}resetNetwork(){bt.peerContexts.length<1&&(bt.open(),_t.myCursor.peerId=bt.peerId)}closeIfConnected(){0<bt.peerContexts.length&&this.modalService.resolve()}disConnect(){console.log("\u5207\u65ad"),console.log("\u63a5\u7d9a\u6570 A:"+this.networkService.peerIds.length),this.networkService.connectionClose(),console.log("\u63a5\u7d9a\u6570 B:"+this.networkService.peerIds.length),console.log("\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u72b6\u614b:"+this.networkService.isOpen),console.log("\u518d\u63a5\u7d9a\u6311\u6226:"+this.networkService.open()),console.log("\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u72b6\u614b:"+this.networkService.isOpen)}deleteObject(){console.log("\u5207\u65ad\u5143\u3068\u4e0d\u4e00\u81f4\u306b\u306a\u3063\u3066\u3044\u308b\u53ef\u80fd\u6027\u306e\u3042\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u524a\u9664");let e=Xe.instance.getObjects(Lt);for(let g of e)g.setLocation("graveyard"),this.deleteGameObject(g);let i=Xe.instance.getObjects(or);for(let g of i)g.setLocation("graveyard"),this.deleteGameObject(g);let r=Xe.instance.getObjects(Qo);for(let g of r)g.setLocation("graveyard"),this.deleteGameObject(g);let o=Xe.instance.getObjects(vs);for(let g of o)g.setLocation("graveyard"),this.deleteGameObject(g);let s=Xe.instance.getObjects(So);for(let g of s)g.setLocation("graveyard"),this.deleteGameObject(g);let a=Xe.instance.getObjects(_o);for(let g of a)g.setLocation("graveyard"),this.deleteGameObject(g);Xe.instance.clearDeleteHistory()}deleteGameObject(e){e.destroy(),this.changeDetector.markForCheck()}logCrear(){console.log("\u524a\u9664\u3057\u305f\u8a18\u9332\u3092\u6d88\u53bb"),Xe.instance.clearDeleteHistory()}deleteList(){console.log("\u524a\u9664\u3057\u305f\u8a18\u9332\u3092\u8868\u793a"),Xe.instance.dispGarbageMap()}}return n.\u0275fac=function(e){return new(e||n)(Be(bi),Be($n),Be(pi))},n.\u0275cmp=Qt({type:n,selectors:[["re-connect"]],decls:40,vars:6,consts:[[3,"click"],["style","color: #bbb;",4,"ngIf"],["style","color: #000;",4,"ngIf"],[1,"danger",3,"disabled","click"],[2,"font-size","16px"],["color","red"],[2,"color","#bbb"],[2,"color","#000"]],template:function(e,i){1&e&&(J(0,"div"),we(1," \u203b\u8a66\u9a13\u7684\u6a5f\u80fd\u3067\u3059"),it(2,"br"),J(3,"button",0),Re("click",function(){return i.cancel()}),we(4,"\u30ad\u30e3\u30f3\u30bb\u30eb"),oe(),we(5,"\xa0\xa0\xa0\xa0 "),Ee(6,LJ,2,0,"span",1),Ee(7,zJ,2,0,"span",2),J(8,"button",3),Re("click",function(){return i.reConnect()}),we(9,"\u5207\u65ad\u5b9f\u884c"),oe(),we(10,"\uff1e "),Ee(11,HJ,2,0,"span",1),Ee(12,VJ,2,0,"span",2),J(13,"button",3),Re("click",function(){return i.reConnect2()}),we(14,"\u518d\u63a5\u7d9a\u5b9f\u884c"),oe(),it(15,"hr"),oe(),J(16,"span",4),we(17,"\n\u753b\u50cf\u3084\u97f3\u697d\u306e\u518d\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3092\u884c\u308f\u305a\u9ad8\u901f\u306b\u90e8\u5c4b\u306b\u518d\u63a5\u7d9a\u3057\u307e\u3059\u3002"),it(18,"br"),we(19,"\n\u305f\u3060\u3057\u3001\u78ba\u5b9f\u306b\u6210\u529f\u3059\u308b\u308f\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002"),it(20,"br"),we(21,"\n\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u5834\u5408\u306f\u3001\u5f93\u6765\u3069\u304a\u308a\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u6700\u521d\u304b\u3089\u306e\u63a5\u7d9a\u3092\u8a66\u307f\u3066\u304f\u3060\u3055\u3044\u3002"),it(22,"br"),J(23,"font",5),we(24,"\u6ce8\u610f\uff1a\u4ed6\u306b\u90e8\u5c4b\u30c7\u30fc\u30bf\u306e\u4fdd\u6301\u8005\u304c\u5c45\u306a\u3044\u5834\u5408\u3001\u30c7\u30fc\u30bf\u304c\u7834\u68c4\u3055\u308c\u305f\u4e0a\u306b\u5931\u6557\u3057\u307e\u3059\u3002"),it(25,"br"),we(26,"\n\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u90e8\u5c4b\u30c7\u30fc\u30bf\u306e\u4fdd\u5b58\u3092\u884c\u3063\u3066\u304b\u3089\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),oe(),it(27,"br")(28,"br"),we(29,"\nSTEP1\u30012\u306e\u9806\u3067\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),it(30,"br")(31,"br"),we(32,"\nSTEP1\uff1a\u65e2\u5b58\u306e\u63a5\u7d9a\u3092\u5207\u65ad\u3057\u3001\u540c\u671f\u304c\u53d6\u308c\u306a\u304f\u306a\u3063\u305f\u53ef\u80fd\u6027\u306e\u3042\u308b\u8981\u7d20\u3092\u524a\u9664\u3057\u307e\u3059\u3002"),it(33,"br"),we(34,"\nSTEP2\uff1a\u30eb\u30fc\u30e0\u306b\u518d\u5ea6\u63a5\u7d9a\u3057\u3001\u30c7\u30fc\u30bf\u540c\u671f\u306e\u56de\u5fa9\u3092\u8a66\u307f\u307e\u3059\u3002"),it(35,"br")(36,"br"),we(37,"\nSTEP2\u306f1\u5ea6\u306e\u8a66\u307f\u3067\u6210\u529f\u3057\u306a\u3044\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002"),it(38,"br"),we(39,"\nSTEP2\u3092\u8907\u6570\u56de\u8a66\u307f\u3066\u3082\u5fa9\u5e30\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3057\u3001\u90e8\u5c4b\u306b\u5165\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n"),oe()),2&e&&(j(6),ie("ngIf",i.isDisconnect),j(1),ie("ngIf",!i.isDisconnect),j(1),ie("disabled",i.isDisconnect),j(3),ie("ngIf",!i.isDisconnect),j(1),ie("ngIf",i.isDisconnect),j(1),ie("disabled",!i.isDisconnect))},directives:[Sn],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.room-list[_ngcontent-%COMP%]{font-size:12px;border:0;border-spacing:0;padding:0;width:100%;max-width:100%;white-space:nowrap}.room-list[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:1px .5em;text-align:center}.room-name[_ngcontent-%COMP%]{white-space:normal;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;min-width:50%}.is-small-font[_ngcontent-%COMP%]{font-size:10px}"]}),n})(),Ym=(()=>{class n{constructor(){}createGameCharacter(e){let i=Lt.create("\u65b0\u3057\u3044\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",1,"");return i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z,i}createGameTableMask(e){let i=this.getViewTable();if(!i)return;let r=So.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);return r.location.x=e.x-25,r.location.y=e.y-25,r.posZ=e.z,i.appendChild(r),r}createGameTableScratchMask(e){let i=this.getViewTable();if(!i)return;let r=Do.create("\u30b9\u30af\u30e9\u30c3\u30c1\u30de\u30b9\u30af",10,10,100);return r.location.x=e.x-25,r.location.y=e.y-25,r.posZ=e.z,i.appendChild(r),r}createTerrain(e){let i="./assets/images/tex.jpg",r=St.instance.get(i);r||(r=St.instance.add(i),rn.create(r.identifier).tag="\u5730\u5f62");let o=this.getViewTable();if(!o)return;let s=_o.create("\u5730\u5f62",2,2,2,r.identifier,r.identifier);return s.location.x=e.x-50,s.location.y=e.y-50,s.posZ=e.z,o.appendChild(s),s}createTextNote(e){let i=Qo.create("\u5171\u6709\u30e1\u30e2","\u30c6\u30ad\u30b9\u30c8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",5,4,3);return i.location.x=e.x,i.location.y=e.y,i.posZ=e.z,i}createDiceSymbol(e,i,r,o,s){let a=vs.create(i,r,1,void 0,s),g=null;return a.faces.forEach(w=>{let W=`./assets/images/dice/${o}/${o}[${w}].png`;g=St.instance.get(W),g||(g=St.instance.add(W)),a.imageDataElement.getFirstElementByName(w).value=g.identifier}),a.location.x=e.x-25,a.location.y=e.y-25,a.posZ=e.z,a}createRangeArea(e,i){let r;switch(i){case"LINE":r=or.create("\u5c04\u7a0b\u7bc4\u56f2",1,10,100);break;case"CIRCLE":case"SQUARE":case"DIAMOND":r=or.create("\u5c04\u7a0b\u7bc4\u56f2",6,6,100);break;default:r=or.create("\u5c04\u7a0b\u7bc4\u56f2",5,5,100)}r.location.x=e.x,r.location.y=e.y,r.posZ=e.z,r.type=i;let o=r.commonDataElement.getFirstElementByName("opacity");return console.log("\u5c04\u7a0b\u7bc4\u56f2TEST"+o),o.currentValue=60,r}createTrump(e){let i=wr.create("\u30c8\u30e9\u30f3\u30d7\u5c71\u672d");i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z;let r="./assets/images/trump/z02.gif";if(!St.instance.get(r)){const a=St.instance.add(r);rn.create(a.identifier).tag="\u30c8\u30e9\u30f3\u30d7"}let o=["c","d","h","s"],s=[];for(let a of o)for(let g=1;g<=13;g++)s.push(a+("00"+g).slice(-2));s.push("x01"),s.push("x02");for(let a of s){let g="./assets/images/trump/"+a+".gif";if(!St.instance.get(g)){const W=St.instance.add(g);rn.create(W.identifier).tag="\u30c8\u30e9\u30f3\u30d7"}let w=Jr.create("\u30ab\u30fc\u30c9",g,r);i.putOnBottom(w)}return i}makeDefaultTable(){let e=new da("tableSelecter");e.initialize();let i=new to("gameTable"),r=null,o=Bt.createEmpty("testTableBackgroundImage_image").toContext();o.url="./assets/images/BG_AC6TRPG_grid.png",r=St.instance.add(o),rn.create(r.identifier).tag="\u80cc\u666f",i.name="\u6700\u521d\u306e\u30c6\u30fc\u30d6\u30eb",i.imageIdentifier=r.identifier,i.width=18,i.height=18,i.gridColor="#00000080",i.initialize(),e.viewTableIdentifier=i.identifier}addBuffRound(e,i,r,o){if(e.buffDataElement.children)for(let s of e.buffDataElement.children)return void s.appendChild(st.create(i,o,{type:"numberResource",currentValue:r},i+"_"+e.identifier))}initAprilDiceImage(){let e=null,i=null;i=Bt.createEmpty("1d4_dice[00]").toContext(),i.url="./assets/images/april_dice/1d4_dice[00].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d4_dice[01]").toContext(),i.url="./assets/images/april_dice/1d4_dice[01].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d4_dice[02]").toContext(),i.url="./assets/images/april_dice/1d4_dice[02].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d4_dice[03]").toContext(),i.url="./assets/images/april_dice/1d4_dice[03].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d6_dice[00]").toContext(),i.url="./assets/images/april_dice/1d6_dice[00].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d6_dice[01]").toContext(),i.url="./assets/images/april_dice/1d6_dice[01].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d6_dice[02]").toContext(),i.url="./assets/images/april_dice/1d6_dice[02].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d6_dice[03]").toContext(),i.url="./assets/images/april_dice/1d6_dice[03].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("2d6_dice[00]").toContext(),i.url="./assets/images/april_dice/2d6_dice[00].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("2d6_dice[01]").toContext(),i.url="./assets/images/april_dice/2d6_dice[01].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("2d6_dice[02]").toContext(),i.url="./assets/images/april_dice/2d6_dice[02].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("2d6_dice[03]").toContext(),i.url="./assets/images/april_dice/2d6_dice[03].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d8_dice[00]").toContext(),i.url="./assets/images/april_dice/1d8_dice[00].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d8_dice[01]").toContext(),i.url="./assets/images/april_dice/1d8_dice[01].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d8_dice[02]").toContext(),i.url="./assets/images/april_dice/1d8_dice[02].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d8_dice[03]").toContext(),i.url="./assets/images/april_dice/1d8_dice[03].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d10_dice[00]").toContext(),i.url="./assets/images/april_dice/1d10_dice[00].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d10_dice[01]").toContext(),i.url="./assets/images/april_dice/1d10_dice[01].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d10_dice[02]").toContext(),i.url="./assets/images/april_dice/1d10_dice[02].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d10_dice[03]").toContext(),i.url="./assets/images/april_dice/1d10_dice[03].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d12_dice[00]").toContext(),i.url="./assets/images/april_dice/1d12_dice[00].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d12_dice[01]").toContext(),i.url="./assets/images/april_dice/1d12_dice[01].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d12_dice[02]").toContext(),i.url="./assets/images/april_dice/1d12_dice[02].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d12_dice[03]").toContext(),i.url="./assets/images/april_dice/1d12_dice[03].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d20_dice[00]").toContext(),i.url="./assets/images/april_dice/1d20_dice[00].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d20_dice[01]").toContext(),i.url="./assets/images/april_dice/1d20_dice[01].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d20_dice[02]").toContext(),i.url="./assets/images/april_dice/1d20_dice[02].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d20_dice[03]").toContext(),i.url="./assets/images/april_dice/1d20_dice[03].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d100_dice[00]").toContext(),i.url="./assets/images/april_dice/1d100_dice[00].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d100_dice[01]").toContext(),i.url="./assets/images/april_dice/1d100_dice[01].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d100_dice[02]").toContext(),i.url="./assets/images/april_dice/1d100_dice[02].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("1d100_dice[03]").toContext(),i.url="./assets/images/april_dice/1d100_dice[03].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("april[00]").toContext(),i.url="./assets/images/april/april[00].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Bt.createEmpty("april[01]").toContext(),i.url="./assets/images/april/april[01].png",e=St.instance.add(i),rn.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04"}makeDefaultTabletopObjects(){let e=null,i=null,r=null;e=new Lt("testCharacter_1"),r=Bt.createEmpty("testCharacter_1_image").toContext(),r.url="./assets/images/mon_052.gif",i=St.instance.add(r),e.location.x=275,e.location.y=475,e.initialize(),rn.create(i.identifier).tag="\u30e2\u30f3\u30b9\u30bf\u30fc",e.createTestGameDataElementLineResourceA("PC\u6a5f\u4f53A",1,i.identifier),this.addBuffRound(e,"ACS\u969c\u5bb3","AP\u640d\u5bb310\u3067\u30b9\u30bf\u30c3\u30ac\u30fc",1),e=new Lt("testCharacter_2"),e.location.x=375,e.location.y=375,e.initialize(),e.createTestGameDataElementLineResourceA("PC\u6a5f\u4f53B",1,i.identifier),e=new Lt("testCharacter_3"),r=Bt.createEmpty("testCharacter_3_image").toContext(),r.url="./assets/images/mon_128.gif",i=St.instance.add(r),e.location.x=250,e.location.y=150,e.initialize(),i=St.instance.add(r),rn.create(i.identifier).tag="\u30e2\u30f3\u30b9\u30bf\u30fc",e.createTestGameDataElementLineResourceB("\u624b\u756a\u6301\u3061\u30a8\u30cd\u30df\u30fc",2,i.identifier)}makeDefaultContextMenuActions(e){return[this.getCreateCharacterMenu(e),this.getCreateTableMaskMenu(e),this.getCreateTerrainMenu(e),this.getCreateTextNoteMenu(e),this.getCreateTrumpMenu(e),this.getCreateDiceSymbolMenu(e),this.getCreateRangeMenu(e)]}getCreateCharacterMenu(e){return{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u6210",action:()=>{let i=this.createGameCharacter(e);Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:i.identifier,className:i.aliasName}),$t.play(dt.piecePut)}}}getCreateTableMaskMenu(e){return{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u6210",action:()=>{this.createGameTableMask(e),$t.play(dt.cardPut)}}}getCreateTerrainMenu(e){return{name:"\u5730\u5f62\u3092\u4f5c\u6210",action:()=>{this.createTerrain(e),$t.play(dt.blockPut)}}}getCreateTextNoteMenu(e){return{name:"\u5171\u6709\u30e1\u30e2\u3092\u4f5c\u6210",action:()=>{this.createTextNote(e),$t.play(dt.cardPut)}}}getCreateTrumpMenu(e){return{name:"\u30c8\u30e9\u30f3\u30d7\u306e\u5c71\u672d\u3092\u4f5c\u6210",action:()=>{this.createTrump(e),$t.play(dt.cardPut)}}}getCreateDiceSymbolMenu(e){let i=[{menuName:"D4",diceName:"D4",type:eo.D4,imagePathPrefix:"4_dice"},{menuName:"D6",diceName:"D6",type:eo.D6,imagePathPrefix:"6_dice"},{menuName:"D8",diceName:"D8",type:eo.D8,imagePathPrefix:"8_dice"},{menuName:"D10",diceName:"D10",type:eo.D10,imagePathPrefix:"10_dice"},{menuName:"D10 (00-90)",diceName:"D10",type:eo.D10_10TIMES,imagePathPrefix:"100_dice"},{menuName:"D12",diceName:"D12",type:eo.D12,imagePathPrefix:"12_dice"},{menuName:"D20",diceName:"D20",type:eo.D20,imagePathPrefix:"20_dice"}],r=[];return r.push({name:"EN\u30c0\u30a4\u30b9(AC6)",action:()=>{this.createDiceSymbol(e,"EN",eo.D6,"6_dice",!0),$t.play(dt.diceRoll1)}}),i.forEach(o=>{r.push({name:o.menuName,action:()=>{this.createDiceSymbol(e,o.diceName,o.type,o.imagePathPrefix),$t.play(dt.dicePut)}})}),{name:"\u30c0\u30a4\u30b9\u3092\u4f5c\u6210",action:null,subActions:r}}getCreateRangeMenu(e){let r=[];return[{menuName:"\u30b3\u30fc\u30f3",typeName:"CORN"},{menuName:"\u76f4\u7dda",typeName:"LINE"},{menuName:"\u5186",typeName:"CIRCLE"},{menuName:"\u6b63\u65b9\u5f62",typeName:"SQUARE"},{menuName:"\u30c0\u30a4\u30e4",typeName:"DIAMOND"}].forEach(o=>{r.push({name:o.menuName,action:()=>{this.createRangeArea(e,o.typeName),$t.play(dt.dicePut)}})}),{name:"\u5c04\u7a0b\u7bc4\u56f2\u3092\u4f5c\u6210",action:null,subActions:r}}getViewTable(){return da.instance.viewTable}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function jJ(n,t){if(1&n){const e=pt();J(0,"div")(1,"button",11),Re("click",function(){return Le(e),$e().changeIcon()}),we(2,"\u30a2\u30a4\u30b3\u30f3\u3092\u5909\u66f4\u3059\u308b"),oe()()}}function GJ(n,t){if(1&n){const e=pt();J(0,"div",13),Re("click",function(){return Le(e),$e(2).changeIcon()}),At(1,"safe"),oe()}2&n&&un("background-image",Ft(1,2,"url("+$e(2).myPeer.image.url+")","style"))}function qJ(n,t){if(1&n&&(Je(0),Ee(1,GJ,2,5,"div",12),et()),2&n){const e=$e();j(1),ie("ngIf",e.myPeer.image)}}function WJ(n,t){1&n&&(J(0,"span"),we(1,"\u3042\u306a\u305f\u306e\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\uff1a"),oe())}function ZJ(n,t){if(1&n&&(J(0,"span",14),we(1),oe()),2&n){const e=$e();j(1),xt(e.networkService.peerContext.userId)}}function YJ(n,t){1&n&&(J(0,"span",14),we(1,"???"),oe())}function KJ(n,t){if(1&n&&(J(0,"span",14),we(1),oe()),2&n){const e=$e(2);j(1),Os("",e.networkService.peerContext.roomName,"/",e.networkService.peerContext.roomId,"")}}function XJ(n,t){if(1&n&&(J(0,"span",14),we(1),oe()),2&n){const e=$e(3);j(1),xt(e.isPasswordVisible?e.networkService.peerContext.password:"\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf")}}function QJ(n,t){if(1&n){const e=pt();J(0,"span"),Ee(1,XJ,2,1,"span",5),J(2,"button",15),Re("click",function(){return Le(e),$e(2).togglePasswordVisibility()}),J(3,"span",16),we(4),oe()()()}if(2&n){const e=$e(2);j(1),ie("ngIf",e.networkService.isOpen),j(3),xt(e.isPasswordVisible?"visibility":"visibility_off")}}function JJ(n,t){if(1&n){const e=pt();Je(0),J(1,"button",17),Re("click",function(){return Le(e),$e(2).showReConnect()}),J(2,"span"),we(3,"\u518d\u63a5\u7d9a"),oe()(),et()}}function eee(n,t){if(1&n&&(Je(0),it(1,"hr"),J(2,"div")(3,"span"),we(4,"\u30eb\u30fc\u30e0\u540d\uff1a"),Ee(5,KJ,2,2,"span",5),oe()(),J(6,"div")(7,"span"),we(8,"\u30d1\u30b9\u30ef\u30fc\u30c9\uff1a"),Ee(9,QJ,5,2,"span",0),oe()(),J(10,"div"),Ee(11,JJ,4,0,"ng-container",0),oe(),et()),2&n){const e=$e();j(5),ie("ngIf",e.networkService.isOpen),j(4),ie("ngIf",e.networkService.peerContext.hasPassword),j(2),ie("ngIf",e.networkService.peerIds.length>1)}}function tee(n,t){1&n&&(J(0,"span"),we(1,"[\u63a5\u7d9a\u4e2d]"),oe())}function nee(n,t){1&n&&(J(0,"span"),we(1,"\u63a5\u7d9a\u78ba\u8a8d\uff1a[-:--:--]"),oe())}function iee(n,t){if(1&n&&(J(0,"span"),we(1),At(2,"date"),oe()),2&n){const e=$e().$implicit,i=$e();j(1),sn("\u63a5\u7d9a\u78ba\u8a8d\uff1a[",Ft(2,1,i.findPeerTimeReceive(e.peerId),"HH:mm:ss"),"]")}}function ree(n,t){if(1&n&&(J(0,"span"),we(1),oe()),2&n){const e=$e(2).$implicit,i=$e();j(1),sn("\u5f80\u5fa9\u901a\u4fe1\u6642\u9593\uff1a",i.findPeerTimeLatency(e.peerId),"\u79d2")}}function oee(n,t){if(1&n&&(J(0,"div"),Ee(1,ree,2,1,"span",0),it(2,"br"),oe()),2&n){const e=$e().$implicit,i=$e();j(1),ie("ngIf",i.findPeerTimeReceive(e.peerId)>0)}}function see(n,t){if(1&n&&(J(0,"div")(1,"span"),we(2),oe(),it(3,"br"),J(4,"span"),we(5),oe(),it(6,"br"),oe()),2&n){const e=$e().$implicit,i=$e();j(2),Os("\u4f1d\u9001\u6642\u9593+\u6642\u8a08\u8aa4\u5dee\u5408\u8a08\u3000\u53d7\u4fe1\uff1a",i.findPeerTimeDiffDown(e.peerId),"ms \u9001\u4fe1\uff1a",i.findPeerTimeDiffUp(e.peerId),"ms"),j(3),sn("\u76f8\u624b\u306e\u751f\u5b58\u4fe1\u53f7\u5230\u7740\u5272\u5408\uff1a",i.findPeerDegreeOfSuccess(e.peerId),"")}}function aee(n,t){if(1&n&&(J(0,"div",18)(1,"div"),Ee(2,tee,2,0,"span",0),J(3,"span"),we(4),oe(),Ee(5,nee,2,0,"span",0),Ee(6,iee,3,4,"span",0),it(7,"br"),Ee(8,oee,3,1,"div",0),Ee(9,see,7,3,"div",0),oe()()),2&n){const e=t.$implicit,i=$e();j(2),ie("ngIf",!e.isOpen),j(2),Os("\u4ed6\u306e\u53c2\u52a0\u8005\uff1a",i.findUserId(e.peerId)," [",i.findPeerName(e.peerId),"] "),j(1),ie("ngIf",i.findPeerTimeReceive(e.peerId)<=0),j(1),ie("ngIf",i.findPeerTimeReceive(e.peerId)>0),j(2),ie("ngIf",i.dispDetailFlag),j(1),ie("ngIf","\u5186\u67f1_"==i.myPeer.name)}}function lee(n,t){if(1&n){const e=pt();Je(0),J(1,"input",19),Re("ngModelChange",function(r){return Le(e),$e().targetUserId=r}),oe(),J(2,"button",20),Re("click",function(){return Le(e),$e().connectPeer()}),we(3,"\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a"),oe(),it(4,"br"),et()}if(2&n){const e=$e();j(1),ie("ngModel",e.targetUserId),j(1),ie("disabled",!e.networkService.isOpen)}}function cee(n,t){if(1&n){const e=pt();J(0,"button",20),Re("click",function(){return Le(e),$e().showLobby()}),we(1,"\u30ed\u30d3\u30fc\uff08\u30eb\u30fc\u30e0\u4e00\u89a7\uff09\u3092\u8868\u793a"),oe()}2&n&&ie("disabled",!$e().networkService.isOpen)}function uee(n,t){1&n&&(J(0,"div",10),we(1,"\u203b\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306f\u3001\u304a\u4e92\u3044\u306eID\u3092\u30e6\u30c9\u30ca\u30ea\u30a6\u30e0\u5916\u3067\u5171\u6709\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),oe())}function dee(n,t){1&n&&(J(0,"div",10),we(1,"\u203b\u4e00\u4eba\u3067\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u306f\u30d6\u30e9\u30a6\u30b6\u30922\u3064\u958b\u304f\u3068\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002"),oe())}function fee(n,t){if(1&n&&(Je(0),Ee(1,uee,2,0,"div",21),Ee(2,dee,2,0,"div",21),et()),2&n){const e=$e();j(1),ie("ngIf",e.networkService.peerContexts.length<1),j(1),ie("ngIf",e.networkService.peerContexts.length<1)}}function hee(n,t){1&n&&(Je(0),J(1,"div",10),we(2,"\u203b\u30eb\u30fc\u30e0\u6a5f\u80fd\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u6642\u306f\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002"),oe(),J(3,"div",10)(4,"font",22),we(5,"\u203b\u63a5\u7d9a\u60c5\u5831\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u51fa\u3059\u30bf\u30d6\u306e\u5909\u66f4\u306f"),it(6,"br"),we(7,"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u306e\u30bf\u30d6\u8a2d\u5b9a\u304b\u3089\u884c\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),oe()(),et())}let UP=(()=>{class n{constructor(e,i,r,o,s,a){this.tabletopActionService=e,this.changeDetector=i,this.ngZone=r,this.modalService=o,this.panelService=s,this.appConfigService=a,this.targetUserId="",this.networkService=bt,this.gameRoomService=Xe.instance,this.help="",this.isPasswordVisible=!1,this.disptimer=null,this.dispDetailFlag=!1,this.myTime=0}get myPeer(){return _t.myCursor}get tableSelecter(){return da.instance}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u63a5\u7d9a\u60c5\u5831")}ngAfterViewInit(){Qe.register(this).on("OPEN_NETWORK",e=>{this.ngZone.run(()=>{})}),this.disptimer=setInterval(()=>{this.dispInfo()},1e3)}ngOnDestroy(){Qe.unregister(this),this.disptimer=null}changeIcon(){this.modalService.open(Hf).then(e=>{!this.myPeer||!e||(this.myPeer.imageIdentifier=e)})}connectPeer(){let e=this.targetUserId;if(this.targetUserId="",e.length<1)return;this.help="";let i=zi.create(e);i.isRoom||(Xe.instance.clearDeleteHistory(),bt.connect(i.peerId))}showLobby(){this.modalService.open(BJ,{width:700,height:400,left:0,top:400})}showReConnect(){this.modalService.open(UJ,{width:700,height:400,left:0,top:400})}togglePasswordVisibility(){this.isPasswordVisible=!this.isPasswordVisible}findUserId(e){const i=_t.findByPeerId(e);return i?i.userId:""}findPeerName(e){const i=_t.findByPeerId(e);return i?i.name:""}findPeerTimeSend(e){const i=_t.findByPeerId(e);return i?i.timestampSend:0}findPeerTimeReceive(e){const i=_t.findByPeerId(e);return i?i.timestampReceive:0}findPeerTimeDiffUp(e){const i=_t.findByPeerId(e);return i?i.timeDiffUp:0}findPeerTimeDiffDown(e){const i=_t.findByPeerId(e);return i?i.timeDiffDown:0}findPeerTimeLatency(e){const i=_t.findByPeerId(e);return i?i?i.timeLatency/1e3:99999:"--"}findPeerDegreeOfSuccess(e){const i=_t.findByPeerId(e);return!i||i.firstTimeSignNo<0?"0/0":i.totalTimeSignNum+"/"+(i.lastTimeSignNo-i.firstTimeSignNo+1)}checkConnect(){console.log("\u81ea\u8eab\u306eUserid:"+this.networkService.peerContext.userId);for(let e of this.networkService.peerContexts)console.log("\u63a5\u7d9a\u5bfe\u8c61ID:"+e.peerId)}dispInfo(){this.myTime=Date.now()}}return n.\u0275fac=function(e){return new(e||n)(Be(Ym),Be(bi),Be(An),Be(pi),Be($n),Be(Mw))},n.\u0275cmp=Qt({type:n,selectors:[["peer-menu"]],decls:39,vars:19,consts:[[4,"ngIf"],[1,"user"],[1,"user_icon"],[1,"user_info"],["placeholder","\u30cb\u30c3\u30af\u30cd\u30fc\u30e0",1,"is-caret",3,"ngModel","ngModelChange"],["style","font-weight: bold;",4,"ngIf"],["type","number","min","1","max","600",1,"is-caret",3,"ngModel","ngModelChange"],["type","checkbox","value","dispDetailFlag",3,"ngModel","ngModelChange"],["style","font-size: 15px;",4,"ngFor","ngForOf"],[3,"disabled","click",4,"ngIf"],[2,"font-size","12px"],[3,"click"],["class","image cover",3,"background-image","click",4,"ngIf"],[1,"image","cover",3,"click"],[2,"font-weight","bold"],[2,"padding","2px","margin-left","1.0em","font-size","1.0em",3,"click"],[1,"material-icons",2,"font-size","1.0em","vertical-align","text-bottom"],[1,"danger",3,"click"],[2,"font-size","15px"],["placeholder","\u63a5\u7d9a\u3057\u305f\u3044\u76f8\u624b\u306eID","name","targetUserId",1,"is-caret",3,"ngModel","ngModelChange"],[3,"disabled","click"],["style","font-size: 12px;",4,"ngIf"],["color","#FF5555"]],template:function(e,i){1&e&&(Ee(0,jJ,3,0,"div",0),J(1,"div",1)(2,"div",2),Ee(3,qJ,2,1,"ng-container",0),oe(),J(4,"div",3),Ee(5,WJ,2,0,"span",0),J(6,"input",4),Re("ngModelChange",function(o){return i.myPeer.name=o}),oe(),it(7,"br"),J(8,"span"),we(9,"ID\uff1a"),oe(),Ee(10,ZJ,2,1,"span",5),Ee(11,YJ,2,0,"span",5),it(12,"br"),J(13,"div")(14,"span"),we(15,"\u30d6\u30e9\u30a6\u30b6\u6642\u523b\uff1a"),oe(),J(16,"span"),we(17),At(18,"date"),oe()()()(),Ee(19,eee,12,3,"ng-container",0),it(20,"hr"),J(21,"div")(22,"span")(23,"input",6),Re("ngModelChange",function(o){return i.myPeer.timeout=o}),oe(),we(24," \u79d2\u4ee5\u4e0a\u901a\u4fe1\u3067\u304d\u306a\u3044\u53c2\u52a0\u8005\u60c5\u5831\u3092\u30c1\u30e3\u30c3\u30c8\u306b\u8868\u793a"),oe(),it(25,"br"),J(26,"span"),we(27,"\u8a73\u7d30\u3092\u8868\u793a"),J(28,"input",7),Re("ngModelChange",function(o){return i.dispDetailFlag=o}),oe()(),it(29,"br"),oe(),Ee(30,aee,10,7,"div",8),J(31,"div"),Ee(32,lee,5,2,"ng-container",0),Ee(33,cee,2,1,"button",9),oe(),J(34,"div")(35,"span",10),we(36),oe()(),Ee(37,fee,3,2,"ng-container",0),Ee(38,hee,8,0,"ng-container",0)),2&e&&(ie("ngIf",i.myPeer),j(3),ie("ngIf",i.myPeer),j(2),ie("ngIf",i.myPeer),j(1),ie("ngModel",i.myPeer.name),j(4),ie("ngIf",i.networkService.isOpen),j(1),ie("ngIf",!i.networkService.isOpen),j(6),xt(Ft(18,16,i.myTime,"yy/MM/dd HH:mm:ss")),j(2),ie("ngIf",i.networkService.peerContext.isRoom),j(4),ie("ngModel",i.myPeer.timeout),j(5),ie("ngModel",i.dispDetailFlag),j(2),ie("ngForOf",i.networkService.peerContexts),j(2),ie("ngIf",!i.networkService.peerContext.isRoom),j(1),ie("ngIf",i.networkService.peerIds.length<=1),j(3),xt(i.help),j(1),ie("ngIf",!i.networkService.peerContext.isRoom),j(1),ie("ngIf",i.networkService.peerContext.isRoom))},directives:[Sn,Fi,Ti,yi,Vc,Ju,ms,ra,si],pipes:[Ii,D2],styles:[".user[_ngcontent-%COMP%]{display:table}.user_icon[_ngcontent-%COMP%]{display:table-cell;vertical-align:top;width:160px}.user_info[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom}.image[_ngcontent-%COMP%]{padding:0;width:128px;height:128px;display:table-cell;vertical-align:top}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto;height:auto;max-width:100%;max-height:100%;vertical-align:bottom}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();class fa{constructor(t,e={capture:!1,passive:!1,always:!1}){this.target=t,this.callbackOnMouse=this.onMouse.bind(this),this.callbackOnTouch=this.onTouch.bind(this),this.callbackOnMenu=this.onMenu.bind(this),this.lastPointers=[],this.primaryPointer={x:0,y:0,z:0,identifier:-9999},this._isDragging=!1,this._isGrabbing=!1,this._isDestroyed=!1,this.option=null,this.option={capture:!0===e.capture,passive:!0===e.passive,always:!0===e.always},this.initialize()}get pointer(){return this.primaryPointer}get isDragging(){return this._isDragging}get isGrabbing(){return this._isGrabbing}get isDestroyed(){return this._isDestroyed}initialize(){this.target.addEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.addEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.option.always&&this.addEventListeners()}destroy(){this.cancel(),this._isDestroyed=!0,this.target.removeEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.removeEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.removeEventListeners()}cancel(){this._isDragging=this._isGrabbing=!1,this.option.always||this.removeEventListeners()}onMouse(t){let e={x:t.pageX,y:t.pageY,z:0,identifier:-9999};this.isSyntheticEvent(e)||(this.lastPointers=[e],this.primaryPointer=e,this.onPointer(t))}onTouch(t){let e=t.changedTouches.length;if(!(e<1)){this.lastPointers=[];for(let i=0;i<e;i++){let r=t.changedTouches[i];this.lastPointers.push({x:r.pageX,y:r.pageY,z:0,identifier:r.identifier})}if("touchstart"===t.type)this.primaryPointer=this.lastPointers[0];else{let r=Array.from(t.changedTouches).find(s=>s.identifier===this.primaryPointer.identifier);if(null==r)return void(null!=Array.from(t.touches).find(a=>a.identifier===this.primaryPointer.identifier)||(this.onEnd&&this.onEnd(t),this.cancel()));this.primaryPointer={x:r.pageX,y:r.pageY,z:0,identifier:r.identifier}}this.onPointer(t)}}onPointer(t){switch(t.type){case"mousedown":case"touchstart":this._isGrabbing=!0,this._isDragging=!1,this.addEventListeners(),this.onStart&&this.onStart(t);break;case"mousemove":case"touchmove":this.onMove&&this.onMove(t),this._isDragging=this._isGrabbing;break;default:this.onEnd&&this.onEnd(t),this.cancel()}}onMenu(t){this.onContextMenu&&this.onContextMenu(t)}isSyntheticEvent(t,e=15){for(let i of this.lastPointers)if(i.identifier!==t.identifier&&(t.x-i.x)**2+(t.y-i.y)**2<e**2)return!0;return!1}addEventListeners(){let t={capture:this.option.capture,passive:this.option.passive};this.target.ownerDocument.addEventListener("mousemove",this.callbackOnMouse,t),this.target.ownerDocument.addEventListener("mouseup",this.callbackOnMouse,t),this.target.ownerDocument.addEventListener("touchmove",this.callbackOnTouch,t),this.target.ownerDocument.addEventListener("touchend",this.callbackOnTouch,t),this.target.ownerDocument.addEventListener("touchcancel",this.callbackOnTouch,t),this.target.ownerDocument.addEventListener("contextmenu",this.callbackOnMenu,t),this.target.ownerDocument.addEventListener("drop",this.callbackOnMouse,t)}removeEventListeners(){let t={capture:this.option.capture};this.target.ownerDocument.removeEventListener("mousemove",this.callbackOnMouse,t),this.target.ownerDocument.removeEventListener("mouseup",this.callbackOnMouse,t),this.target.ownerDocument.removeEventListener("touchmove",this.callbackOnTouch,t),this.target.ownerDocument.removeEventListener("touchend",this.callbackOnTouch,t),this.target.ownerDocument.removeEventListener("touchcancel",this.callbackOnTouch,t),this.target.ownerDocument.removeEventListener("contextmenu",this.callbackOnMenu,t),this.target.ownerDocument.removeEventListener("drop",this.callbackOnMouse,t)}}let GP=(()=>{class n{constructor(e,i){this.ngZone=e,this.elementRef=i,this.isDisable=!1,this.boundsSelector="body",this.handleSelector="",this.unhandleSelector="input,textarea,button,select,option,span",this.stackSelector="",this.opacity=.7,this.allowOverHalf=!1,this.onstart=new Xt,this.onmove=new Xt,this.onend=new Xt,this.callbackOnResize=this.adjustPosition.bind(this),this.input=null,this.startPosition={x:0,y:0,z:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={x:0,y:0,z:0}}ngAfterViewInit(){this.initialize(),this.adjustPosition(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.input=new fa(this.elementRef.nativeElement),window.addEventListener("resize",this.callbackOnResize,!1)}),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this)}cancel(){this.input.cancel()}destroy(){window.removeEventListener("resize",this.callbackOnResize,!1),this.input.destroy()}onInputStart(e){if(1===e.button||2===e.button)return this.cancel();this.setForeground(),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=this.input.pointer,this.prevTrans={x:0,y:0,z:0};let i=this.isHandleElement(e.target),r=this.isUnhandleElement(e.target),o=null!=e.touches&&this.isScrollableElement(e.target);!i||r||o?this.cancel():e.stopPropagation()}onInputMove(e){let i={x:this.input.pointer.x-this.startPointer.x,y:this.input.pointer.y-this.startPointer.y,z:this.input.pointer.z-this.startPointer.z},o=this.calcCorrectionPosition({x:i.x-this.prevTrans.x,y:i.y-this.prevTrans.y,z:i.z-this.prevTrans.z});i.x+=o.x,i.y+=o.y,i.z+=o.z,0<i.x**2+i.y**2+i.z**2&&(this.elementRef.nativeElement.style.opacity=this.opacity+""),this.elementRef.nativeElement.style.willChange="top, left",this.elementRef.nativeElement.style.left=i.x+this.startPosition.x+"px",this.elementRef.nativeElement.style.top=i.y+this.startPosition.y+"px",this.prevTrans=i,e.cancelable&&e.preventDefault(),e.stopPropagation()}onInputEnd(e){this.elementRef.nativeElement.style.opacity=null,this.elementRef.nativeElement.style.willChange=null,this.input.isDragging&&e.cancelable&&(this.preventClickIfNeeded(e),e.preventDefault()),e.stopPropagation()}onContextMenu(e){e.stopPropagation()}preventClickIfNeeded(e){if(null!=e.touches)return;if(225>(this.input.pointer.x-this.startPointer.x)**2+(this.input.pointer.y-this.startPointer.y)**2+(this.input.pointer.z-this.startPointer.z)**2)return;let a=g=>{g.cancelable&&g.preventDefault(),g.stopPropagation()};this.elementRef.nativeElement.addEventListener("click",a,!0),setTimeout(()=>this.elementRef.nativeElement.removeEventListener("click",a,!0))}adjustPosition(){let e=this.calcElementPosition(this.elementRef.nativeElement),i=this.calcCorrectionPosition();console.log("current x "+e.x+"  y"+e.y),console.log("correction x "+i.x+"  y"+i.y),this.elementRef.nativeElement.style.left=i.x+e.x+"px",this.elementRef.nativeElement.style.top=i.y+e.y+"px"}isHandleElement(e){return this.handleSelector.length<1||this.isContainsElement(e,this.handleSelector)}isUnhandleElement(e){return!(this.unhandleSelector.length<1)&&this.isContainsElement(e,this.unhandleSelector)}isContainsElement(e,i){let r=this.elementRef.nativeElement.querySelectorAll(i);for(let o=0;o<r.length;o++)if(r[o].contains(e))return!0;return!1}isScrollableElement(e){let i=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector),r=e,o=["scroll","auto"],s=["fixed","sticky","-webkit-sticky"];for(;r&&i!==r&&this.elementRef.nativeElement!==r;){let a=window.getComputedStyle(r);if(0<=o.indexOf(a.overflowY)&&r.offsetHeight<r.scrollHeight)return!0;if(0<=s.indexOf(a.position))return!1;r=r.parentElement}return!1}calcCorrectionPosition(e={x:0,y:0,z:0}){let i={x:0,y:0,z:0},r=this.elementRef.nativeElement.getBoundingClientRect(),o=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();if(this.allowOverHalf){const s=r.right-r.left,a=r.bottom-r.top;o.right+s/2<r.right+e.x&&(i.x+=o.right+s/2-(r.right+e.x)),r.left+e.x<o.left-s/2&&(i.x+=o.left-s/2-(r.left+e.x)),o.bottom+a/2<r.bottom+e.y&&(i.y+=o.bottom+a/2-(r.bottom+e.y)),r.top+e.y<o.top-a/2&&(i.y+=o.top-a/2-(r.top+e.y))}else o.right<r.right+e.x&&(i.x+=o.right-(r.right+e.x)),r.left+e.x<o.left&&(i.x+=o.left-(r.left+e.x)),o.bottom<r.bottom+e.y&&(i.y+=o.bottom-(r.bottom+e.y)),r.top+e.y<o.top&&(i.y+=o.top-(r.top+e.y));return i}calcElementPosition(e){let i=window.getComputedStyle(e);return{x:Er.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),y:Er.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),z:0}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(o=>{let s=parseInt(o.style.zIndex);i<s&&(i=s),s<r&&(r=s)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(o=>{o.style.zIndex=parseInt(o.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(fi))},n.\u0275dir=nn({type:n,selectors:[["","appDraggable",""]],inputs:{isDisable:["draggable.disable","isDisable"],boundsSelector:["draggable.bounds","boundsSelector"],handleSelector:["draggable.handle","handleSelector"],unhandleSelector:["draggable.unhandle","unhandleSelector"],stackSelector:["draggable.stack","stackSelector"],opacity:["draggable.opacity","opacity"],allowOverHalf:["draggable.allowOverHalf","allowOverHalf"]},outputs:{onstart:"draggable.start",onmove:"draggable.move",onend:"draggable.end"}}),n})();var ki=(()=>(function(n){n.N="n",n.E="e",n.W="w",n.S="s",n.NE="ne",n.NW="nw",n.SE="se",n.SW="sw"}(ki||(ki={})),ki))();class pee{constructor(t,e){this.target=t,this.type=e,this.input=null,this.handle=null,this.width=12,this.initialize()}initialize(){this.handle=this.target.ownerDocument.createElement("div"),this.handle.classList.add("ui-resize-handler-"+this.type),this.input=new fa(this.handle),this.target.appendChild(this.handle);let t=this.handle.style;switch(t.position="absolute",t.zIndex="1",t.backgroundColor="transparent",this.type){case ki.N:t.top=3*-this.width/4+"px",t.left="0px",t.right="0px",t.height=`${this.width}px`,t.cursor="ns-resize";break;case ki.E:t.top="0px",t.bottom="0px",t.right=3*-this.width/4+"px",t.width=`${this.width}px`,t.cursor="ew-resize";break;case ki.W:t.top="0px",t.bottom="0px",t.left=3*-this.width/4+"px",t.width=`${this.width}px`,t.cursor="ew-resize";break;case ki.S:t.bottom=3*-this.width/4+"px",t.left="0px",t.right="0px",t.height=`${this.width}px`,t.cursor="ns-resize";break;case ki.NE:t.top=3*-this.width/4+"px",t.right=3*-this.width/4+"px",t.width=3*this.width/2+"px",t.height=3*this.width/2+"px",t.cursor="nesw-resize",t.zIndex="2";break;case ki.NW:t.top=3*-this.width/4+"px",t.left=3*-this.width/4+"px",t.width=3*this.width/2+"px",t.height=3*this.width/2+"px",t.cursor="nwse-resize",t.zIndex="2";break;case ki.SE:t.bottom=3*-this.width/4+"px",t.right=3*-this.width/4+"px",t.width=3*this.width/2+"px",t.height=3*this.width/2+"px",t.cursor="nwse-resize",t.zIndex="2";break;case ki.SW:t.bottom=3*-this.width/4+"px",t.left=3*-this.width/4+"px",t.width=3*this.width/2+"px",t.height=3*this.width/2+"px",t.cursor="nesw-resize",t.zIndex="2"}}destroy(){this.handle.remove(),this.input.destroy()}}let gee=(()=>{class n{constructor(e,i){this.ngZone=e,this.elementRef=i,this.isDisable=!1,this.boundsSelector="body",this.stackSelector="",this.minWidth=100,this.minHeight=100,this.ostart=new Xt,this.onmove=new Xt,this.onend=new Xt,this.handleMap=new Map,this.handleTypes=[ki.N,ki.E,ki.W,ki.S,ki.NE,ki.NW,ki.SE,ki.SW],this.startPosition={left:0,top:0,width:0,height:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={left:0,top:0,width:0,height:0}}ngAfterViewInit(){this.initialize(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.handleTypes.forEach(e=>{let i=new pee(this.elementRef.nativeElement,e);this.handleMap.set(e,i),i.input.onStart=r=>this.onResizeStart(r,i),i.input.onMove=r=>this.onResizeMove(r,i),i.input.onEnd=r=>this.onResizeEnd(r,i),i.input.onContextMenu=r=>this.onContextMenu(r,i)})})}cancel(){this.handleMap.forEach(e=>e.input.cancel())}destroy(){this.handleMap.forEach(e=>e.input.destroy())}onResizeStart(e,i){return this.isDisable||1===e.button||2===e.button?this.cancel():(this.setForeground(),this.handleMap.forEach(r=>{r!==i&&r.input.cancel()}),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=i.input.pointer,this.prevTrans={left:0,top:0,width:0,height:0},void e.stopPropagation())}onResizeMove(e,i){let r={left:0,top:0,width:i.input.pointer.x-this.startPointer.x,height:i.input.pointer.y-this.startPointer.y};switch(i.type){case ki.N:case ki.S:r.width=0;break;case ki.E:case ki.W:r.height=0}switch(i.type){case ki.SW:r.left=r.width,r.width*=-1;break;case ki.NE:r.top=r.height,r.height*=-1;break;case ki.E:case ki.S:case ki.SE:break;case ki.N:case ki.W:case ki.NW:r.left=r.width,r.top=r.height,r.width*=-1,r.height*=-1}r.width+this.startPosition.width<this.minWidth&&(r.width=this.minWidth-this.startPosition.width,r.left=0!==r.left?-r.width:r.left),r.height+this.startPosition.height<this.minHeight&&(r.height=this.minHeight-this.startPosition.height,r.top=0!==r.top?-r.height:r.top);let s=this.calcCorrectionPosition({left:r.left-this.prevTrans.left,top:r.top-this.prevTrans.top,width:r.width-this.prevTrans.width,height:r.height-this.prevTrans.height});r.left+=s.left,r.top+=s.top,r.width+=s.width,r.height+=s.height,this.elementRef.nativeElement.style.left=r.left+this.startPosition.left+"px",this.elementRef.nativeElement.style.top=r.top+this.startPosition.top+"px",this.elementRef.nativeElement.style.width=r.width+this.startPosition.width+"px",this.elementRef.nativeElement.style.height=r.height+this.startPosition.height+"px",this.prevTrans=r,e.cancelable&&e.preventDefault(),e.stopPropagation()}onResizeEnd(e,i){i.input.isDragging&&e.cancelable&&e.preventDefault(),e.stopPropagation()}onContextMenu(e,i){e.stopPropagation()}calcCorrectionPosition(e={left:0,top:0,width:0,height:0}){let i={left:0,top:0,width:0,height:0},r=this.elementRef.nativeElement.getBoundingClientRect(),o=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();return o.right<r.right+e.left+e.width&&(i.width+=o.right-(r.right+e.left+e.width)),r.left+e.left<o.left&&(i.left+=o.left-(r.left+e.left),i.width-=i.left),o.bottom<r.bottom+e.top+e.height&&(i.height+=o.bottom-(r.bottom+e.top+e.height)),r.top+e.top<o.top&&(i.top+=o.top-(r.top+e.top),i.height-=i.top),i}calcElementPosition(e){let i=window.getComputedStyle(e);return{left:Er.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),top:Er.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),width:Er.relation(i.width,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),height:Er.relation(i.height,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight)}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(o=>{let s=parseInt(o.style.zIndex);i<s&&(i=s),s<r&&(r=s)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(o=>{o.style.zIndex=parseInt(o.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(fi))},n.\u0275dir=nn({type:n,selectors:[["","appResizable",""]],inputs:{isDisable:["resizable.disable","isDisable"],boundsSelector:["resizable.bounds","boundsSelector"],stackSelector:["resizable.stack","stackSelector"],minWidth:["resizable.minWidth","minWidth"],minHeight:["resizable.minHeight","minHeight"]},outputs:{ostart:"resizable.start",onmove:"resizable.move",onend:"resizable.end"}}),n})();const _ee=["draggablePanel"],mee=["scrollablePanel"],$ee=["titleBar"],vee=["content"];function bee(n,t){if(1&n){const e=pt();J(0,"div",10)(1,"button",11),Re("click",function(){return Le(e),$e().toggleMinimize()}),J(2,"i",12),we(3,"minimize"),oe()(),J(4,"button",11),Re("click",function(){return Le(e),$e().toggleFullScreen()}),J(5,"i",12),we(6,"fullscreen"),oe()(),J(7,"button",13),Re("click",function(){return Le(e),$e().close()}),J(8,"i",12),we(9,"close"),oe()()()}if(2&n){const e=$e();j(1),ie("disabled",e.isFullScreen),j(3),ie("disabled",e.isMinimized)}}function yee(n,t){if(1&n&&(Je(0),it(1,"chat-tachie-img",14),et()),2&n){const e=$e();j(1),ie("chatTabidentifier",e.panelService.chatTab.identifier)("isTilteTop",1)("dispByMouse",e.tachieDispByMouse)}}function Cee(n,t){if(1&n&&(Je(0),it(1,"card-stack-list-img",15),et()),2&n){const e=$e();j(1),ie("cardStackidentifier",e.panelService.cardStack.identifier)}}const xee=function(n){return{"pointer-events-none":n}},wee=function(n){return{padding:n}},Eee=["*"];let qP=(()=>{class n{constructor(e,i){this.panelService=e,this.pointerDeviceService=i,this.showTitleButtons=!0,this.preLeft=0,this.preTop=0,this.preWidth=100,this.preHeight=100,this.isFullScreen=!1,this.isMinimized=!1,this.tachieDispByMouse=!0,this.timerCheckWindowSize=null}set title(e){this.panelService.title=e}set left(e){this.panelService.left=e}set top(e){this.panelService.top=e}set width(e){this.panelService.width=e}set height(e){this.panelService.height=e}get title(){return this.panelService.title}get left(){return this.panelService.left}get top(){return this.panelService.top}get width(){return this.panelService.width}get height(){return this.panelService.height}get isPointerDragging(){return this.pointerDeviceService.isDragging}showTachie(e){this.tachieDispByMouse=e}ngOnInit(){this.panelService.scrollablePanel=this.scrollablePanel.nativeElement,this.timerCheckWindowSize=setInterval(()=>{this.chkeWindowMinSize()},500)}chkeWindowMinSize(){const e=this.panelService.cutInIdentifier;if(!e)return;const i=Xe.instance.get(e);if(!i||!i.videoId)return;let r=this.draggablePanel.nativeElement;console.log("chkeWindowMinSize:"+r.style.width+" H:"+r.style.height);const o=parseInt(r.style.width),s=parseInt(r.style.height);o<i.minSizeWidth(!0)&&(r.style.width=i.minSizeWidth(!0)+"px",console.log("\u30b5\u30a4\u30ba\u88dc\u6b63W")),s<i.minSizeHeight(!0)&&(r.style.height=i.minSizeHeight(!0)+"px",console.log("\u30b5\u30a4\u30ba\u88dc\u6b63H"));const a=window.innerWidth,g=window.innerHeight,w=r.offsetLeft,W=r.offsetTop,ve=w+i.minSizeWidth(!0)-a;ve>=0&&(r.style.left=(w-ve<=0?0:w-ve)+"px",console.log("\u306f\u307f\u51fa\u3057\u9632\u6b62\u51e6\u7406\u6a2a"));const me=W+i.minSizeHeight(!0)-g;me>=0&&(r.style.top=(W-me<=0?0:W-me)+"px",console.log("\u306f\u307f\u51fa\u3057\u9632\u6b62\u51e6\u7406\u7e26"))}toggleMinimize(){if(this.isFullScreen)return;const e=this.panelService.cutInIdentifier;if(e&&Xe.instance.get(e).videoId)return;let i=this.scrollablePanel.nativeElement,r=this.draggablePanel.nativeElement;this.isMinimized?(this.isMinimized=!1,i.style.display=null,this.height=this.preHeight):(this.preHeight=r.offsetHeight,this.isMinimized=!0,i.style.display="none",this.height=this.titleBar.nativeElement.offsetHeight)}toggleFullScreen(){if(this.isMinimized)return;let e=this.draggablePanel.nativeElement;this.isFullScreen=!(e.offsetLeft<=0&&e.offsetTop<=0&&e.offsetWidth>=window.innerWidth&&e.offsetHeight>=window.innerHeight),this.isFullScreen?(this.preLeft=e.offsetLeft,this.preTop=e.offsetTop,this.preWidth=e.offsetWidth,this.preHeight=e.offsetHeight,this.left=0,this.top=0,this.width=window.innerWidth,this.height=window.innerHeight,e.style.left=this.left+"px",e.style.top=this.top+"px",e.style.width=this.width+"px",e.style.height=this.height+"px"):(this.left=this.preLeft,this.top=this.preTop,this.width=this.preWidth,this.height=this.preHeight)}get padding_(){return this.panelService.isCutIn?"0px":"8px"}get isCutIn(){return this.panelService.isCutIn}close(){this.timerCheckWindowSize&&(clearTimeout(this.timerCheckWindowSize),this.timerCheckWindowSize=null),this.timerCheckWindowSize=null,this.panelService&&this.panelService.close()}backGroundSetting(e){return"background: linear-gradient(-30deg, rgba(240,218,189, 0.9), rgba(255, 244, 232, 0.9));"}}return n.\u0275fac=function(e){return new(e||n)(Be($n),Be(Di))},n.\u0275cmp=Qt({type:n,selectors:[["ui-panel"]],viewQuery:function(e,i){if(1&e&&(Gn(_ee,7),Gn(mee,7),Gn($ee,7),Gn(vee,7,ds)),2&e){let r;yn(r=Cn())&&(i.draggablePanel=r.first),yn(r=Cn())&&(i.scrollablePanel=r.first),yn(r=Cn())&&(i.titleBar=r.first),yn(r=Cn())&&(i.content=r.first)}},inputs:{title:"title",left:"left",top:"top",width:"width",height:"height",showTitleButtons:"showTitleButtons"},features:[Xi([$n])],ngContentSelectors:Eee,decls:13,vars:21,consts:[["appDraggable","","appResizable","",1,"draggable-panel","no-caret",3,"ngClass","resizable.disable","draggable.stack","mouseenter","mouseleave"],["draggablePanel",""],[1,"title","no-caret"],["titleBar",""],["class","title-button",4,"ngIf"],[4,"ngIf"],[1,"scrollable-panel","no-caret",3,"ngStyle"],["scrollablePanel",""],[1,"no-caret"],["content",""],[1,"title-button"],[3,"disabled","click"],[1,"material-icons",2,"font-size","14px"],[3,"click"],[3,"chatTabidentifier","isTilteTop","dispByMouse"],[3,"cardStackidentifier"]],template:function(e,i){1&e&&(j_(),J(0,"div",0,1),Re("mouseenter",function(){return i.showTachie(!0)})("mouseleave",function(){return i.showTachie(!1)}),J(2,"div",2,3),Ee(4,bee,10,2,"div",4),we(5),oe(),Ee(6,yee,2,3,"ng-container",5),Ee(7,Cee,2,1,"ng-container",5),J(8,"div",6,7),G_(10),it(11,"div",8,9),oe()()),2&e&&(un("left",i.left,"px")("top",i.top,"px")("width",i.width,"px")("height",i.height,"px"),ie("@flyInOut","in")("ngClass",Nt(17,xee,i.isPointerDragging))("resizable.disable",i.isMinimized||i.isFullScreen)("draggable.stack",".draggable-panel"),j(4),ie("ngIf","\u30e1\u30cb\u30e5\u30fc"!==i.title),j(1),sn(" ",i.panelService.title," "),j(1),ie("ngIf",i.panelService.chatTab),j(1),ie("ngIf",i.panelService.cardStack),j(1),ie("ngStyle",Nt(19,wee,i.padding_)))},directives:[GP,gee,ir,Sn,AP,Co],styles:["[_nghost-%COMP%]{display:block}.draggable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;color:#444;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;padding:0;top:200px;height:200px;width:300px;max-height:100%;max-width:100%}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;position:absolute;top:25px;bottom:0;width:100%;padding:8px;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.cut-in--panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;position:absolute;top:25px;bottom:0;width:100%;padding:0;overscroll-behavior:contain}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#555;color:#ccc;-webkit-user-select:none;user-select:none}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#ccc}.title[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{opacity:.3}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.no-caret[_ngcontent-%COMP%]{caret-color:transparent}"],data:{animation:[Na("flyInOut",[Lr("void => *",[Br("100ms ease-out",Ls([mn({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),mn({transform:"scale(1.0, 1.0)",opacity:"1",offset:1})]))]),Lr("* => void",[Br(100,mn({transform:"scale(0, 0)"}))])])]}}),n})();const Tee=["videoPlayerComponent"];function See(n,t){1&n&&(it(0,"img",5),At(1,"safe")),2&n&&ie("src",Ft(1,1,$e(2).cutIn.cutInImage.url,"resourceUrl"),hn)}const Dee=function(n,t,e,i){return{autoplay:1,controls:0,start:n,loop:t,playsinline:1,rel:0,listType:"playlist",list:e,playlist:i,disablekb:1,fs:0,iv_load_policy:3,modestbranding:1}};function Iee(n,t){if(1&n){const e=pt();J(0,"div",1)(1,"youtube-player",2,3),Re("ready",function(r){return Le(e),$e().onPlayerReady(r)})("stateChange",function(r){return Le(e),$e().onPlayerStateChange(r)}),oe(),Ee(3,See,2,4,"img",4),oe()}if(2&n){const e=$e();Ht("id",e.cutInAreaId),j(1),un("visibility",e.isVisible),ie("videoId",e.videoId)("width",e.youTubeWidth)("height",e.youTubeHeight)("playerVars",Rr(8,Dee,e.cutIn.videoStart,e.cutIn&&e.cutIn.isLoop?1:0,e.playListId?e.playListId:null,e.playListId?null:e.videoId)),j(2),ie("ngIf",!e.videoId)}}let kee=(()=>{class n{constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.changeDetectionRef=r,this.ngZone=o,this.left=0,this.top=0,this.width=200,this.height=150,this.lazyUpdateTimer=null,this.audioPlayer=new Jt,this.cutInTimeOut=null,this.timerCheckWindowSize=null,this._videoId="",this.videoStateTransition=!1,this.isTest=!1,this.cutIn=null,this.playListId="",this._naturalWidth=0,this._naturalHeight=0}get audios(){return en.instance.audios.filter(e=>!e.isHidden)}get cutInLauncher(){return Xe.instance.get("CutInLauncher")}get jukebox(){return Xe.instance.get("Jukebox")}get config(){return Xe.instance.get("Config")}getCutIns(){return Xe.instance.getObjects(Yi)}startCutIn(){if(!this.cutIn)return;console.log("CutInWin "+this.cutIn.name);let e=this.cutIn.audio;e&&(this.audioPlayer.loop=this.cutIn.isLoop,this.cutIn.videoId||this.audioPlayer.play(e)),this.cutIn.outTime>0&&(console.log("outTime "+this.cutIn.outTime),this.cutInTimeOut=setTimeout(()=>{this.cutInTimeOut=null,this.panelService.close()},1e3*this.cutIn.outTime))}stopCutIn(){this.audioPlayer.stop()}ngOnInit(){Qe.register(this).on("START_CUT_IN",e=>{console.log("\u30ab\u30c3\u30c8\u30a4\u30f3\u30a6\u30a3\u30f3\u30c9\u30a6>Event:START_CUT_IN "+this.cutIn.name),this.cutIn&&(this.cutIn.identifier==e.data.cutIn.identifier||this.cutIn.tagName==e.data.cutIn.tagName)&&this.panelService.close()}).on("STOP_CUT_IN_BY_BGM",e=>{if(this.cutIn){console.log(" 'STOP_CUT_IN_BY_BGM :"+this.cutIn);let i=en.instance.get(this.cutIn.audioIdentifier);""==this.cutIn.tagName&&i&&this.panelService.close()}}).on("STOP_CUT_IN",e=>{console.log("\u30ab\u30c3\u30c8\u30a4\u30f3\u30a6\u30a3\u30f3\u30c9\u30a6>Event: "+this.cutIn.name),this.cutIn&&this.cutIn.identifier==e.data.cutIn.identifier&&this.panelService.close()})}ngAfterViewInit(){this.cutIn&&setTimeout(()=>{this.moveCutInPos()},0)}moveCutInPos(){if(this.cutIn){let e=this.cutIn.width,i=this.cutIn.height,r=window.innerWidth-e,o=window.innerHeight-i-25;r<0&&(r=0),o<0&&(o=0);let s=r*this.cutIn.x_pos/100,a=o*this.cutIn.y_pos/100;this.width=e,this.height=i+25,this.left=s,this.top=a}else console.log("\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u672a\u5b9a\u7fa9\u3067\u518d\u751f\u3055\u308c\u305f");this.panelService.width=this.width,this.panelService.height=this.height,this.panelService.left=this.left,this.panelService.top=this.top}chkeWindowMinSize(){this.videoId&&(console.log("chkeWindowMinSize 1:"+this.panelService.width),this.panelService.width<this.cutIn.minSizeWidth(!0)&&(this.panelService.width=this.cutIn.minSizeWidth(!0)),this.panelService.height<this.cutIn.minSizeHeight(!0)&&(this.panelService.height=this.cutIn.minSizeHeight(!0)),console.log("chkeWindowMinSize 2:"+this.panelService.width))}get videoId(){return this.cutIn?(""==this._videoId&&(this._videoId=this.cutIn.videoId),this._videoId):""}get videoVolume(){return(this.isTest?this.jukebox.auditionVolume:this.jukebox.volume)*this.config.roomVolume*100}get cutInAreaId(){return this.cutIn?this.cutIn.identifier+"_window":""}get youTubeWidth(){return document.getElementById(this.cutInAreaId)?document.getElementById(this.cutInAreaId).clientWidth:640}get youTubeHeight(){return document.getElementById(this.cutInAreaId)?document.getElementById(this.cutInAreaId).clientHeight:340}onPlayerReady(e){e.target.setVolume(this.videoVolume),console.log("ready"),e.target.playVideo()}onPlayerStateChange(e){const i=e.data;console.log(e.data),1==i&&(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200)),2==i&&(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200)),5==i&&(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200)),0==i&&(this.cutInTimeOut=null,this.panelService.close())}onErrorFallback(){console.log("fallback")}ngOnDestroy(){this.cutInTimeOut&&(clearTimeout(this.cutInTimeOut),this.cutInTimeOut=null),this.stopCutIn(),Qe.unregister(this)}lazyNgZoneUpdate(){null===this.lazyUpdateTimer&&(this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,this.ngZone.run(()=>{})},100))}}return n.\u0275fac=function(e){return new(e||n)(Be(pi),Be($n),Be(bi),Be(An))},n.\u0275cmp=Qt({type:n,selectors:[["app-cut-in-window"]],viewQuery:function(e,i){if(1&e&&Gn(Tee,5),2&e){let r;yn(r=Cn())&&(i.videoPlayer=r.first)}},decls:1,vars:1,consts:[["class","cut-in",3,"id",4,"ngIf"],[1,"cut-in",3,"id"],["suggestedQuality","default",3,"videoId","width","height","playerVars","ready","stateChange"],["videoPlayerComponent",""],[3,"src",4,"ngIf"],[3,"src"]],template:function(e,i){1&e&&Ee(0,Iee,4,13,"div",0),2&e&&ie("ngIf",i.cutIn)},directives:[Sn,Nk],pipes:[Ii],styles:[".cut-in[_ngcontent-%COMP%]{padding:0;overflow-x:hidden;overflow-y:hidden;height:100%;width:100%}img[_ngcontent-%COMP%]{width:100%;height:100%}"]}),n})();function Mee(n,t){1&n&&pn(0)}function Aee(n,t){1&n&&pn(0)}const Pee=function(){return{box:!0}},Fee=function(n){return{target:n}};function Ree(n,t){if(1&n&&(J(0,"div",5),Ee(1,Aee,1,0,"ng-container",6),oe()),2&n){const e=t.$implicit;$e();const i=ln(6);ie("ngClass",$r(3,Pee)),j(1),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",Nt(4,Fee,e))}}function Nee(n,t){if(1&n){const e=pt();Je(0,11),J(1,"button",12),Re("click",function(){const o=Le(e).$implicit;return $e(2).voteSend(o)}),we(2),oe(),et()}if(2&n){const e=t.$implicit,i=$e(2);j(1),Ht("name",e),Ht("id",e),Yt("disabled",i.isMyVoteEnd()?"":null),j(1),Os(" ",e,":",i.vote.votedNumByChoice(e),"\u4eba")}}function Oee(n,t){if(1&n&&(J(0,"form",7)(1,"div",8)(2,"div"),we(3),oe(),J(4,"div"),we(5),J(6,"span",9),we(7,"\u203b\u6295\u7968\u524d\u306b\u9589\u3058\u308b\u3068\u68c4\u6a29"),oe()(),J(8,"div"),Ee(9,Nee,3,5,"ng-container",10),oe()()()),2&n){const e=$e();j(3),sn(" ",e.vote.voteTitle," "),j(2),y1(" \u6295\u7968\u6570:",e.vote.votedTotalNum(),"/",e.vote.voteAnswer.length," (\u68c4\u6a29\uff1a",e.vote.votedNumByIndex(-2),")"),j(4),ie("ngForOf",e.vote.choices)}}function Bee(n,t){if(1&n&&(J(0,"div",21),At(1,"safe"),oe()),2&n){const e=$e().target;un("background-image",Ft(1,2,"url("+$e().findPeerImage(e).url+")","style"))}}function Lee(n,t){if(1&n&&(Je(0),we(1),et()),2&n){const e=$e().target,i=$e();j(1),xt(i.findPeerLastControlName(e))}}function zee(n,t){1&n&&(Je(0),we(1,"\u64cd\u4f5c\u30ad\u30e3\u30e9\u306a\u3057"),et())}function Hee(n,t){if(1&n&&(J(0,"div",21),At(1,"safe"),oe()),2&n){const e=$e().target;un("background-image",Ft(1,2,"url("+$e().findPeerLastControlImage(e).url+")","style"))}}function Vee(n,t){1&n&&it(0,"div",22)}function Uee(n,t){1&n&&(Je(0),we(1,"\u672a\u6295\u7968"),et())}function jee(n,t){1&n&&(Je(0),we(1,"\u68c4\u6a29"),et())}function Gee(n,t){if(1&n&&(Je(0),we(1),et()),2&n){const e=$e().target,i=$e();j(1),xt(i.vote.indexToChoice(i.vote.voteAnswerByPeerId(e)))}}function qee(n,t){if(1&n&&(J(0,"div",13)(1,"div",14)(2,"div",15)(3,"div",16),we(4),oe(),J(5,"div",17),Ee(6,Bee,2,5,"div",18),oe()(),J(7,"div",15)(8,"div",16),Ee(9,Lee,2,1,"ng-container",19),Ee(10,zee,2,0,"ng-container",19),oe(),J(11,"div",17),Ee(12,Hee,2,5,"div",18),Ee(13,Vee,1,0,"div",18),oe()(),J(14,"div",20),Ee(15,Uee,2,0,"ng-container",19),Ee(16,jee,2,0,"ng-container",19),Ee(17,Gee,2,1,"ng-container",19),oe()()()),2&n){const e=t.target,i=$e();j(4),sn(" ",i.findPeerName(e)," "),j(2),ie("ngIf",i.findPeerImage(e)),j(3),ie("ngIf",i.findPeerLastControlName(e)),j(1),ie("ngIf",!i.findPeerLastControlName(e)),j(2),ie("ngIf",i.findPeerLastControlImage(e)),j(1),ie("ngIf",!i.findPeerLastControlImage(e)),j(2),ie("ngIf",-1==i.vote.voteAnswerByPeerId(e)),j(1),ie("ngIf",-2==i.vote.voteAnswerByPeerId(e)),j(1),ie("ngIf",i.vote.voteAnswerByPeerId(e)>=0)}}let Wee=(()=>{class n{constructor(e,i,r,o,s){this.modalService=e,this.panelService=i,this.changeDetectionRef=r,this.chatMessageService=o,this.ngZone=s,this.timestamp=0,this.timestamp=this.vote.initTimeStamp}get vote(){return Xe.instance.get("Vote")}get answerList(){return this.vote.voteAnswer}numberOfVote(e){const i=this.answerList;let r=0;for(let o of i)o==e&&r++;return r}isMyVoteEnd(){return this.vote.isVoteEnd(_t.myCursor.peerId)}voteSend(e){this.vote.voting(e,_t.myCursor.peerId);let i=this.vote.isRollCall?"\u70b9\u547c\uff1a":"\u6295\u7968\uff1a";i+=e+"("+this.vote.votedTotalNum()+"/"+this.answerList.length+")",this.chatMessageService.sendSystemMessageLastSendCharactor(i)}ngOnInit(){Qe.register(this).on("END_OLD_VOTE",e=>{console.log("\u53e4\u3044\u6295\u7968\u3092\u7d42\u4e86"),this.timestamp!=this.vote.initTimeStamp&&this.panelService.close()})}ngAfterViewInit(){}findUserId(e){const i=_t.findByPeerId(e);return i?i.userId:""}findPeerName(e){const i=_t.findByPeerId(e);return i?i.name:""}findPeerLastControlName(e){const i=_t.findByPeerId(e);return i?i.lastControlCharacterName:""}findPeerImage(e){const i=_t.findByPeerId(e);return i?i.image:null}findPeerLastControlImage(e){const i=_t.findByPeerId(e);return i?i.lastControlImage:null}ngOnDestroy(){if(!this.isMyVoteEnd()&&this.timestamp==this.vote.initTimeStamp){this.vote.voting(null,_t.myCursor.peerId);let e=this.vote.isRollCall?"\u70b9\u547c\uff1a":"\u6295\u7968\uff1a";e+="\u68c4\u6a29\u3057\u307e\u3057\u305f("+this.vote.votedTotalNum()+"/"+this.answerList.length+")",this.chatMessageService.sendSystemMessageLastSendCharactor(e)}Qe.unregister(this)}}return n.\u0275fac=function(e){return new(e||n)(Be(pi),Be($n),Be(bi),Be(go),Be(An))},n.\u0275cmp=Qt({type:n,selectors:[["app-vote-window"]],decls:7,vars:2,consts:[[1,"component"],[4,"ngTemplateOutlet"],["style","font-size: 15px;",3,"ngClass",4,"ngFor","ngForOf"],["voteTop",""],["voteAnswers",""],[2,"font-size","15px",3,"ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"is-sticky-top"],[1,"tab"],[2,"font-size","12px"],["style","font-size: 15px;",4,"ngFor","ngForOf"],[2,"font-size","15px"],[3,"name","id","click"],[1,"inventory-object"],[1,"object-tags-box"],[1,"table-cell"],[1,"object-name"],[1,"image-box"],["class","image cover",3,"background-image",4,"ngIf"],[4,"ngIf"],[1,"table-cell","message"],[1,"image","cover"],[1,"image","cover",3,"background-image"]],template:function(e,i){if(1&e&&(J(0,"div",0),Ee(1,Mee,1,0,"ng-container",1),Ee(2,Ree,2,6,"div",2),oe(),Ee(3,Oee,10,5,"ng-template",null,3,Ln),Ee(5,qee,18,9,"ng-template",null,4,Ln)),2&e){const r=ln(4);j(1),ie("ngTemplateOutlet",r),j(1),ie("ngForOf",i.vote.targetPeerId)}},directives:[Ra,si,ir,_s,gs,xo,Sn],pipes:[Ii],styles:[".component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border:transparent 2px solid;border-left:transparent 6px solid;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border:1px dotted #666}.message[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;vertical-align:middle}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #444}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.tab[_ngcontent-%COMP%]{padding:0;border:solid 1px #555;border-radius:.3em;overflow:hidden;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;background-color:#f0dabde6}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin-left:20px;margin-top:-3px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.is-sticky-top[_ngcontent-%COMP%]{position:sticky;top:0}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table-cell[_ngcontent-%COMP%]{display:table-cell}.image-box[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;max-width:64px;max-height:64px;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:table-cell;vertical-align:top}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.image-cover[_ngcontent-%COMP%]{width:100%;height:100%}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em;width:120px;overflow:hidden;white-space:nowrap}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}"]}),n})();function Zee(n,t){1&n&&pn(0)}function Yee(n,t){if(1&n&&(J(0,"form",3)(1,"div",4)(2,"div"),we(3),oe(),J(4,"div"),we(5),oe()()()),2&n){const e=$e();j(3),sn(" ",e.title," "),j(2),sn(" ",e.time,"\u79d2\u7d4c\u904e\u3057\u307e\u3057\u305f ")}}let Kee=(()=>{class n{constructor(e,i,r,o,s){this.modalService=e,this.panelService=i,this.changeDetectionRef=r,this.chatMessageService=o,this.ngZone=s,this.timestamp=0,this.timestamp=this.alarm.initTimeStamp}get alarm(){return Xe.instance.get("Alarm")}ngOnInit(){}ngAfterViewInit(){}ngOnDestroy(){Qe.unregister(this)}}return n.\u0275fac=function(e){return new(e||n)(Be(pi),Be($n),Be(bi),Be(go),Be(An))},n.\u0275cmp=Qt({type:n,selectors:[["app-alarm-window"]],decls:4,vars:1,consts:[[1,"component"],[4,"ngTemplateOutlet"],["alarmTop",""],[1,"is-sticky-top"],[1,"tab"]],template:function(e,i){if(1&e&&(J(0,"div",0),Ee(1,Zee,1,0,"ng-container",1),oe(),Ee(2,Yee,6,2,"ng-template",null,2,Ln)),2&e){const r=ln(3);j(1),ie("ngTemplateOutlet",r)}},directives:[Ra,_s,gs,xo],styles:[".component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border:transparent 2px solid;border-left:transparent 6px solid;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border:1px dotted #666}.message[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;vertical-align:middle}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #444}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.tab[_ngcontent-%COMP%]{padding:0;border:solid 1px #555;border-radius:.3em;overflow:hidden;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;background-color:#f0dabde6}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin-left:20px;margin-top:-3px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.is-sticky-top[_ngcontent-%COMP%]{position:sticky;top:0}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table-cell[_ngcontent-%COMP%]{display:table-cell}.image-box[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;max-width:64px;max-height:64px;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:table-cell;vertical-align:top}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.image-cover[_ngcontent-%COMP%]{width:100%;height:100%}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em;width:120px;overflow:hidden;white-space:nowrap}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}"]}),n})();class WP{constructor(t){this.canvasElement=t}makeBrush(t,e,i){t.strokeStyle=i,t.fillStyle=t.strokeStyle,t.lineWidth=1;let r=Math.floor(e/5);return t.font=`bold ${r}px sans-serif`,t.textBaseline="top",t.textAlign="center",t}render(t,e,i=50,r=bs.SQUARE,o="#000000e6",s=!1,a=0,g=0){this.canvasElement.width=t*i,this.canvasElement.height=e*i;let w=this.canvasElement.getContext("2d");if(r<0)return;let W=s?Math.floor(a/i)+1:0,ve=s?Math.floor(g/i)+1:0,me=this.generateCalcGridPositionFunc(r);this.makeBrush(w,i,o);for(let Se=0;Se<=e;Se++)for(let Oe=0;Oe<=t;Oe++){let{gx:Ve,gy:We}=me(Oe,Se,i);this.strokeSquare(w,Ve,We,i);let Ze=0,je=0;s&&r==bs.HEX_VERTICAL&&(Ze=ve%2==1&&(Oe+1+ve)%2==1?-1:0),s&&r==bs.HEX_HORIZONTAL&&(je=W%2==1&&(Se+1+W)%2==1?-1:0),w.fillText((Oe+1+ve+je).toString()+"-"+(Se+1+W+Ze).toString(),Ve+i/2,We+i/2)}}generateCalcGridPositionFunc(t){switch(t){case bs.HEX_VERTICAL:return(e,i,r)=>e%2==1?{gx:e*r,gy:i*r}:{gx:e*r,gy:i*r+r/2};case bs.HEX_HORIZONTAL:return(e,i,r)=>i%2==1?{gx:e*r,gy:i*r}:{gx:e*r+r/2,gy:i*r};default:return(e,i,r)=>({gx:e*r,gy:i*r})}}strokeSquare(t,e,i,r){t.beginPath(),t.strokeRect(e,i,r,r)}strokeHex(t,e,i,r,o){let s=o===bs.HEX_HORIZONTAL?-30:0,a=r/Math.sqrt(3),g=e+r/2,w=i+r/2;t.beginPath();for(let W=0;W<6;W++){s+=60;let ve=Math.PI/180*s,me=Math.cos(ve)*a+g,Se=Math.sin(ve)*a+w;t.lineTo(me,Se)}t.closePath(),t.stroke()}}var Vf=(()=>(function(n){n.DRAG="drag",n.ZOOM="zoom",n.ROTATE="rotate",n.KEYBOARD="keyboard"}(Vf||(Vf={})),Vf))(),Wa=(()=>(function(n){n.ArrowLeft="ArrowLeft",n.ArrowUp="ArrowUp",n.ArrowRight="ArrowRight",n.ArrowDown="ArrowDown"}(Wa||(Wa={})),Wa))();class Xee{constructor(t){this.targetElement=t,this.currentPositionX=0,this.currentPositionY=0,this.buttonCode=0,this.input=null,this.callbackOnWheel=e=>this.onWheel(e),this.callbackOnKeydown=e=>this.onKeydown(e),this.onstart=null,this.onend=null,this.ontransform=null,this.initialize()}get isGrabbing(){return this.input.isGrabbing}get isDragging(){return this.input.isDragging}initialize(){this.input=new fa(this.targetElement,{capture:!0}),this.addEventListeners(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this)}cancel(){this.input.cancel()}destroy(){this.input.destroy(),this.removeEventListeners()}onInputStart(t){this.currentPositionX=this.input.pointer.x,this.currentPositionY=this.input.pointer.y,this.buttonCode=t.button,this.onstart&&this.onstart(t)}onInputEnd(t){this.onend&&this.onend(t)}onInputMove(t){let e=this.input.pointer.x,i=this.input.pointer.y,r=e-this.currentPositionX,o=i-this.currentPositionY,s=0,a=0,w=0,ve=0,me=Vf.DRAG;2===this.buttonCode?(me=Vf.ROTATE,ve=-r/5,w=-o/5):(s=r,a=o),this.currentPositionX=e,this.currentPositionY=i,this.ontransform&&this.ontransform(s,a,0,w,0,ve,me,t)}onWheel(t){let e=0;switch(t.deltaMode){case WheelEvent.DOM_DELTA_LINE:e=16*t.deltaY;break;case WheelEvent.DOM_DELTA_PAGE:e=t.deltaY*window.innerHeight;break;default:e=t.deltaY}let o=0;o=-1.5*e,9e4<o**2&&(o=Math.min(Math.max(o,-300),300)),this.ontransform&&this.ontransform(0,0,o,0,0,0,Vf.ZOOM,t)}onKeydown(t){let e=0,i=0,r=0,o=0,a=0,g=this.getKeyName(t);switch(g){case Wa.ArrowLeft:t.shiftKey?a=-2:e=10;break;case Wa.ArrowUp:t.shiftKey?o=-2:t.ctrlKey?r=150:i=10;break;case Wa.ArrowRight:t.shiftKey?a=2:e=-10;break;case Wa.ArrowDown:t.shiftKey?o=2:t.ctrlKey?r=-150:i=-10}null!=Wa[g]&&this.ontransform&&this.ontransform(e,i,r,o,0,a,Vf.KEYBOARD,t)}getKeyName(t){if(t.key)return t.key;switch(t.keyCode){case 37:return Wa.ArrowLeft;case 38:return Wa.ArrowUp;case 39:return Wa.ArrowRight;case 40:return Wa.ArrowDown;default:return""}}addEventListeners(){this.targetElement.addEventListener("wheel",this.callbackOnWheel,!1),document.body.addEventListener("keydown",this.callbackOnKeydown,!1)}removeEventListeners(){this.targetElement.removeEventListener("wheel",this.callbackOnWheel,!1),document.body.removeEventListener("keydown",this.callbackOnKeydown,!1)}}var vd=(()=>(function(n){n.PAN="pan",n.TAP_PINCH="tappinch",n.PINCH="pinch",n.ROTATE="rotate"}(vd||(vd={})),vd))();class Qee{constructor(t,e){this.targetElement=t,this.ngZone=e,this.hammer=null,this.deltaHammerDeltaX=0,this.deltaHammerDeltaY=1,this.deltaHammerScale=1,this.deltaHammerRotation=0,this.prevHammerDeltaX=0,this.prevHammerDeltaY=0,this.prevHammerScale=0,this.prevHammerRotation=0,this.tappedPanTimer=null,this.tappedPanCenter={x:0,y:0},this.onstart=null,this.onend=null,this.ongesture=null,this.ontransform=null,this.initializeHammer()}destroy(){this.clearTappedPanTimer(),this.hammer.destroy()}initializeHammer(){this.hammer=new Hammer.Manager(this.targetElement,{inputClass:Hammer.TouchInput});let t=new Hammer.Tap,e=new Hammer.Pan({event:"pan1p",pointers:1,threshold:0}),i=new Hammer.Pan({event:"pan2p",pointers:2,threshold:0}),r=new Hammer.Pinch,o=new Hammer.Rotate;e.recognizeWith(i),e.recognizeWith(o),e.recognizeWith(r),i.recognizeWith(r),i.recognizeWith(o),r.recognizeWith(o),this.hammer.add([t,e,i,r,o]),this.hammer.on("hammer.input",this.onHammer.bind(this)),this.hammer.on("tap",this.onTap.bind(this)),this.hammer.on("pan1pstart",this.onTappedPanStart.bind(this)),this.hammer.on("pan1pmove",this.onTappedPanMove.bind(this)),this.hammer.on("pan1pend",this.onTappedPanEnd.bind(this)),this.hammer.on("pan1pcancel",this.onTappedPanEnd.bind(this)),this.hammer.on("pan2pmove",this.onPanMove.bind(this)),this.hammer.on("pinchmove",this.onPinchMove.bind(this)),this.hammer.on("rotatemove",this.onRotateMove.bind(this));let s=window.navigator.userAgent.toLowerCase();(s.indexOf("iphone")>-1||s.indexOf("ipad")>-1||s.indexOf("macintosh")>-1&&"ontouchend"in document)&&(this.hammer.add(new Hammer.Press({time:251})),this.hammer.on("press",g=>{let w=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,clientX:g.center.x,clientY:g.center.y});this.ngZone.run(()=>g.srcEvent.target.dispatchEvent(w))}))}onHammer(t){t.isFirst?(this.deltaHammerScale=t.scale,this.deltaHammerRotation=t.rotation,this.deltaHammerDeltaX=t.deltaX,this.deltaHammerDeltaY=t.deltaY,this.onstart&&this.onstart(t.srcEvent)):t.isFinal?this.onend&&this.onend(t.srcEvent):(this.deltaHammerScale=t.scale-this.prevHammerScale,this.deltaHammerRotation=t.rotation-this.prevHammerRotation,this.deltaHammerDeltaX=t.deltaX-this.prevHammerDeltaX,this.deltaHammerDeltaY=t.deltaY-this.prevHammerDeltaY),this.prevHammerScale=t.scale,this.prevHammerRotation=t.rotation,this.prevHammerDeltaX=t.deltaX,this.prevHammerDeltaY=t.deltaY,null!=this.tappedPanTimer&&t.eventType==Hammer.INPUT_START&&2500<(this.tappedPanCenter.x-t.center.x)**2+(this.tappedPanCenter.y-t.center.y)**2&&this.clearTappedPanTimer()}onTap(t){this.tappedPanCenter=t.center,this.tappedPanTimer=setTimeout(()=>{this.tappedPanTimer=null},400),this.ongesture&&this.ongesture(t.srcEvent)}onTappedPanStart(t){null!=this.tappedPanTimer&&(this.clearTappedPanTimer(!1),this.ongesture&&this.ongesture(t.srcEvent))}onTappedPanEnd(t){this.clearTappedPanTimer()}onTappedPanMove(t){if(null==this.tappedPanTimer){let e=this.deltaHammerDeltaX,i=this.deltaHammerDeltaY,r=0;this.ontransform&&this.ontransform(e,i,r,0,0,0,vd.PAN,t.srcEvent)}else{this.clearTappedPanTimer(!1);let i=7.5*this.deltaHammerDeltaY;this.ongesture&&this.ongesture(t.srcEvent),this.ontransform&&this.ontransform(0,0,i,0,0,0,vd.TAP_PINCH,t.srcEvent)}}onPanMove(t){this.clearTappedPanTimer();let e=-this.deltaHammerDeltaY/window.innerHeight*100;this.ongesture&&this.ongesture(t.srcEvent),this.ontransform&&this.ontransform(0,0,0,e,0,0,vd.ROTATE,t.srcEvent)}onPinchMove(t){this.clearTappedPanTimer();let e=500*this.deltaHammerScale;this.ongesture&&this.ongesture(t.srcEvent),this.ontransform&&this.ontransform(0,0,e,0,0,0,vd.PINCH,t.srcEvent)}onRotateMove(t){this.clearTappedPanTimer();let e=this.deltaHammerRotation;this.ongesture&&this.ongesture(t.srcEvent),this.ontransform&&this.ontransform(0,0,0,0,0,e,vd.ROTATE,t.srcEvent)}clearTappedPanTimer(t=!0){clearTimeout(this.tappedPanTimer),t&&(this.tappedPanTimer=null)}}let bd=(()=>{class n{constructor(e,i,r,o,s){this.ngZone=e,this.elementRef=i,this.batchService=r,this.pointerDeviceService=o,this.coordinateService=s,this.layerName="",this.colideLayers=[],this.transformCssOffset="",this.isDisable=!1,this.isScratcOwner=!1,this.onstart=new Xt,this.ondragstart=new Xt,this.ondrag=new Xt,this.ondragend=new Xt,this.onend=new Xt,this._posX=0,this._posY=0,this._posZ=0,this.mathFloor=!0,this.pointerOffset2d={x:0,y:0,z:0},this.pointerStart3d={x:0,y:0,z:0},this.height=0,this.width=0,this.ratio=1,this.updateTimer=null,this.collidableElements=[],this.input=null}set option(e){this.tabletopObject=null!=e.tabletopObject?e.tabletopObject:this.tabletopObject,this.layerName=null!=e.layerName?e.layerName:this.layerName,this.colideLayers=null!=e.colideLayers?e.colideLayers:this.colideLayers,this.transformCssOffset=null!=e.transformCssOffset?e.transformCssOffset:this.transformCssOffset}get nativeElement(){return this.elementRef.nativeElement}get posX(){return this._posX}set posX(e){this._posX=this.mathFloor?Math.floor(e):e,this.setUpdateTimer()}get posY(){return this._posY}set posY(e){this._posY=this.mathFloor?Math.floor(e):e,this.setUpdateTimer()}get posZ(){return this._posZ}set posZ(e){this._posZ=this.mathFloor?Math.floor(8*e)/8:e,this.setUpdateTimer()}get isGridSnap(){return da.instance.gridSnap}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.elementRef),this.setPosition(this.tabletopObject)}ngOnDestroy(){this.cancel(),this.input.destroy(),this.unregister(),Qe.unregister(this),this.batchService.remove(this),this.batchService.remove(this.elementRef)}initialize(){this.input=new fa(this.nativeElement),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),Qe.register(this).on("UPDATE_GAME_OBJECT",e=>{e.isSendFromSelf&&this.input.isGrabbing||e.data.identifier!==this.tabletopObject.identifier||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.stopTransition(),this.setPosition(this.tabletopObject)},this)}),this.layerName.length<1&&this.tabletopObject&&(this.layerName=this.tabletopObject.aliasName),this.register(),this.findCollidableElements(),this.setPosition(this.tabletopObject)}cancel(){this.input.cancel(),this.setPointerEvents(!0),this.setAnimatedTransition(!0),this.setCollidableLayer(!1)}scratchObjectPosition(e){let i={x:this.input.pointer.x,y:this.input.pointer.y,z:0};i.x=Math.min(window.innerWidth-.1,Math.max(i.x,.1)),i.y=Math.min(window.innerHeight-.1,Math.max(i.y,.1));let r=document.elementFromPoint(i.x,i.y);if(null==r)return;let o=this.coordinateService.calcTabletopLocalCoordinate(i,r);o.x-=this.posX,o.y-=this.posY,Qe.trigger("SCRATCH_POINTER_XYZ",{x:o.x,y:o.y,z:o.z,identifier:this.tabletopObject.identifier,start:e})}onInputStart(e){if(this.callSelectedEvent(),this.collidableElements.length<1&&this.findCollidableElements(),this.isDisable&&!this.isScratcOwner||1===e.button||2===e.button)return this.cancel();this.onstart.emit(e),this.setPointerEvents(!1),this.setAnimatedTransition(!1),this.setCollidableLayer(!0),this.width=this.nativeElement.clientWidth,this.height=this.nativeElement.clientHeight;let i={x:this.posX+this.width/2,y:this.posY+this.height/2,z:this.posZ},r=this.coordinateService.convertToGlobal(i,this.coordinateService.tabletopOriginElement);this.setPointerEvents(!0),this.pointerOffset2d.x=r.x-this.input.pointer.x,this.pointerOffset2d.y=r.y-this.input.pointer.y,this.pointerOffset2d.z=r.z-this.input.pointer.z,this.pointerStart3d.x=i.x,this.pointerStart3d.y=i.y,this.pointerStart3d.z=i.z,this.targetStartRect=this.nativeElement.getBoundingClientRect(),this.isScratcOwner&&this.scratchObjectPosition(!0),this.ratio=1}onInputMove(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable&&!this.isScratcOwner||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),this.input.isDragging||this.setPointerEvents(!1);let i={x:this.input.pointer.x+this.pointerOffset2d.x*this.ratio,y:this.input.pointer.y+this.pointerOffset2d.y*this.ratio,z:0};i.x=Math.min(window.innerWidth-.1,Math.max(i.x,.1)),i.y=Math.min(window.innerHeight-.1,Math.max(i.y,.1));let r=document.elementFromPoint(i.x,i.y);if(null==r)return;let o=this.coordinateService.calcTabletopLocalCoordinate(i,r);if(o.x-=this.width/2,o.y-=this.height/2,this.posX===o.x&&this.posY===o.y&&this.posZ===o.z)return;this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e);let a=this.nativeElement.getBoundingClientRect().width/this.targetStartRect.width;a<this.ratio&&(this.ratio+=.1*(a-this.ratio)),this.isScratcOwner?this.scratchObjectPosition(!1):(this.posX=o.x,this.posY=o.y,this.posZ=o.z)}onInputEnd(e){if(this.isDisable)return this.cancel();this.input.isDragging&&this.ondragend.emit(e),this.isGridSnap&&this.input.isDragging&&!this.isScratcOwner&&this.snapToGrid(),this.cancel(),this.onend.emit(e)}onContextMenu(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.isGridSnap&&this.input.isDragging&&this.snapToGrid();let i=this.input.isGrabbing&&e.isTrusted;if(this.cancel(),i){e.stopPropagation();let r=new MouseEvent(e.type,e);this.ngZone.run(()=>this.nativeElement.dispatchEvent(r))}}callSelectedEvent(){this.tabletopObject&&Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.tabletopObject.identifier,className:this.tabletopObject.aliasName})}snapToGrid(e=25){this.posX=this.calcSnapNum(this.posX,e),this.posY=this.calcSnapNum(this.posY,e)}calcSnapNum(e,i){return i<=0?e:(e=e<0?e-i/2:e+i/2)-e%i}setPosition(e){this._posX=this.mathFloor?Math.floor(e.location.x):e.location.x,this._posY=this.mathFloor?Math.floor(e.location.y):e.location.y,this._posZ=this.mathFloor?Math.floor(8*e.posZ)/8:e.posZ,this.updateTransformCss()}setUpdateTimer(){null===this.updateTimer&&this.tabletopObject&&(this.updateTimer=setTimeout(()=>{this.tabletopObject.location.x=this.posX,this.tabletopObject.location.y=this.posY,this.tabletopObject.posZ=this.posZ,this.updateTimer=null},66)),this.updateTransformCss()}findCollidableElements(){this.collidableElements=[],"none"===getComputedStyle(this.nativeElement).pointerEvents?this.findNestedCollidableElements(this.nativeElement):this.collidableElements=[this.nativeElement]}findNestedCollidableElements(e){let i=e.children;for(let r=0;r<i.length;r++){let o=i[r];o instanceof HTMLElement&&"none"!==getComputedStyle(o).pointerEvents&&this.collidableElements.push(o)}if(this.collidableElements.length<1)for(let r=0;r<i.length;r++){let o=i[r];o instanceof HTMLElement&&this.findNestedCollidableElements(o)}}setPointerEvents(e){let i=e?"auto":"none";this.collidableElements.forEach(r=>r.style.pointerEvents=i)}setAnimatedTransition(e){this.nativeElement.style.transition=e?"transform 132ms linear":""}shouldTransition(e){return e.location.x!==this.posX||e.location.y!==this.posY||e.posZ!==this.posZ}stopTransition(){this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform}updateTransformCss(){this.nativeElement.style.transform="translate3d("+this.posX+"px,"+this.posY+"px,"+this.posZ+"px) "+this.transformCssOffset}setCollidableLayer(e){let i=e;for(let r in n.layerHash)i=-1<this.colideLayers.indexOf(r)?!this.input.isGrabbing||e:!e,n.layerHash[r].forEach(o=>{o===this||o.input.isGrabbing||o.setPointerEvents(i)})}register(){this.layerName in n.layerHash||(n.layerHash[this.layerName]=[]),n.layerHash[this.layerName].indexOf(this)<0&&n.layerHash[this.layerName].push(this)}unregister(){if(!(this.layerName in n.layerHash))return;let e=n.layerHash[this.layerName].indexOf(this);-1<e&&n.layerHash[this.layerName].splice(e,1)}}return n.layerHash={},n.\u0275fac=function(e){return new(e||n)(Be(An),Be(fi),Be(Rp),Be(Di),Be($d))},n.\u0275dir=nn({type:n,selectors:[["","appMovable",""]],inputs:{option:["movable.option","option"],isDisable:["movable.disable","isDisable"],isScratcOwner:["movable.scratch_owner","isScratcOwner"]},outputs:{onstart:"movable.onstart",ondragstart:"movable.ondragstart",ondrag:"movable.ondrag",ondragend:"movable.ondragend",onend:"movable.onend"}}),n})(),Uf=(()=>{class n{constructor(e,i,r,o){this.elementRef=e,this.batchService=i,this.pointerDeviceService=r,this.coordinateService=o,this.transformCssOffset="",this.grabbingSelecter=".rotate-grab",this.isDisable=!1,this.onstart=new Xt,this.ondragstart=new Xt,this.ondrag=new Xt,this.ondragend=new Xt,this.onend=new Xt,this._rotate=0,this.valueChange=new Xt,this.rotateOffset=0,this.updateTimer=null,this.grabbingElement=null,this.input=null}set option(e){this.tabletopObject=null!=e.tabletopObject?e.tabletopObject:this.tabletopObject,this.grabbingSelecter=null!=e.grabbingSelecter?e.grabbingSelecter:this.grabbingSelecter,this.transformCssOffset=null!=e.transformCssOffset?e.transformCssOffset:this.transformCssOffset}get nativeElement(){return this.elementRef.nativeElement}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.setUpdateTimer()}set value(e){this._rotate=e,this.updateTransformCss()}get isAllowedToRotate(){if(!this.grabbingElement||!this.nativeElement)return!1;if(this.grabbingSelecter.length<1)return!0;let e=this.nativeElement.querySelectorAll(this.grabbingSelecter),i=!1;for(let r=0;r<e.length;r++)if(i=e[r].contains(this.grabbingElement),i)return!0;return!1}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.elementRef),this.tabletopObject?this.setRotate(this.tabletopObject):this.updateTransformCss()}ngOnDestroy(){this.cancel(),this.input.destroy(),Qe.unregister(this),this.batchService.remove(this),this.batchService.remove(this.elementRef)}initialize(){this.input=new fa(this.nativeElement),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),this.tabletopObject?(Qe.register(this).on("UPDATE_GAME_OBJECT",e=>{e.isSendFromSelf&&this.input.isGrabbing||e.data.identifier!==this.tabletopObject.identifier||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.stopTransition(),this.setRotate(this.tabletopObject)},this)}),this.setRotate(this.tabletopObject)):this.updateTransformCss()}cancel(){this.input.cancel(),this.grabbingElement=null,this.setAnimatedTransition(!0)}onInputStart(e){if(this.grabbingElement=e.target,this.isDisable||!this.isAllowedToRotate||1===e.button||2===e.button)return this.cancel();e.stopPropagation(),this.onstart.emit(e);let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement);this.rotateOffset=this.calcRotate(i,this.rotate),this.setAnimatedTransition(!1)}onInputMove(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),e.stopPropagation();let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement),r=this.calcRotate(i,this.rotateOffset);this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e),this.rotate=r}onInputEnd(e){if(this.isDisable)return this.cancel();e.stopPropagation(),this.input.isDragging&&this.ondragend.emit(e),this.cancel(),this.snapToPolygonal(),this.onend.emit(e)}onContextMenu(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.cancel(),this.snapToPolygonal()}calcRotate(e,i){return(180*Math.atan2(e.y-this.nativeElement.clientHeight/2,e.x-this.nativeElement.clientWidth/2)/Math.PI-i)%360}snapToPolygonal(e=24){e<=1||(this.tabletopObject instanceof or&&this.tabletopObject.subDivisionSnapPolygonal&&(e=240),this.rotate=this.rotate<0?this.rotate-180/e:this.rotate+180/e,this.rotate-=this.rotate%(360/e))}setUpdateTimer(){null===this.updateTimer&&(this.updateTimer=setTimeout(()=>{this.valueChange.emit(this.rotate),this.tabletopObject&&(this.tabletopObject.rotate=this.rotate),this.updateTimer=null},66)),this.updateTransformCss()}setRotate(e){e&&(this._rotate=e.rotate),this.updateTransformCss()}setAnimatedTransition(e){this.nativeElement.style.transition=e?"transform 132ms linear":""}shouldTransition(e){return e.rotate!==this.rotate}stopTransition(){this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform}updateTransformCss(){let e=`${this.transformCssOffset} rotateZ(${this.rotate.toFixed(4)}deg)`;this.nativeElement.style.transform=e}}return n.\u0275fac=function(e){return new(e||n)(Be(fi),Be(Rp),Be(Di),Be($d))},n.\u0275dir=nn({type:n,selectors:[["","appRotable",""]],inputs:{option:["rotable.option","option"],isDisable:["rotable.disable","isDisable"],value:["rotable.value","value"]},outputs:{onstart:"rotable.onstart",ondragstart:"rotable.ondragstart",ondrag:"rotable.ondrag",ondragend:"rotable.ondragend",onend:"rotable.onend",valueChange:"rotable.valueChange"}}),n})();const Jee=["gridCanvas"],ZP=function(n){return{"blinking-animation":n}};function ete(n,t){if(1&n&&(J(0,"div",9),At(1,"safe"),oe()),2&n){const e=$e(2);un("background-image",Ft(1,3,"url("+e.floorImage.url+")","style")),ie("ngClass",Nt(6,ZP,!e.isLocked))}}function tte(n,t){if(1&n&&(Je(0),Ee(1,ete,2,8,"div",8),et()),2&n){const e=$e();j(1),ie("ngIf",e.isDropShadow&&(0!=e.terreinAltitude||e.isSlope&&!e.hasWall))}}const YP=function(n,t,e){return{"backface-visibility":n,transform:t,filter:e}};function nte(n,t){if(1&n&&(Je(0),J(1,"div",10),At(2,"safe"),oe(),et()),2&n){const e=$e();j(1),un("background-image",Ft(2,4,"url("+e.floorImage.url+")","style")),ie("ngClass",Nt(7,ZP,!e.isLocked))("ngStyle",Wo(9,YP,e.isSlope?"visible":"hidden","translateZ("+e.height/(e.isSlope?2:1)*e.gridSize+"px)"+e.floorModCss,"brightness("+e.floorBrightness+")"))}}const vb=function(n,t,e,i){return{"blinking-animation":n,"no-shadow":t,"is-slope":e,"is-inverse-slope":i}};function ite(n,t){if(1&n&&(J(0,"div",12),At(1,"safe"),oe()),2&n){const e=$e(3);un("background-image",Ft(1,7,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),ie("ngClass",Rr(10,vb,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.LEFT,e.slopeDirection==e.slopeDirectionState.RIGHT))}}function rte(n,t){if(1&n&&(Je(0),Ee(1,ite,2,15,"div",11),et()),2&n){const e=$e(2);j(1),ie("ngIf",e.isVisibleWallTopBottom)}}function ote(n,t){if(1&n&&(J(0,"div",14),At(1,"safe"),oe()),2&n){const e=$e(3);un("background-image",Ft(1,7,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),ie("ngClass",Rr(10,vb,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.LEFT,e.slopeDirection==e.slopeDirectionState.RIGHT))}}function ste(n,t){if(1&n&&(Je(0),Ee(1,ote,2,15,"div",13),et()),2&n){const e=$e(2);j(1),ie("ngIf",e.isVisibleWallTopBottom)}}function ate(n,t){if(1&n&&(J(0,"div",16),At(1,"safe"),oe()),2&n){const e=$e(3);un("background-image",Ft(1,7,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),ie("ngClass",Rr(10,vb,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.BOTTOM,e.slopeDirection==e.slopeDirectionState.TOP))}}function lte(n,t){if(1&n&&(Je(0),Ee(1,ate,2,15,"div",15),et()),2&n){const e=$e(2);j(1),ie("ngIf",e.isVisibleWallLeftRight)}}function cte(n,t){if(1&n&&(J(0,"div",18),At(1,"safe"),oe()),2&n){const e=$e(3);un("background-image",Ft(1,7,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),ie("ngClass",Rr(10,vb,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.BOTTOM,e.slopeDirection==e.slopeDirectionState.TOP))}}function ute(n,t){if(1&n&&(Je(0),Ee(1,cte,2,15,"div",17),et()),2&n){const e=$e(2);j(1),ie("ngIf",e.isVisibleWallLeftRight)}}function dte(n,t){if(1&n&&(Je(0),Ee(1,rte,2,1,"ng-container",3),Ee(2,ste,2,1,"ng-container",3),Ee(3,lte,2,1,"ng-container",3),Ee(4,ute,2,1,"ng-container",3),et()),2&n){const e=$e();j(1),ie("ngIf",e.slopeDirection!=e.slopeDirectionState.TOP),j(1),ie("ngIf",e.slopeDirection!=e.slopeDirectionState.BOTTOM),j(1),ie("ngIf",e.slopeDirection!=e.slopeDirectionState.LEFT),j(1),ie("ngIf",e.slopeDirection!=e.slopeDirectionState.RIGHT)}}function fte(n,t){1&n&&(Je(0),it(1,"div",19),J(2,"div",20)(3,"i",21),we(4,"autorenew"),oe()(),J(5,"div",22)(6,"i",21),we(7,"autorenew"),oe()(),J(8,"div",23)(9,"i",21),we(10,"autorenew"),oe()(),J(11,"div",24)(12,"i",21),we(13,"autorenew"),oe()(),et())}const KP=function(n){return{transform:n}};function hte(n,t){if(1&n&&(J(0,"div",25)(1,"div",26),we(2),oe(),J(3,"div",27),we(4),oe()()),2&n){const e=$e();un("height",e.math.abs(e.terreinAltitude*e.gridSize),"px"),ie("ngStyle",Nt(5,KP,"translateX("+e.width*e.gridSize/2+"px) translateY("+-e.depth*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.terreinAltitude>0?-(e.altitude+(e.isSlope||e.isWallExist?0:e.height))*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),j(2),xt(e.math.abs(e.terreinAltitude)),j(2),xt(e.math.abs(e.terreinAltitude))}}const pte=function(n){return{"is-grab":n}},gte=function(n,t){return{"upright-transform":n,fall:t}};let _te=(()=>{class n{constructor(e,i,r,o,s,a,g,w,W,ve){this.ngZone=e,this.imageService=i,this.tabletopActionService=r,this.contextMenuService=o,this.elementRef=s,this.panelService=a,this.changeDetector=g,this.pointerDeviceService=w,this.coordinateService=W,this.tabletopService=ve,this.terrain=null,this.is3D=!1,this.gridSize=50,this.movableOption={},this.rotableOption={},this.math=Math,this.slopeDirectionState=Gi,this.input=null,this.viewRotateZ=10}get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get name(){return this.terrain.name}get mode(){return this.terrain.mode}set mode(e){this.terrain.mode=e}get isLocked(){return this.terrain.isLocked}set isLocked(e){this.terrain.isLocked=e}get hasWall(){return this.terrain.hasWall}get hasFloor(){return this.terrain.hasFloor}get wallImage(){return this.imageService.getSkeletonOr(this.terrain.wallImage)}get floorImage(){return this.imageService.getSkeletonOr(this.terrain.floorImage)}get height(){return this.adjustMinBounds(this.terrain.height)}get width(){return this.adjustMinBounds(this.terrain.width)}get depth(){return this.adjustMinBounds(this.terrain.depth)}get altitude(){return this.terrain.altitude}set altitude(e){this.terrain.altitude=e}get isDropShadow(){return this.terrain.isDropShadow}set isDropShadow(e){this.terrain.isDropShadow=e}get isSurfaceShading(){return this.terrain.isSurfaceShading}set isSurfaceShading(e){this.terrain.isSurfaceShading=e}get isSlope(){return this.terrain.isSlope}set isSlope(e){this.terrain.isSlope=e,e||(this.terrain.slopeDirection=Gi.NONE)}get slopeDirection(){return this.terrain.isSlope?this.terrain.isSlope&&this.terrain.slopeDirection===Gi.NONE?Gi.BOTTOM:this.terrain.slopeDirection:Gi.NONE}set slopeDirection(e){this.terrain.isSlope=e!=Gi.NONE,this.terrain.slopeDirection=e}get isAltitudeIndicate(){return this.terrain.isAltitudeIndicate}set isAltitudeIndicate(e){this.terrain.isAltitudeIndicate=e}get isVisibleFloor(){return 0<this.width*this.depth}get isVisibleWallTopBottom(){return 0<this.width*this.height}get isVisibleWallLeftRight(){return 0<this.depth*this.height}get roomGridDispAlways(){let e=Xe.instance.get("Config");return!!e&&e.roomGridDispAlways}set roomGridDispAlways(e){let i=Xe.instance.get("Config");i&&(i.roomGridDispAlways=e)}get isWallExist(){return this.hasWall&&this.wallImage&&this.wallImage.url&&this.wallImage.url.length>0}get terreinAltitude(){let e=this.altitude;return(this.altitude<0||!this.isSlope&&!this.isWallExist)&&(e+=this.height),e}ngOnInit(){Qe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Xe.instance.get(e.data.identifier);!this.terrain||!i||((this.terrain===i||i instanceof Si&&this.terrain.contains(i))&&this.changeDetector.markForCheck(),(e.data.identifier===this.currentTable.identifier||e.data.identifier===this.tableSelecter.identifier||e.data.identifier===this.terrain.identifier)&&this.setGameTableGrid(this.width,this.depth,this.gridSize,this.currentTable.gridType,this.currentTable.gridColor))}).on("DISP_TERRAIN_GRID",e=>{let i=0;this.terrain.isGrid&&(i=1),this.gridCanvas.nativeElement.style.opacity=i+""}).on("DISP_TERRAIN_GRID_END",e=>{let i=0;this.terrain.isGrid&&(this.roomGridDispAlways&&(i=1),this.tableSelecter.gridShow&&(i=1)),this.gridCanvas.nativeElement.style.opacity=i+""}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.terrain,colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.terrain}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new fa(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this),this.setGameTableGrid(this.width,this.depth,this.gridSize,this.currentTable.gridType,this.currentTable.gridColor)}ngOnDestroy(){this.input.destroy(),Qe.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLocked&&Qe.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate();this.contextMenuService.open(i,[{name:"\u9ad8\u5ea6\u8a2d\u5b9a",action:null,subActions:[{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,$t.play(dt.sweep))},altitudeHande:this.terrain},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1,$t.play(dt.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0,$t.play(dt.sweep),Qe.trigger("UPDATE_INVENTORY",null)}},this.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!1,$t.play(dt.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!0,$t.play(dt.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}]},xi,this.isLocked?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLocked=!1,$t.play(dt.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLocked=!0,$t.play(dt.lock)}},xi,{name:"\u50be\u659c",action:null,subActions:[{name:(this.slopeDirection==Gi.NONE?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.slopeDirection=Gi.NONE}},xi,{name:(this.slopeDirection==Gi.TOP?"\u25c9":"\u25cb")+" \u4e0a\uff08\u5317\uff09",action:()=>{this.slopeDirection=Gi.TOP}},{name:(this.slopeDirection==Gi.BOTTOM?"\u25c9":"\u25cb")+" \u4e0b\uff08\u5357\uff09",action:()=>{this.slopeDirection=Gi.BOTTOM}},{name:(this.slopeDirection==Gi.LEFT?"\u25c9":"\u25cb")+" \u5de6\uff08\u897f\uff09",action:()=>{this.slopeDirection=Gi.LEFT}},{name:(this.slopeDirection==Gi.RIGHT?"\u25c9":"\u25cb")+" \u53f3\uff08\u6771\uff09",action:()=>{this.slopeDirection=Gi.RIGHT}}]},this.hasWall?{name:"\u58c1\u3092\u975e\u8868\u793a",action:()=>{this.mode=md.FLOOR,this.depth*this.width==0&&(this.terrain.width=this.width<=0?1:this.width,this.terrain.depth=this.depth<=0?1:this.depth)}}:{name:"\u58c1\u3092\u8868\u793a",action:()=>{this.mode=md.ALL}},this.isSurfaceShading?{name:"\u58c1\u306b\u9670\u5f71\u3092\u4ed8\u3051\u306a\u3044",action:()=>{this.isSurfaceShading=!1,$t.play(dt.sweep)}}:{name:"\u58c1\u306b\u9670\u5f71\u3092\u4ed8\u3051\u308b",action:()=>{this.isSurfaceShading=!0,$t.play(dt.sweep)}},this.isDropShadow?{name:"\u5f71\u3092\u975e\u8868\u793a",action:()=>{this.isDropShadow=!1,$t.play(dt.sweep)}}:{name:"\u5f71\u3092\u8868\u793a",action:()=>{this.isDropShadow=!0,$t.play(dt.sweep)}},xi,{name:"\u5730\u5f62\u8a2d\u5b9a\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.terrain)}},{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let o=this.terrain.clone();o.location.x+=this.gridSize,o.location.y+=this.gridSize,o.isLocked=!1,this.terrain.parent&&this.terrain.parent.appendChild(o),$t.play(dt.blockPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.terrain.destroy(),$t.play(dt.sweep)}},xi,{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}],this.name)}onMove(){$t.play(dt.blockPick)}onMoved(){$t.play(dt.blockPut)}get floorModCss(){let e="",i=0;switch(this.slopeDirection){case Gi.TOP:i=Math.atan(this.height/this.depth),e=" rotateX("+i+"rad) scaleY("+1/Math.cos(i)+")";break;case Gi.BOTTOM:i=Math.atan(this.height/this.depth),e=" rotateX("+-i+"rad) scaleY("+1/Math.cos(i)+")";break;case Gi.LEFT:i=Math.atan(this.height/this.width),e=" rotateY("+-i+"rad) scaleX("+1/Math.cos(i)+")";break;case Gi.RIGHT:i=Math.atan(this.height/this.width),e=" rotateY("+i+"rad) scaleX("+1/Math.cos(i)+")"}return e}get floorBrightness(){let e=1;if(!this.isSurfaceShading)return e;switch(this.slopeDirection){case Gi.TOP:e=.4;break;case Gi.BOTTOM:e=1;break;case Gi.LEFT:e=.6;break;case Gi.RIGHT:e=.9}return e}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5730\u5f62\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(wl,{title:r,left:i.x-250,top:i.y-150,width:600,height:300}).tabletopObject=e}setGameTableGrid(e,i,r=50,o=bs.SQUARE,s="#000000e6"){new WP(this.gridCanvas.nativeElement).render(e,i,r,o,s,!0,this.terrain.location.y-i/2,this.terrain.location.x-e/2);let W=0;setTimeout(()=>{this.terrain.isGrid&&(this.roomGridDispAlways&&(W=1),this.tableSelecter.gridShow&&(W=1)),this.gridCanvas.nativeElement.style.opacity=W+""},0)}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(Op),Be(Ym),Be(To),Be(fi),Be($n),Be(bi),Be(Di),Be($d),Be(Wm))},n.\u0275cmp=Qt({type:n,selectors:[["terrain"]],viewQuery:function(e,i){if(1&e&&Gn(Jee,7),2&e){let r;yn(r=Cn())&&(i.gridCanvas=r.first)}},hostBindings:function(e,i){1&e&&Re("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{terrain:"terrain",is3D:"is3D"},decls:11,vars:29,consts:[["appMovable","",1,"dummy-will-change",3,"movable.option"],["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"ngClass","rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],[4,"ngIf"],[1,"is-3d","texture",2,"z-index","1",3,"ngClass","ngStyle"],[1,"grid-canvas","is-fill",3,"ngStyle"],["gridCanvas",""],["class","is-3d","style","display:flex; align-items: center; border-left: 2px dashed blanchedalmond; position: absolute; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],["style","opacity: 0.7; filter: brightness(0) blur(1px); transform: translateZ(0.3px) scale(0.98); backface-visibility: visible ","class","is-3d texture chrome-smooth-image-trick",3,"ngClass","background-image",4,"ngIf"],[1,"is-3d","texture","chrome-smooth-image-trick",2,"opacity","0.7","filter","brightness(0) blur(1px)","transform","translateZ(0.3px) scale(0.98)","backface-visibility","visible",3,"ngClass"],[1,"is-3d","texture","chrome-smooth-image-trick",3,"ngClass","ngStyle"],["class","is-3d texture of-wall-top chrome-smooth-image-trick","style","transform: translateY(-100%) rotateX(90deg) rotateZ(180deg) scaleX(-1.0)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-top","chrome-smooth-image-trick",2,"transform","translateY(-100%) rotateX(90deg) rotateZ(180deg) scaleX(-1.0)",3,"ngClass"],["class","is-3d texture of-wall-bottom chrome-smooth-image-trick","style","transform: rotateX(-90deg)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-bottom","chrome-smooth-image-trick",2,"transform","rotateX(-90deg)",3,"ngClass"],["class","is-3d texture of-wall-left chrome-smooth-image-trick","style","transform: rotateZ(90deg) rotateX(-90deg) scaleX(-1.0) translateX(-100%) translateY(-100%)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-left","chrome-smooth-image-trick",2,"transform","rotateZ(90deg) rotateX(-90deg) scaleX(-1.0) translateX(-100%) translateY(-100%)",3,"ngClass"],["class","is-3d texture of-wall-right chrome-smooth-image-trick","style","transform: rotateZ(-90deg) rotateX(-90deg) translateY(-100%)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-right","chrome-smooth-image-trick",2,"transform","rotateZ(-90deg) rotateX(-90deg) translateY(-100%)",3,"ngClass"],[1,"pedestal-grab","rotate-grab","is-3d","will-change"],[1,"rotate-grab","of-left-top","rotate-grab-icon","is-3d","will-change"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","rotate-grab-icon","is-3d","will-change"],[1,"rotate-grab","of-right-bottom","rotate-grab-icon","is-3d","will-change"],[1,"rotate-grab","of-right-top","rotate-grab-icon","is-3d","will-change"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","position","absolute","transform-origin","top left",3,"ngStyle"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(it(0,"div",0),J(1,"div",1),Re("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),J(2,"div",2),Re("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Ee(3,tte,2,1,"ng-container",3),J(4,"div",4),Ee(5,nte,3,13,"ng-container",3),it(6,"canvas",5,6),Ee(8,dte,5,4,"ng-container",3),Ee(9,fte,14,0,"ng-container",3),oe()(),Ee(10,hte,5,7,"div",7),oe()),2&e&&(ie("movable.option",i.movableOption),j(1),un("width",i.width*i.gridSize,"px")("height",i.depth*i.gridSize,"px"),ie("movable.option",i.movableOption)("movable.disable",i.isLocked),j(1),ie("ngClass",Nt(18,pte,!i.isLocked))("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),j(1),ie("ngIf",i.hasFloor&&i.isVisibleFloor&&0<(null==i.floorImage?null:i.floorImage.url.length)),j(1),ie("ngClass",hi(20,gte,i.height<.5&&0==i.altitude,i.height>=.5&&0==i.altitude))("ngStyle",Nt(23,KP,"translateZ("+i.altitude*i.gridSize+"px)")),j(1),ie("ngIf",i.hasFloor&&i.isVisibleFloor&&0<(null==i.floorImage?null:i.floorImage.url.length)),j(1),ie("ngStyle",Wo(25,YP,i.isSlope?"visible":"hidden","translateZ("+i.height/(i.isSlope?2:1)*i.gridSize+"px)"+i.floorModCss,"brightness("+i.floorBrightness+")")),j(2),ie("ngIf",i.hasWall&&0<(null==i.wallImage?null:i.wallImage.url.length)),j(1),ie("ngIf",!i.isLocked),j(1),ie("ngIf",i.isAltitudeIndicate&&!((i.isSlope||i.isWallExist)&&-i.height<i.altitude&&i.altitude<0)&&(i.terreinAltitude<=-.5||.5<=i.terreinAltitude)))},directives:[bd,Uf,ir,Sn,Co],pipes:[Ii],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.will-change[_ngcontent-%COMP%]{will-change:opacity}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.dummy-will-change[_ngcontent-%COMP%]{position:absolute;height:1px;width:1px;will-change:opacity}.component-content[_ngcontent-%COMP%]{height:100%;width:100%}.texture[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;background-repeat:no-repeat;background-size:100% 100%;height:100%;width:100%}.of-wall-top[_ngcontent-%COMP%]{top:0px;left:0px;transform-origin:50% 100%;transform:translateY(-100%) rotateX(90deg) rotate(180deg) scaleX(-1);filter:brightness(.3)}.of-wall-bottom[_ngcontent-%COMP%]{bottom:0px;left:0px;transform-origin:50% 100%;transform:rotateX(-90deg)}.of-wall-left[_ngcontent-%COMP%]{top:0px;left:0px;transform-origin:0% 0%;transform:rotate(90deg) rotateX(-90deg) scaleX(-1) translate(-100%) translateY(-100%);filter:brightness(.5)}.of-wall-right[_ngcontent-%COMP%]{top:0px;right:0px;transform-origin:100% 0%;transform:rotate(-90deg) rotateX(-90deg) translateY(-100%);filter:brightness(.8)}.of-wall-top.is-slope[_ngcontent-%COMP%], .of-wall-bottom.is-slope[_ngcontent-%COMP%], .of-wall-left.is-slope[_ngcontent-%COMP%], .of-wall-right.is-slope[_ngcontent-%COMP%]{clip-path:polygon(100% 0%,0% 100%,100% 100%)}.of-wall-top.is-inverse-slope[_ngcontent-%COMP%], .of-wall-bottom.is-inverse-slope[_ngcontent-%COMP%], .of-wall-left.is-inverse-slope[_ngcontent-%COMP%], .of-wall-right.is-inverse-slope[_ngcontent-%COMP%]{clip-path:polygon(0% 0%,100% 100%,0% 100%)}.of-wall-top.no-shadow[_ngcontent-%COMP%], .of-wall-left.no-shadow[_ngcontent-%COMP%], .of-wall-right.no-shadow[_ngcontent-%COMP%]{filter:brightness(1)}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;position:absolute;top:-14px;left:-14px;right:-14px;bottom:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.rotate-grab[_ngcontent-%COMP%]{opacity:0;z-index:-1}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;border:solid 2px #CCCCCC;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:0;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;transform-style:preserve-3d;transform:translateZ(.1px)}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px;border-radius:14px 7px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px;border-radius:7px 14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px;border-radius:14px 7px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px;border-radius:7px 14px}.blinking-animation[_ngcontent-%COMP%]{animation:blink 1s linear infinite alternate}@keyframes blink{0%{opacity:.9}to{opacity:.5}}.grid-canvas[_ngcontent-%COMP%]{opacity:0;transform:translateZ(.15px);transition:.3s ease-out;-webkit-backface-visibility:hidden;backface-visibility:hidden}.is-fill[_ngcontent-%COMP%]{display:block;position:absolute;top:0;left:0;bottom:0;right:0;margin:auto}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.upright-transform[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}"],changeDetection:0}),n})();var mte=Ce(7489);function $te(n,t){if(1&n&&(it(0,"img",11),At(1,"safe")),2&n){const e=$e();un("mix-blend-mode",1==e.blendType?null:"hard-light"),ie("src",Ft(1,3,e.imageFile.url,"resourceUrl"),hn)}}function vte(n,t){if(1&n&&(bu(),Je(0),it(1,"rect",16)(2,"rect",17),et()),2&n){const e=$e().$implicit,i=$e(2);j(1),Yt("x",e.x*i.gridSize+5)("y",e.y*i.gridSize+5)("width",i.gridSize-10)("height",i.gridSize-10),j(1),Yt("x",e.x*i.gridSize+5)("y",e.y*i.gridSize+5)("width",i.gridSize-10)("height",i.gridSize-10)}}function bte(n,t){if(1&n&&(bu(),Je(0),it(1,"line",18)(2,"line",18)(3,"line",19)(4,"line",19),et()),2&n){const e=$e().$implicit,i=$e(2);j(1),Yt("x1",e.x*i.gridSize+5)("y1",e.y*i.gridSize+5)("x2",e.x*i.gridSize+(i.gridSize-5))("y2",e.y*i.gridSize+(i.gridSize-5)),j(1),Yt("x1",e.x*i.gridSize+(i.gridSize-5))("y1",e.y*i.gridSize+5)("x2",e.x*i.gridSize+5)("y2",e.y*i.gridSize+(i.gridSize-5)),j(1),Yt("x1",e.x*i.gridSize+5)("y1",e.y*i.gridSize+5)("x2",e.x*i.gridSize+(i.gridSize-5))("y2",e.y*i.gridSize+(i.gridSize-5)),j(1),Yt("x1",e.x*i.gridSize+(i.gridSize-5))("y1",e.y*i.gridSize+5)("x2",e.x*i.gridSize+5)("y2",e.y*i.gridSize+(i.gridSize-5))}}function yte(n,t){if(1&n&&(bu(),Je(0),it(1,"rect",20)(2,"line",18)(3,"line",18)(4,"rect",21)(5,"line",22)(6,"line",22),et()),2&n){const e=$e().$implicit,i=$e(2);j(1),Yt("x",e.x*i.gridSize+5)("y",e.y*i.gridSize+5)("width",i.gridSize-10)("height",i.gridSize-10),j(1),Yt("x1",e.x*i.gridSize+15)("y1",e.y*i.gridSize+25)("x2",e.x*i.gridSize+35)("y2",e.y*i.gridSize+25),j(1),Yt("x1",e.x*i.gridSize+25)("y1",e.y*i.gridSize+15)("x2",e.x*i.gridSize+25)("y2",e.y*i.gridSize+35),j(1),Yt("x",e.x*i.gridSize+5)("y",e.y*i.gridSize+5)("width",i.gridSize-10)("height",i.gridSize-10),j(1),Yt("x1",e.x*i.gridSize+15)("y1",e.y*i.gridSize+25)("x2",e.x*i.gridSize+35)("y2",e.y*i.gridSize+25),j(1),Yt("x1",e.x*i.gridSize+25)("y1",e.y*i.gridSize+15)("x2",e.x*i.gridSize+25)("y2",e.y*i.gridSize+35)}}function Cte(n,t){if(1&n&&(bu(),J(0,"g")(1,"desc"),we(2),oe(),Je(3,14),Ee(4,vte,3,8,"ng-container",15),Ee(5,bte,5,16,"ng-container",15),Ee(6,yte,7,24,"ng-container",15),et(),oe()),2&n){const e=t.$implicit,i=$e(2);un("transform-origin",(e.x+.5)*i.gridSize+"px "+(e.y+.5)*i.gridSize+"px"),ie("@rotateInOut",e.state),j(2),xt(e.state),j(1),ie("ngSwitch",e.state),j(1),ie("ngSwitchCase","scrached"),j(1),ie("ngSwitchCase","scraching"),j(1),ie("ngSwitchCase","restore")}}function xte(n,t){if(1&n&&(bu(),J(0,"svg",null,12),Ee(2,Cte,7,8,"g",13),oe()),2&n){const e=$e();ie("@fadeInOut",void 0),Yt("width",e.width*e.gridSize)("height",e.height*e.gridSize)("viewBox","0, 0, "+e.width*e.gridSize+", "+e.height*e.gridSize),j(2),ie("ngForOf",e.scratchingGridInfos)("ngForTrackBy",e.identify)}}function wte(n,t){1&n&&(J(0,"div",25)(1,"i",26),we(2,"lock"),oe()())}function Ete(n,t){if(1&n&&(J(0,"div",23),Ee(1,wte,3,0,"div",24),oe()),2&n){const e=$e();j(1),ie("ngIf",e.isLock&&e.dispLockMark)}}function Tte(n,t){if(1&n){const e=pt();J(0,"button",32),Re("pointerdown",function(r){return Le(e),$e(2).prevent(r)})("mousedown",function(r){return Le(e),$e(2).prevent(r)})("click",function(r){return Le(e),$e(2).scratchDone(r)}),J(1,"i",33),we(2,"done"),oe()()}2&n&&ie("title",$e(2).gameTableMask.scratchingGrids?"\u78ba\u5b9a":"\u7d42\u4e86")}function Ste(n,t){if(1&n){const e=pt();J(0,"button",34),Re("pointerdown",function(r){return Le(e),$e(2).prevent(r)})("mousedown",function(r){return Le(e),$e(2).prevent(r)})("click",function(r){return Le(e),$e(2).scratchCancel(r)}),J(1,"i",33),we(2,"clear"),oe()()}}const Dte=function(n){return{"background-color":n}},Ite=function(n){return{"is-inverse":n}};function kte(n,t){if(1&n&&(J(0,"div",27)(1,"div",28)(2,"span",29)(3,"b"),we(4),oe(),we(5," \u304c\u64cd\u4f5c\u4e2d "),Ee(6,Tte,3,1,"button",30),Ee(7,Ste,3,0,"button",31),oe()()()),2&n){const e=$e();j(1),ie("ngStyle",Nt(5,Dte,e.ownerColor+"E6")),j(1),ie("ngClass",Nt(7,Ite,e.isInverse)),j(2),xt(e.ownerName),j(2),ie("ngIf",e.gameTableMask.isMine),j(1),ie("ngIf",e.gameTableMask.isMine)}}const Mte=function(n){return{transform:n}};function Ate(n,t){if(1&n&&(J(0,"div",35)(1,"div",36)(2,"span",37),we(3),oe(),J(4,"span",38),we(5),oe()()()),2&n){const e=$e();un("height",e.math.abs(e.gameTableMaskAltitude*e.gridSize),"px"),ie("ngStyle",Nt(5,Mte,"translateX("+e.width*e.gridSize/2+"px) translateY("+-e.height*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),j(3),xt(e.math.abs(e.gameTableMaskAltitude)),j(2),xt(e.gameTableMaskAltitude)}}const Pte=function(n,t){return{"is-grab":n,"is-scratching":t,"is-border":!0}},Fte=function(n){return{fall:n}},Rte=function(n){return{transform:n}},Nte=function(n,t,e,i){return{opacity:n,"background-color":t,"-webkit-mask":e,mask:i}},Ote=function(n){return{image:n}};let Bte=(()=>{class n{constructor(e,i,r,o,s,a,g,w,W){this.ngZone=e,this.tabletopActionService=i,this.contextMenuService=r,this.elementRef=o,this.panelService=s,this.changeDetector=a,this.pointerDeviceService=g,this.modalService=w,this.coordinateService=W,this.gameTableMask=null,this.is3D=!1,this.gridSize=50,this.math=Math,this.viewRotateZ=10,this.movableOption={},this.input=null,this._scratchingGridX=-1,this._scratchingGridY=-1}get dispLockMark(){return this.gameTableMask.dispLockMark}set dispLockMark(e){this.gameTableMask.dispLockMark=e}get name(){return this.gameTableMask.name}get width(){return this.adjustMinBounds(this.gameTableMask.width)}get height(){return this.adjustMinBounds(this.gameTableMask.height)}get opacity(){return this.gameTableMask.opacity}get imageFile(){return this.gameTableMask.imageFile}get isLock(){return this.gameTableMask.isLock}set isLock(e){this.gameTableMask.isLock=e}get color(){return this.gameTableMask.color}set color(e){this.gameTableMask.color=e}get bgcolor(){return this.gameTableMask.bgcolor}set bgcolor(e){this.gameTableMask.bgcolor=e}get isPreview(){return this.gameTableMask.isPreview}set isPreview(e){this.gameTableMask.isPreview=e}get isPreviewMode(){return!!this.gameTableMask&&this.isPreview&&this.gameTableMask.isMine}get gameTableMaskAltitude(){return+this.altitude.toFixed(1)}get scratchedGrids(){return this.gameTableMask.scratchedGrids}set scratchedGrids(e){this.gameTableMask.scratchedGrids=e}get scratchingGrids(){return this.gameTableMask.scratchingGrids}set scratchingGrids(e){this.gameTableMask.scratchingGrids=e}get isNonScratched(){return!this.gameTableMask.scratchedGrids}get isNonScratching(){return!(this.gameTableMask.scratchingGrids||this._currentScratchingSet)}get masksCss(){if(!this.isPreviewMode&&this.isNonScratched)return"";const e=[],i=new Set(this.scratchedGrids.split(/,/g)),r=this._currentScratchingSet?this._currentScratchingSet:new Set(this.scratchingGrids.split(/,/g));for(let o=0;o<this.width;o++)for(let s=0;s<this.height;s++){const a=`${o}:${s}`;if(this.isPreviewMode){if(i.has(a)&&!r.has(a)||r.has(a)&&!i.has(a))continue}else if(i.has(a))continue;e.push(`radial-gradient(#000, #000) ${o*this.gridSize-1}px ${s*this.gridSize-1}px / ${this.gridSize+2}px ${this.gridSize+2}px no-repeat`)}return e.length?e.join(","):"radial-gradient(#000, #000) 0px 0px / 0px 0px no-repeat"}get scratchingGridInfos(){console.log("scratchingGridInfos");const e=[];if(!this.gameTableMask||this.isNonScratching&&this.isNonScratched)return e;const i=this._currentScratchingSet?this._currentScratchingSet:new Set(this.scratchingGrids.split(/,/g)),r=new Set(this.scratchedGrids.split(/,/g));for(let o=0;o<Math.ceil(this.width);o++)for(let s=0;s<Math.ceil(this.height);s++){const a=`${o}:${s}`;(i.has(a)||r.has(a))&&e.push({x:o,y:s,state:i.has(a)?r.has(a)?"restore":"scraching":"scrached"})}return e}get operateOpacity(){const e=this.opacity*(this.gameTableMask.isMine?.6:1);return e<.4&&this.isScratching?.4:e}get altitude(){return this.gameTableMask.altitude}set altitude(e){this.gameTableMask.altitude=e}get isAltitudeIndicate(){return this.gameTableMask.isAltitudeIndicate}set isAltitudeIndicate(e){this.gameTableMask.isAltitudeIndicate=e}get isScratching(){return!!this.gameTableMask.owner}get hasOwner(){return this.gameTableMask.hasOwner}get ownerIsOnline(){return this.gameTableMask.ownerIsOnline}get ownerName(){return this.gameTableMask.ownerName}get ownerColor(){return this.gameTableMask.ownerColor}ngOnChanges(){var e,i,r;Qe.unregister(this),Qe.register(this).on(`UPDATE_GAME_OBJECT/identifier/${null===(e=this.gameTableMask)||void 0===e?void 0:e.identifier}`,o=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${null===(i=this.gameTableMask)||void 0===i?void 0:i.identifier}`,o=>{this.changeDetector.markForCheck()}).on("CHANGE_GM_MODE",o=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",o=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",o=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,o=>{this.ngZone.run(()=>{this.viewRotateZ=o.data.z,this.changeDetector.markForCheck()})}).on(`UPDATE_SELECTION/identifier/${null===(r=this.gameTableMask)||void 0===r?void 0:r.identifier}`,o=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.gameTableMask,transformCssOffset:"translateZ(0.10px)",colideLayers:["terrain"]},this.panelId=fd.generateUuid()}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new fa(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this)}ngOnDestroy(){this.input.destroy(),Qe.unregister(this),clearTimeout(this._scratchingTimerId)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.isScratching&&this.gameTableMask.isMine?!window.PointerEvent&&e.button<2&&e.buttons<2&&this.scratching(!0):this.input.cancel(),(this.isLock&&!this.isScratching||this.isScratching&&!this.gameTableMask.isMine)&&Qe.trigger("DRAG_LOCKED_OBJECT",{srcEvent:e})}onInputStartPointer(e){!this.isScratching||!this.gameTableMask.isMine||e.button<2&&e.buttons<2&&this.scratching(!0,{offsetX:e.offsetX,offsetY:e.offsetY})}onInputMove(e){!window.PointerEvent&&this.isScratching&&this.gameTableMask.isMine&&this.input.isDragging&&this.scratching(!1)}onInputMovePointer(e){this.isScratching&&this.gameTableMask.isMine&&this.input.isDragging&&e.buttons<2&&this.scratching(!1,{offsetX:e.offsetX,offsetY:e.offsetY}),this.isScratching&&this.gameTableMask.isMine&&console.log("onInputMovePointer"),e.stopPropagation(),e.preventDefault()}scratching(e,i=null){if(!this.gameTableMask.isMine)return;const r=da.instance;let o,s;if(console.log("tableSelecter.gridShow"),r.gridShow||(r.viewTable.gridClipRect={top:0,right:0,bottom:0,left:0}),i)o=i.offsetX,s=i.offsetY;else{const W=this.coordinateService.calcTabletopLocalCoordinate(this.pointerDeviceService.pointers[0],this.elementRef.nativeElement);o=W.x-this.gameTableMask.location.x,s=W.y-this.gameTableMask.location.y}if(o<0||this.gameTableMask.width*this.gridSize<=o||s<0||this.gameTableMask.height*this.gridSize<=s)return;const a=Math.floor(o/this.gridSize),g=Math.floor(s/this.gridSize);if(!e&&this._scratchingGridX===a&&this._scratchingGridY===g)return;const w=`${a}:${g}`;this._scratchingGridX=a,this._scratchingGridY=g,this._currentScratchingSet||(this._currentScratchingSet=new Set(this.scratchingGrids.split(/,/g))),this._currentScratchingSet.has(w)?this._currentScratchingSet.delete(w):this._currentScratchingSet.add(w),clearTimeout(this._scratchingTimerId),this._scratchingTimerId=setTimeout(()=>{this.scratchingGrids=Array.from(this._currentScratchingSet).filter(W=>W&&/^\d+:\d+$/.test(W)).sort().join(","),this._currentScratchingSet=null},250)}scratched(){const e=this.scratchedGrids.split(/,/g);this._currentScratchingSet&&(clearTimeout(this._scratchingTimerId),this.scratchingGrids=Array.from(this._currentScratchingSet).filter(r=>r&&/^\d+:\d+$/.test(r)).sort().join(","),this._currentScratchingSet=null);const i=this.scratchingGrids.split(/,/g);this.scratchedGrids=(0,mte.xor)(e,i).filter(r=>r&&/^\d+:\d+$/.test(r)).sort().join(",")}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate(),o=[];o.push({name:"\u9ad8\u5ea6\u8a2d\u5b9a",action:null,subActions:[{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,$t.play(dt.sweep))},altitudeHande:this.gameTableMask},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1,$t.play(dt.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0,$t.play(dt.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}]},xi,this.isLock?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLock=!1,this.dispLockMark=!0,$t.play(dt.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLock=!0,$t.play(dt.lock)}}),this.isLock&&o.push(this.dispLockMark?{name:"\u56fa\u5b9a\u30de\u30fc\u30af\u6d88\u53bb",action:()=>{this.dispLockMark=!1,$t.play(dt.lock)}}:{name:"\u56fa\u5b9a\u30de\u30fc\u30af\u8868\u793a",action:()=>{this.dispLockMark=!0,$t.play(dt.lock)}}),o.push(this.gameTableMask.isMine?{name:"\u30b9\u30af\u30e9\u30c3\u30c1\u78ba\u5b9a",action:()=>{this.scratchDone(),this.isPreview=!1,this.gameTableMask.owner=""}}:{name:"\u30b9\u30af\u30e9\u30c3\u30c1\u958b\u59cb",action:()=>{""!=this.gameTableMask.owner&&(this.isPreview=!1,clearTimeout(this._scratchingTimerId),this._currentScratchingSet=null),$t.play(dt.cardDraw),this.gameTableMask.owner=bt.peerContext.userId,this._scratchingGridX=-1,this._scratchingGridY=-1,$t.play(dt.lock)}}),this.gameTableMask.isMine&&o.push({name:"\u30b9\u30af\u30e9\u30c3\u30c1\u30ad\u30e3\u30f3\u30bb\u30eb",action:()=>{$t.play(dt.cardDraw),this.gameTableMask.owner=""}}),o.push(xi),o.push({name:"\u30de\u30b9\u30af\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.gameTableMask)}}),o.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let s=this.gameTableMask.clone();console.log("\u30b3\u30d4\u30fc",s),s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.isLock=!1,this.gameTableMask.parent&&this.gameTableMask.parent.appendChild(s),$t.play(dt.cardPut)}}),o.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.gameTableMask.destroy(),$t.play(dt.sweep)}}),o.push(xi),o.push({name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}),this.contextMenuService.open(i,o,this.name)}onMove(){$t.play(dt.cardPick)}onMoved(){$t.play(dt.cardPut)}scratchDone(e=null){return e&&(e.preventDefault(),e.stopPropagation()),this.gameTableMask.isMine&&(this.ngZone.run(()=>{this.scratched(),this.gameTableMask.owner="",this.scratchingGrids="",this.isPreview=!1}),this._scratchingGridX=-1,this._scratchingGridY=-1,$t.play(dt.cardPut)),!1}scratchCancel(e=null){return e&&(e.preventDefault(),e.stopPropagation()),!this.gameTableMask.isMine&&this.ownerIsOnline||(this.ngZone.run(()=>{this.gameTableMask.owner="",this.scratchingGrids="",this.isPreview=!1}),this._scratchingGridX=-1,this._scratchingGridY=-1,$t.play(dt.unlock)),!1}prevent(e){e.preventDefault(),e.stopPropagation()}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30de\u30c3\u30d7\u30de\u30b9\u30af\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(wl,{title:r,left:i.x-200,top:i.y-150,width:400,height:300}).tabletopObject=e}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(Ym),Be(To),Be(fi),Be($n),Be(bi),Be(Di),Be(pi),Be($d))},n.\u0275cmp=Qt({type:n,selectors:[["game-table-mask"]],hostBindings:function(e,i){1&e&&Re("dragstart",function(o){return i.onDragstart(o)})("pointerdown",function(o){return i.onInputStartPointer(o)})("pointermove",function(o){return i.onInputMovePointer(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{gameTableMask:"gameTableMask",is3D:"is3D"},features:[br],decls:11,vars:31,consts:[["appMovable","",1,"dummy-will-change",3,"movable.option"],["appMovable","",1,"component","is-3d",2,"pointer-events","none",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],[1,"is-fit-full","is-3d",2,"pointer-events","none",3,"ngClass","ngStyle"],[1,"is-fit-full","is-3d"],[1,"is-fit-full","is-3d","chrome-smooth-image-trick",2,"pointer-events","auto","position","absolute","backface-visibility","hidden",3,"ngStyle","ngClass"],["class","is-fit-full is-3d chrome-smooth-image-trick","style","pointer-events: none; position: absolute;",3,"mix-blend-mode","src",4,"ngIf"],[1,"is-fit-full","is-3d","scratching-area","border",2,"pointer-events","none","backface-visibility","hidden"],[4,"ngIf"],["style","pointer-events: none; z-index: 10; backface-visibility: hidden",4,"ngIf"],["class","scratching is-center is-3d","style","pointer-events: none; z-index: 10; top: -10px; left: 1px; backface-visibility: hidden",4,"ngIf"],["class","is-3d","style","display: flex; align-items: center; border-left: 2px dashed blanchedalmond; transform-origin: top left; pointer-events: none",3,"height","ngStyle",4,"ngIf"],[1,"is-fit-full","is-3d","chrome-smooth-image-trick",2,"pointer-events","none","position","absolute",3,"src"],["elementToDetach",""],[3,"transform-origin",4,"ngFor","ngForOf","ngForTrackBy"],[3,"ngSwitch"],[4,"ngSwitchCase"],["fill","none","stroke","#22222288","stroke-width","5","stroke-linejoin","round"],["fill","none","stroke","#ff3e3e","stroke-width","4","stroke-linejoin","round"],["stroke","#22222288","stroke-width","6","stroke-linecap","round"],["stroke","#ff3e3e","stroke-width","4","stroke-linecap","round"],["fill","none","stroke","#22222288","stroke-width","6","stroke-linejoin","round"],["fill","none","stroke","#8098ff","stroke-width","4","stroke-linejoin","round"],["stroke","#8098ff","stroke-width","4","stroke-linecap","round"],[2,"pointer-events","none","z-index","10","backface-visibility","hidden"],["class","lock-icon is-center is-3d",4,"ngIf"],[1,"lock-icon","is-center","is-3d"],[1,"material-icons",2,"pointer-events","none","backface-visibility","hidden"],[1,"scratching","is-center","is-3d",2,"pointer-events","none","z-index","10","top","-10px","left","1px","backface-visibility","hidden"],[1,"name-tag","has-length-limit","is-nowrap","is-black-background",2,"color","whitesmoke",3,"ngStyle"],[2,"display","inline-block",3,"ngClass"],["class","edit-button",3,"title","pointerdown","mousedown","click",4,"ngIf"],["class","edit-button","title","\u30ad\u30e3\u30f3\u30bb\u30eb",3,"pointerdown","mousedown","click",4,"ngIf"],[1,"edit-button",3,"title","pointerdown","mousedown","click"],[1,"material-icons","small-font"],["title","\u30ad\u30e3\u30f3\u30bb\u30eb",1,"edit-button",3,"pointerdown","mousedown","click"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","transform-origin","top left","pointer-events","none",3,"ngStyle"],[1,"is-3d",2,"pointer-events","none"],[1,"altitude-indicator","is-3d",2,"position","absolute","pointer-events","none"],[1,"altitude-indicator","is-3d",2,"position","absolute","pointer-events","none","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(it(0,"div",0),J(1,"div",1),Re("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),J(2,"div",2)(3,"div",3)(4,"div",4),Ee(5,$te,2,6,"img",5),oe(),J(6,"div",6),Ee(7,xte,3,6,"svg",7),oe()(),Ee(8,Ete,2,1,"div",8),Ee(9,kte,8,9,"div",9),oe(),Ee(10,Ate,6,7,"div",10),oe()),2&e&&(ie("movable.option",i.movableOption),j(1),un("width",i.width*i.gridSize,"px")("height",i.height*i.gridSize,"px"),ie("ngClass",hi(17,Pte,!i.isLock&&!i.isScratching,i.isScratching&&i.gameTableMask.isMine))("movable.option",i.movableOption)("movable.disable",i.isLock||i.isScratching),j(1),ie("ngClass",Nt(20,Fte,0==i.altitude))("ngStyle",Nt(22,Rte,"translateZ("+i.altitude*i.gridSize+"px)")),j(2),ie("ngStyle",Rr(24,Nte,i.operateOpacity,i.imageFile.url.length<1?i.bgcolor:null,i.masksCss,i.masksCss))("ngClass",Nt(29,Ote,i.imageFile.url.length>=1)),j(1),ie("ngIf",i.imageFile.url.length>=1),j(2),ie("ngIf",i.isScratching),j(1),ie("ngIf",1),j(1),ie("ngIf",i.isScratching&&i.ownerIsOnline),j(1),ie("ngIf",i.isAltitudeIndicate&&i.math.abs(i.gameTableMaskAltitude)>=.5))},directives:[bd,ir,Co,Sn,si,tc,Wu],pipes:[Ii],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-scratching[_ngcontent-%COMP%]{cursor:pointer}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.image[_ngcontent-%COMP%]{display:block;box-sizing:border-box}.lock-icon[_ngcontent-%COMP%], .draw-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px}.lock-icon[_ngcontent-%COMP%], .scratching[_ngcontent-%COMP%], .draw-icon[_ngcontent-%COMP%]{visibility:visible}.component[_ngcontent-%COMP%]:hover   .scratching.is-mine[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .scratching.is-mine[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:hover   .draw-icon.is-mine[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .draw-icon.is-mine[_ngcontent-%COMP%]{visibility:hidden}.is-center[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;margin:auto}.image.border[_ngcontent-%COMP%]{border-width:0px}.component[_ngcontent-%COMP%]:hover   .border[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .border[_ngcontent-%COMP%], .is-border[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{outline:2px solid #CCC!important;outline-offset:-2px}.is-fit-full[_ngcontent-%COMP%]{height:100%;width:100%}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.fall[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.text[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.is-inverse[_ngcontent-%COMP%]{transform:rotate(180deg)}.scratching-area[_ngcontent-%COMP%]{overflow:hidden}.name-tag[_ngcontent-%COMP%]{font-size:15px;padding:3px 9px;border-radius:24px;pointer-events:none;display:inline-block}.component[_ngcontent-%COMP%]:hover   .is-mine[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .is-mine[_ngcontent-%COMP%]{visibility:hidden}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.name-tag[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px;display:inline-block;position:relative;vertical-align:text-bottom}.small-font[_ngcontent-%COMP%]{font-size:14px;vertical-align:bottom}.edit-button[_ngcontent-%COMP%]{padding:0 4px;vertical-align:10%;margin:0 1px 0 0;pointer-events:auto}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;background-color:#80d4ff99;top:0;left:0;right:0;bottom:0}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}"],data:{animation:[Na("fadeInOut",[Lr("void => *",[Br("132ms ease-out",Ls([mn({opacity:0,offset:0}),mn({opacity:1,offset:1})]))]),Lr("* => void",[Br("132ms ease-in",Ls([mn({opacity:1,offset:0}),mn({opacity:0,offset:1})]))])]),Na("rotateInOut",[Lr("scrached<=>restore",[Br("132ms ease-in-out",Ls([mn({transform:"rotateY(0deg)",offset:0}),mn({transform:"rotateY(-90deg)",offset:1})]))])])]},changeDetection:0}),n})();const Lte=["textArea"];function zte(n,t){1&n&&(J(0,"div",13)(1,"i",14),we(2,"lock"),oe()())}function Hte(n,t){if(1&n&&(J(0,"div",11),we(1),Ee(2,zte,3,0,"div",12),oe()),2&n){const e=$e();j(1),sn(" ",e.title," "),j(1),ie("ngIf",e.isLock)}}const XP=function(n){return{transform:n}};function Vte(n,t){if(1&n&&(Je(0),J(1,"div",15)(2,"div",16)(3,"i",17),we(4,"autorenew"),oe()(),J(5,"div",18)(6,"i",17),we(7,"autorenew"),oe()()(),et()),2&n){const e=$e();j(1),ie("ngStyle",Nt(1,XP,"translateZ("+e.altitude*e.gridSize+"px)"))}}const Ute=function(n){return{transform:n}};function jte(n,t){if(1&n&&(J(0,"div",19)(1,"div",20)(2,"span",21),we(3),oe(),J(4,"span",22),we(5),oe()()()),2&n){const e=$e();un("height",e.math.abs(e.textNoteAltitude*e.gridSize),"px"),ie("ngStyle",Nt(5,Ute,"rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),j(3),xt(e.math.abs(e.textNoteAltitude)),j(2),xt(e.textNoteAltitude)}}const Gte=function(n,t){return{"is-transition":n,fall:t}};let qte=(()=>{class n{constructor(e,i,r,o,s,a){this.ngZone=e,this.contextMenuService=i,this.elementRef=r,this.panelService=o,this.changeDetector=s,this.pointerDeviceService=a,this.textNote=null,this.is3D=!1,this.oldText="",this.oldFontSize=9,this.callbackOnMouseUp=g=>this.onMouseUp(g),this.gridSize=50,this.math=Math,this._transitionTimeout=null,this._transition=!1,this._fallTimeout=null,this._fall=!1,this.calcFitHeightTimer=null,this.movableOption={},this.rotableOption={},this.input=null,this.viewRotateZ=10,this.oldScrollHeight=0,this.oldOffsetHeight=0}get title(){return this.textNote.title}get isLock(){return this.textNote.isLock}set isLock(e){this.textNote.isLock=e}get text(){return console.log("get text"),this.oldText!=this.textNote.text&&this.calcFitHeightIfNeeded(),this.textNote.text}set text(e){console.log("set text"),this.calcFitHeightIfNeeded(),this.textNote.text=e,this.oldText=e}get fontSize(){return console.log("get fontSize"),this.oldFontSize!=this.textNote.fontSize&&this.calcFitHeightIfNeeded(),this.oldFontSize=this.textNote.fontSize,this.textNote.fontSize}get imageFile(){return this.textNote.imageFile}get rotate(){return this.textNote.rotate}set rotate(e){this.textNote.rotate=e}get height(){return this.adjustMinBounds(this.textNote.height)}get width(){return this.adjustMinBounds(this.textNote.width)}get altitude(){return this.textNote.altitude}set altitude(e){this.textNote.altitude=e}get textNoteAltitude(){let e=this.altitude;if(this.isUpright&&this.altitude<0){if(-this.height<=this.altitude)return 0;e+=this.height}return+e.toFixed(1)}get isUpright(){return this.textNote.isUpright}set isUpright(e){this.textNote.isUpright=e}get isAltitudeIndicate(){return this.textNote.isAltitudeIndicate}set isAltitudeIndicate(e){this.textNote.isAltitudeIndicate=e}get isSelected(){return document.activeElement===this.textAreaElementRef.nativeElement}get transition(){return this._transition}set transition(e){this._transition=e,this._transitionTimeout&&clearTimeout(this._transitionTimeout),this._transitionTimeout=e?setTimeout(()=>{this._transition=!1},132):null}get fall(){return this._fall}set fall(e){this._fall=e,this._fallTimeout&&clearTimeout(this._fallTimeout),this._fallTimeout=e?setTimeout(()=>{this._fall=!1},132):null}ngOnInit(){Qe.register(this).on("RESIZE_NOTE_OBJECT",-1e3,e=>{console.log("resize");let i=Xe.instance.get(e.data.identifier);!this.textNote||!i||this.textNote===i&&this.calcFitHeight()}).on("UPDATE_GAME_OBJECT",-1e3,e=>{let i=Xe.instance.get(e.data.identifier);!this.textNote||!i||(this.textNote===i||i instanceof Si&&this.textNote.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.textNote,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.textNote}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new fa(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this._transitionTimeout&&clearTimeout(this._transitionTimeout),this._fallTimeout&&clearTimeout(this._fallTimeout),Qe.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onMouseDown(e){if(console.log("e.id onMouseDown:"+e.target.id),!this.isSelected){if(e.preventDefault(),this.textNote.toTopmost(),2===e.button)return void Qe.trigger("DRAG_LOCKED_OBJECT",{});this.addMouseEventListeners()}}onMouseUp(e){if(console.log("e.id onMouseUp:"+e.target.id),this.pointerDeviceService.isAllowedToOpenContextMenu){console.log("TEST");let i=window.getSelection();i.isCollapsed||i.removeAllRanges(),this.textAreaElementRef.nativeElement.focus()}this.removeMouseEventListeners(),e.preventDefault()}onRotateMouseDown(e){console.log("e.id onRotateMouseDown:"+e.target.id),e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLock&&Qe.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){this.removeMouseEventListeners(),!this.isSelected&&(e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu)&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:"\u9ad8\u5ea6\u8a2d\u5b9a",action:null,subActions:[{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,$t.play(dt.sweep))},altitudeHande:this.textNote},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1,$t.play(dt.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0,$t.play(dt.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}]},xi,this.isLock?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLock=!1,$t.play(dt.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLock=!0,$t.play(dt.lock)}},xi,this.isUpright?{name:"\u5bdd\u304b\u305b\u308b",action:()=>{this.transition=!0,this.isUpright=!1,$t.play(dt.sweep)}}:{name:"\u76f4\u7acb\u3055\u305b\u308b",action:()=>{this.transition=!0,this.isUpright=!0,$t.play(dt.sweep)}},xi,{name:"\u30e1\u30e2\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.textNote)}},{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.textNote.clone();console.log("\u30b3\u30d4\u30fc",r),r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.toTopmost(),$t.play(dt.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.textNote.destroy(),$t.play(dt.sweep)}}],this.title)}onMove(){$t.play(dt.cardPick)}onMoved(){$t.play(dt.cardPut)}calcFitHeightIfNeeded(){this.calcFitHeightTimer||this.ngZone.runOutsideAngular(()=>{this.calcFitHeightTimer=setTimeout(()=>{this.calcFitHeight(),this.calcFitHeightTimer=null},0)})}calcFitHeight(){console.log("calcFitHeight");let e=this.textAreaElementRef.nativeElement;if(e.style.height="0",this.textNote.limitHeight){let i=e.scrollHeight,r=this.height*this.gridSize-2;r<this.gridSize&&(r=this.gridSize-2),r-=this.title.length?32:2,i>r&&(i=r),e.style.height=i+"px"}else console.log("textArea.scrollHeight"+e.scrollHeight),console.log("textArea.offsetHeight"+e.offsetHeight),e.scrollHeight>e.offsetHeight&&(console.log("\u66f4\u65b0"),e.style.height=e.scrollHeight+"px",this.oldScrollHeight=e.scrollHeight,this.oldOffsetHeight=e.offsetHeight)}adjustMinBounds(e,i=0){return e<i?i:e}addMouseEventListeners(){document.body.addEventListener("mouseup",this.callbackOnMouseUp,!1)}removeMouseEventListeners(){document.body.removeEventListener("mouseup",this.callbackOnMouseUp,!1)}showDetail(e){Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5171\u6709\u30e1\u30e2\u8a2d\u5b9a";e.title.length&&(r+=" - "+e.title),this.panelService.open(wl,{title:r,left:i.x-350,top:i.y-200,width:700,height:400}).tabletopObject=e}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(To),Be(fi),Be($n),Be(bi),Be(Di))},n.\u0275cmp=Qt({type:n,selectors:[["text-note"]],viewQuery:function(e,i){if(1&e&&Gn(Lte,7),2&e){let r;yn(r=Cn())&&(i.textAreaElementRef=r.first)}},hostBindings:function(e,i){1&e&&Re("dragstart",function(o){return i.onDragstart(o)})("mousedown",function(o){return i.onMouseDown(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{textNote:"textNote",is3D:"is3D"},decls:12,vars:28,consts:[["appMovable","",1,"dummy-will-change",3,"movable.option"],["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.ondragstart","movable.ondragend"],["appRotable","",1,"is-3d",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"component-content","is-3d","is-pointer-events-auto"],[1,"is-3d",3,"ngClass","ngStyle"],[1,"upright-transform","is-3d","is-bg-color","is-bg-texture","chrome-smooth-image-trick"],["class","title is-black-background is-pointer-events-none",4,"ngIf"],["spellcheck","false","id","text-area",1,"textarea","is-caret",2,"overflow","hidden auto",3,"ngModel","input","ngModelChange"],["textArea",""],[4,"ngIf"],["class","is-3d","style","display: flex; align-items: center; border-left: 2px dashed blanchedalmond; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],[1,"title","is-black-background","is-pointer-events-none"],["class","lock-icon is-right",4,"ngIf"],[1,"lock-icon","is-right"],[1,"material-icons",2,"display","inline"],[3,"ngStyle"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-right-top"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","transform-origin","top left",3,"ngStyle"],[1,"is-3d"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(it(0,"div",0),J(1,"div",1),Re("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),J(2,"div",2),Re("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),J(3,"div",3)(4,"div",4)(5,"div",5),At(6,"safe"),Ee(7,Hte,3,2,"div",6),J(8,"textarea",7,8),Re("input",function(){return i.calcFitHeight()})("ngModelChange",function(o){return i.text=o}),oe()()(),Ee(10,Vte,8,3,"ng-container",9),oe()(),Ee(11,jte,6,7,"div",10),oe()),2&e&&(ie("movable.option",i.movableOption),j(1),ie("movable.option",i.movableOption)("movable.disable",i.isSelected),j(1),ie("rotable.option",i.rotableOption),j(1),un("width",i.width*i.gridSize,"px"),j(1),ie("ngClass",hi(23,Gte,i.transition,i.fall))("ngStyle",Nt(26,XP,"translateZ("+i.altitude*i.gridSize+"px) rotateY(90deg) rotateZ("+(i.isUpright?0:90)+"deg) rotateY(-90deg)")),j(1),un("background-image",Ft(6,20,"url("+(null==i.imageFile?null:i.imageFile.url)+")","style"))("width",i.width*i.gridSize,"px")("min-height",i.height*i.gridSize,"px"),j(2),ie("ngIf",i.title.length),j(1),un("font-size",i.fontSize+9,"px"),ie("ngModel",i.text),j(2),ie("ngIf",!i.isLock),j(1),ie("ngIf",i.isAltitudeIndicate&&i.math.abs(i.textNoteAltitude)>=.5))},directives:[bd,Uf,ir,Co,Sn,Fi,Ti,yi],pipes:[Ii],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;width:1px;height:0}.dummy-will-change[_ngcontent-%COMP%]{position:absolute;height:1px;width:1px;will-change:opacity}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;transform:translate(-50%)}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform-origin:50% 100%;transform:rotateX(-90deg)}.is-bg-texture[_ngcontent-%COMP%]{background-repeat:no-repeat;background-size:100% 100%}.is-bg-color[_ngcontent-%COMP%]{box-sizing:border-box;color:#444;background-color:#f0dabde6;border:solid 1px #999}.title[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;-webkit-backface-visibility:hidden;backface-visibility:hidden}.lock-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px}.is-right[_ngcontent-%COMP%]{position:absolute;top:0px;right:0;margin:auto}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;resize:none;overflow:hidden;box-sizing:border-box;background:none;border:none;border-radius:0;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1rem;padding:2px;margin:0;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;-webkit-backface-visibility:hidden;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]:focus{background:rgba(255,255,255,.75)}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.is-outline-text[_ngcontent-%COMP%]{font-size:24px;color:#444;text-shadow:#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px}.lock-icon-mark[_ngcontent-%COMP%]{position:absolute;width:42px;height:28px;box-sizing:border-box;z-index:1;text-align:center;padding:2px;background-color:#1e1e1ecc;border-radius:28px;color:#ccc;font-size:8px}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:42px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;text-align:center;padding:2px;background-color:#ccc;border-radius:28px;color:#444;font-size:8px}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-21px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-21px}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"],changeDetection:0}),n})();const Wte=["draggablePanel"];function Zte(n,t){1&n&&pn(0)}function Yte(n,t){1&n&&pn(0)}const QP=function(n){return{card:n}};function Kte(n,t){if(1&n&&(Je(0),Ee(1,Yte,1,0,"ng-container",13),et()),2&n){const e=$e(),i=ln(13);j(1),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",Nt(2,QP,e.tabletopObject))}}function Xte(n,t){1&n&&pn(0)}function Qte(n,t){if(1&n&&(Je(0),Ee(1,Xte,1,0,"ng-container",13),et()),2&n){const e=$e(),i=ln(13);j(1),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",Nt(2,QP,e.tabletopObject))}}function Jte(n,t){1&n&&pn(0)}const ene=function(n){return{note:n}};function tne(n,t){if(1&n&&(Je(0),Ee(1,Jte,1,0,"ng-container",13),et()),2&n){const e=$e(),i=ln(15);j(1),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",Nt(2,ene,e.tabletopObject))}}function nne(n,t){1&n&&pn(0)}const JP=function(n){return{character:n}};function ine(n,t){if(1&n&&(Je(0),Ee(1,nne,1,0,"ng-container",13),et()),2&n){const e=$e(),i=ln(17);j(1),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",Nt(2,JP,e.tabletopObject))}}function rne(n,t){1&n&&pn(0)}const one=function(n){return{dice:n}};function sne(n,t){if(1&n&&(Je(0),Ee(1,rne,1,0,"ng-container",13),et()),2&n){const e=$e(),i=ln(19);j(1),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",Nt(2,one,e.tabletopObject))}}function ane(n,t){1&n&&pn(0)}const lne=function(n){return{range:n}};function cne(n,t){if(1&n&&(Je(0),Ee(1,ane,1,0,"ng-container",13),et()),2&n){const e=$e(),i=ln(21);j(1),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",Nt(2,lne,e.tabletopObject))}}function une(n,t){1&n&&pn(0)}function dne(n,t){if(1&n&&(Je(0),Ee(1,une,1,0,"ng-container",13),et()),2&n){const e=$e(),i=ln(17);j(1),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",Nt(2,JP,e.tabletopObject))}}function fne(n,t){1&n&&pn(0)}function hne(n,t){if(1&n&&(Je(0),Ee(1,fne,1,0,"ng-container",14),et()),2&n){$e();const e=ln(25);j(1),ie("ngTemplateOutlet",e)}}function pne(n,t){if(1&n&&(J(0,"div",25)(1,"div",26),we(2),oe()()),2&n){const e=$e(2).card;j(2),xt(e.ownerName)}}function gne(n,t){if(1&n){const e=pt();J(0,"div",20),it(1,"img",21),At(2,"safe"),J(3,"button",22),Re("click",function(){return Le(e),$e(2).chanageImageView(!0)}),J(4,"i",23),we(5,"zoom_in"),oe()(),Ee(6,pne,3,1,"div",24),oe()}if(2&n){const e=$e().card,i=$e();j(1),ie("src",Ft(2,2,i.imageUrl,"resourceUrl"),hn),j(5),ie("ngIf",e.hasOwner&&0<e.ownerName.length)}}function _ne(n,t){if(1&n&&(Je(0),we(1),et()),2&n){const e=$e(2).card;j(1),xt(e.name)}}function mne(n,t){1&n&&(Je(0),we(1,"\u30ab\u30fc\u30c9"),et())}const $ne=function(n){return{"with-button-marign":n}},eF=function(n){return{width:n}};function vne(n,t){if(1&n&&(J(0,"div",27),Ee(1,_ne,2,1,"ng-container",5),Ee(2,mne,2,0,"ng-container",5),oe()),2&n){const e=$e().card,i=$e();ie("ngClass",Nt(4,$ne,i.hasImage))("ngStyle",Nt(6,eF,i.overViewCardWidthNoMargin+"px")),j(1),ie("ngIf",null==e.isVisible||e.isVisible),j(1),ie("ngIf",null!=e.isVisible&&!e.isVisible)}}function bne(n,t){1&n&&pn(0)}const Km=function(n){return{dataElm:n}};function yne(n,t){if(1&n&&(Je(0),Ee(1,bne,1,0,"ng-container",13),et()),2&n){const e=t.$implicit;$e(3);const i=ln(23);j(1),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",Nt(2,Km,e))}}const Xm=function(n,t){return{width:n,"max-height":t}};function Cne(n,t){if(1&n&&(J(0,"div",28)(1,"div",29),Ee(2,yne,2,4,"ng-container",30),oe()()),2&n){const e=$e(2);ie("ngStyle",hi(2,Xm,e.overViewCardWidth+"px",e.overViewCardMaxHeight+"px")),j(2),ie("ngForOf",e.dataElms)}}const Us=function(n,t){return{"is-pointer-events-auto":n,"pointer-events-none":t}};function xne(n,t){if(1&n&&(J(0,"div",15),Ee(1,gne,7,5,"div",16),Ee(2,vne,3,8,"div",17),J(3,"div",18),Ee(4,Cne,3,5,"div",19),oe()()),2&n){const e=t.card,i=$e();ie("ngClass",hi(6,Us,!i.isPointerDragging,i.isPointerDragging))("ngStyle",Nt(9,eF,i.overViewCardWidth+"px")),j(1),ie("ngIf",i.hasImage),j(1),ie("ngIf",0<(null==e||null==e.name?null:e.name.length)),j(1),ie("ngStyle",hi(11,Xm,i.overViewCardWidth+"px",i.overViewCardMaxHeight+"px")),j(1),ie("ngIf",i.hasDataElms&&e.isVisible)}}const wne=function(n,t){return{"max-width":n,width:t}},Ene=function(n){return{"max-width":n}};function Tne(n,t){if(1&n){const e=pt();J(0,"div",31)(1,"div",32),we(2),oe(),J(3,"div",33)(4,"div",34)(5,"div",35)(6,"textarea",36),Re("ngModelChange",function(r){return Le(e).note.text=r}),oe()(),J(7,"div",37),we(8),oe()()()()}if(2&n){const e=t.note,i=$e();ie("ngStyle",hi(7,wne,"1000px",i.overViewNoteWidth+"px"))("ngClass",hi(10,Us,!i.isPointerDragging,i.isPointerDragging)),j(1),ie("ngStyle",Nt(13,Ene,"1000px")),j(1),xt(e.title),j(1),ie("ngStyle",hi(15,Xm,i.overViewNoteWidth+"px",i.overViewNoteMaxHeight+"px")),j(3),ie("ngModel",e.text),j(2),xt(e.text)}}function Sne(n,t){if(1&n&&(J(0,"div",44),it(1,"img",45),At(2,"safe"),oe()),2&n){const e=$e(2);ie("ngClass",hi(5,Us,!e.isPointerDragging,e.isPointerDragging)),j(1),ie("src",Ft(2,2,e.imageUrl,"resourceUrl"),hn)}}function Dne(n,t){1&n&&pn(0)}function Ine(n,t){if(1&n&&(Je(0),J(1,"div",29),Ee(2,Dne,1,0,"ng-container",13),oe(),et()),2&n){const e=$e().$implicit;$e(3);const i=ln(23);j(2),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",Nt(2,Km,e))}}function kne(n,t){if(1&n&&(Je(0),Ee(1,Ine,3,4,"ng-container",5),et()),2&n){const e=t.$implicit,i=$e(3);j(1),ie("ngIf",e&&e.name!==i.newLineString)}}function Mne(n,t){if(1&n&&(J(0,"div",28),Ee(1,kne,2,1,"ng-container",30),oe()),2&n){const e=$e(2);ie("ngStyle",hi(2,Xm,e.overViewCharacterWidth+"px",e.overViewCharacterMaxHeight+"px")),j(1),ie("ngForOf",e.inventoryDataElms)}}function Ane(n,t){if(1&n&&(J(0,"div",38),it(1,"div",39),Ee(2,Sne,3,8,"div",40),J(3,"div",41),we(4),oe(),it(5,"div",42),J(6,"div",43),Ee(7,Mne,2,5,"div",19),oe()()),2&n){const e=t.character,i=$e();j(1),ie("ngClass",hi(6,Us,!i.isPointerDragging,i.isPointerDragging)),j(1),ie("ngIf",i.hasImage),j(1),ie("ngClass",hi(9,Us,!i.isPointerDragging,i.isPointerDragging)),j(1),xt(e.name),j(2),ie("ngClass",hi(12,Us,!i.isPointerDragging,i.isPointerDragging)),j(1),ie("ngIf",i.hasDataElms)}}function Pne(n,t){if(1&n&&(Je(0),we(1),et()),2&n){const e=$e().dice;j(1),xt(e.face)}}function Fne(n,t){1&n&&(Je(0),we(1,"???"),et())}function Rne(n,t){if(1&n&&(J(0,"div",48)(1,"div",26),we(2),oe()()),2&n){const e=$e().dice,i=$e();ie("ngClass",hi(2,Us,!i.isPointerDragging,i.isPointerDragging)),j(2),sn("",e.ownerName," ")}}const Nne=function(n,t){return{"is-black-mask":n,"is-harf-black-mask":t}};function One(n,t){if(1&n&&(J(0,"div",44),it(1,"img",49),At(2,"safe"),oe()),2&n){const e=$e().dice,i=$e();ie("ngClass",hi(6,Us,!i.isPointerDragging,i.isPointerDragging)),j(1),ie("ngClass",hi(9,Nne,!e.isVisible,e.isMine))("src",Ft(2,3,i.imageUrl,"resourceUrl"),hn)}}function Bne(n,t){1&n&&pn(0)}function Lne(n,t){if(1&n&&(Je(0),Ee(1,Bne,1,0,"ng-container",13),et()),2&n){const e=$e().$implicit;$e(3);const i=ln(23);j(1),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",Nt(2,Km,e))}}function zne(n,t){if(1&n&&(Je(0),Ee(1,Lne,2,4,"ng-container",5),et()),2&n){const e=t.$implicit,i=$e(3);j(1),ie("ngIf",e&&e.name!==i.newLineString)}}function Hne(n,t){if(1&n&&(J(0,"div",50)(1,"div",29),Ee(2,zne,2,1,"ng-container",30),oe()()),2&n){const e=$e(2);j(2),ie("ngForOf",e.dataElms)}}function Vne(n,t){if(1&n&&(J(0,"div",38),it(1,"div",39),J(2,"div",41),we(3),Ee(4,Pne,2,1,"ng-container",5),Ee(5,Fne,2,0,"ng-container",5),oe(),Ee(6,Rne,3,5,"div",46),Ee(7,One,3,12,"div",40),it(8,"div",42),J(9,"div",43),Ee(10,Hne,3,1,"div",47),oe()()),2&n){const e=t.dice,i=$e();j(1),ie("ngClass",hi(9,Us,!i.isPointerDragging,i.isPointerDragging)),j(1),ie("ngClass",hi(12,Us,!i.isPointerDragging,i.isPointerDragging)),j(1),sn(" ",e.name,": "),j(1),ie("ngIf",e.isVisible),j(1),ie("ngIf",!e.isVisible),j(1),ie("ngIf",e.hasOwner&&0<e.ownerName.length),j(1),ie("ngIf",i.hasImage),j(2),ie("ngClass",hi(15,Us,!i.isPointerDragging,i.isPointerDragging)),j(1),ie("ngIf",i.hasDataElms&&e.isVisible)}}function Une(n,t){1&n&&pn(0)}function jne(n,t){if(1&n&&(Je(0),J(1,"div",29),Ee(2,Une,1,0,"ng-container",13),oe(),et()),2&n){const e=$e(2).$implicit;$e(3);const i=ln(23);j(2),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",Nt(2,Km,e))}}function Gne(n,t){if(1&n&&(Je(0),Ee(1,jne,3,4,"ng-container",5),et()),2&n){const e=$e().$implicit,i=$e(2).range;j(1),ie("ngIf","CIRCLE"!==i.type&&"SQUARE"!==i.type&&"DIAMOND"!==i.type||"width"!==e.name)}}function qne(n,t){if(1&n&&(Je(0),Ee(1,Gne,2,1,"ng-container",5),et()),2&n){const e=t.$implicit;j(1),ie("ngIf",e&&"name"!==e.name)}}function Wne(n,t){if(1&n&&(J(0,"div",28),Ee(1,qne,2,1,"ng-container",30),oe()),2&n){const e=$e(2);ie("ngStyle",hi(2,Xm,e.overViewCharacterWidth+"px",e.overViewCharacterMaxHeight+"px")),j(1),ie("ngForOf",e.rangeElms)}}function Zne(n,t){if(1&n&&(J(0,"div",38),it(1,"div",39),J(2,"div",41),we(3),oe(),it(4,"div",42),J(5,"div",43),Ee(6,Wne,2,5,"div",19),oe()()),2&n){const e=t.range,i=$e();j(1),ie("ngClass",hi(5,Us,!i.isPointerDragging,i.isPointerDragging)),j(1),ie("ngClass",hi(8,Us,!i.isPointerDragging,i.isPointerDragging)),j(1),xt(e.name),j(2),ie("ngClass",hi(11,Us,!i.isPointerDragging,i.isPointerDragging)),j(1),ie("ngIf",i.hasRangeElms)}}function Yne(n,t){1&n&&pn(0)}function Kne(n,t){if(1&n&&(J(0,"div",57),we(1),oe()),2&n){const e=$e(2).dataElm;j(1),xt(e.name)}}function Xne(n,t){1&n&&pn(0)}function Qne(n,t){if(1&n&&(Je(0),Ee(1,Xne,1,0,"ng-container",13),et()),2&n){const e=t.$implicit;$e(3);const i=ln(23);j(1),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",Nt(2,Km,e))}}function Jne(n,t){if(1&n&&(J(0,"div",54),Ee(1,Kne,2,1,"div",55),J(2,"div",56),Ee(3,Qne,2,4,"ng-container",30),oe()()),2&n){const e=$e().dataElm;j(1),ie("ngIf",0<e.name.trim().length),j(2),ie("ngForOf",e.children)}}const eie=function(){return{stripPrefix:!1}};function tie(n,t){if(1&n){const e=pt();Je(0),J(1,"div",59)(2,"div"),we(3),J(4,"span",60),we(5," \xa0\xa0URL\u7de8\u96c6:"),J(6,"input",61),Re("change",function(){return Le(e),$e(3).changeChk()}),oe()()(),J(7,"div",62)(8,"div",35)(9,"textarea",63),Re("ngModelChange",function(r){return Le(e),$e(2).dataElm.value=r})("focus",function(){Le(e);const r=$e(2).dataElm;return $e().textFocus(r.myIdentifer)}),oe(),it(10,"span",64),At(11,"linky"),oe(),J(12,"div",37),we(13),oe()()(),et()}if(2&n){const e=$e(2).dataElm,i=$e();j(3),sn("",e.name," "),j(1),ie("hidden",!i.isUrlText(e.value)),j(2),Ht("id",e.myIdentifer),j(3),ie("ngModel",e.value)("hidden",!i.isEditUrl(e.myIdentifer)&&i.isUrlText(e.value)),j(1),ie("innerHTML",Ft(11,8,i.escapeHtml(e.value),$r(11,eie)),Lc)("hidden",i.isEditUrl(e.myIdentifer)||!i.isUrlText(e.value)),j(3),xt(e.value)}}function nie(n,t){if(1&n&&(Je(0),J(1,"div",59)(2,"div"),we(3),oe(),J(4,"div",62)(5,"div",35),it(6,"span",65),oe(),it(7,"div",66),oe()(),et()),2&n){const e=$e(2).dataElm,i=$e();j(3),sn("",e.name," "),j(3),ie("innerHTML",i.escapeHtmlMarkDown(e.value,e.myIdentifer),Lc),j(1),ie("innerHTML",i.escapeHtmlMarkDown(e.value,e.myIdentifer),Lc)}}function iie(n,t){if(1&n){const e=pt();J(0,"input",71),Re("click",function(){return Le(e),$e(3).dataElm.value=0}),oe()}}function rie(n,t){if(1&n){const e=pt();J(0,"input",72),Re("click",function(){return Le(e),$e(3).dataElm.value=1}),oe()}}function oie(n,t){if(1&n&&(Je(0),J(1,"div",67),we(2),oe(),J(3,"div",68),Ee(4,iie,1,0,"input",69),Ee(5,rie,1,0,"input",70),oe(),et()),2&n){const e=$e(2).dataElm;j(2),xt(e.name),j(2),ie("ngIf",0!=e.value),j(1),ie("ngIf",0==e.value)}}function sie(n,t){if(1&n){const e=pt();Je(0),J(1,"div",67),we(2),oe(),J(3,"div",68)(4,"div",73)(5,"div",74),we(6),oe(),J(7,"input",75),Re("ngModelChange",function(r){return Le(e),$e(2).dataElm.currentValue=r}),oe()(),J(8,"div",76),we(9),oe()(),J(10,"div",77)(11,"input",78),Re("ngModelChange",function(r){return Le(e),$e(2).dataElm.currentValue=r}),At(12,"safe"),oe()(),et()}if(2&n){const e=$e(2).dataElm;j(2),xt(e.name),j(4),xt(e.currentValue),j(1),Qn("color:"+e.nowValueColor+";"),Ht("step",e.step),ie("ngModel",e.currentValue),j(2),sn(" / ",e.value,""),j(2),Qn(Ft(12,12,"font-size: 0.8em; width: 100%; --min: 0; --max:"+e.value+"; --val:"+e.currentValue+";","style")),Ht("max",e.value),Ht("step",e.step),ie("ngModel",e.currentValue)}}function aie(n,t){if(1&n){const e=pt();Je(0),J(1,"div",67),we(2),oe(),J(3,"div",68)(4,"div",73)(5,"div",79),we(6),oe(),J(7,"input",80),Re("ngModelChange",function(r){return Le(e),$e(2).dataElm.currentValue=r}),oe()(),J(8,"div",76),we(9),oe(),J(10,"div",81)(11,"div",79),we(12),oe(),J(13,"input",80),Re("ngModelChange",function(r){return Le(e),$e(2).dataElm.currentLineValue=r}),oe()(),J(14,"div",76),we(15),oe()(),J(16,"div",77)(17,"input",78),Re("ngModelChange",function(r){return Le(e),$e(2).dataElm.currentValue=r}),At(18,"safe"),oe()(),et()}if(2&n){const e=$e(2).dataElm;j(2),xt(e.name),j(4),xt(e.currentValue),j(1),Qn("color:"+e.nowValueColor+";"),ie("ngModel",e.currentValue),j(2),sn(" / ",e.value,""),j(3),xt(e.currentLineValue),j(1),Qn("color:"+e.nowValueColor+";"),ie("ngModel",e.currentLineValue),j(2),sn(" / ",e.maxLineValue,""),j(2),Qn(Ft(18,16,"font-size: 0.8em; width: 100%; --min: 0; --max:"+e.value+"; --val:"+e.currentValue+";","style")),Ht("max",e.value),Ht("step",e.step),ie("ngModel",e.currentValue)}}function lie(n,t){if(1&n){const e=pt();Je(0),J(1,"div",67),we(2),oe(),J(3,"div",68)(4,"div",79),we(5),oe(),J(6,"input",82),Re("ngModelChange",function(r){return Le(e),$e(2).dataElm.value=r}),oe()(),et()}if(2&n){const e=$e(2).dataElm;j(2),xt(e.name),j(3),xt(e.value),j(1),ie("ngModel",e.value)}}function cie(n,t){1&n&&(Je(0,2),Ee(1,tie,14,12,"ng-container",3),Ee(2,nie,8,3,"ng-container",3),Ee(3,oie,6,3,"ng-container",3),Ee(4,sie,13,15,"ng-container",3),Ee(5,aie,19,19,"ng-container",3),Ee(6,lie,7,3,"ng-container",4),et(),it(7,"div",58)),2&n&&(ie("ngSwitch",$e().dataElm.type),j(1),ie("ngSwitchCase","note"),j(1),ie("ngSwitchCase","markdown"),j(1),ie("ngSwitchCase","check"),j(1),ie("ngSwitchCase","numberResource"),j(1),ie("ngSwitchCase","lineResource"))}function uie(n,t){if(1&n&&(Ee(0,Yne,1,0,"ng-container",51),Ee(1,Jne,4,2,"ng-template",null,52,Ln),Ee(3,cie,8,6,"ng-template",null,53,Ln)),2&n){const e=t.dataElm,i=ln(2),r=ln(4);ie("ngIf",0<e.children.length)("ngIfThen",i)("ngIfElse",r)}}function die(n,t){if(1&n){const e=pt();J(0,"div",83),Re("click",function(){return Le(e),$e().chanageImageView(!1)}),J(1,"div",84)(2,"i",23),we(3,"close"),oe()(),it(4,"img",85),At(5,"safe"),oe()}if(2&n){const e=$e();ie("@fadeInOut","in"),j(4),ie("src",Ft(5,2,e.imageUrl,"resourceUrl"),hn)}}let fie=(()=>{class n{constructor(e,i,r,o){this.inventoryService=e,this.changeDetector=i,this.pointerDeviceService=r,this.domSanitizer=o,this.tabletopObject=null,this.left=0,this.top=0,this.isOpenImageView=!1}get imageUrl(){return this.tabletopObject&&this.tabletopObject.imageFile?this.tabletopObject.imageFile.url:""}get hasImage(){return 0<this.imageUrl.length}get inventoryDataElms(){return this.tabletopObject?this.getInventoryTags(this.tabletopObject):[]}get dataElms(){return this.tabletopObject&&this.tabletopObject.detailDataElement?this.tabletopObject.detailDataElement.children:[]}get hasDataElms(){return 0<this.dataElms.length}get rangeElms(){return this.tabletopObject&&this.tabletopObject.commonDataElement?this.tabletopObject.commonDataElement.children:[]}get hasRangeElms(){return 0<this.rangeElms.length}get newLineString(){return this.inventoryService.newLineString}get isPointerDragging(){return this.pointerDeviceService.isDragging}get pointerEventsStyle(){return{"is-pointer-events-auto":!this.isPointerDragging,"pointer-events-none":this.isPointerDragging}}ngAfterViewInit(){this.initPanelPosition(),setTimeout(()=>{this.adjustPositionRoot()},16),Qe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Xe.instance.get(e.data.identifier);!this.tabletopObject||!i||!(i instanceof Si)||(this.tabletopObject===i||this.tabletopObject.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()})}ngOnDestroy(){Qe.unregister(this)}initPanelPosition(){let e=this.draggablePanel.nativeElement,i=e.offsetWidth,o=this.left+100,s=this.top-e.offsetHeight-50,a=!1;window.innerWidth<o+i&&(o=window.innerWidth-i,a=!0),s<=0&&(s=0),a&&(o=this.left-i-100),o<0&&(o=0),s<0&&(s=0),e.style.left=o+"px",e.style.top=s+"px"}adjustPositionRoot(){let e=this.draggablePanel.nativeElement,i=this.tabletopObject.aliasName,r=250;"card"==i&&(r=this.overViewCardWidth),"card-stack"==i&&(r=this.overViewCardWidth),"text-note"==i&&(r=this.overViewNoteWidth),"character"==i&&(r=this.overViewCharacterWidth);let o=e.getBoundingClientRect(),s=0,a=0,g=Number(o.left),w=Number(o.left)+Number(r);window.innerWidth<w+s&&(s+=window.innerWidth-(w+s)),g+s<0&&(s+=0-(g+s)),window.innerHeight<o.bottom+a&&(a+=window.innerHeight-(o.bottom+a)),o.top+a<0&&(a+=0-(o.top+a)),e.style.left=e.offsetLeft+s+"px",e.style.top=e.offsetTop+a+"px"}chanageImageView(e){this.isOpenImageView=e}getInventoryTags(e){return this.inventoryService.tableInventory.dataElementMap.get(e.identifier)}get overViewNoteWidth(){let e=this.tabletopObject;if(!e)return 250;let i=e.overViewWidth;return i<250&&(i=250),i>800&&(i=800),i}get overViewNoteMaxHeight(){let e=this.tabletopObject;if(!e)return 250;let i=e.overViewMaxHeight;return i<250&&(i=250),i>1e3&&(i=1e3),i}get overViewCharacterWidth(){let e=this.tabletopObject;if(!e)return 270;let i=e.overViewWidth;return i<270&&(i=270),i>800&&(i=800),i}get overViewCharacterMaxHeight(){let e=this.tabletopObject;if(!e)return 250;let i=e.overViewMaxHeight;return i<250&&(i=250),i>1e3&&(i=1e3),i}get overViewCardWidth(){let e=this.tabletopObject,i=this.tabletopObject,r=null;if(console.log("overViewCardWidth"),!e&&!i)return 250;e?(r=e,console.log("card")):i&&(console.log("cardStack"),r=i);let o=r.overViewWidth;return o<250&&(o=250),o>1e3&&(o=1e3),o}get overViewCardWidthNoMargin(){return this.hasImage?this.overViewCardWidth-60-12-2:this.overViewCardWidth-12-2}get overViewCardMaxHeight(){let e=this.tabletopObject,i=this.tabletopObject,r=null;if(!e&&!i)return 250;e?r=e:i&&(r=i);let o=r.overViewMaxHeight;return o<250&&(o=250),o>1e3&&(o=1e3),o}escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}clickMarkDownBox(e){console.log("\u30de\u30fc\u30af\u30c0\u30a6\u30f3\u30af\u30ea\u30c3\u30af:"+e)}get markdown(){return Xe.instance.get("markdwon")}escapeHtmlMarkDown(e,i){let r=this.markdown.markDownCheckBox(e,i),o=this.markdown.markDownTable(r);return this.domSanitizer.bypassSecurityTrustHtml(o.replace(/\n/g,"<br>"))}click(e){this.markdown&&(console.log("event.timeStamp:"+e.timeStamp),this.markdown.changeMarkDownCheckBox(e.target.id,e.timeStamp))}isEditUrl(e){let i=document.getElementById(e);return!!i&&i.checked}isUrlText(e){return!(!e.match(/^https:\/\//)&&!e.match(/^http:\/\//))}changeChk(){}textFocus(e){document.getElementById(e).checked=!0}}return n.\u0275fac=function(e){return new(e||n)(Be(ab),Be(bi),Be(Di),Be(Q1))},n.\u0275cmp=Qt({type:n,selectors:[["overview-panel"]],viewQuery:function(e,i){if(1&e&&Gn(Wte,7),2&e){let r;yn(r=Cn())&&(i.draggablePanel=r.first)}},hostBindings:function(e,i){1&e&&Re("click",function(o){return i.click(o)})},inputs:{tabletopObject:"tabletopObject",left:"left",top:"top"},decls:26,vars:10,consts:[["appDraggable","",1,"component","is-pointer-events-none"],["draggablePanel",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf"],["overviewCard",""],["overviewNote",""],["overviewCharacter",""],["overviewDiceSymbol",""],["overviewRange",""],["dataElement",""],["imageView",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngTemplateOutlet"],[1,"component-content","is-small-size",3,"ngClass","ngStyle"],["style","position: relative;",4,"ngIf"],["class","component-title title-background",3,"ngClass","ngStyle",4,"ngIf"],[1,"component-background",3,"ngStyle"],["class","grid-container-root",3,"ngStyle",4,"ngIf"],[2,"position","relative"],[1,"card-image",3,"src"],[1,"zoom-button",3,"click"],[1,"material-icons"],["class","component-owner position-right-bottom",4,"ngIf"],[1,"component-owner","position-right-bottom"],[1,"owner-tag"],[1,"component-title","title-background",3,"ngClass","ngStyle"],[1,"grid-container-root",3,"ngStyle"],[1,"grid-container"],[4,"ngFor","ngForOf"],[1,"component-content","is-large-size",3,"ngStyle","ngClass"],[1,"component-title","title-background",3,"ngStyle"],[1,"component-background","text-note-container",3,"ngStyle"],[2,"position","relative","width","100%"],[1,"is-fill"],["spellcheck","false",1,"textarea","is-caret",3,"ngModel","ngModelChange"],[1,"textarea-spacer"],[1,"component-content","character-grid-container","is-middle-size"],[1,"title-bg-area","title-background",3,"ngClass"],["class","image-area character-image-box",3,"ngClass",4,"ngIf"],[1,"title-area","component-title",3,"ngClass"],[1,"void-area","is-pointer-events-none"],[1,"dataElm-area","component-background",3,"ngClass"],[1,"image-area","character-image-box",3,"ngClass"],[1,"character-image",3,"src"],["class","owner-name-area component-owner",3,"ngClass",4,"ngIf"],["class","grid-container-root",4,"ngIf"],[1,"owner-name-area","component-owner",3,"ngClass"],[1,"character-image",3,"ngClass","src"],[1,"grid-container-root"],[4,"ngIf","ngIfThen","ngIfElse"],["thenBlock",""],["elseBlock",""],[1,"section",2,"padding-top","0.5em"],["class","section-text",4,"ngIf"],[1,"grid-container","indetnt"],[1,"section-text"],[1,"section","border"],[1,"section"],[3,"hidden"],["type","checkbox",3,"id","change"],[1,"note",2,"position","relative"],["spellcheck","false",1,"textarea",3,"ngModel","hidden","ngModelChange","focus"],[1,"textarea-url",3,"innerHTML","hidden"],[1,"textarea-markdown",3,"innerHTML"],[1,"textarea-spacer",3,"innerHTML"],[1,"tag"],[1,"value"],["type","checkbox","checked","",3,"click",4,"ngIf"],["type","checkbox",3,"click",4,"ngIf"],["type","checkbox","checked","",3,"click"],["type","checkbox",3,"click"],[2,"display","inline-block","width","min-content"],[1,"hidden-spacer",2,"margin-right","2em"],["type","number","size","1",1,"input","is-caret",3,"step","ngModel","ngModelChange"],[2,"display","inline"],[1,"section",2,"line-height","1em"],["type","range","min","0",3,"max","step","ngModel","ngModelChange"],[1,"hidden-spacer"],["type","number","size","1",1,"input","is-caret",3,"ngModel","ngModelChange"],[2,"display","inline-block","width","min-content","margin-left","0.5em"],["size","1",1,"input","is-caret",3,"ngModel","ngModelChange"],[1,"image-view-background","is-fill",3,"click"],[1,"close-button","is-pointer-events-none"],[1,"contain-image",3,"src"]],template:function(e,i){1&e&&(J(0,"div",0,1),Je(2,2),Ee(3,Zte,1,0,"ng-container",3),Ee(4,Kte,2,4,"ng-container",3),Ee(5,Qte,2,4,"ng-container",3),Ee(6,tne,2,4,"ng-container",3),Ee(7,ine,2,4,"ng-container",3),Ee(8,sne,2,4,"ng-container",3),Ee(9,cne,2,4,"ng-container",3),Ee(10,dne,2,4,"ng-container",4),et(),oe(),Ee(11,hne,2,1,"ng-container",5),Ee(12,xne,5,14,"ng-template",null,6,Ln),Ee(14,Tne,9,18,"ng-template",null,7,Ln),Ee(16,Ane,8,15,"ng-template",null,8,Ln),Ee(18,Vne,11,18,"ng-template",null,9,Ln),Ee(20,Zne,7,14,"ng-template",null,10,Ln),Ee(22,uie,5,3,"ng-template",null,11,Ln),Ee(24,die,6,5,"ng-template",null,12,Ln)),2&e&&(ie("@fadeInOut","in"),j(2),ie("ngSwitch",i.tabletopObject.aliasName),j(1),ie("ngSwitchCase","numberResource"),j(1),ie("ngSwitchCase","card"),j(1),ie("ngSwitchCase","card-stack"),j(1),ie("ngSwitchCase","text-note"),j(1),ie("ngSwitchCase","character"),j(1),ie("ngSwitchCase","dice-symbol"),j(1),ie("ngSwitchCase","range"),j(2),ie("ngIf",i.isOpenImageView))},directives:[GP,tc,Wu,Ra,gf,Sn,ir,Co,si,Fi,Ti,yi,ms,oa],pipes:[Ii,Rx],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;max-height:100%;max-width:100%;box-sizing:border-box;overflow:visible;color:#444;z-index:9000;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.component-content[_ngcontent-%COMP%]{font-size:12px}.is-large-size[_ngcontent-%COMP%]{max-width:350px}.is-middle-size[_ngcontent-%COMP%]{max-width:270px}.is-small-size[_ngcontent-%COMP%]{max-width:250px}.is-middle-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:270px}.is-small-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:250px}.component-background[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border-bottom:solid 1px #999}.component-title[_ngcontent-%COMP%]{color:#ccc;font-size:1em;text-align:right;vertical-align:middle;height:32px;line-height:32px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 1em}.title-background[_ngcontent-%COMP%]{background-color:#555;border-top:solid 1px #999;border-left:solid 1px #999;border-right:solid 1px #999}.component-owner[_ngcontent-%COMP%]{font-size:.8em;color:#ccc;vertical-align:middle;overflow:hidden;text-align:right;padding:2px 1em;max-width:100%;box-sizing:border-box}.owner-tag[_ngcontent-%COMP%]{width:min-content;max-width:100%;margin-left:auto;margin-right:0;overflow:hidden;color:#ccc;background-color:#1e1e1ecc;box-sizing:border-box;padding:3px 9px;border-radius:6px;white-space:nowrap;text-overflow:ellipsis}.card-image[_ngcontent-%COMP%]{width:250px;max-height:330px;padding:8px;vertical-align:bottom;object-fit:contain;box-sizing:border-box;background-color:#cccccc80}.zoom-button[_ngcontent-%COMP%]{position:absolute;left:8px;bottom:-21px;width:42px;height:42px;border-radius:100px;padding:4px}.zoom-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:24px;vertical-align:bottom}.position-right-bottom[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0}.image-view-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1e4d;z-index:9900}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{position:absolute;right:16px;top:16px}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:36px}.contain-image[_ngcontent-%COMP%]{width:100%;height:100%;box-sizing:border-box;padding:16px;vertical-align:bottom;object-fit:contain}.text-note-container[_ngcontent-%COMP%]{width:100%;max-height:400px;padding:.6em 1.2em;box-sizing:border-box;overflow:hidden auto;line-height:1.8;border-left:solid 1px #999;border-right:solid 1px #999}.character-image-box[_ngcontent-%COMP%]{width:100px;max-height:120px;overflow:hidden;vertical-align:bottom;margin-left:.5em;margin-bottom:-6px;border-radius:1em;z-index:1}.character-image[_ngcontent-%COMP%]{padding:0;width:100%;vertical-align:bottom}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.character-grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:min-content auto;grid-template-rows:1fr auto auto auto}.title-bg-area[_ngcontent-%COMP%]{grid-area:3 / 1 / 4 / 3}.title-area[_ngcontent-%COMP%]{grid-area:3 / 2 / 4 / 3}.owner-name-area[_ngcontent-%COMP%]{grid-area:2 / 2 / 3 / 3}.image-area[_ngcontent-%COMP%]{grid-area:1 / 1 / 4 / 2}.void-area[_ngcontent-%COMP%]{grid-area:1 / 2 / 3 / 3}.dataElm-area[_ngcontent-%COMP%]{grid-area:4 / 1 / 5 / 3}.grid-container-root[_ngcontent-%COMP%]{padding:.5em 1.2em;max-height:250px;overflow:hidden auto;box-sizing:border-box;border-left:solid 1px #999;border-right:solid 1px #999}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr fit-content(80%)}.grid-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{box-sizing:border-box;line-height:24px}.indetnt[_ngcontent-%COMP%]{padding-left:.5em}.section[_ngcontent-%COMP%]{max-width:100%;grid-column:1 / span 2}.section-text[_ngcontent-%COMP%]{font-size:1.1em;font-weight:700;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.note[_ngcontent-%COMP%]{margin-left:.5em;font-size:1em;line-height:1.8}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box;resize:none;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.textarea[_ngcontent-%COMP%]:hover{background:#EEE}.textarea[_ngcontent-%COMP%]:focus{background:#FFF}.textarea-url[_ngcontent-%COMP%]{width:100%;height:100%;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box;resize:none;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.tag[_ngcontent-%COMP%]{padding-right:1em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.value[_ngcontent-%COMP%]{font-size:1.2em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;text-align:right}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0px;min-width:3em;overflow:hidden;white-space:pre-wrap}.textarea-spacer[_ngcontent-%COMP%]{visibility:hidden;min-width:3em;height:auto;min-height:24px;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.input[_ngcontent-%COMP%]{width:100%;min-width:3em;text-align:right;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#EEE}.input[_ngcontent-%COMP%]:focus{background:#FFF}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}.border[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.separator[_ngcontent-%COMP%]{padding:2px 0;border-bottom:1px solid #888}.with-button-marign[_ngcontent-%COMP%]{padding-left:60px}.is-fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0}.is-bold[_ngcontent-%COMP%]{font-weight:700}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"],data:{animation:[Na("fadeInOut",[Lr("void => *",[Br("100ms ease-out",Ls([mn({opacity:0,offset:0}),mn({opacity:1,offset:1})]))]),Lr("* => void",[Br("100ms ease-in",Ls([mn({opacity:1,offset:0}),mn({opacity:0,offset:1})]))])])]},changeDetection:0}),n})(),qw=(()=>{class n{constructor(e,i,r,o){this.ngZone=e,this.viewContainerRef=i,this.componentFactoryResolver=r,this.pointerDeviceService=o,this.callbackOnMouseEnter=s=>this.onMouseEnter(s),this.callbackOnMouseLeave=s=>this.onMouseLeave(s),this.callbackOnMouseDown=s=>this.onMouseDown(s)}ngOnInit(){}ngAfterViewInit(){this.addEventListeners(this.viewContainerRef.element.nativeElement)}ngOnDestroy(){this.removeEventListeners(this.viewContainerRef.element.nativeElement),this.clearTimer(),this.close()}onMouseEnter(e){this.clearTimer(),this.tooltipComponentRef||this.startOpenTimer()}onMouseLeave(e){this.clearTimer(),this.tooltipComponentRef&&this.startCloseTimer()}onMouseDown(e){!this.tooltipComponentRef||!this.tooltipComponentRef.location.nativeElement.contains(e.target)&&!this.viewContainerRef.element.nativeElement.contains(e.target)&&this.ngZone.run(()=>this.closeAll())}startOpenTimer(){let e=this.pointerDeviceService.pointerX,i=this.pointerDeviceService.pointerY;this.openTooltipTimer=setTimeout(()=>{this.openTooltipTimer=null,4<(e-this.pointerDeviceService.pointerX)**2+(i-this.pointerDeviceService.pointerY)**2?this.startOpenTimer():this.ngZone.run(()=>this.open())},100)}startCloseTimer(){this.closeTooltipTimer=setTimeout(()=>{this.closeTooltipTimer=null,this.tooltipComponentRef&&this.tooltipComponentRef.location.nativeElement.contains(document.activeElement)?this.startCloseTimer():this.ngZone.run(()=>this.closeAll())},400)}clearTimer(){this.closeTooltipTimer&&clearTimeout(this.closeTooltipTimer),this.openTooltipTimer&&clearTimeout(this.openTooltipTimer),this.closeTooltipTimer=this.openTooltipTimer=null}open(){if(this.closeAll(),this.pointerDeviceService.isDragging)return;let e=To.defaultParentViewContainerRef;const i=e.injector,r=this.componentFactoryResolver.resolveComponentFactory(fie);this.tooltipComponentRef=e.createComponent(r,e.length,i),this.tooltipComponentRef.instance.tabletopObject=this.tabletopObject,this.tooltipComponentRef.instance.left=this.pointerDeviceService.pointerX,this.tooltipComponentRef.instance.top=this.pointerDeviceService.pointerY,this.addEventListeners(this.tooltipComponentRef.location.nativeElement),this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.addEventListener("mousedown",this.callbackOnMouseDown,!0)}),Qe.register(this).on("DELETE_GAME_OBJECT",o=>{this.tabletopObject&&this.tabletopObject.identifier===o.data.identifier&&this.closeAll()}),this.tooltipComponentRef.onDestroy(()=>{this.removeEventListeners(this.tooltipComponentRef.location.nativeElement),document.body.removeEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.removeEventListener("mousedown",this.callbackOnMouseDown,!0),this.clearTimer(),this.tooltipComponentRef=null,Qe.unregister(this)}),n.activeTooltips.push(this.tooltipComponentRef)}close(){if(!this.tooltipComponentRef)return;let e=n.activeTooltips.indexOf(this.tooltipComponentRef);0<=e&&n.activeTooltips.splice(e,1),this.tooltipComponentRef.destroy(),this.tooltipComponentRef=null}closeAll(){n.activeTooltips.forEach(e=>e.destroy()),n.activeTooltips=[],this.close()}addEventListeners(e){this.ngZone.runOutsideAngular(()=>{e.addEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.addEventListener("mouseleave",this.callbackOnMouseLeave,!1)})}removeEventListeners(e){e.removeEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.removeEventListener("mouseleave",this.callbackOnMouseLeave,!1)}}return n.activeTooltips=[],n.\u0275fac=function(e){return new(e||n)(Be(An),Be(ds),Be(ju),Be(Di))},n.\u0275dir=nn({type:n,selectors:[["","appTooltip",""]],inputs:{tabletopObject:["appTooltip","tabletopObject"]}}),n})();function hie(n,t){if(1&n){const e=pt();J(0,"div",2)(1,"div",3)(2,"div",4),At(3,"safe"),oe(),J(4,"div",4),At(5,"safe"),oe()(),J(6,"div",5)(7,"button",6),Re("click",function(){const o=Le(e).$implicit;return $e().drawCard(o)}),we(8,"\u5c71\u672d\u304b\u3089\u51fa\u3059"),oe(),J(9,"button",0),Re("click",function(){const o=Le(e).$implicit;return $e().showDetail(o)}),J(10,"i",7),we(11,"settings"),oe(),we(12,"\u7de8\u96c6"),oe(),it(13,"br"),J(14,"button",0),Re("click",function(){const o=Le(e).$implicit;return $e().up(o)}),we(15,"\u2191"),oe(),J(16,"button",0),Re("click",function(){const o=Le(e).$implicit;return $e().down(o)}),we(17,"\u2193"),oe(),it(18,"br"),oe()()}if(2&n){const e=t.$implicit;j(1),ie("appTooltip",e),j(1),un("background-image",Ft(3,5,"url("+(null==e||null==e.frontImage?null:e.frontImage.url)+")","style")),j(2),un("background-image",Ft(5,8,"url("+(null==e||null==e.backImage?null:e.backImage.url)+")","style"))}}let pie=(()=>{class n{constructor(e,i){this.panelService=e,this.changeDetector=i,this.cardStack=null,this.owner=bt.peerContext.userId}ngOnInit(){Promise.resolve().then(()=>this.panelService.title=this.cardStack.name+" \u306e\u30ab\u30fc\u30c9\u4e00\u89a7"),Qe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Xe.instance.get(e.data.identifier);!this.cardStack||!i||((this.cardStack===i||i instanceof Si&&this.cardStack.contains(i))&&this.changeDetector.markForCheck(),e.data.identifier===this.cardStack.identifier&&this.cardStack.owner!==this.owner&&this.panelService.close())}).on("DELETE_GAME_OBJECT",e=>{this.cardStack&&this.cardStack.identifier===e.data.identifier&&this.panelService.close()})}ngOnDestroy(){Qe.unregister(this),this.cardStack.owner===this.owner&&(this.cardStack.owner="")}drawCard(e){e.parent.removeChild(e),e.location.x=this.cardStack.location.x+100+50*Math.random(),e.location.y=this.cardStack.location.y+25+50*Math.random(),e.location.name=this.cardStack.location.name,e.rotate+=this.cardStack.rotate,360<e.rotate&&(e.rotate-=360),e.toTopmost(),$t.play(dt.cardDraw)}up(e){let i=e.parent,r=i.children.indexOf(e);0<r&&i.insertBefore(e,i.children[r-1])}down(e){let i=e.parent,r=i.children.indexOf(e);r<i.children.length-1&&i.insertBefore(i.children[r+1],e)}close(e=!1){e&&(this.cardStack.shuffle(),Qe.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier}),$t.play(dt.cardShuffle)),this.panelService.close()}showDetail(e){let r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(wl,{title:r,left:this.panelService.left+10,top:this.panelService.top+20,width:600,height:600}).tabletopObject=e}trackByCard(e,i){return i.identifier}}return n.\u0275fac=function(e){return new(e||n)(Be($n),Be(bi))},n.\u0275cmp=Qt({type:n,selectors:[["card-stack-list"]],inputs:{cardStack:"cardStack"},decls:5,vars:2,consts:[[3,"click"],["class","box",4,"ngFor","ngForOf","ngForTrackBy"],[1,"box"],[1,"image-box",3,"appTooltip"],[1,"image","contain"],[2,"display","inline-block"],["type","submit",3,"click"],[1,"material-icons",2,"font-size","1.1em","vertical-align","text-bottom"]],template:function(e,i){1&e&&(J(0,"div")(1,"button",0),Re("click",function(){return i.close(!0)}),we(2,"\u30b7\u30e3\u30c3\u30d5\u30eb\u3057\u3066\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b"),oe(),it(3,"hr"),Ee(4,hie,19,11,"div",1),oe()),2&e&&(j(4),ie("ngForOf",i.cardStack.cards)("ngForTrackBy",i.trackByCard))},directives:[si,qw],pipes:[Ii],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image-box[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}"],changeDetection:0}),n})();const bb=function(n){return{transform:n}};function gie(n,t){if(1&n){const e=pt();J(0,"div"),Re("@shuffle.start",function(r){return Le(e),$e().animationShuffleStarted(r)})("@shuffle.done",function(r){return Le(e),$e().animationShuffleDone(r)}),it(1,"img",7),At(2,"safe"),oe()}if(2&n){const e=$e();ie("@shuffle",e.animeState),j(1),ie("ngStyle",Nt(6,bb,"rotateZ("+e.topCard.rotate+"deg)"))("src",Ft(2,3,e.imageFile.url,"resourceUrl"),hn)}}function _ie(n,t){1&n&&(Je(0),J(1,"div",8)(2,"i",9),we(3,"autorenew"),oe()(),J(4,"div",10)(5,"i",9),we(6,"autorenew"),oe()(),J(7,"div",11)(8,"i",9),we(9,"autorenew"),oe()(),J(10,"div",12)(11,"i",9),we(12,"autorenew"),oe()(),et())}function mie(n,t){if(1&n&&(J(0,"div",13)(1,"i",14),we(2,"lock"),oe()()),2&n){const e=$e();ie("ngStyle",Nt(1,bb,"translateY(0%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)"))}}function $ie(n,t){if(1&n&&(J(0,"div",15)(1,"span"),we(2),oe()()),2&n){const e=$e();ie("ngStyle",Nt(2,bb,"translateY(-50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),j(2),sn("",e.cards.length,"\u679a")}}function vie(n,t){if(1&n&&(J(0,"div",16)(1,"span"),we(2),oe()()),2&n){const e=$e();ie("ngStyle",Nt(2,bb,"translateY(50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),j(2),sn("",e.ownerName," \u304c\u78ba\u8a8d\u4e2d")}}const bie=function(n){return{"is-empty":n}};let yie=(()=>{class n{constructor(e,i,r,o,s,a,g){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=o,this.changeDetector=s,this.imageService=a,this.pointerDeviceService=g,this.cardStack=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null}get isLock(){return this.cardStack.isLock}set isLock(e){this.cardStack.isLock=e}get name(){return this.cardStack.name}get rotate(){return this.cardStack.rotate}set rotate(e){this.cardStack.rotate=e}get zindex(){return this.cardStack.zindex}get isShowTotal(){return this.cardStack.isShowTotal}get cards(){return this.cardStack.cards}get isEmpty(){return this.cardStack.isEmpty}get size(){let e=this.cardStack.topCard;return e?e.size:2}get hasOwner(){return this.cardStack.hasOwner}get ownerName(){return this.cardStack.ownerName}get topCard(){return this.cardStack.topCard}get imageFile(){return this.imageService.getSkeletonOr(this.cardStack.imageFile)}get isIconHidden(){return null!=this.iconHiddenTimer}ngOnInit(){Qe.register(this).on("SHUFFLE_CARD_STACK",e=>{e.data.identifier===this.cardStack.identifier&&(this.animeState="active",this.changeDetector.markForCheck())}).on("UPDATE_GAME_OBJECT",e=>{let i=Xe.instance.get(e.data.identifier);!this.cardStack||!i||(this.cardStack===i||i instanceof Si&&this.cardStack.contains(i)||i instanceof _t&&i.userId===this.cardStack.owner)&&this.changeDetector.markForCheck()}).on("CARD_STACK_DECREASED",e=>{e.data.cardStackIdentifier===this.cardStack.identifier&&this.cardStack&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=_t.findByPeerId(e.data.peerId);(!i||this.cardStack.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.cardStack,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.cardStack}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new fa(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),Qe.unregister(this)}animationShuffleStarted(e){}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onCardDrop(e){if(this.cardStack!==e.detail&&(e.detail instanceof Jr||e.detail instanceof wr))if(e.stopPropagation(),e.preventDefault(),e.detail instanceof Jr){let i=e.detail;(i.location.x-this.cardStack.location.x)**2+(i.location.y-this.cardStack.location.y)**2+(i.posZ-this.cardStack.posZ)**2<2500&&this.cardStack.putOnTop(i)}else if(e.detail instanceof wr){let i=e.detail;(i.location.x-this.cardStack.location.x)**2+(i.location.y-this.cardStack.location.y)**2+(i.posZ-this.cardStack.posZ)**2<625&&this.concatStack(i)}}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100&&(console.log("onDoubleClick !!!!"),null!=this.drawCard()&&$t.play(dt.cardDraw))}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.startDoubleClickTimer(e),this.cardStack.toTopmost(),this.startIconHiddenTimer(),this.isLock&&Qe.trigger("DRAG_LOCKED_OBJECT",{}),Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.cardStack.identifier,className:"GameCharacter"})}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[this.isLock?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLock=!1,$t.play(dt.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLock=!0,$t.play(dt.lock)}},xi,{name:"\uff11\u679a\u5f15\u304f",action:()=>{null!=this.drawCard()&&$t.play(dt.cardDraw)}},xi,{name:"\u4e00\u756a\u4e0a\u3092\u8868\u306b\u3059\u308b",action:()=>{this.cardStack.faceUp(),$t.play(dt.cardDraw)}},{name:"\u4e00\u756a\u4e0a\u3092\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDown(),$t.play(dt.cardDraw)}},xi,{name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b",action:()=>{this.cardStack.faceUpAll(),$t.play(dt.cardDraw)}},{name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDownAll(),$t.play(dt.cardDraw)}},{name:"\u3059\u3079\u3066\u6b63\u4f4d\u7f6e\u306b\u3059\u308b",action:()=>{this.cardStack.uprightAll(),$t.play(dt.cardDraw)}},xi,{name:"\u30b7\u30e3\u30c3\u30d5\u30eb",action:()=>{this.cardStack.shuffle(),$t.play(dt.cardShuffle),Qe.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier})}},{name:"\u30ab\u30fc\u30c9\u4e00\u89a7",action:()=>{this.showStackList(this.cardStack)}},xi,this.isShowTotal?{name:"\u679a\u6570\u3092\u975e\u8868\u793a\u306b\u3059\u308b",action:()=>{this.cardStack.isShowTotal=!1}}:{name:"\u679a\u6570\u3092\u8868\u793a\u3059\u308b",action:()=>{this.cardStack.isShowTotal=!0}},{name:"\u30ab\u30fc\u30c9\u30b5\u30a4\u30ba\u3092\u63c3\u3048\u308b",action:()=>{this.cardStack.topCard&&this.cardStack.unifyCardsSize(this.cardStack.topCard.size)}},xi,{name:"\u5c71\u672d\u3092\u4eba\u6570\u5206\u306b\u5206\u5272\u3059\u308b",action:()=>{this.splitStack(bt.peerIds.length),$t.play(dt.cardDraw)}},{name:"\u5c71\u672d\u3092\u5d29\u3059",action:()=>{this.breakStack(),$t.play(dt.cardShuffle)}},xi,{name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.cardStack)}},{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.cardStack.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.owner="",r.toTopmost(),$t.play(dt.cardPut)}},{name:"\u5c71\u672d\u3092\u524a\u9664\u3059\u308b",action:()=>{this.cardStack.setLocation("graveyard"),this.cardStack.destroy(),$t.play(dt.sweep)}}],this.name)}onMove(){$t.play(dt.cardPick)}onMoved(){$t.play(dt.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}drawCard(){let e=this.cardStack.drawCard();return e&&(this.cardStack.update(),e.location.x+=100+50*Math.random(),e.location.y+=25+50*Math.random(),e.setLocation(this.cardStack.location.name)),e}breakStack(){let e=this.cardStack.drawCardAll().reverse();for(let i of e)i.location.x+=25-50*Math.random(),i.location.y+=25-50*Math.random(),i.toTopmost(),i.setLocation(this.cardStack.location.name);this.cardStack.setLocation("graveyard"),this.cardStack.destroy()}splitStack(e){if(e<2)return;let i=[];for(let a=0;a<e;a++){let g=wr.create(this.cardStack.name);g.location.x=this.cardStack.location.x+50-100*Math.random(),g.location.y=this.cardStack.location.y+50-100*Math.random(),g.posZ=this.cardStack.posZ,g.location.name=this.cardStack.location.name,g.rotate=this.rotate,g.toTopmost(),i.push(g)}let r=this.cardStack.drawCardAll();this.cardStack.setLocation("graveyard"),this.cardStack.destroy();let o=0,s=r.length/e*(o+1);for(let a=0;a<r.length;a++)i[o].putOnBottom(r[a]),s<=a+1&&(o++,s=r.length/e*(o+1))}concatStack(e,i=this.cardStack){let r=wr.create(e.name);r.location.name=i.location.name,r.location.x=i.location.x,r.location.y=i.location.y,r.posZ=i.posZ,r.zindex=e.zindex,r.rotate=i.rotate;let o=i.drawCardAll(),s=e.drawCardAll();for(let a of s.concat(o))r.putOnBottom(a);i.setLocation(""),i.destroy(),e.setLocation(""),e.destroy()}dispatchCardDropEvent(){let r=this.elementRef.nativeElement.parentElement.children,o=new CustomEvent("carddrop",{detail:this.cardStack,bubbles:!0});for(let s=0;s<r.length;s++)r[s].dispatchEvent(o)}showDetail(e){Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5c71\u672d\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(wl,{title:r,left:i.x-300,top:i.y-300,width:600,height:600}).tabletopObject=e}showStackList(e){Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r={left:i.x-200,top:i.y-300,width:400,height:600};this.cardStack.owner=bt.peerContext.userId,this.panelService.open(pie,r).cardStack=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(To),Be($n),Be(fi),Be(bi),Be(Op),Be(Di))},n.\u0275cmp=Qt({type:n,selectors:[["card-stack"]],hostBindings:function(e,i){1&e&&Re("carddrop",function(o){return i.onCardDrop(o)})("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{cardStack:"cardStack",is3D:"is3D"},decls:8,vars:13,consts:[["appMovable","",1,"dummy-will-change",3,"movable.option"],["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"ngClass","movable.option","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-pointer-events-auto","is-grab",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[4,"ngIf"],["class","lock-icon-mark is-nowrap is-black-background is-3d will-change",3,"ngStyle",4,"ngIf"],["class","name-tag is-nowrap is-black-background is-3d will-change",3,"ngStyle",4,"ngIf"],["class","name-tag has-length-limit is-nowrap is-black-background is-3d will-change",3,"ngStyle",4,"ngIf"],[1,"card-image","chrome-smooth-image-trick",3,"ngStyle","src"],[1,"rotate-grab","of-left-top","is-3d","will-change"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","is-3d","will-change"],[1,"rotate-grab","of-right-bottom","is-3d","will-change"],[1,"rotate-grab","of-right-top","is-3d","will-change"],[1,"lock-icon-mark","is-nowrap","is-black-background","is-3d","will-change",3,"ngStyle"],[1,"material-icons",2,"display","inline"],[1,"name-tag","is-nowrap","is-black-background","is-3d","will-change",3,"ngStyle"],[1,"name-tag","has-length-limit","is-nowrap","is-black-background","is-3d","will-change",3,"ngStyle"]],template:function(e,i){1&e&&(it(0,"div",0),J(1,"div",1),Re("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),J(2,"div",2),Re("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Ee(3,gie,3,8,"div",3),Ee(4,_ie,13,0,"ng-container",3),Ee(5,mie,3,3,"div",4),Ee(6,$ie,3,4,"div",5),Ee(7,vie,3,4,"div",6),oe()()),2&e&&(ie("movable.option",i.movableOption),j(1),un("width",i.size*i.gridSize,"px"),ie("ngClass",Nt(11,bie,i.isEmpty))("movable.option",i.movableOption),j(1),ie("rotable.option",i.rotableOption),j(1),ie("ngIf",i.topCard&&i.imageFile),j(1),ie("ngIf",!i.isIconHidden&&!i.isLock),j(1),ie("ngIf",i.isLock),j(1),ie("ngIf",i.isShowTotal),j(1),ie("ngIf",i.hasOwner))},directives:[bd,ir,Uf,Sn,Co],pipes:[Ii],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.will-change[_ngcontent-%COMP%]{will-change:opacity}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.is-empty[_ngcontent-%COMP%]{height:100px;width:100px}.component[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.dummy-will-change[_ngcontent-%COMP%]{position:absolute;height:1px;width:1px;will-change:opacity}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;margin-top:-5px;margin-left:-5px;border:solid 5px #CCCCCC;border-radius:5px;background-color:#ccc;-webkit-backface-visibility:hidden;backface-visibility:hidden}.card-image[_ngcontent-%COMP%]{display:block;top:0;left:0;bottom:0;right:0;margin:auto;height:auto;width:100%}.lock-icon-mark[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;z-index:1;padding:2px;background-color:#444;border-radius:100%;color:#ccc;font-size:8px;top:5px}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.rotate-grab[_ngcontent-%COMP%]{display:none;z-index:11}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:50%}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],data:{animation:[Na("shuffle",[ox("active",mn({transform:""})),Lr("* => active",[Br("800ms ease",Ls([mn({transform:"scale3d(0, 0, 0) rotateZ(0deg)",offset:0}),mn({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(360deg)",offset:.5}),mn({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(520deg)",offset:.75}),mn({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(630deg)",offset:.875}),mn({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(720deg)",offset:1})]))])])]},changeDetection:0}),n})();function Cie(n,t){if(1&n&&(it(0,"img",8),At(1,"safe")),2&n){const e=$e();ie("src",Ft(1,1,e.isFront?e.frontImage.url:e.backImage.url,"resourceUrl"),hn)}}const tF=function(n){return{transform:n}};function xie(n,t){if(1&n&&(J(0,"div",9)(1,"span",10),we(2),oe()()),2&n){const e=$e();ie("ngStyle",Nt(2,tF,"translateY(-75%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),j(2),xt(e.ownerName)}}function wie(n,t){1&n&&(it(0,"img",11),At(1,"safe")),2&n&&ie("src",Ft(1,1,$e().frontImage.url,"resourceUrl"),hn)}function Eie(n,t){1&n&&(Je(0),J(1,"div",12)(2,"i",13),we(3,"autorenew"),oe()(),J(4,"div",14)(5,"i",13),we(6,"autorenew"),oe()(),J(7,"div",15)(8,"i",13),we(9,"autorenew"),oe()(),J(10,"div",16)(11,"i",13),we(12,"autorenew"),oe()(),it(13,"div",17),et())}function Tie(n,t){if(1&n&&(J(0,"div",18)(1,"i",19),we(2,"lock"),oe()()),2&n){const e=$e();ie("ngStyle",Nt(1,tF,"translateY(0%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)"))}}let Sie=(()=>{class n{constructor(e,i,r,o,s,a,g,w){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=o,this.changeDetector=s,this.tabletopService=a,this.imageService=g,this.pointerDeviceService=w,this.card=null,this.is3D=!1,this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null}get dispLockMark(){return this.card.dispLockMark}set dispLockMark(e){this.card.dispLockMark=e}get isLock(){return this.card.isLock}set isLock(e){this.card.isLock=e}get name(){return this.card.name}get state(){return this.card.state}set state(e){this.card.state=e}get rotate(){return this.card.rotate}set rotate(e){this.card.rotate=e}get owner(){return this.card.owner}set owner(e){this.card.owner=e}get zindex(){return this.card.zindex}get size(){return this.adjustMinBounds(this.card.size)}get isHand(){return this.card.isHand}get isFront(){return this.card.isFront}get isVisible(){return this.card.isVisible}get hasOwner(){return this.card.hasOwner}get ownerIsOnline(){return this.card.ownerIsOnline}get ownerName(){return this.card.ownerName}get imageFile(){return this.imageService.getSkeletonOr(this.card.imageFile)}get frontImage(){return this.imageService.getSkeletonOr(this.card.frontImage)}get backImage(){return this.imageService.getSkeletonOr(this.card.backImage)}get isIconHidden(){return null!=this.iconHiddenTimer}ngOnInit(){Qe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Xe.instance.get(e.data.identifier);!this.card||!i||(this.card===i||i instanceof Si&&this.card.contains(i)||i instanceof _t&&i.userId===this.card.owner)&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=_t.findByPeerId(e.data.peerId);(!i||this.card.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.card,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.card}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new fa(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),Qe.unregister(this)}onCardDrop(e){if(this.card!==e.detail&&(e.detail instanceof Jr||e.detail instanceof wr)&&(e.stopPropagation(),e.preventDefault(),e.detail instanceof wr)){let i=e.detail;(i.location.x-this.card.location.x)**2+(i.location.y-this.card.location.y)**2+(i.posZ-this.card.posZ)**2<625&&(i.location.x=this.card.location.x,i.location.y=this.card.location.y,i.posZ=this.card.posZ,i.putOnBottom(this.card))}}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){if(this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100){if(console.log("onDoubleClick !!!!"),this.ownerIsOnline&&!this.isHand)return;this.state=this.isVisible&&!this.isHand?Kc.BACK:Kc.FRONT,this.owner="",$t.play(dt.cardDraw)}}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.startDoubleClickTimer(e),this.card.toTopmost(),this.startIconHiddenTimer(),this.isLock&&Qe.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r.push(this.isLock?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLock=!1,this.dispLockMark=!0,$t.play(dt.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLock=!0,$t.play(dt.lock)}}),this.isLock&&r.push(this.dispLockMark?{name:"\u56fa\u5b9a\u30de\u30fc\u30af\u6d88\u53bb",action:()=>{this.dispLockMark=!1,$t.play(dt.lock)}}:{name:"\u56fa\u5b9a\u30de\u30fc\u30af\u8868\u793a",action:()=>{this.dispLockMark=!0,$t.play(dt.lock)}}),r.push(xi),r.push(!this.isVisible||this.isHand?{name:"\u8868\u306b\u3059\u308b",action:()=>{this.card.faceUp(),$t.play(dt.cardDraw)}}:{name:"\u88cf\u306b\u3059\u308b",action:()=>{this.card.faceDown(),$t.play(dt.cardDraw)}}),r.push(this.isHand?{name:"\u88cf\u306b\u3059\u308b",action:()=>{this.card.faceDown(),$t.play(dt.cardDraw)}}:{name:"\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{$t.play(dt.cardDraw),this.card.faceDown(),this.owner=bt.peerContext.userId}}),r.push(xi),r.push({name:"\u91cd\u306a\u3063\u305f\u30ab\u30fc\u30c9\u3067\u5c71\u672d\u3092\u4f5c\u308b",action:()=>{this.createStack(),$t.play(dt.cardPut)}}),r.push({name:"\u30ab\u30fc\u30c9\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.card)}}),r.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let o=this.card.clone();o.location.x+=this.gridSize,o.location.y+=this.gridSize,o.toTopmost(),$t.play(dt.cardPut)}}),r.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.card.destroy(),$t.play(dt.sweep)}}),this.contextMenuService.open(i,r,this.isVisible?this.name:"\u30ab\u30fc\u30c9")}onMove(){this.input.cancel(),$t.play(dt.cardPick)}onMoved(){$t.play(dt.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}createStack(){let e=wr.create("\u5c71\u672d");e.location.x=this.card.location.x,e.location.y=this.card.location.y,e.posZ=this.card.posZ,e.location.name=this.card.location.name,e.rotate=this.rotate,e.zindex=this.card.zindex;let i=this.tabletopService.cards.filter(r=>(r.location.x-this.card.location.x)**2+(r.location.y-this.card.location.y)**2+(r.posZ-this.card.posZ)**2<1e4);i.sort((r,o)=>r.zindex<o.zindex?1:r.zindex>o.zindex?-1:0);for(let r of i)e.putOnBottom(r)}dispatchCardDropEvent(){console.log("dispatchCardDropEvent");let r=this.elementRef.nativeElement.parentElement.children,o=new CustomEvent("carddrop",{detail:this.card,bubbles:!0});for(let s=0;s<r.length;s++)r[s].dispatchEvent(o)}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(wl,{title:r,left:i.x-300,top:i.y-300,width:600,height:600}).tabletopObject=e}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(To),Be($n),Be(fi),Be(bi),Be(Wm),Be(Op),Be(Di))},n.\u0275cmp=Qt({type:n,selectors:[["card"]],hostBindings:function(e,i){1&e&&Re("carddrop",function(o){return i.onCardDrop(o)})("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{card:"card",is3D:"is3D"},decls:8,vars:10,consts:[["appMovable","",1,"dummy-will-change",3,"movable.option"],["appMovable","",1,"component","is-3d","is-pointer-events-none","is-grab",3,"movable.option","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-pointer-events-auto","is-3d",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],["class","card-image is-3d chrome-smooth-image-trick",3,"src",4,"ngIf"],["class","name-tag is-nowrap has-length-limit is-black-background will-change",3,"ngStyle",4,"ngIf"],["class","card-image thumbnail-transform is-translucent is-3d will-change chrome-smooth-image-trick",3,"src",4,"ngIf"],[4,"ngIf"],["class","lock-icon-mark is-nowrap is-black-background is-3d will-change",3,"ngStyle",4,"ngIf"],[1,"card-image","is-3d","chrome-smooth-image-trick",3,"src"],[1,"name-tag","is-nowrap","has-length-limit","is-black-background","will-change",3,"ngStyle"],[1,"is-3d"],[1,"card-image","thumbnail-transform","is-translucent","is-3d","will-change","chrome-smooth-image-trick",3,"src"],[1,"rotate-grab","of-left-top","is-3d","will-change"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","is-3d","will-change"],[1,"rotate-grab","of-right-bottom","is-3d","will-change"],[1,"rotate-grab","of-right-top","is-3d","will-change"],[1,"border-bg","is-pointer-events-none","is-3d","will-change"],[1,"lock-icon-mark","is-nowrap","is-black-background","is-3d","will-change",3,"ngStyle"],[1,"material-icons",2,"display","inline"]],template:function(e,i){1&e&&(it(0,"div",0),J(1,"div",1),Re("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),J(2,"div",2),Re("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Ee(3,Cie,2,4,"img",3),Ee(4,xie,3,4,"div",4),Ee(5,wie,2,4,"img",5),Ee(6,Eie,14,0,"ng-container",6),Ee(7,Tie,3,3,"div",7),oe()()),2&e&&(ie("movable.option",i.movableOption),j(1),un("width",i.size*i.gridSize,"px"),ie("movable.option",i.movableOption),j(1),ie("rotable.option",i.rotableOption),j(1),ie("ngIf",i.imageFile),j(1),ie("ngIf",!i.isFront&&i.hasOwner&&0<i.ownerName.length),j(1),ie("ngIf",i.isHand&&i.frontImage),j(1),ie("ngIf",!i.isIconHidden&&!i.isLock),j(1),ie("ngIf",i.isLock&&i.dispLockMark))},directives:[bd,Uf,Sn,Co],pipes:[Ii],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.will-change[_ngcontent-%COMP%]{will-change:opacity}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:auto;width:auto;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;min-width:25px;min-height:25px}.dummy-will-change[_ngcontent-%COMP%]{position:absolute;height:1px;width:1px;will-change:opacity}.component-content[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;height:100%;width:100%;box-sizing:border-box}.card-image[_ngcontent-%COMP%]{display:block;top:0;left:0;bottom:0;right:0;margin:auto;height:auto;width:100%}.lock-icon-mark[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;z-index:1;padding:2px;background-color:#444;border-radius:100%;color:#ccc;font-size:8px;top:5px}.thumbnail-transform[_ngcontent-%COMP%]{position:absolute;transform:scale(.9)}.is-translucent[_ngcontent-%COMP%]{filter:opacity(.8)}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;z-index:11}.rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-10px;left:-10px;border-radius:14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-10px;left:-10px;border-radius:14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-10px;right:-10px;border-radius:14px}.of-right-top[_ngcontent-%COMP%]{top:-10px;right:-10px;border-radius:14px}.border-bg[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;border-radius:8px;background-color:#cccccc80;top:-2px;left:-2px;right:-2px;bottom:-2px;z-index:-1}.border-bg[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .border-bg[_ngcontent-%COMP%]{display:block}.component[_ngcontent-%COMP%]:active   .border-bg[_ngcontent-%COMP%]{display:none}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:0;color:#f5f5f5!important;opacity:.9;z-index:10}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],changeDetection:0}),n})();const Die=["cursor"],Iie=["opacity"];function kie(n,t){if(1&n&&(J(0,"div",6)(1,"div",7),At(2,"safe"),J(3,"div",8)(4,"span",9),we(5),oe()()()()),2&n){const e=t.$implicit,i=$e(2);ie("ngClass",e),j(1),un("background-image",Ft(2,4,"url("+i.iconUrl+")","style")),j(4),xt(i.name)}}const Mie=function(){return["is-front","is-back"]};function Aie(n,t){1&n&&(Je(0),J(1,"div",1,2)(3,"div",3,4),Ee(5,kie,6,7,"div",5),oe()(),et()),2&n&&(j(5),ie("ngForOf",$r(1,Mie)))}let Pie=(()=>{class n{constructor(e,i,r,o){this.batchService=e,this.coordinateService=i,this.chatMessageService=r,this.ngZone=o,this.cursor=_t.myCursor,this.cursorElement=null,this.opacityElement=null,this.fadeOutTimer=null,this.updateInterval=null,this.timestampInterval=null,this.timestampIntervalEnable=!1,this.callcack=s=>this.onMouseMove(s),this._x=0,this._y=0,this.networkService=bt,this.secdCounter=0,this.indexCounter=0}get iconUrl(){return this.cursor.image.url}get name(){return this.cursor.name}get isMine(){return this.cursor.isMine}get chatTabList(){return Xe.instance.get("ChatTabList")}get delayMs(){let e=16.6*bt.peerIds.length;return e<100?100:e}get delayMsHb(){let e=166*bt.peerIds.length;return e<1e3?1e3:e}ngOnInit(){this.isMine||Qe.register(this).on("CURSOR_MOVE",e=>{e.sendFrom===this.cursor.peerId&&this.batchService.add(()=>{this.stopTransition(),this.setAnimatedTransition(),this.setPosition(e.data[0],e.data[1],e.data[2]),this.resetFadeOut()},this)}).on("HEART_BEAT",e=>{e.sendFrom===this.cursor.peerId&&this.batchService.add(()=>{this.cursor.timestampSend=e.data[0],this.cursor.timestampReceive=Date.now(),this.cursor.timeDiffDown=this.cursor.timestampReceive-this.cursor.timestampSend+_t.myCursor.debugReceiveDelay;const i=e.data[1],r=e.data[2];this.cursor.lastTimeSignNo=e.data[3],this.cursor.firstTimeSignNo<0&&(this.cursor.firstTimeSignNo=e.data[3]),this.cursor.totalTimeSignNum++,i==_t.myCursor.peerId&&null!=r&&(this.cursor.timeDiffUp=r,this.cursor.timeLatency=r+this.cursor.timeDiffDown)},this)})}chkDisConnect(){const e=1e3*_t.myCursor.timeout,i=Date.now()-this.cursor.timestampReceive,o=Xe.instance.get("ChatTabList").systemMessageTab;e<=i?!this.cursor.isDisConnect&&(this.cursor.isDisConnect=!0,o)&&this.chatMessageService.sendSystemMessageOnePlayer(o,this.cursor.userId+"["+this.cursor.name+"] \u3055\u3093\u304b\u3089\u3042\u306a\u305f\u3078\u306e\u63a5\u7d9a\u78ba\u8a8d\u4fe1\u53f7\u304c"+_t.myCursor.timeout+"\u79d2\u4ee5\u4e0a\u53d7\u4fe1\u3067\u304d\u307e\u305b\u3093\u3002\u901a\u4fe1\u969c\u5bb3\u306e\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002",_t.myCursor.identifier,"#006633"):(1==this.cursor.isDisConnect&&setTimeout(()=>{this.timestampInterval=null,o&&this.chatMessageService.sendSystemMessageOnePlayer(o,"\u3042\u306a\u305f\u3068"+this.cursor.userId+"["+this.cursor.name+"] \u3055\u3093\u306e\u63a5\u7d9a\u3092\u78ba\u8a8d\u3057\u307e\u3057\u305f\u3002",_t.myCursor.identifier,"#006633")},1e3),this.cursor.isDisConnect=!1)}logoutMessage(){const i=Xe.instance.get("ChatTabList").systemMessageTab;i&&this.chatMessageService.sendSystemMessageOnePlayer(i,this.cursor.userId+"["+this.cursor.name+"] \u3055\u3093\u304c\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u307e\u3057\u305f\u3002",_t.myCursor.identifier,"#006633")}timestampLoop(){!this.timestampIntervalEnable||this.timestampInterval||(this.timestampInterval=setTimeout(()=>{if(this.timestampInterval=null,_t.myCursor.peerId==this.cursor.peerId){const e=this.networkService.peerContexts.length;if(e){e<=this.indexCounter&&(this.indexCounter=0);let i=Date.now()+_t.myCursor.debugTimeShift,r=null;this.networkService.peerContexts[this.indexCounter]&&(r=this.networkService.peerContexts[this.indexCounter]);let o="";r&&this.networkService.peerContexts[this.indexCounter].isOpen&&(o=this.networkService.peerContexts[this.indexCounter].peerId);const s=_t.findByPeerId(o);Qe.call("HEART_BEAT",[i,o,s?s.timeDiffDown:null,this.secdCounter]),this.indexCounter++,this.secdCounter++}}else this.chkDisConnect();this.timestampLoop()},this.delayMsHb))}ngAfterViewInit(){this.isMine?this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousemove",this.callcack),document.body.addEventListener("touchmove",this.callcack)}):(this.cursorElement=this.cursorElementRef.nativeElement,this.opacityElement=this.opacityElementRef.nativeElement,this.setAnimatedTransition(),this.setPosition(0,0,0),this.resetFadeOut()),this.timestampIntervalEnable=!0,this.timestampLoop()}ngOnDestroy(){this.logoutMessage(),document.body.removeEventListener("mousemove",this.callcack),document.body.removeEventListener("touchmove",this.callcack),Qe.unregister(this),this.batchService.remove(this),this.fadeOutTimer&&this.fadeOutTimer.clear(),this.timestampIntervalEnable=!1}onMouseMove(e){let i=e.touches?e.changedTouches[0].pageX:e.pageX,r=e.touches?e.changedTouches[0].pageY:e.pageY;i===this._x&&r===this._y||(this._x=i,this._y=r,this._target=e.target,this.updateInterval||(this.updateInterval=setTimeout(()=>{this.updateInterval=null,this.calcLocalCoordinate(this._x,this._y,this._target)},this.delayMs)))}calcLocalCoordinate(e,i,r){if(!document.getElementById("app-table-layer").contains(r))return;let o={x:e,y:i,z:0};o=this.coordinateService.calcTabletopLocalCoordinate(o,r),Qe.call("CURSOR_MOVE",[o.x,o.y,o.z])}resetFadeOut(){this.opacityElement.style.opacity="1.0",null==this.fadeOutTimer&&(this.fadeOutTimer=new uc(()=>{this.opacityElement.style.opacity="0.0"},3e3)),this.fadeOutTimer.reset()}stopTransition(){this.cursorElement.style.transform=window.getComputedStyle(this.cursorElement).transform}setAnimatedTransition(){this.cursorElement.style.transition=`transform ${this.delayMs+33}ms linear, opacity 0.5s ease-out`}setPosition(e,i,r){this.cursorElement.style.transform=`translateX(${e.toFixed(4)}px) translateY(${i.toFixed(4)}px) translateZ(${r.toFixed(4)}px)`}}return n.\u0275fac=function(e){return new(e||n)(Be(Rp),Be($d),Be(go),Be(An))},n.\u0275cmp=Qt({type:n,selectors:[["peer-cursor"],["","peer-cursor",""]],viewQuery:function(e,i){if(1&e&&(Gn(Die,5),Gn(Iie,5)),2&e){let r;yn(r=Cn())&&(i.cursorElementRef=r.first),yn(r=Cn())&&(i.opacityElementRef=r.first)}},inputs:{cursor:"cursor"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"component","is-3d","is-transition","is-pointer-events-none"],["cursor",""],[1,"upright-transform","is-3d","is-transition"],["opacity",""],["class","peer-cursor is-front",3,"ngClass",4,"ngFor","ngForOf"],[1,"peer-cursor","is-front",3,"ngClass"],[1,"icon"],[1,"name","is-center"],[2,"white-space","nowrap"]],template:function(e,i){1&e&&Ee(0,Aie,6,2,"ng-container",0),2&e&&ie("ngIf",!i.isMine)},directives:[Sn,si,ir],pipes:[Ii],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;overflow:visible;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;will-change:transform;transform:translate(0) translateY(0px%) translateZ(0)}.is-transition[_ngcontent-%COMP%]{transition:transform 133ms linear,opacity .5s ease-out}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.peer-cursor[_ngcontent-%COMP%]{height:45px;width:45px;position:absolute;left:0;top:0;box-sizing:border-box;border:solid 1px rgba(240,218,189);border-radius:50% 50% 5%;background-color:#f0dabde6;transform-origin:100% 100%;-webkit-backface-visibility:hidden;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotateX(-90deg) rotate(45deg)}.is-back[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotateX(-90deg) rotateY(180deg) rotate(45deg)}.icon[_ngcontent-%COMP%]{overflow:visible;height:100%;width:100%;border-radius:100%;background-position:top,center;background-repeat:no-repeat;background-size:cover;transform:rotate(-45deg) scale(.85)}.name[_ngcontent-%COMP%]{box-sizing:border-box;font-size:7px;padding:2px 5px;border-radius:14px;color:#ccc;background-color:#1e1e1ecc}.is-center[_ngcontent-%COMP%]{position:absolute;left:50%;top:-26px;transform:translate(-50%)}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.will-change[_ngcontent-%COMP%]{will-change:opacity}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}"]}),n})();function Fie(n,t){if(1&n&&(J(0,"ng-option",10),we(1),oe()),2&n){const e=t.$implicit;ie("value",e.identifier),j(1),sn("",e.name," ")}}function Rie(n,t){1&n&&(it(0,"img",11),At(1,"safe")),2&n&&ie("src",Ft(1,1,$e().imageFile.url,"resourceUrl"),hn)}let Nie=(()=>{class n{constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this.tabletopObject=null,this.shouldUpdateCharacterList=!0,this._gameCharacters=[]}get sendFrom(){return this._sendFrom}set sendFrom(e){this._sendFrom=e}get gameCharacters(){return this.shouldUpdateCharacterList&&(this.shouldUpdateCharacterList=!1,this._gameCharacters=Xe.instance.getObjects(Lt).filter(e=>this.allowsChat(e))),this._gameCharacters}allowsChat(e){return"table"===e.location.name&&!e.nonTalkFlag}get imageFile(){let e=Xe.instance.get(this._sendFrom);return e instanceof Lt&&St.instance.get(e.imageDataElement.children[0].value)||Bt.Empty}get selectCharacterTachieNum(){let e=Xe.instance.get(this._sendFrom);return e instanceof Lt?e.imageDataElement.children.length:0}followring(){let e=Xe.instance.get(this._sendFrom);e instanceof Lt&&Lt&&($t.play(dt.lock),this.tabletopObject.followingCharctorIdentifier=e.identifier,this.tabletopObject.following()),this.panelService.close()}cancel(){this.panelService.close()}ngOnInit(){this._sendFrom=this.gameCharacters.length>=1?this.gameCharacters[0].identifier:""}ngAfterViewInit(){}ngOnDestroy(){}}return n.\u0275fac=function(e){return new(e||n)(Be(bi),Be($n),Be(pi))},n.\u0275cmp=Qt({type:n,selectors:[["range-docking-character"]],inputs:{tabletopObject:"tabletopObject"},decls:16,vars:4,consts:[[1,"table"],[1,"table-cell",2,"width","7em"],[2,"text-align","center"],[1,"table-cell"],[1,"ud-select","is-caret",2,"width","12em",3,"ngModel","clearable","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"table-cell","imagebox"],["class","image",3,"src",4,"ngIf"],[2,"width","9em",3,"click"],[2,"width","9em","margin-left","3em",3,"click"],[3,"value"],[1,"image",3,"src"]],template:function(e,i){1&e&&(J(0,"div",0)(1,"div",1)(2,"div",2),we(3," \u63a5\u7d9a\u5148\uff1e "),oe()(),J(4,"div",3)(5,"ng-select",4),Re("ngModelChange",function(o){return i.sendFrom=o}),Ee(6,Fie,2,2,"ng-option",5),oe()()(),J(7,"div",0)(8,"div",6),Ee(9,Rie,2,4,"img",7),oe()(),it(10,"br"),J(11,"div",0)(12,"button",8),Re("click",function(){return i.followring()}),we(13,"\u63a5\u7d9a\u5b9f\u884c"),oe(),J(14,"button",9),Re("click",function(){return i.cancel()}),we(15,"\u30ad\u30e3\u30f3\u30bb\u30eb"),oe()()),2&e&&(j(5),ie("ngModel",i.sendFrom)("clearable",!1),j(1),ie("ngForOf",i.gameCharacters),j(3),ie("ngIf",0<i.imageFile.url.length))},directives:[gp,Ti,yi,si,wf,Sn],pipes:[Ii],styles:[".flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table-cell[_ngcontent-%COMP%]{display:table-cell}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:100px;height:100px;max-width:50px;max-height:50px;vertical-align:top;text-align:center}.image[_ngcontent-%COMP%]{height:100%;vertical-align:bottom;object-fit:cover}input[_ngcontent-%COMP%]{width:5em}"],changeDetection:0}),n})();class Oie{constructor(t,e){this.canvasElement=t,this.canvasElementRange=e}makeBrush(t,e,i){t.strokeStyle=i,t.fillStyle=t.strokeStyle,t.lineWidth=1;let r=Math.floor(e/5);return t.font=`bold ${r}px sans-serif`,t.textBaseline="top",t.textAlign="center",t}chkOuterProduct(t,e,i,r,o,s){return(i-t)*(s-e)-(r-e)*(o-t)>=-.01}chkInCircle(t,e,i){return t*t>=e*e+i*i}renderCircle(t){let e=t.gridSize,i=t.areaWidth*e/2,r=t.areaHeight*e/2,s=(Math,-t.centerX%e),a=-t.centerY%e;s>0&&(s-=e),a>0&&(a-=e),t.offSetX&&(s<-.5?s+=e/2:s-=e/2),t.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=t.areaWidth*e,this.canvasElement.height=t.areaHeight*e;let g=this.canvasElement.getContext("2d"),w=0,W=0,ve=this.generateCalcGridPositionFunc(t.gridType,t.centerX,t.centerY,t.areaWidth,t.areaHeight);if(t.fillOutLine)this.makeBrush(g,e,t.gridColor),g.beginPath(),g.arc(i,r,t.range*e,0,2*Math.PI,!0),g.fill();else{this.makeBrush(g,e,t.gridColor);for(let me=0;me<=t.areaHeight+1;me++)for(let Se=0;Se<=t.areaWidth+1;Se++){let{gx:Oe,gy:Ve}=ve(Se,me,e);w=Oe+s+e/2-i,W=Ve+a+e/2-r,this.chkInCircle(t.range*e,w,W)&&this.fillSquare(g,Oe+s,Ve+a,e)}}this.canvasElementRange.width=t.areaWidth*e,this.canvasElementRange.height=t.areaHeight*e,g=this.canvasElementRange.getContext("2d"),this.makeBrush(g,e,t.rangeColor),g.beginPath(),g.lineWidth=2,g.arc(i,r,t.range*e,0,2*Math.PI,!0),g.stroke(),t.isDocking?(g.beginPath(),g.strokeRect(i-6,r-6,12,12)):(g.beginPath(),g.arc(i,i,5,0,2*Math.PI,!0),g.fill())}renderLine(t){let e=t.gridSize,i=t.areaWidth*e/2,r=t.areaHeight*e/2,o=Math.PI/180*t.degree,s=-t.centerX%e,a=-t.centerY%e;s>0&&(s-=e),a>0&&(a-=e),t.offSetX&&(s<-.5?s+=e/2:s-=e/2),t.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=t.areaWidth*e,this.canvasElement.height=t.areaHeight*e;let g=this.canvasElement.getContext("2d"),W=.5*t.width*e,me=-.5*t.width*e,Se=t.range*e,Oe=-.5*t.width*e,Ve=t.range*e,We=.5*t.width*e,Ze=0-1*e,je=W+1*e,ut=0-1*e,ot=me-1*e,ft=Se+1*e,Ot=Oe-1*e,Et=Ve+1*e,Ut=We+1*e,It=0*Math.cos(o)-W*Math.sin(o),Pt=0*Math.sin(o)+W*Math.cos(o),Wt=0*Math.cos(o)-me*Math.sin(o),ci=0*Math.sin(o)+me*Math.cos(o),Jn=Se*Math.cos(o)-Oe*Math.sin(o),gi=Se*Math.sin(o)+Oe*Math.cos(o),Ri=Ve*Math.cos(o)-We*Math.sin(o),Rt=Ve*Math.sin(o)+We*Math.cos(o),Zt={clip01x:Ze*Math.cos(o)-je*Math.sin(o),clip01y:Ze*Math.sin(o)+je*Math.cos(o),clip02x:ut*Math.cos(o)-ot*Math.sin(o),clip02y:ut*Math.sin(o)+ot*Math.cos(o),clip03x:ft*Math.cos(o)-Ot*Math.sin(o),clip03y:ft*Math.sin(o)+Ot*Math.cos(o),clip04x:Et*Math.cos(o)-Ut*Math.sin(o),clip04y:Et*Math.sin(o)+Ut*Math.cos(o)},tn=0,dn=0,Wn=this.generateCalcGridPositionFunc(t.gridType,t.centerX,t.centerY,t.areaWidth,t.areaHeight);if(this.makeBrush(g,e,t.gridColor),t.fillOutLine)this.makeBrush(g,e,t.gridColor),g.beginPath(),g.moveTo(It+i,Pt+r),g.lineTo(Wt+i,ci+r),g.lineTo(Jn+i,gi+r),g.lineTo(Ri+i,Rt+r),g.lineTo(It+i,Pt+r),g.fill();else{this.makeBrush(g,e,t.gridColor);for(let $i=0;$i<=t.areaHeight+1;$i++)for(let Mi=0;Mi<=t.areaWidth+1;Mi++){let{gx:ar,gy:vi}=Wn(Mi,$i,e);tn=ar+s+e/2-i,dn=vi+a+e/2-r,this.chkOuterProduct(It,Pt,Wt,ci,tn,dn)&&this.chkOuterProduct(Wt,ci,Jn,gi,tn,dn)&&this.chkOuterProduct(Jn,gi,Ri,Rt,tn,dn)&&this.chkOuterProduct(Ri,Rt,It,Pt,tn,dn)&&this.fillSquare(g,ar+s,vi+a,e)}}return this.canvasElementRange.width=t.areaWidth*e,this.canvasElementRange.height=t.areaHeight*e,g=this.canvasElementRange.getContext("2d"),this.makeBrush(g,e,t.rangeColor),g.beginPath(),g.lineWidth=2,g.moveTo(It+i,Pt+r),g.lineTo(Wt+i,ci+r),g.lineTo(Jn+i,gi+r),g.lineTo(Ri+i,Rt+r),g.lineTo(It+i,Pt+r),g.stroke(),g.beginPath(),g.arc(i,i,5,0,2*Math.PI,!0),g.fill(),Zt}renderSquare(t){let e=t.gridSize,i=t.areaWidth*e/2,r=t.areaHeight*e/2,s=(Math,-t.centerX%e),a=-t.centerY%e;s>0&&(s-=e),a>0&&(a-=e),t.offSetX&&(s<-.5?s+=e/2:s-=e/2),t.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=t.areaWidth*e,this.canvasElement.height=t.areaHeight*e;let g=this.canvasElement.getContext("2d"),w=-t.range*e,W=t.range*e,ve=-t.range*e,me=-t.range*e,Se=t.range*e,Oe=-t.range*e,Ve=t.range*e,We=t.range*e,It={clip01x:w-1*e,clip01y:W+1*e,clip02x:ve-1*e,clip02y:me-1*e,clip03x:Se+1*e,clip03y:Oe-1*e,clip04x:Ve+1*e,clip04y:We+1*e},Pt=0,Wt=0,ci=this.generateCalcGridPositionFunc(t.gridType,t.centerX,t.centerY,t.areaWidth,t.areaHeight);if(this.makeBrush(g,e,t.gridColor),t.fillOutLine)this.makeBrush(g,e,t.gridColor),g.beginPath(),g.moveTo(w+i,W+r),g.lineTo(ve+i,me+r),g.lineTo(Se+i,Oe+r),g.lineTo(Ve+i,We+r),g.lineTo(w+i,W+r),g.fill();else{this.makeBrush(g,e,t.gridColor);for(let Jn=0;Jn<=t.areaHeight+1;Jn++)for(let gi=0;gi<=t.areaWidth+1;gi++){let{gx:Ri,gy:Rt}=ci(gi,Jn,e);Pt=Ri+s+e/2-i,Wt=Rt+a+e/2-r,this.chkOuterProduct(w,W,ve,me,Pt,Wt)&&this.chkOuterProduct(ve,me,Se,Oe,Pt,Wt)&&this.chkOuterProduct(Se,Oe,Ve,We,Pt,Wt)&&this.chkOuterProduct(Ve,We,w,W,Pt,Wt)&&this.fillSquare(g,Ri+s,Rt+a,e)}}return this.canvasElementRange.width=t.areaWidth*e,this.canvasElementRange.height=t.areaHeight*e,g=this.canvasElementRange.getContext("2d"),this.makeBrush(g,e,t.rangeColor),g.beginPath(),g.lineWidth=2,g.moveTo(w+i,W+r),g.lineTo(ve+i,me+r),g.lineTo(Se+i,Oe+r),g.lineTo(Ve+i,We+r),g.lineTo(w+i,W+r),g.stroke(),t.isDocking?(g.beginPath(),g.strokeRect(i-6,r-6,12,12)):(g.beginPath(),g.arc(i,i,5,0,2*Math.PI,!0),g.fill()),It}renderDiamond(t){let e=t.gridSize,i=t.areaWidth*e/2,r=t.areaHeight*e/2,s=(Math,-t.centerX%e),a=-t.centerY%e;s>0&&(s-=e),a>0&&(a-=e),t.offSetX&&(s<-.5?s+=e/2:s-=e/2),t.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=t.areaWidth*e,this.canvasElement.height=t.areaHeight*e;let g=this.canvasElement.getContext("2d"),w=-t.range*e,me=-t.range*e,Se=t.range*e,We=t.range*e,It={clip01x:w-1.2*e,clip01y:0,clip02x:0,clip02y:me-1.2*e,clip03x:Se+1.2*e,clip03y:0,clip04x:0,clip04y:We+1.2*e},Pt=0,Wt=0,ci=this.generateCalcGridPositionFunc(t.gridType,t.centerX,t.centerY,t.areaWidth,t.areaHeight);if(this.makeBrush(g,e,t.gridColor),t.fillOutLine)this.makeBrush(g,e,t.gridColor),g.beginPath(),g.moveTo(w+i,0+r),g.lineTo(0+i,me+r),g.lineTo(Se+i,0+r),g.lineTo(0+i,We+r),g.lineTo(w+i,0+r),g.fill();else{this.makeBrush(g,e,t.gridColor);for(let Jn=0;Jn<=t.areaHeight+1;Jn++)for(let gi=0;gi<=t.areaWidth+1;gi++){let{gx:Ri,gy:Rt}=ci(gi,Jn,e);Pt=Ri+s+e/2-i,Wt=Rt+a+e/2-r,this.chkOuterProduct(w,0,0,me,Pt,Wt)&&this.chkOuterProduct(0,me,Se,0,Pt,Wt)&&this.chkOuterProduct(Se,0,0,We,Pt,Wt)&&this.chkOuterProduct(0,We,w,0,Pt,Wt)&&this.fillSquare(g,Ri+s,Rt+a,e)}}return this.canvasElementRange.width=t.areaWidth*e,this.canvasElementRange.height=t.areaHeight*e,g=this.canvasElementRange.getContext("2d"),this.makeBrush(g,e,t.rangeColor),g.beginPath(),g.lineWidth=2,g.moveTo(w+i,0+r),g.lineTo(0+i,me+r),g.lineTo(Se+i,0+r),g.lineTo(0+i,We+r),g.lineTo(w+i,0+r),g.stroke(),t.isDocking?(g.beginPath(),g.strokeRect(i-6,r-6,12,12)):(g.beginPath(),g.arc(i,i,5,0,2*Math.PI,!0),g.fill()),It}renderCorn(t){let e=t.gridSize,i=t.areaWidth*e/2,r=t.areaHeight*e/2,o=Math.PI/180*t.degree,s=-t.centerX%e,a=-t.centerY%e;s>0&&(s-=e),a>0&&(a-=e),t.offSetX&&(s<-.5?s+=e/2:s-=e/2),t.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=t.areaWidth*e,this.canvasElement.height=t.areaHeight*e;let g=this.canvasElement.getContext("2d"),ve=t.range*e,me=-.5*t.width*e,Se=t.range*e,Oe=.5*t.width*e,Ve=0-1.5*e,Ze=0-1*e,je=0-1*e,ut=ve-1*e,ot=me-1*e,ft=ve,Ot=me-1*e,Et=ve+1*e,Ut=me-1*e,It=Et,Pt=-Ut,Wt=ft,ci=-Ot,Jn=ut,gi=-ot,Ri=Ze,Rt=-je,dn=ve*Math.cos(o)-me*Math.sin(o),Wn=ve*Math.sin(o)+me*Math.cos(o),$i=Se*Math.cos(o)-Oe*Math.sin(o),Mi=Se*Math.sin(o)+Oe*Math.cos(o),ar={clip01x:Ve*Math.cos(o)-0*Math.sin(o),clip01y:Ve*Math.sin(o)+0*Math.cos(o),clip02x:Ze*Math.cos(o)-je*Math.sin(o),clip02y:Ze*Math.sin(o)+je*Math.cos(o),clip03x:ut*Math.cos(o)-ot*Math.sin(o),clip03y:ut*Math.sin(o)+ot*Math.cos(o),clip04x:ft*Math.cos(o)-Ot*Math.sin(o),clip04y:ft*Math.sin(o)+Ot*Math.cos(o),clip05x:Et*Math.cos(o)-Ut*Math.sin(o),clip05y:Et*Math.sin(o)+Ut*Math.cos(o),clip06x:It*Math.cos(o)-Pt*Math.sin(o),clip06y:It*Math.sin(o)+Pt*Math.cos(o),clip07x:Wt*Math.cos(o)-ci*Math.sin(o),clip07y:Wt*Math.sin(o)+ci*Math.cos(o),clip08x:Jn*Math.cos(o)-gi*Math.sin(o),clip08y:Jn*Math.sin(o)+gi*Math.cos(o),clip09x:Ri*Math.cos(o)-Rt*Math.sin(o),clip09y:Ri*Math.sin(o)+Rt*Math.cos(o)},vi=0,Mt=0,Zw=this.generateCalcGridPositionFunc(t.gridType,t.centerX,t.centerY,t.areaWidth,t.areaHeight);if(t.fillOutLine)this.makeBrush(g,e,t.gridColor),g.beginPath(),g.moveTo(0+i,0+r),g.lineTo(dn+i,Wn+r),g.lineTo($i+i,Mi+r),g.lineTo(0+i,0+r),g.fill();else{this.makeBrush(g,e,t.gridColor);for(let io=0;io<=t.areaHeight+1;io++)for(let El=0;El<=t.areaWidth+1;El++){let{gx:Tl,gy:$c}=Zw(El,io,e);vi=Tl+s+e/2-i,Mt=$c+a+e/2-r,this.chkOuterProduct(0,0,dn,Wn,vi,Mt)&&this.chkOuterProduct(dn,Wn,$i,Mi,vi,Mt)&&this.chkOuterProduct($i,Mi,0,0,vi,Mt)&&this.fillSquare(g,Tl+s,$c+a,e)}}return this.canvasElementRange.width=t.areaWidth*e,this.canvasElementRange.height=t.areaHeight*e,g=this.canvasElementRange.getContext("2d"),this.makeBrush(g,e,t.rangeColor),g.beginPath(),g.lineWidth=2,g.moveTo(0+i,0+r),g.lineTo(dn+i,Wn+r),g.lineTo($i+i,Mi+r),g.lineTo(0+i,0+r),g.stroke(),g.beginPath(),g.arc(i,i,5,0,2*Math.PI,!0),g.fill(),ar}generateCalcGridPositionFunc(t,e,i,r,o){switch(t){case bs.HEX_VERTICAL:return(s,a,g)=>(s+(e%(2*g)<g?1:0)+(r%4==0?1:0))%2==1?{gx:s*g,gy:a*g}:{gx:s*g,gy:a*g+g/2};case bs.HEX_HORIZONTAL:return(s,a,g)=>(a+(i%(2*g)<g?1:0)+(o%4==0?1:0))%2==1?{gx:s*g,gy:a*g}:{gx:s*g+g/2,gy:a*g};default:return(s,a,g)=>({gx:s*g,gy:a*g})}}fillSquare(t,e,i,r){t.beginPath(),t.fillRect(e,i,r,r)}strokeSquare(t,e,i,r){t.beginPath(),t.strokeRect(e,i,r,r)}strokeHex(t,e,i,r,o){let s=o===bs.HEX_HORIZONTAL?-30:0,a=r/Math.sqrt(3),g=e+r/2,w=i+r/2;t.beginPath();for(let W=0;W<6;W++){s+=60;let ve=Math.PI/180*s,me=Math.cos(ve)*a+g,Se=Math.sin(ve)*a+w;t.lineTo(me,Se)}t.closePath(),t.stroke()}}const Bie=["gridCanvas"],Lie=["rangeCanvas"],zie=["rotate"];function Hie(n,t){1&n&&(J(0,"div",17)(1,"i",18),we(2,"lock"),oe()())}function Vie(n,t){if(1&n&&(Je(0),J(1,"div",19)(2,"div",20)(3,"i",18),we(4,"autorenew"),oe()(),J(5,"div",21)(6,"i",18),we(7,"autorenew"),oe()(),J(8,"div",22)(9,"i",18),we(10,"autorenew"),oe()()(),et()),2&n){const e=$e();j(2),un("left",1*e.range.length*e.gridSize,"px")}}const nF=function(n){return{transform:n}};function Uie(n,t){if(1&n&&(J(0,"div",23)(1,"div",24)(2,"span",25)(3,"i"),we(4),oe()(),J(5,"span",26)(6,"i"),we(7),oe()()(),J(8,"div",24)(9,"span",27),we(10),oe(),J(11,"span",28),we(12),oe()(),J(13,"div",29)(14,"span",25)(15,"i"),we(16),oe()(),J(17,"span",26)(18,"i"),we(19),oe()()()()),2&n){const e=$e();un("border-left-color",e.range.rangeColor)("height",e.math.abs(e.altitude*e.gridSize)-0,"px"),ie("ngStyle",Nt(40,nF,"rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),j(1),un("visibility",e.altitude>0?"visible":"hidden"),j(1),un("color",e.range.rangeColor)("text-shadow",e.textShadowCss),j(2),xt(e.elevation),j(1),un("color",e.range.rangeColor)("text-shadow",e.textShadowCss),j(2),xt(e.elevation),j(2),un("color",e.range.rangeColor)("text-shadow",e.textShadowCss),j(1),xt(e.math.abs(e.altitude)),j(1),un("color",e.range.rangeColor)("text-shadow",e.textShadowCss),j(1),xt(e.math.abs(e.altitude)),j(1),un("visibility",e.altitude<0?"visible":"hidden"),ie("ngStyle",Nt(42,nF,"translateY("+(e.isFollowed?e.followingCharactor.chatBubbleAltitude+4:0)+"px)")),j(1),un("color",e.range.rangeColor)("text-shadow",e.textShadowCss),j(2),xt(e.elevation),j(1),un("color",e.range.rangeColor)("text-shadow",e.textShadowCss),j(2),xt(e.elevation)}}const jie=function(n){return{"is-grab":n}},Gie=function(n){return{fall:n}};let qie=(()=>{class n{constructor(e,i,r,o,s,a,g,w,W){this.ngZone=e,this.tabletopActionService=i,this.contextMenuService=r,this.elementRef=o,this.panelService=s,this.changeDetector=a,this.pointerDeviceService=g,this.coordinateService=w,this.tabletopService=W,this.range=null,this.is3D=!1,this.clipAreaCorn={clip01x:0,clip01y:0,clip02x:100,clip02y:0,clip03x:100,clip03y:100,clip04x:0,clip04y:100,clip05x:0,clip05y:0,clip06x:0,clip06y:0,clip07x:0,clip07y:0,clip08x:0,clip08y:0,clip09x:0,clip09y:0},this.clipAreaLine={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.clipAreaSquare={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.clipAreaDiamond={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gridSize=50,this.math=Math,this.viewRotateX=50,this.viewRotateZ=10,this.movableOption={},this.rotableOption={},this.input=null}get clipPathText(){let e="";switch(this.range.type){case"LINE":e=this.clipLine;break;case"CIRCLE":e=this.clipCircle;break;case"SQUARE":e=this.clipSquare;break;case"DIAMOND":e=this.clipDiamond;break;default:e=this.clipCorn}return e}get clipCircle(){return"circle("+(this.range.length+1.5)*this.gridSize+"px)"}get clipCorn(){let e="polygon("+this.clipAreaCorn.clip01x+"px "+this.clipAreaCorn.clip01y+"px, ";return e+=this.clipAreaCorn.clip02x+"px "+this.clipAreaCorn.clip02y+"px, ",e+=this.clipAreaCorn.clip03x+"px "+this.clipAreaCorn.clip03y+"px, ",e+=this.clipAreaCorn.clip04x+"px "+this.clipAreaCorn.clip04y+"px, ",e+=this.clipAreaCorn.clip05x+"px "+this.clipAreaCorn.clip05y+"px, ",e+=this.clipAreaCorn.clip06x+"px "+this.clipAreaCorn.clip06y+"px, ",e+=this.clipAreaCorn.clip07x+"px "+this.clipAreaCorn.clip07y+"px, ",e+=this.clipAreaCorn.clip08x+"px "+this.clipAreaCorn.clip08y+"px, ",e+=this.clipAreaCorn.clip09x+"px "+this.clipAreaCorn.clip09y+"px)",e}get clipLine(){let e="polygon("+this.clipAreaLine.clip01x+"px "+this.clipAreaLine.clip01y+"px, ";return e+=this.clipAreaLine.clip02x+"px "+this.clipAreaLine.clip02y+"px, ",e+=this.clipAreaLine.clip03x+"px "+this.clipAreaLine.clip03y+"px, ",e+=this.clipAreaLine.clip04x+"px "+this.clipAreaLine.clip04y+"px)",e}get clipSquare(){let e="polygon("+this.clipAreaSquare.clip01x+"px "+this.clipAreaSquare.clip01y+"px, ";return e+=this.clipAreaSquare.clip02x+"px "+this.clipAreaSquare.clip02y+"px, ",e+=this.clipAreaSquare.clip03x+"px "+this.clipAreaSquare.clip03y+"px, ",e+=this.clipAreaSquare.clip04x+"px "+this.clipAreaSquare.clip04y+"px)",e}get clipDiamond(){let e="polygon("+this.clipAreaDiamond.clip01x+"px "+this.clipAreaDiamond.clip01y+"px, ";return e+=this.clipAreaDiamond.clip02x+"px "+this.clipAreaDiamond.clip02y+"px, ",e+=this.clipAreaDiamond.clip03x+"px "+this.clipAreaDiamond.clip03y+"px, ",e+=this.clipAreaDiamond.clip04x+"px "+this.clipAreaDiamond.clip04y+"px)",e}get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get name(){return this.range.name}get width(){return this.adjustMinBounds(this.range.width)}get length(){return this.adjustMinBounds(this.range.length)}get opacity(){return this.range.opacity}get imageFile(){return this.range.imageFile}get isLock(){return this.range.isLock}set isLock(e){this.range.isLock=e}get areaQuadrantSize(){let e=this.width<1?1:this.width,i=this.length<1?1:this.length;return Math.ceil(Math.sqrt(e*e+i*i))+1}get rotateDeg(){let e="0.0";return this.rotate&&this.rotate.nativeElement&&this.rotate.nativeElement.style&&this.rotate.nativeElement.style.transform?(e=this.rotate.nativeElement.style.transform.replace(/[^0-9\.\-]/g,""),e||(e="0.0"),parseFloat(e)):0}get altitude(){return this.range.altitude}set altitude(e){this.range.altitude=e}get isAltitudeIndicate(){return this.range.isAltitudeIndicate}set isAltitudeIndicate(e){this.range.isAltitudeIndicate=e}ngOnInit(){Qe.register(this).on("UPDATE_GAME_OBJECT",-1e3,e=>{let i=Xe.instance.get(e.data.identifier);this.setRange(),this.range&&i&&((this.range===i||i instanceof Si&&this.range.contains(i))&&this.changeDetector.markForCheck(),i.identifier==this.range.followingCharctorIdentifier&&(console.log("\u8ffd\u5f93\u52d5\u4f5c"),this.range.following(),this.setRange()))}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.range,transformCssOffset:"translateZ(0.25px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.range},this.setRange()}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new fa(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this),this.setRange()}ngOnDestroy(){this.input.destroy(),Qe.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLock&&Qe.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate(),o=[];o.push({name:"\u9ad8\u5ea6\u8a2d\u5b9a",action:null,subActions:[{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,$t.play(dt.sweep))},altitudeHande:this.range},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1,$t.play(dt.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0,$t.play(dt.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}]}),o.push(this.isLock?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLock=!1,$t.play(dt.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLock=!0,$t.play(dt.lock)}}),("CIRCLE"==this.range.type||"SQUARE"==this.range.type||"DIAMOND"==this.range.type)&&o.push(null!=Xe.instance.get(this.range.followingCharctorIdentifier)?{name:"\u8ffd\u5f93\u3092\u89e3\u9664",action:()=>{$t.play(dt.unlock),this.range.followingCharctorIdentifier=null}}:{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u8ffd\u5f93",action:()=>{this.dockingWindowOpen()}}),o.push(xi),o.push({name:"\u5c04\u7a0b\u7bc4\u56f2\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.range)}}),o.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let s=this.range.clone();console.log("\u30b3\u30d4\u30fc",s),s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.isLock=!1,this.range.parent&&this.range.parent.appendChild(s),$t.play(dt.cardPut)}}),o.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.range.destroy(),$t.play(dt.sweep)}}),o.push(xi),o.push({name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}),this.contextMenuService.open(i,o,this.name)}dockingWindowOpen(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(Nie,{left:e.x-250,top:e.y-175,width:350,height:200,title:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u8ffd\u5f93"}).tabletopObject=this.range}onMove(){$t.play(dt.cardPick)}onMoved(){$t.play(dt.cardPut)}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u5c04\u7a0b\u7bc4\u56f2\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(wl,{title:r,left:i.x-200,top:i.y-150,width:400,height:300}).tabletopObject=e}setRange(){let e=new Oie(this.gridCanvas.nativeElement,this.rangeCanvas.nativeElement),i={areaWidth:2*this.areaQuadrantSize,areaHeight:2*this.areaQuadrantSize,range:this.length<1?1:this.length,width:this.width<.1?.1:this.width,centerX:this.range.location.x,centerY:this.range.location.y,gridSize:this.gridSize,type:this.range.type,gridColor:this.range.gridColor,rangeColor:this.range.rangeColor,fanDegree:0,degree:this.rotateDeg,offSetX:this.range.offSetX,offSetY:this.range.offSetY,fillOutLine:this.range.fillOutLine,gridType:this.currentTable.gridType,isDocking:!!Xe.instance.get(this.range.followingCharctorIdentifier)};switch(this.range.type){case"LINE":this.clipAreaLine=e.renderLine(i);break;case"CIRCLE":e.renderCircle(i);break;case"SQUARE":this.clipAreaSquare=e.renderSquare(i);break;case"DIAMOND":this.clipAreaDiamond=e.renderDiamond(i);break;default:this.clipAreaCorn=e.renderCorn(i)}this.gridCanvas.nativeElement.style.opacity=this.range.opacity+""}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(Ym),Be(To),Be(fi),Be($n),Be(bi),Be(Di),Be($d),Be(Wm))},n.\u0275cmp=Qt({type:n,selectors:[["range"]],viewQuery:function(e,i){if(1&e&&(Gn(Bie,7),Gn(Lie,7),Gn(zie,5)),2&e){let r;yn(r=Cn())&&(i.gridCanvas=r.first),yn(r=Cn())&&(i.rangeCanvas=r.first),yn(r=Cn())&&(i.rotate=r.first)}},hostBindings:function(e,i){1&e&&Re("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{range:"range",is3D:"is3D"},decls:18,vars:33,consts:[["appMovable","",1,"dummy-will-change",3,"movable.option"],["appMovable","",1,"component","is-3d",2,"pointer-events","none",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],[1,"is-3d",3,"ngClass"],[1,"is-3d",2,"position","absolute","pointer-events","auto"],[2,"position","absolute"],[1,"image-box",3,"appTooltip"],[1,"is-fill"],["gridCanvas",""],["rangeCanvas",""],["appRotable","",1,"component-content","is-3d",2,"transform","rotateZ(0deg)",3,"rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],["rotate",""],["class","lock-icon is-center",4,"ngIf"],[4,"ngIf"],["class","is-3d","style","display: flex; flex-flow: column nowrap; justify-content: space-between; border-left: 2px dashed black; transform-origin: top left",3,"border-left-color","height","ngStyle",4,"ngIf"],[1,"is-3d",2,"position","absolute","z-index","0"],[1,"is-fill","is-3d"],["centerPunch",""],[1,"lock-icon","is-center"],[1,"material-icons"],[2,"position","absolute","width","28px"],[1,"rotate-grab","of-corn-tip","rotate-grab-icon","is-3d","will-change",2,"position","absolute"],[1,"rotate-grab","of-corn-bottom","rotate-grab-icon","is-3d","will-change"],[1,"rotate-grab","of-corn-top","rotate-grab-icon","is-3d","will-change"],[1,"is-3d",2,"display","flex","flex-flow","column nowrap","justify-content","space-between","border-left","2px dashed black","transform-origin","top left",3,"ngStyle"],[1,"is-3d"],[1,"elevation-indicator","is-3d",2,"position","absolute"],[1,"elevation-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"is-3d",3,"ngStyle"]],template:function(e,i){1&e&&(it(0,"div",0),J(1,"div",1),Re("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),J(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),it(6,"canvas",6,7)(8,"canvas",6,8),oe()(),J(10,"div",9,10),Re("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Ee(12,Hie,3,0,"div",11),Ee(13,Vie,11,2,"ng-container",12),oe()()(),Ee(14,Uie,20,44,"div",13),J(15,"div",14),it(16,"canvas",15,16),oe()()),2&e&&(ie("movable.option",i.movableOption),j(1),ie("ngClass",Nt(29,jie,!i.isLock))("movable.option",i.movableOption)("movable.disable",i.isLock),j(1),un("transform","translateZ("+i.altitude*i.gridSize+"px)"),ie("ngClass",Nt(31,Gie,0==i.altitude)),j(1),un("width",0,"px")("height",0,"px")("clip-path",i.clipPathText),j(1),un("top",0,"px")("left",-1*i.areaQuadrantSize*i.gridSize,"px"),j(1),ie("appTooltip",i.range),j(5),ie("rotable.option",i.rotableOption)("rotable.disable",i.isLock),j(2),ie("ngIf",i.isLock),j(1),ie("ngIf",!i.isLock&&"CIRCLE"!=i.range.type&&"SQUARE"!=i.range.type&&"DIAMOND"!=i.range.type),j(1),ie("ngIf",i.isAltitudeIndicate&&(i.altitude<=-.5||.5<=i.altitude)),j(1),un("visibility",0!=i.altitude?"visible":"hidden")("top",0,"px")("left",-1*i.areaQuadrantSize*i.gridSize,"px"))},directives:[bd,ir,qw,Uf,Sn,Co],styles:[".is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.dummy-will-change[_ngcontent-%COMP%]{position:absolute;height:1px;width:1px;will-change:opacity}.image[_ngcontent-%COMP%]{display:block}.lock-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px}.is-center[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;margin:auto}.border[_ngcontent-%COMP%]{box-sizing:border-box;border:solid 2px #CCCCCC}.is-fit-full[_ngcontent-%COMP%]{height:100%;width:100%}.pedestal-grab-corn[_ngcontent-%COMP%]{z-index:-1;position:absolute;top:-14px;left:-14px;right:14px;bottom:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;position:absolute;top:-14px;left:-14px;right:-14px;bottom:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:1}.rotate-grab[_ngcontent-%COMP%]{opacity:0;z-index:-1}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:30px;height:30px;box-sizing:border-box;border:solid 2px #CCCCCC;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:0;background-color:#ccc;border-radius:100%;color:#444;font-size:24px;transform-style:preserve-3d;transform:translateZ(.1px)}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.will-change[_ngcontent-%COMP%]{will-change:opacity}.of-corn-top[_ngcontent-%COMP%]{top:-30px;left:-15px;border-radius:15px 15px 0 0}.of-corn-bottom[_ngcontent-%COMP%]{bottom:-30px;left:-15px;border-radius:0 0 15px 15px}.of-corn-tip[_ngcontent-%COMP%]{top:-15px;left:-15px;border-radius:15px}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px;border-radius:14px 7px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px;border-radius:7px 14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px;border-radius:14px 7px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px;border-radius:7px 14px}.is-fill[_ngcontent-%COMP%]{display:block;position:absolute;top:0;left:0;bottom:0;right:0;margin:auto}.fall[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.altitude-indicator[_ngcontent-%COMP%]{font-size:10px}.elevation-indicator[_ngcontent-%COMP%], .altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;color:#000;text-shadow:whitesmoke 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.elevation-indicator[_ngcontent-%COMP%]{font-weight:bolder;font-size:12px}"],changeDetection:0}),n})();function Wie(n,t){1&n&&(J(0,"div",14)(1,"div",15)(2,"div",16),we(3,"autorenew"),oe(),J(4,"div",17),we(5,"autorenew"),oe()()())}function Zie(n,t){if(1&n&&(Je(0),Ee(1,Wie,6,0,"div",13),et()),2&n){const e=$e();j(1),ie("ngIf",!e.isLock)}}function Yie(n,t){if(1&n&&(J(0,"span"),we(1),oe()),2&n){const e=$e(2);j(1),xt(e.face)}}function Kie(n,t){1&n&&(J(0,"span"),we(1,"???"),oe())}function Xie(n,t){1&n&&(Je(0),J(1,"i",20),we(2,"lock"),oe(),et())}const Ww=function(n){return{transform:n}};function Qie(n,t){if(1&n&&(J(0,"div",18)(1,"div",19),we(2),Ee(3,Yie,2,1,"span",6),Ee(4,Kie,2,0,"span",6),Ee(5,Xie,3,0,"ng-container",6),oe()()),2&n){const e=$e();ie("ngStyle",Nt(5,Ww,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),j(2),sn("",e.name,":"),j(1),ie("ngIf",e.isVisible),j(1),ie("ngIf",!e.isVisible),j(1),ie("ngIf",e.isLock)}}function Jie(n,t){if(1&n&&(J(0,"span"),we(1),oe()),2&n){const e=$e(2);j(1),xt(e.face)}}function ere(n,t){1&n&&(J(0,"span"),we(1,"???"),oe())}function tre(n,t){1&n&&(Je(0),J(1,"i",20),we(2,"lock"),oe(),et())}function nre(n,t){if(1&n&&(J(0,"div",18)(1,"div",19),we(2),Ee(3,Jie,2,1,"span",6),Ee(4,ere,2,0,"span",6),Ee(5,tre,3,0,"ng-container",6),oe()()),2&n){const e=$e();ie("ngStyle",Nt(5,Ww,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateY(180deg)")),j(2),sn("",e.name,":"),j(1),ie("ngIf",e.isVisible),j(1),ie("ngIf",!e.isVisible),j(1),ie("ngIf",e.isLock)}}function ire(n,t){if(1&n&&(J(0,"div",21)(1,"div",22),we(2),oe(),J(3,"div",23),we(4),oe()()),2&n){const e=$e();ie("ngStyle",Nt(3,Ww,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),j(2),xt(e.ownerName),j(2),xt(e.ownerName)}}const rre=function(n,t){return{height:n,transform:t}},iF=function(n,t){return{"is-black-mask":n,"is-harf-black-mask":t}};function ore(n,t){if(1&n&&(it(0,"img",24),At(1,"safe")),2&n){const e=$e();ie("ngStyle",hi(6,rre,+e.imageHeignt+"px","translateX(-50%) translateX("+e.size*e.gridSize/2+"px)"))("src",Ft(1,3,e.imageFile.url,"resourceUrl"),hn)("ngClass",hi(9,iF,!e.isVisible,e.isMine))}}const sre=function(){return{width:"100%"}};function are(n,t){if(1&n&&(it(0,"img",24),At(1,"safe")),2&n){const e=$e();ie("ngStyle",$r(6,sre))("src",Ft(1,3,e.imageFile.url,"resourceUrl"),hn)("ngClass",hi(7,iF,!e.isVisible,e.isMine))}}const lre=function(n){return{"is-gray-border":n}};let cre=(()=>{class n{constructor(e,i,r,o,s,a,g,w){this.ngZone=e,this.panelService=i,this.contextMenuService=r,this.elementRef=o,this.changeDetector=s,this.imageService=a,this.pointerDeviceService=g,this.chatMessageService=w,this.diceSymbol=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null}get face(){return this.diceSymbol.face}set face(e){this.diceSymbol.face=e}get owner(){return this.diceSymbol.owner}set owner(e){this.diceSymbol.owner=e}get rotate(){return this.diceSymbol.rotate}set rotate(e){this.diceSymbol.rotate=e}get name(){return this.diceSymbol.name}set name(e){this.diceSymbol.name=e}get size(){return this.adjustMinBounds(this.diceSymbol.size)}get imageHeignt(){return this.diceSymbol.komaImageHeignt}get specifyImageFlag(){return this.diceSymbol.specifyKomaImageFlag}get isEnDice(){return this.diceSymbol.isEnDice}get faces(){return this.diceSymbol.faces}get imageFile(){return this.imageService.getEmptyOr(this.diceSymbol.imageFile)}get isMine(){return this.diceSymbol.isMine}get hasOwner(){return this.diceSymbol.hasOwner}get ownerName(){return this.diceSymbol.ownerName}get isVisible(){return this.diceSymbol.isVisible}get isLock(){return this.diceSymbol.isLock}set isLock(e){this.diceSymbol.isLock=e}get isIconHidden(){return null!=this.iconHiddenTimer}ngOnInit(){Qe.register(this).on("ROLL_DICE_SYMBOL",e=>{e.data.identifier===this.diceSymbol.identifier&&this.ngZone.run(()=>{this.animeState="inactive",this.changeDetector.markForCheck(),setTimeout(()=>{this.animeState="active",this.changeDetector.markForCheck()})})}).on("UPDATE_GAME_OBJECT",e=>{let i=Xe.instance.get(e.data.identifier);!this.diceSymbol||!i||(this.diceSymbol===i||i instanceof Si&&this.diceSymbol.contains(i)||i instanceof _t&&i.userId===this.diceSymbol.owner)&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=_t.findByPeerId(e.data.peerId);(!i||this.diceSymbol.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.diceSymbol,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.diceSymbol},this.diceSymbol.isEnDice&&(this.sendMessage("EN\u30c0\u30a4\u30b9\u751f\u6210["+this.face+"]"),Qe.call("ROLL_DICE_SYMBOL",{identifier:this.diceSymbol.identifier}))}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new fa(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),Qe.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onInputStart(e){this.startDoubleClickTimer(e),this.startIconHiddenTimer(),this.isLock&&Qe.trigger("DRAG_LOCKED_OBJECT",{})}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100&&this.isVisible&&(this.isEnDice?(this.isEnDice&&this.sendMessage("EN\u30c0\u30a4\u30b9\u6d88\u8cbb["+this.face+"]"),this.diceSymbol.destroy(),$t.play(dt.sweep)):this.diceRoll())}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];if(this.isVisible&&r.push({name:"\u30c0\u30a4\u30b9\u3092\u632f\u308b",action:()=>{let o=this.face;this.diceRoll(),this.isEnDice&&this.sendMessage("EN\u30c0\u30a4\u30b9\u30ea\u30ed\u30fc\u30eb["+o+"]\u2192["+this.face+"]")}}),r.length&&r.push(xi),(this.isMine||this.hasOwner)&&r.push({name:"\u30c0\u30a4\u30b9\u3092\u516c\u958b",action:()=>{this.owner="",$t.play(dt.unlock)}}),!this.isMine&&!this.isEnDice&&r.push({name:"\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{this.owner=bt.peerContext.userId,$t.play(dt.lock)}}),this.isVisible){let o=[];this.faces.forEach(s=>{o.push({name:`${s}`,action:()=>{this.isEnDice&&this.sendMessage("EN\u30c0\u30a4\u30b9\u624b\u52d5\u5909\u66f4["+this.face+"]\u2192["+s+"]"),this.face=s,$t.play(dt.dicePut)}})}),r.push({name:"\u30c0\u30a4\u30b9\u76ee\u3092\u8a2d\u5b9a",action:null,subActions:o})}r.push(xi),r.push(this.isLock?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLock=!1,$t.play(dt.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLock=!0,$t.play(dt.lock)}}),r.push(xi),r.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.diceSymbol)}}),this.isEnDice||r.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let o=this.diceSymbol.clone();o.location.x+=this.gridSize,o.location.y+=this.gridSize,o.update(),$t.play(dt.dicePut)}}),r.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.isEnDice&&this.sendMessage("EN\u30c0\u30a4\u30b9\u524a\u9664["+this.face+"]"),this.diceSymbol.destroy(),$t.play(dt.sweep)}}),this.contextMenuService.open(i,r,this.name)}onMove(){$t.play(dt.dicePick)}onMoved(){$t.play(dt.dicePut)}diceRoll(){return Qe.call("ROLL_DICE_SYMBOL",{identifier:this.diceSymbol.identifier}),$t.play(dt.diceRoll1),this.diceSymbol.diceRoll()}showDetail(e){Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(wl,{title:r,left:i.x-300,top:i.y-300,width:600,height:600}).tabletopObject=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}adjustMinBounds(e,i=0){return e<i?i:e}sendMessage(e){const r=Xe.instance.get("ChatTabList").systemMessageTab;this.chatMessageService.sendMessage(r,e+" <\u81ea\u52d5\u30e1\u30c3\u30bb\u30fc\u30b8>",null,_t.myCursor.identifier)}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be($n),Be(To),Be(fi),Be(bi),Be(Op),Be(Di),Be(go))},n.\u0275cmp=Qt({type:n,selectors:[["dice-symbol"]],hostBindings:function(e,i){1&e&&Re("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{diceSymbol:"diceSymbol",is3D:"is3D"},decls:16,vars:22,consts:[["appMovable","",1,"dummy-will-change",3,"movable.option"],["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"pedestal-inner",3,"ngClass"],[1,"pedestal-outer"],[4,"ngIf"],[1,"upright-transform","is-fit-width","is-3d"],[1,"rotate-frame","is-3d"],[1,"rotate-inner","is-3d"],["class","name-tag is-nowrap is-black-background is-3d will-change backface-off",3,"ngStyle",4,"ngIf"],["class","owner-tag is-nowrap is-black-background is-3d will-change",3,"ngStyle",4,"ngIf"],["class","image is-3d chrome-smooth-image-trick",3,"ngStyle","src","ngClass",4,"ngIf"],["class","pedestal-grab rotate-grab is-3d will-change",4,"ngIf"],[1,"pedestal-grab","rotate-grab","is-3d","will-change"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"name-tag","is-nowrap","is-black-background","is-3d","will-change","backface-off",3,"ngStyle"],[1,"is-3d"],[1,"material-icons","lock-icon",2,"display","inline"],[1,"owner-tag","is-nowrap","is-black-background","is-3d","will-change",3,"ngStyle"],[1,"fornt-tag","has-length-limit","is-3d"],[1,"back-tag","has-length-limit","is-3d"],[1,"image","is-3d","chrome-smooth-image-trick",3,"ngStyle","src","ngClass"]],template:function(e,i){1&e&&(it(0,"div",0),J(1,"div",1),Re("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),J(2,"div",2)(3,"div",3),Re("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),it(4,"div",4)(5,"div",5),Ee(6,Zie,2,1,"ng-container",6),J(7,"div",2),Re("@diceRoll.done",function(o){return i.animationShuffleDone(o)}),J(8,"div",7)(9,"div",8)(10,"div",9),Ee(11,Qie,6,7,"div",10),Ee(12,nre,6,7,"div",10),Ee(13,ire,5,5,"div",11),Ee(14,ore,2,12,"img",12),Ee(15,are,2,10,"img",12),oe()()()()()()()),2&e&&(ie("movable.option",i.movableOption),j(1),un("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),ie("movable.option",i.movableOption),j(1),ie("@bounceInOut","in"),j(1),ie("rotable.option",i.rotableOption),j(1),ie("ngClass",Nt(20,lre,i.hasOwner)),j(2),ie("ngIf",!i.isIconHidden),j(1),ie("@diceRoll",i.animeState),j(2),un("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),j(2),ie("ngIf",0<i.name.length),j(1),ie("ngIf",0<i.name.length),j(1),ie("ngIf",i.hasOwner&&0<i.ownerName.length),j(1),ie("ngIf",0<i.imageFile.url.length&&i.specifyImageFlag),j(1),ie("ngIf",0<i.imageFile.url.length&&!i.specifyImageFlag))},directives:[bd,Uf,ir,Sn,Co],pipes:[Ii],styles:[".is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.will-change[_ngcontent-%COMP%]{will-change:opacity}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.dummy-will-change[_ngcontent-%COMP%]{position:absolute;height:1px;width:1px;will-change:opacity}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:22px}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px rgb(216,139,75);border-radius:5px}.is-gray-border[_ngcontent-%COMP%]{border-color:#999}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:5px}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;height:auto;vertical-align:bottom}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:6px;position:absolute;top:-30px}.owner-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:12px;padding:3px 9px;border-radius:6px;position:absolute;top:-55px}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.fornt-tag[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.back-tag[_ngcontent-%COMP%]{position:absolute;top:3px;-webkit-backface-visibility:hidden;backface-visibility:hidden;transform:rotateY(-180deg)}.backface-off[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.lock-icon[_ngcontent-%COMP%]{font-size:15px;vertical-align:middle}"],data:{animation:[Na("diceRoll",[Lr("* => active",[Br("800ms ease",Ls([mn({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(0deg)",offset:0}),mn({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(360deg)",offset:.5}),mn({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(520deg)",offset:.75}),mn({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(630deg)",offset:.875}),mn({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(720deg)",offset:1})]))])]),Na("bounceInOut",[Lr("void => *",[Br("600ms ease",Ls([mn({transform:"scale3d(0, 0, 0)",offset:0}),mn({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),mn({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),mn({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),mn({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Lr("* => void",[Br(100,mn({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),n})();const ure=["root"],dre=function(){return{border:"solid 6px #FFCC80"}};function fre(n,t){1&n&&it(0,"div",20),2&n&&Qn($r(2,dre))}const hre=function(){return{border:"solid 6px #A0E0FF"}};function pre(n,t){1&n&&it(0,"div",20),2&n&&Qn($r(2,hre))}function gre(n,t){1&n&&(J(0,"div",21)(1,"div",22)(2,"div",23),we(3,"autorenew"),oe(),J(4,"div",24),we(5,"autorenew"),oe()()())}const rF=function(n,t){return{height:n,transform:t}};function _re(n,t){if(1&n&&(it(0,"img",25),At(1,"safe")),2&n){const e=$e();ie("ngStyle",hi(5,rF,+e.gameCharacter.komaImageHeignt+"px","translateX(-50%) translateX("+e.size*e.gridSize/2+"px) scaleY(0.5) translateY(-150%) translateY("+e.size*e.gridSize+"px)"))("src",Ft(1,2,e.imageFile.url,"resourceUrl"),hn)}}const mre=function(n){return{width:"100%",transform:n}};function $re(n,t){if(1&n&&(it(0,"img",25),At(1,"safe")),2&n){const e=$e();ie("ngStyle",Nt(5,mre,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px) scaleY(0.5) translateY(-150%) translateY("+e.size*e.gridSize+"px)"))("src",Ft(1,2,e.imageFile.url,"resourceUrl"),hn)}}function vre(n,t){if(1&n&&(J(0,"div",35),it(1,"div",37),oe()),2&n){const e=t.$implicit,i=$e(6);j(1),ie("gameDataElement",e)("isEdit",i.isEdit)("isPieceMode",!0)}}const yd=function(n){return{transform:n}};function bre(n,t){if(1&n){const e=pt();J(0,"div",29)(1,"div",30),it(2,"img",15),oe(),J(3,"div",13)(4,"div",31),Re("mousedown",function(){return Le(e),$e(5).foldingBuffFlag(!0)}),we(5,"\u25bc"),oe(),J(6,"div",32),Ee(7,vre,2,3,"div",33),oe()(),J(8,"div",13)(9,"div",31),Re("mousedown",function(){return Le(e),$e(5).foldingBuffFlag(!1)}),we(10,"\u25b2"),oe(),J(11,"div",34)(12,"div",35)(13,"div",36),we(14),oe()()()()()}if(2&n){const e=$e(5);ie("ngStyle",Nt(6,yd,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px) translateY(-100%)")),j(1),ie("hidden",!e.gameCharacter.targeted),j(2),ie("hidden",e.foldingBuff),j(4),ie("ngForOf",e.gameCharacter.buffDataElement.children),j(1),ie("hidden",!e.foldingBuff),j(6),sn("\u7c21\u6613\u8868\u793a\u4e2d/\u30d0\u30d5",e.buffNum,"\u500b")}}function yre(n,t){if(1&n&&(J(0,"div",35),it(1,"div",37),oe()),2&n){const e=t.$implicit,i=$e(6);j(1),ie("gameDataElement",e)("isEdit",i.isEdit)("isPieceMode",!0)}}const Cre=function(){return{transform:"rotateY(180deg)"}};function xre(n,t){if(1&n){const e=pt();J(0,"div",29)(1,"div",38),it(2,"img",15),oe(),J(3,"div",13)(4,"div",31),Re("mousedown",function(){return Le(e),$e(5).foldingBuffFlag(!0)}),we(5,"\u25bc"),oe(),J(6,"div",34),Ee(7,yre,2,3,"div",33),oe()(),J(8,"div",13)(9,"div",31),Re("mousedown",function(){return Le(e),$e(5).foldingBuffFlag(!1)}),we(10,"\u25b2"),oe(),J(11,"div",34)(12,"div",35)(13,"div",36),we(14),oe()()()()()}if(2&n){const e=$e(5);ie("ngStyle",Nt(7,yd,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px) translateY(-100%) rotateY(180deg)")),j(1),ie("hidden",!e.gameCharacter.targeted)("ngStyle",$r(9,Cre)),j(2),ie("hidden",e.foldingBuff),j(4),ie("ngForOf",e.gameCharacter.buffDataElement.children),j(1),ie("hidden",!e.foldingBuff),j(6),sn("\u7c21\u6613\u8868\u793a\u4e2d/\u30d0\u30d5",e.buffNum,"\u500b")}}function wre(n,t){if(1&n&&(Je(0),Ee(1,bre,15,8,"div",28),Ee(2,xre,15,10,"div",28),et()),2&n){const e=$e(4);j(1),ie("ngIf",e.gameCharacter.buffDataElement),j(1),ie("ngIf",e.gameCharacter.buffDataElement)}}function Ere(n,t){if(1&n&&(Je(0),Ee(1,wre,3,2,"ng-container",16),et()),2&n){const e=t.$implicit;j(1),ie("ngIf",e.children.length>0)}}function Tre(n,t){if(1&n&&(Je(0),Ee(1,Ere,2,1,"ng-container",27),et()),2&n){const e=$e(2);j(1),ie("ngForOf",e.gameCharacter.buffDataElement.children)}}function Sre(n,t){if(1&n&&(J(0,"div",26),Ee(1,Tre,2,1,"ng-container",16),oe()),2&n){const e=$e();j(1),ie("ngIf",1==e.gameCharacter.buffDataElement.children.length)}}function Dre(n,t){1&n&&(Je(0),J(1,"i",42),we(2,"lock"),oe(),et())}const oF=function(n){return{transform:n,"background-color":"rgba(255,255,255, 0.6)",color:"#333",border:"solid 1px #555"}};function Ire(n,t){if(1&n&&(J(0,"div",40)(1,"div",41),we(2),Ee(3,Dre,3,0,"ng-container",16),oe()()),2&n){const e=$e(2);ie("ngStyle",Nt(3,oF,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),j(2),sn("",e.name," "),j(1),ie("ngIf",e.isLock)}}function kre(n,t){1&n&&(Je(0),J(1,"i",42),we(2,"lock"),oe(),et())}function Mre(n,t){if(1&n&&(J(0,"div",40)(1,"div",41),we(2),Ee(3,kre,3,0,"ng-container",16),oe()()),2&n){const e=$e(2);ie("ngStyle",Nt(3,oF,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateY(180deg)")),j(2),sn("",e.name," "),j(1),ie("ngIf",e.isLock)}}function Are(n,t){if(1&n&&(Je(0),Ee(1,Ire,4,5,"div",39),Ee(2,Mre,4,5,"div",39),et()),2&n){const e=$e();j(1),ie("ngIf",0<e.name.length),j(1),ie("ngIf",0<e.name.length)}}function Pre(n,t){1&n&&(Je(0),J(1,"i",42),we(2,"lock"),oe(),et())}function Fre(n,t){if(1&n&&(J(0,"div",40)(1,"div",41),we(2),Ee(3,Pre,3,0,"ng-container",16),oe()()),2&n){const e=$e(2);ie("ngStyle",Nt(3,yd,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),j(2),sn("",e.name," "),j(1),ie("ngIf",e.isLock)}}function Rre(n,t){1&n&&(Je(0),J(1,"i",42),we(2,"lock"),oe(),et())}function Nre(n,t){if(1&n&&(J(0,"div",40)(1,"div",41),we(2),Ee(3,Rre,3,0,"ng-container",16),oe()()),2&n){const e=$e(2);ie("ngStyle",Nt(3,yd,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateY(180deg)")),j(2),sn("",e.name," "),j(1),ie("ngIf",e.isLock)}}function Ore(n,t){if(1&n&&(Je(0),Ee(1,Fre,4,5,"div",39),Ee(2,Nre,4,5,"div",39),et()),2&n){const e=$e();j(1),ie("ngIf",0<e.name.length),j(1),ie("ngIf",0<e.name.length)}}function Bre(n,t){if(1&n&&(J(0,"div",43)(1,"div",44)(2,"i",45),we(3,"autorenew"),oe()()()),2&n){const e=$e();j(1),ie("ngStyle",Nt(1,yd,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px) translateY( -0px)"))}}function Lre(n,t){if(1&n&&(it(0,"img",46),At(1,"safe")),2&n){const e=$e();ie("ngStyle",hi(5,rF,+e.gameCharacter.komaImageHeignt+"px","translateX(-50%) translateX("+e.size*e.gridSize/2+"px)"))("src",Ft(1,2,e.imageFile.url,"resourceUrl"),hn)}}const zre=function(){return{width:"100%"}};function Hre(n,t){if(1&n&&(it(0,"img",46),At(1,"safe")),2&n){const e=$e();ie("ngStyle",$r(5,zre))("src",Ft(1,2,e.imageFile.url,"resourceUrl"),hn)}}function Vre(n,t){1&n&&(Je(0),J(1,"i",45),we(2,"autorenew"),oe(),et())}function Ure(n,t){if(1&n&&(J(0,"div",48),Ee(1,Vre,3,0,"ng-container",16),oe()),2&n){const e=$e(2);ie("ngStyle",Nt(2,yd,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px")),j(1),ie("ngIf",!e.isLock)}}function jre(n,t){if(1&n&&(J(0,"div",43),Ee(1,Ure,2,4,"div",47),oe()),2&n){const e=$e();j(1),ie("ngIf",!e.isLock)}}const sF=function(n){return{transform:n}};function Gre(n,t){if(1&n&&(J(0,"div",49)(1,"div",26)(2,"span",50)(3,"i"),we(4),oe()(),J(5,"span",51)(6,"i"),we(7),oe()()(),J(8,"div",26)(9,"span",52),we(10),oe(),J(11,"span",53),we(12),oe()(),J(13,"div",54)(14,"span",50)(15,"i"),we(16),oe()(),J(17,"span",51)(18,"i"),we(19),oe()()()()),2&n){const e=$e();un("height",e.math.abs(e.altitude*e.gridSize)-0,"px"),ie("ngStyle",Nt(14,sF,"translateX("+e.size*e.gridSize/2+"px) translateY("+-e.size*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),j(1),un("visibility",e.altitude>0?"visible":"hidden"),j(3),xt(e.elevation),j(3),xt(e.elevation),j(3),xt(e.math.abs(e.altitude)),j(2),xt(e.math.abs(e.altitude)),j(1),un("visibility",e.altitude<0?"visible":"hidden"),ie("ngStyle",Nt(16,sF,"translateY("+(e.chatBubbleAltitude+4)+"px)")),j(3),xt(e.elevation),j(3),xt(e.elevation)}}let qre=(()=>{class n{constructor(e,i,r,o,s,a){this.ngZone=e,this.contextMenuService=i,this.elementRef=r,this.panelService=o,this.changeDetector=s,this.pointerDeviceService=a,this.gameCharacter=null,this.is3D=!1,this.foldingBuff=!1,this.gridSize=50,this.math=Math,this.viewRotateX=50,this.viewRotateZ=10,this.movableOption={},this.input=null,this.rotableOption={}}get isLock(){return this.gameCharacter.isLock}set isLock(e){this.gameCharacter.isLock=e}get name(){return this.gameCharacter.name}get size(){return this.adjustMinBounds(this.gameCharacter.size)}get altitude(){return this.gameCharacter.altitude}set altitude(e){this.gameCharacter.altitude=e}get imageFile(){return this.gameCharacter.imageFile}get rotate(){return this.gameCharacter.rotate}set rotate(e){this.gameCharacter.rotate=e}get roll(){return this.gameCharacter.roll}set roll(e){this.gameCharacter.roll=e}get isDropShadow(){return this.gameCharacter.isDropShadow}set isDropShadow(e){this.gameCharacter.isDropShadow=e}get isAltitudeIndicate(){return this.gameCharacter.isAltitudeIndicate}set isAltitudeIndicate(e){this.gameCharacter.isAltitudeIndicate=e}get elevation(){return+((this.gameCharacter.posZ+this.altitude*this.gridSize)/this.gridSize).toFixed(1)}get chatBubbleAltitude(){return 0}ngOnInit(){Qe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Xe.instance.get(e.data.identifier);!this.gameCharacter||!i||(this.gameCharacter===i||i instanceof Si&&this.gameCharacter.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateX=e.data.x,this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("CHK_TARGET_CHANGE",-1e3,e=>{Xe.instance.get(e.data.identifier)==this.gameCharacter&&this.changeDetector.detectChanges()}).on("HIGHTLIGHT_TABLETOP_OBJECT",e=>{this.gameCharacter.identifier===e.data.identifier&&"table"==this.gameCharacter.location.name&&(console.log(`recv focus event to ${this.gameCharacter.name}`),null==this.highlightTimer&&(this.rootElementRef.nativeElement.classList.contains("focused")&&(clearTimeout(this.unhighlightTimer),this.rootElementRef.nativeElement.classList.remove("focused")),this.highlightTimer=setTimeout(()=>{this.highlightTimer=null,this.rootElementRef.nativeElement.classList.add("focused")},0),this.unhighlightTimer=setTimeout(()=>{this.unhighlightTimer=null,this.rootElementRef.nativeElement.classList.remove("focused")},1010)))}),this.movableOption={tabletopObject:this.gameCharacter,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.gameCharacter}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new fa(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),Qe.unregister(this)}onDragstart(e){console.log("Dragstart Cancel !!!!"),e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLock&&Qe.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:"\u9ad8\u5ea6\u8a2d\u5b9a",action:null,subActions:[{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,$t.play(dt.sweep))},altitudeHande:this.gameCharacter},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1,$t.play(dt.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0,$t.play(dt.sweep),Qe.trigger("UPDATE_INVENTORY",null)}},this.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!1,$t.play(dt.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!0,$t.play(dt.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}]},xi,{name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.gameCharacter)}},{name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(this.gameCharacter)}},{name:"\u30ea\u30e2\u30b3\u30f3\u3092\u8868\u793a",action:()=>{this.showRemoteController(this.gameCharacter)}},{name:"\u30d0\u30d5\u7de8\u96c6",action:()=>{this.showBuffEdit(this.gameCharacter)}},xi,{name:"\u5171\u6709\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{this.gameCharacter.setLocation("common"),$t.play(dt.piecePut)}},{name:"\u500b\u4eba\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{this.gameCharacter.setLocation(bt.peerId),$t.play(dt.piecePut)}},{name:"\u5893\u5834\u306b\u79fb\u52d5",action:()=>{this.gameCharacter.setLocation("graveyard"),$t.play(dt.sweep)}},xi,this.isLock?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLock=!1,$t.play(dt.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLock=!0,$t.play(dt.lock)}},xi,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.gameCharacter.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.update(),$t.play(dt.piecePut)}}],this.name)}deleteGameObject(e){e.destroy(),this.changeDetector.markForCheck()}onMove(){$t.play(dt.piecePick)}onMoved(){$t.play(dt.piecePut)}checkKey(e){let i=e||window.event,r=i.shiftKey,o=i.ctrlKey,s=i.altKey,a=i.metaKey;if(r&&console.log("shift\u30ad\u30fc"),o&&console.log("ctrl\u30ad\u30fc"),s&&(console.log("alt\u30ad\u30fc"),this.gameCharacter.targeted=!this.gameCharacter.targeted),a&&console.log("meta\u30ad\u30fc"),r&&s){console.log("shift+ALT\u30ad\u30fc");let g=Xe.instance.getObjects(Lt);for(let w of g)w.targeted=!1,Qe.trigger("CHK_TARGET_CHANGE",{identifier:w.identifier,className:w.aliasName})}}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(wl,{title:r,left:i.x-400,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(BP,{left:i.x-250,top:i.y-175,width:615,height:350}).character=e}showRemoteController(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(HP,{left:i.x-250,top:i.y-175,width:700,height:600}).character=e}showBuffEdit(e){let i=this.pointerDeviceService.pointers[0],r={left:i.x,top:i.y,width:420,height:300};r.title=e.name+"\u306e\u30d0\u30d5\u7de8\u96c6",this.panelService.open(zP,r).character=e}foldingBuffFlag(e){console.log("private foldingBuffFlag"),this.foldingBuff=e}get buffNum(){return 0==this.gameCharacter.buffDataElement.children.length?0:this.gameCharacter.buffDataElement.children[0].children.length}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(To),Be(fi),Be($n),Be(bi),Be(Di))},n.\u0275cmp=Qt({type:n,selectors:[["game-character"]],viewQuery:function(e,i){if(1&e&&Gn(ure,5),2&e){let r;yn(r=Cn())&&(i.rootElementRef=r.first)}},hostBindings:function(e,i){1&e&&Re("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{gameCharacter:"gameCharacter",is3D:"is3D"},decls:25,vars:34,consts:[["appMovable","",1,"dummy-will-change",3,"movable.option"],["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend","mousedown"],["root",""],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],["class","pedestal-inner is-3d",3,"style",4,"ngIf"],[1,"pedestal-outer"],["class","pedestal-grab rotate-grab will-change",4,"ngIf"],["class","image is-pointer-events-none chrome-smooth-image-trick","style","filter: brightness(0) opacity(0.7) blur(1px);",3,"ngStyle","src",4,"ngIf"],[1,"upright-transform","is-fit-width","is-3d",3,"ngStyle"],["appRotable","",1,"rotate-frame","is-3d",3,"rotable.value","rotable.valueChange","rotable.ondragstart","rotable.ondragend"],[1,"rotate-inner","is-3d"],["class","is-3d",4,"ngIf"],[3,"hidden"],[1,"target-icon","scrolldown4",3,"hidden","ngStyle"],["src","./assets/images/target/target.png"],[4,"ngIf"],["class","grab-group is-3d",4,"ngIf"],["class","image is-3d chrome-smooth-image-trick",3,"ngStyle","src",4,"ngIf"],["class","is-3d","style","display: flex; flex-flow: column nowrap; justify-content: space-between; border-left: 2px dashed black; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],[1,"pedestal-inner","is-3d"],[1,"pedestal-grab","rotate-grab","will-change"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"image","is-pointer-events-none","chrome-smooth-image-trick",2,"filter","brightness(0) opacity(0.7) blur(1px)",3,"ngStyle","src"],[1,"is-3d"],[4,"ngFor","ngForOf"],["style","","class","buff-tag is-nowrap is-buff-background is-3d will-change backface-off",3,"ngStyle",4,"ngIf"],[1,"buff-tag","is-nowrap","is-buff-background","is-3d","will-change","backface-off",3,"ngStyle"],[1,"target-icon-buff","scrolldown5",3,"hidden"],[1,"buff-folding-icon",3,"mousedown"],[1,"!table","is-3d"],["class","flex-item is-3d",4,"ngFor","ngForOf"],[1,"table","is-3d"],[1,"flex-item","is-3d"],[1,"table-row","fornt-tag","is-3d",2,"font-family","Cambria, Georgia","font-size","12px"],["game-data-element-buff","",1,"table-row","fornt-tag","is-3d",3,"gameDataElement","isEdit","isPieceMode"],[1,"target-icon-buff2","scrolldown5",3,"hidden","ngStyle"],["class","name-tag is-nowrap is-black-background is-3d will-change backface-off",3,"ngStyle",4,"ngIf"],[1,"name-tag","is-nowrap","is-black-background","is-3d","will-change","backface-off",3,"ngStyle"],[1,"has-length-limit","is-3d"],[1,"material-icons","lock-icon",2,"display","inline"],[1,"grab-group","is-3d"],[1,"rotate-grab","rotate-grab-icon","of-top","is-3d","will-change",3,"ngStyle"],[1,"material-icons","will-change"],[1,"image","is-3d","chrome-smooth-image-trick",3,"ngStyle","src"],["class","rotate-grab rotate-grab-icon of-bottom is-3d will-change",3,"ngStyle",4,"ngIf"],[1,"rotate-grab","rotate-grab-icon","of-bottom","is-3d","will-change",3,"ngStyle"],[1,"is-3d",2,"display","flex","flex-flow","column nowrap","justify-content","space-between","border-left","2px dashed black","transform-origin","top left",3,"ngStyle"],[1,"elevation-indicator","is-3d",2,"position","absolute"],[1,"elevation-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"is-3d",3,"ngStyle"]],template:function(e,i){1&e&&(it(0,"div",0),J(1,"div",1,2),Re("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()})("mousedown",function(o){return i.checkKey(o)}),J(3,"div",3)(4,"div",4),Re("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Ee(5,fre,1,3,"div",5),Ee(6,pre,1,3,"div",5),it(7,"div",6),Ee(8,gre,6,0,"div",7),Ee(9,_re,2,8,"img",8),Ee(10,$re,2,7,"img",8),J(11,"div",9)(12,"div",10),Re("rotable.valueChange",function(o){return i.roll=o})("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),J(13,"div",11),Ee(14,Sre,2,1,"div",12),J(15,"div",13)(16,"div",14),it(17,"img",15),oe()(),Ee(18,Are,3,2,"ng-container",16),Ee(19,Ore,3,2,"ng-container",16),Ee(20,Bre,4,3,"div",17),Ee(21,Lre,2,8,"img",18),Ee(22,Hre,2,6,"img",18),Ee(23,jre,2,1,"div",17),oe()()()(),Ee(24,Gre,20,18,"div",19),oe()()),2&e&&(ie("movable.option",i.movableOption),j(1),un("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),ie("movable.option",i.movableOption),j(2),ie("@bounceInOut","in"),j(1),ie("rotable.option",i.rotableOption),j(1),ie("ngIf",!i.gameCharacter.hideInventory),j(1),ie("ngIf",i.gameCharacter.hideInventory),j(2),ie("ngIf",!i.isLock),j(1),ie("ngIf",i.isDropShadow&&0<i.imageFile.url.length&&i.gameCharacter.specifyKomaImageFlag),j(1),ie("ngIf",i.isDropShadow&&0<i.imageFile.url.length&&!i.gameCharacter.specifyKomaImageFlag),j(1),ie("ngStyle",Nt(30,yd,"rotateY(90deg) rotateZ(-90deg) rotateY(-90deg) translateY(-50%) translateY("+-i.altitude*i.gridSize+"px)")),j(1),un("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),ie("rotable.value",i.roll),j(2),ie("ngIf",i.gameCharacter.buffDataElement),j(1),ie("hidden",0!=i.buffNum),j(1),ie("hidden",!i.gameCharacter.targeted)("ngStyle",Nt(32,yd,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px)")),j(2),ie("ngIf",i.gameCharacter.nonTalkFlag),j(1),ie("ngIf",!i.gameCharacter.nonTalkFlag),j(1),ie("ngIf",!i.isLock),j(1),ie("ngIf",0<i.imageFile.url.length&&i.gameCharacter.specifyKomaImageFlag),j(1),ie("ngIf",0<i.imageFile.url.length&&!i.gameCharacter.specifyKomaImageFlag),j(1),ie("ngIf",!i.isLock),j(1),ie("ngIf",i.isAltitudeIndicate&&(i.altitude<=-.5||.5<=i.altitude)))},directives:[bd,Uf,Sn,Co,si,LP],pipes:[Ii],styles:['[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.will-change[_ngcontent-%COMP%]{will-change:opacity}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.upright-transform[_ngcontent-%COMP%]{transition:transform 132ms ease}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.dummy-will-change[_ngcontent-%COMP%]{position:absolute;height:1px;width:1px;will-change:opacity}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:37px}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px #FFCC80;border-radius:25px}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:25px}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;height:auto;vertical-align:bottom}.buff-tag[_ngcontent-%COMP%]{box-sizing:border-box;padding:3px 9px;border:1px #222 solid;border-radius:12px;position:absolute;margin:auto;top:-35px}.is-buff-background[_ngcontent-%COMP%]{color:#222;background-color:#f0e5d7cc}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:-30px}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc;-webkit-backface-visibility:hidden;backface-visibility:hidden}.backface-off[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:24em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.altitude-indicator[_ngcontent-%COMP%]{font-size:10px}.elevation-indicator[_ngcontent-%COMP%], .altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;color:#000;text-shadow:#f5f5f5 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.elevation-indicator[_ngcontent-%COMP%]{font-weight:bolder;font-size:12px}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.component.focused[_ngcontent-%COMP%]{animation-name:focused;animation-timing-function:ease;animation-duration:1s}.lock-icon[_ngcontent-%COMP%]{font-size:15px;vertical-align:middle}@keyframes focused{0%{box-shadow:none}50%{box-shadow:0 0 10px 5px #ff0,inset 0 0 10px 5px #ff0}to{box-shadow:none}}.buff-folding-dummy[_ngcontent-%COMP%]{width:1px;height:1px}.buff-folding-icon[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle;text-align:center;margin-left:100%;position:absolute;width:20px;height:20px;left:-20px;top:-20px;background-color:#f0e5d7cc;box-sizing:border-box;border:1px #222 solid;border-radius:4px;cursor:pointer}.target-icon[_ngcontent-%COMP%]{width:30px;font-size:20px;left:6px;box-sizing:border-box;position:absolute}.scrolldown4[_ngcontent-%COMP%]{position:absolute;animation:arrowmove 1s ease-in-out infinite}@keyframes arrowmove{0%{top:-80px}to{top:-60px}}.scrolldown4[_ngcontent-%COMP%]:before{top:-60px}.scrolldown4[_ngcontent-%COMP%]:after{content:"";position:absolute;top:-80px}.target-icon-buff[_ngcontent-%COMP%]{width:30px;font-size:20px;margin-left:50%;left:-10px;box-sizing:border-box;position:absolute;margin-top:}.target-icon-buff2[_ngcontent-%COMP%]{width:30px;font-size:20px;margin-left:50%;left:-20px;box-sizing:border-box;position:absolute;margin-top:}.scrolldown5[_ngcontent-%COMP%]{position:absolute;animation:arrowmove2 1s ease-in-out infinite}@keyframes arrowmove2{0%{top:-50px}to{top:-30px}}.scrolldown5[_ngcontent-%COMP%]:before{top:-30px}.scrolldown5[_ngcontent-%COMP%]:after{content:"";position:absolute;top:-50px}'],data:{animation:[Na("bounceInOut",[Lr("void => *",[Br("600ms ease",Ls([mn({transform:"scale3d(0, 0, 0)",offset:0}),mn({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),mn({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),mn({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),mn({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Lr("* => void",[Br(100,mn({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),n})();const Wre=["root"],Zre=["gameTable"],Yre=["gameObjects"],Kre=["gridCanvas"];function Xre(n,t){1&n&&it(0,"terrain",21),2&n&&ie("terrain",t.$implicit)}function Qre(n,t){if(1&n&&(J(0,"div",19),it(1,"div",15),Ee(2,Xre,1,1,"terrain",20),oe()),2&n){const e=$e();j(2),ie("ngForOf",e.terrains)("ngForTrackBy",e.trackByGameObject)}}function Jre(n,t){1&n&&it(0,"game-table-mask",22),2&n&&ie("gameTableMask",t.$implicit)}function eoe(n,t){1&n&&it(0,"game-table-scratch-mask",23),2&n&&ie("gameTableScratchMask",t.$implicit)}const toe=function(n){return{"z-index":n}};function noe(n,t){if(1&n&&it(0,"text-note",25),2&n){const e=t.$implicit;ie("textNote",e)("appTooltip",e)("ngStyle",Nt(3,toe,e.zindex))}}function ioe(n,t){if(1&n&&(J(0,"div",19),it(1,"div",15),Ee(2,noe,1,5,"text-note",24),oe()),2&n){const e=$e();j(2),ie("ngForOf",e.textNotes)("ngForTrackBy",e.trackByGameObject)}}const aF=function(n,t){return{"z-index":n,transform:t}};function roe(n,t){if(1&n&&it(0,"card-stack",26),2&n){const e=t.$implicit;ie("cardStack",e)("appTooltip",e)("ngStyle",hi(3,aF,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function ooe(n,t){if(1&n&&it(0,"card",27),2&n){const e=t.$implicit;ie("card",e)("appTooltip",e)("ngStyle",hi(3,aF,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function soe(n,t){1&n&&it(0,"peer-cursor",28),2&n&&ie("cursor",t.$implicit)}function aoe(n,t){1&n&&it(0,"range",29),2&n&&ie("range",t.$implicit)}function loe(n,t){if(1&n&&it(0,"dice-symbol",31),2&n){const e=t.$implicit;ie("diceSymbol",e)("appTooltip",e)}}function coe(n,t){if(1&n&&(J(0,"div",19),it(1,"div",15),Ee(2,loe,1,2,"dice-symbol",30),oe()),2&n){const e=$e();j(2),ie("ngForOf",e.diceSymbols)("ngForTrackBy",e.trackByGameObject)}}function uoe(n,t){if(1&n&&it(0,"game-character",33),2&n){const e=t.$implicit;ie("gameCharacter",e)("appTooltip",e)}}function doe(n,t){if(1&n&&(J(0,"div",19),it(1,"div",15),Ee(2,uoe,1,2,"game-character",32),oe()),2&n){const e=$e();j(2),ie("ngForOf",e.characters)("ngForTrackBy",e.trackByGameObject)}}function foe(n,t){1&n&&it(0,"peer-cursor",28),2&n&&ie("cursor",t.$implicit)}const hoe=function(n,t){return[n,t]},poe=function(n){return{"is-grabbing":n}};let goe=(()=>{class n{constructor(e,i,r,o,s,a,g,w,W){this.changeDetector=e,this.ngZone=i,this.contextMenuService=r,this.pointerDeviceService=o,this.coordinateService=s,this.imageService=a,this.tabletopService=g,this.tabletopActionService=w,this.modalService=W,this.isTableTransformMode=!1,this.isTableTransformed=!1,this.viewPotisonX=100,this.viewPotisonY=0,this.viewPotisonZ=0,this.viewRotateX=50,this.viewRotateY=0,this.viewRotateZ=10,this.mouseGesture=null,this.touchGesture=null}get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get tableImage(){return this.imageService.getSkeletonOr(this.currentTable.imageIdentifier)}get backgroundImage(){return this.imageService.getEmptyOr(this.currentTable.backgroundImageIdentifier)}get backgroundFilterType(){return this.currentTable.backgroundFilterType}get roomGridDispAlways(){let e=Xe.instance.get("Config");return!!e&&e.roomGridDispAlways}set roomGridDispAlways(e){let i=Xe.instance.get("Config");i&&(i.roomGridDispAlways=e)}get isPointerDragging(){return this.pointerDeviceService.isDragging}get characters(){return this.tabletopService.characters}get tableMasks(){return this.tabletopService.tableMasks}get tableScratchMasks(){return this.tabletopService.tableScratchMasks}get cards(){return this.tabletopService.cards}get cardStacks(){return this.tabletopService.cardStacks}get ranges(){return this.tabletopService.ranges}get terrains(){return this.tabletopService.terrains}get textNotes(){return this.tabletopService.textNotes}get diceSymbols(){return this.tabletopService.diceSymbols}get peerCursors(){return this.tabletopService.peerCursors}ngOnInit(){Qe.register(this).on("UPDATE_GAME_OBJECT",e=>{e.data.identifier!==this.currentTable.identifier&&e.data.identifier!==this.tableSelecter.identifier||(console.log("UPDATE_GAME_OBJECT GameTableComponent "+this.currentTable.identifier),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor))}).on("RE_DRAW_TABLE",e=>{console.log("\u30c6\u30fc\u30d6\u30eb\u518d\u63cf\u753b"),this.changeDetector.detectChanges(),this.changeDetector.markForCheck()}).on("DRAG_LOCKED_OBJECT",e=>{this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1;let i=this.tableSelecter.gridShow?1:0;this.roomGridDispAlways&&(i=1),this.gridCanvas.nativeElement.style.opacity=i+""}).on("FOCUS_TO_TABLETOP_COORDINATE",e=>{setTimeout(()=>{console.log(`move table to focus (${e.data.x}, ${e.data.y})`),this.gameTable.nativeElement.style.transition="0.2s ease-out",setTimeout(()=>{this.gameTable.nativeElement.style.transition=null},100);let o=e.data.x-this.gridCanvas.nativeElement.clientWidth/2,s=e.data.y-this.gridCanvas.nativeElement.clientHeight/2,a=this.viewRotateZ/180*Math.PI,g=o*Math.cos(a)-s*Math.sin(a),w=o*Math.sin(a)+s*Math.cos(a),W=this.viewRotateX/180*Math.PI,ve=w*Math.cos(W),me=w*Math.sin(W);this.setTransform(100-g-this.viewPotisonX,-ve-this.viewPotisonY,-me-this.viewPotisonZ,0,0,0)},50)}),this.tabletopActionService.makeDefaultTable(),this.tabletopActionService.makeDefaultTabletopObjects(),this.tabletopActionService.initAprilDiceImage()}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.initializeTableTouchGesture(),this.initializeTableMouseGesture()}),this.cancelInput(),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor),this.setTransform(0,0,0,0,0,0),this.coordinateService.tabletopOriginElement=this.gameObjects.nativeElement}ngOnDestroy(){Qe.unregister(this),this.mouseGesture.destroy(),this.touchGesture.destroy()}initializeTableTouchGesture(){this.touchGesture=new Qee(this.rootElementRef.nativeElement,this.ngZone),this.touchGesture.onstart=this.onTableTouchStart.bind(this),this.touchGesture.onend=this.onTableTouchEnd.bind(this),this.touchGesture.ongesture=this.onTableTouchGesture.bind(this),this.touchGesture.ontransform=this.onTableTouchTransform.bind(this)}initializeTableMouseGesture(){this.mouseGesture=new Xee(this.rootElementRef.nativeElement),this.mouseGesture.onstart=this.onTableMouseStart.bind(this),this.mouseGesture.onend=this.onTableMouseEnd.bind(this),this.mouseGesture.ontransform=this.onTableMouseTransform.bind(this)}onTableTouchStart(){this.mouseGesture.cancel()}onTableTouchEnd(){this.cancelInput()}onTableTouchGesture(){this.cancelInput()}onTableTouchTransform(e,i,r,o,s,a,g,w){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),w.cancelable&&w.preventDefault();let W=(1e3+Math.abs(this.viewPotisonZ))/1e3;80<o+this.viewRotateX&&(o+=80-(o+this.viewRotateX)),o+this.viewRotateX<0&&(o+=0-(o+this.viewRotateX)),750<r+this.viewPotisonZ&&(r+=750-(r+this.viewPotisonZ)),this.setTransform(e*=W,i*=W,r,o,s,a),this.isTableTransformed=!0}onTableMouseStart(e){e.target.contains(this.gameObjects.nativeElement)||1===e.button||2===e.button?this.isTableTransformMode=!0:(this.isTableTransformMode=!1,this.pointerDeviceService.isDragging=!0,this.gridCanvas.nativeElement.style.opacity="1",Qe.trigger("DISP_TERRAIN_GRID",{})),document.activeElement.contains(e.target)||(this.removeSelectionRanges(),this.removeFocus())}onTableMouseEnd(e){this.cancelInput(),Qe.trigger("DISP_TERRAIN_GRID_END",{})}onTableMouseTransform(e,i,r,o,s,a,g,w){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),w.cancelable&&w.preventDefault();let W=(1e3+Math.abs(this.viewPotisonZ))/1e3;this.setTransform(e*=W,i*=W,r,o,s,a),this.isTableTransformed=!0}cancelInput(){this.mouseGesture.cancel(),this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1;let e=this.tableSelecter.gridShow?1:0;this.roomGridDispAlways&&(e=1),this.gridCanvas.nativeElement.style.opacity=e+""}onContextMenu(e){if(!document.activeElement.contains(this.gameObjects.nativeElement)||(e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate(),o=[];Array.prototype.push.apply(o,this.tabletopActionService.makeDefaultContextMenuActions(r)),o.push(xi),o.push({name:"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a",action:()=>{this.modalService.open(VP)}}),this.contextMenuService.open(i,o,this.currentTable.name)}onDocumentMouseDown(e){this.isTableTransformed=!1}onDocumentTouchStart(e){this.isTableTransformed=!1}onDocumentContextMenu(e){this.isTableTransformed&&!this.pointerDeviceService.isAllowedToOpenContextMenu&&e.preventDefault()}setTransform(e,i,r,o,s,a){this.viewRotateX+=o,this.viewRotateY+=s,this.viewRotateZ+=a,this.viewPotisonX+=e,this.viewPotisonY+=i,this.viewPotisonZ+=r,(0!=o||0!=s||0!=o)&&this.ngZone.run(()=>{Qe.trigger("TABLE_VIEW_ROTATE",{x:this.viewRotateX,y:this.viewRotateY,z:this.viewRotateZ})}),this.gameTable.nativeElement.style.transform=`translateZ(${this.viewPotisonZ.toFixed(4)}px) translateY(${this.viewPotisonY.toFixed(4)}px) translateX(${this.viewPotisonX.toFixed(4)}px) rotateY(${this.viewRotateY.toFixed(4)}deg) rotateX(${this.viewRotateX.toFixed(4)+"deg) rotateZ("+this.viewRotateZ.toFixed(4)}deg)`}setGameTableGrid(e,i,r=50,o=bs.SQUARE,s="#000000e6"){this.gameTable.nativeElement.style.width=e*r+"px",this.gameTable.nativeElement.style.height=i*r+"px",new WP(this.gridCanvas.nativeElement).render(e,i,r,o,s),setTimeout(()=>{let g=this.tableSelecter.gridShow?1:0;this.roomGridDispAlways&&(g=1),this.gridCanvas.nativeElement.style.opacity=g+"",console.log("\u30b0\u30ea\u30c3\u30c9\u63cf\u753b")},0)}removeSelectionRanges(){let e=window.getSelection();e.isCollapsed||e.removeAllRanges()}removeFocus(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}trackByGameObject(e,i){return i.identifier}}return n.\u0275fac=function(e){return new(e||n)(Be(bi),Be(An),Be(To),Be(Di),Be($d),Be(Op),Be(Wm),Be(Ym),Be(pi))},n.\u0275cmp=Qt({type:n,selectors:[["game-table"]],viewQuery:function(e,i){if(1&e&&(Gn(Wre,7),Gn(Zre,7),Gn(Yre,7),Gn(Kre,7)),2&e){let r;yn(r=Cn())&&(i.rootElementRef=r.first),yn(r=Cn())&&(i.gameTable=r.first),yn(r=Cn())&&(i.gameObjects=r.first),yn(r=Cn())&&(i.gridCanvas=r.first)}},hostBindings:function(e,i){1&e&&Re("contextmenu",function(o){return i.onContextMenu(o)})("mousedown",function(o){return i.onDocumentMouseDown(o)},!1,Ah)("touchstart",function(o){return i.onDocumentTouchStart(o)},!1,Ah)("contextmenu",function(o){return i.onDocumentContextMenu(o)},!1,Ah)},decls:26,vars:35,consts:[[1,"background-image","is-pointer-events-none",3,"ngClass"],[1,"component","is-fill","is-perspective",3,"ngClass"],["root",""],[1,"component-content","is-fill","is-3d-2"],["gameTable",""],["id","app-game-table",1,"game-table","table-image","is-3d-2"],["gameObjects",""],[1,"grid-canvas","is-fill","is-pointer-events-none"],["gridCanvas",""],["class","layer",4,"ngIf"],["class","is-3d will-change-transform",3,"gameTableMask",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d will-change-transform",3,"gameTableScratchMask",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d will-change-transform",3,"cardStack","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d will-change-transform",3,"card","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],[1,"range"],[1,"dummy"],["class","is-3d will-change-transform",3,"cursor",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d will-change-transform",3,"range",4,"ngFor","ngForOf","ngForTrackBy"],[1,"layer","cursor-layer"],[1,"layer"],["class","is-3d will-change-transform",3,"terrain",4,"ngFor","ngForOf","ngForTrackBy"],[1,"is-3d","will-change-transform",3,"terrain"],[1,"is-3d","will-change-transform",3,"gameTableMask"],[1,"is-3d","will-change-transform",3,"gameTableScratchMask"],["class","is-3d will-change-transform",3,"textNote","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],[1,"is-3d","will-change-transform",3,"textNote","appTooltip","ngStyle"],[1,"is-3d","will-change-transform",3,"cardStack","appTooltip","ngStyle"],[1,"is-3d","will-change-transform",3,"card","appTooltip","ngStyle"],[1,"is-3d","will-change-transform",3,"cursor"],[1,"is-3d","will-change-transform",3,"range"],["class","is-3d will-change-transform",3,"diceSymbol","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],[1,"is-3d","will-change-transform",3,"diceSymbol","appTooltip"],["class","is-3d will-change-transform",3,"gameCharacter","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],[1,"is-3d","will-change-transform",3,"gameCharacter","appTooltip"]],template:function(e,i){1&e&&(J(0,"div",0),At(1,"safe"),oe(),J(2,"div",1,2)(4,"div",3,4)(6,"div",5,6),At(8,"safe"),it(9,"canvas",7,8),Ee(11,Qre,3,2,"div",9),Ee(12,Jre,1,1,"game-table-mask",10),Ee(13,eoe,1,1,"game-table-scratch-mask",11),Ee(14,ioe,3,2,"div",9),Ee(15,roe,1,6,"card-stack",12),Ee(16,ooe,1,6,"card",13),J(17,"div",14),it(18,"div",15),Ee(19,soe,1,1,"peer-cursor",16),oe(),Ee(20,aoe,1,1,"range",17),Ee(21,coe,3,2,"div",9),Ee(22,doe,3,2,"div",9),J(23,"div",18),it(24,"div",15),Ee(25,foe,1,1,"peer-cursor",16),oe()()()()),2&e&&(un("background-image",Ft(1,24,"url("+i.backgroundImage.url+")","style")),ie("ngClass",hi(30,hoe,i.backgroundFilterType?"is-filter":"",i.backgroundFilterType)),j(2),ie("ngClass",Nt(33,poe,i.isPointerDragging)),j(4),un("background-image",Ft(8,27,"url("+i.tableImage.url+")","style")),j(5),ie("ngIf",i.terrains.length>0),j(1),ie("ngForOf",i.tableMasks)("ngForTrackBy",i.trackByGameObject),j(1),ie("ngForOf",i.tableScratchMasks)("ngForTrackBy",i.trackByGameObject),j(1),ie("ngIf",i.textNotes.length>0),j(1),ie("ngForOf",i.cardStacks)("ngForTrackBy",i.trackByGameObject),j(1),ie("ngForOf",i.cards)("ngForTrackBy",i.trackByGameObject),j(3),ie("ngForOf",i.peerCursors)("ngForTrackBy",i.trackByGameObject),j(1),ie("ngForOf",i.ranges)("ngForTrackBy",i.trackByGameObject),j(1),ie("ngIf",i.diceSymbols.length>0),j(1),ie("ngIf",i.characters.length>0),j(3),ie("ngForOf",i.peerCursors)("ngForTrackBy",i.trackByGameObject))},directives:[ir,Sn,si,_te,Bte,qte,qw,Co,yie,Sie,Pie,qie,cre,qre],pipes:[Ii],styles:['[_nghost-%COMP%]{display:block}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-perspective[_ngcontent-%COMP%]{perspective:1000px}.is-fill[_ngcontent-%COMP%]{display:block;position:absolute;top:0;left:0;bottom:0;right:0;margin:auto}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d;-webkit-backface-visibility:visible;backface-visibility:visible;position:absolute}.is-3d-2[_ngcontent-%COMP%]{transform-style:preserve-3d;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute}.will-change-transform[_ngcontent-%COMP%]{will-change:transform;-webkit-backface-visibility:visible;backface-visibility:visible}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.dummy[_ngcontent-%COMP%]{position:absolute;height:1px;width:1px;content:"";will-change:opacity;pointer-events:none;transform-style:preserve-3d;-webkit-backface-visibility:hidden;backface-visibility:hidden;transform:translate(0)}.layer[_ngcontent-%COMP%]{transform-style:preserve-3d;position:absolute;pointer-events:none;top:0;left:0;bottom:0;right:0;margin:auto}.component[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;touch-action:manipulation;height:100%;width:100%;overflow:hidden}.component-content[_ngcontent-%COMP%]{height:2000px;width:2000px}.grid-canvas[_ngcontent-%COMP%]{opacity:0;transform:translateZ(.15px);transition:.3s ease-out;-webkit-backface-visibility:hidden;backface-visibility:hidden}.game-table[_ngcontent-%COMP%]{height:100%;width:100%}.table-image[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;background-repeat:no-repeat;background-size:100% 100%}.background-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:0;right:0;margin:-5px;background-repeat:no-repeat;background-position:center;background-size:cover}.background-image.is-filter[_ngcontent-%COMP%]{will-change:filter}.background-image.is-filter.white[_ngcontent-%COMP%], .background-image.is-filter.black[_ngcontent-%COMP%]{filter:blur(5px)}.background-image.is-filter[_ngcontent-%COMP%]:after{display:block;content:"";width:100%;height:100%}.background-image.is-filter.white[_ngcontent-%COMP%]:after{background-color:#f7f7f7;filter:opacity(.2)}.background-image.is-filter.black[_ngcontent-%COMP%]:after{background-color:#1a1a1a;filter:opacity(.3)}']}),n})(),_oe=(()=>{class n{constructor(e){this.elementRef=e,this.timer=null,this.needRepeat=!1}ngAfterViewInit(){let e=()=>{this.needRepeat?(this.timer=setTimeout(e,650),this.needRepeat=!1):(this.timer=null,this.elementRef.nativeElement.style.display="none")};Qe.register(this).on("*",i=>{this.needRepeat||bt.bandwidthUsage<3072||(null===this.timer?(this.elementRef.nativeElement.style.display="block",this.timer=setTimeout(e,650)):this.needRepeat=!0)})}ngOnDestroy(){Qe.unregister(this)}}return n.\u0275fac=function(e){return new(e||n)(Be(fi))},n.\u0275cmp=Qt({type:n,selectors:[["network-indicator"]],decls:12,vars:0,consts:[[1,"sk-cube-grid"],[1,"sk-cube","sk-cube1"],[1,"sk-cube","sk-cube2"],[1,"sk-cube","sk-cube3"],[1,"sk-cube","sk-cube4"],[1,"sk-cube","sk-cube5"],[1,"sk-cube","sk-cube6"],[1,"sk-cube","sk-cube7"],[1,"sk-cube","sk-cube8"],[1,"sk-cube","sk-cube9"],[1,"sk-title"]],template:function(e,i){1&e&&(J(0,"div",0),it(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),J(10,"div",10),we(11,"sync"),oe()())},styles:["[_nghost-%COMP%]{display:block}.sk-cube-grid[_ngcontent-%COMP%]{font-size:8px;color:#444;height:100%;width:100%;background-color:#f7f7f799}.sk-cube[_ngcontent-%COMP%]{background-color:#555}.sk-title[_ngcontent-%COMP%]{padding:2px 0;background-color:#f7f7f799}"]}),n})();const moe=["modalLayer"];function $oe(n,t){if(1&n){const e=pt();J(0,"li",2),Re("click",function(){return Le(e),$e().save()}),J(1,"a",3)(2,"div")(3,"i",5),we(4,"sd_storage"),oe()(),J(5,"div"),we(6,"\u4fdd\u5b58"),oe()()()}}function voe(n,t){if(1&n&&(J(0,"li",11)(1,"a")(2,"div")(3,"i",12),we(4,"sd_storage"),oe()(),J(5,"div"),we(6),oe()()()),2&n){const e=$e();j(6),sn("",e.progresPercent,"%")}}let boe=(()=>{class n{constructor(e,i,r,o,s,a,g,w){var W=this;this.modalService=e,this.panelService=i,this.pointerDeviceService=r,this.chatMessageService=o,this.appConfigService=s,this.saveDataService=a,this.ngSelectConfig=g,this.ngZone=w,this.networkService=bt,this.immediateUpdateTimer=null,this.lazyUpdateTimer=null,this.openPanelCount=0,this.isSaveing=!1,this.progresPercent=0,this.dispcounter=10,this.ngZone.runOutsideAngular(()=>{Cl.instance.initialize(),Ap.instance.initialize(),Mp.instance.initialize(),Pp.instance.initialize()}),this.appConfigService.initialize(),this.pointerDeviceService.initialize(),this.ngSelectConfig.appendTo="body",da.instance.initialize(),Vs.instance.initialize(),Of.instance.initialize(),ja.instance.initialize(),new sr("DiceBot").initialize(),sr.getHelpMessage("").then(()=>this.lazyNgZoneUpdate(!0)),new zf("Jukebox").initialize(),new Lw("markdwon").initialize(),new mc("CutInLauncher").initialize(),new xl("Vote").initialize(),new Ga("Alarm").initialize(),new Bw("ReloadCheck").initialize(),new $t("SoundEffect").initialize(),Vs.instance.addChatTab("\u30e1\u30a4\u30f3\u30bf\u30d6","MainTab"),Vs.instance.addChatTab("\u30b5\u30d6\u30bf\u30d6","SubTab");let ut=Bt.createEmpty("none_icon").toContext();ut.url="./assets/images/ic_account_circle_black_24dp_2x.png";let ot=St.instance.add(ut);Jt.resumeAudioContext(),dt.dicePick=en.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,dt.dicePut=en.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,dt.diceRoll1=en.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu01.mp3").identifier,dt.diceRoll2=en.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu02.mp3").identifier,dt.cardDraw=en.instance.add("./assets/sounds/soundeffect-lab/card-turn-over1.mp3").identifier,dt.cardPick=en.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,dt.cardPut=en.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,dt.cardShuffle=en.instance.add("./assets/sounds/soundeffect-lab/card-open1.mp3").identifier,dt.piecePick=en.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,dt.piecePut=en.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,dt.blockPick=en.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,dt.blockPut=en.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,dt.lock=en.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,dt.unlock=en.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,dt.sweep=en.instance.add("./assets/sounds/tm2/tm2_swing003.wav").identifier,dt.alarm=en.instance.add("./assets/sounds/alarm/alarm.mp3").identifier,en.instance.get(dt.dicePick).isHidden=!0,en.instance.get(dt.dicePut).isHidden=!0,en.instance.get(dt.diceRoll1).isHidden=!0,en.instance.get(dt.diceRoll2).isHidden=!0,en.instance.get(dt.cardDraw).isHidden=!0,en.instance.get(dt.cardPick).isHidden=!0,en.instance.get(dt.cardPut).isHidden=!0,en.instance.get(dt.cardShuffle).isHidden=!0,en.instance.get(dt.piecePick).isHidden=!0,en.instance.get(dt.piecePut).isHidden=!0,en.instance.get(dt.blockPick).isHidden=!0,en.instance.get(dt.blockPut).isHidden=!0,en.instance.get(dt.lock).isHidden=!0,en.instance.get(dt.unlock).isHidden=!0,en.instance.get(dt.sweep).isHidden=!0,en.instance.get(dt.alarm).isHidden=!0,_t.createMyCursor(),_t.myCursor.name="\u30d7\u30ec\u30a4\u30e4\u30fc",_t.myCursor.imageIdentifier=ot.identifier,Qe.register(this).on("ALARM_TIMEUP_ORIGIN",ft=>{this.alarmTimeUpOrigin(ft.data.text)}).on("ALARM_POP",ft=>{this.alarmPop(ft.data.title,ft.data.time)}).on("START_VOTE",ft=>{this.startVote()}).on("FINISH_VOTE",ft=>{this.finishVote(ft.data.text)}).on("START_CUT_IN",ft=>{this.startCutIn(ft.data.cutIn)}).on("STOP_CUT_IN",ft=>{!ft.data.cutIn||console.log("\u30ab\u30c3\u30c8\u30a4\u30f3\u30a4\u30d9\u30f3\u30c8_\u30b9\u30c8\u30c3\u30d7"+ft.data.cutIn.name)}).on("UPDATE_GAME_OBJECT",ft=>{this.lazyNgZoneUpdate(ft.isSendFromSelf)}).on("DELETE_GAME_OBJECT",ft=>{this.lazyNgZoneUpdate(ft.isSendFromSelf)}).on("SYNCHRONIZE_AUDIO_LIST",ft=>{ft.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("SYNCHRONIZE_FILE_LIST",ft=>{ft.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("LOAD_CONFIG",ft=>{console.log("LOAD_CONFIG !!!"),bt.setApiKey(ft.data.webrtc.key),bt.open()}).on("FILE_LOADED",ft=>{this.lazyNgZoneUpdate(!1)}).on("OPEN_NETWORK",ft=>{console.log("OPEN_NETWORK",ft.data.peerId),_t.myCursor.peerId=bt.peerContext.peerId,_t.myCursor.userId=bt.peerContext.userId}).on("NETWORK_ERROR",ft=>{console.log("NETWORK_ERROR",ft.data.peerId);let Ot=ft.data.errorType,Et=ft.data.errorMessage;this.ngZone.run((0,xn.Z)(function*(){["peer-unavailable"].includes(Ot)||(yield W.modalService.open(Uw,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:Et}),["disconnected","socket-error","unavailable-id","authentication","server-error"].includes(Ot)&&(yield W.modalService.open(Uw,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:"\u3053\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b\u3068\u518d\u63a5\u7d9a\u3092\u8a66\u307f\u307e\u3059\u3002"}),bt.open()))}))}).on("CONNECT_PEER",ft=>{ft.isSendFromSelf&&this.chatMessageService.calibrateTimeOffset(),this.lazyNgZoneUpdate(ft.isSendFromSelf)}).on("DISCONNECT_PEER",ft=>{this.lazyNgZoneUpdate(ft.isSendFromSelf)})}get reloadCheck(){return Xe.instance.get("ReloadCheck")}ngAfterViewInit(){$n.defaultParentViewContainerRef=pi.defaultParentViewContainerRef=To.defaultParentViewContainerRef=this.modalLayerViewContainerRef,setTimeout(()=>{this.panelService.open(UP,{width:500,height:450,left:100}),this.panelService.open(NP,{width:700,height:400,left:100,top:450})},0)}ngOnDestroy(){Qe.unregister(this)}alarmTimeUpOrigin(e){Xe.instance.get("Alarm"),this.chatMessageService.sendSystemMessageLastSendCharactor(e)}alarmTimeUpTarget(e){Xe.instance.get("Alarm"),this.chatMessageService.sendSystemMessageLastSendCharactor(e)}startVote(){if(console.log("\u70b9\u547c/\u6295\u7968\u30a4\u30d9\u30f3\u30c8_\u30b9\u30bf\u30fc\u30c8"),!Xe.instance.get("Vote").chkToMe())return;let i={left:0,top:0,width:450,height:400,title:"\u70b9\u547c/\u6295\u7968"},r=(window.innerWidth-i.width)/2,o=(window.innerHeight-i.height)/2;r<0&&(r=0),o<0&&(o=0),i.left=r,i.top=o,this.panelService.open(Wee,i)}finishVote(e){console.log("\u6295\u7968\u96c6\u8a08\u5b8c\u4e86"),this.chatMessageService.sendSystemMessageLastSendCharactor(e)}alarmPop(e,i){console.log("\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7_\u30b9\u30bf\u30fc\u30c8"+e);let s={width:200,height:100,left:300,top:100};s.title="\u30a2\u30e9\u30fc\u30e0 "+e,console.log("POP\u753b\u9762\u9818\u57df w:"+window.innerWidth+" h:"+window.innerHeight),console.log("POP\u30b5\u30a4\u30ba w:200 h:100");let a=window.innerWidth-200,g=window.innerHeight-100-25;a<0&&(a=0),g<0&&(g=0);let w=.5*a,W=.5*g;s.width=200,s.height=125,s.left=w,s.top=W;let ve=this.panelService.open(Kee,s);ve.title=e,ve.time=i}startCutIn(e){if(!e)return;console.log("\u30ab\u30c3\u30c8\u30a4\u30f3\u30a4\u30d9\u30f3\u30c8_\u30b9\u30bf\u30fc\u30c8"+e.name);let i={width:200,height:100,left:300,top:100};i.title="\u30ab\u30c3\u30c8\u30a4\u30f3 : "+e.name,console.log("\u753b\u9762\u9818\u57df w:"+window.innerWidth+" h:"+window.innerHeight);let r=e.width,o=e.height;console.log("\u753b\u50cf\u30b5\u30a4\u30ba w:"+r+" h:"+o);let s=window.innerWidth-r,a=window.innerHeight-o-25;s<0&&(s=0),a<0&&(a=0);let g=s*e.x_pos/100,w=a*e.y_pos/100;i.width=r,i.height=o+25,i.left=g,i.top=w,i.isCutIn=!0,i.cutInIdentifier=e.identifier;let W=this.panelService.open(kee,i);W.cutIn=e,W.startCutIn()}open(e){let i=null,r={width:450,height:600,left:100};switch(e){case"PeerMenuComponent":i=UP;break;case"ChatWindowComponent":i=NP,r.width=700;break;case"GameTableSettingComponent":i=VP,r={width:630,height:500,left:100};break;case"FileStorageComponent":i=bZ;break;case"GameCharacterSheetComponent":i=wl;break;case"JukeboxComponent":i=mJ;break;case"GameCharacterGeneratorComponent":i=DZ,r={width:500,height:300,left:100};break;case"GameObjectInventoryComponent":i=vQ}i&&(r.top=20*(this.openPanelCount%10+1),r.left=100+5*(this.openPanelCount%20+1),this.openPanelCount=this.openPanelCount+1,this.panelService.open(i,r))}save(){var e=this;return(0,xn.Z)(function*(){if(e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=bt.peerContext&&0<bt.peerContext.roomName.length?bt.peerContext.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf";yield e.saveDataService.saveRoomAsync(i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}handleFileSelect(e){let i=e.target,r=i.files;this.reloadCheck.reloadCheckStart(""!=this.networkService.peerContext.roomName),r.length&&Cl.instance.load(r),i.value=""}lazyNgZoneUpdate(e){if(e){if(null!==this.immediateUpdateTimer)return;this.immediateUpdateTimer=setTimeout(()=>{this.immediateUpdateTimer=null,null!=this.lazyUpdateTimer&&(clearTimeout(this.lazyUpdateTimer),this.lazyUpdateTimer=null),this.ngZone.run(()=>{})},0)}else{if(null!==this.lazyUpdateTimer)return;this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,null!=this.immediateUpdateTimer&&(clearTimeout(this.immediateUpdateTimer),this.immediateUpdateTimer=null),this.ngZone.run(()=>{})},100)}}}return n.\u0275fac=function(e){return new(e||n)(Be(pi),Be($n),Be(Di),Be(go),Be(Mw),Be(ko),Be(Sk),Be(An))},n.\u0275cmp=Qt({type:n,selectors:[["app-root"]],viewQuery:function(e,i){if(1&e&&Gn(moe,7,ds),2&e){let r;yn(r=Cn())&&(i.modalLayerViewContainerRef=r.first)}},decls:61,vars:8,consts:[["id","app-table-layer",2,"position","absolute","width","100%","height","100%","overflow","hidden"],[3,"top","left","width","height","title","showTitleButtons"],[3,"click"],["routerLink","/","routerLinkActive","active"],[1,"material-icons","icon-size"],[1,"material-icons"],["type","file","multiple","","accept","application/xml,text/xml,application/zip",2,"display","none",3,"change"],[3,"click",4,"ngIf"],["style","pointer-events: none;",4,"ngIf"],["modalLayer",""],[1,"networkIndicator"],[2,"pointer-events","none"],[1,"material-icons","vibration-amine"]],template:function(e,i){1&e&&(J(0,"div",0),it(1,"game-table"),oe(),J(2,"ui-panel",1)(3,"nav")(4,"ul")(5,"li",2),Re("click",function(){return i.open("PeerMenuComponent")}),J(6,"a",3)(7,"div")(8,"i",4),we(9,"people"),oe()(),J(10,"div"),we(11,"\u63a5\u7d9a"),oe()()(),J(12,"li",2),Re("click",function(){return i.open("ChatWindowComponent")}),J(13,"a",3)(14,"div")(15,"i",4),we(16,"speaker_notes"),oe()(),J(17,"div"),we(18,"\u30c1\u30e3\u30c3\u30c8\u753b\u9762"),oe()()(),J(19,"li",2),Re("click",function(){return i.open("GameTableSettingComponent")}),J(20,"a",3)(21,"div")(22,"i",4),we(23,"layers"),oe()(),J(24,"div"),we(25,"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"),oe()()(),J(26,"li",2),Re("click",function(){return i.open("FileStorageComponent")}),J(27,"a",3)(28,"div")(29,"i",4),we(30,"photo_library"),oe()(),J(31,"div"),we(32,"\u753b\u50cf"),oe()()(),J(33,"li",2),Re("click",function(){return i.open("JukeboxComponent")}),J(34,"a",3)(35,"div")(36,"i",5),we(37,"queue_music"),oe()(),J(38,"div"),we(39,"\u97f3\u697d"),oe()()(),J(40,"li",2),Re("click",function(){return i.open("GameObjectInventoryComponent")}),J(41,"a",3)(42,"div")(43,"i",4),we(44,"folder_shared"),oe()(),J(45,"div"),we(46,"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),oe()()(),J(47,"li")(48,"a",3)(49,"label")(50,"div")(51,"i",5),we(52,"open_in_browser"),oe()(),J(53,"div"),we(54,"ZIP\u8aad\u8fbc"),oe(),J(55,"input",6),Re("change",function(o){return i.handleFileSelect(o)}),oe()()()(),Ee(56,$oe,7,0,"li",7),Ee(57,voe,7,1,"li",8),oe()()(),it(58,"div",null,9)(60,"network-indicator",10)),2&e&&(j(2),ie("top",0)("left",0)("width",105)("height",475)("title","\u30e1\u30cb\u30e5\u30fc")("showTitleButtons",!1),j(54),ie("ngIf",!i.isSaveing),j(1),ie("ngIf",i.isSaveing))},directives:[goe,qP,Sn,_oe],styles:["img[_ngcontent-%COMP%]{height:5px;width:5px}.dummydisp[_ngcontent-%COMP%]{position:absolute;color:#1e1e1e00;font-size:10px;max-height:5px}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{text-align:center;padding:5px;color:#ccc;color:#444;cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{height:128px;width:128px;font-size:8px;-webkit-user-select:none;user-select:none}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{text-decoration:none}.icon-size[_ngcontent-%COMP%]{font-size:40px}.side-menu[_ngcontent-%COMP%]{top:0px;left:0px;box-sizing:border-box;overflow:auto;position:absolute;color:#ccc;background-color:#1e1e1ecc;border:solid 1px #999;padding:0;height:100%;width:300px}.networkIndicator[_ngcontent-%COMP%]{display:none;z-index:9999;pointer-events:none;position:absolute;top:3px;right:3px;height:30px;width:30px}.vibration-amine[_ngcontent-%COMP%]{animation:vibration .2s infinite}@keyframes vibration{0%{transform:scale(1) translate(0)}50%{transform:scale(1.02,.95) translateY(5%)}to{transform:scale(1) translate(0)}}"]}),n})();$n.UIPanelComponentClass=qP,To.ContextMenuComponentClass=fZ,pi.ModalComponentClass=bJ;let yoe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ns({type:n,bootstrap:[boe]}),n.\u0275inj=ts({providers:[Mw,go,To,pi,ab,$n,Di,Wm],imports:[[aD,pL,M2,_8,WL,G9,y9]]}),n})();(function QR(){wS=!1})(),nO().bootstrapModule(yoe).catch(n=>console.error(n))},5904:(T,fe,Ce)=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),Ce(8827),Ce(4748),Ce(9202),Ce(8465);var f=Ce(3583),S=Ce(3693),te=function(){function v(D,z){this.internal=null!=z?z:f.BCDice.Base.$new(D)}return v.eval=function(D){var z=f.BCDice.Base.$eval(D);return S.parseResult(z)},Object.defineProperty(v.prototype,"randomizer",{get:function(){return this.internal.randomizer},enumerable:!1,configurable:!0}),v.prototype.eval=function(){var D=this.internal.$eval();return S.parseResult(D)},v}();fe.default=te},8827:(T,fe,Ce)=>{Ce(9993),Opal.queue(function(f){var G,V,Y,k,R,le,Z,q,S=f.module,te=f.ensure_kwargs,v=f.truthy,D=f.thrower,z=f.def,I=[],Q=f.nil,U=f.$$$;return G=I,V=q=[S(I[0],"BCDice")].concat(G),Z=[le=S(q[0],"ArithmeticEvaluator")].concat(V),k=[Y=f.get_singleton_class(le)].concat(Z),R=f.$r(k),z(Y,"$eval",function(H,A){try{D("eval_return");var C,P=Q;return null==(C=(A=te(A)).$$smap.round_type)&&(C=U(R("RoundType"),"FLOOR")),v(H)&&v(P=R("Arithmetic").$eval(H,C))?P:0}catch(L){if(L===f.t_eval_return)return L.$v;throw L}},-2)})},9202:(T,fe,Ce)=>{Ce(9993),Opal.modules.json=function(f){var Z,le,S=f.module,te=f.klass,v=f.send,D=f.Object,z=f.hash2,I=f.eqeqeq,Q=f.defs,U=f.truthy,N=f.def,G=f.return_val,re=[],q=f.nil,E=f.$$$;return function(V,le){var Y,Z=S(V,"JSON"),X=[Z].concat(le),k=f.$r(X);te(X[0],k("StandardError"),"JSONError"),te(X[0],k("JSONError"),"ParserError");var R=f.hasOwnProperty;function ee(A){try{return JSON.parse(A)}catch(M){Z.$raise(E(k("JSON"),"ParserError"),M.message)}}function H(A,M){var C,P,L,ne,F,he;switch(typeof A){case"string":case"number":return A;case"boolean":return!!A;case"undefined":return q;case"object":if(!A)return q;if(A.$$is_array){for(P=M.array_class.$new(),ne=0,F=A.length;ne<F;ne++)P.$push(H(A[ne],M));return P}for(he in L=M.object_class.$new(),A)R.call(A,he)&&(Y=[he,H(A[he],M)],v(L,"[]=",Y));return M.parse||(C=L["$[]"](k("JSON").$create_id()))==q?L:D.$const_get(C).$json_create(L)}}f.get_singleton_class(Z).$attr_accessor("create_id"),Z["$create_id="]("json_class"),Q(Z,"$[]",function(M,C){return null==C&&(C=z([],{})),I(k("String"),M)?this.$parse(M,C):this.$generate(M,C)},-2),Q(Z,"$parse",function(M,C){return null==C&&(C=z([],{})),this.$from_object(ee(M),C.$merge(z(["parse"],{parse:!0})))},-2),Q(Z,"$parse!",function(M,C){return null==C&&(C=z([],{})),this.$parse(M,C)},-2),Q(Z,"$load",function(M,C){return null==C&&(C=z([],{})),this.$from_object(ee(M),C)},-2),Q(Z,"$from_object",function(M,C){return null==C&&(C=z([],{})),U(C["$[]"]("object_class"))||C["$[]="]("object_class",k("Hash")),U(C["$[]"]("array_class"))||C["$[]="]("array_class",k("Array")),H(M,C.$$smap)},-2),Q(Z,"$generate",function(M,C){return null==C&&(C=z([],{})),M.$to_json(C)},-2),Q(Z,"$dump",function(M,C,P){var ne;return null==C&&(C=q),null==P&&(P=q),ne=this.$generate(M),U(C)?(U(C["$responds_to?"]("to_io"))&&(C=C.$to_io()),C.$write(ne),C):ne},-2)}(re[0],re),Z=te(re[0],null,"Object"),N(Z,"$to_json",function(){return this.$to_s().$to_json()}),le=S(re[0],"Enumerable"),N(le,"$to_json",function(){return this.$to_a().$to_json()}),function(V,le){var Z=te(V,null,"Array");N(Z,"$to_json",function(){for(var k=[],R=0,ee=this.length;R<ee;R++)k.push(this[R].$to_json());return"["+k.join(",")+"]"})}(re[0]),function(V,le){var Z=te(V,null,"Boolean");N(Z,"$to_json",function(){return 1==this?"true":"false"})}(re[0]),function(V,le){var Z=te(V,null,"Hash");N(Z,"$to_json",function(){for(var A,M,k=[],R=0,ee=this.$$keys,H=ee.length;R<H;R++)(A=ee[R]).$$is_string?M=this.$$smap[A]:(M=A.value,A=A.key),k.push(A.$to_s().$to_json()+":"+M.$to_json());return"{"+k.join(",")+"}"})}(re[0]),function(V,le){var Z=te(V,null,"NilClass");N(Z,"$to_json",G("null"))}(re[0]),function(V,le){var Z=te(V,null,"Numeric");N(Z,"$to_json",function(){return this.toString()})}(re[0]),function(V,le){var Z=te(V,null,"String");N(Z,"$to_json",function(){return JSON.stringify(this)})}(re[0]),function(V,le){var Z=te(V,null,"Time");N(Z,"$to_json",function(){return this.$strftime("%FT%T%z").$to_json()})}(re[0]),function(V,le){var Z=te(V,null,"Date");return N(Z,"$to_json",function(){return this.$to_s().$to_json()}),N(Z,"$as_json",function(){return this.$to_s()})}(re[0])},Opal.modules.i18n=function(f){var R,A,C,P,ee,H,S=f.module,te=f.class_variable_set,v=f.class_variable_get,D=f.def,z=f.truthy,I=f.hash2,Q=f.send,U=f.ensure_kwargs,N=f.kwrestargs,G=f.to_a,q=f.alias,E=f.klass,V=f.return_val,Z=[],Y=f.nil,X=f.$$$;return f.top.$require("json"),R=Z,H=[ee=S(Z[0],"I18n")].concat(R),A=f.get_singleton_class(ee),C=[A].concat(H),P=f.$r(C),te(C[1],"@@load_path",[]),te(C[1],"@@table",Y),D(A,"$load_path",function(){return v(C[1],"@@load_path",!1)}),D(A,"$default_locale",function(){return v(C[1],"@@default_locale",!1)}),D(A,"$default_locale=",function(ne){return te(C[1],"@@default_locale",ne)}),D(A,"$fallbacks",function(){return X(X(P("I18n"),"Locale"),"Fallbacks").$new()}),D(A,"$load_default_translation",function(){return z(v(C[1],"@@table",!1)["$nil?"]())?(te(C[1],"@@table",I([],{})),this.$load_translation(JSON.stringify(Ce(6884)))):Y}),D(A,"$load_translation",function(ne){var he;return this.$load_default_translation(),he=P("JSON").$parse(ne,I(["symbolize_names"],{symbolize_names:!0})),te(C[1],"@@table",Q(v(C[1],"@@table",!1),"merge",[he],function(O,m,l){return null==O&&(O=Y),null==m&&(m=Y),null==l&&(l=Y),m.$merge(l)}))}),D(A,"$clear_translate_table",function(){return te(C[1],"@@table",Y)}),D(A,"$translate",function(ne,F){var he,B,m,l,c=Y,h=Y,d=Y;null==(he=(F=U(F)).$$smap.locale)&&(he=Y),B=N(F,{locale:!0}),this.$load_default_translation(),m=Q(ne.$split("."),"map",[],"to_sym".$to_proc()),l=v(C[1],"@@table",!1),c=v(C[1],"@@default_locale",!1),h=z(d=Q(l,"dig",[he].concat(G(m))))?d:Q(l,"dig",[c].concat(G(m)));try{z(h["$is_a?"](P("String")))&&(h=this.$format(h,f.to_hash(B)))}catch(p){if(!f.rescue(p,[P("ArgumentError"),P("KeyError")]))throw p;f.pop_exception()}return z(d=h)?d:B["$[]"]("default")},-2),q(A,"t","translate"),function(A,M){var ne,F,he,P=[S(A,"Locale")].concat(M),L=f.$r(P);ne=P[0],F=L("Hash"),he=E(ne,F,"Fallbacks"),D(he,"$defaults=",V(Y))}(H[0],H),function(A,M){var P=[S(A,"Backend")].concat(M);S(P[0],"Simple")}(H[0],H),function(A,M){var L,C=S(A,"Thread");return[C].concat(M),L=f.get_singleton_class(C),D(L,"$current",function(){return I(["i18n_fallbacks"],{i18n_fallbacks:Y})})}(H[0],H)},Opal.modules["i18n/backend/fallbacks"]=function(f){var X,ee,A,M,k,R,S=f.module,te=f.class_variable_set,v=f.truthy,D=f.class_variable_get,z=f.def,I=f.send,Q=f.send2,U=f.find_super,N=f.hash2,G=f.find_block_super,re=f.neqeq,q=f.thrower,E=f.return_val,V=[],le=f.nil,Z=f.$$$;return X=V,R=[k=S(V[0],"I18n")].concat(X),te(R[0],"@@fallbacks",le),ee=f.get_singleton_class(k),A=[ee].concat(R),M=f.$r(A),z(ee,"$fallbacks",function(){var L=le;return te(A[1],"@@fallbacks",v(null!=A[1].$$cvars["@@fallbacks"]?"class variable":le)&&v(L=D(A[1],"@@fallbacks",!1))?L:Z(Z(M("I18n"),"Locale"),"Fallbacks").$new()),v(L=M("Thread").$current()["$[]"]("i18n_fallbacks"))?L:D(A[1],"@@fallbacks",!1)}),z(ee,"$fallbacks=",function(P){var L;return te(A[1],"@@fallbacks",v(P["$is_a?"](M("Array")))?Z(Z(M("I18n"),"Locale"),"Fallbacks").$new(P):P),L=["i18n_fallbacks",D(A[1],"@@fallbacks",!1)],I(M("Thread").$current(),"[]=",L),L[L.length-1]}),function(ee,H){var P,L,ne,F,M=[S(ee,"Backend")].concat(H);return P=M,ne=[L=S(M[0],"Fallbacks")].concat(P),F=f.$r(ne),z(L,"$translate",function he(B,O,m){try{var l=q("return"),c=he.$$p||le,h=this,d=le,p=le;return he.$$p=null,null==m&&(m=F("EMPTY_HASH")),v(m.$fetch("fallback",!0))?v(m["$[]"]("fallback_in_progress"))?Q(h,U(h,"translate",he,!1,!0),"translate",[B,O,m],c):(v(m["$[]"]("default"))&&(d=h["$extract_non_symbol_default!"](m)),p=m.$merge(N(["fallback_in_progress"],{fallback_in_progress:!0})),I(F("I18n").$fallbacks()["$[]"](B),"each",[],function _(x){var $=null==_.$$s?this:_.$$s;null==x&&(x=le);try{return I($,"catch",["exception"],function se(){var ae=null==se.$$s?this:se.$$s,Te=le;if(Te=Q(ae,G(ae,"translate",se.$$def||_.$$def||he,!1,!1),"translate",[x,O,p],null),v(Te["$nil?"]()))return le;re(B.$to_s(),x.$to_s())&&ae.$on_fallback(B,x,O,m),l.$throw(Te)},{$$s:$,$$ret:l})}catch(se){if(!f.rescue(se,[Z(F("I18n"),"InvalidLocale")]))throw se;try{return le}finally{f.pop_exception()}}},{$$s:h}),v(m["$key?"]("default"))&&v(m["$[]"]("default")["$nil?"]())?le:v(d)?Q(h,U(h,"translate",he,!1,!0),"translate",[B,le,m.$merge(N(["default"],{default:d}))],null):h.$throw("exception",Z(F("I18n"),"MissingTranslation").$new(B,O,m))):Q(h,U(h,"translate",he,!1,!0),"translate",[B,O,m],c)}catch(_){if(_===l)return _.$v;throw _}},-3),z(L,"$extract_non_symbol_default!",function(B){var m,O=le;return O=[B["$[]"]("default")].$flatten(),m=I(O,"detect",[],function(c){return null==c&&(c=le),c["$is_a?"](F("Symbol"))["$!"]()}),v(m)&&B["$[]="]("default",O["$[]"](0,O.$index(m))),m}),z(L,"$exists?",function he(B,O,m){try{var l=q("return"),c=he.$$p||le,h=this;return he.$$p=null,null==m&&(m=F("EMPTY_HASH")),v(m.$fetch("fallback",!0))?(I(F("I18n").$fallbacks()["$[]"](B),"each",[],function d(p){var _=null==d.$$s?this:d.$$s;null==p&&(p=le);try{if(!v(Q(_,G(_,"exists?",d.$$def||he,!1,!1),"exists?",[p,O],null)))return le;l.$throw(!0)}catch(x){if(!f.rescue(x,[Z(F("I18n"),"InvalidLocale")]))throw x;try{return le}finally{f.pop_exception()}}},{$$s:h,$$ret:l}),!1):Q(h,U(h,"exists?",he,!1,!0),"exists?",[B,O,m],c)}catch(d){if(d===l)return d.$v;throw d}},-3),L.$private(),z(L,"$on_fallback",E(le))}(R[0],R)},Opal.modules["bcdice/randomizer"]=function(f){var k,C,P,L,ne,F,ee,H,te=f.klass,v=f.const_set,D=f.def,z=f.truthy,I=f.rb_gt,Q=f.rb_plus,U=f.rb_le,N=f.send,G=f.rb_minus,re=f.eqeq,q=f.rb_times,E=f.eqeqeq,V=f.rb_ge,le=[],Z=f.nil,Y=f.$$$;return k=le,ee=[(0,f.module)(le[0],"BCDice")].concat(k),H=f.$r(ee),C=ee,L=[P=te(ee[0],null,"Randomizer")].concat(C),ne=f.$r(L),(F=P.$$prototype).rand_results=F.detailed_rand_results=Z,v(L[0],"UPPER_LIMIT_DICE_TIMES",200),v(L[0],"UPPER_LIMIT_DICE_SIDES",1e4),v(L[0],"UPPER_LIMIT_RANDS",1e4),D(P,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]}),P.$attr_reader("rand_results"),P.$attr_reader("detailed_rand_results"),v(L[0],"DetailedRandResult",ne("Struct").$new("kind","sides","value")),D(P,"$roll_barabara",function(B,O){var m=this;return z(I(Q(m.rand_results.$size(),B),ne("UPPER_LIMIT_RANDS")))&&m.$raise(ne("TooManyRandsError")),z(U(B,0))||z(I(B,ne("UPPER_LIMIT_DICE_TIMES")))?[]:N(ne("Array"),"new",[B],function l(){return(null==l.$$s?this:l.$$s).$roll_once(O)},{$$s:m})}),D(P,"$roll_sum",function(B,O){return this.$roll_barabara(B,O).$sum()}),D(P,"$roll_once",function(B){var m=Z;return z(U(B,0))||z(I(B,ne("UPPER_LIMIT_DICE_SIDES")))?0:(m=this.$rand_inner(B),this.$push_to_detail("normal",B,m),m)}),D(P,"$roll_index",function(B){return G(this.$roll_once(B),1)}),D(P,"$roll_tens_d10",function(){var m,O=Z;return O=this.$rand_inner(10),re(O,10)&&(O=0),m=q(O,10),this.$push_to_detail("tens_d10",10,m),m}),D(P,"$roll_d9",function(){var O;return O=G(this.$rand_inner(10),1),this.$push_to_detail("d9",10,O),O}),D(P,"$roll_d66",function(B){var l,m=Z;return m=N(ne("Array"),"new",[2],function c(){return(null==c.$$s?this:c.$$s).$roll_once(6)},{$$s:this}),E(Y(ne("D66SortType"),"ASC"),l=B)?m["$sort!"]():E(Y(ne("D66SortType"),"DESC"),l)&&m["$sort!"]()["$reverse!"](),Q(q(m["$[]"](0),10),m["$[]"](1))}),P.$private(),D(P,"$rand_inner",function(B){var m,O=this;return z(V(O.rand_results.$size(),ne("UPPER_LIMIT_RANDS")))&&O.$raise(ne("TooManyRandsError")),m=O.$random(B),O.rand_results["$<<"]([m,B]),m}),D(P,"$random",function(B){return Q(ne("Kernel").$rand(B),1)}),D(P,"$push_to_detail",function(B,O,m){var c;return c=ne("DetailedRandResult").$new(B,O,m),this.detailed_rand_results.$push(c)}),te(ee[0],H("StandardError"),"TooManyRandsError"),Z},Opal.modules["bcdice/dice_table/roll_result"]=function(f){var N,E,X,k,R,ee,H,le,re,S=f.module,te=f.klass,v=f.def,D=f.truthy,z=f.return_val,I=[],Q=f.nil;return N=I,E=re=[S(I[0],"BCDice")].concat(N),X=le=[S(re[0],"DiceTable")].concat(E),R=[k=te(le[0],null,"RollResult")].concat(X),ee=f.$r(R),(H=k.$$prototype).table_name=H.value=H.body=Q,v(k,"$initialize",function(M,C,P){var L=this;return L.table_name=M,L.value=C,L.body=P}),k.$attr_reader("table_name"),k.$attr_reader("value"),k.$attr_reader("body"),v(k,"$to_s",function(){var M=this;return M.table_name+"("+M.value+") \uff1e "+M.body}),v(k,"$last_body",function(){var M=this;return D(M.body["$is_a?"](ee("RollResult")))?M.body.$last_body():M.body}),v(k,"$empty?",z(!1))},Opal.modules["bcdice/dice_table/chain_table"]=function(f){var N,E,X,k,R,ee,H,le,re,S=f.module,te=f.klass,v=f.truthy,D=f.def,z=f.rb_minus,I=[],Q=f.nil;return N=I,E=re=[S(I[0],"BCDice")].concat(N),X=le=[S(re[0],"DiceTable")].concat(E),R=[k=te(le[0],null,"ChainTable")].concat(X),ee=f.$r(R),(H=k.$$prototype).times=H.sides=H.items=H.name=Q,D(k,"$initialize",function(M,C,P){var L=this,ne=Q;return L.name=M,L.items=P.$freeze(),ne=/(\d+)D(\d+)/i.$match(C),v(ne)||L.$raise(ee("ArgumentError"),"Unexpected table type: "+C),L.times=ne["$[]"](1).$to_i(),L.sides=ne["$[]"](2).$to_i()}),D(k,"$roll",function(M){var P,L,C=this,ne=Q;return P=M.$roll_sum(C.times,C.sides),L=z(P,C.times),ne=C.items["$[]"](L),v(ne["$respond_to?"]("roll"))&&(ne=ne.$roll(M)),ee("RollResult").$new(C.name,P,ne)})},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(f){var q,Z,ee,H,A,M,C,X,V,S=f.module,te=f.klass,v=f.hash2,D=f.defs,z=f.def,I=f.rb_plus,Q=f.rb_times,U=f.rb_minus,N=[],G=f.nil;return q=N,Z=V=[S(N[0],"BCDice")].concat(q),ee=X=[S(V[0],"DiceTable")].concat(Z),A=[H=te(X[0],null,"D66GridTable")].concat(ee),M=f.$r(A),(C=H.$$prototype).name=C.items=G,D(H,"$from_i18n",function(L,ne){var he=G;return he=M("I18n").$t(L,v(["locale","raise"],{locale:ne,raise:!0})),this.$new(he["$[]"]("name"),he["$[]"]("items"))}),z(H,"$initialize",function(L,ne){return this.name=L,this.items=ne.$freeze()}),z(H,"$roll",function(L){var F,he,B,O,m;return F=L.$roll_once(6),he=L.$roll_once(6),B=I(Q(F,10),he),O=U(F,1),m=U(he,1),M("RollResult").$new(this.name,B,this.items["$[]"](O)["$[]"](m))})},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(f){var G,V,R,ee,H,A,Z,Y,q,S=f.module,te=f.klass,v=f.hash2,D=f.defs,z=f.def,Q=[],U=f.nil;return f.top.$require("bcdice/dice_table/d66_grid_table"),G=Q,V=q=[S(Q[0],"BCDice")].concat(G),Z=[S(q[0],"DiceTable")].concat(V),Y=f.$r(Z),R=Z,H=[ee=te(Z[0],Y("D66GridTable"),"D66HalfGridTable")].concat(R),A=f.$r(H),D(ee,"$from_i18n",function(C,P){var ne=U;return ne=A("I18n").$t(C,v(["locale","raise"],{locale:P,raise:!0})),this.$new(ne["$[]"]("name"),ne["$[]"]("items_1_2_3"),ne["$[]"]("items_4_5_6"))}),z(ee,"$initialize",function(C,P,L){return this.name=C,this.items=[P,P,P,L,L,L].$freeze()})},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(f){var G,V,R,ee,H,A,Z,Y,q,S=f.module,te=f.klass,v=f.hash2,D=f.defs,z=f.def,Q=[],U=f.nil;return f.top.$require("bcdice/dice_table/d66_grid_table"),G=Q,V=q=[S(Q[0],"BCDice")].concat(G),Z=[S(q[0],"DiceTable")].concat(V),Y=f.$r(Z),R=Z,H=[ee=te(Z[0],Y("D66GridTable"),"D66OneThirdTable")].concat(R),A=f.$r(H),D(ee,"$from_i18n",function(C,P){var ne=U;return ne=A("I18n").$t(C,v(["locale","raise"],{locale:P,raise:!0})),this.$new(ne["$[]"]("name"),ne["$[]"]("items_1_2"),ne["$[]"]("items_3_4"),ne["$[]"]("items_5_6"))}),z(ee,"$initialize",function(C,P,L,ne){return this.name=C,this.items=[P,P,L,L,ne,ne].$freeze()})},Opal.modules["bcdice/dice_table/d66_table"]=function(f){var V,X,A,M,C,P,L,R,Z,S=f.module,te=f.klass,v=f.hash2,D=f.defs,z=f.def,I=f.eqeqeq,Q=f.rb_plus,U=f.rb_times,N=f.truthy,G=[],re=f.nil,q=f.$$$;return V=G,X=Z=[S(G[0],"BCDice")].concat(V),A=R=[S(Z[0],"DiceTable")].concat(X),C=[M=te(R[0],null,"D66Table")].concat(A),P=f.$r(C),(L=M.$$prototype).sort_type=L.items=L.name=re,D(M,"$from_i18n",function(F,he){var m,O=re;return O=P("I18n").$t(F,v(["locale"],{locale:he})),m=P("D66SortType").$const_get(O["$[]"]("d66_sort_type")),this.$new(O["$[]"]("name"),m,O["$[]"]("items"))}),z(M,"$initialize",function(F,he,B){var O=this;return O.name=F,O.sort_type=he,O.items=B.$freeze()}),z(M,"$roll",function(F){var B=re,O=re,m=re,l=re;return B=F.$roll_barabara(2,6),I(q(P("D66SortType"),"ASC"),O=this.sort_type)?B["$sort!"]():I(q(P("D66SortType"),"DESC"),O)&&B["$sort!"]()["$reverse!"](),m=Q(U(B["$[]"](0),10),B["$[]"](1)),l=N(O=this.items["$[]"](m))?O:this.items["$[]"](m.$to_s()),N(l["$respond_to?"]("roll"))&&(l=l.$roll(F)),P("RollResult").$new(this.name,m,l)}),z(M,"$choice",function(F){return P("RollResult").$new(this.name,F,this.items["$[]"](F))})},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(f){var le,k,ee,H,Y,S=f.module,te=f.klass,v=f.hash2,D=f.send,z=f.to_ary,I=f.rb_plus,Q=f.rb_times,U=f.send2,N=f.find_super,G=f.def,q=[],E=f.nil;return f.top.$require("bcdice/dice_table/d66_table"),le=q,k=Y=[S(q[0],"BCDice")].concat(le),ee=[S(Y[0],"DiceTable")].concat(k),H=f.$r(ee),G(te(ee[0],H("D66Table"),"D66LeftRangeTable"),"$initialize",function P(L,ne,F){var O;return P.$$p=null,O=v([],{}),D(F,"each",[],function(l){var c,p;return null==l&&(l=E),c=z(l),p=null==c[1]?E:c[1],D(null==c[0]?E:c[0],"each",[],function(x){return null==x&&(x=E),D(p,"each_with_index",[],function(se,ae){var Te,Ae;return null==se&&(se=E),null==ae&&(ae=E),Ae=I(Q(x,10),I(ae,1)),D(O,"[]=",Te=[Ae,se]),Te[Te.length-1]})})}),U(this,N(this,"initialize",P,!1,!0),"initialize",[L,ne,O],null)})},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(f){var E,Y,H,A,M,C,P,k,le,S=f.module,te=f.klass,v=f.hash2,D=f.defs,z=f.def,I=f.truthy,Q=f.rb_minus,U=f.rb_plus,N=f.rb_times,G=[],re=f.nil;return E=G,Y=le=[S(G[0],"BCDice")].concat(E),H=k=[S(le[0],"DiceTable")].concat(Y),M=[A=te(k[0],null,"D66ParityTable")].concat(H),C=f.$r(M),(P=A.$$prototype).odd=P.even=P.name=re,D(A,"$from_i18n",function(ne,F){var B=re;return B=C("I18n").$t(ne,v(["locale","raise"],{locale:F,raise:!0})),this.$new(B["$[]"]("name"),B["$[]"]("odd"),B["$[]"]("even"))}),z(A,"$initialize",function(ne,F,he){var B=this;return B.name=ne,B.odd=F.$freeze(),B.even=he.$freeze()}),z(A,"$roll",function(ne){var B,m,l,F=this,he=re;return he=ne.$roll_once(6),B=ne.$roll_once(6),m=(I(he["$odd?"]())?F.odd:F.even)["$[]"](Q(B,1)),l=U(N(he,10),B),C("RollResult").$new(F.name,l,m)})},Opal.modules["bcdice/dice_table/d66_range_table"]=function(f){var G,V,k,R,ee,H,A,Z,q,S=f.module,te=f.klass,v=f.def,D=f.rb_plus,z=f.rb_times,I=f.send,Q=[],U=f.nil;return G=Q,V=q=[S(Q[0],"BCDice")].concat(G),k=Z=[S(q[0],"DiceTable")].concat(V),ee=[R=te(Z[0],null,"D66RangeTable")].concat(k),H=f.$r(ee),(A=R.$$prototype).items=A.name=U,v(R,"$initialize",function(C,P){return this.name=C,this.items=P.$freeze()}),v(R,"$roll",function(C){var L,ne,F,he=U;return L=C.$roll_once(6),ne=C.$roll_once(6),F=D(z(L,10),ne),he=I(this.items,"find",[],function(O){return null==O&&(O=U),O["$[]"](0)["$include?"](F)}),H("RollResult").$new(this.name,F,he["$[]"](1))})},Opal.modules["bcdice/dice_table/range_table"]=function(f){var le,k,M,F,B,O,C,P,L,ne,ee,Y,S=f.module,te=f.klass,v=f.const_set,D=f.send,z=f.hash2,I=f.def,Q=f.eqeqeq,U=f.truthy,N=f.to_a,G=f.rb_times,re=f.rb_plus,q=[],E=f.nil;return le=q,k=Y=[S(q[0],"BCDice")].concat(le),M=ee=[S(Y[0],"DiceTable")].concat(k),P=[C=te(ee[0],null,"RangeTable")].concat(M),L=f.$r(P),(ne=C.$$prototype).name=ne.items=ne.num_of_dice=ne.num_of_sides=ne.formatter=E,v(P[0],"RollResult",D(L("Struct"),"new",["sum","values","content","formatted"],function F(){return(null==F.$$s?this:F.$$s).$alias_method("to_s","formatted")},{$$s:C})),v(P[0],"Item",L("Struct").$new("range","content")),v(P[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),v(P[0],"DEFAULT_FORMATTER",D(C,"lambda",[],function(he,B){return null==he&&(he=E),null==B&&(B=E),he.$name()+"("+B.$sum()+") \uff1e "+B.$content()})),C.$attr_reader("name"),C.$attr_reader("num_of_dice"),C.$attr_reader("num_of_sides"),B=[F=f.get_singleton_class(C)].concat(P),O=f.$r(B),I(F,"$from_i18n",function(l,c){var p,d=E;return d=O("I18n").$t(l,z(["locale"],{locale:c})),p=D(d["$[]"]("items"),"map",[],function _(x){return null==x&&(x=E),[(null==_.$$s?this:_.$$s).$conv_string_range(x["$[]"](0)),x["$[]"](1)]},{$$s:this}),this.$new(d["$[]"]("name"),d["$[]"]("type"),p)}),I(F,"$conv_string_range",function(l){var h,c=this;return null==c.name&&(c.name=E),Q(O("Integer"),h=l)?l:Q(O("String"),h)?U(l["$include?"](".."))?D(O("Range"),"new",N(D(l.$split("..",2),"map",[],function d(p){return null==p&&(p=E),(null==d.$$s?this:d.$$s).$Integer(p)},{$$s:c}))):c.$Integer(l):c.$raise(O("TypeError"),c.name+": "+l+" ("+l.$class()+") must be a String or an Integer")}),I(C,"$initialize",function F(he,B,O){var c,m=F.$$p||E,l=this,h=E;return F.$$p=null,l.name=he.$freeze(),l.formatter=U(c=m)?c:L("DEFAULT_FORMATTER"),h=L("DICE_ROLL_METHOD_RE").$match(B),U(h)||l.$raise(L("ArgumentError"),l.name+": invalid dice roll method: "+B),l.num_of_dice=h["$[]"](1).$to_i(),l.num_of_sides=h["$[]"](2).$to_i(),l.$store(O)}),I(C,"$fetch",function(he){var O,B=this;return O=D(B.items,"find",[],function(l){return null==l&&(l=E),l.$range()["$include?"](he)}),U(O)||B.$raise(L("RangeError"),B.name+": value is out of range: "+he),O}),I(C,"$roll",function(he){var m,B=this,O=E,l=E;return m=(O=he.$roll_barabara(B.num_of_dice,B.num_of_sides)).$sum(),(l=L("RollResult").$new(m,O,B.$fetch(m).$content()))["$formatted="](B.formatter["$[]"](B,l)),l}),C.$private(),I(C,"$store",function(he){var O,m,B=this;return O=D(he,"map",[],function l(c,h){return null==c&&(c=E),null==h&&(h=E),[(null==l.$$s?this:l.$$s).$coerce_to_int_range(c),h]},{$$s:B}),m=D(O,"sort_by",[],function(c,h){return null==c&&(c=E),null==h&&(h=E),c.$min()}),B.$assert_min_sum_is_covered(m),B.$assert_max_sum_is_covered(m),B.$assert_no_gap_or_overlap_in_ranges(m),B.items=D(m,"map",[],function(c,h){return null==c&&(c=E),null==h&&(h=E),L("Item").$new(c,h.$freeze()).$freeze()}).$freeze(),B}),I(C,"$coerce_to_int_range",function(he){var O;return Q(L("Integer"),O=he)?L("Range").$new(he,he):Q(L("Range"),O)&&U(he.$begin()["$is_a?"](L("Integer")))&&U(he.$end()["$is_a?"](L("Integer")))?he:this.$raise(L("TypeError"),this.name+": "+he+" ("+he.$class()+") must be an Integer or a Range with Integers ")}),I(C,"$assert_min_sum_is_covered",function(he){var O,B=this,m=E;return O=B.num_of_dice,m=he.$first()["$[]"](0),U(m["$include?"](O))||B.$raise(L("RangeError"),B.name+": min value ("+O+") is not covered: "+m),B}),I(C,"$assert_max_sum_is_covered",function(he){var O,B=this,m=E;return O=G(B.num_of_dice,B.num_of_sides),m=he.$last()["$[]"](0),U(m["$include?"](O))||B.$raise(L("RangeError"),B.name+": max value ("+O+") is not covered: "+m),B}),I(C,"$assert_no_gap_or_overlap_in_ranges",function(he){return D(he,"each_cons",[2],function O(m,l){var p,_,c=null==O.$$s?this:O.$$s,h=E,d=E;return null==c.name&&(c.name=E),null==m&&(m=E),null==l&&(l=E),h=m["$[]"](0),d=l["$[]"](0),p=h.$max(),_=re(p,1),U(d["$include?"](p))&&c.$raise(L("RangeError"),c.name+": Range overlap: "+h+" and "+d),U(d["$include?"](_))?E:c.$raise(L("RangeError"),c.name+": Range gap: "+h+" and "+d)},{$$s:this}),this})},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(f){var re,le,R,C,P,L,ne,H,Y,E,S=f.module,te=f.klass,v=f.send,D=f.def,z=f.rb_minus,I=f.return_ivar,Q=[],U=f.nil,N=f.$$$;return re=Q,le=E=[S(Q[0],"BCDice")].concat(re),R=Y=[S(E[0],"DiceTable")].concat(le),C=H=[te(Y[0],null,"SaiFicSkillTable")].concat(R),L=[P=te(H[0],null,"Category")].concat(C),ne=f.$r(L),D(P,"$initialize",function(he,B,O,m){var l=this;return l.name=he,l.skills=v(B.$map(),"with_index",[2],function(h,d){return null==h&&(h=U),null==d&&(d=U),N(ne("SaiFicSkillTable"),"Skill").$new(he,h,O,d,m)}),l.dice=O}),D(P,"$roll",function(he){return this.$skills()["$[]"](z(he.$roll_sum(2,6),2))}),D(P,"$to_s",I("name")),P.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(f){var U,q,Y,H,A,k,V,G,S=f.module,te=f.klass,v=f.def,D=f.hash2,z=[],I=f.nil;return U=z,q=G=[S(z[0],"BCDice")].concat(U),Y=V=[S(G[0],"DiceTable")].concat(q),k=[te(V[0],null,"SaiFicSkillTable")].concat(Y),(A=(H=te(k[0],null,"Skill")).$$prototype).s_format=A.category_dice=A.row_dice=A.category_name=A.name=I,v(H,"$initialize",function(C,P,L,ne,F){var he=this;return he.category_name=C,he.name=P,he.category_dice=L,he.row_dice=ne,he.s_format=F}),v(H,"$to_s",function(){var C=this;return C.$format(C.s_format,D(["category_dice","row_dice","category_name","skill_name"],{category_dice:C.category_dice,row_dice:C.row_dice,category_name:C.category_name,skill_name:C.name}))}),H.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(f){var k,A,ne,F,he,B,O,C,ee,S=f.module,te=f.klass,v=f.ensure_kwargs,D=f.hash2,z=f.send,Q=f.defs,U=f.const_set,N=f.to_ary,G=f.def,re=f.truthy,q=f.rb_minus,E=f.rb_plus,V=f.top,le=[],Z=f.nil,Y=f.$$$;return V.$require("bcdice/dice_table/sai_fic_skill_table/category"),V.$require("bcdice/dice_table/sai_fic_skill_table/skill"),k=le,A=ee=[S(le[0],"BCDice")].concat(k),ne=C=[S(ee[0],"DiceTable")].concat(A),he=[F=te(C[0],null,"SaiFicSkillTable")].concat(ne),B=f.$r(he),(O=F.$$prototype).rtt=O.rtt_format=O.rct=O.rct_format=O.rttn=O.rttn_format=O.categories=Z,Q(F,"$from_i18n",function(l,c,h){var d,p,_,ae,se=Z;return null==(d=(h=v(h)).$$smap.rtt)&&(d=Z),null==(p=h.$$smap.rct)&&(p=Z),null==(_=h.$$smap.rttn)&&(_=Z),ae=(se=B("I18n").$t("RTT",D(["locale","raise","default"],{locale:c,raise:!1,default:D([],{})})).$merge(B("I18n").$t(l,D(["locale","raise"],{locale:c,raise:!0}))))["$[]"]("items"),se=z(se,"select",[],function(Ae,de){return null==Ae&&(Ae=Z),null==de&&(de=Z),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](Ae)}),this.$new(ae,f.to_hash(se).$merge(D(["rtt","rct","rttn"],{rtt:d,rct:p,rttn:_})))},-3),U(he[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),U(he[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),U(he[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),U(he[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),G(F,"$initialize",function(l,c){var h,d,p,_,x,$,se,ae=this;return null==(h=(c=v(c)).$$smap.rtt)&&(h=Z),null==(d=c.$$smap.rct)&&(d=Z),null==(p=c.$$smap.rttn)&&(p=Z),null==(_=c.$$smap.rtt_format)&&(_=B("DEFAULT_RTT")),null==(x=c.$$smap.rct_format)&&(x=B("DEFAULT_RCT")),null==($=c.$$smap.rttn_format)&&($=B("DEFAULT_RTTN")),null==(se=c.$$smap.s_format)&&(se=B("DEFAULT_S")),ae.categories=z(l.$map(),"with_index",[1],function(Ae,de){var Fe,ke,De;return null==Ae&&(Ae=Z),null==de&&(de=Z),ke=null==(Fe=N(Ae))[0]?Z:Fe[0],De=null==Fe[1]?Z:Fe[1],Y(B("SaiFicSkillTable"),"Category").$new(ke,De,de,se)},{$$has_top_level_mlhs_arg:!0}),ae.rtt=h,ae.rct=d,ae.rttn=p.$to_a(),ae.rtt_format=_,ae.rct_format=x,ae.rttn_format=$},-2),U(he[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),F.$attr_reader("categories"),G(F,"$roll_command",function(l,c){var d,h=this,p=Z,_=Z;return re(["RTT",h.rtt]["$include?"](d=c))?h.$format_skill(h.rtt_format,h.$roll_skill(l)):re(["RCT",h.rct]["$include?"](d))?(p=h.$roll_category(l),h.$format(h.rct_format,D(["category_dice","category_name"],{category_dice:p.$dice(),category_name:p.$name()}))):re(_=B("RTTN").$index(d))||re(_=h.rttn.$index(d))?h.$format_skill(h.rttn_format,h.categories["$[]"](_).$roll(l)):Z}),G(F,"$roll_category",function(l){return this.categories["$[]"](q(l.$roll_once(6),1))}),G(F,"$roll_skill",function(l){return this.$roll_category(l).$roll(l)}),G(F,"$prefixes",function(){var l=this;return E(["RTT[1-6]?","RCT",l.rtt,l.rct],l.rttn).$compact()}),F.$private(),G(F,"$format_skill",function(l,c){return this.$format(l,D(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:c.$category_dice(),row_dice:c.$row_dice(),category_name:c.$category_name(),skill_name:c.$name(),text:c.$to_s()}))})},Opal.modules["bcdice/dice_table/table"]=function(f){var re,le,R,ee,H,A,M,Y,E,S=f.module,te=f.klass,v=f.hash2,D=f.defs,z=f.truthy,I=f.def,Q=f.rb_minus,U=[],N=f.nil;return re=U,le=E=[S(U[0],"BCDice")].concat(re),R=Y=[S(E[0],"DiceTable")].concat(le),H=[ee=te(Y[0],null,"Table")].concat(R),A=f.$r(H),(M=ee.$$prototype).times=M.sides=M.name=M.items=N,D(ee,"$from_i18n",function(P,L){var F=N;return F=A("I18n").$t(P,v(["locale"],{locale:L})),this.$new(F["$[]"]("name"),F["$[]"]("type"),F["$[]"]("items"))}),I(ee,"$initialize",function(P,L,ne){var F=this,he=N;return F.name=P,F.items=ne.$freeze(),he=/(\d+)D(\d+)/i.$match(L),z(he)||F.$raise(A("ArgumentError"),"Unexpected table type: "+L),F.times=he["$[]"](1).$to_i(),F.sides=he["$[]"](2).$to_i()}),I(ee,"$roll",function(P){var ne,L=this;return ne=P.$roll_sum(L.times,L.sides),L.$choice(ne)}),I(ee,"$choice",function(P){var ne,L=this;return ne=Q(P,L.times),A("RollResult").$new(L.name,P,L.items["$[]"](ne))})},Opal.modules["bcdice/dice_table"]=function(f){var S=f.top;return S.$require("bcdice/dice_table/roll_result"),S.$require("bcdice/dice_table/chain_table"),S.$require("bcdice/dice_table/d66_grid_table"),S.$require("bcdice/dice_table/d66_half_grid_table"),S.$require("bcdice/dice_table/d66_one_third_table"),S.$require("bcdice/dice_table/d66_left_range_table"),S.$require("bcdice/dice_table/d66_parity_table"),S.$require("bcdice/dice_table/d66_range_table"),S.$require("bcdice/dice_table/d66_table"),S.$require("bcdice/dice_table/range_table"),S.$require("bcdice/dice_table/sai_fic_skill_table"),S.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(f){var I,G,q,U,S=f.module,te=f.const_set,v=[];return I=v,G=U=[S(v[0],"BCDice")].concat(I),q=[S(U[0],"D66SortType")].concat(G),te(q[0],"NO_SORT","no_sort"),te(q[0],"ASC","asc"),te(q[0],"DESC","desc"),function(N,G){var q=[S(N,"RoundType")].concat(G);return te(q[0],"CEIL","ceil"),te(q[0],"FLOOR","floor"),te(q[0],"ROUND","round")}(U[0],U)},Opal.modules["bcdice/translate"]=function(f){var G,V,le,Z,Y,q,S=f.module,te=f.ensure_kwargs,v=f.kwrestargs,z=f.hash2,I=f.def,Q=[],U=f.nil;return G=Q,V=q=[S(Q[0],"BCDice")].concat(G),Z=[le=S(q[0],"Translate")].concat(V),Y=f.$r(Z),I(le,"$translate",function(k,R){var ee,H=this;return null==H.locale&&(H.locale=U),R=te(R),ee=v(R,{}),Y("I18n").$translate(k,z(["locale","raise"],{locale:H.locale,raise:!0}).$merge(f.to_hash(ee)))},-2)},Opal.modules["bcdice/result"]=function(f){var le,X,Z,G,q,te=f.klass,v=f.send,D=f.def,z=f.return_val,I=f.return_ivar,Q=[],U=f.nil;return G=Q,le=q=[(0,f.module)(Q[0],"BCDice")].concat(G),[Z=te(q[0],null,"Result")].concat(le),D(X=f.get_singleton_class(Z),"$success",function(ee){return v(this.$new(),"tap",[],function(M){var C;return null==M&&(M=U),M["$text="](ee),v(M,"success=",C=[!0]),C[C.length-1]})}),D(X,"$failure",function(ee){return v(this.$new(),"tap",[],function(M){var C;return null==M&&(M=U),M["$text="](ee),v(M,"failure=",C=[!0]),C[C.length-1]})}),D(X,"$critical",function(ee){return v(this.$new(),"tap",[],function(M){var C;return null==M&&(M=U),M["$text="](ee),M["$critical="](!0),v(M,"success=",C=[!0]),C[C.length-1]})}),D(X,"$fumble",function(ee){return v(this.$new(),"tap",[],function(M){var C;return null==M&&(M=U),M["$text="](ee),M["$fumble="](!0),v(M,"failure=",C=[!0]),C[C.length-1]})}),D(X,"$nothing",z("nothing")),D(Z,"$initialize",function(k){var R=this;return null==k&&(k=U),R.text=k,R.rands=U,R.detailed_rands=U,R.secret=!1,R.success=!1,R.failure=!1,R.critical=!1,R.fumble=!1},-1),Z.$attr_accessor("text","rands","detailed_rands"),Z.$attr_writer("secret","success","failure","critical","fumble"),D(Z,"$secret?",I("secret")),D(Z,"$success?",I("success")),D(Z,"$failure?",I("failure")),D(Z,"$critical?",I("critical")),D(Z,"$fumble?",I("fumble")),D(Z,"$condition=",function(k){return this.success=k,this.failure=k["$!"]()})},Opal.modules["racc/parser"]=function(f){var P,ne,F,S=f.module,te=f.klass,v=f.truthy,D=f.const_set,z=f.defs,I=f.gvars,Q=f.rb_lt,U=f.def,N=f.to_ary,G=f.send,re=f.neqeq,q=f.rb_plus,E=f.eqeq,V=f.rb_ge,le=f.rb_gt,Z=f.rb_minus,Y=f.rb_le,X=f.rb_times,k=f.assign_ivar_val,ee=[],H=f.$r(ee),A=f.nil,M=f.$$$;return P=ee,ne=[S(ee[0],"Racc")].concat(P),F=f.$r(ne),te(ne[0],F("StandardError"),"ParseError"),v(M("::","ParseError","skip_raise")?"constant":A)||D(ee[0],"ParseError",M(H("Racc"),"ParseError")),function(C,P){var m,l,c,h,d,F=[S(C,"Racc")].concat(P),he=f.$r(F);return v(he("Racc_No_Extensions","skip_raise")?"constant":A)||D(F[0],"Racc_No_Extensions",!1),m=F,c=[l=te(F[0],null,"Parser")].concat(m),h=f.$r(c),(d=l.$$prototype).yydebug=d.racc_debug_out=d.racc_error_status=d.racc_t=d.racc_vstack=d.racc_val=d.racc_state=d.racc_tstack=A,D(c[0],"Racc_Runtime_Version","1.4.6"),D(c[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),D(c[0],"Racc_Runtime_Core_Version_R","1.4.6"),D(c[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),D(c[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),D(c[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),D(c[0],"Racc_Runtime_Core_Version",h("Racc_Runtime_Core_Version_R")),D(c[0],"Racc_Runtime_Core_Revision",h("Racc_Runtime_Core_Revision_R")),D(c[0],"Racc_Runtime_Type","ruby"),z(h("Parser"),"$racc_runtime_type",function(){return h("Racc_Runtime_Type")}),U(l,"$_racc_setup",function(){var _,x,$=this,se=A,ae=A;return null==I.stderr&&(I.stderr=A),v(M($.$class(),"Racc_debug_parser"))||($.yydebug=!1),v(null!=(_=$.yydebug)&&_!==A?"instance-variable":A)||($.yydebug=!1),v($.yydebug)&&(v(null!=(x=$.racc_debug_out)&&x!==A?"instance-variable":A)||($.racc_debug_out=I.stderr),$.racc_debug_out=v(se=$.racc_debug_out)?se:I.stderr),ae=M($.$class(),"Racc_arg"),v(Q(ae.$size(),14))&&ae["$[]="](13,!0),ae}),U(l,"$_racc_init_sysvars",function(){var _=this;return _.racc_state=[0],_.racc_tstack=[],_.racc_vstack=[],_.racc_t=A,_.racc_val=A,_.racc_read_next=!0,_.racc_user_yyerror=!1,_.racc_error_status=0}),U(l,"$do_parse",function(){return this.$__send__(h("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),U(l,"$next_token",function(){return this.$raise(h("NotImplementedError"),this.$class()+"#next_token is not defined")}),U(l,"$_racc_do_parse_rb",function(_,x){var $,Te=A,Ae=A,de=A,Fe=A,ke=A,De=A,Me=A,_e=A;return $=N(_),Te=null==$[0]?A:$[0],Ae=null==$[1]?A:$[1],de=null==$[2]?A:$[2],Fe=null==$[3]?A:$[3],ke=null==$[10]?A:$[10],this.$_racc_init_sysvars(),De=Me=_e=A,G(this,"catch",["racc_end_parse"],function ce(){var pe,ye,b=null==ce.$$s?this:ce.$$s,K=A;for(null==b.racc_state&&(b.racc_state=A),null==b.racc_read_next&&(b.racc_read_next=A),null==b.racc_t&&(b.racc_t=A),null==b.yydebug&&(b.yydebug=A),null==b.racc_val&&(b.racc_val=A);v(!0);)for(v(_e=Fe["$[]"](b.racc_state["$[]"](-1)))?(v(b.racc_read_next)&&re(b.racc_t,0)&&(ye=b.$next_token(),pe=N(ye),De=null==pe[0]?A:pe[0],b.racc_val=null==pe[1]?A:pe[1],b.racc_t=v(De)?v(K=ke["$[]"](De))?K:1:0,v(b.yydebug)&&b.$racc_read_token(b.racc_t,De,b.racc_val),b.racc_read_next=!1),_e=q(_e,b.racc_t),v(V(_e,0))&&v(Me=Te["$[]"](_e))&&E(Ae["$[]"](_e),b.racc_state["$[]"](-1))||(Me=de["$[]"](b.racc_state["$[]"](-1)))):Me=de["$[]"](b.racc_state["$[]"](-1));v(Me=b.$_racc_evalact(Me,_)););},{$$s:this})}),U(l,"$yyparse",function(_,x){return this.$__send__(h("Racc_YY_Parse_Method"),_,x,this.$_racc_setup(),!0)}),U(l,"$_racc_yyparse_rb",function(_,x,$,se){var ae,de=A,Fe=A,xe=A,ke=A,Me=A,_e=A,ce=A;return ae=N($),de=null==ae[0]?A:ae[0],Fe=null==ae[1]?A:ae[1],xe=null==ae[2]?A:ae[2],ke=null==ae[3]?A:ae[3],Me=null==ae[10]?A:ae[10],this.$_racc_init_sysvars(),_e=A,ce=A,G(this,"catch",["racc_end_parse"],function pe(){var ye=null==pe.$$s?this:pe.$$s;for(null==ye.racc_state&&(ye.racc_state=A);!v(ce=ke["$[]"](ye.racc_state["$[]"](-1)));)for(;v(_e=ye.$_racc_evalact(xe["$[]"](ye.racc_state["$[]"](-1)),$)););return G(_,"__send__",[x],function b(K,ge){var be=null==b.$$s?this:b.$$s,Pe=A,Ue=A;for(null==be.racc_t&&(be.racc_t=A),null==be.racc_state&&(be.racc_state=A),null==be.racc_read_next&&(be.racc_read_next=A),null==K&&(K=A),null==ge&&(ge=A),be.racc_t=v(K)?v(Pe=Me["$[]"](K))?Pe:1:0,be.racc_val=ge,be.racc_read_next=!1,ce=q(ce,be.racc_t),v(V(ce,0))&&v(_e=de["$[]"](ce))&&E(Fe["$[]"](ce),be.racc_state["$[]"](-1))||(_e=xe["$[]"](be.racc_state["$[]"](-1)));v(_e=be.$_racc_evalact(_e,$)););for(;v(v(Pe=v(Ue=(ce=ke["$[]"](be.racc_state["$[]"](-1)))["$!"]())?Ue:be.racc_read_next["$!"]())?Pe:be.racc_t["$=="](0));)for(v(ce)&&v(ce=q(ce,be.racc_t))&&v(V(ce,0))&&v(_e=de["$[]"](ce))&&E(Fe["$[]"](ce),be.racc_state["$[]"](-1))||(_e=xe["$[]"](be.racc_state["$[]"](-1)));v(_e=be.$_racc_evalact(_e,$)););},{$$s:ye})},{$$s:this})}),U(l,"$_racc_evalact",function(_,x){var $,xe,ae=this,Te=A,Ae=A,Fe=A,ke=A,De=A,Me=A;if(Te=null==($=N(x))[0]?A:$[0],Ae=null==$[1]?A:$[1],Fe=null==$[3]?A:$[3],xe=null==$[11]?A:$[11],ke=null==$[12]?A:$[12],v(le(_,0))&&v(Q(_,xe)))v(le(ae.racc_error_status,0))&&(E(ae.racc_t,1)||(ae.racc_error_status=Z(ae.racc_error_status,1))),ae.racc_vstack.$push(ae.racc_val),ae.racc_state.$push(_),ae.racc_read_next=!0,v(ae.yydebug)&&(ae.racc_tstack.$push(ae.racc_t),ae.$racc_shift(ae.racc_t,ae.racc_tstack,ae.racc_vstack));else if(v(Q(_,0))&&v(le(_,ke["$-@"]()))){if(De=G(ae,"catch",["racc_jump"],function _e(){var ce=null==_e.$$s?this:_e.$$s;return null==ce.racc_state&&(ce.racc_state=A),ce.racc_state.$push(ce.$_racc_do_reduce(x,_)),!1},{$$s:ae}),v(De))switch(De.valueOf()){case 1:return ae.racc_user_yyerror=!0,ke["$-@"]();case 2:return xe;default:ae.$raise("[Racc Bug] unknown jump code")}}else if(E(_,xe))v(ae.yydebug)&&ae.$racc_accept(),ae.$throw("racc_end_parse",ae.racc_vstack["$[]"](0));else{if(E(_,ke["$-@"]())){switch(ae.racc_error_status.valueOf()){case 0:v(x["$[]"](21))||ae.$on_error(ae.racc_t,ae.racc_val,ae.racc_vstack);break;case 3:E(ae.racc_t,0)&&ae.$throw("racc_end_parse",A),ae.racc_read_next=!0}for(ae.racc_user_yyerror=!1,ae.racc_error_status=3;v(!0)&&!(v(Me=Fe["$[]"](ae.racc_state["$[]"](-1)))&&(Me=q(Me,1),v(V(Me,0))&&v(_=Te["$[]"](Me))&&E(Ae["$[]"](Me),ae.racc_state["$[]"](-1))));)v(Y(ae.racc_state.$size(),1))&&ae.$throw("racc_end_parse",A),ae.racc_state.$pop(),ae.racc_vstack.$pop(),v(ae.yydebug)&&(ae.racc_tstack.$pop(),ae.$racc_e_pop(ae.racc_state,ae.racc_tstack,ae.racc_vstack));return _}ae.$raise("[Racc Bug] unknown action "+_.$inspect())}return v(ae.yydebug)&&ae.$racc_next_state(ae.racc_state["$[]"](-1),ae.racc_state),A}),U(l,"$_racc_do_reduce",function(_,x){var $,ke,Me,K,ge,be,Ye,ae=this,Ae=A,de=A,Fe=A,xe=A,De=A,_e=A,ce=A,pe=A,ye=A,b=A,Pe=A,Ue=A,nt=A;return Ae=null==($=N(_))[4]?A:$[4],de=null==$[5]?A:$[5],Fe=null==$[6]?A:$[6],xe=null==$[7]?A:$[7],ke=null==$[8]?A:$[8],De=null==$[9]?A:$[9],Me=null==$[13]?A:$[13],_e=ae.racc_state,ce=ae.racc_vstack,pe=ae.racc_tstack,ye=X(x,-3),b=De["$[]"](ye),K=De["$[]"](q(ye,1)),ge=De["$[]"](q(ye,2)),be=[],v(ae.yydebug)&&(Pe=pe["$[]"](b["$-@"](),b)),Ue=ce["$[]"](b["$-@"](),b),v(ae.yydebug)&&pe["$[]="](b["$-@"](),b,be),ce["$[]="](b["$-@"](),b,be),_e["$[]="](b["$-@"](),b,be),v(Me)?ce.$push(ae.$__send__(ge,Ue,ce,Ue["$[]"](0))):ce.$push(ae.$__send__(ge,Ue,ce)),pe.$push(K),v(ae.yydebug)&&ae.$racc_reduce(Pe,K,pe,ce),Ye=Z(K,ke),v(ye=xe["$[]"](Ye))&&(ye=q(ye,_e["$[]"](-1)),v(V(ye,0))&&v(nt=Ae["$[]"](ye))&&E(de["$[]"](ye),Ye))?nt:Fe["$[]"](Ye)}),U(l,"$on_error",function(_,x,$){var ae;return this.$raise(h("ParseError"),this.$sprintf("\nparse error on value %s (%s)",x.$inspect(),v(ae=this.$token_to_str(_))?ae:"?"))}),U(l,"$yyerror",function(){return this.$throw("racc_jump",1)}),U(l,"$yyaccept",function(){return this.$throw("racc_jump",2)}),U(l,"$yyerrok",k("racc_error_status",0)),U(l,"$racc_read_token",function(_,x,$){var se=this;return se.racc_debug_out.$print("read    "),se.racc_debug_out.$print(x.$inspect(),"(",se.$racc_token2str(_),") "),se.racc_debug_out.$puts($.$inspect()),se.racc_debug_out.$puts()}),U(l,"$racc_shift",function(_,x,$){return this.racc_debug_out.$puts("shift   "+this.$racc_token2str(_)),this.$racc_print_stacks(x,$),this.racc_debug_out.$puts()}),U(l,"$racc_reduce",function(_,x,$,se){var ae=this,Te=A;return(Te=ae.racc_debug_out).$print("reduce "),v(_["$empty?"]())?Te.$print(" <none>"):G(_,"each",[],function Ae(de){return null==de&&(de=A),Te.$print(" ",(null==Ae.$$s?this:Ae.$$s).$racc_token2str(de))},{$$s:ae}),Te.$puts(" --\x3e "+ae.$racc_token2str(x)),ae.$racc_print_stacks($,se),ae.racc_debug_out.$puts()}),U(l,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),U(l,"$racc_e_pop",function(_,x,$){return this.racc_debug_out.$puts("error recovering mode: pop token"),this.$racc_print_states(_),this.$racc_print_stacks(x,$),this.racc_debug_out.$puts()}),U(l,"$racc_next_state",function(_,x){var $=this;return $.racc_debug_out.$puts("goto    "+_),$.$racc_print_states(x),$.racc_debug_out.$puts()}),U(l,"$racc_print_stacks",function(_,x){var se=A;return(se=this.racc_debug_out).$print("        ["),G(_,"each_index",[],function ae(Te){return null==Te&&(Te=A),se.$print(" (",(null==ae.$$s?this:ae.$$s).$racc_token2str(_["$[]"](Te))," ",x["$[]"](Te).$inspect(),")")},{$$s:this}),se.$puts(" ]")}),U(l,"$racc_print_states",function(_){var $=A;return($=this.racc_debug_out).$print("        ["),G(_,"each",[],function(ae){return null==ae&&(ae=A),$.$print(" ",ae)}),$.$puts(" ]")}),U(l,"$racc_token2str",function(_){var $;return v($=M(this.$class(),"Racc_token_to_s_table")["$[]"](_))?$:this.$raise("[Racc Bug] can't convert token "+_+" to string")}),U(l,"$token_to_str",function(_){return M(this.$class(),"Racc_token_to_s_table")["$[]"](_)})}(ee[0],ee)},Opal.modules["bcdice/arithmetic/node"]=function(f){var k,A,L,m,l,F,he,C,ee,S=f.module,te=f.klass,v=f.def,D=f.thrower,z=f.return_ivar,I=f.send2,Q=f.find_super,U=f.eqeq,N=f.const_set,G=f.eqeqeq,re=f.rb_divide,q=f.truthy,E=f.assign_ivar,V=f.alias,le=[],Z=f.nil,Y=f.$$$;return k=le,A=ee=[S(le[0],"BCDice")].concat(k),L=C=[S(ee[0],"Arithmetic")].concat(A),F=[S(C[0],"Node")].concat(L),he=f.$r(F),(l=(m=te(F[0],null,"BinaryOp")).$$prototype).lhs=l.rhs=l.op=Z,v(m,"$initialize",function(h,d,p){var _=this;return _.lhs=h,_.op=d,_.rhs=p}),v(m,"$eval",function(h){try{D("eval_return");var x,p=this,_=Z;return _=p.lhs.$eval(h),x=p.rhs.$eval(h),_.$send(p.op,x)}catch($){if($===f.t_eval_return)return $.$v;throw $}}),v(m,"$output",function(){var h=this;return""+h.lhs.$output()+h.op+h.rhs.$output()}),v(m,"$s_exp",function(){var h=this;return"("+h.$op_for_s_exp()+" "+h.lhs.$s_exp()+" "+h.rhs.$s_exp()+")"}),v(m,"$op_for_s_exp",z("op")),function(B,O,m){var l=te(B,O,"DivideBase"),c=[l].concat(m),h=f.$r(c),d=l.$$prototype;d.lhs=d.rhs=d.op=Z,v(l,"$initialize",function p(_,x){return p.$$p=null,I(this,Q(this,"initialize",p,!1,!0),"initialize",[_,"/",x],null)}),v(l,"$eval",function(_){try{D("eval_return");var se,ae,$=this;return se=$.lhs.$eval(_),ae=$.rhs.$eval(_),U(ae,0)&&$.$raise(h("ZeroDivisionError")),$.$divide_and_round(se,ae,_)}catch(Te){if(Te===f.t_eval_return)return Te.$v;throw Te}}),v(l,"$output",function p(){var _=p.$$p||Z,x=this;return p.$$p=null,""+I(x,Q(x,"output",p,!1,!0),"output",[],_)+x.$rounding_method()}),l.$private(),v(l,"$rounding_method",function(){return Y(this.$class(),"ROUNDING_METHOD")}),v(l,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),v(l,"$divide_and_round",function(_,x,$){return this.$raise(h("NotImplementedError"))})}(F[0],he("BinaryOp"),F),function(B,O,m){var l=te(B,O,"DivideWithGameSystemDefault"),c=[l].concat(m),h=f.$r(c);N(c[0],"ROUNDING_METHOD",""),l.$private(),v(l,"$divide_and_round",function(p,_,x){var $,se=Z;return G(Y(h("RoundType"),"CEIL"),$=x)?re(p.$to_f(),_).$ceil():G(Y(h("RoundType"),"ROUND"),$)?(se=re(p.$to_f(),_),q(se["$negative?"]())?se.$abs().$round()["$-@"]():se.$round()):re(p,_).$floor()})}(F[0],he("DivideBase"),F),function(B,O,m){var l=te(B,O,"DivideWithCeil"),c=[l].concat(m);N(c[0],"ROUNDING_METHOD","C"),l.$private(),v(l,"$divide_and_round",function(d,p,_){return re(d.$to_f(),p).$ceil()})}(F[0],he("DivideBase"),F),function(B,O,m){var l=te(B,O,"DivideWithRound"),c=[l].concat(m);N(c[0],"ROUNDING_METHOD","R"),l.$private(),v(l,"$divide_and_round",function(d,p,_){var x=Z;return x=re(d.$to_f(),p),q(x["$negative?"]())?x.$abs().$round()["$-@"]():x.$round()})}(F[0],he("DivideBase"),F),function(B,O,m){var l=te(B,O,"DivideWithFloor"),c=[l].concat(m);N(c[0],"ROUNDING_METHOD","F"),l.$private(),v(l,"$divide_and_round",function(d,p,_){return re(d,p).$floor()})}(F[0],he("DivideBase"),F),function(B,O){var m=te(B,null,"Negative");m.$$prototype.body=Z,v(m,"$initialize",E("body")),v(m,"$eval",function(h){try{return D("eval_return"),this.body.$eval(h)["$-@"]()}catch(_){if(_===f.t_eval_return)return _.$v;throw _}}),v(m,"$output",function(){return"-"+this.body.$output()}),v(m,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(F[0]),function(B,O){var m=te(B,null,"Parenthesis");m.$$prototype.expr=Z,v(m,"$initialize",E("expr")),v(m,"$eval",function(h){try{return D("eval_return"),this.expr.$eval(h)}catch(_){if(_===f.t_eval_return)return _.$v;throw _}}),v(m,"$output",function(){return"("+this.expr.$output()+")"}),v(m,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(F[0]),function(B,O){var m=te(B,null,"Number");return m.$$prototype.value=Z,v(m,"$initialize",E("value")),v(m,"$eval",z("value")),v(m,"$output",function(){return this.value.$to_s()}),V(m,"s_exp","output")}(F[0])},Opal.modules.strscan=function(f){var E,V,le,Z,Y,te=f.def,v=f.truthy,D=f.eqeqeq,z=f.Opal,I=f.return_ivar,Q=f.send,U=f.alias,N=[],G=f.nil;return E=N,le=[V=(0,f.klass)(N[0],null,"StringScanner")].concat(E),Z=f.$r(le),(Y=V.$$prototype).pos=Y.string=Y.working=Y.matched=Y.prev_pos=Y.match=G,V.$attr_reader("pos","matched"),te(V,"$initialize",function(k){var R=this;return R.string=k,R.pos=0,R.matched=G,R.working=k,R.match=[]}),V.$attr_reader("string"),te(V,"$beginning_of_line?",function(){var k=this;return 0===k.pos||"\n"===k.string.charAt(k.pos-1)}),te(V,"$scan",function(k){var R=this,ee=(k=R.$anchor(k)).exec(R.working);return null==ee?R.matched=G:(R.prev_pos=R.pos,R.pos+=ee[0].length,R.working=R.working.substring(ee[0].length),R.matched=ee[0],R.match=ee,ee[0])}),te(V,"$scan_until",function(k){var R=this;k=R.$anchor(k);for(var ee=R.working,H=0;ee.length!=H;++H){var A=k.exec(ee.substr(H));if(null!==A){var M=H+A[0].length,C=ee.substr(0,M);return R.matched=A[0],R.match=A,R.prev_pos=R.pos+H,R.pos+=M,R.working=ee.substr(M),C}}return R.matched=G}),te(V,"$[]",function(k){var ee;if(v(this.match["$empty?"]()))return G;D(Z("Symbol"),ee=k)?k=k.$to_s():D(Z("String"),ee)||(k=z["$coerce_to!"](k,Z("Integer"),"to_int"));var H=this.match;return k<0&&(k+=H.length),k<0||k>=H.length||null==H[k]?G:H[k]}),te(V,"$check",function(k){var R=this,ee=(k=R.$anchor(k)).exec(R.working);return R.matched=null==ee?G:ee[0]}),te(V,"$check_until",function(k){var R=this,ee=R.prev_pos,H=R.pos,A=R.working,M=R.$scan_until(k);return R.prev_pos=ee,R.pos=H,R.working=A,M}),te(V,"$peek",function(k){return this.working.substring(0,k)}),te(V,"$eos?",function(){return 0===this.working.length}),te(V,"$exist?",function(k){var ee=k.exec(this.working);return null==ee?G:0==ee.index?0:ee.index+1}),te(V,"$skip",function(k){var R=this,ee=(k=R.$anchor(k)).exec(R.working);if(null==ee)return R.match=[],R.matched=G;var H=ee[0],A=H.length;return R.matched=H,R.match=ee,R.prev_pos=R.pos,R.pos+=A,R.working=R.working.substring(A),A}),te(V,"$skip_until",function(k){var ee=this.$scan_until(k);return ee===G?G:(this.matched=ee.substr(-1),ee.length)}),te(V,"$get_byte",function(){var k=this,R=G;return k.pos<k.string.length?(k.prev_pos=k.pos,k.pos+=1,R=k.matched=k.working.substring(0,1),k.working=k.working.substring(1)):k.matched=G,R}),te(V,"$match?",function(k){var R=this,ee=(k=R.$anchor(k)).exec(R.working);return null==ee?G:(R.prev_pos=R.pos,ee[0].length)}),te(V,"$pos=",function(k){var R=this;return k<0&&(k+=R.string.$length()),R.pos=k,R.working=R.string.slice(k)}),te(V,"$matched_size",function(){return this.matched===G?G:this.matched.length}),te(V,"$post_match",function(){var k=this;return k.matched===G?G:k.string.substr(k.pos)}),te(V,"$pre_match",function(){var k=this;return k.matched===G?G:k.string.substr(0,k.prev_pos)}),te(V,"$reset",function(){var k=this;return k.working=k.string,k.matched=G,k.pos=0}),te(V,"$rest",I("working")),te(V,"$rest?",function(){return 0!==this.working.length}),te(V,"$rest_size",function(){return this.$rest().$size()}),te(V,"$terminate",function(){var k,R=this;return R.match=G,k=[R.string.$length()],Q(R,"pos=",k),k[k.length-1]}),te(V,"$unscan",function(){var k=this;return k.pos=k.prev_pos,k.prev_pos=G,k.match=G,k}),U(V,"bol?","beginning_of_line?"),U(V,"getch","get_byte"),V.$private(),te(V,"$anchor",function(k){var R=k.toString().match(/\/([^\/]+)$/);return R=R?R[1]:void 0,new RegExp("^(?:"+k.source+")",R)})},Opal.modules["bcdice/normalize"]=function(f){var U,q,G,S=f.module,te=f.eqeqeq,v=f.def,D=f.eqeq,z=[],I=f.nil;return U=z,G=[S(z[0],"BCDice")].concat(U),(q=S(G[0],"Normalize")).$module_function(),v(q,"$comparison_operator",function(V){var le;return te(/<=|=</,le=V)?"<=":te(/>=|=>/,le)?">=":te(/<>|!=|=!/,le)?"!=":te(/</,le)?"<":te(/>/,le)?">":te(/=/,le)?"==":I}),v(q,"$target_number",function(V){return D(V,"?")?V:V.$to_i()})},Opal.modules["bcdice/command/lexer"]=function(f){var E,Y,H,A,M,C,P,k,le,S=f.module,te=f.klass,v=f.const_set,D=f.hash2,z=f.truthy,I=f.send,Q=f.def,U=f.thrower,N=f.top,G=[],re=f.nil;return N.$require("strscan"),N.$require("bcdice/normalize"),E=G,Y=le=[S(G[0],"BCDice")].concat(E),H=k=[S(le[0],"Command")].concat(Y),M=[A=te(k[0],null,"Lexer")].concat(H),C=f.$r(M),(P=A.$$prototype).scanner=P.notations=re,v(M[0],"SYMBOLS",D(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),Q(A,"$initialize",function(ne,F){var he,B,m;return ne=z(m=(he=(B=ne)===re||null==B?re:B.$split(" ",2))===re||null==he?re:he.$first())?m:"",this.scanner=C("StringScanner").$new(ne),this.notations=I(F,"map",[],function(c){return null==c&&(c=re),z(c["$is_a?"](C("String")))?C("Regexp").$new(c):c})}),Q(A,"$next_token",function(){try{var ne=U("return"),F=this,he=re,B=re,m=re,l=re;return z(F.scanner["$eos?"]())?[!1,"$"]:(I(F.notations,"each",[],function c(h){var p,d=null==c.$$s?this:c.$$s;if(null==d.scanner&&(d.scanner=re),null==h&&(h=re),p=d.scanner.$scan(h),!z(p))return re;ne.$throw(["NOTATION",p])},{$$s:F,$$ret:ne}),z(he=F.scanner.$scan(/\d+/))?["NUMBER",he.$to_i()]:z(B=F.scanner.$scan(/[<>!=]+/))?(B=C("Normalize").$comparison_operator(B),[z(B)?"CMP_OP":"ILLEGAL",B]):(m=F.scanner.$getch().$upcase(),[z(l=C("SYMBOLS")["$[]"](m))?l:m.$to_sym(),m]))}catch(c){if(c===ne)return c.$v;throw c}}),Q(A,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/command/parsed"]=function(f){var N,E,X,k,R,ee,H,le,re,S=f.module,te=f.klass,v=f.def,D=f.return_ivar,z=f.truthy,I=[],Q=f.nil;return N=I,E=re=[S(I[0],"BCDice")].concat(N),X=le=[S(re[0],"Command")].concat(E),R=[k=te(le[0],null,"Parsed")].concat(X),ee=f.$r(R),(H=k.$$prototype).critical=H.fumble=H.dollar=H.modify_number=H.question_target=H.target_number=H.prefix_number=H.command=H.suffix_number=H.cmp_op=Q,k.$attr_accessor("command"),k.$attr_accessor("prefix_number"),k.$attr_accessor("suffix_number"),k.$attr_accessor("critical"),k.$attr_accessor("fumble"),k.$attr_accessor("dollar"),k.$attr_accessor("modify_number"),k.$attr_accessor("cmp_op"),k.$attr_accessor("target_number"),k.$attr_writer("question_target"),v(k,"$initialize",function(){var M=this;return M.prefix_number=Q,M.suffix_number=Q,M.critical=Q,M.fumble=Q,M.dollar=Q,M.cmp_op=Q,M.target_number=Q,M.question_target=!1}),v(k,"$question_target?",D("question_target")),v(k,"$to_s",function(M){var C=this,P=Q,L=Q,ne=Q,F=Q,he=Q;switch(null==M&&(M="after_command"),P=z(C.critical)?"@"+C.critical:Q,L=z(C.fumble)?"#"+C.fumble:Q,ne=z(C.dollar)?"$"+C.dollar:Q,F=ee("Format").$modifier(C.modify_number),he=z(C.question_target)?"?":C.target_number,M.valueOf()){case"after_command":return[C.prefix_number,C.command,C.suffix_number,P,L,ne,F,C.cmp_op,he].$join();case"after_modify_number":return[C.prefix_number,C.command,C.suffix_number,F,P,L,ne,C.cmp_op,he].$join();case"after_target_number":return[C.prefix_number,C.command,C.suffix_number,F,C.cmp_op,he,P,L,ne].$join();default:return Q}},-1)},Opal.modules["bcdice/command/parser"]=function(f){var M,ne,l,x,$,se,ae,Te,Ae,de,Fe,xe,Me,c,p,_,pe,he,B,P,S=f.klass,te=f.module,v=f.slice,D=f.extract_kwargs,z=f.ensure_kwargs,I=f.get_kwarg,Q=f.send2,U=f.find_super,N=f.def,G=f.send,re=f.eqeq,q=f.thrower,E=f.hash,V=f.const_set,le=f.truthy,Z=f.to_ary,Y=f.hash2,X=f.top,k=[],R=f.$r(k),ee=f.nil,H=f.$$$;return X.$require("racc/parser.rb"),X.$require("bcdice/arithmetic/node"),X.$require("bcdice/command/lexer"),X.$require("bcdice/command/parsed"),S(H(R("BCDice"),"Command"),H(R("Racc"),"Parser"),"Parser"),M=k,ne=P=[te(k[0],"BCDice")].concat(M),he=[te(P[0],"Command")].concat(ne),B=f.$r(he),l=he,p=[c=S(he[0],H(B("Racc"),"Parser"),"Parser")].concat(l),_=f.$r(p),(pe=c.$$prototype).notations=pe.lexer=pe.modifier=pe.suffix_number=pe.prefix_number=pe.need_suffix_number=pe.need_prefix_number=pe.critical=pe.fumble=pe.dollar=pe.allowed_cmp_op=pe.question_target=ee,N(c,"$initialize",function ye(b,K){var ge,be,Pe,Ue,nt=this;return ye.$$p=null,ge=v(arguments),be=D(ge),be=z(be),Pe=ge,Ue=I(be,"round_type"),Q(nt,U(nt,"initialize",ye,!1,!0),"initialize",[],null),nt.notations=Pe,nt.round_type=Ue,nt.prefix_number=!1,nt.suffix_number=!1,nt.need_prefix_number=!1,nt.need_suffix_number=!1,nt.modifier=!0,nt.critical=!1,nt.fumble=!1,nt.dollar=!1,nt.allowed_cmp_op=[ee,">=",">","<=","<","==","!="],nt.question_target=!1},-2),N(c,"$disable_modifier",function(){return this.modifier=!1,this}),N(c,"$enable_prefix_number",function(){return this.prefix_number=!0,this}),N(c,"$enable_suffix_number",function(){return this.suffix_number=!0,this}),N(c,"$has_prefix_number",function(){var b=this;return b.prefix_number=!0,b.need_prefix_number=!0,b}),N(c,"$has_suffix_number",function(){var b=this;return b.suffix_number=!0,b.need_suffix_number=!0,b}),N(c,"$enable_critical",function(){return this.critical=!0,this}),N(c,"$enable_fumble",function(){return this.fumble=!0,this}),N(c,"$enable_dollar",function(){return this.dollar=!0,this}),N(c,"$restrict_cmp_op_to",function(b){var K,be=this;return K=v(arguments),be.allowed_cmp_op=K,be},-1),N(c,"$enable_question_target",function(){return this.question_target=!0,this}),N(c,"$parse",function(b){var K=this;try{return K.lexer=_("Lexer").$new(b,K.notations),K.$do_parse()}catch(ge){if(!f.rescue(ge,[_("ParseError"),_("ZeroDivisionError")]))throw ge;try{return ee}finally{f.pop_exception()}}}),c.$private(),N(c,"$parsed",function(b,K,ge,be){try{return q("eval_return"),G(_("Parsed").$new(),"tap",[],function Ye(nt){var vt,wt,cn,an,Bn,zn,Hi,lr=null==Ye.$$s?this:Ye.$$s;return null==lr.round_type&&(lr.round_type=ee),null==nt&&(nt=ee),nt["$command="](b["$[]"]("command")),nt["$prefix_number="]((vt=b["$[]"]("prefix"))===ee||null==vt?ee:vt.$eval(lr.round_type)),nt["$suffix_number="]((wt=b["$[]"]("suffix"))===ee||null==wt?ee:wt.$eval(lr.round_type)),nt["$critical="]((cn=K["$[]"]("critical"))===ee||null==cn?ee:cn.$eval(lr.round_type)),nt["$fumble="]((an=K["$[]"]("fumble"))===ee||null==an?ee:an.$eval(lr.round_type)),nt["$dollar="]((Bn=K["$[]"]("dollar"))===ee||null==Bn?ee:Bn.$eval(lr.round_type)),nt["$modify_number="](ge.$eval(lr.round_type)),nt["$cmp_op="](be["$[]"]("cmp_op")),re(be["$[]"]("target"),"?")?(nt["$question_target="](!0),G(nt,"target_number=",zn=[0]),zn[zn.length-1]):(nt["$question_target="](!1),zn=[(Hi=be["$[]"]("target"),Hi===ee||null==Hi?ee:Hi.$eval(lr.round_type))],G(nt,"target_number=",zn),zn[zn.length-1])},{$$s:this})}catch(Ye){if(Ye===f.t_eval_return)return Ye.$v;throw Ye}}),N(c,"$next_token",function(){return this.lexer.$next_token()}),x=f.large_array_unpack("6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,33,34,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,,,17,18,6,,5,,,17,18,,,5,23,24,25,26,56,54,55,57"),$=f.large_array_unpack("0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,,17,15,15,18,18,23,,18,30,30,23,23,24,,23,31,31,24,24,25,,24,44,44,25,25,28,,25,47,47,28,28,29,,28,48,48,29,29,33,,29,49,49,33,33,34,,33,50,50,34,34,36,,34,,,36,36,37,,36,,,37,37,,,37,27,27,27,27,52,52,52,52"),se=f.large_array_unpack("-2,4,16,-3,-1,11,,33,13,35,23,30,1,,28,40,,37,44,,,-2,,51,58,65,0,106,72,79,47,54,,86,93,,100,107,,,,,,,63,,,68,75,82,89,,120,,,,,"),ae=f.large_array_unpack("-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29"),Te=f.large_array_unpack("30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,,,21,47,48,40,51,52,49,50,44,46,3,,,,13,,,,,,,,32"),Ae=f.large_array_unpack("8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,,,4,8,8,5,7,7,8,8,9,5,6,,,,6,,,,,,,,6"),de=[ee,6,13,3,9,-1,27,-15,-10,-1,-38],Fe=[ee,ee,ee,ee,ee,ee,19,16,15,ee,ee],xe=f.large_array_unpack("0,0,racc_error,4,20,_reduce_1,4,20,_reduce_2,3,20,_reduce_3,3,21,_reduce_4,2,21,_reduce_5,2,21,_reduce_6,1,21,_reduce_7,0,22,_reduce_8,3,22,_reduce_9,3,22,_reduce_10,3,22,_reduce_11,2,23,_reduce_12,2,23,_reduce_13,3,23,_reduce_14,3,23,_reduce_15,0,24,_reduce_16,2,24,_reduce_17,2,24,_reduce_18,3,28,_reduce_19,3,28,_reduce_20,1,28,_reduce_none,3,27,_reduce_22,4,27,_reduce_23,1,27,_reduce_none,0,29,_reduce_25,1,29,_reduce_26,1,29,_reduce_27,1,29,_reduce_28,1,29,_reduce_29,2,26,_reduce_30,2,26,_reduce_31,1,26,_reduce_none,3,25,_reduce_33,1,25,_reduce_34"),Me=E(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),V(p[0],"Racc_arg",[x,$,ae,se,Te,Ae,Fe,de,19,xe,Me,58,35,!0]),le(_("Ractor","skip_raise")?"constant":ee)&&_("Ractor").$make_shareable(_("Racc_arg")),V(p[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),le(_("Ractor","skip_raise")?"constant":ee)&&_("Ractor").$make_shareable(_("Racc_token_to_s_table")),V(p[0],"Racc_debug_parser",!1),N(c,"$_reduce_1",function(b,K,ge){var be;return le(this.modifier)||this.$raise(_("ParseError")),be=Z(b),this.$parsed(null==be[0]?ee:be[0],null==be[1]?ee:be[1],null==be[2]?ee:be[2],null==be[3]?ee:be[3])}),N(c,"$_reduce_2",function(b,K,ge){var be;return le(this.modifier)||this.$raise(_("ParseError")),be=Z(b),this.$parsed(null==be[0]?ee:be[0],null==be[2]?ee:be[2],null==be[1]?ee:be[1],null==be[3]?ee:be[3])}),N(c,"$_reduce_3",function(b,K,ge){var be,vt;return vt=null==(be=Z(b))[2]?ee:be[2],this.$parsed(null==be[0]?ee:be[0],null==be[1]?ee:be[1],H(H(_("Arithmetic"),"Node"),"Number").$new(0),vt)}),N(c,"$_reduce_4",function(b,K,ge){return le(this.prefix_number)&&le(this.suffix_number)||this.$raise(_("ParseError")),Y(["command","prefix","suffix"],{command:b["$[]"](1),prefix:b["$[]"](0),suffix:b["$[]"](2)})}),N(c,"$_reduce_5",function(b,K,ge){return le(this.prefix_number)||this.$raise(_("ParseError")),le(this.need_suffix_number)&&this.$raise(_("ParseError")),Y(["command","prefix"],{command:b["$[]"](1),prefix:b["$[]"](0)})}),N(c,"$_reduce_6",function(b,K,ge){return le(this.suffix_number)||this.$raise(_("ParseError")),le(this.need_prefix_number)&&this.$raise(_("ParseError")),Y(["command","suffix"],{command:b["$[]"](0),suffix:b["$[]"](1)})}),N(c,"$_reduce_7",function(b,K,ge){return(le(this.need_prefix_number)||le(this.need_suffix_number))&&this.$raise(_("ParseError")),Y(["command"],{command:b["$[]"](0)})}),N(c,"$_reduce_8",function(b,K,ge){return Y([],{})}),N(c,"$_reduce_9",function(b,K,ge){var be,vt,Ye=ee;return Ye=null==(be=Z(b))[0]?ee:be[0],vt=null==be[2]?ee:be[2],le(this.critical)&&le(Ye["$[]"]("critical")["$nil?"]())||this.$raise(_("ParseError")),Ye["$[]="]("critical",vt),Ye}),N(c,"$_reduce_10",function(b,K,ge){var be,vt,Ye=ee;return Ye=null==(be=Z(b))[0]?ee:be[0],vt=null==be[2]?ee:be[2],le(this.fumble)&&le(Ye["$[]"]("fumble")["$nil?"]())||this.$raise(_("ParseError")),Ye["$[]="]("fumble",vt),Ye}),N(c,"$_reduce_11",function(b,K,ge){var be,vt,Ye=ee;return Ye=null==(be=Z(b))[0]?ee:be[0],vt=null==be[2]?ee:be[2],le(this.dollar)&&le(Ye["$[]"]("dollar")["$nil?"]())||this.$raise(_("ParseError")),Ye["$[]="]("dollar",vt),Ye}),N(c,"$_reduce_12",function(b,K,ge){return b["$[]"](1)}),N(c,"$_reduce_13",function(b,K,ge){return H(H(_("Arithmetic"),"Node"),"Negative").$new(b["$[]"](1))}),N(c,"$_reduce_14",function(b,K,ge){return H(H(_("Arithmetic"),"Node"),"BinaryOp").$new(b["$[]"](0),"+",b["$[]"](2))}),N(c,"$_reduce_15",function(b,K,ge){return H(H(_("Arithmetic"),"Node"),"BinaryOp").$new(b["$[]"](0),"-",b["$[]"](2))}),N(c,"$_reduce_16",function(b,K,ge){return le(this.allowed_cmp_op["$include?"](ee))||this.$raise(_("ParseError")),Y([],{})}),N(c,"$_reduce_17",function(b,K,ge){var be,Ye,nt;return nt=null==(be=Z(b))[1]?ee:be[1],le(this.allowed_cmp_op["$include?"](Ye=null==be[0]?ee:be[0]))||this.$raise(_("ParseError")),Y(["cmp_op","target"],{cmp_op:Ye,target:nt})}),N(c,"$_reduce_18",function(b,K,ge){var Pe;return Pe=b["$[]"](0),le(this.question_target)||this.$raise(_("ParseError")),le(this.allowed_cmp_op["$include?"](Pe))||this.$raise(_("ParseError")),Y(["cmp_op","target"],{cmp_op:Pe,target:"?"})}),N(c,"$_reduce_19",function(b,K,ge){return H(H(_("Arithmetic"),"Node"),"BinaryOp").$new(b["$[]"](0),"+",b["$[]"](2))}),N(c,"$_reduce_20",function(b,K,ge){return H(H(_("Arithmetic"),"Node"),"BinaryOp").$new(b["$[]"](0),"-",b["$[]"](2))}),N(c,"$_reduce_22",function(b,K,ge){return H(H(_("Arithmetic"),"Node"),"BinaryOp").$new(b["$[]"](0),"*",b["$[]"](2))}),N(c,"$_reduce_23",function(b,K,ge){return b["$[]"](3).$new(b["$[]"](0),b["$[]"](2))}),N(c,"$_reduce_25",function(b,K,ge){return H(H(_("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),N(c,"$_reduce_26",function(b,K,ge){return H(H(_("Arithmetic"),"Node"),"DivideWithCeil")}),N(c,"$_reduce_27",function(b,K,ge){return H(H(_("Arithmetic"),"Node"),"DivideWithCeil")}),N(c,"$_reduce_28",function(b,K,ge){return H(H(_("Arithmetic"),"Node"),"DivideWithRound")}),N(c,"$_reduce_29",function(b,K,ge){return H(H(_("Arithmetic"),"Node"),"DivideWithFloor")}),N(c,"$_reduce_30",function(b,K,ge){return b["$[]"](1)}),N(c,"$_reduce_31",function(b,K,ge){return H(H(_("Arithmetic"),"Node"),"Negative").$new(b["$[]"](1))}),N(c,"$_reduce_33",function(b,K,ge){return b["$[]"](1)}),N(c,"$_reduce_34",function(b,K,ge){return H(H(_("Arithmetic"),"Node"),"Number").$new(b["$[]"](0))}),N(c,"$_reduce_none",function(b,K,ge){return b["$[]"](0)})},Opal.modules["bcdice/deprecated/checker"]=function(f){var G,V,X,k,R,ee,Z,q,S=f.module,te=f.send,v=f.eqeqeq,D=f.truthy,z=f.def,I=f.return_val,Q=[],U=f.nil;return G=Q,V=q=[S(Q[0],"BCDice")].concat(G),X=Z=[S(q[0],"Deprecated")].concat(V),R=[k=S(Z[0],"Checker")].concat(X),ee=f.$r(R),k.$private(),z(k,"$check_result_legacy",function(A,M,C,P){var he,L=this,ne=U,F=U,B=U,O=U;return ne=te(M,"map",[],"sides".$to_proc()),he=(F=te(M,"map",[],"value".$to_proc())).$sum(),B=v([100],O=ne)?L.$check_1D100(A,he,C,P):v([20],O)?L.$check_1D20(A,he,C,P):v([6,6],O)?L.$check_2D6(A,he,F,C,P):U,(D(B["$nil?"]())||D(B["$empty?"]()))&&(B=v([10],O=ne.$uniq())?L.$check_nD10(A,he,F,C,P):v([6],O)?L.$check_nD6(A,he,F,C,P):U,D(B["$nil?"]())||D(B["$empty?"]()))?U:ee("Result").$new(B.$delete_prefix(" \uff1e "))}),z(k,"$check_1D100",I(U)),z(k,"$check_1D20",I(U)),z(k,"$check_nD10",I(U)),z(k,"$check_2D6",I(U)),z(k,"$check_nD6",I(U))},Opal.queue(function(f){var R,L,O,d,_,x,m,l,c,h,F,S=f.module,te=f.klass,v=f.slice,D=f.rb_plus,z=f.truthy,I=f.def,Q=f.regexp,U=f.send,N=f.thrower,G=f.return_ivar,re=f.assign_ivar_val,q=f.eqeqeq,E=f.eqeq,V=f.return_val,le=f.range,Z=f.rb_minus,Y=f.rb_divide,X=f.rb_times,k=f.rb_ge,ee=f.top,H=[],A=f.$r(H),M=f.nil,C=f.$$$;return ee.$require("i18n"),ee.$require("i18n/backend/fallbacks"),ee.$require("bcdice/randomizer"),ee.$require("bcdice/dice_table"),ee.$require("bcdice/enum"),ee.$require("bcdice/translate"),ee.$require("bcdice/result"),ee.$require("bcdice/command/parser"),ee.$require("bcdice/deprecated/checker"),L=H,O=F=[S(H[0],"BCDice")].concat(L),l=[m=te(F[0],null,"Base")].concat(O),c=f.$r(l),(h=m.$$prototype).raw_input=h.randomizer=h.enabled_upcase_input=h.debug=M,_=[d=f.get_singleton_class(m)].concat(l),x=f.$r(_),d.$attr_reader("prefixes"),I(d,"$register_prefix",function(se){var Te,Ae=this,de=M;return null==Ae.prefixes&&(Ae.prefixes=M),Te=v(arguments),Ae.prefixes=D(z(de=Ae.prefixes)?de:[],Te.$flatten())},-1),I(d,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())}),I(d,"$prefixes_pattern",function(){var se=this,ae=M;return null==se.prefixes_pattern&&(se.prefixes_pattern=M),null==se.prefixes&&(se.prefixes=M),se.prefixes_pattern=z(ae=se.prefixes_pattern)?ae:M,z(se.prefixes_pattern)?se.prefixes_pattern:(se.prefixes=z(ae=se.prefixes)?ae:[],se.prefixes.$freeze(),se.prefixes_pattern=(z(se.prefixes["$empty?"]())?/(?!)/:Q(["^(S)?(",se.prefixes.$join("|"),")"],"i")).$freeze())}),I(d,"$command_pattern",function(){var se=this,ae=M,Te=M;return null==se.command_pattern&&(se.command_pattern=M),null==se.prefixes&&(se.prefixes=M),se.command_pattern=z(ae=se.command_pattern)?ae:M,z(se.command_pattern)?se.command_pattern:(se.prefixes=z(ae=se.prefixes)?ae:[],se.prefixes.$freeze(),Te=D(U(C(x("CommonCommand"),"COMMANDS"),"map",[],function(de){return null==de&&(de=M),C(de,"PREFIX_PATTERN").$source()}),se.prefixes),se.command_pattern=Q(["^S?(",Te.$join("|"),")"],"i").$freeze())}),I(d,"$eval",function(se){try{return N("eval_return"),this.$new(se).$eval()}catch(Ae){if(Ae===f.t_eval_return)return Ae.$v;throw Ae}}),m.$include(c("Translate")),m.$include(C(c("Deprecated"),"Checker")),I(m,"$initialize",function(p){var _=this;return _.raw_input=p,_.sort_add_dice=!1,_.sort_barabara_dice=!1,_.d66_sort_type=C(c("D66SortType"),"NO_SORT"),_.enabled_d9=!1,_.round_type=C(c("RoundType"),"FLOOR"),_.sides_implicit_d=6,_.upper_dice_reroll_threshold=M,_.reroll_dice_reroll_threshold=M,_.default_cmp_op=M,_.default_target_number=M,_.enabled_upcase_input=!0,_.locale="ja_jp",_.randomizer=C(c("BCDice"),"Randomizer").$new(),_.debug=!1}),m.$attr_accessor("randomizer"),m.$attr_reader("d66_sort_type"),m.$attr_reader("round_type"),m.$attr_reader("sides_implicit_d"),m.$attr_reader("upper_dice_reroll_threshold"),m.$attr_reader("reroll_dice_reroll_threshold"),m.$attr_reader("default_cmp_op"),m.$attr_reader("default_target_number"),I(m,"$sort_add_dice?",G("sort_add_dice")),I(m,"$sort_barabara_dice?",G("sort_barabara_dice")),I(m,"$enabled_d9?",G("enabled_d9")),I(m,"$enable_debug",re("debug",!0)),I(m,"$eval",function(){var _,$,p=this,x=M;return _=C(c("BCDice"),"Preprocessor").$process(p.raw_input,p),x=z($=p.$dice_command(_))?$:p.$eval_common_command(p.raw_input),z(x)?(x["$rands="](p.randomizer.$rand_results()),x["$detailed_rands="](p.randomizer.$detailed_rand_results()),x):M}),I(m,"$change_text",function(p){return p}),I(m,"$check_result",function(p,_,x,$){var se=this,ae=M,Te=M,Ae=M,de=M,Fe=M;return ae=se.$check_result_legacy(p,_,x,$),z(ae)?ae:(Te=U(_,"map",[],"sides".$to_proc()),de=(Ae=U(_,"map",[],"value".$to_proc())).$sum(),ae=q([100],Fe=Te)?se.$result_1d100(p,de,x,$):q([20],Fe)?se.$result_1d20(p,de,x,$):q([6,6],Fe)?se.$result_2d6(p,de,Ae,x,$):M,E(ae,c("Result").$nothing())?M:z(ae)?ae:(ae=q([10],Fe=Te.$uniq())?se.$result_nd10(p,de,Ae,x,$):q([6],Fe)?se.$result_nd6(p,de,Ae,x,$):M,E(ae,c("Result").$nothing())?M:z(ae)?ae:se.$result_ndx(p,x,$)))}),I(m,"$grich_text",V(M)),m.$private(),I(m,"$eval_common_command",function(p){try{N("eval_return");var x=N("return");return p=this.$change_text(p),U(C(c("CommonCommand"),"COMMANDS"),"each",[],function se(ae){var Ae,Te=null==se.$$s?this:se.$$s;if(null==Te.randomizer&&(Te.randomizer=M),null==ae&&(ae=M),Ae=ae.$eval(p,Te,Te.randomizer),!z(Ae))return M;x.$throw(Ae)},{$$s:this,$$ret:x}),M}catch(se){if(se===f.t_eval_return||se===x)return se.$v;throw se}}),I(m,"$dice_command",function(p){var _=this,x=M,$=M,se=M,ae=M;return z(_.enabled_upcase_input)&&(p=p.$upcase()),x=_.$class().$prefixes_pattern().$match(p),z(x)?($=x["$[]"](1)["$nil?"]()["$!"](),z($)&&(p=p["$[]"](le(1,-1,!1))),se=_.$eval_game_system_specific_command(p),z(se["$is_a?"](c("Result")))?(se["$secret="](z(ae=se["$secret?"]())?ae:$),se):z(se["$nil?"]())||z(se["$empty?"]())||E(se,"1")?M:U(c("Result").$new(),"tap",[],function(Ae){var de;return null==Ae&&(Ae=M),Ae["$text="](se.$to_s()),U(Ae,"secret=",de=[$]),de[de.length-1]})):M}),I(m,"$eval_game_system_specific_command",V(M)),I(m,"$result_ndx",function(p,_,x){return z(x["$is_a?"](c("String")))?M:z(p.$send(_,x))?c("Result").$success(this.$translate("success")):c("Result").$failure(this.$translate("failure"))}),I(m,"$result_1d100",V(M)),I(m,"$result_1d20",V(M)),I(m,"$result_nd10",V(M)),I(m,"$result_2d6",V(M)),I(m,"$result_nd6",V(M)),I(m,"$get_table_by_2d6",function(p){return this.$get_table_by_nD6(p,2)}),I(m,"$get_table_by_1d6",function(p){return this.$get_table_by_nD6(p,1)}),I(m,"$get_table_by_nD6",function(p,_){return this.$get_table_by_nDx(p,_,6)}),I(m,"$get_table_by_nDx",function(p,_,x){var se,ae=M;return se=this.randomizer.$roll_sum(_,x),ae=this.$get_table_value(p["$[]"](Z(se,_))),z(ae["$nil?"]())?["1",0]:[ae,se]}),I(m,"$get_table_by_1d3",function(p){var $,se,_=this,ae=M;return _.$debug("get_table_by_1d3"),$=_.randomizer.$roll_sum(1,6),_.$debug("num",$),se=Y(Z($,1),2).$to_i(),_.$debug("index",se),ae=p["$[]"](se),z(ae["$nil?"]())?["1",0]:[ae,$]}),I(m,"$get_table_by_d66_swap",function(p){var x;return x=this.randomizer.$roll_d66(C(c("D66SortType"),"ASC")),[this.$get_table_by_number(x,p),x]}),I(m,"$get_table_by_d66",function(p){var x,$,se,Te,ae=M;return x=this.randomizer.$roll_once(6),$=this.randomizer.$roll_once(6),se=D(X(Z(x,1),6),Z($,1)),ae=p["$[]"](se),Te=""+x+$,z(ae["$nil?"]())?["1",Te]:[ae,Te]}),I(m,"$get_table_by_number",function(p,_,x){try{var $=N("return");return null==x&&(x="1"),U(_,"each",[],function ae(Te){var de,Ae=null==ae.$$s?this:ae.$$s;if(null==Te&&(Te=M),de=Te["$[]"](0),!z(k(de,p)))return M;$.$throw(Ae.$get_table_value(Te["$[]"](1)))},{$$s:this,$$ret:$}),this.$get_table_value(x)}catch(ae){if(ae===$)return ae.$v;throw ae}},-3),I(m,"$get_table_value",function(p){return z(p["$is_a?"](c("Proc")))?p.$call():p}),I(m,"$roll_tables",function(p,_){var $=M;return $=_["$[]"](p),z($)?$.$roll(this.randomizer).$to_s():M}),I(m,"$debug",function(p,_){var $,se=this,ae=M,Te=M;return $=v(arguments,1),z(se.debug)?(ae=z(p["$is_a?"](c("String")))?p:p.$inspect(),z($["$empty?"]())?se.$warn(ae):(Te=U($,"map",[],function(de){return null==de&&(de=M),z(de["$is_a?"](c("String")))?'"'+de+'"':de.$inspect()}),se.$warn(ae+": "+Te.$join(", ")))):M},-2),C(C(A("I18n"),"Backend"),"Simple").$include(C(C(A("I18n"),"Backend"),"Fallbacks")),A("I18n").$load_path()["$<<"](A("Dir")["$[]"](A("File").$join("bcdice","../../i18n/**/*.yml"))),A("I18n")["$default_locale="]("ja_jp"),R=[["ja_jp"]],U(A("I18n").$fallbacks(),"defaults=",R),R[R.length-1]})},4748:(T,fe,Ce)=>{Ce(9993),Opal.modules["bcdice/normalize"]=function(f){var U,q,G,S=f.module,te=f.eqeqeq,v=f.def,D=f.eqeq,z=[],I=f.nil;return U=z,G=[S(z[0],"BCDice")].concat(U),(q=S(G[0],"Normalize")).$module_function(),v(q,"$comparison_operator",function(V){var le;return te(/<=|=</,le=V)?"<=":te(/>=|=>/,le)?">=":te(/<>|!=|=!/,le)?"!=":te(/</,le)?"<":te(/>/,le)?">":te(/=/,le)?"==":I}),v(q,"$target_number",function(V){return D(V,"?")?V:V.$to_i()})},Opal.modules["racc/parser"]=function(f){var P,ne,F,S=f.module,te=f.klass,v=f.truthy,D=f.const_set,z=f.defs,I=f.gvars,Q=f.rb_lt,U=f.def,N=f.to_ary,G=f.send,re=f.neqeq,q=f.rb_plus,E=f.eqeq,V=f.rb_ge,le=f.rb_gt,Z=f.rb_minus,Y=f.rb_le,X=f.rb_times,k=f.assign_ivar_val,ee=[],H=f.$r(ee),A=f.nil,M=f.$$$;return P=ee,ne=[S(ee[0],"Racc")].concat(P),F=f.$r(ne),te(ne[0],F("StandardError"),"ParseError"),v(M("::","ParseError","skip_raise")?"constant":A)||D(ee[0],"ParseError",M(H("Racc"),"ParseError")),function(C,P){var m,l,c,h,d,F=[S(C,"Racc")].concat(P),he=f.$r(F);return v(he("Racc_No_Extensions","skip_raise")?"constant":A)||D(F[0],"Racc_No_Extensions",!1),m=F,c=[l=te(F[0],null,"Parser")].concat(m),h=f.$r(c),(d=l.$$prototype).yydebug=d.racc_debug_out=d.racc_error_status=d.racc_t=d.racc_vstack=d.racc_val=d.racc_state=d.racc_tstack=A,D(c[0],"Racc_Runtime_Version","1.4.6"),D(c[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),D(c[0],"Racc_Runtime_Core_Version_R","1.4.6"),D(c[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),D(c[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),D(c[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),D(c[0],"Racc_Runtime_Core_Version",h("Racc_Runtime_Core_Version_R")),D(c[0],"Racc_Runtime_Core_Revision",h("Racc_Runtime_Core_Revision_R")),D(c[0],"Racc_Runtime_Type","ruby"),z(h("Parser"),"$racc_runtime_type",function(){return h("Racc_Runtime_Type")}),U(l,"$_racc_setup",function(){var _,x,$=this,se=A,ae=A;return null==I.stderr&&(I.stderr=A),v(M($.$class(),"Racc_debug_parser"))||($.yydebug=!1),v(null!=(_=$.yydebug)&&_!==A?"instance-variable":A)||($.yydebug=!1),v($.yydebug)&&(v(null!=(x=$.racc_debug_out)&&x!==A?"instance-variable":A)||($.racc_debug_out=I.stderr),$.racc_debug_out=v(se=$.racc_debug_out)?se:I.stderr),ae=M($.$class(),"Racc_arg"),v(Q(ae.$size(),14))&&ae["$[]="](13,!0),ae}),U(l,"$_racc_init_sysvars",function(){var _=this;return _.racc_state=[0],_.racc_tstack=[],_.racc_vstack=[],_.racc_t=A,_.racc_val=A,_.racc_read_next=!0,_.racc_user_yyerror=!1,_.racc_error_status=0}),U(l,"$do_parse",function(){return this.$__send__(h("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),U(l,"$next_token",function(){return this.$raise(h("NotImplementedError"),this.$class()+"#next_token is not defined")}),U(l,"$_racc_do_parse_rb",function(_,x){var $,Te=A,Ae=A,de=A,Fe=A,ke=A,De=A,Me=A,_e=A;return $=N(_),Te=null==$[0]?A:$[0],Ae=null==$[1]?A:$[1],de=null==$[2]?A:$[2],Fe=null==$[3]?A:$[3],ke=null==$[10]?A:$[10],this.$_racc_init_sysvars(),De=Me=_e=A,G(this,"catch",["racc_end_parse"],function ce(){var pe,ye,b=null==ce.$$s?this:ce.$$s,K=A;for(null==b.racc_state&&(b.racc_state=A),null==b.racc_read_next&&(b.racc_read_next=A),null==b.racc_t&&(b.racc_t=A),null==b.yydebug&&(b.yydebug=A),null==b.racc_val&&(b.racc_val=A);v(!0);)for(v(_e=Fe["$[]"](b.racc_state["$[]"](-1)))?(v(b.racc_read_next)&&re(b.racc_t,0)&&(ye=b.$next_token(),pe=N(ye),De=null==pe[0]?A:pe[0],b.racc_val=null==pe[1]?A:pe[1],b.racc_t=v(De)?v(K=ke["$[]"](De))?K:1:0,v(b.yydebug)&&b.$racc_read_token(b.racc_t,De,b.racc_val),b.racc_read_next=!1),_e=q(_e,b.racc_t),v(V(_e,0))&&v(Me=Te["$[]"](_e))&&E(Ae["$[]"](_e),b.racc_state["$[]"](-1))||(Me=de["$[]"](b.racc_state["$[]"](-1)))):Me=de["$[]"](b.racc_state["$[]"](-1));v(Me=b.$_racc_evalact(Me,_)););},{$$s:this})}),U(l,"$yyparse",function(_,x){return this.$__send__(h("Racc_YY_Parse_Method"),_,x,this.$_racc_setup(),!0)}),U(l,"$_racc_yyparse_rb",function(_,x,$,se){var ae,de=A,Fe=A,xe=A,ke=A,Me=A,_e=A,ce=A;return ae=N($),de=null==ae[0]?A:ae[0],Fe=null==ae[1]?A:ae[1],xe=null==ae[2]?A:ae[2],ke=null==ae[3]?A:ae[3],Me=null==ae[10]?A:ae[10],this.$_racc_init_sysvars(),_e=A,ce=A,G(this,"catch",["racc_end_parse"],function pe(){var ye=null==pe.$$s?this:pe.$$s;for(null==ye.racc_state&&(ye.racc_state=A);!v(ce=ke["$[]"](ye.racc_state["$[]"](-1)));)for(;v(_e=ye.$_racc_evalact(xe["$[]"](ye.racc_state["$[]"](-1)),$)););return G(_,"__send__",[x],function b(K,ge){var be=null==b.$$s?this:b.$$s,Pe=A,Ue=A;for(null==be.racc_t&&(be.racc_t=A),null==be.racc_state&&(be.racc_state=A),null==be.racc_read_next&&(be.racc_read_next=A),null==K&&(K=A),null==ge&&(ge=A),be.racc_t=v(K)?v(Pe=Me["$[]"](K))?Pe:1:0,be.racc_val=ge,be.racc_read_next=!1,ce=q(ce,be.racc_t),v(V(ce,0))&&v(_e=de["$[]"](ce))&&E(Fe["$[]"](ce),be.racc_state["$[]"](-1))||(_e=xe["$[]"](be.racc_state["$[]"](-1)));v(_e=be.$_racc_evalact(_e,$)););for(;v(v(Pe=v(Ue=(ce=ke["$[]"](be.racc_state["$[]"](-1)))["$!"]())?Ue:be.racc_read_next["$!"]())?Pe:be.racc_t["$=="](0));)for(v(ce)&&v(ce=q(ce,be.racc_t))&&v(V(ce,0))&&v(_e=de["$[]"](ce))&&E(Fe["$[]"](ce),be.racc_state["$[]"](-1))||(_e=xe["$[]"](be.racc_state["$[]"](-1)));v(_e=be.$_racc_evalact(_e,$)););},{$$s:ye})},{$$s:this})}),U(l,"$_racc_evalact",function(_,x){var $,xe,ae=this,Te=A,Ae=A,Fe=A,ke=A,De=A,Me=A;if(Te=null==($=N(x))[0]?A:$[0],Ae=null==$[1]?A:$[1],Fe=null==$[3]?A:$[3],xe=null==$[11]?A:$[11],ke=null==$[12]?A:$[12],v(le(_,0))&&v(Q(_,xe)))v(le(ae.racc_error_status,0))&&(E(ae.racc_t,1)||(ae.racc_error_status=Z(ae.racc_error_status,1))),ae.racc_vstack.$push(ae.racc_val),ae.racc_state.$push(_),ae.racc_read_next=!0,v(ae.yydebug)&&(ae.racc_tstack.$push(ae.racc_t),ae.$racc_shift(ae.racc_t,ae.racc_tstack,ae.racc_vstack));else if(v(Q(_,0))&&v(le(_,ke["$-@"]()))){if(De=G(ae,"catch",["racc_jump"],function _e(){var ce=null==_e.$$s?this:_e.$$s;return null==ce.racc_state&&(ce.racc_state=A),ce.racc_state.$push(ce.$_racc_do_reduce(x,_)),!1},{$$s:ae}),v(De))switch(De.valueOf()){case 1:return ae.racc_user_yyerror=!0,ke["$-@"]();case 2:return xe;default:ae.$raise("[Racc Bug] unknown jump code")}}else if(E(_,xe))v(ae.yydebug)&&ae.$racc_accept(),ae.$throw("racc_end_parse",ae.racc_vstack["$[]"](0));else{if(E(_,ke["$-@"]())){switch(ae.racc_error_status.valueOf()){case 0:v(x["$[]"](21))||ae.$on_error(ae.racc_t,ae.racc_val,ae.racc_vstack);break;case 3:E(ae.racc_t,0)&&ae.$throw("racc_end_parse",A),ae.racc_read_next=!0}for(ae.racc_user_yyerror=!1,ae.racc_error_status=3;v(!0)&&!(v(Me=Fe["$[]"](ae.racc_state["$[]"](-1)))&&(Me=q(Me,1),v(V(Me,0))&&v(_=Te["$[]"](Me))&&E(Ae["$[]"](Me),ae.racc_state["$[]"](-1))));)v(Y(ae.racc_state.$size(),1))&&ae.$throw("racc_end_parse",A),ae.racc_state.$pop(),ae.racc_vstack.$pop(),v(ae.yydebug)&&(ae.racc_tstack.$pop(),ae.$racc_e_pop(ae.racc_state,ae.racc_tstack,ae.racc_vstack));return _}ae.$raise("[Racc Bug] unknown action "+_.$inspect())}return v(ae.yydebug)&&ae.$racc_next_state(ae.racc_state["$[]"](-1),ae.racc_state),A}),U(l,"$_racc_do_reduce",function(_,x){var $,ke,Me,K,ge,be,Ye,ae=this,Ae=A,de=A,Fe=A,xe=A,De=A,_e=A,ce=A,pe=A,ye=A,b=A,Pe=A,Ue=A,nt=A;return Ae=null==($=N(_))[4]?A:$[4],de=null==$[5]?A:$[5],Fe=null==$[6]?A:$[6],xe=null==$[7]?A:$[7],ke=null==$[8]?A:$[8],De=null==$[9]?A:$[9],Me=null==$[13]?A:$[13],_e=ae.racc_state,ce=ae.racc_vstack,pe=ae.racc_tstack,ye=X(x,-3),b=De["$[]"](ye),K=De["$[]"](q(ye,1)),ge=De["$[]"](q(ye,2)),be=[],v(ae.yydebug)&&(Pe=pe["$[]"](b["$-@"](),b)),Ue=ce["$[]"](b["$-@"](),b),v(ae.yydebug)&&pe["$[]="](b["$-@"](),b,be),ce["$[]="](b["$-@"](),b,be),_e["$[]="](b["$-@"](),b,be),v(Me)?ce.$push(ae.$__send__(ge,Ue,ce,Ue["$[]"](0))):ce.$push(ae.$__send__(ge,Ue,ce)),pe.$push(K),v(ae.yydebug)&&ae.$racc_reduce(Pe,K,pe,ce),Ye=Z(K,ke),v(ye=xe["$[]"](Ye))&&(ye=q(ye,_e["$[]"](-1)),v(V(ye,0))&&v(nt=Ae["$[]"](ye))&&E(de["$[]"](ye),Ye))?nt:Fe["$[]"](Ye)}),U(l,"$on_error",function(_,x,$){var ae;return this.$raise(h("ParseError"),this.$sprintf("\nparse error on value %s (%s)",x.$inspect(),v(ae=this.$token_to_str(_))?ae:"?"))}),U(l,"$yyerror",function(){return this.$throw("racc_jump",1)}),U(l,"$yyaccept",function(){return this.$throw("racc_jump",2)}),U(l,"$yyerrok",k("racc_error_status",0)),U(l,"$racc_read_token",function(_,x,$){var se=this;return se.racc_debug_out.$print("read    "),se.racc_debug_out.$print(x.$inspect(),"(",se.$racc_token2str(_),") "),se.racc_debug_out.$puts($.$inspect()),se.racc_debug_out.$puts()}),U(l,"$racc_shift",function(_,x,$){return this.racc_debug_out.$puts("shift   "+this.$racc_token2str(_)),this.$racc_print_stacks(x,$),this.racc_debug_out.$puts()}),U(l,"$racc_reduce",function(_,x,$,se){var ae=this,Te=A;return(Te=ae.racc_debug_out).$print("reduce "),v(_["$empty?"]())?Te.$print(" <none>"):G(_,"each",[],function Ae(de){return null==de&&(de=A),Te.$print(" ",(null==Ae.$$s?this:Ae.$$s).$racc_token2str(de))},{$$s:ae}),Te.$puts(" --\x3e "+ae.$racc_token2str(x)),ae.$racc_print_stacks($,se),ae.racc_debug_out.$puts()}),U(l,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),U(l,"$racc_e_pop",function(_,x,$){return this.racc_debug_out.$puts("error recovering mode: pop token"),this.$racc_print_states(_),this.$racc_print_stacks(x,$),this.racc_debug_out.$puts()}),U(l,"$racc_next_state",function(_,x){var $=this;return $.racc_debug_out.$puts("goto    "+_),$.$racc_print_states(x),$.racc_debug_out.$puts()}),U(l,"$racc_print_stacks",function(_,x){var se=A;return(se=this.racc_debug_out).$print("        ["),G(_,"each_index",[],function ae(Te){return null==Te&&(Te=A),se.$print(" (",(null==ae.$$s?this:ae.$$s).$racc_token2str(_["$[]"](Te))," ",x["$[]"](Te).$inspect(),")")},{$$s:this}),se.$puts(" ]")}),U(l,"$racc_print_states",function(_){var $=A;return($=this.racc_debug_out).$print("        ["),G(_,"each",[],function(ae){return null==ae&&(ae=A),$.$print(" ",ae)}),$.$puts(" ]")}),U(l,"$racc_token2str",function(_){var $;return v($=M(this.$class(),"Racc_token_to_s_table")["$[]"](_))?$:this.$raise("[Racc Bug] can't convert token "+_+" to string")}),U(l,"$token_to_str",function(_){return M(this.$class(),"Racc_token_to_s_table")["$[]"](_)})}(ee[0],ee)},Opal.modules.strscan=function(f){var E,V,le,Z,Y,te=f.def,v=f.truthy,D=f.eqeqeq,z=f.Opal,I=f.return_ivar,Q=f.send,U=f.alias,N=[],G=f.nil;return E=N,le=[V=(0,f.klass)(N[0],null,"StringScanner")].concat(E),Z=f.$r(le),(Y=V.$$prototype).pos=Y.string=Y.working=Y.matched=Y.prev_pos=Y.match=G,V.$attr_reader("pos","matched"),te(V,"$initialize",function(k){var R=this;return R.string=k,R.pos=0,R.matched=G,R.working=k,R.match=[]}),V.$attr_reader("string"),te(V,"$beginning_of_line?",function(){var k=this;return 0===k.pos||"\n"===k.string.charAt(k.pos-1)}),te(V,"$scan",function(k){var R=this,ee=(k=R.$anchor(k)).exec(R.working);return null==ee?R.matched=G:(R.prev_pos=R.pos,R.pos+=ee[0].length,R.working=R.working.substring(ee[0].length),R.matched=ee[0],R.match=ee,ee[0])}),te(V,"$scan_until",function(k){var R=this;k=R.$anchor(k);for(var ee=R.working,H=0;ee.length!=H;++H){var A=k.exec(ee.substr(H));if(null!==A){var M=H+A[0].length,C=ee.substr(0,M);return R.matched=A[0],R.match=A,R.prev_pos=R.pos+H,R.pos+=M,R.working=ee.substr(M),C}}return R.matched=G}),te(V,"$[]",function(k){var ee;if(v(this.match["$empty?"]()))return G;D(Z("Symbol"),ee=k)?k=k.$to_s():D(Z("String"),ee)||(k=z["$coerce_to!"](k,Z("Integer"),"to_int"));var H=this.match;return k<0&&(k+=H.length),k<0||k>=H.length||null==H[k]?G:H[k]}),te(V,"$check",function(k){var R=this,ee=(k=R.$anchor(k)).exec(R.working);return R.matched=null==ee?G:ee[0]}),te(V,"$check_until",function(k){var R=this,ee=R.prev_pos,H=R.pos,A=R.working,M=R.$scan_until(k);return R.prev_pos=ee,R.pos=H,R.working=A,M}),te(V,"$peek",function(k){return this.working.substring(0,k)}),te(V,"$eos?",function(){return 0===this.working.length}),te(V,"$exist?",function(k){var ee=k.exec(this.working);return null==ee?G:0==ee.index?0:ee.index+1}),te(V,"$skip",function(k){var R=this,ee=(k=R.$anchor(k)).exec(R.working);if(null==ee)return R.match=[],R.matched=G;var H=ee[0],A=H.length;return R.matched=H,R.match=ee,R.prev_pos=R.pos,R.pos+=A,R.working=R.working.substring(A),A}),te(V,"$skip_until",function(k){var ee=this.$scan_until(k);return ee===G?G:(this.matched=ee.substr(-1),ee.length)}),te(V,"$get_byte",function(){var k=this,R=G;return k.pos<k.string.length?(k.prev_pos=k.pos,k.pos+=1,R=k.matched=k.working.substring(0,1),k.working=k.working.substring(1)):k.matched=G,R}),te(V,"$match?",function(k){var R=this,ee=(k=R.$anchor(k)).exec(R.working);return null==ee?G:(R.prev_pos=R.pos,ee[0].length)}),te(V,"$pos=",function(k){var R=this;return k<0&&(k+=R.string.$length()),R.pos=k,R.working=R.string.slice(k)}),te(V,"$matched_size",function(){return this.matched===G?G:this.matched.length}),te(V,"$post_match",function(){var k=this;return k.matched===G?G:k.string.substr(k.pos)}),te(V,"$pre_match",function(){var k=this;return k.matched===G?G:k.string.substr(0,k.prev_pos)}),te(V,"$reset",function(){var k=this;return k.working=k.string,k.matched=G,k.pos=0}),te(V,"$rest",I("working")),te(V,"$rest?",function(){return 0!==this.working.length}),te(V,"$rest_size",function(){return this.$rest().$size()}),te(V,"$terminate",function(){var k,R=this;return R.match=G,k=[R.string.$length()],Q(R,"pos=",k),k[k.length-1]}),te(V,"$unscan",function(){var k=this;return k.pos=k.prev_pos,k.prev_pos=G,k.match=G,k}),U(V,"bol?","beginning_of_line?"),U(V,"getch","get_byte"),V.$private(),te(V,"$anchor",function(k){var R=k.toString().match(/\/([^\/]+)$/);return R=R?R[1]:void 0,new RegExp("^(?:"+k.source+")",R)})},Opal.modules["bcdice/common_command/lexer"]=function(f){var re,le,R,ee,H,A,Y,E,S=f.module,te=f.klass,v=f.const_set,D=f.hash2,z=f.truthy,I=f.def,Q=f.top,U=[],N=f.nil;return Q.$require("strscan"),Q.$require("bcdice/normalize"),re=U,le=E=[S(U[0],"BCDice")].concat(re),R=Y=[S(E[0],"CommonCommand")].concat(le),H=[ee=te(Y[0],null,"Lexer")].concat(R),A=f.$r(H),ee.$$prototype.scanner=N,v(H[0],"SYMBOLS",D(["+","-","*","/","(",")","[","]","?","@"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","?":"QUESTION","@":"AT"}).$freeze()),I(ee,"$initialize",function(P){var ne;return P=z(ne=P.$split(" ",2).$first())?ne:"",this.scanner=A("StringScanner").$new(P)}),I(ee,"$next_token",function(){var P=this,L=N,ne=N,F=N,B=N;return z(P.scanner["$eos?"]())?[!1,"$"]:z(L=P.scanner.$scan(/\d+/))?["NUMBER",L.$to_i()]:z(ne=P.scanner.$scan(/[<>!=]+/))?["CMP_OP",A("Normalize").$comparison_operator(ne)]:(F=P.scanner.$getch().$upcase(),[z(B=A("SYMBOLS")["$[]"](F))?B:F.$to_sym(),F])}),I(ee,"$source",function(){return this.scanner.$string()})},Opal.modules.singleton=function(f){var re,Z,Y,X,k,q,E,V,S=f.module,te=f.def,v=f.send2,D=f.find_super,z=f.send,I=f.truthy,Q=f.defs,U=[],N=f.nil;return re=U,E=[q=S(U[0],"Singleton")].concat(re),V=f.$r(E),te(q,"$clone",function(){return this.$raise(V("TypeError"),"can't clone instance of singleton "+this.$class())}),te(q,"$dup",function(){return this.$raise(V("TypeError"),"can't dup instance of singleton "+this.$class())}),Z=E,X=[Y=S(E[0],"SingletonClassMethods")].concat(Z),k=f.$r(X),te(Y,"$clone",function R(){var ee=R.$$p||N;return R.$$p=null,k("Singleton").$__init__(v(this,D(this,"clone",R,!1,!0),"clone",[],ee))}),te(Y,"$inherited",function R(ee){var H=R.$$p||N;return R.$$p=null,v(this,D(this,"inherited",R,!1,!0),"inherited",[ee],H),k("Singleton").$__init__(ee)}),function(le,Z){var Y=[le].concat(Z),X=f.$r(Y);return te(le,"$__init__",function(R){return z(R,"instance_eval",[],function H(){return(null==H.$$s?this:H.$$s).singleton__instance__=N},{$$s:this}),Q(R,"$instance",function(){var A=this;return null==A.singleton__instance__&&(A.singleton__instance__=N),I(A.singleton__instance__)?A.singleton__instance__:A.singleton__instance__=A.$new()}),R}),te(le,"$included",function k(R){var ee=k.$$p||N;return k.$$p=null,v(this,D(this,"included",k,!1,!0),"included",[R],ee),R.$extend(X("SingletonClassMethods")),X("Singleton").$__init__(R)})}(f.get_singleton_class(V("Singleton")),E)},Opal.modules["bcdice/common_command/add_dice/node"]=function(f){var C,F,m,d,ae,Te,Ae,de,Fe,_,x,c,B,L,S=f.module,te=f.klass,v=f.def,D=f.rb_plus,z=f.thrower,I=f.truthy,Q=f.rb_le,U=f.send,N=f.return_val,G=f.alias,re=f.return_ivar,q=f.send2,E=f.find_super,V=f.const_set,le=f.eqeqeq,Z=f.rb_divide,Y=f.assign_ivar,X=f.not,k=f.neqeq,ee=[],H=f.nil,A=f.$$$;return f.top.$require("singleton"),C=ee,F=L=[S(ee[0],"BCDice")].concat(C),m=B=[S(L[0],"CommonCommand")].concat(F),d=c=[S(B[0],"AddDice")].concat(m),_=[S(c[0],"Node")].concat(d),x=f.$r(_),ae=_,Ae=[Te=te(_[0],null,"Command")].concat(ae),de=f.$r(Ae),(Fe=Te.$$prototype).lhs=Fe.rhs=Fe.cmp_op=H,Te.$attr_reader("lhs"),Te.$attr_reader("cmp_op"),Te.$attr_reader("rhs"),v(Te,"$initialize",function(ke,De,Me,_e){return null==Me&&(Me=H),null==_e&&(_e=H),this.secret=ke,this.lhs=De,this.cmp_op=Me,this.rhs=_e},-3),v(Te,"$expr",function(ke){try{var Me;return z("eval_return"),D(D(this.lhs.$expr(ke),this.$cmp_op_text()),(Me=this.rhs,Me===H||null==Me?H:Me.$eval(ke,H)).$to_s())}catch(ce){if(ce===f.t_eval_return)return ce.$v;throw ce}}),v(Te,"$s_exp",function(){var ke=this;return I(ke.cmp_op)?"(Command ("+ke.cmp_op+" "+ke.lhs.$s_exp()+" "+ke.rhs.$s_exp()+"))":"(Command "+ke.lhs.$s_exp()+")"}),v(Te,"$eval",function(ke,De){try{z("eval_return");var _e,ge,ce=this,pe=H,ye=H,b=H,K=H,be=H;return De=de("Randomizer").$new(De,ke),pe=ce.lhs.$eval(ke,De),ye=I(Q(De.$rand_results().$size(),1))&&I(ce.lhs["$is_a?"](A(de("Node"),"DiceRoll")))?H:ce.lhs.$output(),b=I(ce.cmp_op)?(K=ce.rhs.$eval(ke,H),ke.$check_result(pe,De.$rand_results(),ce.cmp_op,K)):H,b=I(ge=b)?ge:de("Result").$new(),be=["("+ce.$expr(ke)+")",ye,pe,(_e=b,_e===H||null==_e?H:_e.$text())].$compact(),U(b,"tap",[],function Pe(Ue){var Ye,nt=null==Pe.$$s?this:Pe.$$s;return null==nt.secret&&(nt.secret=H),null==Ue&&(Ue=H),Ue["$secret="](nt.secret),Ye=[be.$join(" \uff1e ")],U(Ue,"text=",Ye),Ye[Ye.length-1]},{$$s:ce})}catch(Pe){if(Pe===f.t_eval_return)return Pe.$v;throw Pe}}),Te.$private(),v(Te,"$cmp_op_text",function(){switch(this.cmp_op.valueOf()){case"!=":return"<>";case"==":return"=";default:return this.cmp_op.$to_s()}}),function($,se,ae){var Te=te($,null,"UndecidedTarget"),Ae=[Te].concat(ae),de=f.$r(Ae);Te.$include(de("Singleton")),v(Te,"$eval",N("?")),v(Te,"$include_dice?",N(!1)),v(Te,"$expr",N("?")),v(Te,"$output",N("?")),G(Te,"s_exp","output")}(_[0],0,_),function($,se){var ae=te($,null,"BinaryOp"),Te=ae.$$prototype;Te.lhs=Te.rhs=Te.op=H,v(ae,"$initialize",function(de,Fe,xe){return this.lhs=de,this.op=Fe,this.rhs=xe}),v(ae,"$eval",function(de,Fe){try{var De,Me;return z("eval_return"),De=this.lhs.$eval(de,Fe),Me=this.rhs.$eval(de,Fe),this.$calc(De,Me,de.$round_type()).$to_i()}catch(_e){if(_e===f.t_eval_return)return _e.$v;throw _e}}),v(ae,"$include_dice?",function(){var Fe;return I(Fe=this.lhs["$include_dice?"]())?Fe:this.rhs["$include_dice?"]()}),v(ae,"$expr",function(de){var xe,ke;return xe=this.lhs.$expr(de),ke=this.rhs.$expr(de),""+xe+this.op+ke}),v(ae,"$output",function(){return""+this.lhs.$output()+this.op+this.rhs.$output()}),v(ae,"$s_exp",function(){return"("+this.$op_for_s_exp()+" "+this.lhs.$s_exp()+" "+this.rhs.$s_exp()+")"}),ae.$private(),v(ae,"$calc",function(de,Fe,xe){return de.$send(this.op,Fe).$to_i()}),v(ae,"$op_for_s_exp",re("op"))}(_[0]),function($,se,ae){var Te=te($,se,"DivideBase"),Ae=[Te].concat(ae),de=f.$r(Ae);Te.$$prototype.op=H,v(Te,"$initialize",function xe(ke,De){return xe.$$p=null,q(this,E(this,"initialize",xe,!1,!0),"initialize",[ke,"/",De],null)}),v(Te,"$expr",function xe(ke){return xe.$$p=null,""+q(this,E(this,"expr",xe,!1,!0),"expr",[ke],null)+this.$rounding_method()}),v(Te,"$output",function xe(){var ke=xe.$$p||H;return xe.$$p=null,""+q(this,E(this,"output",xe,!1,!0),"output",[],ke)+this.$rounding_method()}),Te.$private(),v(Te,"$rounding_method",function(){return A(this.$class(),"ROUNDING_METHOD")}),v(Te,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),v(Te,"$calc",function(ke,De,Me){return I(De["$zero?"]())?1:this.$divide_and_round(ke,De,Me).$to_i()}),v(Te,"$divide_and_round",function(ke,De,Me){return this.$raise(de("NotImplementedError"))})}(_[0],x("BinaryOp"),_),function($,se,ae){var Te=te($,se,"DivideWithGameSystemDefault"),Ae=[Te].concat(ae),de=f.$r(Ae);V(Ae[0],"ROUNDING_METHOD",""),Te.$private(),v(Te,"$divide_and_round",function(xe,ke,De){var Me,_e=H;return le(A(de("RoundType"),"CEIL"),Me=De)?Z(xe.$to_f(),ke).$ceil():le(A(de("RoundType"),"ROUND"),Me)?(_e=Z(xe.$to_f(),ke),I(_e["$negative?"]())?_e.$abs().$round()["$-@"]():_e.$round()):Z(xe,ke).$floor()})}(_[0],x("DivideBase"),_),function($,se,ae){var Te=te($,se,"DivideWithRoundingUp"),Ae=[Te].concat(ae);V(Ae[0],"ROUNDING_METHOD","U"),Te.$private(),v(Te,"$divide_and_round",function(Fe,xe,ke){return Z(Fe.$to_f(),xe).$ceil()})}(_[0],x("DivideBase"),_),function($,se,ae){var Te=te($,se,"DivideWithRoundingOff"),Ae=[Te].concat(ae);V(Ae[0],"ROUNDING_METHOD","R"),Te.$private(),v(Te,"$divide_and_round",function(Fe,xe,ke){var De=H;return De=Z(Fe.$to_f(),xe),I(De["$negative?"]())?De.$abs().$round()["$-@"]():De.$round()})}(_[0],x("DivideBase"),_),function($,se,ae){var Te=te($,se,"DivideWithRoundingDown"),Ae=[Te].concat(ae);V(Ae[0],"ROUNDING_METHOD","F"),Te.$private(),v(Te,"$divide_and_round",function(Fe,xe,ke){return Z(Fe,xe).$floor()})}(_[0],x("DivideBase"),_),function($,se){var ae=te($,null,"Negate");ae.$$prototype.body=H,ae.$attr_reader("body"),v(ae,"$initialize",Y("body")),v(ae,"$eval",function(de,Fe){try{return z("eval_return"),this.body.$eval(de,Fe).$to_i()["$-@"]()}catch(De){if(De===f.t_eval_return)return De.$v;throw De}}),v(ae,"$include_dice?",function(){return this.body["$include_dice?"]()}),v(ae,"$expr",function(de){return"-"+this.body.$expr(de)}),v(ae,"$output",function(){return"-"+this.body.$output()}),v(ae,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(_[0]),function($,se){var ae=te($,null,"DiceRoll"),Te=ae.$$prototype;Te.times=Te.sides=H,v(ae,"$initialize",function(de,Fe){return this.times=de,this.sides=Fe,this.text=H}),v(ae,"$eval",function(de,Fe){try{z("eval_return");var De,Me,_e=H,ce=H;return De=this.times.$eval(de,H),Me=this.$eval_sides(de),ce=(_e=Fe.$roll(De,Me)).$sum(),this.text=ce+"["+_e.$join(",")+"]",ce.$to_i()}catch(pe){if(pe===f.t_eval_return)return pe.$v;throw pe}}),v(ae,"$include_dice?",N(!0)),v(ae,"$expr",function(de){try{return z("eval_return"),this.times.$eval(de,H)+"D"+this.$eval_sides(de)}catch(Me){if(Me===f.t_eval_return)return Me.$v;throw Me}}),v(ae,"$output",re("text")),v(ae,"$s_exp",function(){return"(DiceRoll "+this.times.$s_exp()+" "+this.sides.$s_exp()+")"}),ae.$private(),v(ae,"$eval_sides",function(de){try{return z("eval_return"),this.sides.$eval(de,H)}catch(ke){if(ke===f.t_eval_return)return ke.$v;throw ke}})}(_[0]),function($,se){var ae=te($,se,"ImplicitSidesDiceRoll");ae.$$prototype.times=H,v(ae,"$initialize",function(de){return this.times=de,this.text=H}),v(ae,"$s_exp",function(){return"(ImplicitSidesDiceRoll "+this.times.$s_exp()+")"}),ae.$private(),v(ae,"$eval_sides",function(de){return de.$sides_implicit_d()})}(_[0],x("DiceRoll")),function($,se,ae){var Te=te($,null,"DiceRollWithFilter"),Ae=[Te].concat(ae),de=f.$r(Ae),Fe=Te.$$prototype;Fe.times=Fe.n_filtering=Fe.filter=Fe.sides=H,V(Ae[0],"Filter",de("Struct").$new("abbr","apply")),V(Ae[0],"KEEP_HIGHEST",de("Filter").$new("KH",U(Te,"lambda",[],function(ke,De){return null==ke&&(ke=H),null==De&&(De=H),ke.$reverse().$take(De)})).$freeze()),V(Ae[0],"KEEP_LOWEST",de("Filter").$new("KL",U(Te,"lambda",[],function(ke,De){return null==ke&&(ke=H),null==De&&(De=H),ke.$take(De)})).$freeze()),V(Ae[0],"DROP_HIGHEST",de("Filter").$new("DH",U(Te,"lambda",[],function(ke,De){return null==ke&&(ke=H),null==De&&(De=H),ke.$reverse().$drop(De)})).$freeze()),V(Ae[0],"DROP_LOWEST",de("Filter").$new("DL",U(Te,"lambda",[],function(ke,De){return null==ke&&(ke=H),null==De&&(De=H),ke.$drop(De)})).$freeze()),v(Te,"$initialize",function(ke,De,Me,_e){var ce=this;return k(De,"implicit")&&X(De["$respond_to?"]("eval"))&&ce.$raise(de("TypeError"),"sides must be a Node or :implicit ("+De.$inspect()+")"),ce.times=ke,ce.sides=De,ce.n_filtering=Me,ce.filter=_e,ce.text=H}),v(Te,"$eval",function(ke,De){try{z("eval_return");var ce,pe,ye,_e=this,b=H,K=H;return ce=_e.times.$eval(ke,H),pe=_e.$eval_sides(ke),ye=_e.n_filtering.$eval(ke,H),b=De.$roll(ce,pe).$sort(),K=_e.filter.$apply()["$[]"](b,ye).$sum(),_e.text=K+"["+b.$join(",")+"]",K.$to_i()}catch(ge){if(ge===f.t_eval_return)return ge.$v;throw ge}}),v(Te,"$include_dice?",N(!0)),v(Te,"$implicit_sides?",function(){return this.sides["$=="]("implicit")}),v(Te,"$expr",function(ke){try{var _e,ce,pe;return z("eval_return"),_e=this.times.$eval(ke,H),ce=this.$eval_sides(ke),pe=this.n_filtering.$eval(ke,H),_e+"D"+ce+this.filter.$abbr()+pe}catch(ye){if(ye===f.t_eval_return)return ye.$v;throw ye}}),v(Te,"$output",re("text")),v(Te,"$s_exp",function(){var De,ke=this;return De=I(ke["$implicit_sides?"]())?ke.sides.$inspect():ke.sides.$s_exp(),"(DiceRollWithFilter "+ke.times.$s_exp()+" "+De+" "+ke.filter.$abbr().$inspect()+" "+ke.n_filtering.$s_exp()+")"}),Te.$private(),v(Te,"$eval_sides",function(ke){try{return z("eval_return"),I(this["$implicit_sides?"]())?ke.$sides_implicit_d():this.sides.$eval(ke,H)}catch(_e){if(_e===f.t_eval_return)return _e.$v;throw _e}})}(_[0],0,_),function($,se){var ae=te($,null,"Parenthesis");ae.$$prototype.expr=H,v(ae,"$initialize",Y("expr")),v(ae,"$eval",function(de,Fe){try{return z("eval_return"),this.expr.$eval(de,Fe).$to_i()}catch(De){if(De===f.t_eval_return)return De.$v;throw De}}),v(ae,"$include_dice?",function(){return this.expr["$include_dice?"]()}),v(ae,"$expr",function(de){return"("+this.expr.$expr(de)+")"}),v(ae,"$output",function(){return"("+this.expr.$output()+")"}),v(ae,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(_[0]),function($,se,ae){var Te=te($,null,"Number"),Ae=[Te].concat(ae),de=f.$r(Ae);return Te.$$prototype.literal=H,Te.$attr_reader("literal"),v(Te,"$initialize",function(ke){return this.literal=ke.$to_i()}),v(Te,"$negate",function(){return de("Number").$new(this.literal["$-@"]())}),v(Te,"$eval",function(ke,De){return this.literal.$to_i()}),v(Te,"$include_dice?",N(!1)),v(Te,"$expr",function(ke){return this.literal.$to_s()}),v(Te,"$output",function(){return this.literal.$to_s()}),G(Te,"s_exp","output")}(_[0],0,_)},Opal.modules["bcdice/common_command/add_dice/parser"]=function(f){var k,A,L,m,_,x,$,se,ae,Te,Ae,de,Fe,De,l,d,p,F,he,C,ee,S=f.module,te=f.klass,v=f.defs,D=f.def,z=f.truthy,I=f.eqeq,Q=f.hash,U=f.const_set,N=f.to_ary,G=f.not,re=f.return_val,q=f.neqeq,E=f.hash2,V=f.top,le=[],Z=f.nil,Y=f.$$$;return V.$require("racc/parser.rb"),V.$require("bcdice/common_command/lexer"),V.$require("bcdice/common_command/add_dice/node"),k=le,A=ee=[S(le[0],"BCDice")].concat(k),L=C=[S(ee[0],"CommonCommand")].concat(A),F=[S(C[0],"AddDice")].concat(L),he=f.$r(F),m=F,d=[l=te(F[0],Y(he("Racc"),"Parser"),"Parser")].concat(m),p=f.$r(d),l.$$prototype.lexer=Z,v(l,"$parse",function(ye){return this.$new().$parse(ye)}),D(l,"$parse",function(ye){try{return this.lexer=p("Lexer").$new(ye),this.$do_parse()}catch(K){if(!f.rescue(K,[p("ParseError")]))throw K;try{return Z}finally{f.pop_exception()}}}),l.$private(),D(l,"$next_token",function(){return this.lexer.$next_token()}),D(l,"$expand_negate",function(ye,b){if(z(b["$is_a?"](Y(p("Node"),"Negate")))){if(I(ye,"+"))return["-",b.$body()];if(I(ye,"-"))return["+",b.$body()]}return[ye,b]}),_=f.large_array_unpack("14,14,50,12,51,19,20,14,14,14,12,3,12,17,18,14,8,9,12,4,13,13,28,8,9,8,9,13,13,13,14,8,9,12,15,13,14,23,14,12,56,12,19,20,57,14,8,9,12,,13,,8,9,8,9,13,14,13,,12,8,9,14,16,13,-27,-27,19,20,-27,17,18,8,9,,42,13,,17,18,40,39,13,,38,-28,-28,40,39,-28,,38,45,47,44,46,52,53,54,55"),x=f.large_array_unpack("16,12,38,16,38,6,6,2,36,8,2,0,8,27,27,9,16,16,9,1,16,12,16,2,2,8,8,2,36,8,13,9,9,13,4,9,17,11,18,17,50,18,29,29,51,19,13,13,19,,13,,17,17,18,18,17,20,18,,20,19,19,23,5,19,23,23,30,30,23,25,25,20,20,,25,20,,5,5,24,24,23,,24,33,33,34,34,33,,34,32,32,32,32,39,39,40,40"),$=f.large_array_unpack("7,19,5,,34,61,-15,,7,13,,32,-1,28,,,-2,34,36,43,55,,,61,76,53,,-5,,22,48,,79,81,83,,6,,-8,90,92,,,,,,,,,,29,31,,,,,,"),se=f.large_array_unpack("-3,-41,-41,-4,-41,-1,-9,-12,-41,-41,-20,-26,-41,-41,-40,58,-41,-41,-41,-41,-41,-18,-19,-22,-24,-41,-2,-5,-6,-7,-8,-10,-13,-21,-41,-25,-37,-30,-41,-41,-41,-38,-39,-11,-14,-15,-16,-17,-23,-29,-41,-41,-33,-34,-35,-36,-31,-32"),ae=[24,5,21,22,29,30,35,1,2,26,43,33,25,31,32,27,48,34,Z,Z,Z,Z,Z,Z,49],Te=[9,3,6,6,5,5,11,1,2,4,7,9,3,6,6,3,11,10,Z,Z,Z,Z,Z,Z,9],Ae=[Z,7,8,-1,-7,-13,-6,-22,Z,-12,-6,-18,Z,Z,Z],de=[Z,Z,Z,Z,Z,6,7,Z,10,11,Z,Z,36,37,41],Fe=f.large_array_unpack("0,0,racc_error,2,26,_reduce_1,4,26,_reduce_2,0,27,_reduce_3,1,27,_reduce_4,1,29,_reduce_none,1,29,_reduce_6,3,28,_reduce_7,3,28,_reduce_8,1,28,_reduce_none,3,30,_reduce_10,4,30,_reduce_11,1,30,_reduce_none,0,32,_reduce_13,1,32,_reduce_14,1,32,_reduce_15,1,32,_reduce_16,1,32,_reduce_17,2,31,_reduce_18,2,31,_reduce_19,1,31,_reduce_none,3,33,_reduce_21,2,33,_reduce_22,4,33,_reduce_23,2,33,_reduce_24,3,33,_reduce_25,1,33,_reduce_none,0,35,_reduce_27,1,35,_reduce_28,2,36,_reduce_29,1,36,_reduce_30,3,39,_reduce_31,3,39,_reduce_32,2,37,_reduce_33,2,37,_reduce_34,2,37,_reduce_35,2,37,_reduce_36,1,38,_reduce_none,1,38,_reduce_none,3,34,_reduce_39,1,34,_reduce_40"),De=Q(!1,0,"error",1,"NUMBER",2,"CMP_OP",3,"S",4,"D",5,"K",6,"H",7,"L",8,"M",9,"A",10,"X",11,"I",12,"N",13,"U",14,"R",15,"F",16,"C",17,"PLUS",18,"MINUS",19,"ASTERISK",20,"SLASH",21,"PARENL",22,"PARENR",23,"QUESTION",24),U(d[0],"Racc_arg",[_,x,se,$,ae,Te,de,Ae,25,Fe,De,58,41,!0]),z(p("Ractor","skip_raise")?"constant":Z)&&p("Ractor").$make_shareable(p("Racc_arg")),U(d[0],"Racc_token_to_s_table",f.large_array_unpack("$end,error,NUMBER,CMP_OP,S,D,K,H,L,M,A,X,I,N,U,R,F,C,PLUS,MINUS,ASTERISK,SLASH,PARENL,PARENR,QUESTION,$start,command,secret,add,target,mul,unary,round_type,dice,term,explicit_or_implicit_sides,filter,filter_type,filter_type_with_shorthand,filter_shorthand")),z(p("Ractor","skip_raise")?"constant":Z)&&p("Ractor").$make_shareable(p("Racc_token_to_s_table")),U(d[0],"Racc_debug_parser",!1),D(l,"$_reduce_1",function(ye,b,K){var ge,Ue,Ye=Z;return Ue=null==(ge=N(ye))[0]?Z:ge[0],z((Ye=null==ge[1]?Z:ge[1])["$include_dice?"]())||this.$raise(p("ParseError")),Y(p("Node"),"Command").$new(Ue,Ye)}),D(l,"$_reduce_2",function(ye,b,K){var ge,Ue,Ye=Z,nt=Z,vt=Z;return Ue=null==(ge=N(ye))[0]?Z:ge[0],nt=null==ge[2]?Z:ge[2],vt=null==ge[3]?Z:ge[3],(G((Ye=null==ge[1]?Z:ge[1])["$include_dice?"]())||z(vt["$include_dice?"]())||z(nt["$nil?"]()))&&this.$raise(p("ParseError")),Y(p("Node"),"Command").$new(Ue,Ye,nt,vt)}),D(l,"$_reduce_3",re(!1)),D(l,"$_reduce_4",re(!0)),D(l,"$_reduce_6",function(ye,b,K){return Y(p("Node"),"UndecidedTarget").$instance()}),D(l,"$_reduce_7",function(ye,b,K){var ge,be,Ue,Ye,nt;return Ue=ye["$[]"](0),be=this.$expand_negate("+",ye["$[]"](2)),Ye=null==(ge=N(be))[0]?Z:ge[0],nt=null==ge[1]?Z:ge[1],Y(p("Node"),"BinaryOp").$new(Ue,Ye,nt)}),D(l,"$_reduce_8",function(ye,b,K){var ge,be,Ue,Ye,nt;return Ue=ye["$[]"](0),be=this.$expand_negate("-",ye["$[]"](2)),Ye=null==(ge=N(be))[0]?Z:ge[0],nt=null==ge[1]?Z:ge[1],Y(p("Node"),"BinaryOp").$new(Ue,Ye,nt)}),D(l,"$_reduce_10",function(ye,b,K){var ge,be;return ge=ye["$[]"](0),be=ye["$[]"](2),Y(p("Node"),"BinaryOp").$new(ge,"*",be)}),D(l,"$_reduce_11",function(ye,b,K){var ge,be;return ge=ye["$[]"](0),be=ye["$[]"](2),ye["$[]"](3).$new(ge,be)}),D(l,"$_reduce_13",function(ye,b,K){return Y(p("Node"),"DivideWithGameSystemDefault")}),D(l,"$_reduce_14",function(ye,b,K){return Y(p("Node"),"DivideWithRoundingDown")}),D(l,"$_reduce_15",function(ye,b,K){return Y(p("Node"),"DivideWithRoundingUp")}),D(l,"$_reduce_16",function(ye,b,K){return Y(p("Node"),"DivideWithRoundingUp")}),D(l,"$_reduce_17",function(ye,b,K){return Y(p("Node"),"DivideWithRoundingOff")}),D(l,"$_reduce_18",function(ye,b,K){return ye["$[]"](1)}),D(l,"$_reduce_19",function(ye,b,K){var ge=Z;return ge=ye["$[]"](1),z(ge["$is_a?"](Y(p("Node"),"Negate")))?ge.$body():Y(p("Node"),"Negate").$new(ge)}),D(l,"$_reduce_21",function(ye,b,K){var be=Z,Pe=Z;return be=ye["$[]"](0),Pe=ye["$[]"](2),(z(be["$include_dice?"]())||z(Pe["$include_dice?"]()))&&this.$raise(p("ParseError")),Y(p("Node"),"DiceRoll").$new(be,Pe)}),D(l,"$_reduce_22",function(ye,b,K){var be=Z;return be=ye["$[]"](0),z(be["$include_dice?"]())&&this.$raise(p("ParseError")),Y(p("Node"),"ImplicitSidesDiceRoll").$new(be)}),D(l,"$_reduce_23",function(ye,b,K){var Ue,be=Z,Pe=Z,Ye=Z;return be=ye["$[]"](0),Pe=ye["$[]"](2),Ue=ye["$[]"](3)["$[]"]("filter"),Ye=ye["$[]"](3)["$[]"]("n_filtering"),q(Pe,"implicit")&&z(Pe["$include_dice?"]())&&this.$raise(p("ParseError")),(z(be["$include_dice?"]())||z(Ye["$include_dice?"]()))&&this.$raise(p("ParseError")),Y(p("Node"),"DiceRollWithFilter").$new(be,Pe,Ye,Ue)}),D(l,"$_reduce_24",function(ye,b,K){var be,Pe=Z;return be=Y(p("Node"),"Number").$new(1),Pe=ye["$[]"](1),z(Pe["$include_dice?"]())&&this.$raise(p("ParseError")),z(Pe["$instance_of?"](Y(p("Node"),"Number")))&&I(Pe.$literal(),66)&&this.$raise(p("ParseError")),Y(p("Node"),"DiceRoll").$new(be,Pe)}),D(l,"$_reduce_25",function(ye,b,K){var be,Ue,Pe=Z,Ye=Z;return be=Y(p("Node"),"Number").$new(1),Pe=ye["$[]"](1),Ue=ye["$[]"](2)["$[]"]("filter"),Ye=ye["$[]"](2)["$[]"]("n_filtering"),q(Pe,"implicit")&&z(Pe["$include_dice?"]())&&this.$raise(p("ParseError")),z(Ye["$include_dice?"]())&&this.$raise(p("ParseError")),z(Pe["$instance_of?"](Y(p("Node"),"Number")))&&I(Pe.$literal(),66)&&this.$raise(p("ParseError")),Y(p("Node"),"DiceRollWithFilter").$new(be,Pe,Ye,Ue)}),D(l,"$_reduce_27",re("implicit")),D(l,"$_reduce_28",function(ye,b,K){return ye["$[]"](0)}),D(l,"$_reduce_29",function(ye,b,K){return E(["filter","n_filtering"],{filter:ye["$[]"](0),n_filtering:ye["$[]"](1)})}),D(l,"$_reduce_30",function(ye,b,K){return E(["filter","n_filtering"],{filter:ye["$[]"](0),n_filtering:Y(p("Node"),"Number").$new(1)})}),D(l,"$_reduce_31",function(ye,b,K){return Y(Y(p("Node"),"DiceRollWithFilter"),"KEEP_HIGHEST")}),D(l,"$_reduce_32",function(ye,b,K){return Y(Y(p("Node"),"DiceRollWithFilter"),"KEEP_LOWEST")}),D(l,"$_reduce_33",function(ye,b,K){return Y(Y(p("Node"),"DiceRollWithFilter"),"KEEP_HIGHEST")}),D(l,"$_reduce_34",function(ye,b,K){return Y(Y(p("Node"),"DiceRollWithFilter"),"KEEP_LOWEST")}),D(l,"$_reduce_35",function(ye,b,K){return Y(Y(p("Node"),"DiceRollWithFilter"),"DROP_HIGHEST")}),D(l,"$_reduce_36",function(ye,b,K){return Y(Y(p("Node"),"DiceRollWithFilter"),"DROP_LOWEST")}),D(l,"$_reduce_39",function(ye,b,K){return Y(p("Node"),"Parenthesis").$new(ye["$[]"](1))}),D(l,"$_reduce_40",function(ye,b,K){return Y(p("Node"),"Number").$new(ye["$[]"](0))}),D(l,"$_reduce_none",function(ye,b,K){return ye["$[]"](0)})},Opal.modules["bcdice/common_command/add_dice/randomizer"]=function(f){var re,le,k,M,C,P,L,ne,ee,Y,E,S=f.module,te=f.klass,v=f.const_set,D=f.def,z=f.eqeq,I=f.send,Q=f.truthy,U=[],N=f.nil;return re=U,le=E=[S(U[0],"BCDice")].concat(re),k=Y=[S(E[0],"CommonCommand")].concat(le),M=ee=[S(Y[0],"AddDice")].concat(k),P=[C=te(ee[0],null,"Randomizer")].concat(M),L=f.$r(P),(ne=C.$$prototype).game_system=ne.rand_source=ne.rand_results=N,C.$attr_reader("rand_results"),v(P[0],"RandResult",L("Struct").$new("sides","value")),D(C,"$initialize",function(he,B){var O=this;return O.rand_source=he,O.game_system=B,O.rand_results=[]}),D(C,"$roll",function(he,B){var l,O=this,m=N;return m=z(B,66)?I(L("Array"),"new",[he],function c(){var h=null==c.$$s?this:c.$$s;return null==h.rand_source&&(h.rand_source=N),null==h.game_system&&(h.game_system=N),h.rand_source.$roll_d66(h.game_system.$d66_sort_type())},{$$s:O}):z(B,9)&&Q(O.game_system["$enabled_d9?"]())?I(L("Array"),"new",[he],function c(){var h=null==c.$$s?this:c.$$s;return null==h.rand_source&&(h.rand_source=N),h.rand_source.$roll_d9()},{$$s:O}):O.rand_source.$roll_barabara(he,B),Q(O.game_system["$sort_add_dice?"]())&&m["$sort!"](),l=I(m,"map",[],function(h){return null==h&&(h=N),L("RandResult").$new(B,h)}),O.rand_results.$concat(l),m})},Opal.modules["bcdice/common_command/add_dice"]=function(f){var N,E,Y,R,H,A,X,k,le,re,S=f.module,te=f.const_set,v=f.thrower,D=f.def,z=f.top,I=[],Q=f.nil;return z.$require("bcdice/normalize"),z.$require("bcdice/common_command/add_dice/parser"),z.$require("bcdice/common_command/add_dice/randomizer"),N=I,E=re=[S(I[0],"BCDice")].concat(N),Y=le=[S(re[0],"CommonCommand")].concat(E),te((k=[X=S(le[0],"AddDice")].concat(Y))[0],"PREFIX_PATTERN",/[+\-(]*(\d+|D\d+)/.$freeze()),H=[R=f.get_singleton_class(X)].concat(k),A=f.$r(H),D(R,"$eval",function(C,P,L){try{var F;return v("eval_return"),(F=A("Parser").$parse(C))===Q||null==F?Q:F.$eval(P,L)}catch(B){if(B===f.t_eval_return)return B.$v;throw B}})},Opal.modules["bcdice/common_command/reroll_dice/node"]=function(f){var X,H,P,he,c,h,d,p,_,O,ne,M,R,S=f.module,te=f.klass,v=f.ensure_kwargs,D=f.get_kwarg,z=f.def,I=f.truthy,Q=f.send,U=f.thrower,N=f.rb_lt,G=f.rb_plus,re=f.rb_gt,q=f.eqeq,E=f.rb_le,V=f.rb_ge,le=[],Z=f.nil;return X=le,H=R=[S(le[0],"BCDice")].concat(X),P=M=[S(R[0],"CommonCommand")].concat(H),he=ne=[S(M[0],"RerollDice")].concat(P),c=O=[S(ne[0],"Node")].concat(he),d=[h=te(O[0],null,"Command")].concat(c),p=f.$r(d),(_=h.$$prototype).cmp_op=_.reroll_cmp_op=_.target_number_node=_.reroll_threshold_node=_.notations=_.source=Z,z(h,"$initialize",function($){var se,ae,Te,Ae,de,Fe,xe,ke=this;return $=v($),se=D($,"secret"),ae=D($,"notations"),Te=D($,"source"),null==(Ae=$.$$smap.cmp_op)&&(Ae=Z),null==(de=$.$$smap.target_number)&&(de=Z),null==(Fe=$.$$smap.reroll_cmp_op)&&(Fe=Z),null==(xe=$.$$smap.reroll_threshold)&&(xe=Z),ke.secret=se,ke.notations=ae,ke.cmp_op=Ae,ke.target_number_node=de,ke.reroll_cmp_op=Fe,ke.reroll_threshold_node=xe,ke.source=Te}),z(h,"$eval",function($,se){try{U("eval_return");var Te,Ae,Fe,xe,De,_e,ce,ye,de=this,ke=Z,Me=Z,pe=Z,b=Z,K=Z,ge=Z,be=Z,Pe=Z;return Fe=$.$round_type(),xe=I(ke=de.cmp_op)?ke:$.$default_cmp_op(),De=I(ke=I(Me=de.reroll_cmp_op)?Me:xe)?ke:">=",_e=I(ke=(Te=de.target_number_node)===Z||null==Te?Z:Te.$eval(Fe))?ke:$.$default_target_number(),ce=I(ke=I(Me=(Ae=de.reroll_threshold_node)===Z||null==Ae?Z:Ae.$eval(Fe))?Me:$.$reroll_dice_reroll_threshold())?ke:_e,pe=p("RerollCondition").$new(De,ce),ye=Q(de.notations,"map",[],function(Ye){return null==Ye&&(Ye=Z),Ye.$to_dice(Fe)}),I(Q(ye,"all?",[],function(Ye){return null==Ye&&(Ye=Z),pe["$valid?"](Ye.$sides())}))?(K=(b=de.$roll(ye,se,pe,$["$sort_barabara_dice?"]())).$flatten(),ge=b.$take(de.notations.$size()).$flatten().$count(1),be=I(xe)?Q(K,"count",[],function(Ye){return null==Ye&&(Ye=Z),Ye.$send(xe,_e)}):0,Pe=[de.$expr(Fe,pe,xe,_e),Q(b,"map",[],function(Ye){return null==Ye&&(Ye=Z),Ye.$join(",")}).$join(" + "),"\u6210\u529f\u6570"+be,$.$grich_text(ge,K.$size(),be)].$compact(),de.$result_with_text(Pe.$join(" \uff1e "))):de.$result_with_text(de.source+" \uff1e \u6761\u4ef6\u304c\u9593\u9055\u3063\u3066\u3044\u307e\u3059\u30022R6>=5 \u3042\u308b\u3044\u306f 2R6[5] \u306e\u3088\u3046\u306b\u632f\u308a\u8db3\u3057\u76ee\u6a19\u5024\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002")}catch(Ue){if(Ue===f.t_eval_return)return Ue.$v;throw Ue}}),h.$private(),z(h,"$roll",function($,se,ae,Te){var Ae=Z,de=Z,Fe=Z,xe=Z,ke=Z,De=Z;for(Ae=[],de=0;I(I(Fe=$["$empty?"]()["$!"]())?N(de,p("REROLL_LIMIT")):Fe);)xe=$.$shift(),de=G(de,1),ke=xe.$roll(se),I(Te)&&ke["$sort!"](),Ae.$push(ke),De=Q(ke,"count",[],function(_e){return null==_e&&(_e=Z),ae["$reroll?"](_e)}),I(re(De,0))&&$.$push(p("Dice").$new(De,xe.$sides()));return Ae}),z(h,"$expr",function($,se,ae,Te){var de,Fe,xe;return de=Q(this.notations,"map",[],function(De){return null==De&&(De=Z),De.$to_dice($)}).$join("+"),Fe=q(se.$cmp_op(),ae)?"":p("Format").$comparison_operator(se.$cmp_op()),xe=p("Format").$comparison_operator(ae),"("+de+"["+Fe+se.$threshold()+"]"+xe+Te+")"}),z(h,"$result_with_text",function($){return Q(p("Result").$new(),"tap",[],function ae(Te){var Ae,de=null==ae.$$s?this:ae.$$s;return null==de.secret&&(de.secret=Z),null==Te&&(Te=Z),Te["$secret="](de.secret),Q(Te,"text=",Ae=[$]),Ae[Ae.length-1]},{$$s:this})}),function(m,l){var c=te(m,null,"RerollCondition"),h=c.$$prototype;h.threshold=h.cmp_op=Z,c.$attr_reader("cmp_op"),c.$attr_reader("threshold"),z(c,"$initialize",function(p,_){return this.cmp_op=p,this.threshold=_}),z(c,"$valid?",function(p){var _=this;if(!I(_.threshold))return!1;switch(_.cmp_op.valueOf()){case"<=":return N(_.threshold,p);case"<":return E(_.threshold,p);case">=":return re(_.threshold,1);case">":return V(_.threshold,1);case"!=":return f.Range.$new(1,p,!1)["$include?"](_.threshold);default:return!0}}),z(c,"$reroll?",function(p){return p.$send(this.cmp_op,this.threshold)})}(O[0]),function(m,l,c){var h=te(m,null,"Notation"),d=[h].concat(c),p=f.$r(d),_=h.$$prototype;_.times=_.sides=Z,z(h,"$initialize",function($,se){return this.times=$,this.sides=se}),z(h,"$to_dice",function($){try{var Te,Ae;return U("eval_return"),Te=this.times.$eval($),Ae=this.sides.$eval($),p("Dice").$new(Te,Ae)}catch(de){if(de===f.t_eval_return)return de.$v;throw de}})}(O[0],0,O),function(m,l){var c=te(m,null,"Dice");return c.$attr_reader("times","sides"),z(c,"$initialize",function(d,p){return this.times=d,this.sides=p}),z(c,"$roll",function(d){return d.$roll_barabara(this.$times(),this.$sides())}),z(c,"$to_s",function(){return this.$times()+"R"+this.$sides()})}(O[0])},Opal.modules["bcdice/arithmetic/node"]=function(f){var k,A,L,m,l,F,he,C,ee,S=f.module,te=f.klass,v=f.def,D=f.thrower,z=f.return_ivar,I=f.send2,Q=f.find_super,U=f.eqeq,N=f.const_set,G=f.eqeqeq,re=f.rb_divide,q=f.truthy,E=f.assign_ivar,V=f.alias,le=[],Z=f.nil,Y=f.$$$;return k=le,A=ee=[S(le[0],"BCDice")].concat(k),L=C=[S(ee[0],"Arithmetic")].concat(A),F=[S(C[0],"Node")].concat(L),he=f.$r(F),(l=(m=te(F[0],null,"BinaryOp")).$$prototype).lhs=l.rhs=l.op=Z,v(m,"$initialize",function(h,d,p){var _=this;return _.lhs=h,_.op=d,_.rhs=p}),v(m,"$eval",function(h){try{D("eval_return");var x,p=this,_=Z;return _=p.lhs.$eval(h),x=p.rhs.$eval(h),_.$send(p.op,x)}catch($){if($===f.t_eval_return)return $.$v;throw $}}),v(m,"$output",function(){var h=this;return""+h.lhs.$output()+h.op+h.rhs.$output()}),v(m,"$s_exp",function(){var h=this;return"("+h.$op_for_s_exp()+" "+h.lhs.$s_exp()+" "+h.rhs.$s_exp()+")"}),v(m,"$op_for_s_exp",z("op")),function(B,O,m){var l=te(B,O,"DivideBase"),c=[l].concat(m),h=f.$r(c),d=l.$$prototype;d.lhs=d.rhs=d.op=Z,v(l,"$initialize",function p(_,x){return p.$$p=null,I(this,Q(this,"initialize",p,!1,!0),"initialize",[_,"/",x],null)}),v(l,"$eval",function(_){try{D("eval_return");var se,ae,$=this;return se=$.lhs.$eval(_),ae=$.rhs.$eval(_),U(ae,0)&&$.$raise(h("ZeroDivisionError")),$.$divide_and_round(se,ae,_)}catch(Te){if(Te===f.t_eval_return)return Te.$v;throw Te}}),v(l,"$output",function p(){var _=p.$$p||Z,x=this;return p.$$p=null,""+I(x,Q(x,"output",p,!1,!0),"output",[],_)+x.$rounding_method()}),l.$private(),v(l,"$rounding_method",function(){return Y(this.$class(),"ROUNDING_METHOD")}),v(l,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),v(l,"$divide_and_round",function(_,x,$){return this.$raise(h("NotImplementedError"))})}(F[0],he("BinaryOp"),F),function(B,O,m){var l=te(B,O,"DivideWithGameSystemDefault"),c=[l].concat(m),h=f.$r(c);N(c[0],"ROUNDING_METHOD",""),l.$private(),v(l,"$divide_and_round",function(p,_,x){var $,se=Z;return G(Y(h("RoundType"),"CEIL"),$=x)?re(p.$to_f(),_).$ceil():G(Y(h("RoundType"),"ROUND"),$)?(se=re(p.$to_f(),_),q(se["$negative?"]())?se.$abs().$round()["$-@"]():se.$round()):re(p,_).$floor()})}(F[0],he("DivideBase"),F),function(B,O,m){var l=te(B,O,"DivideWithCeil"),c=[l].concat(m);N(c[0],"ROUNDING_METHOD","C"),l.$private(),v(l,"$divide_and_round",function(d,p,_){return re(d.$to_f(),p).$ceil()})}(F[0],he("DivideBase"),F),function(B,O,m){var l=te(B,O,"DivideWithRound"),c=[l].concat(m);N(c[0],"ROUNDING_METHOD","R"),l.$private(),v(l,"$divide_and_round",function(d,p,_){var x=Z;return x=re(d.$to_f(),p),q(x["$negative?"]())?x.$abs().$round()["$-@"]():x.$round()})}(F[0],he("DivideBase"),F),function(B,O,m){var l=te(B,O,"DivideWithFloor"),c=[l].concat(m);N(c[0],"ROUNDING_METHOD","F"),l.$private(),v(l,"$divide_and_round",function(d,p,_){return re(d,p).$floor()})}(F[0],he("DivideBase"),F),function(B,O){var m=te(B,null,"Negative");m.$$prototype.body=Z,v(m,"$initialize",E("body")),v(m,"$eval",function(h){try{return D("eval_return"),this.body.$eval(h)["$-@"]()}catch(_){if(_===f.t_eval_return)return _.$v;throw _}}),v(m,"$output",function(){return"-"+this.body.$output()}),v(m,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(F[0]),function(B,O){var m=te(B,null,"Parenthesis");m.$$prototype.expr=Z,v(m,"$initialize",E("expr")),v(m,"$eval",function(h){try{return D("eval_return"),this.expr.$eval(h)}catch(_){if(_===f.t_eval_return)return _.$v;throw _}}),v(m,"$output",function(){return"("+this.expr.$output()+")"}),v(m,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(F[0]),function(B,O){var m=te(B,null,"Number");return m.$$prototype.value=Z,v(m,"$initialize",E("value")),v(m,"$eval",z("value")),v(m,"$output",function(){return this.value.$to_s()}),V(m,"s_exp","output")}(F[0])},Opal.modules["bcdice/common_command/barabara_dice/parser"]=function(f){var Z,R,M,he,h,d,p,_,x,$,se,ae,Te,Fe,B,l,c,P,L,H,X,S=f.module,te=f.klass,v=f.defs,D=f.def,z=f.hash,I=f.const_set,Q=f.truthy,U=f.hash2,N=f.return_val,G=f.to_ary,re=f.top,q=[],E=f.nil,V=f.$$$;return re.$require("racc/parser.rb"),re.$require("bcdice/common_command/lexer"),re.$require("bcdice/common_command/reroll_dice/node"),re.$require("bcdice/arithmetic/node"),Z=q,R=X=[S(q[0],"BCDice")].concat(Z),M=H=[S(X[0],"CommonCommand")].concat(R),P=[S(H[0],"BarabaraDice")].concat(M),L=f.$r(P),he=P,l=[B=te(P[0],V(L("Racc"),"Parser"),"Parser")].concat(he),c=f.$r(l),B.$$prototype.lexer=E,v(B,"$parse",function(_e){return this.$new().$parse(_e)}),D(B,"$parse",function(_e){try{return this.lexer=c("Lexer").$new(_e),this.$do_parse()}catch(pe){if(!f.rescue(pe,[c("ParseError")]))throw pe;try{return E}finally{f.pop_exception()}}}),B.$private(),D(B,"$next_token",function(){return this.lexer.$next_token()}),h=f.large_array_unpack("13,9,3,9,24,25,9,9,9,26,18,19,8,12,8,18,19,8,8,8,9,4,9,38,36,37,39,18,19,18,19,8,9,8,9,27,28,24,25,18,19,18,19,8,9,8,9,27,28,27,28,18,19,18,19,8,10,8,14"),d=f.large_array_unpack("5,2,0,8,15,15,13,14,12,15,8,8,2,5,8,12,12,13,14,12,18,1,19,34,34,34,34,18,18,19,19,18,24,19,25,16,16,21,21,24,24,25,25,24,27,25,28,31,31,32,32,27,27,28,28,27,4,28,7"),p=f.large_array_unpack("-6,21,-1,,56,-9,,55,1,,,,6,4,5,-5,24,,18,20,,28,,,30,32,,42,44,,,36,38,,19,,,,,"),_=f.large_array_unpack("-2,-25,-25,-3,-25,-4,-7,-25,-25,-24,40,-1,-25,-25,-25,-25,-11,-14,-25,-25,-22,-5,-6,-8,-25,-25,-23,-25,-25,-20,-21,-9,-10,-12,-15,-13,-16,-17,-18,-19"),x=[7,1,6,15,2,29,30,21,31,32,5,7,23,22,33,34,11,35],$=[7,1,6,5,2,9,9,5,8,8,3,7,7,6,9,9,4,10],se=[E,1,4,8,11,-5,0,-2,-16,-13,-17],ae=[E,E,E,E,E,E,E,20,16,17,E],Te=f.large_array_unpack("0,0,racc_error,3,24,_reduce_1,0,25,_reduce_2,1,25,_reduce_3,0,27,_reduce_4,2,27,_reduce_5,3,26,_reduce_6,1,26,_reduce_7,3,29,_reduce_8,3,28,_reduce_9,3,28,_reduce_10,1,28,_reduce_none,3,31,_reduce_12,4,31,_reduce_13,1,31,_reduce_none,0,33,_reduce_15,1,33,_reduce_16,1,33,_reduce_17,1,33,_reduce_18,1,33,_reduce_19,2,32,_reduce_20,2,32,_reduce_21,1,32,_reduce_none,3,30,_reduce_23,1,30,_reduce_24"),Fe=z(!1,0,"error",1,"NUMBER",2,"B",3,"R",4,"U",5,"C",6,"F",7,"S",8,"PLUS",9,"MINUS",10,"ASTERISK",11,"SLASH",12,"PARENL",13,"PARENR",14,"BRACKETL",15,"BRACKETR",16,"LESS",17,"GREATER",18,"EQUAL",19,"NOT",20,"AT",21,"CMP_OP",22),I(l[0],"Racc_arg",[h,d,_,p,x,$,ae,se,23,Te,Fe,40,25,!0]),Q(c("Ractor","skip_raise")?"constant":E)&&c("Ractor").$make_shareable(c("Racc_arg")),I(l[0],"Racc_token_to_s_table",f.large_array_unpack("$end,error,NUMBER,B,R,U,C,F,S,PLUS,MINUS,ASTERISK,SLASH,PARENL,PARENR,BRACKETL,BRACKETR,LESS,GREATER,EQUAL,NOT,AT,CMP_OP,$start,expr,secret,notations,target,add,dice,term,mul,unary,round_type")),Q(c("Ractor","skip_raise")?"constant":E)&&c("Ractor").$make_shareable(c("Racc_token_to_s_table")),I(l[0],"Racc_debug_parser",!1),D(B,"$_reduce_1",function(_e,ce,pe){return V(c("Node"),"Command").$new(U(["secret","notations","cmp_op","target_number"],{secret:_e["$[]"](0),notations:_e["$[]"](1),cmp_op:_e["$[]"](2)["$[]"]("cmp_op"),target_number:_e["$[]"](2)["$[]"]("target")}))}),D(B,"$_reduce_2",N(!1)),D(B,"$_reduce_3",N(!0)),D(B,"$_reduce_4",function(_e,ce,pe){return U([],{})}),D(B,"$_reduce_5",function(_e,ce,pe){var ye,ge,be;return be=null==(ye=G(_e))[1]?E:ye[1],Q(ge=null==ye[0]?E:ye[0])||this.$raise(c("ParseError")),U(["cmp_op","target"],{cmp_op:ge,target:be})}),D(B,"$_reduce_6",function(_e,ce,pe){var ye=E;return(ye=_e["$[]"](0)).$push(_e["$[]"](2)),ye}),D(B,"$_reduce_7",function(_e,ce,pe){return[_e["$[]"](0)]}),D(B,"$_reduce_8",function(_e,ce,pe){var ye,b;return ye=_e["$[]"](0),b=_e["$[]"](2),V(c("Node"),"Notation").$new(ye,b)}),D(B,"$_reduce_9",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"BinaryOp").$new(_e["$[]"](0),"+",_e["$[]"](2))}),D(B,"$_reduce_10",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"BinaryOp").$new(_e["$[]"](0),"-",_e["$[]"](2))}),D(B,"$_reduce_12",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"BinaryOp").$new(_e["$[]"](0),"*",_e["$[]"](2))}),D(B,"$_reduce_13",function(_e,ce,pe){return _e["$[]"](3).$new(_e["$[]"](0),_e["$[]"](2))}),D(B,"$_reduce_15",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),D(B,"$_reduce_16",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"DivideWithCeil")}),D(B,"$_reduce_17",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"DivideWithCeil")}),D(B,"$_reduce_18",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"DivideWithRound")}),D(B,"$_reduce_19",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"DivideWithFloor")}),D(B,"$_reduce_20",function(_e,ce,pe){return _e["$[]"](1)}),D(B,"$_reduce_21",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"Negative").$new(_e["$[]"](1))}),D(B,"$_reduce_23",function(_e,ce,pe){return _e["$[]"](1)}),D(B,"$_reduce_24",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"Number").$new(_e["$[]"](0))}),D(B,"$_reduce_none",function(_e,ce,pe){return _e["$[]"](0)})},Opal.modules["bcdice/common_command/barabara_dice"]=function(f){var N,E,Y,R,H,A,X,k,le,re,S=f.module,te=f.const_set,v=f.thrower,D=f.def,I=[],Q=f.nil;return f.top.$require("bcdice/common_command/barabara_dice/parser"),N=I,E=re=[S(I[0],"BCDice")].concat(N),Y=le=[S(re[0],"CommonCommand")].concat(E),te((k=[X=S(le[0],"BarabaraDice")].concat(Y))[0],"PREFIX_PATTERN",/\d+B\d+/.$freeze()),H=[R=f.get_singleton_class(X)].concat(k),A=f.$r(H),D(R,"$eval",function(C,P,L){try{var F;return v("eval_return"),(F=A("Parser").$parse(C))===Q||null==F?Q:F.$eval(P,L)}catch(B){if(B===f.t_eval_return)return B.$v;throw B}})},Opal.modules["bcdice/result"]=function(f){var le,X,Z,G,q,te=f.klass,v=f.send,D=f.def,z=f.return_val,I=f.return_ivar,Q=[],U=f.nil;return G=Q,le=q=[(0,f.module)(Q[0],"BCDice")].concat(G),[Z=te(q[0],null,"Result")].concat(le),D(X=f.get_singleton_class(Z),"$success",function(ee){return v(this.$new(),"tap",[],function(M){var C;return null==M&&(M=U),M["$text="](ee),v(M,"success=",C=[!0]),C[C.length-1]})}),D(X,"$failure",function(ee){return v(this.$new(),"tap",[],function(M){var C;return null==M&&(M=U),M["$text="](ee),v(M,"failure=",C=[!0]),C[C.length-1]})}),D(X,"$critical",function(ee){return v(this.$new(),"tap",[],function(M){var C;return null==M&&(M=U),M["$text="](ee),M["$critical="](!0),v(M,"success=",C=[!0]),C[C.length-1]})}),D(X,"$fumble",function(ee){return v(this.$new(),"tap",[],function(M){var C;return null==M&&(M=U),M["$text="](ee),M["$fumble="](!0),v(M,"failure=",C=[!0]),C[C.length-1]})}),D(X,"$nothing",z("nothing")),D(Z,"$initialize",function(k){var R=this;return null==k&&(k=U),R.text=k,R.rands=U,R.detailed_rands=U,R.secret=!1,R.success=!1,R.failure=!1,R.critical=!1,R.fumble=!1},-1),Z.$attr_accessor("text","rands","detailed_rands"),Z.$attr_writer("secret","success","failure","critical","fumble"),D(Z,"$secret?",I("secret")),D(Z,"$success?",I("success")),D(Z,"$failure?",I("failure")),D(Z,"$critical?",I("critical")),D(Z,"$fumble?",I("fumble")),D(Z,"$condition=",function(k){return this.success=k,this.failure=k["$!"]()})},Opal.modules["bcdice/common_command/tally_dice/node"]=function(f){var k,A,L,B,h,d,p,_,m,F,C,ee,S=f.module,te=f.klass,v=f.const_set,D=f.ensure_kwargs,z=f.get_kwarg,I=f.def,Q=f.truthy,U=f.rb_gt,N=f.send,G=f.not,re=f.eqeq,q=f.hash2,E=f.thrower,V=f.alias,Z=[],Y=f.nil;return f.top.$require("bcdice/result"),k=Z,A=ee=[S(Z[0],"BCDice")].concat(k),L=C=[S(ee[0],"CommonCommand")].concat(A),B=F=[S(C[0],"TallyDice")].concat(L),h=m=[S(F[0],"Node")].concat(B),p=[d=te(m[0],null,"Command")].concat(h),_=f.$r(p),d.$$prototype.notation=Y,v(p[0],"MAX_SIDES",20),I(d,"$initialize",function(se){var ae,Te;return se=D(se),ae=z(se,"secret"),Te=z(se,"notation"),this.secret=ae,this.notation=Te}),I(d,"$eval",function(se,ae){var Ae=Y,de=Y,Fe=Y,xe=Y,ke=Y,De=Y;return Ae=this.notation.$to_dice(se.$round_type()),Q(Ae["$valid?"]())?Q(U(Ae.$sides(),_("MAX_SIDES")))?_("Result").$new("("+Ae+") \uff1e \u9762\u6570\u306f1\u4ee5\u4e0a\u3001"+_("MAX_SIDES")+"\u4ee5\u4e0b\u3068\u3057\u3066\u304f\u3060\u3055\u3044"):(de=Ae.$roll(ae),Fe=(Q(se["$sort_barabara_dice?"]())?de.$sort():de).$join(","),xe=N(N(de,"group_by",[],"itself".$to_proc()),"transform_values",[],"length".$to_proc()),ke=N(f.Range.$new(1,Ae.$sides(),!1),"map",[],function(_e){var ce;return null==_e&&(_e=Y),ce=xe.$fetch(_e,0),re(ce,0)&&G(Ae["$show_zeros?"]())?Y:"["+_e+"]\xd7"+xe.$fetch(_e,0)}),De=["("+Ae+")",Fe,ke.$compact().$join(", ")].$compact(),N(_("Result").$new(),"tap",[],function Me(_e){var ce,pe=null==Me.$$s?this:Me.$$s;return null==pe.secret&&(pe.secret=Y),null==_e&&(_e=Y),_e["$secret="](pe.secret),ce=[De.$join(" \uff1e ")],N(_e,"text=",ce),ce[ce.length-1]},{$$s:this})):Y}),function(l,c,h){var d=te(l,null,"Notation"),p=[d].concat(h),_=f.$r(p),x=d.$$prototype;x.times=x.sides=x.show_zeros=Y,d.$attr_reader("times"),d.$attr_reader("sides"),d.$attr_reader("show_zeros"),I(d,"$initialize",function(se){var ae,Te,Ae;return se=D(se),ae=z(se,"times"),Te=z(se,"sides"),Ae=z(se,"show_zeros"),this.times=ae,this.sides=Te,this.show_zeros=Ae}),I(d,"$to_dice",function(se){try{var Ae,de;return E("eval_return"),Ae=this.times.$eval(se),de=this.sides.$eval(se),_("Dice").$new(q(["times","sides","show_zeros"],{times:Ae,sides:de,show_zeros:this.show_zeros}))}catch(Fe){if(Fe===f.t_eval_return)return Fe.$v;throw Fe}})}(m[0],0,m),function(l,c){var h=te(l,null,"Dice"),d=h.$$prototype;return d.times=d.sides=d.show_zeros=Y,h.$attr_reader("times"),h.$attr_reader("sides"),h.$attr_reader("show_zeros"),V(h,"show_zeros?","show_zeros"),I(h,"$initialize",function(_){var x,$,se;return _=D(_),x=z(_,"times"),$=z(_,"sides"),se=z(_,"show_zeros"),this.times=x,this.sides=$,this.show_zeros=se}),I(h,"$valid?",function(){var x;return Q(x=U(this.times,0))?U(this.sides,0):x}),I(h,"$roll",function(_){return _.$roll_barabara(this.times,this.sides)}),I(h,"$to_s",function(){var x,_=this;return x=Q(_.show_zeros)?"Z":"Y",_.times+"T"+x+_.sides})}(m[0])},Opal.modules["bcdice/common_command/tally_dice/parser"]=function(f){var le,k,A,F,c,h,d,p,_,x,$,se,ae,de,he,m,l,C,P,ee,Y,S=f.module,te=f.klass,v=f.defs,D=f.def,z=f.hash,I=f.const_set,Q=f.truthy,U=f.hash2,N=f.return_val,G=f.top,re=[],q=f.nil,E=f.$$$;return G.$require("racc/parser.rb"),G.$require("bcdice/common_command/lexer"),G.$require("bcdice/common_command/tally_dice/node"),G.$require("bcdice/arithmetic/node"),le=re,k=Y=[S(re[0],"BCDice")].concat(le),A=ee=[S(Y[0],"CommonCommand")].concat(k),C=[S(ee[0],"TallyDice")].concat(A),P=f.$r(C),F=C,m=[he=te(C[0],E(P("Racc"),"Parser"),"Parser")].concat(F),l=f.$r(m),he.$$prototype.lexer=q,v(he,"$parse",function(Me){return this.$new().$parse(Me)}),D(he,"$parse",function(Me){try{return this.lexer=l("Lexer").$new(Me),this.$do_parse()}catch(ce){if(!f.rescue(ce,[l("ParseError")]))throw ce;try{return q}finally{f.pop_exception()}}}),he.$private(),D(he,"$next_token",function(){return this.lexer.$next_token()}),c=f.large_array_unpack("8,8,18,19,20,21,8,8,8,22,14,15,3,7,7,14,15,14,15,7,7,7,8,4,8,35,33,34,36,8,9,14,15,14,15,7,8,7,14,15,23,24,7,23,24,14,15,23,24,7,10"),h=f.large_array_unpack("2,7,10,10,11,11,14,17,15,11,7,7,0,2,7,14,14,15,15,14,17,15,20,1,21,31,31,31,31,23,4,20,20,21,21,20,24,21,23,23,12,12,23,28,28,24,24,29,29,24,6"),d=f.large_array_unpack("2,23,-2,,30,,47,-1,,,-2,-7,27,,4,6,,5,,,20,22,,27,34,,,,30,34,,19,,,,,"),p=f.large_array_unpack("-2,-23,-23,-3,-23,-1,-23,-23,-22,37,-23,-23,-9,-12,-23,-23,-20,-23,-5,-6,-23,-23,-21,-23,-23,-18,-19,-4,-7,-8,-10,-13,-11,-14,-15,-16,-17"),_=[6,25,26,12,1,2,5,17,11,32,30,31,q,q,q,27,28,29],x=[4,8,8,7,1,2,3,5,6,9,8,8,q,q,q,4,7,7],$=[q,4,5,4,-2,-3,1,-4,-13,-22],se=[q,q,q,q,16,q,q,q,13,q],ae=f.large_array_unpack("0,0,racc_error,2,18,_reduce_1,0,19,_reduce_2,1,19,_reduce_3,4,20,_reduce_4,1,22,_reduce_5,1,22,_reduce_6,3,23,_reduce_7,3,23,_reduce_8,1,23,_reduce_none,3,24,_reduce_10,4,24,_reduce_11,1,24,_reduce_none,0,26,_reduce_13,1,26,_reduce_14,1,26,_reduce_15,1,26,_reduce_16,1,26,_reduce_17,2,25,_reduce_18,2,25,_reduce_19,1,25,_reduce_none,3,21,_reduce_21,1,21,_reduce_22"),de=z(!1,0,"error",1,"NUMBER",2,"T",3,"Y",4,"Z",5,"R",6,"U",7,"C",8,"F",9,"S",10,"PLUS",11,"MINUS",12,"ASTERISK",13,"SLASH",14,"PARENL",15,"PARENR",16),I(m[0],"Racc_arg",[c,h,p,d,_,x,se,$,17,ae,de,37,23,!0]),Q(l("Ractor","skip_raise")?"constant":q)&&l("Ractor").$make_shareable(l("Racc_arg")),I(m[0],"Racc_token_to_s_table",["$end","error","NUMBER","T","Y","Z","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","expr","secret","notation","term","show_zeros","add","mul","unary","round_type"]),Q(l("Ractor","skip_raise")?"constant":q)&&l("Ractor").$make_shareable(l("Racc_token_to_s_table")),I(m[0],"Racc_debug_parser",!1),D(he,"$_reduce_1",function(Me,_e,ce){return E(l("Node"),"Command").$new(U(["secret","notation"],{secret:Me["$[]"](0),notation:Me["$[]"](1)}))}),D(he,"$_reduce_2",N(!1)),D(he,"$_reduce_3",N(!0)),D(he,"$_reduce_4",function(Me,_e,ce){return E(l("Node"),"Notation").$new(U(["times","sides","show_zeros"],{times:Me["$[]"](0),sides:Me["$[]"](3),show_zeros:Me["$[]"](2)}))}),D(he,"$_reduce_5",N(!1)),D(he,"$_reduce_6",N(!0)),D(he,"$_reduce_7",function(Me,_e,ce){return E(E(l("Arithmetic"),"Node"),"BinaryOp").$new(Me["$[]"](0),"+",Me["$[]"](2))}),D(he,"$_reduce_8",function(Me,_e,ce){return E(E(l("Arithmetic"),"Node"),"BinaryOp").$new(Me["$[]"](0),"-",Me["$[]"](2))}),D(he,"$_reduce_10",function(Me,_e,ce){return E(E(l("Arithmetic"),"Node"),"BinaryOp").$new(Me["$[]"](0),"*",Me["$[]"](2))}),D(he,"$_reduce_11",function(Me,_e,ce){return Me["$[]"](3).$new(Me["$[]"](0),Me["$[]"](2))}),D(he,"$_reduce_13",function(Me,_e,ce){return E(E(l("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),D(he,"$_reduce_14",function(Me,_e,ce){return E(E(l("Arithmetic"),"Node"),"DivideWithCeil")}),D(he,"$_reduce_15",function(Me,_e,ce){return E(E(l("Arithmetic"),"Node"),"DivideWithCeil")}),D(he,"$_reduce_16",function(Me,_e,ce){return E(E(l("Arithmetic"),"Node"),"DivideWithRound")}),D(he,"$_reduce_17",function(Me,_e,ce){return E(E(l("Arithmetic"),"Node"),"DivideWithFloor")}),D(he,"$_reduce_18",function(Me,_e,ce){return Me["$[]"](1)}),D(he,"$_reduce_19",function(Me,_e,ce){return E(E(l("Arithmetic"),"Node"),"Negative").$new(Me["$[]"](1))}),D(he,"$_reduce_21",function(Me,_e,ce){return Me["$[]"](1)}),D(he,"$_reduce_22",function(Me,_e,ce){return E(E(l("Arithmetic"),"Node"),"Number").$new(Me["$[]"](0))}),D(he,"$_reduce_none",function(Me,_e,ce){return Me["$[]"](0)})},Opal.modules["bcdice/common_command/tally_dice"]=function(f){var N,E,Y,R,H,A,X,k,le,re,S=f.module,te=f.const_set,v=f.thrower,D=f.def,I=[],Q=f.nil;return f.top.$require("bcdice/common_command/tally_dice/parser"),N=I,E=re=[S(I[0],"BCDice")].concat(N),Y=le=[S(re[0],"CommonCommand")].concat(E),te((k=[X=S(le[0],"TallyDice")].concat(Y))[0],"PREFIX_PATTERN",/\d+T[YZ]\d+/.$freeze()),H=[R=f.get_singleton_class(X)].concat(k),A=f.$r(H),D(R,"$eval",function(C,P,L){try{var F;return v("eval_return"),(F=A("Parser").$parse(C))===Q||null==F?Q:F.$eval(P,L)}catch(B){if(B===f.t_eval_return)return B.$v;throw B}})},Opal.modules["bcdice/common_command/calc/node"]=function(f){var V,X,H,P,B,O,m,l,ne,M,R,Z,S=f.module,te=f.klass,v=f.ensure_kwargs,D=f.get_kwarg,z=f.def,I=f.truthy,Q=f.send,U=f.thrower,G=[],re=f.nil,q=f.$$$;return f.top.$require("bcdice/arithmetic/node"),V=G,X=Z=[S(G[0],"BCDice")].concat(V),H=R=[S(Z[0],"CommonCommand")].concat(X),P=M=[S(R[0],"Calc")].concat(H),B=ne=[S(M[0],"Node")].concat(P),m=[O=te(ne[0],null,"Command")].concat(B),l=f.$r(m),O.$$prototype.expr=re,z(O,"$initialize",function(d){var p,_;return d=v(d),p=D(d,"secret"),_=D(d,"expr"),this.secret=p,this.expr=_}),z(O,"$eval",function(d){try{U("eval_return");var x,$,_=this;return x=function(){try{return _.expr.$eval(d).$to_i()}catch(se){if(!f.rescue(se,[l("ZeroDivisionError")]))throw se;try{return"\u30bc\u30ed\u9664\u7b97\u304c\u767a\u751f\u3057\u305f\u305f\u3081\u8a08\u7b97\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f"}finally{f.pop_exception()}}}(),$=I(_.expr["$is_a?"](q(q(l("Arithmetic"),"Node"),"Parenthesis")))?_.expr.$output():"("+_.expr.$output()+")",Q(l("Result").$new(),"tap",[],function se(ae){var Te,Ae=null==se.$$s?this:se.$$s;return null==Ae.secret&&(Ae.secret=re),null==ae&&(ae=re),ae["$secret="](Ae.secret),Q(ae,"text=",Te=["c"+$+" \uff1e "+x]),Te[Te.length-1]},{$$s:_})}catch(se){if(se===f.t_eval_return)return se.$v;throw se}})},Opal.modules["bcdice/common_command/calc/parser"]=function(f){var le,k,A,F,c,h,d,p,_,x,$,se,ae,de,he,m,l,C,P,ee,Y,S=f.module,te=f.klass,v=f.defs,D=f.def,z=f.hash,I=f.const_set,Q=f.truthy,U=f.hash2,N=f.return_val,G=f.top,re=[],q=f.nil,E=f.$$$;return G.$require("racc/parser.rb"),G.$require("bcdice/common_command/lexer"),G.$require("bcdice/common_command/calc/node"),G.$require("bcdice/arithmetic/node"),le=re,k=Y=[S(re[0],"BCDice")].concat(le),A=ee=[S(Y[0],"CommonCommand")].concat(k),C=[S(ee[0],"Calc")].concat(A),P=f.$r(C),F=C,m=[he=te(C[0],E(P("Racc"),"Parser"),"Parser")].concat(F),l=f.$r(m),he.$$prototype.lexer=q,v(he,"$parse",function(Me){return this.$new().$parse(Me)}),D(he,"$parse",function(Me){try{return this.lexer=l("Lexer").$new(Me),this.$do_parse()}catch(ce){if(!f.rescue(ce,[l("ParseError")]))throw ce;try{return q}finally{f.pop_exception()}}}),he.$private(),D(he,"$next_token",function(){return this.lexer.$next_token()}),c=f.large_array_unpack("14,3,14,15,16,4,10,11,10,11,13,14,13,14,17,18,5,10,11,10,11,13,14,13,14,17,18,6,10,11,10,11,13,14,13,14,17,18,,10,11,10,11,13,,13,15,16,,,,26,30,28,29,31"),h=f.large_array_unpack("5,0,10,7,7,1,5,5,10,10,5,11,10,13,8,8,2,11,11,13,13,11,15,13,16,22,22,4,15,15,16,16,15,17,16,18,23,23,,17,17,18,18,17,,18,21,21,,,,21,25,25,25,25"),d=[-6,5,11,q,27,-2,q,-5,4,q,0,9,q,11,q,20,22,31,33,q,q,38,15,26,q,49,q,q,q,q,q,q],p=[-2,-20,-20,-3,-20,-20,32,-1,-6,-9,-20,-20,-17,-20,-19,-20,-20,-20,-20,-15,-16,-20,-4,-5,-7,-10,-18,-8,-11,-12,-13,-14],_=[7,1,19,20,22,23,2,27,21,24,25],x=[3,1,5,5,4,4,2,6,3,5,5],$=[q,1,6,-5,-11,-8,-18,q],se=[q,q,q,q,8,9,q,12],ae=f.large_array_unpack("0,0,racc_error,3,15,_reduce_1,0,16,_reduce_2,1,16,_reduce_3,3,17,_reduce_4,3,17,_reduce_5,1,17,_reduce_none,3,18,_reduce_7,4,18,_reduce_8,1,18,_reduce_none,0,20,_reduce_10,1,20,_reduce_11,1,20,_reduce_12,1,20,_reduce_13,1,20,_reduce_14,2,19,_reduce_15,2,19,_reduce_16,1,19,_reduce_none,3,21,_reduce_18,1,21,_reduce_19"),de=z(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13),I(m[0],"Racc_arg",[c,h,p,d,_,x,se,$,14,ae,de,32,20,!0]),Q(l("Ractor","skip_raise")?"constant":q)&&l("Ractor").$make_shareable(l("Racc_arg")),I(m[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","expr","secret","add","mul","unary","round_type","term"]),Q(l("Ractor","skip_raise")?"constant":q)&&l("Ractor").$make_shareable(l("Racc_token_to_s_table")),I(m[0],"Racc_debug_parser",!1),D(he,"$_reduce_1",function(Me,_e,ce){return E(l("Node"),"Command").$new(U(["secret","expr"],{secret:Me["$[]"](0),expr:Me["$[]"](2)}))}),D(he,"$_reduce_2",N(!1)),D(he,"$_reduce_3",N(!0)),D(he,"$_reduce_4",function(Me,_e,ce){return E(E(l("Arithmetic"),"Node"),"BinaryOp").$new(Me["$[]"](0),"+",Me["$[]"](2))}),D(he,"$_reduce_5",function(Me,_e,ce){return E(E(l("Arithmetic"),"Node"),"BinaryOp").$new(Me["$[]"](0),"-",Me["$[]"](2))}),D(he,"$_reduce_7",function(Me,_e,ce){return E(E(l("Arithmetic"),"Node"),"BinaryOp").$new(Me["$[]"](0),"*",Me["$[]"](2))}),D(he,"$_reduce_8",function(Me,_e,ce){return Me["$[]"](3).$new(Me["$[]"](0),Me["$[]"](2))}),D(he,"$_reduce_10",function(Me,_e,ce){return E(E(l("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),D(he,"$_reduce_11",function(Me,_e,ce){return E(E(l("Arithmetic"),"Node"),"DivideWithCeil")}),D(he,"$_reduce_12",function(Me,_e,ce){return E(E(l("Arithmetic"),"Node"),"DivideWithCeil")}),D(he,"$_reduce_13",function(Me,_e,ce){return E(E(l("Arithmetic"),"Node"),"DivideWithRound")}),D(he,"$_reduce_14",function(Me,_e,ce){return E(E(l("Arithmetic"),"Node"),"DivideWithFloor")}),D(he,"$_reduce_15",function(Me,_e,ce){return Me["$[]"](1)}),D(he,"$_reduce_16",function(Me,_e,ce){return E(E(l("Arithmetic"),"Node"),"Negative").$new(Me["$[]"](1))}),D(he,"$_reduce_18",function(Me,_e,ce){return E(E(l("Arithmetic"),"Node"),"Parenthesis").$new(Me["$[]"](1))}),D(he,"$_reduce_19",function(Me,_e,ce){return E(E(l("Arithmetic"),"Node"),"Number").$new(Me["$[]"](0))}),D(he,"$_reduce_none",function(Me,_e,ce){return Me["$[]"](0)})},Opal.modules["bcdice/common_command/calc"]=function(f){var N,E,Y,R,H,A,X,k,le,re,S=f.module,te=f.const_set,v=f.thrower,D=f.def,I=[],Q=f.nil;return f.top.$require("bcdice/common_command/calc/parser"),N=I,E=re=[S(I[0],"BCDice")].concat(N),Y=le=[S(re[0],"CommonCommand")].concat(E),te((k=[X=S(le[0],"Calc")].concat(Y))[0],"PREFIX_PATTERN",/C[+\-(]*\d+/.$freeze()),H=[R=f.get_singleton_class(X)].concat(k),A=f.$r(H),D(R,"$eval",function(C,P,L){try{var F;return v("eval_return"),(F=A("Parser").$parse(C))===Q||null==F?Q:F.$eval(P.$round_type())}catch(B){if(B===f.t_eval_return)return B.$v;throw B}})},Opal.modules["bcdice/common_command/choice"]=function(f){var R,M,F,c,d,he,B,O,m,P,H,S=f.module,te=f.klass,v=f.const_set,D=f.hash2,z=f.def,I=f.truthy,Q=f.eqeq,U=f.eqeqeq,N=f.send,G=f.rb_lt,re=f.thrower,q=f.rb_gt,E=f.ensure_kwargs,V=f.get_kwarg,Z=[],Y=f.nil,X=f.$$$;return f.top.$require("strscan"),R=Z,M=H=[S(Z[0],"BCDice")].concat(R),F=P=[S(H[0],"CommonCommand")].concat(M),B=[he=te(P[0],null,"Choice")].concat(F),O=f.$r(B),(m=he.$$prototype).items=m.takes=m.block_delimiter=Y,v(B[0],"PREFIX_PATTERN",/choice/.$freeze()),c=B,v((d=[S(B[0],"BlockDelimiter")].concat(c))[0],"BRACKET","bracket"),v(d[0],"PAREN","paren"),v(d[0],"SPACE","space"),v(B[0],"DELIMITER",D(["bracket","paren","space"],{bracket:/,/,paren:/,/,space:/\s+/}).$freeze()),v(B[0],"DELIMITER_CHAR",D(["bracket","paren","space"],{bracket:", ",paren:", ",space:" "}).$freeze()),v(B[0],"TERMINATION",D(["bracket","paren","space"],{bracket:/\]/,paren:/\)/,space:/$/}).$freeze()),v(B[0],"SUFFIX",D(["bracket","paren","space"],{bracket:"]",paren:")",space:""}).$freeze()),function(l,c){var h=[l].concat(c),d=f.$r(h);z(l,"$eval",function(_,x,$){var se;return(se=this.$parse(_))===Y||null==se?Y:se.$roll($)}),l.$private(),z(l,"$parse",function(_){try{var $,Te,Fe,xe,ke,x=re("return"),ae=Y,Ae=Y,de=Y,De=Y,Me=Y,_e=Y;if((ae=d("StringScanner").$new(_)).$skip(/\s+/),Te=ae.$scan(/S/i)["$nil?"]()["$!"](),!I(ae.$scan(/choice/i))||(Ae=I(de=($=ae.$scan(/\d+/))===Y||null==$?Y:$.$to_i())?de:1,Q(Ae,0)))return Y;for(Fe=U("[",de=ae.$scan(/\(|\[|\s+/))?X(d("BlockDelimiter"),"BRACKET"):U("(",de)?X(d("BlockDelimiter"),"PAREN"):U(d("String"),de)?X(d("BlockDelimiter"),"SPACE"):void x.$throw(),xe=d("DELIMITER")["$[]"](Fe),ke=d("TERMINATION")["$[]"](Fe),De=[];I(Me=ae.$scan_until(xe));)De.$push(Me.$delete_suffix(","));return _e=ae.$scan_until(ke),!I(_e)||(De.$push(_e.$delete_suffix(d("SUFFIX")["$[]"](Fe))),De=N(N(De,"map",[],"strip".$to_proc()),"reject",[],"empty?".$to_proc()),Q(De.$size(),1)&&(De=this.$parse_multi_item_shorthand(De.$first())),I(De["$empty?"]())||I(G(De.$size(),Ae)))?Y:this.$new(D(["secret","block_delimiter","takes","items"],{secret:Te,block_delimiter:Fe,takes:Ae,items:De}))}catch(ce){if(ce===x)return ce.$v;throw ce}}),z(l,"$parse_multi_item_shorthand",function(_){var $,se;return I($=I(se=this.$parse_multi_nums_shorthand(_))?se:this.$parse_multi_chars_shorthand(_))?$:[]}),z(l,"$parse_multi_nums_shorthand",function(_){var x=Y,$=Y,se=Y;return x=/^(\d+)-(\d+)$/.$match(_),!I(x)||($=x["$[]"](1).$to_i(),se=x["$[]"](2).$to_i(),I(q($,se)))?Y:$.$upto(se).$to_a()}),z(l,"$parse_multi_chars_shorthand",function(_){var $,x=Y,se=Y,ae=Y;return x=I($=/^([a-z])-([a-z])$/.$match(_))?$:/^([A-Z])-([A-Z])$/.$match(_),!I(x)||(se=x["$[]"](1),ae=x["$[]"](2),I(q(se,ae)))?Y:se.$upto(ae).$to_a()})}(f.get_singleton_class(he),B),z(he,"$initialize",function(c){var h,d,p,_,x=this;return c=E(c),h=V(c,"secret"),d=V(c,"block_delimiter"),p=V(c,"takes"),_=V(c,"items"),x.secret=h,x.block_delimiter=d,x.takes=p,x.items=_}),z(he,"$roll",function(c){var h=this,d=Y,p=Y;return I(q(h.items.$size(),100))?O("Result").$new("\u9805\u76ee\u6570\u306f100\u4ee5\u4e0b\u3068\u3057\u3066\u304f\u3060\u3055\u3044"):(d=h.items.$dup(),p=[],N(h.takes,"times",[],function(){var x;return x=c.$roll_index(d.$size()),p["$<<"](d.$delete_at(x))}),N(O("Result").$new(),"tap",[],function _(x){var $,ae,se=null==_.$$s?this:_.$$s;return null==se.block_delimiter&&(se.block_delimiter=Y),null==se.secret&&(se.secret=Y),null==x&&(x=Y),ae=p.$join(O("DELIMITER_CHAR")["$[]"](se.block_delimiter)),x["$secret="](se.secret),$=["("+se.$expr()+") \uff1e "+ae],N(x,"text=",$),$[$.length-1]},{$$s:h}))}),z(he,"$expr",function(){var h,d,c=this;return h=Q(c.takes,1)?Y:c.takes,U(X(O("BlockDelimiter"),"SPACE"),d=c.block_delimiter)?"choice"+h+" "+c.items.$join(" "):U(X(O("BlockDelimiter"),"BRACKET"),d)?"choice"+h+"["+c.items.$join(",")+"]":U(X(O("BlockDelimiter"),"PAREN"),d)?"choice"+h+"("+c.items.$join(",")+")":Y})},Opal.modules["bcdice/common_command/d66_dice"]=function(f){var X,H,L,O,l,c,ne,F,he,M,R,S=f.module,te=f.klass,v=f.const_set,D=f.thrower,z=f.def,I=f.truthy,Q=f.hash2,U=f.ensure_kwargs,N=f.get_kwarg,G=f.send,re=f.eqeqeq,q=f.rb_plus,E=f.rb_times,V=[],le=f.nil,Z=f.$$$;return X=V,H=R=[S(V[0],"BCDice")].concat(X),L=M=[S(R[0],"CommonCommand")].concat(H),F=[ne=te(M[0],null,"D66Dice")].concat(L),he=f.$r(F),ne.$$prototype.sort_type=le,v(F[0],"PREFIX_PATTERN",/D66/.$freeze()),l=[O=f.get_singleton_class(ne)].concat(F),c=f.$r(l),z(O,"$eval",function(d,p,_){try{var $;return D("eval_return"),($=this.$parse(d,p))===le||null==$?le:$.$eval(_)}catch(Te){if(Te===f.t_eval_return)return Te.$v;throw Te}}),O.$private(),z(O,"$parse",function(d,p){var x=le,$=le;return d=d.$split(" ",2).$first(),x=/^(S)?D66([ANSD])?$/i.$match(d.$upcase()),I(x)?this.$new(Q(["secret","sort_type","suffix"],{secret:x["$[]"](1)["$nil?"]()["$!"](),sort_type:I($=this.$sort_type_from_suffix(x["$[]"](2)))?$:p.$d66_sort_type(),suffix:x["$[]"](2)})):le}),z(O,"$sort_type_from_suffix",function(d){switch(d.valueOf()){case"A":case"S":return Z(c("D66SortType"),"ASC");case"D":return Z(c("D66SortType"),"DESC");case"N":return Z(c("D66SortType"),"NO_SORT");default:return le}}),z(ne,"$initialize",function(m){var l,c,h,d=this;return m=U(m),l=N(m,"secret"),c=N(m,"sort_type"),h=N(m,"suffix"),d.secret=l,d.sort_type=c,d.suffix=h}),z(ne,"$eval",function(m){var c;return c=this.$roll(m),G(he("Result").$new(),"tap",[],function h(d){var p,_=null==h.$$s?this:h.$$s;return null==_.secret&&(_.secret=le),null==_.suffix&&(_.suffix=le),null==d&&(d=le),d["$secret="](_.secret),G(d,"text=",p=["(D66"+_.suffix+") \uff1e "+c]),p[p.length-1]},{$$s:this})}),ne.$private(),z(ne,"$roll",function(m){var h,c=le;return c=G(he("Array"),"new",[2],function(){return m.$roll_once(6)}),re(Z(he("D66SortType"),"ASC"),h=this.sort_type)?c["$sort!"]():re(Z(he("D66SortType"),"DESC"),h)&&c["$sort!"]()["$reverse!"](),q(E(c["$[]"](0),10),c["$[]"](1))})},Opal.modules["bcdice/common_command/repeat"]=function(f){var Y,ee,P,B,m,l,L,ne,F,he,A,k,S=f.module,te=f.klass,v=f.const_set,D=f.def,z=f.truthy,I=f.hash2,Q=f.ensure_kwargs,U=f.get_kwarg,N=f.send,G=f.eqeq,re=f.thrower,q=f.rb_lt,V=[],le=f.nil;return f.top.$require("strscan"),Y=V,ee=k=[S(V[0],"BCDice")].concat(Y),P=A=[S(k[0],"CommonCommand")].concat(ee),ne=[L=te(A[0],null,"Repeat")].concat(P),F=f.$r(ne),(he=L.$$prototype).times=he.trailer=he.secret=le,v(ne[0],"PREFIX_PATTERN",/(repeat|rep|x)\d+/.$freeze()),v(ne[0],"REPEAT_LIMIT",100),m=[B=f.get_singleton_class(L)].concat(ne),l=f.$r(m),D(B,"$eval",function(h,d,p){var _;return(_=this.$parse(h))===le||null==_?le:_.$roll(d,p)}),B.$private(),D(B,"$parse",function(h){var d,x,_=le,$=le,se=le,ae=le,Te=le;return x=(_=l("StringScanner").$new(h)).$scan(/s/i)["$nil?"]()["$!"](),$=_.$scan(/repeat|rep|x/i),se=(d=_.$scan(/\d+/))===le||null==d?le:d.$to_i(),ae=_.$scan(/\s+/),z($["$nil?"]())||z(se["$nil?"]())||z(ae["$nil?"]())||(Te=_.$post_match(),z(Te["$nil?"]())||z(Te["$empty?"]()))?le:this.$new(I(["secret","times","trailer"],{secret:x,times:se,trailer:Te}))}),D(L,"$initialize",function(O){var m,l,c,h=this;return O=Q(O),m=U(O,"secret"),l=U(O,"times"),c=U(O,"trailer"),h.secret=m,h.times=l,h.trailer=c}),D(L,"$roll",function(O,m){try{re("eval_return");var h,c=this,d=le,p=le,_=le,x=le;return h=c.$validate(),z(h)?h:(d=N(F("Array"),"new",[c.times],function $(){var se=null==$.$$s?this:$.$$s,ae=le;return null==se.trailer&&(se.trailer=le),(ae=O.$class().$new(se.trailer))["$randomizer="](m),ae.$eval()},{$$s:c}),G(N(d,"count",[],function(se){return null==se&&(se=le),se["$=="](le)}),c.times)?c.$result_with_text("\u7e70\u308a\u8fd4\u3057\u5bfe\u8c61\u306e\u30b3\u30de\u30f3\u30c9\u304c\u5b9f\u884c\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f ("+c.trailer+")"):(p=N(d.$map(),"with_index",[1],function(se,ae){return null==se&&(se=le),null==ae&&(ae=le),"#"+ae+"\n"+se.$text()}).$join("\n\n"),_=z(x=c.secret)?x:N(d,"any?",[],"secret?".$to_proc()),N(F("Result").$new(),"tap",[],function(se){var ae;return null==se&&(se=le),se["$secret="](_),N(se,"text=",ae=[p]),ae[ae.length-1]})))}catch($){if($===f.t_eval_return)return $.$v;throw $}}),L.$private(),D(L,"$validate",function(){var O=this;return z(/^(repeat|rep|x)\d+/["$match?"](O.trailer))?O.$result_with_text("Repeat\u30b3\u30de\u30f3\u30c9\u306e\u91cd\u8907\u306f\u3067\u304d\u307e\u305b\u3093"):z(q(O.times,1))||z(q(F("REPEAT_LIMIT"),O.times))?O.$result_with_text("\u7e70\u308a\u8fd4\u3057\u56de\u6570\u306f1\u4ee5\u4e0a\u3001"+F("REPEAT_LIMIT")+"\u4ee5\u4e0b\u3068\u3057\u3066\u304f\u3060\u3055\u3044"):le}),D(L,"$result_with_text",function(O){return N(F("Result").$new(),"tap",[],function l(c){var h,d=null==l.$$s?this:l.$$s;return null==d.secret&&(d.secret=le),null==c&&(c=le),c["$secret="](d.secret),N(c,"text=",h=[O]),h[h.length-1]},{$$s:this})})},Opal.modules["bcdice/format"]=function(f){var G,V,le,Z,Y,q,S=f.module,te=f.eqeqeq,v=f.def,D=f.truthy,z=f.eqeq,I=f.rb_gt,Q=[],U=f.nil;return G=Q,V=q=[S(Q[0],"BCDice")].concat(G),Z=[le=S(q[0],"Format")].concat(V),Y=f.$r(Z),le.$module_function(),v(le,"$comparison_operator",function(k){var R;return te("==",R=k)?"=":te("!=",R)?"<>":te(Y("Symbol"),R)?k.$to_s():U}),v(le,"$modifier",function(k){return D(k["$nil?"]())?U:z(k,0)?"":D(I(k,0))?"+"+k:k.$to_s()})},Opal.modules["bcdice/common_command/barabara_dice/result"]=function(f){var re,le,k,M,Y,E,S=f.module,te=f.klass,v=f.send2,D=f.find_super,z=f.def,Q=[],U=f.nil,N=f.$$$;return f.top.$require("bcdice/result"),re=Q,le=E=[S(Q[0],"BCDice")].concat(re),k=Y=[S(E[0],"CommonCommand")].concat(le),(M=te([S(Y[0],"BarabaraDice")].concat(k)[0],N(N("BCDice"),"Result"),"Result")).$attr_accessor("last_dice_list_list"),M.$attr_accessor("last_dice_list"),M.$attr_accessor("success_num"),z(M,"$initialize",function C(P){var ne=this;return C.$$p=null,null==P&&(P=U),v(ne,D(ne,"initialize",C,!1,!0),"initialize",[P],null),ne.last_dice_list_list=[],ne.last_dice_list=[],ne.success_num=0},-1)},Opal.modules["bcdice/common_command/barabara_dice/node"]=function(f){var E,Y,ee,C,he,B,O,m,l,L,A,k,le,S=f.module,te=f.klass,v=f.ensure_kwargs,D=f.get_kwarg,z=f.def,I=f.send,Q=f.truthy,U=f.thrower,N=f.top,G=[],re=f.nil;return N.$require("bcdice/format"),N.$require("bcdice/common_command/barabara_dice/result"),E=G,Y=le=[S(G[0],"BCDice")].concat(E),ee=k=[S(le[0],"CommonCommand")].concat(Y),C=A=[S(k[0],"BarabaraDice")].concat(ee),he=L=[S(A[0],"Node")].concat(C),O=[B=te(L[0],null,"Command")].concat(he),m=f.$r(O),(l=B.$$prototype).notations=l.cmp_op=l.target_number=re,z(B,"$initialize",function(h){var d,p,_,x,$=this;return h=v(h),d=D(h,"secret"),p=D(h,"notations"),_=D(h,"cmp_op"),x=D(h,"target_number"),$.secret=d,$.notations=p,$.cmp_op=_,$.target_number=x}),z(B,"$eval",function(h,d){try{U("eval_return");var _,$,ae,Ae,xe,ke,x=this,se=re,Te=re,de=re,Fe=re,De=re,Me=re;return $=h.$round_type(),se=I(x.notations,"map",[],function(ce){return null==ce&&(ce=re),ce.$to_dice($)}),ae=Q(Te=x.cmp_op)?Te:h.$default_cmp_op(),Ae=Q(Te=(_=x.target_number)===re||null==_?re:_.$eval($))?Te:h.$default_target_number(),de=I(se,"map",[],function(ce){return null==ce&&(ce=re),ce.$roll(d)}),Q(h["$sort_barabara_dice?"]())&&I(de,"map!",[],"sort".$to_proc()),xe=(Fe=de.$flatten()).$count(1),ke=Q(ae)?I(Fe,"count",[],function(ce){return null==ce&&(ce=re),ce.$send(ae,Ae)}):0,Q(ae)&&(De="\u6210\u529f\u6570"+ke),Me=["("+se.$join("+")+m("Format").$comparison_operator(ae)+Ae+")",Fe.$join(","),De,h.$grich_text(xe,Fe.$size(),ke)].$compact(),I(m("Result").$new(),"tap",[],function _e(ce){var pe,ye=null==_e.$$s?this:_e.$$s;return null==ye.secret&&(ye.secret=re),null==ce&&(ce=re),ce["$secret="](ye.secret),ce["$text="](Me.$join(" \uff1e ")),ce["$last_dice_list_list="](de),ce["$last_dice_list="](Fe),I(ce,"success_num=",pe=[ke]),pe[pe.length-1]},{$$s:x})}catch(_e){if(_e===f.t_eval_return)return _e.$v;throw _e}}),function(ne,F,he){var B=te(ne,null,"Notation"),O=[B].concat(he),m=f.$r(O),l=B.$$prototype;l.times=l.sides=re,z(B,"$initialize",function(h,d){return this.times=h,this.sides=d}),z(B,"$to_dice",function(h){try{var _,x;return U("eval_return"),_=this.times.$eval(h),x=this.sides.$eval(h),m("Dice").$new(_,x)}catch($){if($===f.t_eval_return)return $.$v;throw $}})}(L[0],0,L),function(ne,F){var he=te(ne,null,"Dice"),B=he.$$prototype;return B.times=B.sides=re,z(he,"$initialize",function(m,l){return this.times=m,this.sides=l}),z(he,"$roll",function(m){return m.$roll_barabara(this.times,this.sides)}),z(he,"$to_s",function(){return this.times+"B"+this.sides})}(L[0])},Opal.modules["bcdice/common_command/reroll_dice/parser"]=function(f){var Z,R,M,he,h,d,p,_,x,$,se,ae,Te,Fe,B,l,c,P,L,H,X,S=f.module,te=f.klass,v=f.defs,D=f.def,z=f.hash,I=f.const_set,Q=f.truthy,U=f.hash2,N=f.return_val,G=f.to_ary,re=f.top,q=[],E=f.nil,V=f.$$$;return re.$require("racc/parser.rb"),re.$require("bcdice/common_command/lexer"),re.$require("bcdice/common_command/barabara_dice/node"),re.$require("bcdice/arithmetic/node"),Z=q,R=X=[S(q[0],"BCDice")].concat(Z),M=H=[S(X[0],"CommonCommand")].concat(R),P=[S(H[0],"RerollDice")].concat(M),L=f.$r(P),he=P,l=[B=te(P[0],V(L("Racc"),"Parser"),"Parser")].concat(he),c=f.$r(l),B.$$prototype.lexer=E,v(B,"$parse",function(_e){return this.$new().$parse(_e)}),D(B,"$parse",function(_e){try{return this.lexer=c("Lexer").$new(_e),this.$do_parse()}catch(pe){if(!f.rescue(pe,[c("ParseError")]))throw pe;try{return E}finally{f.pop_exception()}}}),B.$private(),D(B,"$next_token",function(){return this.lexer.$next_token()}),h=f.large_array_unpack("9,3,9,9,9,15,20,21,20,21,8,14,8,8,8,9,9,4,13,28,10,39,20,21,9,8,8,31,32,9,20,21,33,16,8,20,21,9,24,8,34,35,9,20,21,31,32,8,20,21,9,13,8,31,32,9,20,21,34,35,8,20,21,9,,8,34,35,9,20,21,31,32,8,20,21,9,,8,,31,32,20,21,31,32,8,40,,,,47,51,49,50,52"),d=f.large_array_unpack("14,0,24,2,15,5,14,14,24,24,14,5,24,2,15,16,8,1,5,14,4,24,8,8,13,16,8,17,17,20,13,13,17,7,13,20,20,21,11,20,18,18,28,21,21,26,26,21,28,28,31,12,28,38,38,32,31,31,42,42,31,32,32,34,,32,43,43,35,34,34,46,46,34,35,35,39,,35,,27,27,39,39,41,41,39,27,,,,41,45,45,45,45"),p=f.large_array_unpack("-6,17,1,,20,-3,,30,14,,,18,30,22,-2,2,13,19,30,,27,35,,,0,,37,72,40,,,48,53,,61,66,,,45,74,,76,48,56,,89,63,,,,,,"),_=f.large_array_unpack("-4,-31,-31,-5,-31,-6,-13,-31,-31,-30,53,-1,-6,-31,-31,-31,-31,-31,-17,-20,-31,-31,-28,-3,-31,-2,-7,-31,-31,-12,-14,-31,-31,-29,-31,-31,-26,-27,-10,-31,-8,-31,-15,-16,-18,-21,-11,-9,-19,-22,-23,-24,-25"),x=[17,7,11,36,37,26,27,1,6,25,42,43,2,5,7,30,38,44,45,12,41,29,23,48,E,E,E,E,E,E,E,46],$=[7,9,4,11,11,7,7,1,8,4,10,10,2,3,9,9,7,11,11,5,7,8,6,12,E,E,E,E,E,E,E,7],se=[E,7,12,11,-3,14,11,-8,6,-1,-21,-17,-22],ae=[E,E,E,E,E,E,E,E,E,22,18,19,E],Te=f.large_array_unpack("0,0,racc_error,3,23,_reduce_1,4,23,_reduce_2,4,23,_reduce_3,0,24,_reduce_4,1,24,_reduce_5,0,26,_reduce_6,2,26,_reduce_7,3,27,_reduce_8,4,27,_reduce_9,2,28,_reduce_10,3,28,_reduce_11,3,25,_reduce_12,1,25,_reduce_13,3,30,_reduce_14,3,29,_reduce_15,3,29,_reduce_16,1,29,_reduce_none,3,32,_reduce_18,4,32,_reduce_19,1,32,_reduce_none,0,34,_reduce_21,1,34,_reduce_22,1,34,_reduce_23,1,34,_reduce_24,1,34,_reduce_25,2,33,_reduce_26,2,33,_reduce_27,1,33,_reduce_none,3,31,_reduce_29,1,31,_reduce_30"),Fe=z(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13,"BRACKETL",14,"BRACKETR",15,"LESS",16,"GREATER",17,"EQUAL",18,"NOT",19,"AT",20,"CMP_OP",21),I(l[0],"Racc_arg",[h,d,_,p,x,$,ae,se,22,Te,Fe,53,31,!0]),Q(c("Ractor","skip_raise")?"constant":E)&&c("Ractor").$make_shareable(c("Racc_arg")),I(l[0],"Racc_token_to_s_table",f.large_array_unpack("$end,error,NUMBER,R,U,C,F,S,PLUS,MINUS,ASTERISK,SLASH,PARENL,PARENR,BRACKETL,BRACKETR,LESS,GREATER,EQUAL,NOT,AT,CMP_OP,$start,expr,secret,notations,target,bracket,at,add,dice,term,mul,unary,round_type")),Q(c("Ractor","skip_raise")?"constant":E)&&c("Ractor").$make_shareable(c("Racc_token_to_s_table")),I(l[0],"Racc_debug_parser",!1),D(B,"$_reduce_1",function(_e,ce,pe){return V(c("Node"),"Command").$new(U(["secret","notations","cmp_op","target_number","source"],{secret:_e["$[]"](0),notations:_e["$[]"](1),cmp_op:_e["$[]"](2)["$[]"]("cmp_op"),target_number:_e["$[]"](2)["$[]"]("target"),source:this.lexer.$source()}))}),D(B,"$_reduce_2",function(_e,ce,pe){var b=E,K=E;return b=_e["$[]"](3),K=_e["$[]"](2),V(c("Node"),"Command").$new(U(["secret","notations","cmp_op","target_number","reroll_cmp_op","reroll_threshold","source"],{secret:_e["$[]"](0),notations:_e["$[]"](1),cmp_op:b["$[]"]("cmp_op"),target_number:b["$[]"]("target"),reroll_cmp_op:K["$[]"]("cmp_op"),reroll_threshold:K["$[]"]("threshold"),source:this.lexer.$source()}))}),D(B,"$_reduce_3",function(_e,ce,pe){var b=E,K=E;return b=_e["$[]"](2),K=_e["$[]"](3),V(c("Node"),"Command").$new(U(["secret","notations","cmp_op","target_number","reroll_cmp_op","reroll_threshold","source"],{secret:_e["$[]"](0),notations:_e["$[]"](1),cmp_op:b["$[]"]("cmp_op"),target_number:b["$[]"]("target"),reroll_cmp_op:K["$[]"]("cmp_op"),reroll_threshold:K["$[]"]("threshold"),source:this.lexer.$source()}))}),D(B,"$_reduce_4",N(!1)),D(B,"$_reduce_5",N(!0)),D(B,"$_reduce_6",function(_e,ce,pe){return U([],{})}),D(B,"$_reduce_7",function(_e,ce,pe){var ye,ge,be;return be=null==(ye=G(_e))[1]?E:ye[1],Q(ge=null==ye[0]?E:ye[0])||this.$raise(c("ParseError")),U(["cmp_op","target"],{cmp_op:ge,target:be})}),D(B,"$_reduce_8",function(_e,ce,pe){return U(["threshold"],{threshold:_e["$[]"](1)})}),D(B,"$_reduce_9",function(_e,ce,pe){var b,K;return b=_e["$[]"](1),K=_e["$[]"](2),Q(b)||this.$raise(c("ParseError")),U(["cmp_op","threshold"],{cmp_op:b,threshold:K})}),D(B,"$_reduce_10",function(_e,ce,pe){return U(["threshold"],{threshold:_e["$[]"](1)})}),D(B,"$_reduce_11",function(_e,ce,pe){var b,K;return b=_e["$[]"](1),K=_e["$[]"](2),Q(b)||this.$raise(c("ParseError")),U(["cmp_op","threshold"],{cmp_op:b,threshold:K})}),D(B,"$_reduce_12",function(_e,ce,pe){var ye=E;return(ye=_e["$[]"](0)).$push(_e["$[]"](2)),ye}),D(B,"$_reduce_13",function(_e,ce,pe){return[_e["$[]"](0)]}),D(B,"$_reduce_14",function(_e,ce,pe){var ye,b;return ye=_e["$[]"](0),b=_e["$[]"](2),V(c("Node"),"Notation").$new(ye,b)}),D(B,"$_reduce_15",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"BinaryOp").$new(_e["$[]"](0),"+",_e["$[]"](2))}),D(B,"$_reduce_16",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"BinaryOp").$new(_e["$[]"](0),"-",_e["$[]"](2))}),D(B,"$_reduce_18",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"BinaryOp").$new(_e["$[]"](0),"*",_e["$[]"](2))}),D(B,"$_reduce_19",function(_e,ce,pe){return _e["$[]"](3).$new(_e["$[]"](0),_e["$[]"](2))}),D(B,"$_reduce_21",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),D(B,"$_reduce_22",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"DivideWithCeil")}),D(B,"$_reduce_23",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"DivideWithCeil")}),D(B,"$_reduce_24",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"DivideWithRound")}),D(B,"$_reduce_25",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"DivideWithFloor")}),D(B,"$_reduce_26",function(_e,ce,pe){return _e["$[]"](1)}),D(B,"$_reduce_27",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"Negative").$new(_e["$[]"](1))}),D(B,"$_reduce_29",function(_e,ce,pe){return _e["$[]"](1)}),D(B,"$_reduce_30",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"Number").$new(_e["$[]"](0))}),D(B,"$_reduce_none",function(_e,ce,pe){return _e["$[]"](0)})},Opal.modules["bcdice/common_command/reroll_dice"]=function(f){var N,E,Y,R,H,A,X,k,le,re,S=f.module,te=f.const_set,v=f.thrower,D=f.def,z=f.top,I=[],Q=f.nil;return z.$require("bcdice/normalize"),z.$require("bcdice/format"),z.$require("bcdice/common_command/reroll_dice/parser"),N=I,E=re=[S(I[0],"BCDice")].concat(N),Y=le=[S(re[0],"CommonCommand")].concat(E),te((k=[X=S(le[0],"RerollDice")].concat(Y))[0],"PREFIX_PATTERN",/\d+R\d+/.$freeze()),te(k[0],"REROLL_LIMIT",1e4),H=[R=f.get_singleton_class(X)].concat(k),A=f.$r(H),D(R,"$eval",function(C,P,L){try{var F;return v("eval_return"),(F=A("Parser").$parse(C))===Q||null==F?Q:F.$eval(P,L)}catch(B){if(B===f.t_eval_return)return B.$v;throw B}})},Opal.modules["bcdice/common_command/upper_dice/node"]=function(f){var Y,ee,C,F,l,c,h,d,p,B,L,A,k,S=f.module,te=f.klass,v=f.ensure_kwargs,D=f.get_kwarg,z=f.def,I=f.send,Q=f.truthy,U=f.rb_le,N=f.thrower,G=f.rb_plus,re=f.eqeq,q=f.hash2,E=f.rb_lt,V=[],le=f.nil;return Y=V,ee=k=[S(V[0],"BCDice")].concat(Y),C=A=[S(k[0],"CommonCommand")].concat(ee),F=L=[S(A[0],"UpperDice")].concat(C),l=B=[S(L[0],"Node")].concat(F),h=[c=te(B[0],null,"Command")].concat(l),d=f.$r(h),(p=c.$$prototype).notations=p.reroll_threshold=p.modifier=p.target_number=p.cmp_op=le,z(c,"$initialize",function(x){var $,se,ae,Te,Ae,de,Fe=this;return x=v(x),$=D(x,"secret"),se=D(x,"notations"),ae=D(x,"modifier"),Te=D(x,"cmp_op"),Ae=D(x,"target_number"),null==(de=x.$$smap.reroll_threshold)&&(de=le),Fe.secret=$,Fe.notations=se,Fe.modifier=ae,Fe.cmp_op=Te,Fe.target_number=Ae,Fe.reroll_threshold=de}),z(c,"$eval",function(x,$){try{N("eval_return");var ae,Te,Ae,Fe,xe,ke,_e,pe,Me,ce,de=this,De=le,ye=le,b=le,K=le;return Fe=x.$round_type(),xe=I(de.notations,"map",[],function(be){return null==be&&(be=le),be.$to_dice(Fe)}),ke=Q(De=Q(Me=(ae=de.reroll_threshold)===le||null==ae?le:ae.$eval(Fe))?Me:x.$upper_dice_reroll_threshold())?De:0,_e=Q(De=(Te=de.modifier)===le||null==Te?le:Te.$eval(Fe))?De:0,ce=(Ae=de.target_number)===le||null==Ae?le:Ae.$eval(Fe),pe=de.$expr(xe,ke,_e,ce),Q(U(ke,1))?de.$result_with_text("("+pe+") \uff1e \u7121\u9650\u30ed\u30fc\u30eb\u306e\u6761\u4ef6\u304c\u307e\u3061\u304c\u3063\u3066\u3044\u307e\u3059"):(ye=I(xe,"map",[],function(be){return null==be&&(be=le),be.$roll($,ke,x["$sort_barabara_dice?"]())}).$reduce([],"concat"),b=Q(de.cmp_op)?de.$result_success_count(ye,_e,ce):de.$result_max_sum(ye,_e),K=["("+pe+")",de.$interlim_expr(ye,_e),b],de.$result_with_text(K.$join(" \uff1e ")))}catch(ge){if(ge===f.t_eval_return)return ge.$v;throw ge}}),c.$private(),z(c,"$result_success_count",function(x,$,se){return"\u6210\u529f\u6570"+I(x,"count",[],function Ae(de){var Fe=null==Ae.$$s?this:Ae.$$s;return null==Fe.cmp_op&&(Fe.cmp_op=le),null==de&&(de=le),G(de["$[]"]("sum"),$).$send(Fe.cmp_op,se)},{$$s:this})}),z(c,"$result_max_sum",function(x,$){var ae,se=le;return se=I(x,"map",[],function(de){return null==de&&(de=le),de["$[]"]("sum")}),ae=G(se.$sum(),$),I(se,"map",[],function(de){return null==de&&(de=le),G(de,$)}).$max()+"/"+ae+"(\u6700\u5927/\u5408\u8a08)"}),z(c,"$interlim_expr",function(x,$){var se;return se=I(x,"map",[],function(Te){return null==Te&&(Te=le),re(Te["$[]"]("list").$size(),1)?Te["$[]"]("sum"):Te["$[]"]("sum")+"["+Te["$[]"]("list").$join(",")+"]"}).$join(","),G(se,d("Format").$modifier($))}),z(c,"$expr",function(x,$,se,ae){var Ae,de;return Ae=d("Format").$comparison_operator(this.cmp_op),de=d("Format").$modifier(se),x.$join("+")+"["+$+"]"+de+Ae+ae}),z(c,"$result_with_text",function(x){return I(d("Result").$new(),"tap",[],function se(ae){var Te,Ae=null==se.$$s?this:se.$$s;return null==Ae.secret&&(Ae.secret=le),null==ae&&(ae=le),ae["$secret="](Ae.secret),I(ae,"text=",Te=[x]),Te[Te.length-1]},{$$s:this})}),function(O,m,l){var c=te(O,null,"Notation"),h=[c].concat(l),d=f.$r(h),p=c.$$prototype;p.roll_times=p.sides=le,z(c,"$initialize",function(x,$){return this.roll_times=x,this.sides=$}),z(c,"$to_dice",function(x){try{var ae,Te;return N("eval_return"),ae=this.roll_times.$eval(x),Te=this.sides.$eval(x),d("Dice").$new(ae,Te)}catch(Ae){if(Ae===f.t_eval_return)return Ae.$v;throw Ae}})}(B[0],0,B),function(O,m,l){var c=te(O,null,"Dice"),h=[c].concat(l),d=f.$r(h),p=c.$$prototype;return p.roll_times=p.sides=le,z(c,"$initialize",function(x,$){return this.roll_times=x,this.sides=$}),z(c,"$roll",function(x,$,se){var Te=le;return Te=I(d("Array"),"new",[this.roll_times],function Ae(){var Fe=le;return Fe=(null==Ae.$$s?this:Ae.$$s).$roll_ones(x,$),q(["sum","list"],{sum:Fe.$sum(),list:Fe})},{$$s:this}),Q(se)&&(Te=I(Te,"sort_by",[],function(de){return null==de&&(de=le),de["$[]"]("sum")})),Te}),z(c,"$to_s",function(){return this.roll_times+"U"+this.sides}),c.$private(),z(c,"$roll_ones",function(x,$){var se=this,ae=le;return ae=[],function(){try{var Te=N("break");I(se,"loop",[],function Ae(){var Fe,de=null==Ae.$$s?this:Ae.$$s;if(null==de.sides&&(de.sides=le),Fe=x.$roll_once(de.sides),ae.$push(Fe),!Q(E(Fe,$)))return le;Te.$throw()},{$$s:se})}catch(Ae){if(Ae===Te)return Ae.$v;throw Ae}}(),ae})}(B[0],0,B)},Opal.modules["bcdice/common_command/upper_dice/parser"]=function(f){var Z,R,M,he,h,d,p,_,x,$,se,ae,Te,Fe,B,l,c,P,L,H,X,S=f.module,te=f.klass,v=f.defs,D=f.def,z=f.hash,I=f.const_set,Q=f.truthy,U=f.hash2,N=f.return_val,G=f.to_ary,re=f.top,q=[],E=f.nil,V=f.$$$;return re.$require("racc/parser.rb"),re.$require("bcdice/common_command/lexer"),re.$require("bcdice/common_command/upper_dice/node"),re.$require("bcdice/arithmetic/node"),Z=q,R=X=[S(q[0],"BCDice")].concat(Z),M=H=[S(X[0],"CommonCommand")].concat(R),P=[S(H[0],"UpperDice")].concat(M),L=f.$r(P),he=P,l=[B=te(P[0],V(L("Racc"),"Parser"),"Parser")].concat(he),c=f.$r(l),B.$$prototype.lexer=E,v(B,"$parse",function(_e){return this.$new().$parse(_e)}),D(B,"$parse",function(_e){try{return this.lexer=c("Lexer").$new(_e),this.$do_parse()}catch(pe){if(!f.rescue(pe,[c("ParseError")]))throw pe;try{return E}finally{f.pop_exception()}}}),B.$private(),D(B,"$next_token",function(){return this.lexer.$next_token()}),h=f.large_array_unpack("9,9,36,37,3,9,9,21,22,49,8,8,21,22,9,8,8,14,15,9,21,22,4,16,8,21,22,9,10,8,36,37,9,21,22,38,17,8,21,22,9,25,8,27,15,9,21,22,28,29,8,21,22,9,44,8,39,40,9,21,22,39,40,8,21,22,9,25,8,39,40,9,21,22,36,37,8,21,22,9,17,8,39,40,9,21,22,39,40,8,21,22,9,,8,39,40,,21,22,39,40,8,58,56,57,59,36,37"),d=f.large_array_unpack("2,8,34,34,0,17,14,8,8,34,2,8,14,14,15,17,14,5,5,16,15,15,1,5,15,16,16,21,4,16,18,18,22,21,21,18,7,21,22,22,25,11,22,12,12,27,25,25,13,13,25,27,27,28,24,27,19,19,29,28,28,30,30,28,29,29,36,26,29,33,33,37,36,36,45,45,36,37,37,39,32,37,47,47,40,39,39,48,48,39,40,40,44,,40,50,50,,44,44,51,51,44,53,53,53,53,54,54"),p=f.large_array_unpack("-3,22,-2,,28,9,,32,-1,,,20,35,40,4,12,17,3,22,46,,25,30,,34,38,46,43,51,56,51,,76,59,-6,,64,69,,77,82,,,,90,66,,72,77,,85,90,,100,99,,,,,"),_=f.large_array_unpack("-4,-35,-35,-5,-35,-6,-17,-35,-35,-34,60,-12,-6,-7,-35,-35,-35,-35,-35,-21,-24,-35,-35,-32,-1,-35,-12,-35,-35,-35,-8,-16,-32,-9,-35,-18,-35,-35,-33,-35,-35,-30,-31,-3,-35,-13,-2,-10,-11,-14,-19,-20,-22,-25,-15,-23,-26,-27,-28,-29"),x=f.large_array_unpack("18,30,33,41,42,24,6,1,34,2,5,12,11,7,30,47,48,45,31,26,46,52,53,50,51,32,43,55,35,,,,,,,,54"),$=f.large_array_unpack("10,9,9,13,13,5,11,1,10,2,3,6,4,12,9,9,9,10,11,4,5,13,13,9,9,12,7,14,12,,,,,,,,10"),se=[E,7,9,8,7,-6,6,2,E,-13,-8,4,11,-18,-26],ae=[E,E,E,E,E,E,E,E,13,19,E,E,23,20,E],Te=f.large_array_unpack("0,0,racc_error,4,23,_reduce_1,5,23,_reduce_2,5,23,_reduce_3,0,24,_reduce_4,1,24,_reduce_5,0,26,_reduce_6,1,26,_reduce_7,2,30,_reduce_8,2,30,_reduce_9,3,30,_reduce_10,3,30,_reduce_11,0,27,_reduce_12,2,27,_reduce_13,3,28,_reduce_14,2,29,_reduce_15,3,25,_reduce_16,1,25,_reduce_17,3,33,_reduce_18,3,32,_reduce_19,3,32,_reduce_20,1,32,_reduce_none,3,31,_reduce_22,4,31,_reduce_23,1,31,_reduce_none,0,36,_reduce_25,1,36,_reduce_26,1,36,_reduce_27,1,36,_reduce_28,1,36,_reduce_29,2,35,_reduce_30,2,35,_reduce_31,1,35,_reduce_none,3,34,_reduce_33,1,34,_reduce_34"),Fe=z(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13,"BRACKETL",14,"BRACKETR",15,"LESS",16,"GREATER",17,"EQUAL",18,"NOT",19,"AT",20,"CMP_OP",21),I(l[0],"Racc_arg",[h,d,_,p,x,$,ae,se,22,Te,Fe,60,35,!0]),Q(c("Ractor","skip_raise")?"constant":E)&&c("Ractor").$make_shareable(c("Racc_arg")),I(l[0],"Racc_token_to_s_table",f.large_array_unpack("$end,error,NUMBER,R,U,C,F,S,PLUS,MINUS,ASTERISK,SLASH,PARENL,PARENR,BRACKETL,BRACKETR,LESS,GREATER,EQUAL,NOT,AT,CMP_OP,$start,expr,secret,notations,modifier,target,bracket,at,modifier_expr,mul,add,dice,term,unary,round_type")),Q(c("Ractor","skip_raise")?"constant":E)&&c("Ractor").$make_shareable(c("Racc_token_to_s_table")),I(l[0],"Racc_debug_parser",!1),D(B,"$_reduce_1",function(_e,ce,pe){return V(V(c("UpperDice"),"Node"),"Command").$new(U(["secret","notations","modifier","cmp_op","target_number"],{secret:_e["$[]"](0),notations:_e["$[]"](1),modifier:_e["$[]"](2),cmp_op:_e["$[]"](3)["$[]"]("cmp_op"),target_number:_e["$[]"](3)["$[]"]("target")}))}),D(B,"$_reduce_2",function(_e,ce,pe){return V(V(c("UpperDice"),"Node"),"Command").$new(U(["secret","notations","modifier","cmp_op","target_number","reroll_threshold"],{secret:_e["$[]"](0),notations:_e["$[]"](1),modifier:_e["$[]"](3),cmp_op:_e["$[]"](4)["$[]"]("cmp_op"),target_number:_e["$[]"](4)["$[]"]("target"),reroll_threshold:_e["$[]"](2)}))}),D(B,"$_reduce_3",function(_e,ce,pe){return V(V(c("UpperDice"),"Node"),"Command").$new(U(["secret","notations","modifier","cmp_op","target_number","reroll_threshold"],{secret:_e["$[]"](0),notations:_e["$[]"](1),modifier:_e["$[]"](2),cmp_op:_e["$[]"](3)["$[]"]("cmp_op"),target_number:_e["$[]"](3)["$[]"]("target"),reroll_threshold:_e["$[]"](4)}))}),D(B,"$_reduce_4",N(!1)),D(B,"$_reduce_5",N(!0)),D(B,"$_reduce_6",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"Number").$new(0)}),D(B,"$_reduce_7",function(_e,ce,pe){return _e["$[]"](0)}),D(B,"$_reduce_8",function(_e,ce,pe){return _e["$[]"](1)}),D(B,"$_reduce_9",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"Negative").$new(_e["$[]"](1))}),D(B,"$_reduce_10",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"BinaryOp").$new(_e["$[]"](0),"+",_e["$[]"](2))}),D(B,"$_reduce_11",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"BinaryOp").$new(_e["$[]"](0),"-",_e["$[]"](2))}),D(B,"$_reduce_12",function(_e,ce,pe){return U([],{})}),D(B,"$_reduce_13",function(_e,ce,pe){var ye,ge,be;return be=null==(ye=G(_e))[1]?E:ye[1],Q(ge=null==ye[0]?E:ye[0])||this.$raise(c("ParseError")),U(["cmp_op","target"],{cmp_op:ge,target:be})}),D(B,"$_reduce_14",function(_e,ce,pe){return _e["$[]"](1)}),D(B,"$_reduce_15",function(_e,ce,pe){return _e["$[]"](1)}),D(B,"$_reduce_16",function(_e,ce,pe){var ye=E;return(ye=_e["$[]"](0)).$push(_e["$[]"](2)),ye}),D(B,"$_reduce_17",function(_e,ce,pe){return[_e["$[]"](0)]}),D(B,"$_reduce_18",function(_e,ce,pe){var ye,b;return ye=_e["$[]"](0),b=_e["$[]"](2),V(V(c("UpperDice"),"Node"),"Notation").$new(ye,b)}),D(B,"$_reduce_19",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"BinaryOp").$new(_e["$[]"](0),"+",_e["$[]"](2))}),D(B,"$_reduce_20",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"BinaryOp").$new(_e["$[]"](0),"-",_e["$[]"](2))}),D(B,"$_reduce_22",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"BinaryOp").$new(_e["$[]"](0),"*",_e["$[]"](2))}),D(B,"$_reduce_23",function(_e,ce,pe){return _e["$[]"](3).$new(_e["$[]"](0),_e["$[]"](2))}),D(B,"$_reduce_25",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),D(B,"$_reduce_26",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"DivideWithCeil")}),D(B,"$_reduce_27",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"DivideWithCeil")}),D(B,"$_reduce_28",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"DivideWithRound")}),D(B,"$_reduce_29",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"DivideWithFloor")}),D(B,"$_reduce_30",function(_e,ce,pe){return _e["$[]"](1)}),D(B,"$_reduce_31",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"Negative").$new(_e["$[]"](1))}),D(B,"$_reduce_33",function(_e,ce,pe){return _e["$[]"](1)}),D(B,"$_reduce_34",function(_e,ce,pe){return V(V(c("Arithmetic"),"Node"),"Number").$new(_e["$[]"](0))}),D(B,"$_reduce_none",function(_e,ce,pe){return _e["$[]"](0)})},Opal.modules["bcdice/common_command/upper_dice"]=function(f){var N,E,Y,R,H,A,X,k,le,re,S=f.module,te=f.const_set,v=f.thrower,D=f.def,I=[],Q=f.nil;return f.top.$require("bcdice/common_command/upper_dice/parser"),N=I,E=re=[S(I[0],"BCDice")].concat(N),Y=le=[S(re[0],"CommonCommand")].concat(E),te((k=[X=S(le[0],"UpperDice")].concat(Y))[0],"PREFIX_PATTERN",/\d+U\d+/.$freeze()),H=[R=f.get_singleton_class(X)].concat(k),A=f.$r(H),D(R,"$eval",function(C,P,L){try{var F;return v("eval_return"),(F=A("Parser").$parse(C))===Q||null==F?Q:F.$eval(P,L)}catch(B){if(B===f.t_eval_return)return B.$v;throw B}})},Opal.modules["bcdice/common_command/version"]=function(f){var G,V,X,ee,A,M,k,R,Z,q,S=f.module,te=f.const_set,v=f.truthy,D=f.send,z=f.def,I=[],Q=f.nil,U=f.$$$;return G=I,V=q=[S(I[0],"BCDice")].concat(G),X=Z=[S(q[0],"CommonCommand")].concat(V),te((R=[k=S(Z[0],"Version")].concat(X))[0],"PREFIX_PATTERN",/BCDiceVersion/.$freeze()),A=[ee=f.get_singleton_class(k)].concat(R),M=f.$r(A),z(ee,"$eval",function(P,L,ne){return P=P.$split(" ",2).$first(),v(P["$match?"](/^BCDiceVersion$/i))?D(M("Result").$new(),"tap",[],function(he){var B;return null==he&&(he=Q),B=["BCDice "+U(M("BCDice"),"VERSION")],D(he,"text=",B),B[B.length-1]}):Q})},Opal.queue(function(f){var Q,re,E,V,N,S=f.module,te=f.const_set,v=f.top,D=[];return v.$require("bcdice/common_command/add_dice"),v.$require("bcdice/common_command/barabara_dice"),v.$require("bcdice/common_command/tally_dice"),v.$require("bcdice/common_command/calc"),v.$require("bcdice/common_command/choice"),v.$require("bcdice/common_command/d66_dice"),v.$require("bcdice/common_command/repeat"),v.$require("bcdice/common_command/reroll_dice"),v.$require("bcdice/common_command/upper_dice"),v.$require("bcdice/common_command/version"),Q=D,re=N=[S(D[0],"BCDice")].concat(Q),E=[S(N[0],"CommonCommand")].concat(re),V=f.$r(E),te(E[0],"COMMANDS",[V("AddDice"),V("BarabaraDice"),V("TallyDice"),V("Calc"),V("Choice"),V("D66Dice"),V("Repeat"),V("RerollDice"),V("UpperDice"),V("Version")].$freeze())})},9993:function(){(function(T){"use strict";var fe;if("undefined"!=typeof globalThis?T=globalThis:"undefined"!=typeof global?T=global:"undefined"!=typeof window&&(T=window),null==T.console&&(T.console={}),"log"in(fe="object"==typeof T.console?T.console:{})||(fe.log=function(){}),"warn"in fe||(fe.warn=fe.log),void 0!==T.Opal)return fe.warn("Opal already loaded. Loading twice can cause troubles, please fix your setup."),T.Opal;var Ce,f,S,te,v,D,z,I=T.Opal={};I.global=T,I.config={missing_require_severity:"error",unsupported_features_severity:"warning",experimental_features_severity:"warning",enable_stack_trace:!0};var Q=Function.prototype.call,U=Function.prototype.bind,N=Object.hasOwn||Q.bind(Object.prototype.hasOwnProperty),G=Object.setPrototypeOf,re=Q.bind(Array.prototype.slice),q=Q.bind(Array.prototype.splice),V=4;function le(){return V+=2}I.uid=le,I.id=function(b){return b.$$is_number?2*b+1:(null==b.$$id&&X(b,"$$id",le()),b.$$id)};var Z=I.gvars={};function Y(b,K){if(b||(b=I.Exception||Error),!z||!z.$raise)throw b.$new?b.$new(K):new b(K);arguments.length>2?z.$raise(b.$new.apply(b,re(arguments,1))):z.$raise(b,K)}function X(b,K,ge){"string"==typeof b?b[K]=ge:Object.defineProperty(b,K,{value:ge,enumerable:!1,configurable:!0,writable:!0})}I.exit=function(b){Z.DEBUG&&fe.log("Exited with status "+b)},I.exceptions=[],I.pop_exception=function(){var b=I.exceptions.pop();b?(Z["!"]=b,Z["@"]=b.$backtrace()):Z["!"]=Z["@"]=Ce},I.prop=X,I.defineProperty=I.prop,I.slice=re;var k=I.truthy=function(b){return!(!1===b||Ce===b||null==b||b instanceof Boolean&&!0!==b.valueOf())};function R(b){var K,ge,be;for(K=0,ge=I.tracers_for_class.length;K<ge;K++)(be=I.tracers_for_class[K]).trace_object=b,be.block.$call(be)}function ee(b,K){if(b.$$autoload[K].loaded){if(b.$$autoload[K].loaded&&!b.$$autoload[K].required&&b.$$autoload[K].exception)throw b.$$autoload[K].exception}else{b.$$autoload[K].loaded=!0;try{I.Kernel.$require(b.$$autoload[K].path)}catch(ge){throw b.$$autoload[K].exception=ge,ge}if(b.$$autoload[K].required=!0,null!=b.$$const[K])return b.$$autoload[K].success=!0,b.$$const[K]}}function H(b,K){if(b){if(null!=b.$$const[K])return b.$$const[K];if(b.$$autoload&&b.$$autoload[K])return ee(b,K)}}function M(b,K){var ge,be,Pe;if(null!=b)for(ge=0,be=(Pe=ae(b)).length;ge<be;ge++){if(Pe[ge].$$const&&N(Pe[ge].$$const,K))return Pe[ge].$$const[K];if(Pe[ge].$$autoload&&Pe[ge].$$autoload[K])return ee(Pe[ge],K)}}function P(b,K){return(b||S).$const_missing(K)}function L(b,K,ge){var be=!0;return(null==b||"::"===b)&&(b=S),ge.$$is_a_module&&((null==ge.$$name||ge.$$name===Ce)&&(ge.$$name=K),null==ge.$$base_module&&(ge.$$base_module=b)),b.$$const=b.$$const||Object.create(null),(K in b.$$const||"$$autoload"in b&&K in b.$$autoload)&&(be=!1),b.$$const[K]=ge,b.$$=b.$$const,I.const_cache_version++,b===S&&(I[K]=ge),X(b,K,ge),be&&b.$const_added&&!b.$const_added.$$pristine&&b.$const_added(K),ge}function ne(b,K,ge){var be;if(be=null!=K&&K.$$bridge?function(){var nt=re(arguments),vt=new(U.apply(K.$$constructor,[null].concat(nt)));return G(vt,be.$$prototype),vt}:function(){},b&&b!==Ce&&X(be,"displayName","::"+b),X(be,"$$name",b),X(be,"$$constructor",be),X(be,"$$prototype",be.prototype),X(be,"$$const",{}),X(be,"$$is_class",!0),X(be,"$$is_a_module",!0),X(be,"$$super",K),X(be,"$$cvars",{}),X(be,"$$own_included_modules",[]),X(be,"$$own_prepended_modules",[]),X(be,"$$ancestors",[]),X(be,"$$ancestors_cache_version",null),X(be,"$$subclasses",[]),X(be.$$prototype,"$$class",be),I.Class&&G(be,I.Class.prototype),null!=K){if(G(be.$$prototype,K.$$prototype),!0!==ge)if("undefined"!=typeof WeakRef){var Pe,Ue,Ye=[];for(Pe=0;Pe<K.$$subclasses.length;Pe++)void 0!==(Ue=K.$$subclasses[Pe]).deref()&&Ye.push(Ue);Ye.push(new WeakRef(be)),K.$$subclasses=Ye}else K.$$subclasses.push(be);K.$$meta&&I.build_class_singleton_class(be)}return be}function B(b){var K=function(){},ge=K;return b&&X(K,"displayName",b+".constructor"),X(ge,"$$name",b),X(ge,"$$prototype",K.prototype),X(ge,"$$const",{}),X(ge,"$$is_module",!0),X(ge,"$$is_a_module",!0),X(ge,"$$cvars",{}),X(ge,"$$iclasses",[]),X(ge,"$$own_included_modules",[]),X(ge,"$$own_prepended_modules",[]),X(ge,"$$ancestors",[ge]),X(ge,"$$ancestors_cache_version",null),G(ge,I.Module.prototype),ge}function m(b,K){b.hasOwnProperty("$$meta")?b.$$meta=K:X(b,"$$meta",K),b.$$frozen?b.$$meta.$freeze():G(b,K.$$prototype)}function l(b){return b.hasOwnProperty("$$iclass")&&b.hasOwnProperty("$$root")}function p(b){var K=_(b);return b.$$is_module&&b.$$iclasses.push(K),K}function _(b){var K={},ge=b.$$prototype;ge.hasOwnProperty("$$dummy")&&(ge=ge.$$define_methods_on);var Ue,be=Object.getOwnPropertyNames(ge),Pe=be.length;for(Ue=0;Ue<Pe;Ue++){var Ye=be[Ue];X(K,Ye,ge[Ye])}return X(K,"$$iclass",!0),X(K,"$$module",b),K}function x(b){var K=b.length,ge=b[0];if(X(ge,"$$root",!0),1===K)return{first:ge,last:ge};for(var be=ge,Pe=1;Pe<K;Pe++){var Ue=b[Pe];G(be,Ue),be=Ue}return{first:b[0],last:b[K-1]}}function $(b){if(!b.hasOwnProperty("$$dummy")){if(b.hasOwnProperty("$$iclass"))return b.$$module;if(b.hasOwnProperty("$$class"))return b.$$class}}function ae(b){if(!b)return[];if(b.$$ancestors_cache_version===I.const_cache_version)return b.$$ancestors;var ge,be,Pe,K=[];for(ge=0,be=function se(b){return b.$$own_prepended_modules.concat([b]).concat(b.$$own_included_modules)}(b),Pe=be.length;ge<Pe;ge++)K.push(be[ge]);if(b.$$super)for(ge=0,Pe=(be=ae(b.$$super)).length;ge<Pe;ge++)K.push(be[ge]);return b.$$ancestors_cache_version=I.const_cache_version,b.$$ancestors=K,K}function Te(b){return b.hasOwnProperty("$$meta")&&null!==b.$$meta?ae(b.$$meta):ae(b.$$class)}function Ae(b,K){"number"==typeof K?b.$$arity=K:"object"==typeof K&&Object.assign(b,K)}I.falsy=function(b){return!k(b)},I.type_error=function(b,K,ge,be){b=b.$$class,Y(I.TypeError,be&&ge?"can't convert "+b+" into "+K+" ("+b+"#"+ge+" gives "+(be=be.$$class)+")":"no implicit conversion of "+b+" into "+K)},I.coerce_to=function(b,K,ge,be){var Pe;return"to_int"===ge&&K===I.Integer&&b.$$is_number?b<0?Math.ceil(b):Math.floor(b):"to_str"===ge&&K===I.String&&b.$$is_string||I.is_a(b,K)?b:b["$respond_to?"].$$pristine&&b.$method_missing.$$pristine?((null==(Pe=b[Fe(ge)])||Pe.$$stub)&&I.type_error(b,K),Pe.apply(b,be)):(b["$respond_to?"](ge)||I.type_error(b,K),null==be&&(be=[]),I.send(b,ge,be))},I.respond_to=function(b,K,ge){if(null==b||!b.$$class)return!1;ge=!!ge;var be=b[K];return b["$respond_to?"].$$pristine?"function"==typeof be&&!be.$$stub||(b["$respond_to_missing?"].$$pristine?void 0:I.send(b,b["$respond_to_missing?"],[K.substr(1),ge])):I.send(b,b["$respond_to?"],[K.substr(1),ge])},I.trace_class=!1,I.tracers_for_class=[],I.const_get_local=function(b,K,ge){var be;if(null!=b)return"::"===b&&(b=S),!b.$$is_module&&!b.$$is_class&&Y(I.TypeError,b.toString()+" is not a class/module"),null!=(be=H(b,K))||ge?be:P(b,K)},I.const_get_qualified=function(b,K,ge){var be,Pe,Ue,Ye=I.const_cache_version;return null==K?null!=(be=H(S,b))?be:I.const_get_qualified(S,b,ge):null!=b?("::"===b&&(b=S),!b.$$is_module&&!b.$$is_class&&Y(I.TypeError,b.toString()+" is not a class/module"),null==(Pe=b.$$const_cache)&&(X(b,"$$const_cache",Object.create(null)),Pe=b.$$const_cache),null==(Ue=Pe[K])||Ue[0]!==Ye?(null!=(be=H(b,K))||(be=M(b,K)),Pe[K]=[Ye,be]):be=Ue[1],null!=be||ge?be:P(b,K)):void 0},I.const_cache_version=1,I.const_get_relative=function(b,K,ge){var Pe,Ye,nt,be=b[0],Ue=I.const_cache_version;return null==(Ye=b.$$const_cache)&&(X(b,"$$const_cache",Object.create(null)),Ye=b.$$const_cache),null==(nt=Ye[K])||nt[0]!==Ue?(null!=(Pe=H(be,K))||null!=(Pe=function A(b,K){var ge,be,Pe;if(0!==b.length)for(ge=0,be=b.length;ge<be;ge++){if(null!=(Pe=b[ge].$$const[K]))return Pe;if(b[ge].$$autoload&&b[ge].$$autoload[K])return ee(b[ge],K)}}(b,K))||null!=(Pe=M(be,K))||(Pe=function C(b,K){if(null==b||b.$$is_module)return M(S,K)}(be,K)),Ye[K]=[Ue,Pe]):Pe=nt[1],null!=Pe||ge?Pe:P(be,K)},I.const_set=L,I.constants=function(b,K){null==K&&(K=!0);var ge,Pe,Ue,nt,be=[b],Ye={};for(K&&(be=be.concat(ae(b))),K&&b.$$is_module&&(be=be.concat([I.Object]).concat(ae(I.Object))),Pe=0,Ue=be.length;Pe<Ue&&(ge=be[Pe],b===S||ge!=S);Pe++){for(nt in ge.$$const)Ye[nt]=!0;if(ge.$$autoload)for(nt in ge.$$autoload)Ye[nt]=!0}return Object.keys(Ye)},I.const_remove=function(b,K){if(I.const_cache_version++,null!=b.$$const[K]){var ge=b.$$const[K];return delete b.$$const[K],ge}if(b.$$autoload&&b.$$autoload[K])return delete b.$$autoload[K],Ce;Y(I.NameError,"constant "+b+"::"+b.$name()+" not defined")},I.const_get_relative_factory=function(b){return function(K,ge){return I.$$(b,K,ge)}},I.$$=I.const_get_relative,I.$$$=I.const_get_qualified,I.$r=I.const_get_relative_factory,I.allocate_class=ne,I.klass=function(b,K,ge){var be;null==b||"::"==b?b=S:!b.$$is_class&&!b.$$is_module&&(b=b.$$class),null!=K&&(!K.hasOwnProperty||K.hasOwnProperty&&!K.hasOwnProperty("$$is_class"))&&(K.constructor&&"Function"==K.constructor.name?(be=K,K=S):Y(I.TypeError,"superclass must be a Class ("+(K.constructor&&(K.constructor.name||K.constructor.$$name)||typeof K)+" given)"));var Pe=function F(b,K){var ge=H(b,K);if(ge)return ge.$$is_class||Y(I.TypeError,K+" is not a class"),ge}(b,ge);return null!=Pe?K&&function he(b,K){b.$$super!==K&&Y(I.TypeError,"superclass mismatch for class "+b.$$name)}(Pe,K):(null==K&&(K=S),L(b,ge,Pe=ne(ge,K)),K.$inherited&&K.$inherited(Pe),be&&I.bridge(be,Pe)),I.trace_class&&R(Pe),Pe},I.allocate_module=B,I.module=function(b,K){var ge;return null==b||"::"==b?b=S:!b.$$is_class&&!b.$$is_module&&(b=b.$$class),ge=function O(b,K){var ge=H(b,K);return null==ge&&b===S&&(ge=M(S,K)),ge&&!ge.$$is_module&&ge!==S&&Y(I.TypeError,K+" is not a module"),ge}(b,K),null==ge&&L(b,K,ge=B(K)),I.trace_class&&R(ge),ge},I.get_singleton_class=function(b){return b.$$is_number&&Y(I.TypeError,"can't define singleton"),b.$$meta?b.$$meta:b.hasOwnProperty("$$is_class")?I.build_class_singleton_class(b):b.hasOwnProperty("$$is_module")?I.build_module_singleton_class(b):I.build_object_singleton_class(b)},I.build_class_singleton_class=function(b){if(b.$$meta)return b.$$meta;var ge=ne(null,b===f?v:I.get_singleton_class(b.$$super),!0);return X(ge,"$$is_singleton",!0),X(ge,"$$singleton_of",b),m(b,ge),X(b,"$$class",I.Class),ge},I.build_module_singleton_class=function(b){if(b.$$meta)return b.$$meta;var K=ne(null,I.Module,!0);return X(K,"$$is_singleton",!0),X(K,"$$singleton_of",b),m(b,K),X(b,"$$class",I.Module),K},I.build_object_singleton_class=function(b){var ge=ne(Ce,b.$$class,!0);return X(ge,"$$is_singleton",!0),X(ge,"$$singleton_of",b),delete ge.$$prototype.$$class,m(b,ge),ge},I.is_method=function(b){return"$"===b[0]&&"$"!==b[1]},I.instance_methods=function(b){for(var K=[],ge=[],be=ae(b),Pe=0,Ue=be.length;Pe<Ue;Pe++){var nt=be[Pe].$$prototype;nt.hasOwnProperty("$$dummy")&&(nt=nt.$$define_methods_on);for(var vt=Object.getOwnPropertyNames(nt),wt=0,cn=vt.length;wt<cn;wt++){var an=vt[wt];if(I.is_method(an)){var Bn=an.slice(1),zn=nt[an];zn.$$stub&&-1===K.indexOf(Bn)&&K.push(Bn),!zn.$$stub&&-1===ge.indexOf(Bn)&&-1===K.indexOf(Bn)&&ge.push(Bn)}}}return ge},I.own_instance_methods=function(b){var K=[],ge=b.$$prototype;ge.hasOwnProperty("$$dummy")&&(ge=ge.$$define_methods_on);for(var be=Object.getOwnPropertyNames(ge),Pe=0,Ue=be.length;Pe<Ue;Pe++){var Ye=be[Pe];if(I.is_method(Ye)&&!ge[Ye].$$stub){var vt=Ye.slice(1);K.push(vt)}}return K},I.methods=function(b){return I.instance_methods(b.$$meta||b.$$class)},I.own_methods=function(b){return b.$$meta?I.own_instance_methods(b.$$meta):[]},I.receiver_methods=function(b){var K=I.get_singleton_class(b),ge=I.own_instance_methods(K),be=I.own_instance_methods(K.$$super);return ge.concat(be)},I.class_variables=function(b){var ge,K=ae(b),Pe={};for(ge=K.length-1;ge>=0;ge--){var Ue=K[ge];for(var Ye in Ue.$$cvars)Pe[Ye]=Ue.$$cvars[Ye]}return Pe},I.class_variable_set=function(b,K,ge){var Pe,be=ae(b);for(Pe=be.length-2;Pe>=0;Pe--){var Ye=be[Pe];if(N(Ye.$$cvars,K))return Ye.$$cvars[K]=ge,ge}return b.$$cvars[K]=ge,ge},I.class_variable_get=function(b,K,ge){if(N(b.$$cvars,K))return b.$$cvars[K];var Pe,be=ae(b),Ue=be.length;for(Pe=0;Pe<Ue;Pe++){var Ye=be[Pe];if(N(Ye.$$cvars,K))return Ye.$$cvars[K]}return ge||Y(I.NameError,"uninitialized class variable "+K+" in "+b.$name()),Ce},I.append_features=function(b,K){var ge=ae(b),be=[];-1!==ge.indexOf(K)&&Y(I.ArgumentError,"cyclic include detected");for(var Pe=0,Ue=ge.length;Pe<Ue;Pe++){var nt=p(ge[Pe]);X(nt,"$$included",!0),be.push(nt)}var cn,an,vt=ae(K),wt=x(be);if(-1===vt.indexOf(b))cn=K.$$prototype,an=Object.getPrototypeOf(K.$$prototype);else{for(var Bn=K.$$prototype,zn=Object.getPrototypeOf(Bn);null!=zn&&(zn.$$module!==b||!l(zn));)Bn=zn,zn=Object.getPrototypeOf(zn);if(zn){for(var Hi=Object.getPrototypeOf(zn);Hi.hasOwnProperty("$$iclass")&&!l(Hi);)Hi=Object.getPrototypeOf(Hi);cn=Bn,an=Hi}else cn=K.$$prototype,an=Object.getPrototypeOf(K.$$prototype)}G(cn,wt.first),G(wt.last,an),K.$$own_included_modules=function c(b){for(var ge,K=[],be=Object.getPrototypeOf(b.$$prototype);be&&!be.hasOwnProperty("$$class");)(ge=$(be))&&K.push(ge),be=Object.getPrototypeOf(be);return K}(K),I.const_cache_version++},I.prepend_features=function(b,K){var ge=ae(b),be=[];-1!==ge.indexOf(K)&&Y(I.ArgumentError,"cyclic prepend detected");for(var Pe=0,Ue=ge.length;Pe<Ue;Pe++){var nt=p(ge[Pe]);X(nt,"$$prepended",!0),be.push(nt)}var an,Bn,zn,vt=x(be),wt=K.$$prototype,cn=Object.getPrototypeOf(wt);if(wt.hasOwnProperty("$$dummy")?an=wt.$$define_methods_on:(an=_(K),function d(b){for(var K=b.$$prototype,ge=Object.getOwnPropertyNames(K),be=0;be<ge.length;be++){var Pe=ge[be];I.is_method(Pe)&&delete K[Pe]}}(K),X(wt,"$$dummy",!0),X(wt,"$$define_methods_on",an),G(wt,an),G(an,cn)),-1===ae(K).indexOf(b))for(Bn=wt,zn=Object.getPrototypeOf(wt);null!=zn&&!zn.hasOwnProperty("$$root")&&zn!==an&&zn.hasOwnProperty("$$iclass");)zn=Object.getPrototypeOf(zn);else Y(I.RuntimeError,"Prepending a module multiple times is not supported");G(Bn,vt.first),G(vt.last,zn),K.$$own_prepended_modules=function h(b){var ge,K=[],be=Object.getPrototypeOf(b.$$prototype);if(b.$$prototype.hasOwnProperty("$$dummy"))for(;be&&be!==b.$$prototype.$$define_methods_on;)(ge=$(be))&&K.push(ge),be=Object.getPrototypeOf(be);return K}(K),I.const_cache_version++},I.bridge=function(b,K){b.hasOwnProperty("$$bridge")&&Y(I.ArgumentError,"already bridged"),X(b,"$$bridge",K),G(b.prototype,(K.$$super||I.Object).$$prototype),X(K,"$$prototype",b.prototype),X(K.$$prototype,"$$class",K),X(K,"$$constructor",b),X(K,"$$bridge",!0)},I.ancestors=ae,I.included_modules=function(b){for(var K=[],ge=null,be=Object.getPrototypeOf(b.$$prototype);be&&Object.getPrototypeOf(be);be=Object.getPrototypeOf(be))(ge=$(be))&&ge.$$is_module&&be.$$iclass&&be.$$included&&K.push(ge);return K},I.add_stubs=function(b){for(var ge,be,K=I.BasicObject.$$prototype,Pe=0,Ue=(b=b.split(",")).length;Pe<Ue;Pe++)(null==(be=K[ge=Fe(b[Pe])])||be.$$stub)&&I.add_stub_for(K,ge)},I.add_stub_for=function(b,K){X(b,K,I.stub_for(K))},I.stub_for=function(b){function K(){this.$method_missing.$$p=K.$$p,K.$$p=null;for(var ge=new Array(arguments.length),be=0,Pe=ge.length;be<Pe;be++)ge[be]=arguments[be];return this.$method_missing.apply(this,[b.slice(1)].concat(ge))}return K.$$stub=!0,K},I.ac=function(b,K,ge,be){var Pe="";Pe+=ge.$$is_a_module?ge.$$name+".":ge.$$class.$$name+"#",Y(I.ArgumentError,"["+(Pe+=be)+"] wrong number of arguments (given "+b+", expected "+K+")")},I.block_ac=function(b,K,ge){Y(I.ArgumentError,"`block in "+ge+"': wrong number of arguments (given "+b+", expected "+K+")")},I.find_super=function(b,K,ge,be,Pe){for(var Ye,nt,Ue=Fe(K),wt=(Ye=Te(b)).indexOf(ge.$$owner)+1;wt<Ye.length;wt++){var an=Ye[wt].$$prototype;if(an.hasOwnProperty("$$dummy")&&(an=an.$$define_methods_on),an.hasOwnProperty(Ue)){nt=an[Ue];break}}return!be&&nt&&nt.$$stub&&b.$method_missing.$$pristine&&Y(I.NoMethodError,"super: no superclass method `"+K+"' for "+b,K),nt.$$stub&&!Pe?null:nt},I.find_block_super=function(b,K,ge,be,Pe){var Ue=K;return ge||Y(I.RuntimeError,"super called outside of method"),Pe&&ge.$$define_meth&&Y(I.RuntimeError,"implicit argument passing of super from method defined by define_method() is not supported. Specify all arguments explicitly"),ge.$$def&&(Ue=ge.$$jsid),I.find_super(b,Ue,ge,be)},I.find_super_dispatcher=I.find_super,I.find_iter_super_dispatcher=I.find_block_super,I.yield1=function(b,K){"function"!=typeof b&&Y(I.LocalJumpError,"no block given");var be=b.$$has_trailing_comma_in_args;return(b.length>1||(b.$$has_top_level_mlhs_arg||be)&&1===b.length)&&(K=I.to_ary(K)),(b.length>1||be&&1===b.length)&&K.$$is_array?b.apply(null,K):b(K)},I.yieldX=function(b,K){if("function"!=typeof b&&Y(I.LocalJumpError,"no block given"),b.length>1&&1===K.length&&K[0].$$is_array)return b.apply(null,K[0]);if(!K.$$is_array){for(var ge=new Array(K.length),be=0,Pe=ge.length;be<Pe;be++)ge[be]=K[be];return b.apply(null,ge)}return b.apply(null,K)},I.rescue=function(b,K){for(var ge=0;ge<K.length;ge++){var be=K[ge];if(be.$$is_array){var Pe=I.rescue(b,be);if(Pe)return Pe}else if(be===I.JS.Error||be["$==="](b))return be}return null},I.is_a=function(b,K){return null!=K&&b.$$meta===K||b.$$class===K||(b.$$is_number&&K.$$is_number_class?!K.$$is_integer_class||b%1==0:-1!==ae(b.$$is_class?I.get_singleton_class(b):b.$$meta||b.$$class).indexOf(K))},I.to_hash=function(b){if(b.$$is_hash)return b;if(b["$respond_to?"]("to_hash",!0)){var K=b.$to_hash();if(K.$$is_hash)return K;Y(I.TypeError,"Can't convert "+b.$$class+" to Hash ("+b.$$class+"#to_hash gives "+K.$$class+")")}else Y(I.TypeError,"no implicit conversion of "+b.$$class+" into Hash")},I.to_ary=function(b){if(b.$$is_array)return b;if(!b["$respond_to?"]("to_ary",!0))return[b];var K=b.$to_ary();return K===Ce?[b]:K.$$is_array?K:void Y(I.TypeError,"Can't convert "+b.$$class+" to Array ("+b.$$class+"#to_ary gives "+K.$$class+")")},I.to_a=function(b){if(b.$$is_array)return b.slice();if(!b["$respond_to?"]("to_a",!0))return[b];var K=b.$to_a();return K===Ce?[b]:K.$$is_array?K:void Y(I.TypeError,"Can't convert "+b.$$class+" to Array ("+b.$$class+"#to_a gives "+K.$$class+")")},I.extract_kwargs=function(b){var K=b[b.length-1];if(null!=K&&I.respond_to(K,"$to_hash",!0))return q(b,b.length-1),K},I.kwrestargs=function(b,K){var Pe,ge=[],be={},Ue=b.$$smap;for(Pe in Ue)K[Pe]||(ge.push(Pe),be[Pe]=Ue[Pe]);return I.hash2(ge,be)};var de=new Map;function Fe(b){var K=de.get(b);return K||de.set(b,K="$"+b),K}function xe(b){return"function"==typeof b&&!b.$$stub}I.jsid=Fe,I.send=function(b,K,ge,be,Pe){var Ue;return"function"==typeof K?(Ue=K,K=null):"string"==typeof K?Ue=b[Fe(K)]:Y(I.NameError,"Passed method should be a string or a function"),I.send2(b,Ue,K,ge,be,Pe)},I.send2=function(b,K,ge,be,Pe,Ue){return null==K&&null!=ge&&b.$method_missing&&(K=b.$method_missing,be=[ge].concat(be)),Ae(Pe,Ue),"function"==typeof Pe&&(K.$$p=Pe),K.apply(b,be)},I.refined_send=function(b,K,ge,be,Pe,Ue){var Ye,nt,vt,wt,cn,an,Bn,zn,Hi,lr;for(wt=Te(K),Ye=0;Ye<wt.length;Ye++)for(cn=I.id(wt[Ye]),nt=0;nt<b.length;nt++)for(vt=(an=b[nt]).length-1;vt>=0;vt--)if(void 0!==(Bn=an[vt]).$$refine_modules&&void 0!==(zn=Bn.$$refine_modules)[cn]&&void 0!==(Hi=zn[cn]).$$prototype[Fe(ge)])return lr=Hi.$$prototype[Fe(ge)],I.send2(K,lr,ge,be,Pe,Ue);return I.send(K,ge,be,Pe,Ue)},I.lambda=function(b,K){return b.$$is_lambda=!0,Ae(b,K),b},I.def=function(b,K,ge,be){return Ae(ge,be),b===I.top?I.defn(I.Object,K,ge):!b.$$eval&&b.$$is_a_module?I.defn(b,K,ge):I.defs(b,K,ge)},I.defn=function(b,K,ge){De(b),ge.displayName=K,ge.$$owner=b;var be=K.substr(1),Pe=b.$$prototype;if(Pe.hasOwnProperty("$$dummy")&&(Pe=Pe.$$define_methods_on),X(Pe,K,ge),b.$$is_module){b.$$module_function&&I.defs(b,K,ge);for(var Ue=0,Ye=b.$$iclasses,nt=Ye.length;Ue<nt;Ue++)X(Ye[Ue],K,ge)}var wt=b.$$singleton_of;return!b.$method_added||b.$method_added.$$stub||wt?wt&&wt.$singleton_method_added&&!wt.$singleton_method_added.$$stub&&wt.$singleton_method_added(be):b.$method_added(be),be},I.defs=function(b,K,ge,be){return Ae(ge,be),(b.$$is_string||b.$$is_number)&&Y(I.TypeError,"can't define singleton"),I.defn(I.get_singleton_class(b),K,ge)},I.rdef=function(b,K){N(b.$$prototype,K)||Y(I.NameError,"method '"+K.substr(1)+"' not defined in "+b.$name()),delete b.$$prototype[K],b.$$is_singleton?b.$$prototype.$singleton_method_removed&&!b.$$prototype.$singleton_method_removed.$$stub&&b.$$prototype.$singleton_method_removed(K.substr(1)):b.$method_removed&&!b.$method_removed.$$stub&&b.$method_removed(K.substr(1))},I.udef=function(b,K){(!b.$$prototype[K]||b.$$prototype[K].$$stub)&&Y(I.NameError,"method '"+K.substr(1)+"' not defined in "+b.$name()),I.add_stub_for(b.$$prototype,K),b.$$is_singleton?b.$$prototype.$singleton_method_undefined&&!b.$$prototype.$singleton_method_undefined.$$stub&&b.$$prototype.$singleton_method_undefined(K.substr(1)):b.$method_undefined&&!b.$method_undefined.$$stub&&b.$method_undefined(K.substr(1))},I.alias=function(b,K,ge){var Ue,Ye,be=Fe(K),Pe=Fe(ge);if(void 0===b.$$prototype&&(b=I.Object),Ue=b.$$prototype[Pe],b.$$eval)return I.alias(I.get_singleton_class(b),K,ge);if(!xe(Ue)){for(var nt=b.$$super;"function"!=typeof Ue&&nt;)Ue=nt[Pe],nt=nt.$$super;!xe(Ue)&&b.$$is_module&&(Ue=I.Object.$$prototype[Pe]),xe(Ue)||Y(I.NameError,"undefined method `"+ge+"' for class `"+b.$name()+"'")}Ue.$$alias_of&&(Ue=Ue.$$alias_of),Ye=function(){var wt,cn,an,vt=Ye.$$p;for(wt=new Array(arguments.length),cn=0,an=arguments.length;cn<an;cn++)wt[cn]=arguments[cn];return Ye.$$p=null,I.send(this,Ue,wt,vt)};try{Object.defineProperty(Ye,"length",{value:Ue.length})}catch(vt){}return Ye.displayName=K,Ye.$$arity=null==Ue.$$arity?Ue.length:Ue.$$arity,Ye.$$parameters=Ue.$$parameters,Ye.$$source_location=Ue.$$source_location,Ye.$$alias_of=Ue,Ye.$$alias_name=K,I.defn(b,be,Ye),b},I.alias_gvar=function(b,K){return Object.defineProperty(Z,b,{configurable:!0,enumerable:!0,get:function(){return Z[K]},set:function(ge){Z[K]=ge}}),Ce},I.alias_native=function(b,K,ge){var be=Fe(K),Pe=b.$$prototype[ge];return("function"!=typeof Pe||Pe.$$stub)&&Y(I.NameError,"undefined native method `"+ge+"' for class `"+b.$name()+"'"),I.defn(b,be,Pe),b},I.hash_init=function(b){b.$$smap=Object.create(null),b.$$map=Object.create(null),b.$$keys=[]},I.hash_clone=function(b,K){K.$$none=b.$$none,K.$$proc=b.$$proc;for(var Ye,nt,ge=0,be=b.$$keys,Pe=b.$$smap,Ue=be.length;ge<Ue;ge++)(Ye=be[ge]).$$is_string?nt=Pe[Ye]:(nt=Ye.value,Ye=Ye.key),I.hash_put(K,Ye,nt)},I.hash_put=function(b,K,ge){if(K.$$is_string)return N(b.$$smap,K)||b.$$keys.push(K),void(b.$$smap[K]=ge);var be,Pe,Ue;if(be=b.$$by_identity?I.id(K):K.$hash(),!N(b.$$map,be))return b.$$keys.push(Pe={key:K,key_hash:be,value:ge}),void(b.$$map[be]=Pe);for(Pe=b.$$map[be];Pe;){if(K===Pe.key||K["$eql?"](Pe.key)){Ue=void 0,Pe.value=ge;break}Ue=Pe,Pe=Pe.next}Ue&&(b.$$keys.push(Pe={key:K,key_hash:be,value:ge}),Ue.next=Pe)},I.hash_get=function(b,K){if(K.$$is_string)return N(b.$$smap,K)?b.$$smap[K]:void 0;var ge,be;if(ge=b.$$by_identity?I.id(K):K.$hash(),N(b.$$map,ge))for(be=b.$$map[ge];be;){if(K===be.key||K["$eql?"](be.key))return be.value;be=be.next}},I.hash_delete=function(b,K){var ge,Ue,Ye,be=b.$$keys,Pe=be.length;if(K.$$is_string){if("string"!=typeof K&&(K=K.valueOf()),!N(b.$$smap,K))return;for(ge=0;ge<Pe;ge++)if((Ye=be[ge]).$$is_string&&"string"!=typeof Ye&&(Ye=Ye.valueOf()),Ye===K){be.splice(ge,1);break}return Ue=b.$$smap[K],delete b.$$smap[K],Ue}var nt=K.$hash();if(N(b.$$map,nt))for(var wt,vt=b.$$map[nt];vt;){if(K===vt.key||K["$eql?"](vt.key)){for(Ue=vt.value,ge=0;ge<Pe;ge++)if(be[ge]===vt){be.splice(ge,1);break}return wt&&vt.next?wt.next=vt.next:wt?delete wt.next:vt.next?b.$$map[nt]=vt.next:delete b.$$map[nt],Ue}wt=vt,vt=vt.next}},I.hash_rehash=function(b){for(var be,Pe,Ue,K=0,ge=b.$$keys.length;K<ge;K++)if(!b.$$keys[K].$$is_string&&(be=b.$$keys[K].key.$hash())!==b.$$keys[K].key_hash){for(Pe=b.$$map[b.$$keys[K].key_hash],Ue=void 0;Pe;){if(Pe===b.$$keys[K]){Ue&&Pe.next?Ue.next=Pe.next:Ue?delete Ue.next:Pe.next?b.$$map[b.$$keys[K].key_hash]=Pe.next:delete b.$$map[b.$$keys[K].key_hash];break}Ue=Pe,Pe=Pe.next}if(b.$$keys[K].key_hash=be,!N(b.$$map,be)){b.$$map[be]=b.$$keys[K];continue}for(Pe=b.$$map[be],Ue=void 0;Pe;){if(Pe===b.$$keys[K]){Ue=void 0;break}Ue=Pe,Pe=Pe.next}Ue&&(Ue.next=b.$$keys[K])}},I.hash=function(){var K,ge,be,Pe,Ue,b=arguments.length;if(1===b&&arguments[0].$$is_hash)return arguments[0];if(ge=new I.Hash,I.hash_init(ge),1===b){if(K=arguments[0],arguments[0].$$is_array){for(Pe=K.length,be=0;be<Pe;be++)2!==K[be].length&&Y(I.ArgumentError,"value not of length 2: "+K[be].$inspect()),I.hash_put(ge,Ue=K[be][0],K[be][1]);return ge}for(Ue in K=arguments[0])N(K,Ue)&&I.hash_put(ge,Ue,K[Ue]);return ge}for(b%2!=0&&Y(I.ArgumentError,"odd number of arguments for Hash"),be=0;be<b;be+=2)I.hash_put(ge,Ue=arguments[be],arguments[be+1]);return ge},I.hash2=function(b,K){var ge=new I.Hash;return ge.$$smap=K,ge.$$map=Object.create(null),ge.$$keys=b,ge},I.range=function(b,K,ge){var be=new I.Range;return be.begin=b,be.end=K,be.excl=ge,be};var ke=["constructor","displayName","__count__","__noSuchMethod__","__parent__","__proto__","hasOwnProperty","valueOf"];function De(b){b.$$frozen&&Y(I.FrozenError,"can't modify frozen "+b.$class()+": "+b,I.hash2(["receiver"],{receiver:b}))}function Me(b,K){return"number"==typeof b&&"number"==typeof K}function _e(b,K){return"number"==typeof b&&"number"==typeof K||"string"==typeof b&&"string"==typeof K}function pe(b){return function(){return b}}I.ivar=function(b){return-1!==ke.indexOf(b)&&(b+="$"),b},I.deny_frozen_access=De,I.freeze=function(b){return X(b,"$$frozen",!0),b.hasOwnProperty("$$id")||X(b,"$$id",le()),b.hasOwnProperty("$$meta")?b.$$meta.$freeze():X(b,"$$meta",null),b.hasOwnProperty("$$comparable")||X(b,"$$comparable",null),Object.seal(b),b},I.freeze_props=function(b){var K,ge,be;for(K in b)("string"!=(ge=typeof K)&&"object"!==ge||"$"!==K[0])&&(be=Object.getOwnPropertyDescriptor(b,K))&&be.enumerable&&be.writable&&function(){var Pe=b[K];Object.defineProperty(b,K,{get:function(){return Pe},set:function(Ue){De(b)},enumerable:!0})}()},I.escape_regexp=function(b){return b.replace(/([-[\]\/{}()*+?.^$\\| ])/g,"\\$1").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r").replace(/[\f]/g,"\\f").replace(/[\t]/g,"\\t")},I.global_regexp=function(b){return b.global?b:(null==b.$$g?b.$$g=new RegExp(b.source,(b.multiline?"gm":"g")+(b.ignoreCase?"i":"")):b.$$g.lastIndex=null,b.$$g)},I.global_multiline_regexp=function(b){var K,ge;return b.global&&b.multiline?b:(ge="gm"+(b.ignoreCase?"i":""),b.multiline?(null==b.$$g&&(b.$$g=new RegExp(b.source,ge)),K=b.$$g):(null==b.$$gm&&(b.$$gm=new RegExp(b.source,ge)),K=b.$$gm),K.lastIndex=null,K)},I.regexp=function(b,K){for(var ge,be=void 0!==K&&K&&K.indexOf("i")>=0,Pe=0,Ue=b.length;Pe<Ue;Pe++)(ge=b[Pe])instanceof RegExp&&(ge.ignoreCase!==be&&I.Kernel.$warn("ignore case doesn't match for "+ge.source.$inspect(),I.hash({uplevel:1})),ge=ge.source),""===ge&&(ge="(?:"+ge+")"),b[Pe]=ge;return K?new RegExp(b.join(""),K):new RegExp(b.join(""))},I.modules={},I.loaded_features=["corelib/runtime"],I.current_dir=".",I.require_table={"corelib/runtime":!0},I.normalize=function(b){var K,ge,be=[];"."!==I.current_dir&&(b=I.current_dir.replace(/\/*$/,"/")+b);for(var Ue=0,Ye=(K=(b=(b=b.replace(/^\.\//,"")).replace(/\.(rb|opal|js)$/,"")).split("/")).length;Ue<Ye;Ue++)""!==(ge=K[Ue])&&(".."===ge?be.pop():be.push(ge));return be.join("/")},I.loaded=function(b){var K,ge,be;for(K=0,ge=b.length;K<ge;K++)be=I.normalize(b[K]),!I.require_table[be]&&(I.loaded_features.push(be),I.require_table[be]=!0)},I.load_normalized=function(b){I.loaded([b]);var K=I.modules[b];if(K){var ge=K(I);if("undefined"!=typeof Promise&&ge instanceof Promise)return ge.then(pe(!0))}else{var be=I.config.missing_require_severity,Pe="cannot load such file -- "+b;"error"===be?Y(I.LoadError,Pe):"warning"===be&&fe.warn("WARNING: LoadError: "+Pe)}return!0},I.load=function(b){return b=I.normalize(b),I.load_normalized(b)},I.require=function(b){return b=I.normalize(b),!I.require_table[b]&&I.load_normalized(b)},I.encodings=Object.create(null),I.set_encoding=function(b,K,ge){void 0===ge&&(ge="encoding"),("string"==typeof b||!0===b.$$frozen)&&Y(I.FrozenError,"can't modify frozen String");var be=I.find_encoding(K);return be===b[ge]||(b[ge]=be),b},I.find_encoding=function(b){var K=I.encodings,ge=K[b]||K[b.toUpperCase()];return ge||Y(I.ArgumentError,"unknown encoding name - "+b),ge},I.enc=function(b,K){var ge=new String(b);return(ge=I.set_encoding(ge,K)).internal_encoding=ge.encoding,ge},I.binary=function(b){var K=new String(b);return I.set_encoding(K,"binary","internal_encoding")},I.last_promise=null,I.promise_unhandled_exception=!1,I.queue=function(b){if(I.last_promise)return I.last_promise=I.last_promise.then(function(){if(!I.promise_unhandled_exception)return b(I)}).catch(function(ge){I.respond_to(ge,"$full_message")&&(ge=ge.$full_message()),fe.error(ge),I.promise_unhandled_exception=!0,I.exit(1)}),I.last_promise;var K=b(I);return"function"==typeof Promise&&"object"==typeof K&&K instanceof Promise&&(I.last_promise=K),K},I.rb_plus=function(b,K){return Me(b,K)?b+K:b["$+"](K)},I.rb_minus=function(b,K){return Me(b,K)?b-K:b["$-"](K)},I.rb_times=function(b,K){return Me(b,K)?b*K:b["$*"](K)},I.rb_divide=function(b,K){return Me(b,K)?b/K:b["$/"](K)},I.rb_lt=function(b,K){return Me(b,K)?b<K:b["$<"](K)},I.rb_gt=function(b,K){return Me(b,K)?b>K:b["$>"](K)},I.rb_le=function(b,K){return Me(b,K)?b<=K:b["$<="](K)},I.rb_ge=function(b,K){return Me(b,K)?b>=K:b["$>="](K)},I.eqeq=function ce(b,K){return _e(b,K)?b===K:k(b["$=="](K))},I.eqeqeq=function(b,K){return _e(b,K)?b===K:k(b["$==="](K))},I.neqeq=function(b,K){return _e(b,K)?b!==K:k(b["$!="](K))},I.not=function(b){return null==b||!1===b||Ce===b||!0!==b&&!b["$!"].$$pristine&&k(b["$!"]())},I.return_val=pe,I.return_self=function(){return this},I.return_ivar=function(b){return function(){return null==this[b]?Ce:this[b]}},I.assign_ivar=function(b){return function(K){return De(this),this[b]=K}},I.assign_ivar_val=function(b,K){return function(){return De(this),this[b]=K}},I.ensure_kwargs=function(b){return null==b?I.hash2([],{}):b.$$is_hash?b:void Y(I.ArgumentError,"expected kwargs")},I.get_kwarg=function(b,K){return N(b.$$smap,K)||Y(I.ArgumentError,"missing keyword: "+K),b.$$smap[K]},I.large_array_unpack=function(b){var be,K=b.split(","),ge=K.length;for(be=0;be<ge;be++)switch(K[be][0]){case void 0:K[be]=Ce;break;case"-":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":K[be]=+K[be]}return K},I.BasicObject=f=ne("BasicObject",null),I.Object=S=ne("Object",I.BasicObject),I.Module=te=ne("Module",I.Object),I.Class=v=ne("Class",I.Module),I.Opal=D=B("Opal"),I.Kernel=z=B("Kernel"),G(I.BasicObject,I.Class.$$prototype),G(I.Object,I.Class.$$prototype),G(I.Module,I.Class.$$prototype),G(I.Class,I.Class.$$prototype),f.$$const.BasicObject=f,L(S,"BasicObject",f),L(S,"Object",S),L(S,"Module",te),L(S,"Class",v),L(S,"Opal",D),L(S,"Kernel",z),f.$$class=v,S.$$class=v,te.$$class=v,v.$$class=v,D.$$class=te,z.$$class=te,X(S.$$prototype,"toString",function(){var b=this.$to_s();return b.$$is_string&&"object"==typeof b?b.valueOf():b}),X(S.$$prototype,"$require",I.require),I.top=new S,I.top.$to_s=I.top.$inspect=pe("main"),I.top.$define_method=function ye(){var b=re(arguments),K=ye.$$p;return ye.$$p=null,I.send(S,"define_method",b,K)},I.NilClass=ne("NilClass",I.Object),L(S,"NilClass",I.NilClass),(Ce=I.nil=new I.NilClass).$$id=4,Ce.call=Ce.apply=function(){Y(I.LocalJumpError,"no block given")},Ce.$$frozen=!0,Ce.$$comparable=!1,Object.seal(Ce),I.thrower=function(b){var K=new Error("unexpected "+b);return K.$thrower_type=b,K.$throw=function(ge){throw null==ge&&(ge=Ce),K.$v=ge,K},K},I.t_eval_return=I.thrower("return"),TypeError.$$super=Error,I.file_sources={}}).call(this),Opal.loaded(["corelib/runtime.js"]),Opal.modules["corelib/helpers"]=function(T){var fe=T.type_error,Ce=T.coerce_to,f=T.module,S=T.defs,te=T.slice,v=T.eqeqeq,D=T.Kernel,z=T.truthy,I=T.Opal,Q=T.nil,U=T.$$$;return function(N){var G=f("::","Opal");S(G,"$bridge",function(E,V){return T.bridge(E,V)}),S(G,"$coerce_to!",function(E,V,le,Z){var Y,k=Q;return Y=te(arguments,3),k=Ce(E,V,le,Y),v(V,k)||D.$raise(fe(E,V,le,k)),k},-4),S(G,"$coerce_to?",function(E,V,le,Z){var X,k=Q;return X=te(arguments,3),!z(E["$respond_to?"](le))||(k=Ce(E,V,le,X),z(k["$nil?"]()))?Q:(v(V,k)||D.$raise(fe(E,V,le,k)),k)},-4),S(G,"$try_convert",function(E,V,le){return v(V,E)?E:z(E["$respond_to?"](le))?E.$__send__(le):Q}),S(G,"$compare",function(E,V){var le;return le=E["$<=>"](V),z(le===Q)&&D.$raise(U("ArgumentError"),"comparison of "+E.$class()+" with "+V.$class()+" failed"),le}),S(G,"$destructure",function(E){if(1==E.length)return E[0];if(E.$$is_array)return E;for(var V=new Array(E.length),le=0,Z=V.length;le<Z;le++)V[le]=E[le];return V}),S(G,"$respond_to?",function(E,V,le){return null==le&&(le=!1),!(null==E||!E.$$class)&&E["$respond_to?"](V,le)},-3),S(G,"$instance_variable_name!",function(E){return E=I["$coerce_to!"](E,U("String"),"to_str"),z(/^@[a-zA-Z_][a-zA-Z0-9_]*?$/.test(E))||D.$raise(U("NameError").$new("'"+E+"' is not allowed as an instance variable name",E)),E}),S(G,"$class_variable_name!",function(E){return E=I["$coerce_to!"](E,U("String"),"to_str"),z(E.length<3||"@@"!==E.slice(0,2))&&D.$raise(U("NameError").$new("`"+E+"' is not allowed as a class variable name",E)),E}),S(G,"$const_name?",function(E){return"string"!=typeof E&&(E=I["$coerce_to!"](E,U("String"),"to_str")),E[0]===E[0].toUpperCase()}),S(G,"$const_name!",function(E){return z(U("::","String","skip_raise")?"constant":Q)&&(E=I["$coerce_to!"](E,U("String"),"to_str")),(!E||E[0]!=E[0].toUpperCase())&&this.$raise(U("NameError"),"wrong constant name "+E),E}),S(G,"$pristine",function(E,V){for(var Z,X,k=(Z=te(arguments,1)).length-1;k>=0;k--)(X=E.$$prototype[T.jsid(Z[k])])&&!X.$$stub&&(X.$$pristine=!0);return Q},-2);var re=[];return S(G,"$inspect",function(E){var le=!1;return function(){try{try{return null===E?"null":void 0===E?"undefined":void 0===E.$$class?Object.prototype.toString.apply(E):"function"!=typeof E.$inspect||E.$inspect.$$stub||-1!==re.indexOf(E.$__id__())?"#<"+E.$$class+":0x"+E.$__id__().$to_s(16)+">":(re.push(E.$__id__()),le=!0,E.$inspect())}catch(Z){if(!T.rescue(Z,[U("Exception")]))throw Z;try{return"#<"+E.$$class+":0x"+E.$__id__().$to_s(16)+">"}finally{T.pop_exception()}}}finally{le&&re.pop()}}()},-1)}()},Opal.modules["corelib/module"]=function(T){var l,c,h,d,fe=T.truthy,Ce=T.coerce_to,f=T.const_set,S=T.Object,te=T.return_ivar,v=T.assign_ivar,D=T.ivar,z=T.deny_frozen_access,I=T.freeze,Q=T.prop,U=T.jsid,N=T.klass,G=T.defs,re=T.send,q=T.def,E=T.eqeqeq,V=T.Module,le=T.Kernel,Z=T.rb_lt,Y=T.rb_gt,X=T.slice,k=T.to_a,R=T.hash2,ee=T.Opal,H=T.return_val,A=T.eqeq,M=T.lambda,C=T.range,P=T.send2,L=T.find_super,ne=T.alias,he=T.nil,B=T.$$$;return l=[],c=N("::",null,"Module"),h=[c].concat(l),d=T.$r(h),G(c,"$allocate",function(){var x=T.allocate_module(he,function(){});return this!==T.Module&&Object.setPrototypeOf(x,this.$$prototype),x}),q(c,"$initialize",function p(){var _=p.$$p||he;return p.$$p=null,_!==he?re(this,"module_eval",[],_.$to_proc()):he}),q(c,"$===",function(_){return!fe(null==_)&&T.is_a(_,this)}),q(c,"$<",function(_){var se,ae,Te,x=this;if(E(V,_)||le.$raise(B("TypeError"),"compared with non class/module"),x===_)return!1;for(ae=0,Te=(se=T.ancestors(x)).length;ae<Te;ae++)if(se[ae]===_)return!0;for(ae=0,Te=(se=T.ancestors(_)).length;ae<Te;ae++)if(se[ae]===x)return!1;return he}),q(c,"$<=",function(_){var $;return fe($=this["$equal?"](_))?$:Z(this,_)}),q(c,"$>",function(_){return E(V,_)||le.$raise(B("TypeError"),"compared with non class/module"),Z(_,this)}),q(c,"$>=",function(_){var $;return fe($=this["$equal?"](_))?$:Y(this,_)}),q(c,"$<=>",function(_){var $=he;return this===_?0:!E(V,_)||($=Z(this,_),fe($["$nil?"]()))?he:fe($)?-1:1}),q(c,"$alias_method",function(_,x){var $=this;return z($),_=Ce(_,B("String"),"to_str"),x=Ce(x,B("String"),"to_str"),T.alias($,_,x),$}),q(c,"$alias_native",function(_,x){var $=this;return null==x&&(x=_),z($),T.alias_native($,_,x),$},-2),q(c,"$ancestors",function(){return T.ancestors(this)}),q(c,"$append_features",function(_){return z(_),T.append_features(this,_),this}),q(c,"$attr_accessor",function(_){var x,$,se=this;return x=X(arguments),re(se,"attr_reader",k($=x)),re(se,"attr_writer",k($))},-1),q(c,"$attr",function(_){var $,se=this;return 2!=($=X(arguments)).length||!0!==$[1]&&!1!==$[1]?re(se,"attr_reader",k($)):(se.$warn("optional boolean argument is obsoleted",R(["uplevel"],{uplevel:1})),$[1]?se.$attr_accessor($[0]):se.$attr_reader($[0]),he)},-1),q(c,"$attr_reader",function(_){var $,se=this;$=X(arguments),z(se);for(var ae=se.$$prototype,Te=$.length-1;Te>=0;Te--){var Ae=$[Te],de=U(Ae),Fe=D(Ae),xe=te(Fe);T.prop(ae,Fe,he),xe.$$parameters=[],xe.$$arity=0,T.defn(se,de,xe)}return he},-1),q(c,"$attr_writer",function(_){var $,se=this;$=X(arguments),z(se);for(var ae=se.$$prototype,Te=$.length-1;Te>=0;Te--){var Ae=$[Te],de=U(Ae+"="),Fe=D(Ae),xe=v(Fe);xe.$$parameters=[["req"]],xe.$$arity=1,T.prop(ae,Fe,he),T.defn(se,de,xe)}return he},-1),q(c,"$autoload",function(_,x){var $=this;return z($),d("Opal")["$const_name?"](_)||le.$raise(B("NameError"),"autoload must be constant name: "+_),""==x&&le.$raise(B("ArgumentError"),"empty file name"),$.$$const.hasOwnProperty(_)||($.$$autoload||($.$$autoload={}),T.const_cache_version++,$.$$autoload[_]={path:x,loaded:!1,required:!1,success:!1,exception:!1},$.$const_added&&!$.$const_added.$$pristine&&$.$const_added(_)),he}),q(c,"$autoload?",function(_){var x=this;if(x.$$autoload&&x.$$autoload[_]&&!x.$$autoload[_].required&&!x.$$autoload[_].success)return x.$$autoload[_].path;for(var $=x.$ancestors(),se=0,ae=$.length;se<ae;se++)if($[se].$$autoload&&$[se].$$autoload[_]&&!$[se].$$autoload[_].required&&!$[se].$$autoload[_].success)return $[se].$$autoload[_].path;return he}),q(c,"$class_variables",function(){return Object.keys(T.class_variables(this))}),q(c,"$class_variable_get",function(_){return _=ee["$class_variable_name!"](_),T.class_variable_get(this,_,!1)}),q(c,"$class_variable_set",function(_,x){return z(this),_=ee["$class_variable_name!"](_),T.class_variable_set(this,_,x)}),q(c,"$class_variable_defined?",function(_){return _=ee["$class_variable_name!"](_),T.class_variables(this).hasOwnProperty(_)}),q(c,"$const_added",H(he)),ee.$pristine(c,"const_added"),q(c,"$remove_class_variable",function(_){var x=this;if(z(x),_=ee["$class_variable_name!"](_),T.hasOwnProperty.call(x.$$cvars,_)){var $=x.$$cvars[_];return delete x.$$cvars[_],$}le.$raise(B("NameError"),"cannot remove "+_+" for "+x)}),q(c,"$constants",function(_){return null==_&&(_=!0),T.constants(this,_)},-1),G(c,"$constants",function(_){if(null==_){var se,Te,Ae,$=(this.$$nesting||[]).concat(S),ae={};for(Te=0,Ae=$.length;Te<Ae;Te++)for(se in $[Te].$$const)ae[se]=!0;return Object.keys(ae)}return T.constants(this,_)},-1),G(c,"$nesting",function(){return this.$$nesting||[]}),q(c,"$const_defined?",function(_,x){var $=this;null==x&&(x=!0),_=d("Opal")["$const_name!"](_),fe(_["$=~"](B(ee,"CONST_NAME_REGEXP")))||le.$raise(B("NameError").$new("wrong constant name "+_,_));var se,Ae,de,ae=[$];for(x&&(ae=ae.concat(T.ancestors($)),$.$$is_module&&(ae=ae.concat([S]).concat(T.ancestors(S)))),Ae=0,de=ae.length;Ae<de;Ae++)if(null!=(se=ae[Ae]).$$const[_]||se.$$autoload&&se.$$autoload[_]&&!se.$$autoload[_].required&&!se.$$autoload[_].success)return!0;return!1},-2),q(c,"$const_get",function(_,x){var $=this;return null==x&&(x=!0),0===(_=d("Opal")["$const_name!"](_)).indexOf("::")&&"::"!==_&&(_=_.slice(2)),fe(-1!=_.indexOf("::")&&"::"!=_)?re(_.$split("::"),"inject",[$],function(ae,Te){return null==ae&&(ae=he),null==Te&&(Te=he),ae.$const_get(Te)}):(fe(_["$=~"](B(ee,"CONST_NAME_REGEXP")))||le.$raise(B("NameError").$new("wrong constant name "+_,_)),x?T.$$([$],_):T.const_get_local($,_))},-2),q(c,"$const_missing",function(_){var $;return $=A(this,S)?_:this+"::"+_,le.$raise(B("NameError").$new("uninitialized constant "+$,_))}),q(c,"$const_set",function(_,x){return z(this),_=ee["$const_name!"](_),(fe(_["$!~"](B(ee,"CONST_NAME_REGEXP")))||fe(_["$start_with?"]("::")))&&le.$raise(B("NameError").$new("wrong constant name "+_,_)),f(this,_,x),x}),q(c,"$public_constant",H(he)),q(c,"$define_method",function p(_,x){var ae,$=p.$$p||he,Te=he;return p.$$p=null,z(this),void 0===x&&$===he&&le.$raise(B("ArgumentError"),"tried to create a Proc object without a block"),$=fe(ae=$)?ae:E(B("Proc"),Te=x)?x:E(B("Method"),Te)?x.$to_proc().$$unbound:E(B("UnboundMethod"),Te)?M(function de(Fe){var ke,De=null==de.$$s?this:de.$$s,Me=he;return ke=X(arguments),Me=x.$bind(De),re(Me,"call",k(ke))},{$$arity:-1,$$s:this}):le.$raise(B("TypeError"),"wrong argument type "+$.$class()+" (expected Proc/Method)"),"undefined"!=typeof Proxy&&($.$$proxy_target=$,$=new Proxy($,{apply:function(de,Fe,xe){var ke=de.$$jsid;de.$$jsid=_;try{return de.apply(Fe,xe)}catch(De){if(De===de.$$brk||De===de.$$ret)return De.$v;throw De}finally{de.$$jsid=ke}}})),$.$$jsid=_,$.$$s=null,$.$$def=$,$.$$define_meth=!0,T.defn(this,U(_),$)},-2),q(c,"$freeze",function(){var _=this;return fe(_["$frozen?"]())?_:(_.hasOwnProperty("$$base_module")||Q(_,"$$base_module",null),I(_))}),q(c,"$remove_method",function(_){var $,se=this;$=X(arguments);for(var ae=0;ae<$.length;ae++){var Te=$[ae];"string"==typeof Te||Te.$$is_string||se.$raise(B("TypeError"),se.$name()+" is not a symbol nor a string"),z(se),T.rdef(se,"$"+Te)}return se},-1),q(c,"$singleton_class?",function(){return!!this.$$is_singleton}),q(c,"$include",function(_){for(var $,se=this,ae=($=X(arguments)).length-1;ae>=0;ae--){var Te=$[ae];Te.$$is_module||le.$raise(B("TypeError"),"wrong argument type "+Te.$class()+" (expected Module)"),Te.$append_features(se),Te.$included(se)}return se},-1),q(c,"$included_modules",function(){return T.included_modules(this)}),q(c,"$include?",function(_){_.$$is_module||le.$raise(B("TypeError"),"wrong argument type "+_.$class()+" (expected Module)");var $,se,ae,Te=T.ancestors(this);for($=0,se=Te.length;$<se;$++)if((ae=Te[$])===_&&ae!==this)return!0;return!1}),q(c,"$instance_method",function(_){var x=this,$=x.$$prototype[U(_)];return(!$||$.$$stub)&&le.$raise(B("NameError").$new("undefined method `"+_+"' for class `"+x.$name()+"'",_)),B("UnboundMethod").$new(x,$.$$owner||x,$,_)}),q(c,"$instance_methods",function(_){return null==_&&(_=!0),fe(_)?T.instance_methods(this):T.own_instance_methods(this)},-1),q(c,"$included",H(he)),q(c,"$extended",H(he)),q(c,"$extend_object",function(_){return z(_),he}),q(c,"$method_added",function(_){return X(arguments),he},-1),q(c,"$method_removed",function(_){return X(arguments),he},-1),q(c,"$method_undefined",function(_){return X(arguments),he},-1),q(c,"$module_eval",function p(_){var se,ae,x=p.$$p||he,Te=this,Ae=he,xe=he,ke=he,De=he,Me=he;p.$$p=null,se=X(arguments),fe(x["$nil?"]())&&fe(!!T.compile)?(fe(C(1,3,!1)["$cover?"](se.$size()))||le.$raise(B("ArgumentError"),"wrong number of arguments (0 for 1..3)"),Ae=null==(ae=[].concat(k(se)))[0]?he:ae[0],xe=R(["file","eval"],{file:fe(ke=null==ae[1]?he:ae[1])?ke:"(eval)",eval:!0}),De=T.hash({arity_check:!1}).$merge(xe),Me=ee.$compile(Ae,De),x=re(le,"proc",[],function pe(){var ye=null==pe.$$s?this:pe.$$s;return new Function("Opal,self","return "+Me)(T,ye)},{$$s:Te})):fe(se["$any?"]())&&le.$raise(B("ArgumentError"),"wrong number of arguments ("+se.$size()+" for 0)\n\n  NOTE:If you want to enable passing a String argument please add \"require 'opal-parser'\" to your script\n");var ce,_e=x.$$s;return x.$$s=null,ce=x.apply(Te,[Te]),x.$$s=_e,ce},-1),q(c,"$module_exec",function p(_){var se,x=p.$$p||he,ae=this;p.$$p=null,se=X(arguments),x===he&&le.$raise(B("LocalJumpError"),"no block given");var Ae,Te=x.$$s;return x.$$s=null,Ae=x.apply(ae,se),x.$$s=Te,Ae},-1),q(c,"$method_defined?",function(_){var $=this.$$prototype[U(_)];return!!$&&!$.$$stub}),q(c,"$module_function",function(_){var $,se=this;if($=X(arguments),z(se),0===$.length)return se.$$module_function=!0,he;for(var ae=0,Te=$.length;ae<Te;ae++){var Ae=$[ae],de=U(Ae),Fe=se.$$prototype[de];T.defs(se,de,Fe)}return 1===$.length?$[0]:$},-1),q(c,"$name",function(){var _=this;if(_.$$full_name)return _.$$full_name;for(var x=[],$=_;$;){if($.$$name===he||null==$.$$name)return he;if(x.unshift($.$$name),($=$.$$base_module)===S)break}return 0===x.length?he:_.$$full_name=x.join("::")}),q(c,"$prepend",function(_){var $,se=this;0===($=X(arguments)).length&&le.$raise(B("ArgumentError"),"wrong number of arguments (given 0, expected 1+)");for(var ae=$.length-1;ae>=0;ae--){var Te=$[ae];Te.$$is_module||le.$raise(B("TypeError"),"wrong argument type "+Te.$class()+" (expected Module)"),Te.$prepend_features(se),Te.$prepended(se)}return se},-1),q(c,"$prepend_features",function(_){var x=this;return z(_),x.$$is_module||le.$raise(B("TypeError"),"wrong argument type "+x.$class()+" (expected Module)"),T.prepend_features(x,_),x}),q(c,"$prepended",H(he)),q(c,"$remove_const",function(_){return z(this),T.const_remove(this,_)}),q(c,"$to_s",function(){var x,_=this;return fe(x=T.Module.$name.call(_))?x:"#<"+(_.$$is_module?"Module":"Class")+":0x"+_.$__id__().$to_s(16)+">"}),q(c,"$undef_method",function(_){var $,se=this;$=X(arguments);for(var ae=0;ae<$.length;ae++){var Te=$[ae];"string"==typeof Te||Te.$$is_string||se.$raise(B("TypeError"),se.$name()+" is not a symbol nor a string"),z(se),T.udef(se,"$"+$[ae])}return se},-1),q(c,"$instance_variables",function(){var _=this,x=he;T.Module.$$nesting=h,x=_.$constants();var $=[];for(var se in _)_.hasOwnProperty(se)&&"$"!==se.charAt(0)&&"constructor"!==se&&!x["$include?"](se)&&$.push("@"+se);return $}),q(c,"$dup",function p(){var _=p.$$p||he,x=this,$=he;return p.$$p=null,($=P(x,L(x,"dup",p,!1,!0),"dup",[],_)).$copy_class_variables(x),$.$copy_constants(x),$}),q(c,"$copy_class_variables",function(_){for(var $ in _.$$cvars)this.$$cvars[$]=_.$$cvars[$]}),q(c,"$copy_constants",function(_){var $,se=_.$$const;for($ in se)f(this,$,se[$])}),q(c,"$refine",function p(_){var $,ae,Ae,x=p.$$p||he,se=this,Te=he;return p.$$p=null,ae=($=[se,he,he])[0],Te=$[1],Ae=T.id(_),void 0===se.$$refine_modules&&(se.$$refine_modules=Object.create(null)),(Te=void 0===se.$$refine_modules[Ae]?se.$$refine_modules[Ae]=B("Refinement").$new():se.$$refine_modules[Ae]).refinement_module=ae,Te.refined_class=_,re(Te,"class_exec",[],x.$to_proc()),Te}),q(c,"$refinements",function(){var x=this.$$refine_modules,$=R([],{});if(void 0===x)return $;for(var se in x)$["$[]="](x[se].refined_class,x[se]);return $}),q(c,"$using",function(_){return le.$raise("Module#using is not permitted in methods")}),ne(c,"class_eval","module_eval"),ne(c,"class_exec","module_exec"),ne(c,"inspect","to_s"),function(O,m){var l=N("::",m,"Refinement"),c=l.$$prototype;return c.refinement_module=c.refined_class=he,l.$attr_reader("refined_class"),q(l,"$inspect",function h(){var d=h.$$p||he,p=this;return h.$$p=null,fe(p.refinement_module)?"#<refinement:"+p.refined_class.$inspect()+"@"+p.refinement_module.$inspect()+">":P(p,L(p,"inspect",h,!1,!0),"inspect",[],d)})}(0,V)},Opal.modules["corelib/class"]=function(T){var le,Z,Y,X,fe=T.klass,Ce=T.send,f=T.defs,S=T.def,te=T.rb_plus,v=T.return_val,D=T.slice,z=T.send2,I=T.find_super,Q=T.Kernel,U=T.alias,re=T.nil,q=T.$$$;return T.top.$require("corelib/module"),le=[],Y=[Z=fe("::",null,"Class")].concat(le),X=T.$r(Y),f(Z,"$new",function k(R){var ee=k.$$p||re;if(k.$$p=null,null==R&&(R=X("Object")),!R.$$is_class)throw T.TypeError.$new("superclass must be a Class");var H=T.allocate_class(re,R);return R.$inherited(H),ee!==re&&Ce(H,"class_eval",[],ee.$to_proc()),H},-1),S(Z,"$allocate",function(){var ee=new this.$$constructor;return ee.$$id=T.uid(),ee}),S(Z,"$descendants",function(){return te(this.$subclasses(),Ce(this.$subclasses(),"map",[],"descendants".$to_proc()).$flatten())}),S(Z,"$inherited",v(re)),S(Z,"$initialize_dup",function(R){this.$initialize_copy(R),this.$$name=null,this.$$full_name=null}),S(Z,"$new",function k(R){var A,ee=k.$$p||re,M=this;k.$$p=null,A=D(arguments);var C=M.$allocate();return T.send(C,C.$initialize,A,ee),C},-1),S(Z,"$subclasses",function(){var R=this;if("undefined"!=typeof WeakRef){var ee,H,A=[];for(ee=0;ee<R.$$subclasses.length;ee++)void 0!==(H=R.$$subclasses[ee].deref())&&A.push(H);return A}return R.$$subclasses}),S(Z,"$superclass",function(){return this.$$super||re}),S(Z,"$to_s",function k(){k.$$p=null;var H=this.$$singleton_of;return H&&H.$$is_a_module?"#<Class:"+H.$name()+">":H?"#<Class:#<"+H.$$class.$name()+":0x"+T.id(H).$to_s(16)+">>":z(this,I(this,"to_s",k,!1,!0),"to_s",[],null)}),S(Z,"$attached_object",function(){var R=this;if(null!=R.$$singleton_of)return R.$$singleton_of;Q.$raise(q("TypeError"),"`"+R+"' is not a singleton class")}),U(Z,"inspect","to_s")},Opal.modules["corelib/basic_object"]=function(T){"use strict";var Z,Ce=T.slice,f=T.def,S=T.alias,te=T.return_val,v=T.Opal,D=T.truthy,z=T.range,I=T.Kernel,Q=T.to_a,U=T.hash2,N=T.send,G=T.eqeq,re=T.rb_ge,q=T.nil,E=T.$$$;return f(Z=(0,T.klass)("::",null,"BasicObject"),"$initialize",function(X){return Ce(arguments),q},-1),f(Z,"$==",function(X){return this===X}),f(Z,"$eql?",function(X){return this["$=="](X)}),S(Z,"equal?","=="),f(Z,"$__id__",function(){var X=this;return null!=X.$$id||T.prop(X,"$$id",T.uid()),X.$$id}),f(Z,"$__send__",function Y(X,k){var H,R=Y.$$p||q,A=this;Y.$$p=null,H=Ce(arguments,1),X.$$is_string||A.$raise(E("TypeError"),A.$inspect()+" is not a symbol nor a string");var M=A[T.jsid(X)];return M?(R!==q&&(M.$$p=R),M.apply(A,H)):(R!==q&&(A.$method_missing.$$p=R),A.$method_missing.apply(A,[X].concat(H)))},-2),f(Z,"$!",te(!1)),v.$pristine("!"),f(Z,"$!=",function(X){return this["$=="](X)["$!"]()}),f(Z,"$instance_eval",function Y(X){var ee,H,k=Y.$$p||q,A=this,M=q,L=q,ne=q,F=q,he=q;if(Y.$$p=null,ee=Ce(arguments),D(k["$nil?"]())&&D(!!T.compile))D(z(1,3,!1)["$cover?"](ee.$size()))||I.$raise(E("ArgumentError"),"wrong number of arguments (0 for 1..3)"),M=null==(H=[].concat(Q(ee)))[0]?q:H[0],L=U(["file","eval"],{file:D(ne=null==H[1]?q:H[1])?ne:"(eval)",eval:!0}),F=T.hash({arity_check:!1}).$merge(L),he=v.$compile(M,F),k=N(I,"proc",[],function m(){var l=null==m.$$s?this:m.$$s;return new Function("Opal,self","return "+he)(T,l)},{$$s:A});else{if(D(k["$nil?"]())&&D(re(ee.$length(),1))&&G(ee.$first()["$[]"](0),"@"))return A.$instance_variable_get(ee.$first());D(ee["$any?"]())&&I.$raise(E("ArgumentError"),"wrong number of arguments ("+ee.$size()+" for 0)")}var O,B=k.$$s;if(k.$$s=null,A.$$is_a_module){A.$$eval=!0;try{O=k.call(A,A)}finally{A.$$eval=!1}}else O=k.call(A,A);return k.$$s=B,O},-1),f(Z,"$instance_exec",function Y(X){var ee,k=Y.$$p||q,H=this;Y.$$p=null,ee=Ce(arguments),D(k)||I.$raise(E("ArgumentError"),"no block given");var M,A=k.$$s;if(k.$$s=null,H.$$is_a_module){H.$$eval=!0;try{M=k.apply(H,ee)}finally{H.$$eval=!1}}else M=k.apply(H,ee);return k.$$s=A,M},-1),f(Z,"$singleton_method_added",function(X){return Ce(arguments),q},-1),f(Z,"$singleton_method_removed",function(X){return Ce(arguments),q},-1),f(Z,"$singleton_method_undefined",function(X){return Ce(arguments),q},-1),f(Z,"$method_missing",function Y(X,k){var H,A=this,M=q;return Y.$$p=null,H=Ce(arguments,1),M=v.$inspect(A),I.$raise(E("NoMethodError").$new("undefined method `"+X+"' for "+M,X,H),q,I.$caller(1))},-2),v.$pristine(Z,"method_missing"),f(Z,"$respond_to_missing?",function(X,k){return null==k&&(k=!1),!1},-2)},Opal.modules["corelib/kernel"]=function(T){"use strict";var B,fe=T.truthy,Ce=T.coerce_to,f=T.respond_to,S=T.Opal,te=T.deny_frozen_access,v=T.freeze,D=T.freeze_props,z=T.jsid,I=T.module,Q=T.return_val,U=T.def,N=T.Kernel,G=T.gvars,re=T.slice,q=T.send,E=T.to_a,V=T.ensure_kwargs,le=T.eqeq,Z=T.hash2,Y=T.rb_plus,X=T.eqeqeq,k=T.return_self,R=T.rb_le,ee=T.extract_kwargs,H=T.rb_lt,A=T.Object,M=T.alias,C=T.klass,L=T.nil,ne=T.$$$;return function(F,he){var B=I("::","Kernel"),O=[B].concat([]),m=T.$r(O);U(B,"$=~",Q(!1)),U(B,"$!~",function(h){return this["$=~"](h)["$!"]()}),U(B,"$===",function(h){var p;return fe(p=this.$object_id()["$=="](h.$object_id()))?p:this["$=="](h)}),U(B,"$<=>",function(h){this.$$comparable=!0;var p=this["$=="](h);return p&&p!==L?0:L}),U(B,"$method",function(h){var d=this,p=d[z(h)];return(!p||p.$$stub)&&N.$raise(ne("NameError").$new("undefined method `"+h+"' for class `"+d.$class()+"'",h)),ne("Method").$new(d,p.$$owner||d.$class(),p,h)}),U(B,"$methods",function(h){return null==h&&(h=!0),fe(h)?T.methods(this):T.own_methods(this)},-1),U(B,"$public_methods",function(h){return null==h&&(h=!0),fe(h)?T.methods(this):T.receiver_methods(this)},-1),U(B,"$Array",function(h){var d;return h===L?[]:h.$$is_array?h:(d=S["$coerce_to?"](h,ne("Array"),"to_ary"))!==L||(d=S["$coerce_to?"](h,ne("Array"),"to_a"))!==L?d:[h]}),U(B,"$at_exit",function c(){var d,h=c.$$p||L;return null==G.__at_exit__&&(G.__at_exit__=L),c.$$p=null,G.__at_exit__=fe(d=G.__at_exit__)?d:[],G.__at_exit__["$<<"](h),h}),U(B,"$caller",function(h,d){var p,_;null==h&&(h=1),null==d&&(d=L),_=[];for(var x=h+1,$=(p=(new Error).$backtrace()).length;x<$;x++)p[x].match(/runtime\.js/)||_.push(p[x]);return d!=L&&(_=_.slice(0,d)),_},-1),U(B,"$caller_locations",function(h){var d,_=this;return d=re(arguments),q(q(_,"caller",E(d)),"map",[],function($){return null==$&&($=L),ne(ne(ne("Thread"),"Backtrace"),"Location").$new($)})},-1),U(B,"$class",function(){return this.$$class}),U(B,"$copy_instance_variables",function(h){var _,x,$,p=Object.keys(h);for(_=0,x=p.length;_<x;_++)"$"!==($=p[_]).charAt(0)&&h.hasOwnProperty($)&&(this[$]=h[$])}),U(B,"$copy_singleton_methods",function(h){var p,_,x,$;if(h.hasOwnProperty("$$meta")&&null!==h.$$meta){var se=T.get_singleton_class(h),ae=T.get_singleton_class(this);for(p=0,$=(x=Object.getOwnPropertyNames(se.$$prototype)).length;p<$;p++)T.is_method(_=x[p])&&(ae.$$prototype[_]=se.$$prototype[_]);ae.$$const=Object.assign({},se.$$const),Object.setPrototypeOf(ae.$$prototype,Object.getPrototypeOf(se.$$prototype))}for(p=0,$=(x=Object.getOwnPropertyNames(h)).length;p<$;p++)"$"===(_=x[p]).charAt(0)&&"$"!==_.charAt(1)&&h.hasOwnProperty(_)&&(this[_]=h[_])}),U(B,"$clone",function(h){var d,p=this,_=L;return null==(d=(h=V(h)).$$smap.freeze)&&(d=L),fe(d["$nil?"]())||le(d,!0)||le(d,!1)||p.$raise(m("ArgumentError"),"unexpected value for freeze: "+d.$class()),(_=p.$class().$allocate()).$copy_instance_variables(p),_.$copy_singleton_methods(p),_.$initialize_clone(p,Z(["freeze"],{freeze:d})),(le(d,!0)||fe(d["$nil?"]())&&fe(p["$frozen?"]()))&&_.$freeze(),_},-1),U(B,"$initialize_clone",function(h,d){return d=V(d),this.$initialize_copy(h),this},-2),U(B,"$define_singleton_method",function c(h,d){var p=c.$$p||L;return c.$$p=null,q(this.$singleton_class(),"define_method",[h,d],p.$to_proc())},-2),U(B,"$dup",function(){var h=this,d=L;return(d=h.$class().$allocate()).$copy_instance_variables(h),d.$initialize_dup(h),d}),U(B,"$initialize_dup",function(h){return this.$initialize_copy(h)}),U(B,"$enum_for",function c(h,d){var _,x,$,p=c.$$p||L,se=this;return c.$$p=null,(_=re(arguments)).length>0&&(x=_.shift()),null==x&&(x="each"),$=_,q(ne("Enumerator"),"for",[se,x].concat(E($)),p.$to_proc())},-1),U(B,"$equal?",function(h){return this===h}),U(B,"$exit",function(h){var d;for(null==G.__at_exit__&&(G.__at_exit__=L),null==h&&(h=!0),G.__at_exit__=fe(d=G.__at_exit__)?d:[];!fe(G.__at_exit__["$empty?"]());)G.__at_exit__.$pop().$call();return h=h.$$is_boolean?h?0:1:Ce(h,ne("Integer"),"to_int"),T.exit(h),L},-1),U(B,"$extend",function(h){var p,_=this;0==(p=re(arguments)).length&&_.$raise(ne("ArgumentError"),"wrong number of arguments (given 0, expected 1+)"),te(_);for(var x=_.$singleton_class(),$=p.length-1;$>=0;$--){var se=p[$];se.$$is_module||N.$raise(ne("TypeError"),"wrong argument type "+se.$class()+" (expected Module)"),se.$append_features(x),se.$extend_object(_),se.$extended(_)}return _},-1),U(B,"$freeze",function(){var h=this;return fe(h["$frozen?"]())?h:"object"==typeof h?(D(h),v(h)):h}),U(B,"$frozen?",function(){switch(typeof this){case"string":case"symbol":case"number":case"boolean":return!0;case"object":return this.$$frozen||!1;default:return!1}}),U(B,"$gets",function(h){var d;return null==G.stdin&&(G.stdin=L),d=re(arguments),q(G.stdin,"gets",E(d))},-1),U(B,"$hash",function(){return this.$__id__()}),U(B,"$initialize_copy",Q(L));var l=[];U(B,"$inspect",function(){var h=this,d=L,p=L,_=L;return function(){try{try{return d="",p=h.$__id__(),fe(l["$include?"](p))?d=" ...":(l["$<<"](p),_=!0,q(h.$instance_variables(),"each",[],function $(se){var Te,Ae;return null==se&&(se=L),Te=(null==$.$$s?this:$.$$s).$instance_variable_get(se),Ae=m("Opal").$inspect(Te),d=Y(d," "+se+"="+Ae)},{$$s:h})),"#<"+h.$class()+":0x"+p.$to_s(16)+d+">"}catch($){if(!T.rescue($,[m("StandardError")]))throw $;try{return"#<"+h.$class()+":0x"+p.$to_s(16)+">"}finally{T.pop_exception()}}}finally{fe(_)&&l.$pop()}}()}),U(B,"$instance_of?",function(h){return!h.$$is_class&&!h.$$is_module&&N.$raise(ne("TypeError"),"class or module required"),this.$$class===h}),U(B,"$instance_variable_defined?",function(h){return h=S["$instance_variable_name!"](h),T.hasOwnProperty.call(this,h.substr(1))}),U(B,"$instance_variable_get",function(h){h=S["$instance_variable_name!"](h);var p=this[T.ivar(h.substr(1))];return null==p?L:p}),U(B,"$instance_variable_set",function(h,d){return te(this),h=S["$instance_variable_name!"](h),this[T.ivar(h.substr(1))]=d}),U(B,"$remove_instance_variable",function(h){var d=this;h=S["$instance_variable_name!"](h);var _,p=T.ivar(h.substr(1));return d.hasOwnProperty(p)?(_=d[p],delete d[p],_):N.$raise(ne("NameError"),"instance variable "+h+" not defined")}),U(B,"$instance_variables",function(){var p,d=[];for(var _ in this)this.hasOwnProperty(_)&&"$"!==_.charAt(0)&&(p="$"===_.substr(-1)?_.slice(0,_.length-1):_,d.push("@"+p));return d}),U(B,"$Integer",function(h,d){var p,_,x;return h.$$is_string?"0"===h?0:(void 0===d?d=0:(1===(d=Ce(d,ne("Integer"),"to_int"))||d<0||d>36)&&N.$raise(ne("ArgumentError"),"invalid radix "+d),_=(_=(_=h.toLowerCase()).replace(/(\d)_(?=\d)/g,"$1")).replace(/^(\s*[+-]?)(0[bodx]?)/,function($,se,ae){switch(ae){case"0b":if(0===d||2===d)return d=2,se;case"0":case"0o":if(0===d||8===d)return d=8,se;case"0d":if(0===d||10===d)return d=10,se;case"0x":if(0===d||16===d)return d=16,se}N.$raise(ne("ArgumentError"),'invalid value for Integer(): "'+h+'"')}),x="0-"+((d=0===d?10:d)<=10?d-1:"9a-"+String.fromCharCode(d-11+97)),new RegExp("^\\s*[+-]?["+x+"]+\\s*$").test(_)||N.$raise(ne("ArgumentError"),'invalid value for Integer(): "'+h+'"'),p=parseInt(_,d),isNaN(p)&&N.$raise(ne("ArgumentError"),'invalid value for Integer(): "'+h+'"'),p):(void 0!==d&&N.$raise(ne("ArgumentError"),"base specified for non string value"),h===L&&N.$raise(ne("TypeError"),"can't convert nil into Integer"),h.$$is_number?((h===1/0||h===-1/0||isNaN(h))&&N.$raise(ne("FloatDomainError"),h),Math.floor(h)):h["$respond_to?"]("to_int")&&(p=h.$to_int())!==L?p:S["$coerce_to!"](h,ne("Integer"),"to_i"))},-2),U(B,"$Float",function(h){var d;return h===L&&N.$raise(ne("TypeError"),"can't convert nil into Float"),h.$$is_string?(d=(d=h.toString()).replace(/(\d)_(?=\d)/g,"$1"),/^\s*[-+]?0[xX][0-9a-fA-F]+\s*$/.test(d)?N.$Integer(d):(/^\s*[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?\s*$/.test(d)||N.$raise(ne("ArgumentError"),'invalid value for Float(): "'+h+'"'),parseFloat(d))):S["$coerce_to!"](h,ne("Float"),"to_f")}),U(B,"$Hash",function(h){return fe(h["$nil?"]())||le(h,[])?Z([],{}):X(ne("Hash"),h)?h:S["$coerce_to!"](h,ne("Hash"),"to_hash")}),U(B,"$is_a?",function(h){return!h.$$is_class&&!h.$$is_module&&N.$raise(ne("TypeError"),"class or module required"),T.is_a(this,h)}),U(B,"$itself",k),U(B,"$lambda",function c(){var h=c.$$p||L;return c.$$p=null,T.lambda(h)}),U(B,"$load",function(h){return h=S["$coerce_to!"](h,ne("String"),"to_str"),T.load(h)}),U(B,"$loop",function c(){var h=c.$$p||L,p=L;if(c.$$p=null,h===L)return q(this,"enum_for",["loop"],function(){return ne(ne("Float"),"INFINITY")});for(;fe(!0);)try{T.yieldX(h,[])}catch(_){if(!T.rescue(_,[ne("StopIteration")]))throw _;p=_;try{return p.$result()}finally{T.pop_exception()}}return this}),U(B,"$nil?",Q(!1)),U(B,"$printf",function(h){var d,p,_=this;return d=re(arguments),fe((p=d)["$any?"]())&&_.$print(q(_,"format",E(p))),L},-1),U(B,"$proc",function c(){var h=c.$$p||L;return c.$$p=null,fe(h)||N.$raise(ne("ArgumentError"),"tried to create Proc object without a block"),h.$$is_lambda=!1,h}),U(B,"$puts",function(h){var d;return null==G.stdout&&(G.stdout=L),d=re(arguments),q(G.stdout,"puts",E(d))},-1),U(B,"$p",function(h){var d,p;return d=re(arguments),q(p=d,"each",[],function(x){return null==G.stdout&&(G.stdout=L),null==x&&(x=L),G.stdout.$puts(x.$inspect())}),fe(R(p.$length(),1))?p["$[]"](0):p},-1),U(B,"$print",function(h){var d;return null==G.stdout&&(G.stdout=L),d=re(arguments),q(G.stdout,"print",E(d))},-1),U(B,"$readline",function(h){var d;return null==G.stdin&&(G.stdin=L),d=re(arguments),q(G.stdin,"readline",E(d))},-1),U(B,"$warn",function(h,d){var p,_,x,$,se,ae,Te=this,Ae=L;return null==G.VERBOSE&&(G.VERBOSE=L),null==G.stderr&&(G.stderr=L),p=re(arguments),_=ee(p),x=p,null==($=(_=V(_)).$$smap.uplevel)&&($=L),fe($)&&($=S["$coerce_to!"]($,ne("Integer"),"to_str"),fe(H($,0))&&N.$raise(ne("ArgumentError"),"negative level ("+$+")"),se=(ae=Te.$caller(Y($,1),1).$first())===L||null==ae?L:ae.$split(":in `"),Ae=se===L||null==se?L:se.$first(),fe(Ae)&&(Ae+=": "),x=q(x,"map",[],function(Fe){return null==Fe&&(Fe=L),Ae+"warning: "+Fe})),fe(G.VERBOSE["$nil?"]())||fe(x["$empty?"]())?L:q(G.stderr,"puts",E(x))},-1),U(B,"$raise",function(h,d,p){throw null==G["!"]&&(G["!"]=L),null==G["@"]&&(G["@"]=L),null==d&&(d=L),null==p&&(p=L),null==h&&G["!"]!==L?G["!"]:(null==h?h=ne("RuntimeError").$new(""):f(h,"$to_str")?h=ne("RuntimeError").$new(h.$to_str()):h.$$is_class&&f(h,"$exception")?h=h.$exception(d):h.$$is_exception||(h=ne("TypeError").$new("exception class/object expected")),p!==L&&h.$set_backtrace(p),G["!"]!==L&&T.exceptions.push(G["!"]),G["!"]=h,G["@"]=h.$backtrace(),h)},-1),U(B,"$rand",function(h){return void 0===h?ne(ne("Random"),"DEFAULT").$rand():(h.$$is_number&&(h<0&&(h=Math.abs(h)),h%1!=0&&(h=h.$to_i()),0===h&&(h=void 0)),ne(ne("Random"),"DEFAULT").$rand(h))},-1),U(B,"$respond_to?",function(h,d){var p=this;null==d&&(d=!1);var _=p[z(h)];return"function"==typeof _&&!_.$$stub||!0!==p["$respond_to_missing?"].$$pristine&&p["$respond_to_missing?"](h,d)},-2),U(B,"$respond_to_missing?",function(h,d){return null==d&&(d=!1),!1},-2),S.$pristine(B,"respond_to?","respond_to_missing?"),U(B,"$require",function(h){return"string"!=typeof h&&T.String&&T.Array&&(h=S["$coerce_to!"](h,ne("String"),"to_str")),T.require(h)}),U(B,"$require_relative",function(h){return S["$try_convert!"](h,ne("String"),"to_str"),h=ne("File").$expand_path(ne("File").$join(T.current_file,"..",h)),T.require(h)}),U(B,"$require_tree",function(h,d){var p;null==(p=(d=V(d)).$$smap.autoload)&&(p=!1);var _=[];for(var x in h=ne("File").$expand_path(h),"."===(h=T.normalize(h))&&(h=""),T.modules)x["$start_with?"](h)&&_.push(p?[x,!0]:[x,T.require(x)]);return _},-2),U(B,"$singleton_class",function(){return T.get_singleton_class(this)}),U(B,"$sleep",function(h){null==h&&(h=L),h===L&&N.$raise(ne("TypeError"),"can't convert NilClass into time interval"),h.$$is_number||N.$raise(ne("TypeError"),"can't convert "+h.$class()+" into time interval"),h<0&&N.$raise(ne("ArgumentError"),"time interval must be positive");for(var d=T.global.performance?function(){return performance.now()}:function(){return new Date},p=d();d()-p<=1e3*h;);return Math.round(h)},-1),U(B,"$srand",function(h){return null==h&&(h=m("Random").$new_seed()),ne("Random").$srand(h)},-1),U(B,"$String",function(h){var d;return fe(d=S["$coerce_to?"](h,ne("String"),"to_str"))?d:S["$coerce_to!"](h,ne("String"),"to_s")}),U(B,"$tap",function c(){var h=c.$$p||L;return c.$$p=null,T.yield1(h,this),this}),U(B,"$to_proc",k),U(B,"$to_s",function(){return"#<"+this.$class()+":0x"+this.$__id__().$to_s(16)+">"}),U(B,"$catch",function c(h){var d=c.$$p||L,p=L,_=L;c.$$p=null,null==h&&(h=L);try{return h=fe(p=h)?p:A.$new(),T.yield1(d,h)}catch(x){if(!T.rescue(x,[ne("UncaughtThrowError")]))throw x;_=x;try{return le(_.$tag(),h)?_.$value():N.$raise()}finally{T.pop_exception()}}},-1),U(B,"$throw",function(h,d){return null==d&&(d=L),N.$raise(ne("UncaughtThrowError").$new(h,d))},-2),U(B,"$open",function c(h){var _,d=c.$$p||L;return c.$$p=null,_=re(arguments),q(ne("File"),"open",E(_),d.$to_proc())},-1),U(B,"$yield_self",function c(){var h=c.$$p||L;return c.$$p=null,h===L?q(this,"enum_for",["yield_self"],Q(1)):T.yield1(h,this)}),M(B,"fail","raise"),M(B,"kind_of?","is_a?"),M(B,"object_id","__id__"),M(B,"public_send","__send__"),M(B,"send","__send__"),M(B,"then","yield_self"),M(B,"to_enum","enum_for")}(),B=C("::",null,"Object"),delete A.$$prototype.$require,B.$include(N)},Opal.modules["corelib/main"]=function(T){var I,fe=T.return_val,Ce=T.def,f=T.Object,S=T.slice,te=T.Kernel;return Ce(I=T.get_singleton_class(T.top),"$to_s",fe("main")),Ce(I,"$include",function(N){return f.$include(N)}),Ce(I,"$autoload",function(N){var G;return G=S(arguments),T.Object.$autoload.apply(T.Object,G)},-1),Ce(I,"$using",function(N){return te.$raise("main.using is permitted only at toplevel")})},Opal.modules["corelib/error/errno"]=function(T){var N,G,re,fe=T.module,Ce=T.truthy,f=T.rb_plus,S=T.send2,te=T.find_super,v=T.def,D=T.klass,z=[],I=T.nil,Q=T.$$$;return function(U,N){var q,V,G=fe("::","Errno"),E=([G].concat(N),I);for(q=[["EINVAL","Invalid argument",22],["EEXIST","File exists",17],["EISDIR","Is a directory",21],["EMFILE","Too many open files",24],["ESPIPE","Illegal seek",29],["EACCES","Permission denied",13],["EPERM","Operation not permitted",1],["ENOENT","No such file or directory",2],["ENAMETOOLONG","File name too long",36]],E=I,V=0;V<q.length;V++)!function(){var X,Z=q[V][1],Y=q[V][2];(E=T.klass(G,T.SystemCallError,q[V][0])).errno=Y,X=T.get_singleton_class(E),v(X,"$new",function R(ee){var M=I;return R.$$p=null,null==ee&&(ee=I),M=Z,Ce(ee)&&(M=f(M," - "+ee)),S(this,te(this,"new",R,!1,!0),"new",[M],null)},-1)}()}(0,z),N=Q("StandardError"),G=z,[re=D("::",N,"SystemCallError")].concat(G),v(re,"$errno",function(){return this.$class().$errno()}),T.get_singleton_class(re).$attr_reader("errno")},Opal.modules["corelib/error"]=function(T){var R,ee,fe=T.klass,Ce=T.slice,f=T.gvars,S=T.defs,te=T.send,v=T.to_a,D=T.def,z=T.truthy,I=T.hash2,Q=T.Kernel,U=T.not,N=T.rb_plus,G=T.eqeq,re=T.Object,q=T.ensure_kwargs,E=T.send2,V=T.find_super,le=T.module,Z=[],Y=T.nil,X=T.$$$;return function(k,R,ee){var P,H=fe("::",R,"Exception"),A=[H].concat(ee),M=T.$r(A);function L(ne){for(var he,F=[],B=0;B<ne.length;B++){var O=ne[B];!O||!O.$$is_string||((he=O.match(/^    at (.*?) \((.*?)\)$/))?F.push(he[2]+":in `"+he[1]+"'"):(he=O.match(/^    at (.*?)$/))?F.push(he[1]+":in `undefined'"):(he=O.match(/^  from (.*?)$/))?F.push(he[1]):(he=O.match(/^(.*?)@(.*?)$/))&&F.push(he[2]+":in `"+he[1]+"'"))}return F}H.$$prototype.message=Y,T.prop(H.$$prototype,"$$is_exception",!0),Error.stackTraceLimit=100,S(H,"$new",function(F){var B,O=this;null==f["!"]&&(f["!"]=Y);var m=(B=Ce(arguments)).length>0?B[0]:Y,l=new O.$$constructor(m);return l.name=O.$$name,l.message=m,l.cause=f["!"],T.send(l,l.$initialize,B),T.config.enable_stack_trace&&Error.captureStackTrace&&Error.captureStackTrace(l,P),l},-1),P=H.$new,S(H,"$exception",function(F){var he,O=this;return he=Ce(arguments),te(O,"new",v(he))},-1),D(H,"$initialize",function(F){var he,B,O=this;return he=Ce(arguments),O.message=(B=he).length>0?B[0]:Y},-1),D(H,"$backtrace",function(){var F=this;if(F.backtrace)return F.backtrace;var he=F.stack;return void 0!==he&&he.$$is_string?F.backtrace=L(he.split("\n")):he?F.backtrace=L(he):[]}),D(H,"$backtrace_locations",function(){var F;return this.backtrace_locations||(this.backtrace_locations=(F=this.$backtrace())===Y||null==F?Y:te(F,"map",[],function(O){return null==O&&(O=Y),X(X(X("Thread"),"Backtrace"),"Location").$new(O)})),this.backtrace_locations}),D(H,"$cause",function(){return this.cause||Y}),D(H,"$exception",function(F){var he=this;if(null==F&&(F=Y),F===Y||he===F)return he;var B=he.$clone();return B.message=F,he.backtrace&&(B.backtrace=he.backtrace.$dup()),B.stack=he.stack,B.cause=he.cause,B},-1),D(H,"$message",function(){return this.$to_s()}),D(H,"$full_message",function(F){var B,O=this,m=Y,l=Y,c=Y,h=Y,d=Y,p=Y,_=Y,x=Y,$=Y;return null==f.stderr&&(f.stderr=Y),null==F&&(F=Y),z(M("Hash","skip_raise")?"constant":Y)?(c=(B=[(F=I(["highlight","order"],{highlight:f.stderr["$tty?"](),order:"top"}).$merge(z(m=F)?m:I([],{})))["$[]"]("highlight"),F["$[]"]("order")])[1],z([!0,!1]["$include?"](l=B[0]))||Q.$raise(X("ArgumentError"),"expected true or false as highlight: "+l),z(["top","bottom"]["$include?"](c))||Q.$raise(X("ArgumentError"),"expected :top or :bottom as order: "+c),z(l)?(h="\x1b[1;4m",d="\x1b[1m",p="\x1b[m"):h=d=p="",_=O.$backtrace().$dup(),(U(_)||z(_["$empty?"]()))&&(_=O.$caller()),x=_.$shift(),$=N($=x+": ",""+d+O.$to_s()+" ("+h+O.$class()+p+d+")"+p+"\n"),$=N($,te(_,"map",[],function(ae){return null==ae&&(ae=Y),"\tfrom "+ae+"\n"}).$join()),z(O.$cause())&&($=N($,O.$cause().$full_message(I(["highlight"],{highlight:l})))),G(c,"bottom")&&($=$.$split("\n").$reverse().$join("\n"),$=N(d+"Traceback"+p+" (most recent call last):\n",$)),$):O.message+"\n"+O.stack},-1),D(H,"$inspect",function(){var F=this,he=Y;return he=F.$to_s(),z(he["$empty?"]())?F.$class().$to_s():"#<"+F.$class().$to_s()+": "+F.$to_s()+">"}),D(H,"$set_backtrace",function(F){var O,m,he=this,B=!0;if(F===Y)he.backtrace=Y,he.stack="";else if(F.$$is_string)he.backtrace=[F],he.stack="  from "+F;else{if(F.$$is_array){for(O=0,m=F.length;O<m;O++)if(!F[O].$$is_string){B=!1;break}}else B=!1;!1===B&&Q.$raise(X("TypeError"),"backtrace must be Array of String"),he.backtrace=F,he.stack=te(F,"map",[],function(c){return null==c&&(c=Y),N("  from ",c)}).join("\n")}return F}),D(H,"$to_s",function(){var he,B,F=this;return z(he=z(B=F.message)?F.message.$to_s():B)?he:F.$class().$to_s()})}(0,Error,Z),fe("::",X("Exception"),"ScriptError"),fe("::",X("ScriptError"),"SyntaxError"),fe("::",X("ScriptError"),"LoadError"),fe("::",X("ScriptError"),"NotImplementedError"),fe("::",X("Exception"),"SystemExit"),fe("::",X("Exception"),"NoMemoryError"),fe("::",X("Exception"),"SignalException"),fe("::",X("SignalException"),"Interrupt"),fe("::",X("Exception"),"SecurityError"),fe("::",X("Exception"),"SystemStackError"),fe("::",X("Exception"),"StandardError"),fe("::",X("StandardError"),"EncodingError"),fe("::",X("StandardError"),"ZeroDivisionError"),fe("::",X("StandardError"),"NameError"),fe("::",X("NameError"),"NoMethodError"),fe("::",X("StandardError"),"RuntimeError"),fe("::",X("RuntimeError"),"FrozenError"),fe("::",X("StandardError"),"LocalJumpError"),fe("::",X("StandardError"),"TypeError"),fe("::",X("StandardError"),"ArgumentError"),fe("::",X("ArgumentError"),"UncaughtThrowError"),fe("::",X("StandardError"),"IndexError"),fe("::",X("IndexError"),"StopIteration"),fe("::",X("StopIteration"),"ClosedQueueError"),fe("::",X("IndexError"),"KeyError"),fe("::",X("StandardError"),"RangeError"),fe("::",X("RangeError"),"FloatDomainError"),fe("::",X("StandardError"),"IOError"),fe("::",X("IOError"),"EOFError"),fe("::",X("StandardError"),"SystemCallError"),fe("::",X("StandardError"),"RegexpError"),fe("::",X("StandardError"),"ThreadError"),fe("::",X("StandardError"),"FiberError"),re.$autoload("Errno","corelib/error/errno"),R=X("RuntimeError"),(ee=fe("::",R,"FrozenError")).$attr_reader("receiver"),D(ee,"$initialize",function H(A,M){var C,L=this;return H.$$p=null,null==(C=(M=q(M)).$$smap.receiver)&&(C=Y),E(L,V(L,"initialize",H,!1,!0),"initialize",[A],null),L.receiver=C},-2),function(k,R){var ee=fe("::",R,"UncaughtThrowError");ee.$$prototype.tag=Y,ee.$attr_reader("tag","value"),D(ee,"$initialize",function A(M,C){var L=this;return A.$$p=null,null==C&&(C=Y),L.tag=M,L.value=C,E(L,V(L,"initialize",A,!1,!0),"initialize",["uncaught throw "+L.tag.$inspect()],null)},-2)}(0,X("ArgumentError")),function(k,R){var ee=fe("::",null,"NameError");ee.$attr_reader("name"),D(ee,"$initialize",function H(A,M){var P=this;return H.$$p=null,null==M&&(M=Y),E(P,V(P,"initialize",H,!1,!0),"initialize",[A],null),P.name=M},-2)}(),function(k,R){var ee=fe("::",null,"NoMethodError");ee.$attr_reader("args"),D(ee,"$initialize",function H(A,M,C){var L=this;return H.$$p=null,null==M&&(M=Y),null==C&&(C=[]),E(L,V(L,"initialize",H,!1,!0),"initialize",[A,M],null),L.args=C},-2)}(),fe("::",null,"StopIteration").$attr_reader("result"),function(k,R){var ee=fe("::",null,"KeyError"),H=ee.$$prototype;H.receiver=H.key=Y,D(ee,"$initialize",function A(M,C){var P,L,F=this;return A.$$p=null,null==(P=(C=q(C)).$$smap.receiver)&&(P=Y),null==(L=C.$$smap.key)&&(L=Y),E(F,V(F,"initialize",A,!1,!0),"initialize",[M],null),F.receiver=P,F.key=L},-2),D(ee,"$receiver",function(){var C;return z(C=this.receiver)?C:Q.$raise(X("ArgumentError"),"no receiver is available")}),D(ee,"$key",function(){var C;return z(C=this.key)?C:Q.$raise(X("ArgumentError"),"no key is available")})}(),function(k,R){var H=[le("::","JS")].concat(R);return fe(H[0],null,"Error"),Y}(0,Z)},Opal.modules["corelib/constants"]=function(T){var fe=T.const_set,f=T.$$$;return fe("::","RUBY_PLATFORM","opal"),fe("::","RUBY_ENGINE","opal"),fe("::","RUBY_VERSION","3.2.0"),fe("::","RUBY_ENGINE_VERSION","1.7.4"),fe("::","RUBY_RELEASE_DATE","2023-09-14"),fe("::","RUBY_PATCHLEVEL",0),fe("::","RUBY_REVISION","0"),fe("::","RUBY_COPYRIGHT","opal - Copyright (C) 2011-2023 Adam Beynon and the Opal contributors"),fe("::","RUBY_DESCRIPTION","opal "+f("RUBY_ENGINE_VERSION")+" ("+f("RUBY_RELEASE_DATE")+" revision "+f("RUBY_REVISION")+")")},Opal.modules["opal/base"]=function(T){var fe=T.Object;return fe.$require("corelib/runtime"),fe.$require("corelib/helpers"),fe.$require("corelib/module"),fe.$require("corelib/class"),fe.$require("corelib/basic_object"),fe.$require("corelib/kernel"),fe.$require("corelib/main"),fe.$require("corelib/error"),fe.$require("corelib/constants")},Opal.modules["corelib/nil"]=function(T){var Z,V,Ce=T.Kernel,f=T.def,S=T.return_val,te=T.ensure_kwargs,v=T.NilClass,D=T.slice,z=T.truthy,I=T.rb_gt,Q=T.alias,N=T.nil,G=T.$$$;return[V=(0,T.klass)("::",null,"NilClass")].concat([]),V.$$prototype.$$meta=V,Z=T.get_singleton_class(V),f(Z,"$allocate",function(){return Ce.$raise(G("TypeError"),"allocator undefined for "+this.$name())}),T.udef(Z,"$new"),f(V,"$!",S(!0)),f(V,"$&",S(!1)),f(V,"$|",function(Y){return!1!==Y&&Y!==N}),f(V,"$^",function(Y){return!1!==Y&&Y!==N}),f(V,"$==",function(Y){return Y===N}),f(V,"$dup",S(N)),f(V,"$clone",function(Y){return Y=te(Y),N},-1),f(V,"$inspect",S("nil")),f(V,"$nil?",S(!0)),f(V,"$singleton_class",function(){return v}),f(V,"$to_a",function(){return[]}),f(V,"$to_h",function(){return T.hash()}),f(V,"$to_i",S(0)),f(V,"$to_s",S("")),f(V,"$to_c",function(){return G("Complex").$new(0,0)}),f(V,"$rationalize",function(Y){var X;return X=D(arguments),z(I(X.$length(),1))&&Ce.$raise(G("ArgumentError")),Ce.$Rational(0,1)},-1),f(V,"$to_r",function(){return Ce.$Rational(0,1)}),f(V,"$instance_variables",function(){return[]}),Q(V,"to_f","to_i")},Opal.modules["corelib/boolean"]=function(T){"use strict";var fe=T.klass,Ce=T.Kernel,f=T.def,S=T.return_self,te=T.ensure_kwargs,v=T.slice,D=T.truthy,z=T.send2,I=T.find_super,Q=T.to_a,U=T.alias,G=T.nil,re=T.$$$;return function(q,E,V){var k,le=fe("::",E,"Boolean");[le].concat([]),T.prop(le.$$prototype,"$$is_boolean",!0);for(var Y=["$$class","$$meta"],X=0;X<Y.length;X++)Object.defineProperty(le.$$prototype,Y[X],{configurable:!0,enumerable:!1,get:function(){return 1==this?T.TrueClass:0==this?T.FalseClass:T.Boolean}});Object.defineProperty(le.$$prototype,"$$id",{configurable:!0,enumerable:!1,get:function(){return 1==this?2:0==this?0:G}}),k=T.get_singleton_class(le),f(k,"$allocate",function(){return Ce.$raise(re("TypeError"),"allocator undefined for "+this.$name())}),T.udef(k,"$new"),f(le,"$__id__",function(){return this.valueOf()?2:0}),f(le,"$!",function(){return 1!=this}),f(le,"$&",function(R){return 1==this&&!1!==R&&R!==G}),f(le,"$|",function(R){return 1==this||!1!==R&&R!==G}),f(le,"$^",function(R){return 1==this?!1===R||R===G:!1!==R&&R!==G}),f(le,"$==",function(R){return 1==this===R.valueOf()}),f(le,"$singleton_class",function(){return this.$$meta}),f(le,"$to_s",function(){return 1==this?"true":"false"}),f(le,"$dup",S),f(le,"$clone",function(R){return R=te(R),this},-1),f(le,"$method_missing",function k(R,ee){var M,H=k.$$p||G,C=this;k.$$p=null,M=v(arguments,1);var P=C.$$class.$$prototype[T.jsid(R)];return D(void 0!==P&&!P.$$stub)||z(C,I(C,"method_missing",k,!1,!0),"method_missing",[R].concat(Q(M)),H),T.send(C,P,M,H)},-2),f(le,"$respond_to_missing?",function(R,ee){null==ee&&(ee=!1);var A=this.$$class.$$prototype[T.jsid(R)];return void 0!==A&&!A.$$stub},-2),U(le,"eql?","=="),U(le,"equal?","=="),U(le,"inspect","to_s"),U(le,"object_id","__id__")}(0,Boolean),fe("::",re("Boolean"),"TrueClass"),fe("::",re("Boolean"),"FalseClass"),G},Opal.modules["corelib/comparable"]=function(T){var fe=T.truthy,Ce=T.module,f=T.rb_gt,S=T.rb_lt,te=T.eqeqeq,v=T.Kernel,D=T.def,z=T.nil,I=T.$$$;return function(Q){var U=Ce("::","Comparable"),N=z;function G(E){return T.is_a(E,T.Integer)?E:f(E,0)?1:S(E,0)?-1:0}function q(E,V){var le=E["$<=>"](V);return fe(le)||function re(E,V){var le;le=te(z,N=V)||te(!0,N)||te(!1,N)||te(I("Integer"),N)||te(I("Float"),N)?V.$inspect():V.$$class,v.$raise(I("ArgumentError"),"comparison of "+E.$class()+" with "+le+" failed")}(E,V),G(le)}return D(U,"$==",function(V){var le=this,Z=z;return!!fe(le["$equal?"](V))||le["$<=>"]!=T.Kernel["$<=>"]&&(le.$$comparable?(le.$$comparable=!1,!1):!!fe(Z=le["$<=>"](V))&&0==G(Z))}),D(U,"$>",function(V){return q(this,V)>0}),D(U,"$>=",function(V){return q(this,V)>=0}),D(U,"$<",function(V){return q(this,V)<0}),D(U,"$<=",function(V){return q(this,V)<=0}),D(U,"$between?",function(V,le){return!(S(this,V)||f(this,le))}),D(U,"$clamp",function(V,le){var Y,X,Z=this;if(null==le&&(le=z),le===z&&(T.is_a(V,T.Range)||v.$raise(I("TypeError"),"wrong argument type "+V.$class()+" (expected Range)"),X=V.excl,le=V.end,V=V.begin,le!==z&&X&&v.$raise(I("ArgumentError"),"cannot clamp with an exclusive range")),V!==z&&le!==z&&q(V,le)>0&&v.$raise(I("ArgumentError"),"min argument must be smaller than max argument"),V!==z){if(0==(Y=q(Z,V)))return Z;if(Y<0)return V}return le!==z&&(Y=q(Z,le))>0?le:Z},-2)}()},Opal.modules["corelib/regexp"]=function(T){var C,P,he,O,m,L,ne,F,fe=T.coerce_to,Ce=T.prop,f=T.freeze,S=T.klass,te=T.const_set,v=T.send2,D=T.find_super,z=T.def,I=T.truthy,Q=T.gvars,U=T.slice,N=T.Kernel,G=T.Opal,re=T.alias,q=T.send,E=T.hash2,V=T.rb_plus,le=T.ensure_kwargs,Z=T.rb_ge,Y=T.to_a,X=T.eqeqeq,k=T.rb_minus,R=T.return_ivar,ee=[],H=T.nil,A=T.$$$;return S("::",A("StandardError"),"RegexpError"),C=RegExp,P=ee,ne=[L=S("::",C,"Regexp")].concat(P),F=T.$r(ne),te(L,"IGNORECASE",1),te(L,"EXTENDED",2),te(L,"MULTILINE",4),T.prop(L.$$prototype,"$$is_regexp",!0),O=[he=T.get_singleton_class(L)].concat(ne),m=T.$r(O),z(he,"$allocate",function l(){var c=l.$$p||H,d=H;return l.$$p=null,(d=v(this,D(this,"allocate",l,!1,!0),"allocate",[],c)).uninitialized=!0,d}),z(he,"$escape",function(c){return c=fe(c,A("String"),"to_str"),T.escape_regexp(c)}),z(he,"$last_match",function(c){return null==Q["~"]&&(Q["~"]=H),null==c&&(c=H),I(c["$nil?"]())?Q["~"]:I(Q["~"])?Q["~"]["$[]"](c):H},-1),z(he,"$union",function(c){var d,_,x,$,se,ae,p=this;if(0==(d=U(arguments)).length)return/(?!)/;if(1==d.length&&d[0].$$is_regexp)return d[0];_=d[0].$$is_array,d.length>1&&_&&N.$raise(A("TypeError"),"no implicit conversion of Array into String"),_&&(d=d[0]),se=void 0,x=[];for(var Te=0;Te<d.length;Te++)($=d[Te]).$$is_string?x.push(p.$escape($)):$.$$is_regexp?(ae=$.$options(),null!=se&&se!=ae&&N.$raise(A("TypeError"),"All expressions must use the same options"),se=ae,x.push("("+$.source+")")):x.push(p.$escape($.$to_str()));return p.$new(x.$join("|"),se)},-1),z(he,"$new",function(c,h){if(c.$$is_regexp)return new RegExp(c);if("\\"===(c=G["$coerce_to!"](c,A("String"),"to_str")).charAt(c.length-1)&&"\\"!==c.charAt(c.length-2)&&N.$raise(A("RegexpError"),"too short escape sequence: /"+c+"/"),c=c.replace("\\A","^").replace("\\z","$"),void 0===h||h["$!"]())return new RegExp(c);if(h.$$is_number){var d="";m("IGNORECASE")&h&&(d+="i"),m("MULTILINE")&h&&(d+="m"),h=d}else h="i";return new RegExp(c,h)},-2),re(he,"compile","new"),re(he,"quote","escape"),z(L,"$==",function(B){return B instanceof RegExp&&this.toString()===B.toString()}),z(L,"$===",function(B){return this.$match(G["$coerce_to?"](B,A("String"),"to_str"))!==H}),z(L,"$=~",function(B){var m;return null==Q["~"]&&(Q["~"]=H),I(m=this.$match(B))?Q["~"].$begin(0):m}),z(L,"$freeze",function(){var B=this;return I(B["$frozen?"]())?B:(B.hasOwnProperty("$$g")||Ce(B,"$$g",null),B.hasOwnProperty("$$gm")||Ce(B,"$$gm",null),f(B))}),z(L,"$inspect",function(){var m=this.toString(),l=/^\/(.*)\/([^\/]*)$/.exec(m);if(l){for(var h=l[2],d=l[1].split(""),p=d.length,_=!1,x="",$=0;$<p;$++){var se=d[$];!_&&"/"==se&&(x=x.concat("\\")),x=x.concat(se),_="\\"==se&&!_}return"/"+x+"/"+h}return m}),z(L,"$match",function he(B,O){var m=he.$$p||H,l=this;if(null==Q["~"]&&(Q["~"]=H),he.$$p=null,l.uninitialized&&N.$raise(A("TypeError"),"uninitialized Regexp"),void 0===O){if(B===H)return Q["~"]=H;var c=l.exec(fe(B,A("String"),"to_str"));return c?(Q["~"]=A("MatchData").$new(l,c),m===H?Q["~"]:T.yield1(m,Q["~"])):Q["~"]=H}if(O=fe(O,A("Integer"),"to_int"),B===H||(B=fe(B,A("String"),"to_str"),O<0&&(O+=B.length)<0))return Q["~"]=H;for(var h,d=T.global_regexp(l);;){if(null===(h=d.exec(B)))return Q["~"]=H;if(h.index>=O)return Q["~"]=A("MatchData").$new(d,h),m===H?Q["~"]:T.yield1(m,Q["~"]);d.lastIndex=h.index+1}},-2),z(L,"$match?",function(B,O){var l,m=this;return m.uninitialized&&N.$raise(A("TypeError"),"uninitialized Regexp"),void 0===O?B!==H&&m.test(fe(B,A("String"),"to_str")):(O=fe(O,A("Integer"),"to_int"),!(B===H||(B=fe(B,A("String"),"to_str"),O<0&&(O+=B.length)<0)||null===(l=T.global_regexp(m).exec(B))||l.index<O))},-2),z(L,"$names",function(){return q(this.$source().$scan(/\(?<(\w+)>/,E(["no_matchdata"],{no_matchdata:!0})),"map",[],"first".$to_proc()).$uniq()}),z(L,"$named_captures",function(){return q(q(q(this.$source().$scan(/\(?<(\w+)>/,E(["no_matchdata"],{no_matchdata:!0})),"map",[],"first".$to_proc()).$each_with_index(),"group_by",[],"first".$to_proc()),"transform_values",[],function(m){return null==m&&(m=H),q(m,"map",[],function(c){return null==c&&(c=H),V(c.$last(),1)})})}),z(L,"$~",function(){return null==Q._&&(Q._=H),this["$=~"](Q._)}),z(L,"$source",function(){return this.source}),z(L,"$options",function(){var B=this;B.uninitialized&&N.$raise(A("TypeError"),"uninitialized Regexp");var O=0;return B.multiline&&(O|=F("MULTILINE")),B.ignoreCase&&(O|=F("IGNORECASE")),O}),z(L,"$casefold?",function(){return this.ignoreCase}),re(L,"eql?","=="),re(L,"to_s","source"),function(M,C,P){var L=S(M,null,"MatchData"),ne=[L].concat(P),F=T.$r(ne);return L.$$prototype.matches=H,L.$attr_reader("post_match","pre_match","regexp","string"),z(L,"$initialize",function(O,m,l){var c,h=this;null==(c=(l=le(l)).$$smap.no_matchdata)&&(c=!1),I(c)||(Q["~"]=h),h.regexp=O,h.begin=m.index,h.string=m.input,h.pre_match=m.input.slice(0,m.index),h.post_match=m.input.slice(m.index+m[0].length),h.matches=[];for(var d=0,p=m.length;d<p;d++){var _=m[d];h.matches.push(null==_?H:_)}},-3),z(L,"$match",function(O){var l;return I(l=this["$[]"](O))?l:I(O["$is_a?"](F("Integer")))&&I(Z(O,this.$length()))?N.$raise(A("IndexError"),"index "+O+" out of matches"):H}),z(L,"$match_length",function(O){var m;return(m=this.$match(O))===H||null==m?H:m.$length()}),z(L,"$[]",function(O){var l,c=this;return(l=U(arguments))[0].$$is_string?(c.$regexp().$names()["$include?"](l["$[]"](0))["$!"]()&&N.$raise(A("IndexError"),"undefined group name reference: "+l["$[]"](0)),c.$named_captures()["$[]"](l["$[]"](0))):q(c.matches,"[]",Y(l))},-1),z(L,"$offset",function(O){var m=this;return 0!==O&&N.$raise(A("ArgumentError"),"MatchData#offset only supports 0th element"),[m.begin,m.begin+m.matches[O].length]}),z(L,"$==",function(O){var m=this,l=H,c=H,h=H,d=H;return!!X(A("MatchData"),O)&&(I(l=I(c=I(h=I(d=m.string==O.string)?m.regexp.toString()==O.regexp.toString():d)?m.pre_match==O.pre_match:h)?m.post_match==O.post_match:c)?m.begin==O.begin:l)}),z(L,"$begin",function(O){return 0!==O&&N.$raise(A("ArgumentError"),"MatchData#begin only supports 0th element"),this.begin}),z(L,"$end",function(O){return 0!==O&&N.$raise(A("ArgumentError"),"MatchData#end only supports 0th element"),this.begin+this.matches[O].length}),z(L,"$captures",function(){return this.matches.slice(1)}),z(L,"$named_captures",function(){var m=H;return m=this.$captures(),q(this.$regexp().$named_captures(),"transform_values",[],function(c){return null==c&&(c=H),m["$[]"](k(c.$last(),1))})}),z(L,"$names",function(){return this.$regexp().$names()}),z(L,"$inspect",function(){var O=this,m="#<MatchData "+O.matches[0].$inspect();if(O.$regexp().$names()["$empty?"]())for(var l=1,c=O.matches.length;l<c;l++)m+=" "+l+":"+O.matches[l].$inspect();else q(O.$named_captures(),"each",[],function(d,p){return null==d&&(d=H),null==p&&(p=H),m+=" "+d+":"+p.$inspect()});return m+">"}),z(L,"$length",function(){return this.matches.length}),z(L,"$to_a",R("matches")),z(L,"$to_s",function(){return this.matches[0]}),z(L,"$values_at",function(O){var l,c=this;l=U(arguments);var h,d,p,_=[];for(h=0;h<l.length;h++)l[h].$$is_range&&((d=l[h].$to_a()).unshift(h,1),Array.prototype.splice.apply(l,d)),(p=G["$coerce_to!"](l[h],A("Integer"),"to_int"))<0&&(p+=c.matches.length)<0?_.push(H):_.push(c.matches[p]);return _},-1),re(L,"eql?","=="),re(L,"size","length")}(ee[0],0,ee)},Opal.modules["corelib/string"]=function(T){var fe=T.coerce_to,Ce=T.respond_to,f=T.global_multiline_regexp,S=T.prop,te=T.klass,v=T.def,D=T.Opal,z=T.defs,I=T.slice,Q=T.send,U=T.to_a,N=T.extract_kwargs,G=T.ensure_kwargs,re=T.eqeqeq,q=T.Kernel,E=T.truthy,V=T.gvars,le=T.rb_divide,Z=T.rb_plus,Y=T.eqeq,X=T.hash2,k=T.alias,R=T.const_set,ee=T.top,H=[],A=T.$r(H),M=T.nil,C=T.$$$;return ee.$require("corelib/comparable"),ee.$require("corelib/regexp"),function(P,L,ne){var F=te("::",String,"String"),he=[F].concat(ne),B=T.$r(he);function O(m){function l(Te){var de,xe,ke,De,Me,_e,Ae="",Fe=Te.length;for(de=0;de<Fe;de++)if("-"===(xe=Te.charAt(de))&&de>0&&de<Fe-1&&!ke){for((De=Te.charCodeAt(de-1))>(Me=Te.charCodeAt(de+1))&&q.$raise(C("ArgumentError"),'invalid range "'+De+"-"+Me+'" in string transliteration'),_e=De+1;_e<Me+1;_e++)Ae+=String.fromCharCode(_e);ke=!0,de++}else ke="\\"===xe,Ae+=xe;return Ae}function c(Te,Ae){if(0===Te.length)return Ae;var Fe,ke,de="",xe=Te.length;for(Fe=0;Fe<xe;Fe++)ke=Te.charAt(Fe),-1!==Ae.indexOf(ke)&&(de+=ke);return de}var h,d,p,_,x,$,se="",ae="";for(h=0,d=m.length;h<d;h++)_="^"===(p=fe(m[h],C("String"),"to_str")).charAt(0)&&p.length>1,p=l(_?p.slice(1):p),_?ae=c(ae,p):se=c(se,p);if(se.length>0&&ae.length>0){for($="",h=0,d=se.length;h<d;h++)x=se.charAt(h),-1===ae.indexOf(x)&&($+=x);se=$,ae=""}return se.length>0?"["+C("Regexp").$escape(se)+"]":ae.length>0?"[^"+C("Regexp").$escape(ae)+"]":null}F.$include(C("Comparable")),T.prop(F.$$prototype,"$$is_string",!0),v(F,"$__id__",function(){return this.toString()}),z(F,"$try_convert",function(l){return D["$coerce_to?"](l,C("String"),"to_str")}),z(F,"$new",function(l){var h,d=this,p=(h=I(arguments))[0]||"",_=h[h.length-1];return p=fe(p,C("String"),"to_str"),_&&_.$$is_hash&&_.$$smap.encoding&&(p=p.$force_encoding(_.$$smap.encoding)),(p=new d.$$constructor(p)).$initialize.$$pristine||Q(p,"initialize",U(h)),p},-1),v(F,"$initialize",function(l,c){var h,d;return h=I(arguments),d=N(h),d=G(d),h.length>0&&h.shift(),M},-1),v(F,"$%",function(l){var c=this;return re(C("Array"),l)?Q(c,"format",[c].concat(U(l))):c.$format(c,l)}),v(F,"$*",function(l){if((l=fe(l,C("Integer"),"to_int"))<0&&q.$raise(C("ArgumentError"),"negative argument"),0===l)return"";var h="",d=this.toString();for(d.length*l>=1<<28&&q.$raise(C("RangeError"),"multiply count must not overflow maximum string size");1==(1&l)&&(h+=d),0!=(l>>>=1);)d+=d;return h}),v(F,"$+",function(l){var c=this;if(""==(l=fe(l,C("String"),"to_str"))&&c.$$class===T.String)return c;if(""==c&&l.$$class===T.String)return l;var h=c+l;return c.encoding===h.encoding&&l.encoding===h.encoding||"UTF-8"===c.encoding.name||"UTF-8"===l.encoding.name?h:T.enc(h,c.encoding)}),v(F,"$<=>",function(l){var c=this;if(E(l["$respond_to?"]("to_str")))return c>(l=l.$to_str().$to_s())?1:c<l?-1:0;var h=l["$<=>"](c);return h===M?M:h>0?-1:h<0?1:0}),v(F,"$==",function(l){return l.$$is_string?this.toString()===l.toString():!!Ce(l,"$to_str")&&l["$=="](this)}),v(F,"$=~",function(l){return l.$$is_string&&q.$raise(C("TypeError"),"type mismatch: String given"),l["$=~"](this)}),v(F,"$[]",function(l,c){var p,_,h=this,d=h.length;if(l.$$is_range)return p=l.excl,_=l,c=l.end===M?-1:fe(l.end,C("Integer"),"to_int"),l=l.begin===M?0:fe(l.begin,C("Integer"),"to_int"),Math.abs(l)>d?M:(l<0&&(l+=d),c<0&&(c+=d),(!p||_.end===M)&&(c+=1),(c-=l)<0&&(c=0),h.substr(l,c));if(l.$$is_string)return null!=c&&q.$raise(C("TypeError")),-1!==h.indexOf(l)?l:M;if(l.$$is_regexp){var x=h.match(l);return null===x?(V["~"]=M,M):(V["~"]=C("MatchData").$new(l,x),null==c?x[0]:(c=fe(c,C("Integer"),"to_int"))<0&&-c<x.length?x[c+=x.length]:c>=0&&c<x.length?x[c]:M)}return(l=fe(l,C("Integer"),"to_int"))<0&&(l+=d),null==c?l>=d||l<0?M:h.substr(l,1):(c=fe(c,C("Integer"),"to_int"))<0||l>d||l<0?M:h.substr(l,c)},-2),v(F,"$b",function(){return new String(this).$force_encoding("binary")}),v(F,"$capitalize",function(){return this.charAt(0).toUpperCase()+this.substr(1).toLowerCase()}),v(F,"$casecmp",function(l){var c=this;if(!E(l["$respond_to?"]("to_str")))return M;l=fe(l,C("String"),"to_str").$to_s();var h=/^[\x00-\x7F]*$/;return h.test(c)&&h.test(l)&&(c=c.toLowerCase(),l=l.toLowerCase()),c["$<=>"](l)}),v(F,"$casecmp?",function(l){var h=this.$casecmp(l);return h===M?M:0===h}),v(F,"$center",function(l,c){var h=this;if(null==c&&(c=" "),l=fe(l,C("Integer"),"to_int"),c=fe(c,C("String"),"to_str").$to_s(),E(c["$empty?"]())&&q.$raise(C("ArgumentError"),"zero width padding"),E(l<=h.length))return h;var d=h.$ljust(le(Z(l,h.length),2).$ceil(),c);return h.$rjust(le(Z(l,h.length),2).$floor(),c)+d.slice(h.length)},-2),v(F,"$chomp",function(l){var h,c=this;return null==V["/"]&&(V["/"]=M),null==l&&(l=V["/"]),E(l===M||0===c.length)?c:("\n"===(l=D["$coerce_to!"](l,C("String"),"to_str").$to_s())?h=c.replace(/\r?\n?$/,""):""===l?h=c.replace(/(\r?\n)+$/,""):c.length>=l.length&&c.substr(c.length-l.length,l.length)===l&&(h=c.substr(0,c.length-l.length)),null!=h?h:c)},-1),v(F,"$chop",function(){var l=this,c=l.length;return c<=1?"":"\n"===l.charAt(c-1)&&"\r"===l.charAt(c-2)?l.substr(0,c-2):l.substr(0,c-1)}),v(F,"$chr",function(){return this.charAt(0)}),v(F,"$clone",function(l){var c,h=this,d=M;return null==(c=(l=G(l)).$$smap.freeze)&&(c=M),E(c["$nil?"]())||Y(c,!0)||Y(c,!1)||h.$raise(B("ArgumentError"),"unexpected value for freeze: "+c.$class()),(d=new String(h)).$copy_singleton_methods(h),d.$initialize_clone(h,X(["freeze"],{freeze:c})),Y(c,!0)?d.$$frozen||(d.$$frozen=!0):E(c["$nil?"]())&&h.$$frozen&&(d.$$frozen=!0),d},-1),v(F,"$dup",function(){var c=M;return(c=new String(this)).$initialize_dup(this),c}),v(F,"$count",function(l){var h,d=this;0===(h=I(arguments)).length&&q.$raise(C("ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var p=O(h);return null===p?0:d.length-d.replace(new RegExp(p,"g"),"").length},-1),v(F,"$delete",function(l){var h,d=this;0===(h=I(arguments)).length&&q.$raise(C("ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var p=O(h);return null===p?d:d.replace(new RegExp(p,"g"),"")},-1),v(F,"$delete_prefix",function(l){var c=this;return l.$$is_string||(l=fe(l,C("String"),"to_str")),c.slice(0,l.length)===l?c.slice(l.length):c}),v(F,"$delete_suffix",function(l){var c=this;return l.$$is_string||(l=fe(l,C("String"),"to_str")),c.slice(c.length-l.length)===l?c.slice(0,c.length-l.length):c}),v(F,"$downcase",function(){return this.toLowerCase()}),v(F,"$each_line",function m(l,c){var d,p,_,x,se,ae,Te,Ae,de,Fe,xe,ke,h=m.$$p||M,$=this;if(null==V["/"]&&(V["/"]=M),m.$$p=null,d=I(arguments),p=N(d),p=G(p),d.length>0&&(_=d.shift()),null==_&&(_=V["/"]),null==(x=p.$$smap.chomp)&&(x=!1),h===M)return $.$enum_for("each_line",_,X(["chomp"],{chomp:x}));if(_===M)return T.yield1(h,$),$;if(0===(_=fe(_,C("String"),"to_str")).length){for(ae=0,Te=(se=$.split(/((?:\r?\n){2})(?:(?:\r?\n)*)/)).length;ae<Te;ae+=2)(se[ae]||se[ae+1])&&(ke=(se[ae]||"")+(se[ae+1]||""),x&&(ke=ke.$chomp("\n")),T.yield1(h,ke));return $}for(de=$.$chomp(_),Fe=$.length!=de.length,ae=0,Ae=(xe=de.split(_)).length;ae<Ae;ae++)ke=xe[ae],(ae<Ae-1||Fe)&&(ke+=_),x&&(ke=ke.$chomp(_)),T.yield1(h,ke);return $},-1),v(F,"$empty?",function(){return 0===this.length}),v(F,"$end_with?",function(l){for(var h,d=this,p=0,_=(h=I(arguments)).length;p<_;p++){var x=fe(h[p],C("String"),"to_str").$to_s();if(d.length>=x.length&&d.substr(d.length-x.length,x.length)==x)return!0}return!1},-1),v(F,"$gsub",function m(l,c){var h=m.$$p||M,d=this;if(m.$$p=null,void 0===c&&h===M)return d.$enum_for("gsub",l);var $,se,ae,p="",_=M,x=0;for(l.$$is_regexp?l=f(l):(l=fe(l,C("String"),"to_str"),l=new RegExp(l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));;){if(null===($=l.exec(d))){V["~"]=M,p+=d.slice(x);break}_=C("MatchData").$new(l,$),void 0===c?(ae=l.lastIndex,se=h($[0]),l.lastIndex=ae):c.$$is_hash?se=c["$[]"]($[0]).$to_s():(c.$$is_string||(c=fe(c,C("String"),"to_str")),se=c.replace(/([\\]+)([0-9+&`'])/g,function(Te,Ae,de){if(Ae.length%2==0)return Te;switch(de){case"+":for(var Fe=$.length-1;Fe>0;Fe--)if(void 0!==$[Fe])return Ae.slice(1)+$[Fe];return"";case"&":return Ae.slice(1)+$[0];case"`":return Ae.slice(1)+d.slice(0,$.index);case"'":return Ae.slice(1)+d.slice($.index+$[0].length);default:return Ae.slice(1)+($[de]||"")}}).replace(/\\\\/g,"\\")),l.lastIndex===$.index?(p+=d.slice(x,$.index)+se+(d[$.index]||""),l.lastIndex+=1):p+=d.slice(x,$.index)+se,x=l.lastIndex}return V["~"]=_,p},-2),v(F,"$hash",function(){return this.toString()}),v(F,"$hex",function(){return this.$to_i(16)}),v(F,"$include?",function(l){return l.$$is_string||(l=fe(l,C("String"),"to_str")),-1!==this.indexOf(l)}),v(F,"$index",function(l,c){var d,p,_,h=this;if(void 0===c)c=0;else if((c=fe(c,C("Integer"),"to_int"))<0&&(c+=h.length)<0)return M;if(l.$$is_regexp)for(_=f(l);;){if(null===(p=_.exec(h))){V["~"]=M,d=-1;break}if(p.index>=c){V["~"]=C("MatchData").$new(_,p),d=p.index;break}_.lastIndex=p.index+1}else d=0===(l=fe(l,C("String"),"to_str")).length&&c>h.length?-1:h.indexOf(l,c);return-1===d?M:d},-2),v(F,"$inspect",function(){var l=this,h={"\x07":"\\a","\x1b":"\\e","\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\v":"\\v",'"':'\\"',"\\":"\\\\"};return'"'+l.replace(/[\\\"\x00-\x1f\u007F-\u009F\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,function(p){return h[p]?h[p]:(p=p.charCodeAt(0))<=255&&(l.encoding["$binary?"]()||l.internal_encoding["$binary?"]())?"\\x"+("00"+p.toString(16).toUpperCase()).slice(-2):"\\u"+("0000"+p.toString(16).toUpperCase()).slice(-4)}).replace(/\#[\$\@\{]/g,"\\$&")+'"'}),v(F,"$intern",function(){return this.toString()}),v(F,"$length",function(){return this.length}),k(F,"size","length"),v(F,"$lines",function m(l,c){var d,p,_,x,h=m.$$p||M,$=this,se=M;return null==V["/"]&&(V["/"]=M),m.$$p=null,d=I(arguments),p=N(d),p=G(p),d.length>0&&(_=d.shift()),null==_&&(_=V["/"]),null==(x=p.$$smap.chomp)&&(x=!1),se=Q($,"each_line",[_,X(["chomp"],{chomp:x})],h.$to_proc()),E(h)?$:se.$to_a()},-1),v(F,"$ljust",function(l,c){var h=this;if(null==c&&(c=" "),l=fe(l,C("Integer"),"to_int"),c=fe(c,C("String"),"to_str").$to_s(),E(c["$empty?"]())&&q.$raise(C("ArgumentError"),"zero width padding"),E(l<=h.length))return h;var d=-1,p="";for(l-=h.length;++d<l;)p+=c;return h+p.slice(0,l)},-2),v(F,"$lstrip",function(){return this.replace(/^[\u0000\s]*/,"")}),v(F,"$ascii_only?",function(){return!!this.encoding.ascii&&/^[\x00-\x7F]*$/.test(this)}),v(F,"$match",function m(l,c){var h=m.$$p||M;return m.$$p=null,(re(B("String"),l)||E(l["$respond_to?"]("to_str")))&&(l=C("Regexp").$new(l.$to_str())),re(C("Regexp"),l)||q.$raise(C("TypeError"),"wrong argument type "+l.$class()+" (expected Regexp)"),Q(l,"match",[this,c],h.$to_proc())},-2),v(F,"$match?",function(l,c){return(re(B("String"),l)||E(l["$respond_to?"]("to_str")))&&(l=C("Regexp").$new(l.$to_str())),re(C("Regexp"),l)||q.$raise(C("TypeError"),"wrong argument type "+l.$class()+" (expected Regexp)"),l["$match?"](this,c)},-2),v(F,"$next",function(){var l=this,c=l.length;if(0===c)return"";for(var _,h=l,d=l.search(/[a-zA-Z0-9]/),p=!1;c--;){if((_=l.charCodeAt(c))>=48&&_<=57||_>=65&&_<=90||_>=97&&_<=122)switch(_){case 57:p=!0,_=48;break;case 90:p=!0,_=65;break;case 122:p=!0,_=97;break;default:p=!1,_+=1}else-1===d?255===_?(p=!0,_=0):(p=!1,_+=1):p=!0;if(h=h.slice(0,c)+String.fromCharCode(_)+h.slice(c+1),p&&(0===c||c===d)){switch(_){case 65:case 97:break;default:_+=1}h=0===c?String.fromCharCode(_)+h:h.slice(0,c)+String.fromCharCode(_)+h.slice(c),p=!1}if(!p)break}return h}),v(F,"$oct",function(){var c,h=this,d=8;return/^\s*_/.test(h)?0:(h=h.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/i,function(p,_,x,$){switch($.charAt(0)){case"+":case"-":return p;case"0":if("x"===$.charAt(1)&&"0x"===x)return p}switch(x){case"0b":d=2;break;case"0":case"0o":d=8;break;case"0d":d=10;break;case"0x":d=16}return _+$}),c=parseInt(h.replace(/_(?!_)/g,""),d),isNaN(c)?0:c)}),v(F,"$ord",function(){var l=this;return"function"==typeof l.codePointAt?l.codePointAt(0):l.charCodeAt(0)}),v(F,"$partition",function(l){var h,d,c=this;return l.$$is_regexp?null===(d=l.exec(c))?h=-1:(C("MatchData").$new(l,d),l=d[0],h=d.index):(l=fe(l,C("String"),"to_str"),h=c.indexOf(l)),-1===h?[c,"",""]:[c.slice(0,h),c.slice(h,h+l.length),c.slice(h+l.length)]}),v(F,"$reverse",function(){return this.split("").reverse().join("")}),v(F,"$rindex",function(l,c){var d,p,_,x,h=this;if(void 0===c)c=h.length;else if((c=fe(c,C("Integer"),"to_int"))<0&&(c+=h.length)<0)return M;if(l.$$is_regexp){for(p=null,_=f(l);!(null===(x=_.exec(h))||x.index>c);)_.lastIndex=(p=x).index+1;null===p?(V["~"]=M,d=-1):(C("MatchData").$new(_,p),d=p.index)}else l=fe(l,C("String"),"to_str"),d=h.lastIndexOf(l,c);return-1===d?M:d},-2),v(F,"$rjust",function(l,c){var h=this;if(null==c&&(c=" "),l=fe(l,C("Integer"),"to_int"),c=fe(c,C("String"),"to_str").$to_s(),E(c["$empty?"]())&&q.$raise(C("ArgumentError"),"zero width padding"),E(l<=h.length))return h;var d=Math.floor(l-h.length),p=Math.floor(d/c.length),_=Array(p+1).join(c);return _+c.slice(0,d-_.length)+h},-2),v(F,"$rpartition",function(l){var h,d,p,_,c=this;if(l.$$is_regexp){for(d=null,p=f(l);null!==(_=p.exec(c));)p.lastIndex=(d=_).index+1;null===d?h=-1:(C("MatchData").$new(p,d),l=d[0],h=d.index)}else l=fe(l,C("String"),"to_str"),h=c.lastIndexOf(l);return-1===h?["","",c]:[c.slice(0,h),c.slice(h,h+l.length),c.slice(h+l.length)]}),v(F,"$rstrip",function(){return this.replace(/[\s\u0000]*$/,"")}),v(F,"$scan",function m(l,c){var d,h=m.$$p||M;m.$$p=null,null==(d=(c=G(c)).$$smap.no_matchdata)&&(d=!1);var $,_=[],x=M;for(l.$$is_regexp?l=f(l):(l=fe(l,C("String"),"to_str"),l=new RegExp(l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));null!=($=l.exec(this));)x=C("MatchData").$new(l,$,X(["no_matchdata"],{no_matchdata:d})),h===M?_.push(1==$.length?$[0]:x.$captures()):T.yield1(h,1==$.length?$[0]:x.$captures()),l.lastIndex===$.index&&(l.lastIndex+=1);return d||(V["~"]=x),h!==M?this:_},-2),v(F,"$singleton_class",function(){return T.get_singleton_class(this)}),v(F,"$split",function(l,c){var h=this,d=M;if(null==V[";"]&&(V[";"]=M),0===h.length)return[];if(void 0===c)c=0;else if(1===(c=D["$coerce_to!"](c,C("Integer"),"to_int")))return[h];(void 0===l||l===M)&&(l=E(d=V[";"])?d:" ");var $,se,ae,p=[],_=h.toString(),x=0;if(l.$$is_regexp?l=f(l):" "===(l=fe(l,C("String"),"to_str").$to_s())?(l=/\s+/gm,_=_.replace(/^\s+/,"")):l=new RegExp(l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"),1===(p=_.split(l)).length&&p[0]===_)return[p[0]];for(;-1!==(se=p.indexOf(void 0));)p.splice(se,1);if(0===c){for(;""===p[p.length-1];)p.length-=1;return p}if($=l.exec(_),c<0){if(null!==$&&""===$[0]&&-1===l.source.indexOf("(?="))for(se=0,ae=$.length;se<ae;se++)p.push("");return p}if(null!==$&&""===$[0])return p.splice(c-1,p.length-1,p.slice(c-1).join("")),p;if(c>=p.length)return p;for(se=0;null!==$&&(se++,x=l.lastIndex,se+1!==c);)$=l.exec(_);return p.splice(c-1,p.length-1,_.slice(x)),p},-1),v(F,"$squeeze",function(l){var h,d=this;if(0===(h=I(arguments)).length)return d.replace(/(.)\1+/g,"$1");var p=O(h);return null===p?d:d.replace(new RegExp("("+p+")\\1+","g"),"$1")},-1),v(F,"$start_with?",function(l){for(var h,d=this,p=0,_=(h=I(arguments)).length;p<_;p++)if(h[p].$$is_regexp){var x=h[p],$=x.exec(d);if(null!=$&&0===$.index)return V["~"]=C("MatchData").$new(x,$),!0;V["~"]=M}else{var se=fe(h[p],C("String"),"to_str").$to_s();if(0===d.indexOf(se))return!0}return!1},-1),v(F,"$strip",function(){return this.replace(/^[\s\u0000]*|[\s\u0000]*$/g,"")}),v(F,"$sub",function m(l,c){var h=m.$$p||M,d=this;m.$$p=null,l.$$is_regexp||(l=fe(l,C("String"),"to_str"),l=new RegExp(l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")));var p,_=l.exec(d);return null===_?(V["~"]=M,p=d.toString()):(C("MatchData").$new(l,_),void 0===c?(h===M&&q.$raise(C("ArgumentError"),"wrong number of arguments (1 for 2)"),p=d.slice(0,_.index)+h(_[0])+d.slice(_.index+_[0].length)):c.$$is_hash?p=d.slice(0,_.index)+c["$[]"](_[0]).$to_s()+d.slice(_.index+_[0].length):(c=(c=fe(c,C("String"),"to_str")).replace(/([\\]+)([0-9+&`'])/g,function(x,$,se){if($.length%2==0)return x;switch(se){case"+":for(var ae=_.length-1;ae>0;ae--)if(void 0!==_[ae])return $.slice(1)+_[ae];return"";case"&":return $.slice(1)+_[0];case"`":return $.slice(1)+d.slice(0,_.index);case"'":return $.slice(1)+d.slice(_.index+_[0].length);default:return $.slice(1)+(_[se]||"")}}).replace(/\\\\/g,"\\"),p=d.slice(0,_.index)+c+d.slice(_.index+_[0].length))),p},-2),v(F,"$sum",function(l){null==l&&(l=16),l=fe(l,C("Integer"),"to_int");for(var h=0,d=this.length,p=0;p<d;p++)h+=this.charCodeAt(p);return l<=0?h:h&Math.pow(2,l)-1},-1),v(F,"$swapcase",function(){return this.replace(/([a-z]+)|([A-Z]+)/g,function(h,d,p){return d?h.toUpperCase():h.toLowerCase()})}),v(F,"$to_f",function(){if("_"===this.charAt(0))return 0;var c=parseFloat(this.replace(/_/g,""));return isNaN(c)||c==1/0||c==-1/0?0:c}),v(F,"$to_i",function(l){null==l&&(l=10);var h,d=this.toLowerCase(),p=fe(l,C("Integer"),"to_int");return(1===p||p<0||p>36)&&q.$raise(C("ArgumentError"),"invalid radix "+p),/^\s*_/.test(d)?0:(d=d.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/,function(_,x,$,se){switch(se.charAt(0)){case"+":case"-":return _;case"0":if("x"===se.charAt(1)&&"0x"===$&&(0===p||16===p))return _}switch($){case"0b":if(0===p||2===p)return p=2,x+se;break;case"0":case"0o":if(0===p||8===p)return p=8,x+se;break;case"0d":if(0===p||10===p)return p=10,x+se;break;case"0x":if(0===p||16===p)return p=16,x+se}return _}),h=parseInt(d.replace(/_(?!_)/g,""),p),isNaN(h)?0:h)},-1),v(F,"$to_proc",function m(){var h,d,p=M;return m.$$p=null,h=this.valueOf(),d=T.jsid(h),p=Q(q,"proc",[],function _(x){var ae,$=_.$$p||M;_.$$p=null,0===(ae=I(arguments)).length&&q.$raise(C("ArgumentError"),"no receiver given");var Te=ae[0];null==Te&&(Te=M);var Ae=Te[d];return Ae?ae=ae.slice(1):(Ae=Te.$method_missing,ae[0]=h),"function"==typeof $&&(Ae.$$p=$),0===ae.length?Ae.call(Te):Ae.apply(Te,ae)},-1),p.$$source_location=M,p}),v(F,"$to_s",function(){return this.toString()}),v(F,"$tr",function(l,c){var h=this;if(l=fe(l,C("String"),"to_str").$to_s(),c=fe(c,C("String"),"to_str").$to_s(),0==l.length||l===c)return h;var d,p,_,x,$,se,ae,Te={},Ae=l.split(""),de=Ae.length,Fe=c.split(""),xe=Fe.length,ke=!1,De=null;"^"===Ae[0]&&Ae.length>1&&(ke=!0,Ae.shift(),De=Fe[xe-1],de-=1);var Me=[],_e=null;for(p=!1,d=0;d<de;d++)if(x=Ae[d],null==_e)_e=x,Me.push(x);else if("-"===x)"-"===_e?(Me.push("-"),Me.push("-")):d==de-1?Me.push("-"):p=!0;else if(p){for(($=_e.charCodeAt(0))>(se=x.charCodeAt(0))&&q.$raise(C("ArgumentError"),'invalid range "'+String.fromCharCode($)+"-"+String.fromCharCode(se)+'" in string transliteration'),_=$+1;_<se;_++)Me.push(String.fromCharCode(_));Me.push(x),p=null,_e=null}else Me.push(x);if(de=(Ae=Me).length,ke)for(d=0;d<de;d++)Te[Ae[d]]=!0;else{if(xe>0){var ce=[],pe=null;for(p=!1,d=0;d<xe;d++)if(x=Fe[d],null==pe)pe=x,ce.push(x);else if("-"===x)"-"===pe?(ce.push("-"),ce.push("-")):d==xe-1?ce.push("-"):p=!0;else if(p){for(($=pe.charCodeAt(0))>(se=x.charCodeAt(0))&&q.$raise(C("ArgumentError"),'invalid range "'+String.fromCharCode($)+"-"+String.fromCharCode(se)+'" in string transliteration'),_=$+1;_<se;_++)ce.push(String.fromCharCode(_));ce.push(x),p=null,pe=null}else ce.push(x);xe=(Fe=ce).length}var ye=de-xe;if(ye>0){var b=xe>0?Fe[xe-1]:"";for(d=0;d<ye;d++)Fe.push(b)}for(d=0;d<de;d++)Te[Ae[d]]=Fe[d]}var K="";for(d=0,ae=h.length;d<ae;d++){var ge=Te[x=h.charAt(d)];K+=ke?null==ge?De:x:null!=ge?ge:x}return K}),v(F,"$tr_s",function(l,c){var h=this;if(l=fe(l,C("String"),"to_str").$to_s(),c=fe(c,C("String"),"to_str").$to_s(),0==l.length)return h;var d,p,_,x,$,se,ae,Te={},Ae=l.split(""),de=Ae.length,Fe=c.split(""),xe=Fe.length,ke=!1,De=null;"^"===Ae[0]&&Ae.length>1&&(ke=!0,Ae.shift(),De=Fe[xe-1],de-=1);var Me=[],_e=null;for(p=!1,d=0;d<de;d++)if(x=Ae[d],null==_e)_e=x,Me.push(x);else if("-"===x)"-"===_e?(Me.push("-"),Me.push("-")):d==de-1?Me.push("-"):p=!0;else if(p){for(($=_e.charCodeAt(0))>(se=x.charCodeAt(0))&&q.$raise(C("ArgumentError"),'invalid range "'+String.fromCharCode($)+"-"+String.fromCharCode(se)+'" in string transliteration'),_=$+1;_<se;_++)Me.push(String.fromCharCode(_));Me.push(x),p=null,_e=null}else Me.push(x);if(de=(Ae=Me).length,ke)for(d=0;d<de;d++)Te[Ae[d]]=!0;else{if(xe>0){var ce=[];for(p=!1,d=0;d<xe;d++)if(x=Fe[d],null==_e)_e=x,ce.push(x);else if("-"===x)d==xe-1?ce.push("-"):p=!0;else if(p){for(($=_e.charCodeAt(0))>(se=x.charCodeAt(0))&&q.$raise(C("ArgumentError"),'invalid range "'+String.fromCharCode($)+"-"+String.fromCharCode(se)+'" in string transliteration'),_=$+1;_<se;_++)ce.push(String.fromCharCode(_));ce.push(x),p=null,_e=null}else ce.push(x);xe=(Fe=ce).length}var ye=de-xe;if(ye>0){var b=xe>0?Fe[xe-1]:"";for(d=0;d<ye;d++)Fe.push(b)}for(d=0;d<de;d++)Te[Ae[d]]=Fe[d]}var K="",ge=null;for(d=0,ae=h.length;d<ae;d++){var be=Te[x=h.charAt(d)];ke?null==be?null==ge&&(K+=De,ge=!0):(K+=x,ge=null):null!=be?(null==ge||ge!==be)&&(K+=be,ge=be):(K+=x,ge=null)}return K}),v(F,"$upcase",function(){return this.toUpperCase()}),v(F,"$upto",function m(l,c){var h=m.$$p||M,d=this;if(m.$$p=null,null==c&&(c=!1),h===M)return d.$enum_for("upto",l,c);var p,_,x=d.toString();if(l=fe(l,C("String"),"to_str"),1===x.length&&1===l.length)for(p=x.charCodeAt(0),_=l.charCodeAt(0);p<=_&&(!c||p!==_);)h(String.fromCharCode(p)),p+=1;else if(parseInt(x,10).toString()===x&&parseInt(l,10).toString()===l)for(p=parseInt(x,10),_=parseInt(l,10);p<=_&&(!c||p!==_);)h(p.toString()),p+=1;else for(;x.length<=l.length&&x<=l&&(!c||x!==l);)h(x),x=x.$succ();return d},-2),v(F,"$instance_variables",function(){return[]}),z(F,"$_load",function(l){var c,d=this;return c=I(arguments),Q(d,"new",U(c))},-1),v(F,"$unicode_normalize",function(l){return null==l&&(l="nfc"),E(["nfc","nfd","nfkc","nfkd"]["$include?"](l))||q.$raise(C("ArgumentError"),"Invalid normalization form "+l),this.normalize(l.$upcase())},-1),v(F,"$unicode_normalized?",function(l){return null==l&&(l="nfc"),this.$unicode_normalize(l)["$=="](this)},-1),v(F,"$unpack",function(l){return q.$raise("To use String#unpack, you must first require 'corelib/string/unpack'.")}),v(F,"$unpack1",function(l){return q.$raise("To use String#unpack1, you must first require 'corelib/string/unpack'.")}),v(F,"$freeze",function(){var l=this;return"string"==typeof l||S(l,"$$frozen",!0),l}),v(F,"$-@",function(){var l=this;return"string"==typeof l||l.$$frozen?l:"UTF-8"==l.encoding.name&&"UTF-8"==l.internal_encoding.name?l.toString():l.$dup().$freeze()}),v(F,"$frozen?",function(){return"string"==typeof this||!0===this.$$frozen}),k(F,"+@","dup"),k(F,"===","=="),k(F,"byteslice","[]"),k(F,"eql?","=="),k(F,"equal?","==="),k(F,"object_id","__id__"),k(F,"slice","[]"),k(F,"succ","next"),k(F,"to_str","to_s"),k(F,"to_sym","intern"),D.$pristine(F,"initialize")}(0,0,H),R(H[0],"Symbol",A("String"))},Opal.modules["corelib/enumerable"]=function(T){var fe=T.truthy,Ce=T.coerce_to,f=T.yield1,S=T.yieldX,te=T.deny_frozen_access,v=T.module,D=T.send,z=T.slice,I=T.to_a,Q=T.Opal,U=T.thrower,N=T.def,G=T.Kernel,re=T.return_val,q=T.rb_gt,E=T.rb_times,V=T.rb_lt,le=T.eqeq,Z=T.rb_plus,Y=T.rb_minus,X=T.rb_divide,k=T.rb_le,R=T.hash2,ee=T.lambda,H=T.not,A=T.alias,C=T.nil,P=T.$$$;return function(L,ne){var F=v("::","Enumerable"),he=[F].concat([]),B=T.$r(he);function O(m){return 0===m.length&&(m=[C]),m.length>1&&(m=[m]),m}return N(F,"$all?",function m(l){try{var c=U("return"),h=m.$$p||C;return m.$$p=null,fe(void 0!==l)?D(this,"each",[],function(_){var se=C;if(se=O(z(arguments)),fe(D(l,"public_send",["==="].concat(I(se)))))return C;c.$throw(!1)},{$$arity:-1,$$ret:c}):D(this,"each",[],h!==C?function(_){var x;if(x=z(arguments),fe(T.yieldX(h,I(x))))return C;c.$throw(!1)}:function(_){var x;if(x=z(arguments),fe(Q.$destructure(x)))return C;c.$throw(!1)},{$$arity:-1,$$ret:c}),!0}catch(p){if(p===c)return p.$v;throw p}},-1),N(F,"$any?",function m(l){try{var c=U("return"),h=m.$$p||C;return m.$$p=null,fe(void 0!==l)?D(this,"each",[],function(_){var se=C;if(se=O(z(arguments)),!fe(D(l,"public_send",["==="].concat(I(se)))))return C;c.$throw(!0)},{$$arity:-1,$$ret:c}):D(this,"each",[],h!==C?function(_){var x;if(x=z(arguments),!fe(T.yieldX(h,I(x))))return C;c.$throw(!0)}:function(_){var x;if(x=z(arguments),!fe(Q.$destructure(x)))return C;c.$throw(!0)},{$$arity:-1,$$ret:c}),!1}catch(p){if(p===c)return p.$v;throw p}},-1),N(F,"$chunk",function m(){var l=m.$$p||C,c=this;return m.$$p=null,l===C?D(c,"to_enum",["chunk"],function h(){return(null==h.$$s?this:h.$$s).$enumerator_size()},{$$s:c}):D(P("Enumerator"),"new",[],function h(d){var p=null==h.$$s?this:h.$$s;null==d&&(d=C);var _=C,x=[];function $(){x.length>0&&d.$yield(_,x)}p.$each.$$p=function(se){var ae=f(l,se);ae===C?($(),x=[],_=C):(_===C||_===ae?x.push(se):($(),x=[se]),_=ae)},p.$each(),$()},{$$s:c})}),N(F,"$chunk_while",function m(){var l=m.$$p||C;return m.$$p=null,l===C&&G.$raise(P("ArgumentError"),"no block given"),D(this,"slice_when",[],function(d,p){return null==d&&(d=C),null==p&&(p=C),T.yieldX(l,[d,p])["$!"]()})}),N(F,"$collect",function m(){var l=m.$$p||C,c=this;if(m.$$p=null,l===C)return D(c,"enum_for",["collect"],function d(){return(null==d.$$s?this:d.$$s).$enumerator_size()},{$$s:c});var h=[];return c.$each.$$p=function(){var d=S(l,arguments);h.push(d)},c.$each(),h}),N(F,"$collect_concat",function m(){var l=m.$$p||C,c=this;return m.$$p=null,l===C?D(c,"enum_for",["collect_concat"],function h(){return(null==h.$$s?this:h.$$s).$enumerator_size()},{$$s:c}):D(c,"map",[],l.$to_proc()).$flatten(1)}),N(F,"$compact",function(){return this.$to_a().$compact()}),N(F,"$count",function m(l){var c=m.$$p||C,d=C;return m.$$p=null,d=0,null!=l&&c!==C&&this.$warn("warning: given block not used"),fe(null!=l)?c=D(G,"proc",[],function(_){var x;return x=z(arguments),Q.$destructure(x)["$=="](l)},-1):fe(c["$nil?"]())&&(c=D(G,"proc",[],re(!0))),D(this,"each",[],function(_){var x;return x=z(arguments),fe(S(c,x))?d++:C},-1),d},-1),N(F,"$cycle",function m(l){var c=m.$$p||C,h=this;if(m.$$p=null,null==l&&(l=C),c===C)return D(h,"enum_for",["cycle",l],function $(){var se=null==$.$$s?this:$.$$s;return fe(l["$nil?"]())?fe(se["$respond_to?"]("size"))?P(P("Float"),"INFINITY"):C:(l=Q["$coerce_to!"](l,P("Integer"),"to_int"),fe(q(l,0))?E(se.$enumerator_size(),l):0)},{$$s:h});if(!fe(l["$nil?"]())&&(l=Q["$coerce_to!"](l,P("Integer"),"to_int"),fe(l<=0)))return C;var p,_,d=[];if(h.$each.$$p=function(){var $=Q.$destructure(arguments);f(c,$),d.push($)},h.$each(),0===d.length)return C;if(l===C)for(;;)for(p=0,_=d.length;p<_;p++)f(c,d[p]);else for(;l>1;){for(p=0,_=d.length;p<_;p++)f(c,d[p]);l--}},-1),N(F,"$detect",function m(l){try{var c=U("return"),h=m.$$p||C;return m.$$p=null,h===C?this.$enum_for("detect",l):(D(this,"each",[],function(_){var x,se=C;if(x=z(arguments),se=Q.$destructure(x),!fe(T.yield1(h,se)))return C;c.$throw(se)},{$$arity:-1,$$ret:c}),void 0!==l?"function"==typeof l?l():l:C)}catch(p){if(p===c)return p.$v;throw p}},-1),N(F,"$drop",function(l){l=Ce(l,P("Integer"),"to_int"),fe(l<0)&&G.$raise(P("ArgumentError"),"attempt to drop negative size");var h=[],d=0;return this.$each.$$p=function(){l<=d&&h.push(Q.$destructure(arguments)),d++},this.$each(),h}),N(F,"$drop_while",function m(){var l=m.$$p||C,c=this;if(m.$$p=null,l===C)return c.$enum_for("drop_while");var h=[],d=!0;return c.$each.$$p=function(){var p=Q.$destructure(arguments);if(d){var _=f(l,p);fe(_)||(d=!1,h.push(p))}else h.push(p)},c.$each(),h}),N(F,"$each_cons",function m(l){var c=m.$$p||C,h=this;if(m.$$p=null,fe(1!=arguments.length)&&G.$raise(P("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 1)"),l=Q.$try_convert(l,P("Integer"),"to_int"),fe(l<=0)&&G.$raise(P("ArgumentError"),"invalid size"),c===C)return D(h,"enum_for",["each_cons",l],function p(){var x=C;return x=(null==p.$$s?this:p.$$s).$enumerator_size(),fe(x["$nil?"]())?C:le(x,0)||fe(V(x,l))?0:Z(Y(x,l),1)},{$$s:h});var d=[];return h.$each.$$p=function(){var p=Q.$destructure(arguments);d.push(p),d.length>l&&d.shift(),d.length==l&&f(c,d.slice(0,l))},h.$each(),h}),N(F,"$each_entry",function m(l){var d,c=m.$$p||C,p=this;return m.$$p=null,d=z(arguments),c===C?D(p,"to_enum",["each_entry"].concat(I(d)),function _(){return(null==_.$$s?this:_.$$s).$enumerator_size()},{$$s:p}):(p.$each.$$p=function(){var _=Q.$destructure(arguments);f(c,_)},p.$each.apply(p,d),p)},-1),N(F,"$each_slice",function m(l){var c=m.$$p||C,h=this;if(m.$$p=null,l=Ce(l,P("Integer"),"to_int"),fe(l<=0)&&G.$raise(P("ArgumentError"),"invalid slice size"),c===C)return D(h,"enum_for",["each_slice",l],function p(){var _=null==p.$$s?this:p.$$s;return fe(_["$respond_to?"]("size"))?X(_.$size(),l).$ceil():C},{$$s:h});var d=[];return h.$each.$$p=function(){var p=Q.$destructure(arguments);d.push(p),d.length===l&&(f(c,d),d=[])},h.$each(),d.length>0&&f(c,d),h}),N(F,"$each_with_index",function m(l){var d,c=m.$$p||C,p=this;if(m.$$p=null,d=z(arguments),c===C)return D(p,"enum_for",["each_with_index"].concat(I(d)),function x(){return(null==x.$$s?this:x.$$s).$enumerator_size()},{$$s:p});var _=0;return p.$each.$$p=function(){var x=Q.$destructure(arguments);c(x,_),_++},p.$each.apply(p,d),p},-1),N(F,"$each_with_object",function m(l){var c=m.$$p||C,h=this;return m.$$p=null,c===C?D(h,"enum_for",["each_with_object",l],function d(){return(null==d.$$s?this:d.$$s).$enumerator_size()},{$$s:h}):(h.$each.$$p=function(){var d=Q.$destructure(arguments);c(d,l)},h.$each(),l)}),N(F,"$entries",function(l){var h,d=this;h=z(arguments);var p=[];return d.$each.$$p=function(){p.push(Q.$destructure(arguments))},d.$each.apply(d,h),p},-1),N(F,"$filter_map",function m(){var l=m.$$p||C,c=this;return m.$$p=null,l===C?D(c,"enum_for",["filter_map"],function h(){return(null==h.$$s?this:h.$$s).$enumerator_size()},{$$s:c}):D(D(c,"map",[],l.$to_proc()),"select",[],"itself".$to_proc())}),N(F,"$find_all",function m(){var l=m.$$p||C,c=this;if(m.$$p=null,l===C)return D(c,"enum_for",["find_all"],function d(){return(null==d.$$s?this:d.$$s).$enumerator_size()},{$$s:c});var h=[];return c.$each.$$p=function(){var d=Q.$destructure(arguments),p=f(l,d);fe(p)&&h.push(d)},c.$each(),h}),N(F,"$find_index",function m(l){try{var c=U("return"),h=m.$$p||C,d=this,p=C;return m.$$p=null,fe(void 0===l&&h===C)?d.$enum_for("find_index"):(null!=l&&h!==C&&d.$warn("warning: given block not used"),p=0,fe(null!=l)?D(d,"each",[],function(x){var $;return $=z(arguments),le(Q.$destructure($),l)&&c.$throw(p),p+=1},{$$arity:-1,$$ret:c}):D(d,"each",[],function(x){var $;return $=z(arguments),fe(T.yieldX(h,I($)))&&c.$throw(p),p+=1},{$$arity:-1,$$ret:c}),C)}catch(_){if(_===c)return _.$v;throw _}},-1),N(F,"$first",function(l){try{var c=U("return"),d=C,p=C;return fe(void 0===l)?D(this,"each",[],function(x){null==x&&(x=C),c.$throw(x)},{$$ret:c}):(d=[],l=Ce(l,P("Integer"),"to_int"),fe(l<0)&&G.$raise(P("ArgumentError"),"attempt to take negative size"),fe(0==l)?[]:(p=0,D(this,"each",[],function(x){var $;if($=z(arguments),d.push(Q.$destructure($)),!fe(l<=++p))return C;c.$throw(d)},{$$arity:-1,$$ret:c}),d))}catch(_){if(_===c)return _.$v;throw _}},-1),N(F,"$grep",function m(l){var c=m.$$p||C,d=C;return m.$$p=null,d=[],D(this,"each",[],function(_){var $,se=C;return se=O($=z(arguments)),fe(D(l,"__send__",["==="].concat(I(se))))?(c!==C?(fe(q($.$length(),1))&&($=[$]),$=T.yieldX(c,I($))):fe(k($.$length(),1))&&($=$["$[]"](0)),d.$push($)):C},-1),d}),N(F,"$grep_v",function m(l){var c=m.$$p||C,d=C;return m.$$p=null,d=[],D(this,"each",[],function(_){var $,se=C;return se=O($=z(arguments)),fe(D(l,"__send__",["==="].concat(I(se))))?C:(c!==C?(fe(q($.$length(),1))&&($=[$]),$=T.yieldX(c,I($))):fe(k($.$length(),1))&&($=$["$[]"](0)),d.$push($))},-1),d}),N(F,"$group_by",function m(){var c,l=m.$$p||C,h=this,d=C,p=C;return m.$$p=null,l===C?D(h,"enum_for",["group_by"],function x(){return(null==x.$$s?this:x.$$s).$enumerator_size()},{$$s:h}):(d=R([],{}),h.$each.$$p=function(){var x=Q.$destructure(arguments),$=f(l,x);(fe(p=d["$[]"]($))?p:(c=[$,[]],D(d,"[]=",c),c[c.length-1]))["$<<"](x)},h.$each(),d)}),N(F,"$include?",function(l){try{var c=U("return");return D(this,"each",[],function(p){var _;if(_=z(arguments),!le(Q.$destructure(_),l))return C;c.$throw(!0)},{$$arity:-1,$$ret:c}),!1}catch(d){if(d===c)return d.$v;throw d}}),N(F,"$inject",function m(l,c){var h=m.$$p||C,d=this;m.$$p=null;var p=l;return h!==C&&void 0===c?d.$each.$$p=function(){var _=Q.$destructure(arguments);void 0!==p?(_=S(h,[p,_]),p=_):p=_}:(void 0===c&&(P("Symbol")["$==="](l)||G.$raise(P("TypeError"),l.$inspect()+" is not a Symbol"),c=l,p=void 0),d.$each.$$p=function(){var _=Q.$destructure(arguments);p=void 0!==p?p.$__send__(c,_):_}),d.$each(),null==p?C:p},-1),N(F,"$lazy",function(){return D(P(P("Enumerator"),"Lazy"),"new",[this,this.$enumerator_size()],function(h,d){var p;return null==h&&(h=C),p=z(arguments,1),D(h,"yield",I(p))},-2)}),N(F,"$enumerator_size",function(){return fe(this["$respond_to?"]("size"))?this.$size():C}),N(F,"$max",function m(l){var d,p,c=m.$$p||C,h=this;return m.$$p=null,void 0===l||l===C?(h.$each.$$p=function(){var _=Q.$destructure(arguments);void 0!==d?((p=c!==C?S(c,[_,d]):_["$<=>"](d))===C&&G.$raise(P("ArgumentError"),"comparison failed"),p>0&&(d=_)):d=_},h.$each(),void 0===d?C:d):(l=Ce(l,P("Integer"),"to_int"),D(h,"sort",[],c.$to_proc()).$reverse().$first(l))},-1),N(F,"$max_by",function m(l){var d,p,c=m.$$p||C,h=this;return m.$$p=null,null==l&&(l=C),fe(c)?fe(l["$nil?"]())?(h.$each.$$p=function(){var _=Q.$destructure(arguments),x=f(c,_);if(void 0===d)return d=_,void(p=x);x["$<=>"](p)>0&&(d=_,p=x)},h.$each(),void 0===d?C:d):D(h,"sort_by",[],c.$to_proc()).$reverse().$take(l):D(h,"enum_for",["max_by",l],function _(){return(null==_.$$s?this:_.$$s).$enumerator_size()},{$$s:h})},-1),N(F,"$min",function m(l){var d,c=m.$$p||C,h=this;return m.$$p=null,null==l&&(l=C),fe(l["$nil?"]())?(h.$each.$$p=c!==C?function(){var p=Q.$destructure(arguments);if(void 0!==d){var _=c(p,d);_===C&&G.$raise(P("ArgumentError"),"comparison failed"),_<0&&(d=p)}else d=p}:function(){var p=Q.$destructure(arguments);void 0!==d?Q.$compare(p,d)<0&&(d=p):d=p},h.$each(),void 0===d?C:d):c!==C?D(h,"sort",[],function(_,x){return null==_&&(_=C),null==x&&(x=C),T.yieldX(c,[_,x])}).$take(l):h.$sort().$take(l)},-1),N(F,"$min_by",function m(l){var d,p,c=m.$$p||C,h=this;return m.$$p=null,null==l&&(l=C),fe(c)?fe(l["$nil?"]())?(h.$each.$$p=function(){var _=Q.$destructure(arguments),x=f(c,_);if(void 0===d)return d=_,void(p=x);x["$<=>"](p)<0&&(d=_,p=x)},h.$each(),void 0===d?C:d):D(h,"sort_by",[],c.$to_proc()).$take(l):D(h,"enum_for",["min_by",l],function _(){return(null==_.$$s?this:_.$$s).$enumerator_size()},{$$s:h})},-1),N(F,"$minmax",function m(){var h,l=m.$$p||C;m.$$p=null,l=fe(h=l)?h:D(G,"proc",[],function($,se){return null==$&&($=C),null==se&&(se=C),$["$<=>"](se)});var d=C,p=C,_=!0;return this.$each.$$p=function(){var x=Q.$destructure(arguments);if(_)d=p=x,_=!1;else{var $=l.$call(d,x);$===C?G.$raise(P("ArgumentError"),"comparison failed"):$>0&&(d=x);var se=l.$call(p,x);se===C?G.$raise(P("ArgumentError"),"comparison failed"):se<0&&(p=x)}},this.$each(),[d,p]}),N(F,"$minmax_by",function m(){var l=m.$$p||C,c=this;if(m.$$p=null,!fe(l))return D(c,"enum_for",["minmax_by"],function x(){return(null==x.$$s?this:x.$$s).$enumerator_size()},{$$s:c});var p,_,h=C,d=C;return c.$each.$$p=function(){var x=Q.$destructure(arguments),$=f(l,x);(void 0===p||$["$<=>"](p)<0)&&(h=x,p=$),(void 0===_||$["$<=>"](_)>0)&&(d=x,_=$)},c.$each(),[h,d]}),N(F,"$none?",function m(l){try{var c=U("return"),h=m.$$p||C;return m.$$p=null,fe(void 0!==l)?D(this,"each",[],function(_){var se=C;if(se=O(z(arguments)),!fe(D(l,"public_send",["==="].concat(I(se)))))return C;c.$throw(!1)},{$$arity:-1,$$ret:c}):D(this,"each",[],h!==C?function(_){var x;if(x=z(arguments),!fe(T.yieldX(h,I(x))))return C;c.$throw(!1)}:function(_){var x,se=C;if(x=z(arguments),se=Q.$destructure(x),!fe(se))return C;c.$throw(!1)},{$$arity:-1,$$ret:c}),!0}catch(p){if(p===c)return p.$v;throw p}},-1),N(F,"$one?",function m(l){try{var c=U("return"),h=m.$$p||C,p=C;return m.$$p=null,p=0,fe(void 0!==l)?D(this,"each",[],function(x){var ae=C;return ae=O(z(arguments)),fe(D(l,"public_send",["==="].concat(I(ae))))?(p=Z(p,1),fe(q(p,1))?void c.$throw(!1):C):C},{$$arity:-1,$$ret:c}):D(this,"each",[],h!==C?function(x){var $;return $=z(arguments),fe(T.yieldX(h,I($)))?(p=Z(p,1),fe(q(p,1))?void c.$throw(!1):C):C}:function(x){var $;return $=z(arguments),fe(Q.$destructure($))?(p=Z(p,1),fe(q(p,1))?void c.$throw(!1):C):C},{$$arity:-1,$$ret:c}),p["$=="](1)}catch(_){if(_===c)return _.$v;throw _}},-1),N(F,"$partition",function m(){var l=m.$$p||C,c=this;if(m.$$p=null,l===C)return D(c,"enum_for",["partition"],function _(){return(null==_.$$s?this:_.$$s).$enumerator_size()},{$$s:c});var h=[],d=[];return c.$each.$$p=function(){var _=Q.$destructure(arguments),x=f(l,_);fe(x)?h.push(_):d.push(_)},c.$each(),[h,d]}),N(F,"$reject",function m(){var l=m.$$p||C,c=this;if(m.$$p=null,l===C)return D(c,"enum_for",["reject"],function d(){return(null==d.$$s?this:d.$$s).$enumerator_size()},{$$s:c});var h=[];return c.$each.$$p=function(){var d=Q.$destructure(arguments),p=f(l,d);fe(p)||h.push(d)},c.$each(),h}),N(F,"$reverse_each",function m(){var l=m.$$p||C,c=this;if(m.$$p=null,l===C)return D(c,"enum_for",["reverse_each"],function p(){return(null==p.$$s?this:p.$$s).$enumerator_size()},{$$s:c});var h=[];c.$each.$$p=function(){h.push(arguments)},c.$each();for(var d=h.length-1;d>=0;d--)S(l,h[d]);return h}),N(F,"$slice_before",function m(l){var c=m.$$p||C,h=this;return m.$$p=null,fe(void 0===l&&c===C)&&G.$raise(P("ArgumentError"),"both pattern and block are given"),fe(void 0!==l&&c!==C||arguments.length>1)&&G.$raise(P("ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),D(P("Enumerator"),"new",[],function d(p){var _=null==d.$$s?this:d.$$s;null==p&&(p=C);var x=[];_.$each.$$p=c!==C?void 0===l?function(){var $=Q.$destructure(arguments),se=f(c,$);fe(se)&&x.length>0&&(p["$<<"](x),x=[]),x.push($)}:function(){var $=Q.$destructure(arguments),se=c($,l.$dup());fe(se)&&x.length>0&&(p["$<<"](x),x=[]),x.push($)}:function(){var $=Q.$destructure(arguments),se=l["$==="]($);fe(se)&&x.length>0&&(p["$<<"](x),x=[]),x.push($)},_.$each(),x.length>0&&p["$<<"](x)},{$$s:h})},-1),N(F,"$slice_after",function m(l){var c=m.$$p||C,h=this;return m.$$p=null,fe(void 0===l&&c===C)&&G.$raise(P("ArgumentError"),"both pattern and block are given"),fe(void 0!==l&&c!==C||arguments.length>1)&&G.$raise(P("ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),fe(void 0!==l)&&(c=D(G,"proc",[],function(p){return null==p&&(p=C),l["$==="](p)})),D(P("Enumerator"),"new",[],function d(p){var x,_=null==d.$$s?this:d.$$s;null==p&&(p=C),_.$each.$$p=function(){var $=Q.$destructure(arguments),se=f(c,$);null==x&&(x=[]),fe(se)?(x.push($),p.$yield(x),x=null):x.push($)},_.$each(),null!=x&&p.$yield(x)},{$$s:h})},-1),N(F,"$slice_when",function m(){var l=m.$$p||C;return m.$$p=null,l===C&&G.$raise(P("ArgumentError"),"wrong number of arguments (0 for 1)"),D(P("Enumerator"),"new",[],function h(d){var p=null==h.$$s?this:h.$$s;null==d&&(d=C);var _=C,x=C;p.$each_cons.$$p=function(){var $=Q.$destructure(arguments),se=$[0],ae=$[1],Te=S(l,[se,ae]);x=ae,_===C&&(_=[]),fe(Te)?(_.push(se),d.$yield(_),_=[]):_.push(se)},p.$each_cons(2),_!==C&&(_.push(x),d.$yield(_))},{$$s:this})}),N(F,"$sort",function m(){var h,l=m.$$p||C;return m.$$p=null,h=this.$to_a(),l===C&&(l=ee(function(p,_){return null==p&&(p=C),null==_&&(_=C),p["$<=>"](_)})),D(h,"sort",[],l.$to_proc())}),N(F,"$sort_by",function m(){var l=m.$$p||C,c=this,h=C;return m.$$p=null,l===C?D(c,"enum_for",["sort_by"],function d(){return(null==d.$$s?this:d.$$s).$enumerator_size()},{$$s:c}):(h=D(c,"map",[],function(){var p=C;return p=Q.$destructure(arguments),[T.yield1(l,p),p]}),D(h,"sort!",[],function(p,_){return null==p&&(p=C),null==_&&(_=C),p[0]["$<=>"](_[0])}),D(h,"map!",[],function(p){return null==p&&(p=C),p[1]}))}),N(F,"$sum",function m(l){var c=m.$$p||C,d=C,p=C;return m.$$p=null,null==l&&(l=0),d=l,p=0,D(this,"each",[],function(x){var se,ae=C,Te=C,Ae=C;return se=z(arguments),ae=c!==C?T.yieldX(c,I(se)):Q.$destructure(se),H([P(P("Float"),"INFINITY"),P(P("Float"),"INFINITY")["$-@"]()]["$include?"](ae))&&fe(ae["$respond_to?"]("-"))?(Te=Y(ae,p),Ae=Z(d,Te),p=Y(Y(Ae,d),Te),d=Ae):d=Z(d,ae)},-1),d},-1),N(F,"$take",function(l){return this.$first(l)}),N(F,"$take_while",function m(){try{var l=U("return"),c=m.$$p||C,d=C;return m.$$p=null,fe(c)?(d=[],D(this,"each",[],function(_){var x,se=C;return x=z(arguments),se=Q.$destructure(x),fe(T.yield1(c,se))||l.$throw(d),d.push(se)},{$$arity:-1,$$ret:l})):this.$enum_for("take_while")}catch(p){if(p===l)return p.$v;throw p}}),N(F,"$uniq",function m(){var l=m.$$p||C,h=C;return m.$$p=null,h=R([],{}),D(this,"each",[],function(p){var _,$,se=C,ae=C;return _=z(arguments),se=Q.$destructure(_),ae=l!==C?T.yield1(l,se):se,fe(h["$key?"](ae))?C:(D(h,"[]=",$=[ae,se]),$[$.length-1])},-1),h.$values()}),N(F,"$tally",function(l){var h;return l&&l!==C&&te(l),h=D(D(this,"group_by",[],"itself".$to_proc()),"transform_values",[],"count".$to_proc()),fe(l)?(D(h,"each",[],function(p,_){var x;return null==p&&(p=C),null==_&&(_=C),x=[p,Z(l.$fetch(p,0),_)],D(l,"[]=",x),x[x.length-1]}),l):h},-1),N(F,"$to_h",function m(l){var d,c=m.$$p||C,p=this;if(m.$$p=null,d=z(arguments),c!==C)return D(D(p,"map",[],c.$to_proc()),"to_h",I(d));var _=R([],{});return p.$each.$$p=function(){var x=Q.$destructure(arguments),$=Q["$coerce_to?"](x,P("Array"),"to_ary");$.$$is_array||G.$raise(P("TypeError"),"wrong element type "+$.$class()+" (expected array)"),2!==$.length&&G.$raise(P("ArgumentError"),"wrong array length (expected 2, was "+$.$length()+")"),T.hash_put(_,$[0],$[1])},p.$each.apply(p,d),_},-1),N(F,"$to_set",function m(l,c){var d,p,h=m.$$p||C,x=this;return m.$$p=null,(d=z(arguments)).length>0&&(p=d.shift()),null==p&&(p=B("Set")),D(p,"new",[x].concat(I(d)),h.$to_proc())},-1),N(F,"$zip",function m(l){var d,p=this;return m.$$p=null,d=z(arguments),D(p.$to_a(),"zip",I(d))},-1),A(F,"find","detect"),A(F,"filter","find_all"),A(F,"flat_map","collect_concat"),A(F,"map","collect"),A(F,"member?","include?"),A(F,"reduce","inject"),A(F,"select","find_all"),A(F,"to_a","entries")}()},Opal.modules["corelib/enumerator/arithmetic_sequence"]=function(T){var R,ee,H,fe=T.klass,Ce=T.truthy,f=T.to_a,S=T.eqeq,te=T.Kernel,v=T.def,D=T.rb_gt,z=T.rb_lt,I=T.rb_le,Q=T.rb_ge,U=T.rb_plus,N=T.rb_minus,G=T.eqeqeq,re=T.not,q=T.rb_times,E=T.rb_divide,V=T.alias,Z=T.nil,Y=T.$$$;return R=[],H=[ee=fe("::",null,"Enumerator")].concat(R),function(A,M,C){var P=fe(A,M,"ArithmeticSequence"),L=[P].concat(C),ne=T.$r(L),F=P.$$prototype;F.step_arg2=F.receiver_num=F.step_arg1=F.step=F.range=F.topfx=F.bypfx=F.creation_method=F.skipped_arg=Z,T.prop(P.$$prototype,"$$is_arithmetic_seq",!0);var he=1/0;return v(P,"$initialize",function(O,m,l){var c,h=this,d=Z;return null==l&&(l="step"),h.creation_method=l,Ce(O["$is_a?"](Y("Array")))?(c=[].concat(f(O)),h.step_arg1=null==c[0]?Z:c[0],h.step_arg2=null==c[1]?Z:c[1],h.topfx=null==c[2]?Z:c[2],h.bypfx=null==c[3]?Z:c[3],h.receiver_num=m,h.step=1,h.range=Ce(h.step_arg2)?(h.step=h.step_arg2,T.Range.$new(h.receiver_num,h.step_arg1,!1)):Ce(h.step_arg1)?T.Range.$new(h.receiver_num,h.step_arg1,!1):T.Range.$new(h.receiver_num,Z,!1)):(Ce(m)||(h.skipped_arg=!0),c=[O,Ce(d=m)?d:1],h.range=c[0],h.step=c[1]),h.object=h,S(h.step,0)&&te.$raise(ne("ArgumentError"),"step can't be 0"),Ce(h.step["$respond_to?"]("to_int"))?Z:te.$raise(ne("ArgumentError"),"no implicit conversion of "+h.step.$class()+" into Integer")},-2),P.$attr_reader("step"),v(P,"$begin",function(){return this.range.$begin()}),v(P,"$end",function(){return this.range.$end()}),v(P,"$exclude_end?",function(){return this.range["$exclude_end?"]()}),v(P,"$_lesser_than_end?",function(O){var l,c,m=this;return l=Ce(c=m.$end())?c:he,Ce(D(m.$step(),0))?Ce(m["$exclude_end?"]())?z(O,l):I(O,l):Ce(m["$exclude_end?"]())?D(O,l):Q(O,l)}),v(P,"$_greater_than_begin?",function(O){var l,c;return l=Ce(c=this.$begin())?c:he["$-@"](),Ce(D(this.$step(),0))?D(O,l):z(O,l)}),v(P,"$first",function(O){var m=this,l=Z,c=Z,h=Z;if(l=Ce(c=m.$begin())?c:he["$-@"](),!Ce(O))return Ce(m["$_lesser_than_end?"](l))?l:Z;for(h=[];Ce(Ce(c=m["$_lesser_than_end?"](l))?D(O,0):c);)h["$<<"](l),l=U(l,m.$step()),O=N(O,1);return h},-1),v(P,"$each",function B(){var l,O=B.$$p||Z,m=this,c=Z;if(B.$$p=null,O===Z)return m;for(G(Z,m.$begin())&&te.$raise(ne("TypeError"),"nil can't be coerced into Integer"),c=Ce(l=m.$begin())?l:he["$-@"]();Ce(m["$_lesser_than_end?"](c));)T.yield1(O,c),c=U(c,m.$step());return m}),v(P,"$last",function(O){var m=this,l=Z,c=Z,h=Z;if(G(he,l=m.$end())||G(he["$-@"](),l)?te.$raise(Y("FloatDomainError"),m.$end()):G(Z,l)&&te.$raise(Y("RangeError"),"cannot get the last element of endless arithmetic sequence"),c=N(m.$end(),N(m.$end(),m.$begin())["$%"](m.$step())),Ce(m["$_lesser_than_end?"](c))||(c=N(c,m.$step())),!Ce(O))return Ce(m["$_greater_than_begin?"](c))?c:Z;for(h=[];Ce(Ce(l=m["$_greater_than_begin?"](c))?D(O,0):l);)h["$<<"](c),c=N(c,m.$step()),O=N(O,1);return h.$reverse()},-1),v(P,"$size",function(){var m,O=this,l=Z;return m=Ce(D(O.$step(),0))?1:-1,re(O["$_lesser_than_end?"](O.$begin()))?0:Ce([he["$-@"](),he]["$include?"](O.$step()))?1:Ce([q(he["$-@"](),m),Z]["$include?"](O.$begin()))||Ce([q(he,m),Z]["$include?"](O.$end()))?he:(l=N(O.$end(),N(O.$end(),O.$begin())["$%"](O.$step())),Ce(O["$_lesser_than_end?"](l))||(l=N(l,O.$step())),U(E(N(l,O.$begin()),O.$step()).$abs().$to_i(),1))}),v(P,"$==",function(O){var l,c,h,d,m=this;return Ce(l=Ce(c=Ce(h=Ce(d=m.$class()["$=="](O.$class()))?m.$begin()["$=="](O.$begin()):d)?m.$end()["$=="](O.$end()):h)?m.$step()["$=="](O.$step()):c)?m["$exclude_end?"]()["$=="](O["$exclude_end?"]()):l}),v(P,"$hash",function(){var O=this;return[O.$begin(),O.$end(),O.$step(),O["$exclude_end?"]()].$hash()}),v(P,"$inspect",function(){var O=this,m=Z;return Ce(O.receiver_num)?(m=Ce(O.step_arg2)?"("+O.topfx+O.step_arg1.$inspect()+", "+O.bypfx+O.step_arg2.$inspect()+")":Ce(O.step_arg1)?"("+O.topfx+O.step_arg1.$inspect()+")":Z,"("+O.receiver_num.$inspect()+"."+O.creation_method+m+")"):(m=Ce(O.skipped_arg)?Z:"("+O.step+")","(("+O.range.$inspect()+")."+O.creation_method+m+")")}),V(P,"===","=="),V(P,"eql?","==")}(ee,ee,H)},Opal.modules["corelib/enumerator/chain"]=function(T){var V,le,re,fe=T.deny_frozen_access,Ce=T.klass,f=T.slice,S=T.def,te=T.send,v=T.to_a,D=T.truthy,z=T.rb_plus,I=T.thrower,Q=T.nil,U=T.$$$;return re=Ce("::",null,"Enumerator"),(le=(V=Ce(re,re,"Chain")).$$prototype).enums=le.iterated=Q,S(V,"$initialize",function(Y){var k,R=this;return k=f(arguments),fe(R),R.enums=k,R.iterated=[],R.object=R},-1),S(V,"$each",function Z(Y){var k,R,X=Z.$$p||Q,ee=this;return Z.$$p=null,k=f(arguments),R=k,X===Q?te(ee,"to_enum",["each"].concat(v(R)),function H(){return(null==H.$$s?this:H.$$s).$size()},{$$s:ee}):(te(ee.enums,"each",[],function H(A){var M=null==H.$$s?this:H.$$s;return null==M.iterated&&(M.iterated=Q),null==A&&(A=Q),M.iterated["$<<"](A),te(A,"each",v(R),X.$to_proc())},{$$s:ee}),ee)},-1),S(V,"$size",function(Y){try{var k,R,X=I("return"),ee=this,H=Q;return k=f(arguments),R=k,H=0,te(ee.enums,"each",[],function(M){var C;return null==M&&(M=Q),C=te(M,"size",v(R)),D([Q,U(U("Float"),"INFINITY")]["$include?"](C))&&X.$throw(C),H=z(H,C)},{$$ret:X}),H}catch(A){if(A===X)return A.$v;throw A}},-1),S(V,"$rewind",function(){var Y=this;return te(Y.iterated,"reverse_each",[],function(k){return null==k&&(k=Q),D(k["$respond_to?"]("rewind"))?k.$rewind():Q}),Y.iterated=[],Y}),S(V,"$inspect",function(){return"#<Enumerator::Chain: "+this.enums.$inspect()+">"})},Opal.modules["corelib/enumerator/generator"]=function(T){var G,le,Z,Y,X,q,fe=T.deny_frozen_access,Ce=T.klass,f=T.truthy,S=T.Kernel,te=T.def,v=T.slice,D=T.send,z=[],I=T.nil,Q=T.$$$;return G=z,le=q=[Ce(z[0],null,"Enumerator")].concat(G),Y=[Z=Ce(q[0],null,"Generator")].concat(le),X=T.$r(Y),Z.$$prototype.block=I,Z.$include(Q("Enumerable")),te(Z,"$initialize",function R(){var ee=R.$$p||I;return R.$$p=null,fe(this),f(ee)||S.$raise(Q("LocalJumpError"),"no block given"),this.block=ee}),te(Z,"$each",function R(ee){var M,H=R.$$p||I,C=this,P=I;R.$$p=null,M=v(arguments),P=D(X("Yielder"),"new",[],H.$to_proc());try{M.unshift(P),T.yieldX(C.block,M)}catch(L){if(L&&"breaker"==L.$thrower_type)return L.$v;throw L}return C},-1)},Opal.modules["corelib/enumerator/lazy"]=function(T){var A,ne,F,he,B,M,fe=T.truthy,Ce=T.coerce_to,f=T.yield1,S=T.yieldX,te=T.deny_frozen_access,v=T.klass,D=T.slice,z=T.send2,I=T.find_super,Q=T.to_a,U=T.defs,N=T.Kernel,G=T.send,re=T.def,q=T.return_self,E=T.Opal,V=T.rb_lt,le=T.eqeqeq,Z=T.rb_plus,Y=T.alias,k=T.nil,R=T.$$$;return A=[],ne=[M=v("::",null,"Enumerator")].concat(A),he=[F=v(M,M,"Lazy")].concat(ne),B=T.$r(he),F.$$prototype.enumerator=k,v(F,R("Exception"),"StopLazyError"),U(F,"$for",function m(l,c){var d,p=m.$$p||k,_=this,x=k;return m.$$p=null,d=D(arguments,1),(x=z(_,I(_,"for",m,!1,!0),"for",[l].concat(Q(d)),p)).enumerator=l,x},-2),re(F,"$initialize",function m(l,c){var h=m.$$p||k,d=this;return m.$$p=null,null==c&&(c=k),te(d),h===k&&N.$raise(R("ArgumentError"),"tried to call lazy new without a block"),d.enumerator=l,z(d,I(d,"initialize",m,!1,!0),"initialize",[c],function(_,x){var se;null==_&&(_=k),se=D(arguments,1);try{return G(l,"each",Q(se),function(Te){var de;(de=D(arguments)).unshift(_),S(h,de)},-1)}catch(ae){if(!T.rescue(ae,[B("StopLazyError")]))throw ae;try{return k}finally{T.pop_exception()}}},-2)},-2),re(F,"$lazy",q),re(F,"$collect",function m(){var l=m.$$p||k;return m.$$p=null,fe(l)||N.$raise(R("ArgumentError"),"tried to call lazy map without a block"),G(B("Lazy"),"new",[this,this.$enumerator_size()],function(d,p){var _;null==d&&(d=k),_=D(arguments,1);var $=S(l,_);d.$yield($)},-2)}),re(F,"$collect_concat",function m(){var l=m.$$p||k;return m.$$p=null,fe(l)||N.$raise(R("ArgumentError"),"tried to call lazy map without a block"),G(B("Lazy"),"new",[this,k],function(d,p){var _;null==d&&(d=k),_=D(arguments,1);var $=S(l,_);if($["$respond_to?"]("force")&&$["$respond_to?"]("each"))G($,"each",[],function(Te){return null==Te&&(Te=k),d.$yield(Te)});else{var se=E.$try_convert($,R("Array"),"to_ary");se===k?d.$yield($):G($,"each",[],function(Te){return null==Te&&(Te=k),d.$yield(Te)})}},-2)}),re(F,"$drop",function(l){var h,d,p=k;return l=Ce(l,R("Integer"),"to_int"),fe(V(l,0))&&N.$raise(R("ArgumentError"),"attempt to drop negative size"),h=this.$enumerator_size(),d=le(R("Integer"),h)&&fe(V(l,h))?l:h,p=0,G(B("Lazy"),"new",[this,d],function(x,$){var ae;return null==x&&(x=k),ae=D(arguments,1),fe(V(p,l))?p=Z(p,1):G(x,"yield",Q(ae))},-2)}),re(F,"$drop_while",function m(){var l=m.$$p||k,h=k;return m.$$p=null,fe(l)||N.$raise(R("ArgumentError"),"tried to call lazy drop_while without a block"),h=!0,G(B("Lazy"),"new",[this,k],function(p,_){var $;if(null==p&&(p=k),$=D(arguments,1),!fe(h))return G(p,"yield",Q($));var se=S(l,$);fe(se)||(h=!1,G(p,"yield",Q($)))},-2)}),re(F,"$enum_for",function m(l,c){var d,p,_,h=m.$$p||k,x=this;return m.$$p=null,(d=D(arguments)).length>0&&(p=d.shift()),null==p&&(p="each"),_=d,G(x.$class(),"for",[x,p].concat(Q(_)),h.$to_proc())},-1),re(F,"$find_all",function m(){var l=m.$$p||k;return m.$$p=null,fe(l)||N.$raise(R("ArgumentError"),"tried to call lazy select without a block"),G(B("Lazy"),"new",[this,k],function(d,p){var _,x;null==d&&(d=k),_=D(arguments,1);var $=S(l,x=_);fe($)&&G(d,"yield",Q(x))},-2)}),re(F,"$grep",function m(l){var c=m.$$p||k;return m.$$p=null,fe(c)?G(B("Lazy"),"new",[this,k],function(p,_){var x;null==p&&(p=k),x=D(arguments,1);var se=E.$destructure(x),ae=l["$==="](se);fe(ae)&&(ae=f(c,se),p.$yield(f(c,se)))},-2):G(B("Lazy"),"new",[this,k],function(p,_){var x;null==p&&(p=k),x=D(arguments,1);var se=E.$destructure(x),ae=l["$==="](se);fe(ae)&&p.$yield(se)},-2)}),re(F,"$reject",function m(){var l=m.$$p||k;return m.$$p=null,fe(l)||N.$raise(R("ArgumentError"),"tried to call lazy reject without a block"),G(B("Lazy"),"new",[this,k],function(d,p){var _,x;null==d&&(d=k),_=D(arguments,1);var $=S(l,x=_);fe($)||G(d,"yield",Q(x))},-2)}),re(F,"$take",function(l){var h,d,p=k;return l=Ce(l,R("Integer"),"to_int"),fe(V(l,0))&&N.$raise(R("ArgumentError"),"attempt to take negative size"),h=this.$enumerator_size(),d=le(R("Integer"),h)&&fe(V(l,h))?l:h,p=0,G(B("Lazy"),"new",[this,d],function(x,$){var ae;return null==x&&(x=k),ae=D(arguments,1),fe(V(p,l))?(G(x,"yield",Q(ae)),p=Z(p,1)):N.$raise(B("StopLazyError"))},-2)}),re(F,"$take_while",function m(){var l=m.$$p||k;return m.$$p=null,fe(l)||N.$raise(R("ArgumentError"),"tried to call lazy take_while without a block"),G(B("Lazy"),"new",[this,k],function(d,p){var _,x;null==d&&(d=k),_=D(arguments,1);var $=S(l,x=_);fe($)?G(d,"yield",Q(x)):N.$raise(B("StopLazyError"))},-2)}),re(F,"$inspect",function(){return"#<"+this.$class()+": "+this.enumerator.$inspect()+">"}),Y(F,"force","to_a"),Y(F,"filter","find_all"),Y(F,"flat_map","collect_concat"),Y(F,"map","collect"),Y(F,"select","find_all"),Y(F,"to_enum","enum_for")},Opal.modules["corelib/enumerator/yielder"]=function(T){var Q,q,N,fe=T.klass,Ce=T.def,f=T.slice,S=T.send,te=T.to_a,v=[],D=T.nil;return Q=v,N=[fe(v[0],null,"Enumerator")].concat(Q),(q=fe(N[0],null,"Yielder")).$$prototype.block=D,Ce(q,"$initialize",function V(){var le=V.$$p||D;return V.$$p=null,this.block=le,this}),Ce(q,"$yield",function(le){var Z,X=this;Z=f(arguments);var k=T.yieldX(X.block,Z);if(k&&"break"==k.$thrower_type)throw k;return k},-1),Ce(q,"$<<",function(le){return this.$yield(le),this}),Ce(q,"$to_proc",function(){return S(this,"proc",[],function Z(Y){var X,R=null==Z.$$s?this:Z.$$s;return X=f(arguments),S(R,"yield",te(X))},{$$arity:-1,$$s:this})})},Opal.modules["corelib/enumerator"]=function(T){var H,A,M,C,P,fe=T.slice,Ce=T.coerce_to,f=T.deny_frozen_access,S=T.klass,te=T.defs,v=T.truthy,D=T.send,z=T.not,I=T.def,Q=T.rb_plus,U=T.to_a,N=T.Opal,G=T.send2,re=T.find_super,q=T.rb_ge,E=T.Kernel,V=T.rb_le,le=T.alias,X=T.nil,k=T.$$$;return T.top.$require("corelib/enumerable"),H=[],M=[A=S("::",null,"Enumerator")].concat(H),C=T.$r(M),(P=A.$$prototype).size=P.args=P.object=P.method=P.values=P.cursor=X,A.$include(k("Enumerable")),A.$$prototype.$$is_enumerator=!0,te(A,"$for",function L(ne,F,he){var O,m,l,B=L.$$p||X,c=this;L.$$p=null,(O=fe(arguments,1)).length>0&&(m=O.shift()),null==m&&(m="each"),l=O;var h=c.$allocate();return h.object=ne,h.size=B,h.method=m,h.args=l,h.cursor=0,h},-2),I(A,"$initialize",function L(ne){var F=L.$$p||X,O=this;return L.$$p=null,fe(arguments),f(O),O.cursor=0,v(F)?(O.object=D(C("Generator"),"new",[],F.$to_proc()),O.method="each",O.args=[],O.size=arguments[0]||X,v(O.size)&&z(O.size["$respond_to?"]("call"))?O.size=Ce(O.size,k("Integer"),"to_int"):X):(O.object=arguments[0],O.method=arguments[1]||"each",O.args=fe(arguments,2),O.size=X)},-1),I(A,"$each",function L(ne){var B,F=L.$$p||X,O=this;return L.$$p=null,B=fe(arguments),v(F["$nil?"]())&&v(B["$empty?"]())?O:(B=Q(O.args,B),v(F["$nil?"]())?D(O.$class(),"new",[O.object,O.method].concat(U(B))):D(O.object,"__send__",[O.method].concat(U(B)),F.$to_proc()))},-1),I(A,"$size",function(){return v(this.size["$respond_to?"]("call"))?D(this.size,"call",U(this.args)):this.size}),I(A,"$with_index",function L(ne){var F=L.$$p||X;if(L.$$p=null,null==ne&&(ne=0),ne=v(ne)?Ce(ne,k("Integer"),"to_int"):0,!v(F))return D(this,"enum_for",["with_index",ne],function m(){return(null==m.$$s?this:m.$$s).$size()},{$$s:this});var O=ne;return this.$each.$$p=function(){var m=N.$destructure(arguments),l=F(m,O);return O++,l},this.$each()},-1),I(A,"$each_with_index",function L(){var ne=L.$$p||X,F=this;return L.$$p=null,ne===X?D(F,"enum_for",["each_with_index"],function he(){return(null==he.$$s?this:he.$$s).$size()},{$$s:F}):(G(F,re(F,"each_with_index",L,!1,!0),"each_with_index",[],ne),F.object)}),I(A,"$rewind",function(){return this.cursor=0,this}),I(A,"$peek_values",function(){var F,ne=this;return ne.values=v(F=ne.values)?F:D(ne,"map",[],function(B){return fe(arguments)},-1),v(q(ne.cursor,ne.values.$length()))&&E.$raise(k("StopIteration"),"iteration reached an end"),ne.values["$[]"](ne.cursor)}),I(A,"$peek",function(){var F=X;return F=this.$peek_values(),v(V(F.$length(),1))?F["$[]"](0):F}),I(A,"$next_values",function(){var F;return F=this.$peek_values(),this.cursor=Q(this.cursor,1),F}),I(A,"$next",function(){var F=X;return F=this.$next_values(),v(V(F.$length(),1))?F["$[]"](0):F}),I(A,"$feed",function(ne){return this.$raise(C("NotImplementedError"),"Opal doesn't support Enumerator#feed")}),I(A,"$+",function(ne){return k(k("Enumerator"),"Chain").$new(this,ne)}),I(A,"$inspect",function(){var ne=this,F=X;return F="#<"+ne.$class()+": "+ne.object.$inspect()+":"+ne.method,v(ne.args["$any?"]())&&(F=Q(F,"("+ne.args.$inspect()["$[]"](k("Range").$new(1,-2))+")")),Q(F,">")}),le(A,"with_object","each_with_object"),A.$autoload("ArithmeticSequence","corelib/enumerator/arithmetic_sequence"),A.$autoload("Chain","corelib/enumerator/chain"),A.$autoload("Generator","corelib/enumerator/generator"),A.$autoload("Lazy","corelib/enumerator/lazy"),A.$autoload("Yielder","corelib/enumerator/yielder")},Opal.modules["corelib/numeric"]=function(T){var P,fe=T.klass,Ce=T.truthy,f=T.Kernel,S=T.def,te=T.to_ary,v=T.return_self,D=T.rb_minus,z=T.rb_times,I=T.rb_lt,Q=T.eqeq,U=T.rb_divide,N=T.return_val,G=T.Opal,re=T.slice,q=T.extract_kwargs,E=T.ensure_kwargs,V=T.not,le=T.send,Z=T.rb_ge,Y=T.rb_le,X=T.rb_plus,k=T.rb_gt,R=T.alias,H=T.nil,A=T.$$$;return T.top.$require("corelib/comparable"),(P=fe("::",null,"Numeric")).$include(A("Comparable")),S(P,"$coerce",function(ne){var F=this;return Ce(ne["$instance_of?"](F.$class()))?[ne,F]:[f.$Float(ne),f.$Float(F)]}),S(P,"$__coerced__",function(ne,F){var he,B;if(Ce(F["$respond_to?"]("coerce")))return B=F.$coerce(this),(null==(he=te(B))[0]?H:he[0]).$__send__(ne,null==he[1]?H:he[1]);switch(ne.valueOf()){case"+":case"-":case"*":case"/":case"%":case"&":case"|":case"^":case"**":return f.$raise(A("TypeError"),F.$class()+" can't be coerced into Numeric");case">":case">=":case"<":case"<=":case"<=>":return f.$raise(A("ArgumentError"),"comparison of "+this.$class()+" with "+F.$class()+" failed");default:return H}}),S(P,"$<=>",function(ne){return Ce(this["$equal?"](ne))?0:H}),S(P,"$+@",v),S(P,"$-@",function(){return D(0,this)}),S(P,"$%",function(ne){return D(this,z(ne,this.$div(ne)))}),S(P,"$abs",function(){return I(this,0)?this["$-@"]():this}),S(P,"$abs2",function(){return z(this,this)}),S(P,"$angle",function(){return I(this,0)?A(A("Math"),"PI"):0}),S(P,"$ceil",function(ne){return null==ne&&(ne=0),this.$to_f().$ceil(ne)},-1),S(P,"$conj",v),S(P,"$denominator",function(){return this.$to_r().$denominator()}),S(P,"$div",function(ne){return Q(ne,0)&&f.$raise(A("ZeroDivisionError"),"divided by o"),U(this,ne).$floor()}),S(P,"$divmod",function(ne){return[this.$div(ne),this["$%"](ne)]}),S(P,"$fdiv",function(ne){return U(this.$to_f(),ne)}),S(P,"$floor",function(ne){return null==ne&&(ne=0),this.$to_f().$floor(ne)},-1),S(P,"$i",function(){return f.$Complex(0,this)}),S(P,"$imag",N(0)),S(P,"$integer?",N(!1)),S(P,"$nonzero?",function(){return Ce(this["$zero?"]())?H:this}),S(P,"$numerator",function(){return this.$to_r().$numerator()}),S(P,"$polar",function(){return[this.$abs(),this.$arg()]}),S(P,"$quo",function(ne){return U(G["$coerce_to!"](this,A("Rational"),"to_r"),ne)}),S(P,"$real",v),S(P,"$real?",N(!0)),S(P,"$rect",function(){return[this,0]}),S(P,"$round",function(ne){return this.$to_f().$round(ne)},-1),S(P,"$step",function L(ne,F,he){var O,m,l,c,h,d,B=L.$$p||H,p=this,_=H;function x(){c===H&&f.$raise(A("TypeError"),"step must be numeric"),null!=c&&c["$=="](0)&&f.$raise(A("ArgumentError"),"step can't be 0"),(c===H||null==c)&&(c=1);var De=c["$<=>"](0);De===H&&f.$raise(A("ArgumentError"),"0 can't be coerced into "+c.$class()),(l===H||null==l)&&(l=De>0?A(A("Float"),"INFINITY"):A(A("Float"),"INFINITY")["$-@"]()),G.$compare(p,l)}function $(){if(c>0&&p>l||c<0&&p<l)return 0;if(c===1/0||c===-1/0)return 1;var De=Math.abs,Me=Math.floor,_e=(De(p)+De(l)+De(l-p))/De(c)*A(A("Float"),"EPSILON");return _e===1/0||_e===-1/0?0:(_e>.5&&(_e=.5),Me((l-p)/c+_e)+1)}function se(){if(x(),0===c)return 1/0;if(c%1!=0)return $();if(c>0&&p>l||c<0&&p<l)return 0;var De=Math.ceil,Me=Math.abs;return De((Me(p-l)+1)/Me(c))}if(L.$$p=null,O=re(arguments),m=q(O),m=E(m),O.length>0&&(l=O.shift()),O.length>0&&(c=O.shift()),h=m.$$smap.to,d=m.$$smap.by,void 0!==l&&void 0!==h&&f.$raise(A("ArgumentError"),"to is given twice"),void 0!==c&&void 0!==d&&f.$raise(A("ArgumentError"),"step is given twice"),void 0!==h&&(l=h),void 0!==d&&(c=d),void 0===l&&(l=H),B===H)return(V(l)||Ce(l["$is_a?"](A("Numeric"))))&&(V(c)||Ce(c["$is_a?"](A("Numeric"))))?A(A("Enumerator"),"ArithmeticSequence").$new([l,c,Ce(h)?"to: ":H,Ce(d)?"by: ":H],p):le(p,"enum_for",["step",l,c],se.$to_proc());x();var ae=c["$negative?"](),Te=c["$=="](0)||l===1/0&&!ae||l===-1/0&&ae;if(p.$$is_number&&c.$$is_number&&l.$$is_number){if(p%1!=0||!Te&&l%1!=0||c%1!=0){var de=p.$to_f().valueOf();c=c.$to_f().valueOf(),l=l.$to_f().valueOf();var Fe=$();if(isFinite(c))if(0===c)for(;;)B(de);else for(var xe=0;xe<Fe;xe++){var ke=xe*c+p;(c>=0?l<ke:l>ke)&&(ke=l),B(ke)}else 0!==Fe&&B(de);return p}var Ae=p;if(Te)for(;;Ae+=c)B(Ae);else if(ae)for(;Ae>=l;Ae+=c)B(Ae);else for(;Ae<=l;Ae+=c)B(Ae);return p}for(_=p;Ce(ae?Z(_,l):Y(_,l));)T.yield1(B,_),_=X(_,c)},-1),S(P,"$to_c",function(){return f.$Complex(this,0)}),S(P,"$to_int",function(){return this.$to_i()}),S(P,"$truncate",function(ne){return null==ne&&(ne=0),this.$to_f().$truncate(ne)},-1),S(P,"$zero?",function(){return this["$=="](0)}),S(P,"$positive?",function(){return k(this,0)}),S(P,"$negative?",function(){return I(this,0)}),S(P,"$dup",v),S(P,"$clone",function(ne){return ne=E(ne),this},-1),S(P,"$finite?",N(!0)),S(P,"$infinite?",N(H)),R(P,"arg","angle"),R(P,"conjugate","conj"),R(P,"imaginary","imag"),R(P,"magnitude","abs"),R(P,"modulo","%"),R(P,"phase","arg"),R(P,"rectangular","rect")},Opal.modules["corelib/array"]=function(T){var fe=T.truthy,Ce=T.falsy,f=T.hash_ids,S=T.yield1,te=T.hash_get,v=T.hash_put,D=T.hash_delete,z=T.coerce_to,I=T.respond_to,Q=T.deny_frozen_access,U=T.freeze,N=T.klass,G=T.slice,re=T.defs,q=T.Kernel,E=T.def,V=T.Opal,le=T.eqeqeq,Z=T.hash2,Y=T.send2,X=T.find_super,k=T.send,R=T.rb_gt,ee=T.rb_times,H=T.eqeq,A=T.rb_minus,M=T.to_a,C=T.to_ary,P=T.gvars,L=T.rb_ge,ne=T.assign_ivar,F=T.rb_lt,he=T.return_self,B=T.neqeq,O=T.alias,m=T.top,c=T.nil,h=T.$$$;return m.$require("corelib/enumerable"),m.$require("corelib/numeric"),function(d,p,_){var x=N("::",Array,"Array"),$=[x].concat([]),se=T.$r($);function Te(_e,ce){return ce.$$name===T.Array?_e:ce.$allocate().$replace(_e.$to_a())}function Ae(_e,ce,pe){for(var ye,b=null,K=new Array(_e.length),ge=0,be=0,Pe=_e.length;ge<Pe;ge++){if(!b)try{ye=S(pe,_e[ge])}catch(Ue){b=Ue}(b||ce(ye))&&(K[be]=_e[ge],be+=1)}if(be!==ge&&(_e.splice.apply(_e,[0,K.length].concat(K)),_e.splice(be,K.length)),b)throw b}function de(_e,ce){var ye,b,K,pe=_e.length;return ye=ce.excl,b=ce.begin===c?0:z(ce.begin,T.Integer,"to_int"),K=ce.end===c?-1:z(ce.end,T.Integer,"to_int"),b<0&&(b+=pe)<0||(ce.excl_rev&&ce.begin!==c&&(b+=1),b>pe)?c:K<0&&(K+=pe)<0?[]:((!ye||ce.end===c)&&(K+=1),_e.slice(b,K))}function ke(_e,ce){return _e===ce||0===ce?1:ce>0&&_e>ce?ke(_e-1,ce-1)+ke(_e-1,ce):0}x.$include(h("Enumerable")),T.prop(x.$$prototype,"$$is_array",!0),re(x,"$[]",function(ce){var b=this;return Te(G(arguments),b)},-1),E(x,"$initialize",function _e(ce,pe){var K,ge,ye=_e.$$p||c,b=this;if(_e.$$p=null,null==ce&&(ce=c),null==pe&&(pe=c),Q(b),pe!==c&&ye!==c&&q.$warn("warning: block supersedes default value argument"),ce>h(h("Integer"),"MAX")&&q.$raise(h("ArgumentError"),"array size too big"),arguments.length>2&&q.$raise(h("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..2)"),0===arguments.length)return b.splice(0,b.length),b;if(1===arguments.length){if(ce.$$is_array)return b.$replace(ce.$to_a()),b;if(ce["$respond_to?"]("to_ary"))return b.$replace(ce.$to_ary()),b}if((ce=z(ce,h("Integer"),"to_int"))<0&&q.$raise(h("ArgumentError"),"negative array size"),b.splice(0,b.length),ye===c)for(K=0;K<ce;K++)b.push(pe);else for(K=0;K<ce;K++)ge=ye(K),b[K]=ge;return b},-1),re(x,"$try_convert",function(ce){return V["$coerce_to?"](ce,h("Array"),"to_ary")}),E(x,"$&",function(ce){ce=le(h("Array"),ce)?ce.$to_a():z(ce,h("Array"),"to_ary").$to_a();var K,ge,be,ye=[],b=Z([],{});for(K=0,ge=ce.length;K<ge;K++)v(b,ce[K],!0);for(K=0,ge=this.length;K<ge;K++)void 0!==D(b,be=this[K])&&ye.push(be);return ye}),E(x,"$|",function(ce){ce=le(h("Array"),ce)?ce.$to_a():z(ce,h("Array"),"to_ary").$to_a();var b,K,ye=Z([],{});for(b=0,K=this.length;b<K;b++)v(ye,this[b],!0);for(b=0,K=ce.length;b<K;b++)v(ye,ce[b],!0);return ye.$keys()}),E(x,"$*",function(ce){if(fe(ce["$respond_to?"]("to_str")))return this.$join(ce.$to_str());ce=z(ce,h("Integer"),"to_int"),fe(ce<0)&&q.$raise(h("ArgumentError"),"negative argument");for(var ye=[],b=this.$to_a(),K=0;K<ce;K++)ye=ye.concat(b);return ye}),E(x,"$+",function(ce){return ce=le(h("Array"),ce)?ce.$to_a():z(ce,h("Array"),"to_ary").$to_a(),this.concat(ce)}),E(x,"$-",function(ce){if(ce=le(h("Array"),ce)?ce.$to_a():z(ce,h("Array"),"to_ary").$to_a(),fe(0===this.length))return[];if(fe(0===ce.length))return this.slice();var K,ge,be,ye=[],b=Z([],{});for(K=0,ge=ce.length;K<ge;K++)v(b,ce[K],!0);for(K=0,ge=this.length;K<ge;K++)void 0===te(b,be=this[K])&&ye.push(be);return ye}),E(x,"$<<",function(ce){return Q(this),this.push(ce),this}),E(x,"$<=>",function(ce){if(le(h("Array"),ce))ce=ce.$to_a();else{if(!fe(ce["$respond_to?"]("to_ary")))return c;ce=ce.$to_ary().$to_a()}if(this.$hash()===ce.$hash())return 0;for(var ye=Math.min(this.length,ce.length),b=0;b<ye;b++){var K=this[b]["$<=>"](ce[b]);if(0!==K)return K}return this.length["$<=>"](ce.length)}),E(x,"$==",function(ce){var ye={};return function b(K,ge){var be,Pe,Ue,Ye;if(K===ge)return!0;if(!ge.$$is_array)return!!I(ge,"$to_ary")&&ge["$=="](K);if(K.$$constructor!==Array&&(K=K.$to_a()),ge.$$constructor!==Array&&(ge=ge.$to_a()),K.length!==ge.length)return!1;for(ye[K.$object_id()]=!0,be=0,Pe=K.length;be<Pe;be++)if(Ye=ge[be],(Ue=K[be]).$$is_array){if(Ye.$$is_array&&Ye.length!==Ue.length||!ye.hasOwnProperty(Ue.$object_id())&&!b(Ue,Ye))return!1}else if(!Ue["$=="](Ye))return!1;return!0}(this,ce)}),E(x,"$[]",function(ce,pe){return ce.$$is_range?de(this,ce):ce.$$is_arithmetic_seq?function Fe(_e,ce){var pe,ye=[],b=0;for(pe=ce.step<0?de(_e,{begin:ce.range.end,end:ce.range.begin,excl:!1,excl_rev:ce.range.excl}).$reverse():de(_e,ce.range);b<pe.length;)ye.push(pe[b]),b+=Math.abs(ce.step);return ye}(this,ce):function xe(_e,ce,pe){var ye=_e.length;return(ce=z(ce,T.Integer,"to_int"))<0&&(ce+=ye)<0?c:void 0===pe?ce>=ye||ce<0?c:_e[ce]:(pe=z(pe,T.Integer,"to_int"))<0||ce>ye||ce<0?c:_e.slice(ce,ce+pe)}(this,ce,pe)},-2),E(x,"$[]=",function(ce,pe,ye){var b=this,K=c,ge=c;Q(b),K=c;var be,vt,Pe=b.length;if(ce.$$is_range){K=pe.$$is_array?pe.$to_a():pe["$respond_to?"]("to_ary")?pe.$to_ary().$to_a():[pe];var Ue=ce.excl,Ye=ce.begin===c?0:z(ce.begin,T.Integer,"to_int"),nt=ce.end===c?-1:z(ce.end,T.Integer,"to_int");if(Ye<0&&(Ye+=Pe)<0&&q.$raise(h("RangeError"),ce.$inspect()+" out of range"),nt<0&&(nt+=Pe),(!Ue||ce.end===c)&&(nt+=1),Ye>Pe)for(be=Pe;be<Ye;be++)b[be]=c;return b.splice.apply(b,nt<0?[Ye,0].concat(K):[Ye,nt-Ye].concat(K)),pe}if(void 0===ye?ge=1:(ge=pe,K=(pe=ye).$$is_array?pe.$to_a():pe["$respond_to?"]("to_ary")?pe.$to_ary().$to_a():[pe]),ce=z(ce,h("Integer"),"to_int"),ge=z(ge,h("Integer"),"to_int"),ce<0&&(vt=ce,(ce+=Pe)<0&&q.$raise(h("IndexError"),"index "+vt+" too small for array; minimum "+-b.length)),ge<0&&q.$raise(h("IndexError"),"negative length ("+ge+")"),ce>Pe)for(be=Pe;be<ce;be++)b[be]=c;return void 0===ye?b[ce]=pe:b.splice.apply(b,[ce,ge].concat(K)),pe},-3),E(x,"$any?",function _e(ce){var pe=_e.$$p||c;return _e.$$p=null,0!==this.length&&Y(this,X(this,"any?",_e,!1,!0),"any?",[ce],pe)},-1),E(x,"$assoc",function(ce){for(var K,ye=0,b=this.length;ye<b;ye++)if((K=this[ye]).length&&K[0]["$=="](ce))return K;return c}),E(x,"$at",function(ce){return(ce=z(ce,h("Integer"),"to_int"))<0&&(ce+=this.length),ce<0||ce>=this.length?c:this[ce]}),E(x,"$bsearch_index",function _e(){var ce=_e.$$p||c;if(_e.$$p=null,ce===c)return this.$enum_for("bsearch_index");for(var K,be,ye=0,b=this.length,Pe=!1,Ue=c;ye<b;){if(K=ye+Math.floor((b-ye)/2),!0===(be=S(ce,this[K])))Ue=K,Pe=!0;else if(!1===be||be===c)Pe=!1;else if(be.$$is_number){if(0===be)return K;Pe=be<0}else q.$raise(h("TypeError"),"wrong argument type "+be.$class()+" (must be numeric, true, false or nil)");Pe?b=K:ye=K+1}return Ue}),E(x,"$bsearch",function _e(){var ce=_e.$$p||c,ye=c;return _e.$$p=null,ce===c?this.$enum_for("bsearch"):null!=(ye=k(this,"bsearch_index",[],ce.$to_proc()))&&ye.$$is_number?this[ye]:ye}),E(x,"$cycle",function _e(ce){var b,K,pe=_e.$$p||c,ye=this;if(_e.$$p=null,null==ce&&(ce=c),pe===c)return k(ye,"enum_for",["cycle",ce],function be(){var Pe=null==be.$$s?this:be.$$s;return fe(ce["$nil?"]())?h(h("Float"),"INFINITY"):(ce=V["$coerce_to!"](ce,h("Integer"),"to_int"),fe(R(ce,0))?ee(Pe.$enumerator_size(),ce):0)},{$$s:ye});if(fe(ye["$empty?"]())||H(ce,0))return c;if(ce===c)for(;;)for(b=0,K=ye.length;b<K;b++)S(pe,ye[b]);else{if((ce=V["$coerce_to!"](ce,h("Integer"),"to_int"))<=0)return ye;for(;ce>0;){for(b=0,K=ye.length;b<K;b++)S(pe,ye[b]);ce--}}return ye},-1),E(x,"$clear",function(){return Q(this),this.splice(0,this.length),this}),E(x,"$count",function _e(ce){var pe=_e.$$p||c;return _e.$$p=null,fe(void 0!==ce)||fe(pe)?Y(this,X(this,"count",_e,!1,!0),"count",[ce],pe):this.$size()},-1),E(x,"$initialize_copy",function(ce){return this.$replace(ce)}),E(x,"$collect",function _e(){var ce=_e.$$p||c;if(_e.$$p=null,ce===c)return k(this,"enum_for",["collect"],function be(){return(null==be.$$s?this:be.$$s).$size()},{$$s:this});for(var ye=[],b=0,K=this.length;b<K;b++){var ge=S(ce,this[b]);ye.push(ge)}return ye}),E(x,"$collect!",function _e(){var ce=_e.$$p||c,pe=this;if(_e.$$p=null,ce===c)return k(pe,"enum_for",["collect!"],function ge(){return(null==ge.$$s?this:ge.$$s).$size()},{$$s:pe});Q(pe);for(var ye=0,b=pe.length;ye<b;ye++){var K=S(ce,pe[ye]);pe[ye]=K}return pe}),E(x,"$combination",function _e(ce){var b,K,ge,be,Pe,Ue,Ye,nt,pe=_e.$$p||c,ye=this;if(_e.$$p=null,b=V["$coerce_to!"](ce,h("Integer"),"to_int"),pe===c)return k(ye,"enum_for",["combination",b],function vt(){return ke((null==vt.$$s?this:vt.$$s).length,b)},{$$s:ye});if(0===b)T.yield1(pe,[]);else if(1===b)for(K=0,ge=ye.length;K<ge;K++)T.yield1(pe,[ye[K]]);else if(b===ye.length)T.yield1(pe,ye.slice());else if(b>=0&&b<ye.length){for(be=[],K=0;K<=b+1;K++)be.push(0);for(Pe=[],Ue=0,Ye=!1,be[0]=-1;!Ye;){for(Pe[Ue]=ye[be[Ue+1]];Ue<b-1;)nt=be[1+ ++Ue]=be[Ue]+1,Pe[Ue]=ye[nt];T.yield1(pe,Pe.slice()),Ue++;do{Ye=0===Ue,be[Ue]++,Ue--}while(be[Ue+1]+b===ye.length+Ue+1)}}return ye}),E(x,"$repeated_combination",function _e(ce){var b,pe=_e.$$p||c;return _e.$$p=null,b=V["$coerce_to!"](ce,h("Integer"),"to_int"),pe===c?k(this,"enum_for",["repeated_combination",b],function ge(){return ke((null==ge.$$s?this:ge.$$s).length+b-1,b)},{$$s:this}):(b>=0&&function K(ge,be,Pe,Ue){if(Pe.length!=ge)for(var nt=be;nt<Ue.length;nt++)Pe.push(Ue[nt]),K(ge,nt,Pe,Ue),Pe.pop();else{var Ye=Pe.slice();T.yield1(pe,Ye)}}(b,0,[],this),this)}),E(x,"$compact",function(){for(var K,pe=[],ye=0,b=this.length;ye<b;ye++)(K=this[ye])!==c&&pe.push(K);return pe}),E(x,"$compact!",function(){var ce=this;Q(ce);for(var pe=ce.length,ye=0,b=ce.length;ye<b;ye++)ce[ye]===c&&(ce.splice(ye,1),b--,ye--);return ce.length===pe?c:ce}),E(x,"$concat",function(ce){var ye,b=this;return ye=G(arguments),Q(b),ye=k(ye,"map",[],function K(ge){var be=null==K.$$s?this:K.$$s;return null==ge&&(ge=c),ge=le(h("Array"),ge)?ge.$to_a():z(ge,h("Array"),"to_ary").$to_a(),fe(ge["$equal?"](be))&&(ge=ge.$dup()),ge},{$$s:b}),k(ye,"each",[],function K(ge){var be=null==K.$$s?this:K.$$s;null==ge&&(ge=c);for(var Pe=0,Ue=ge.length;Pe<Ue;Pe++)be.push(ge[Pe])},{$$s:b}),b},-1),E(x,"$delete",function _e(ce){var pe=_e.$$p||c,ye=this;_e.$$p=null;for(var b=ye.length,K=0,ge=b;K<ge;K++)ye[K]["$=="](ce)&&(Q(ye),ye.splice(K,1),ge--,K--);return ye.length===b?pe!==c?T.yieldX(pe,[]):c:ce}),E(x,"$delete_at",function(ce){var pe=this;if(Q(pe),(ce=z(ce,h("Integer"),"to_int"))<0&&(ce+=pe.length),ce<0||ce>=pe.length)return c;var ye=pe[ce];return pe.splice(ce,1),ye}),E(x,"$delete_if",function _e(){var ce=_e.$$p||c,pe=this;return _e.$$p=null,ce===c?k(pe,"enum_for",["delete_if"],function ye(){return(null==ye.$$s?this:ye.$$s).$size()},{$$s:pe}):(Q(pe),Ae(pe,Ce,ce),pe)}),E(x,"$difference",function(ce){var pe,b=this;return pe=G(arguments),k(pe,"reduce",[b.$to_a().$dup()],function(ge,be){return null==ge&&(ge=c),null==be&&(be=c),A(ge,be)})},-1),E(x,"$dig",function(ce,pe){var b,K=this,ge=c;return b=G(arguments,1),(ge=K["$[]"](ce))===c||0===b.length?ge:(fe(ge["$respond_to?"]("dig"))||q.$raise(h("TypeError"),ge.$class()+" does not have #dig method"),k(ge,"dig",M(b)))},-2),E(x,"$drop",function(ce){return(ce=z(ce,h("Integer"),"to_int"))<0&&q.$raise(h("ArgumentError")),this.slice(ce)}),E(x,"$dup",function _e(){var ce=_e.$$p||c,pe=this;return _e.$$p=null,pe.$$class===T.Array&&pe.$$class.$allocate.$$pristine&&pe.$copy_instance_variables.$$pristine&&pe.$initialize_dup.$$pristine?pe.slice(0):Y(pe,X(pe,"dup",_e,!1,!0),"dup",[],ce)}),E(x,"$each",function _e(){var ce=_e.$$p||c,pe=this;if(_e.$$p=null,ce===c)return k(pe,"enum_for",["each"],function ge(){return(null==ge.$$s?this:ge.$$s).$size()},{$$s:pe});for(var ye=0,b=pe.length;ye<b;ye++)S(ce,pe[ye]);return pe}),E(x,"$each_index",function _e(){var ce=_e.$$p||c;if(_e.$$p=null,ce===c)return k(this,"enum_for",["each_index"],function ge(){return(null==ge.$$s?this:ge.$$s).$size()},{$$s:this});for(var ye=0,b=this.length;ye<b;ye++)S(ce,ye);return this}),E(x,"$empty?",function(){return 0===this.length}),E(x,"$eql?",function(ce){var ye={};return function b(K,ge){var be,Pe,Ue,Ye;if(!ge.$$is_array||(ge=ge.$to_a(),K.length!==ge.length))return!1;for(ye[K.$object_id()]=!0,be=0,Pe=K.length;be<Pe;be++)if(Ye=ge[be],(Ue=K[be]).$$is_array){if(Ye.$$is_array&&Ye.length!==Ue.length||!ye.hasOwnProperty(Ue.$object_id())&&!b(Ue,Ye))return!1}else if(!Ue["$eql?"](Ye))return!1;return!0}(this,ce)}),E(x,"$fetch",function _e(ce,pe){var ye=_e.$$p||c,b=this;_e.$$p=null;var K=ce;return(ce=z(ce,h("Integer"),"to_int"))<0&&(ce+=b.length),ce>=0&&ce<b.length?b[ce]:(ye!==c&&null!=pe&&b.$warn("warning: block supersedes default value argument"),ye!==c?ye(K):null!=pe?pe:void q.$raise(h("IndexError"),0===b.length?"index "+K+" outside of array bounds: 0...0":"index "+K+" outside of array bounds: -"+b.length+"..."+b.length))},-2),E(x,"$fill",function _e(ce){var b,K,wt,an,pe=_e.$$p||c,be=this,Pe=c,Ue=c,Ye=c,nt=c,vt=c;if(_e.$$p=null,b=G(arguments),Q(be),fe(pe)?(fe(b.length>2)&&q.$raise(h("ArgumentError"),"wrong number of arguments ("+b.$length()+" for 0..2)"),Pe=null==(K=C(b))[0]?c:K[0],Ue=null==K[1]?c:K[1]):(fe(0==b.length)?q.$raise(h("ArgumentError"),"wrong number of arguments (0 for 1..3)"):fe(b.length>3)&&q.$raise(h("ArgumentError"),"wrong number of arguments ("+b.$length()+" for 1..3)"),Ye=null==(K=C(b))[0]?c:K[0],Pe=null==K[1]?c:K[1],Ue=null==K[2]?c:K[2]),le(h("Range"),Pe)){if(fe(Ue)&&q.$raise(h("TypeError"),"length invalid with range"),nt=Pe.begin===c?0:z(Pe.begin,h("Integer"),"to_int"),fe(nt<0)&&(nt+=this.length),fe(nt<0)&&q.$raise(h("RangeError"),Pe.$inspect()+" out of range"),vt=Pe.end===c?-1:z(Pe.end,h("Integer"),"to_int"),fe(vt<0)&&(vt+=this.length),fe(Pe["$exclude_end?"]())||(vt+=1),fe(vt<=nt))return be}else if(fe(Pe))if(nt=z(Pe,h("Integer"),"to_int"),fe(nt<0)&&(nt+=this.length),fe(nt<0)&&(nt=0),fe(Ue)){if(vt=z(Ue,h("Integer"),"to_int"),fe(0==vt))return be;vt+=nt}else vt=this.length;else nt=0,vt=this.length;if(fe(nt>this.length))for(wt=this.length;wt<vt;wt++)be[wt]=c;if(fe(vt>this.length)&&(this.length=vt),fe(pe))for(;nt<vt;nt++)an=pe(nt),be[nt]=an;else for(;nt<vt;nt++)be[nt]=Ye;return be},-1),E(x,"$first",function(ce){return null==ce?0===this.length?c:this[0]:((ce=z(ce,h("Integer"),"to_int"))<0&&q.$raise(h("ArgumentError"),"negative array size"),this.slice(0,ce))},-1),E(x,"$flatten",function(ce){var pe=this;return void 0!==ce&&(ce=z(ce,h("Integer"),"to_int")),function ye(b,K){var be,Pe,Ue,Ye,ge=[];for(be=0,Pe=(b=b.$to_a()).length;be<Pe;be++)if(I(Ue=b[be],"$to_ary",!0))if((Ye=Ue.$to_ary())!==c)switch(Ye.$$is_array||q.$raise(h("TypeError")),Ye===pe&&q.$raise(h("ArgumentError")),K){case void 0:ge=ge.concat(ye(Ye));break;case 0:ge.push(Ye);break;default:ge.push.apply(ge,ye(Ye,K-1))}else ge.push(Ue);else ge.push(Ue);return ge}(pe,ce)},-1),E(x,"$flatten!",function(ce){var pe=this;Q(pe);var ye=pe.$flatten(ce);if(pe.length==ye.length){for(var b=0,K=pe.length;b<K&&pe[b]===ye[b];b++);if(b==K)return c}return pe.$replace(ye),pe},-1),E(x,"$freeze",function(){return fe(this["$frozen?"]())?this:U(this)}),E(x,"$hash",function(){var ge,be,ce=this,pe=void 0===f,ye=["A"],b=ce.$object_id();try{if(pe&&(f=Object.create(null)),f[b])return"self";for(be in f)if(ce["$eql?"](f[be]))return"self";for(f[b]=ce,ge=0;ge<ce.length;ge++)ye.push(ce[ge].$hash());return ye.join(",")}finally{pe&&(f=void 0)}}),E(x,"$include?",function(ce){for(var ye=0,b=this.length;ye<b;ye++)if(this[ye]["$=="](ce))return!0;return!1}),E(x,"$index",function _e(ce){var b,K,ge,pe=_e.$$p||c,ye=this;if(_e.$$p=null,null!=ce&&pe!==c&&ye.$warn("warning: given block not used"),null!=ce){for(b=0,K=ye.length;b<K;b++)if(ye[b]["$=="](ce))return b}else{if(pe===c)return ye.$enum_for("index");for(b=0,K=ye.length;b<K;b++)if(!1!==(ge=pe(ye[b]))&&ge!==c)return b}return c},-1),E(x,"$insert",function(ce,pe){var b,K=this;if(b=G(arguments,1),Q(K),ce=z(ce,h("Integer"),"to_int"),b.length>0){if(ce<0&&(ce+=K.length+1)<0&&q.$raise(h("IndexError"),ce+" is out of bounds"),ce>K.length)for(var ge=K.length;ge<ce;ge++)K.push(c);K.splice.apply(K,[ce,0].concat(b))}return K},-2);var pe,De=[];return E(x,"$inspect",function(){var ce=this,pe=[],ye=ce.$__id__(),b=!0;return function(){try{if(-1!==De.indexOf(ye))return b=!1,"[...]";De.push(ye);for(var K=0,ge=ce.length;K<ge;K++){var be=ce["$[]"](K);pe.push(se("Opal").$inspect(be))}return"["+pe.join(", ")+"]"}finally{b&&De.pop()}}()}),E(x,"$intersection",function(ce){var pe,b=this;return pe=G(arguments),k(pe,"reduce",[b.$to_a().$dup()],function(ge,be){return null==ge&&(ge=c),null==be&&(be=c),ge["$&"](be)})},-1),E(x,"$intersect?",function(ce){return this.$intersection(ce)["$empty?"]()["$!"]()}),E(x,"$join",function(ce){var pe=this;if(null==P[","]&&(P[","]=c),null==ce&&(ce=c),fe(0===pe.length))return"";fe(ce===c)&&(ce=P[","]);var b,K,ge,be,ye=[];for(b=0,K=pe.length;b<K;b++)I(ge=pe[b],"$to_str")&&(be=ge.$to_str())!==c?ye.push(be.$to_s()):I(ge,"$to_ary")&&((be=ge.$to_ary())===pe&&q.$raise(h("ArgumentError")),be!==c)?ye.push(be.$join(ce)):I(ge,"$to_s")&&(be=ge.$to_s())!==c?ye.push(be):q.$raise(h("NoMethodError").$new(se("Opal").$inspect(pe.$item())+" doesn't respond to #to_str, #to_ary or #to_s","to_str"));return ye.join(ce===c?"":V["$coerce_to!"](ce,h("String"),"to_str").$to_s())},-1),E(x,"$keep_if",function _e(){var ce=_e.$$p||c,pe=this;return _e.$$p=null,ce===c?k(pe,"enum_for",["keep_if"],function ye(){return(null==ye.$$s?this:ye.$$s).$size()},{$$s:pe}):(Q(pe),Ae(pe,fe,ce),pe)}),E(x,"$last",function(ce){var pe=this;return null==ce?0===pe.length?c:pe[pe.length-1]:((ce=z(ce,h("Integer"),"to_int"))<0&&q.$raise(h("ArgumentError"),"negative array size"),ce>pe.length&&(ce=pe.length),pe.slice(pe.length-ce,pe.length))},-1),E(x,"$length",function(){return this.length}),E(x,"$max",function _e(ce){var pe=_e.$$p||c;return _e.$$p=null,k(this.$each(),"max",[ce],pe.$to_proc())},-1),E(x,"$min",function _e(){var ce=_e.$$p||c;return _e.$$p=null,k(this.$each(),"min",[],ce.$to_proc())}),E(x,"$permutation",function _e(ce){var ge,be,Pe,pe=_e.$$p||c,ye=this,b=c,K=c;if(_e.$$p=null,pe===c)return k(ye,"enum_for",["permutation",ce],function Ye(){var nt=null==Ye.$$s?this:Ye.$$s;return function Me(_e,ce){for(var pe=ce>=0?1:0;ce;)pe*=_e,_e--,ce--;return pe}(nt.length,void 0===ce?nt.length:ce)},{$$s:ye});if(!((ce=void 0===ce?ye.length:z(ce,h("Integer"),"to_int"))<0||ye.length<ce))if(0===ce)T.yield1(pe,[]);else if(1===ce)for(var Ue=0;Ue<ye.length;Ue++)T.yield1(pe,[ye[Ue]]);else b=se("Array").$new(ce),K=se("Array").$new(ye.length,!1),ge=function(Ye,nt,vt,wt,cn){ye=this;for(var an=0;an<ye.length;an++)if(wt["$[]"](an)["$!"]())if(nt[vt]=an,vt<Ye-1)wt[an]=!0,ge.call(ye,Ye,nt,vt+1,wt,cn),wt[an]=!1;else{Pe=[];for(var Bn=0;Bn<nt.length;Bn++)Pe.push(ye[nt[Bn]]);S(cn,Pe)}},pe!==c?(be=ye.slice(),ge.call(be,ce,b,0,K,pe)):ge.call(ye,ce,b,0,K,pe);return ye},-1),E(x,"$repeated_permutation",function _e(ce){var b,pe=_e.$$p||c;return _e.$$p=null,b=V["$coerce_to!"](ce,h("Integer"),"to_int"),pe===c?k(this,"enum_for",["repeated_permutation",b],function ge(){var be=null==ge.$$s?this:ge.$$s;return fe(L(b,0))?be.$size()["$**"](b):0},{$$s:this}):(function K(ge,be,Pe){if(be.length!=ge)for(var Ye=0;Ye<Pe.length;Ye++)be.push(Pe[Ye]),K(ge,be,Pe),be.pop();else{var Ue=be.slice();T.yield1(pe,Ue)}}(b,[],this.slice()),this)}),E(x,"$pop",function(ce){var pe=this;return Q(pe),fe(void 0===ce)?fe(0===pe.length)?c:pe.pop():(ce=z(ce,h("Integer"),"to_int"),fe(ce<0)&&q.$raise(h("ArgumentError"),"negative array size"),fe(0===pe.length)?[]:fe(1===ce)?[pe.pop()]:fe(ce>pe.length)?pe.splice(0,pe.length):pe.splice(pe.length-ce,pe.length))},-1),E(x,"$product",function _e(ce){var ye,b,pe=_e.$$p||c,K=this;_e.$$p=null,ye=G(arguments);var nt,vt,wt,cn,ge=pe!==c?null:[],be=(b=ye).length+1,Pe=new Array(be),Ue=new Array(be),Ye=new Array(be),an=1;for(Ye[0]=K,nt=1;nt<be;nt++)Ye[nt]=z(b[nt-1],h("Array"),"to_ary");for(nt=0;nt<be;nt++){if(0===(cn=Ye[nt].length))return ge||K;(an*=cn)>2147483647&&q.$raise(h("RangeError"),"too big to product"),Ue[nt]=cn,Pe[nt]=0}e:for(;;){for(wt=[],nt=0;nt<be;nt++)wt.push(Ye[nt][Pe[nt]]);for(ge?ge.push(wt):T.yield1(pe,wt),Pe[vt=be-1]++;Pe[vt]===Ue[vt];){if(Pe[vt]=0,--vt<0)break e;Pe[vt]++}}return ge||K},-1),E(x,"$push",function(ce){var ye,b=this;ye=G(arguments),Q(b);for(var K=0,ge=ye.length;K<ge;K++)b.push(ye[K]);return b},-1),E(x,"$rassoc",function(ce){for(var K,ye=0,b=this.length;ye<b;ye++)if((K=this[ye]).length&&void 0!==K[1]&&K[1]["$=="](ce))return K;return c}),E(x,"$reject",function _e(){var ce=_e.$$p||c,pe=this;if(_e.$$p=null,ce===c)return k(pe,"enum_for",["reject"],function be(){return(null==be.$$s?this:be.$$s).$size()},{$$s:pe});for(var ge,ye=[],b=0,K=pe.length;b<K;b++)(!1===(ge=ce(pe[b]))||ge===c)&&ye.push(pe[b]);return ye}),E(x,"$reject!",function _e(){var ce=_e.$$p||c,pe=this,ye=c;return _e.$$p=null,ce===c?k(pe,"enum_for",["reject!"],function b(){return(null==b.$$s?this:b.$$s).$size()},{$$s:pe}):(Q(pe),ye=pe.$length(),k(pe,"delete_if",[],ce.$to_proc()),H(pe.$length(),ye)?c:pe)}),E(x,"$replace",function(ce){var pe=this;return Q(pe),ce=le(h("Array"),ce)?ce.$to_a():z(ce,h("Array"),"to_ary").$to_a(),pe.splice(0,pe.length),pe.push.apply(pe,ce),pe}),E(x,"$reverse",function(){return this.slice(0).reverse()}),E(x,"$reverse!",function(){return Q(this),this.reverse()}),E(x,"$reverse_each",function _e(){var ce=_e.$$p||c;return _e.$$p=null,ce===c?k(this,"enum_for",["reverse_each"],function ye(){return(null==ye.$$s?this:ye.$$s).$size()},{$$s:this}):(k(this.$reverse(),"each",[],ce.$to_proc()),this)}),E(x,"$rindex",function _e(ce){var b,K,pe=_e.$$p||c,ye=this;if(_e.$$p=null,null!=ce&&pe!==c&&ye.$warn("warning: given block not used"),null!=ce){for(b=ye.length-1;b>=0&&!(b>=ye.length);b--)if(ye[b]["$=="](ce))return b}else if(pe!==c){for(b=ye.length-1;b>=0&&!(b>=ye.length);b--)if(!1!==(K=pe(ye[b]))&&K!==c)return b}else if(null==ce)return ye.$enum_for("rindex");return c},-1),E(x,"$rotate",function(ce){var ye,b,K,ge;return null==ce&&(ce=1),ce=z(ce,h("Integer"),"to_int"),1===this.length?this.slice():0===this.length?[]:(K=(ye=this.slice()).slice(b=ce%ye.length),ge=ye.slice(0,b),K.concat(ge))},-1),E(x,"$rotate!",function(ce){var pe=this,ye=c;return null==ce&&(ce=1),Q(pe),0===pe.length||1===pe.length?pe:(ce=z(ce,h("Integer"),"to_int"),ye=pe.$rotate(ce),pe.$replace(ye))},-1),(pe=N(x,null,"SampleRandom")).$$prototype.rng=c,E(pe,"$initialize",ne("rng")),E(pe,"$rand",function(K){var be;return be=z(this.rng.$rand(K),h("Integer"),"to_int"),fe(be<0)&&q.$raise(h("RangeError"),"random value must be >= 0"),fe(be<K)||q.$raise(h("RangeError"),"random value must be less than Array size"),be}),E(x,"$sample",function(ce,pe){var ge,be,Pe,Ue,Ye,nt,vt,wt,ye=this,b=c,K=c;if(fe(void 0===ce))return ye.$at(q.$rand(ye.length));if(fe(void 0===pe)?fe(b=V["$coerce_to?"](ce,h("Hash"),"to_hash"))?(pe=b,ce=c):(pe=c,ce=z(ce,h("Integer"),"to_int")):(ce=z(ce,h("Integer"),"to_int"),pe=z(pe,h("Hash"),"to_hash")),fe(ce)&&fe(ce<0)&&q.$raise(h("ArgumentError"),"count must be greater than 0"),fe(pe)&&(K=pe["$[]"]("random")),K=fe(K)&&fe(K["$respond_to?"]("rand"))?se("SampleRandom").$new(K):q,!fe(ce))return ye[K.$rand(ye.length)];switch(ce>ye.length&&(ce=ye.length),ce){case 0:return[];case 1:return[ye[K.$rand(ye.length)]];case 2:return(Ue=K.$rand(ye.length))<=(Ye=K.$rand(ye.length-1))&&Ye++,[ye[Ue],ye[Ye]];default:if(ye.length/ce>3){for(ge=!1,be=0,Ue=1,(Pe=se("Array").$new(ce))[0]=K.$rand(ye.length);Ue<ce;){for(nt=K.$rand(ye.length),Ye=0;Ye<Ue;){for(;nt===Pe[Ye];){if(++be>100){ge=!0;break}nt=K.$rand(ye.length)}if(ge)break;Ye++}if(ge)break;Pe[Ue]=nt,Ue++}if(!ge){for(Ue=0;Ue<ce;)Pe[Ue]=ye[Pe[Ue]],Ue++;return Pe}}Pe=ye.slice();for(var cn=0;cn<ce;cn++)vt=K.$rand(ye.length-cn)+cn,wt=Pe[cn],Pe[cn]=Pe[vt],Pe[vt]=wt;return ce===ye.length?Pe:Pe["$[]"](0,ce)}},-1),E(x,"$select",function _e(){var ce=_e.$$p||c;if(_e.$$p=null,ce===c)return k(this,"enum_for",["select"],function Pe(){return(null==Pe.$$s?this:Pe.$$s).$size()},{$$s:this});for(var ge,be,ye=[],b=0,K=this.length;b<K;b++)be=S(ce,ge=this[b]),fe(be)&&ye.push(ge);return ye}),E(x,"$select!",function _e(){var ce=_e.$$p||c,pe=this;if(_e.$$p=null,ce===c)return k(pe,"enum_for",["select!"],function b(){return(null==b.$$s?this:b.$$s).$size()},{$$s:pe});Q(pe);var ye=pe.length;return k(pe,"keep_if",[],ce.$to_proc()),pe.length===ye?c:pe}),E(x,"$shift",function(ce){var pe=this;return Q(pe),fe(void 0===ce)?fe(0===pe.length)?c:function ae(_e){for(var ce=_e[0],pe=1,ye=_e.length;pe<ye;pe++)_e[pe-1]=_e[pe];return _e.pop(),ce}(pe):(ce=z(ce,h("Integer"),"to_int"),fe(ce<0)&&q.$raise(h("ArgumentError"),"negative array size"),fe(0===pe.length)?[]:pe.splice(0,ce))},-1),E(x,"$shuffle",function(ce){return this.$dup().$to_a()["$shuffle!"](ce)},-1),E(x,"$shuffle!",function(ce){var pe=this;Q(pe);var ye,K,ge,b=pe.length;for(void 0!==ce&&(ce=V["$coerce_to?"](ce,h("Hash"),"to_hash"))!==c&&(ce=ce["$[]"]("random"))!==c&&ce["$respond_to?"]("rand")&&(ye=ce);b;)ye?((K=ye.$rand(b).$to_int())<0&&q.$raise(h("RangeError"),"random number too small "+K),K>=b&&q.$raise(h("RangeError"),"random number too big "+K)):K=pe.$rand(b),ge=pe[--b],pe[b]=pe[K],pe[K]=ge;return pe},-1),E(x,"$slice!",function(ce,pe){var ye=this,b=c,K=c,ge=c,be=c,Pe=c;if(Q(ye),b=c,fe(void 0===pe))if(le(h("Range"),ce)){b=ye["$[]"](K=ce),ge=K.begin===c?0:z(K.begin,h("Integer"),"to_int"),be=K.end===c?-1:z(K.end,h("Integer"),"to_int"),ge<0&&(ge+=ye.length),be<0?be+=ye.length:be>=ye.length&&(be=ye.length-1,K.excl&&(be+=1));var Ue=be-ge;K.excl&&K.end!==c?be-=1:Ue+=1,ge<ye.length&&ge>=0&&be<ye.length&&be>=0&&Ue>0&&ye.splice(ge,Ue)}else{if((Pe=z(ce,h("Integer"),"to_int"))<0&&(Pe+=ye.length),Pe<0||Pe>=ye.length)return c;b=ye[Pe],0===Pe?ye.shift():ye.splice(Pe,1)}else{if(Pe=z(ce,h("Integer"),"to_int"),(pe=z(pe,h("Integer"),"to_int"))<0)return c;b=ye["$[]"](Pe,pe),Pe<0&&(Pe+=ye.length),Pe+pe>ye.length&&(pe=ye.length-Pe),Pe<ye.length&&Pe>=0&&ye.splice(Pe,pe)}return b},-2),E(x,"$sort",function _e(){var ce=_e.$$p||c;return _e.$$p=null,fe(this.length>1)?(ce===c&&(ce=function(ye,b){return ye["$<=>"](b)}),this.slice().sort(function(ye,b){var K=ce(ye,b);return K===c&&q.$raise(h("ArgumentError"),"comparison of "+ye.$inspect()+" with "+b.$inspect()+" failed"),R(K,0)?1:F(K,0)?-1:0})):this}),E(x,"$sort!",function _e(){var ye,ce=_e.$$p||c,pe=this;_e.$$p=null,Q(pe),ye=ce!==c?k(pe.slice(),"sort",[],ce.$to_proc()):pe.slice().$sort(),pe.length=0;for(var b=0,K=ye.length;b<K;b++)pe.push(ye[b]);return pe}),E(x,"$sort_by!",function _e(){var ce=_e.$$p||c,pe=this;return _e.$$p=null,ce===c?k(pe,"enum_for",["sort_by!"],function ye(){return(null==ye.$$s?this:ye.$$s).$size()},{$$s:pe}):(Q(pe),pe.$replace(k(pe,"sort_by",[],ce.$to_proc())))}),E(x,"$take",function(ce){return ce<0&&q.$raise(h("ArgumentError")),this.slice(0,ce)}),E(x,"$take_while",function _e(){var ce=_e.$$p||c;_e.$$p=null;for(var ge,be,ye=[],b=0,K=this.length;b<K;b++){if(!1===(be=ce(ge=this[b]))||be===c)return ye;ye.push(ge)}return ye}),E(x,"$to_a",function(){return this.$$class===T.Array?this:T.Array.$new(this)}),E(x,"$to_ary",he),E(x,"$to_h",function _e(){var ce=_e.$$p||c,ye=c;_e.$$p=null,ye=this,ce!==c&&(ye=k(ye,"map",[],ce.$to_proc()));var b,ge,K=ye.length,Ue=Z([],{});for(b=0;b<K;b++)(ge=V["$coerce_to?"](ye[b],h("Array"),"to_ary")).$$is_array||q.$raise(h("TypeError"),"wrong element type "+ge.$class()+" at "+b+" (expected array)"),2!==ge.length&&q.$raise(h("ArgumentError"),"wrong array length at "+b+" (expected 2, was "+ge.$length()+")"),v(Ue,ge[0],ge[1]);return Ue}),E(x,"$transpose",function(){var pe=c,ye=c;return fe(this["$empty?"]())?[]:(pe=[],ye=c,k(this,"each",[],function(K){var ge=c;return null==K&&(K=c),K=le(h("Array"),K)?K.$to_a():z(K,h("Array"),"to_ary").$to_a(),ye=fe(ge=ye)?ge:K.length,B(K.length,ye)&&q.$raise(h("IndexError"),"element size differs ("+K.length+" should be "+ye+")"),k(K.length,"times",[],function(Pe){var Ue;return null==Pe&&(Pe=c),(fe(ge=pe["$[]"](Pe))?ge:(k(pe,"[]=",Ue=[Pe,[]]),Ue[Ue.length-1]))["$<<"](K.$at(Pe))})}),pe)}),E(x,"$union",function(ce){var pe,b=this;return pe=G(arguments),k(pe,"reduce",[b.$uniq()],function(ge,be){return null==ge&&(ge=c),null==be&&(be=c),ge["$|"](be)})},-1),E(x,"$uniq",function _e(){var ce=_e.$$p||c;_e.$$p=null;var b,K,ge,be,ye=Z([],{});if(ce===c)for(b=0,K=this.length;b<K;b++)void 0===te(ye,ge=this[b])&&v(ye,ge,ge);else for(b=0,K=this.length;b<K;b++)be=S(ce,ge=this[b]),void 0===te(ye,be)&&v(ye,be,ge);return ye.$values()}),E(x,"$uniq!",function _e(){var ce=_e.$$p||c,pe=this;_e.$$p=null,Q(pe);var K,ge,be,Pe,ye=pe.length,b=Z([],{});for(K=0,ge=ye;K<ge;K++)be=pe[K],Pe=ce===c?be:S(ce,be),void 0!==te(b,Pe)?(pe.splice(K,1),ge--,K--):v(b,Pe,be);return pe.length===ye?c:pe}),E(x,"$unshift",function(ce){var ye,b=this;ye=G(arguments),Q(b);var K=b.length,ge=ye.length;if(0==ge)return b;for(var be=K-ge,Pe=0;Pe<ge;Pe++)b.push(b[be+Pe]);for(var Ue=K-1;Ue-ge>=0;)b[Ue]=b[Ue-ge],Ue--;for(var Ye=0;Ye<ge;Ye++)b[Ye]=ye[Ye];return b},-1),E(x,"$values_at",function(ce){var pe,b=this,K=c;return pe=G(arguments),K=[],k(pe,"each",[],function ge(be){var Pe=null==ge.$$s?this:ge.$$s,Ue=c,Ye=c,nt=c;return null==be&&(be=c),fe(be["$is_a?"](h("Range")))?(Ue=be.$end()===c?-1:z(be.$end(),h("Integer"),"to_int"),(Ye=be.$begin()===c?0:z(be.$begin(),h("Integer"),"to_int"))<0?(Ye+=Pe.length,c):(Ue<0&&(Ue+=Pe.length),be["$exclude_end?"]()&&be.$end()!==c&&Ue--,Ue<Ye?c:k(Ye,"upto",[Ue],function vt(wt){return null==wt&&(wt=c),K["$<<"]((null==vt.$$s?this:vt.$$s).$at(wt))},{$$s:Pe}))):(nt=z(be,h("Integer"),"to_int"),K["$<<"](Pe.$at(nt)))},{$$s:b}),K},-1),E(x,"$zip",function _e(ce){var ye,b,pe=_e.$$p||c,K=this,ge=c;_e.$$p=null,ye=G(arguments);var Ue,Ye,nt,vt,wt,be=[],Pe=K.length;for(vt=0,wt=(b=ye).length;vt<wt;vt++)if(!(Ye=b[vt]).$$is_array){if(Ye.$$is_range||Ye.$$is_enumerator){b[vt]=Ye.$take(Pe);continue}b[vt]=(fe(ge=V["$coerce_to?"](Ye,h("Array"),"to_ary"))?ge:V["$coerce_to!"](Ye,h("Enumerator"),"to_enum","each")).$to_a()}for(nt=0;nt<Pe;nt++){for(Ue=[K[nt]],vt=0,wt=b.length;vt<wt;vt++)null==(Ye=b[vt][nt])&&(Ye=c),Ue[vt+1]=Ye;be[nt]=Ue}if(pe!==c){for(nt=0;nt<Pe;nt++)T.yield1(pe,be[nt]);return c}return be},-1),re(x,"$inherited",function(ce){ce.$$prototype.$to_a=function(){return this.slice(0,this.length)}}),E(x,"$instance_variables",function _e(){var ce=_e.$$p||c;return _e.$$p=null,k(Y(this,X(this,"instance_variables",_e,!1,!0),"instance_variables",[],ce),"reject",[],function(b){var K;return null==b&&(b=c),fe(K=/^@\d+$/.test(b))?K:b["$=="]("@length")})}),E(x,"$pack",function(ce){return G(arguments),q.$raise("To use Array#pack, you must first require 'corelib/array/pack'.")},-1),O(x,"append","push"),O(x,"filter","select"),O(x,"filter!","select!"),O(x,"map","collect"),O(x,"map!","collect!"),O(x,"prepend","unshift"),O(x,"size","length"),O(x,"slice","[]"),O(x,"to_s","inspect"),V.$pristine(x.$singleton_class(),"allocate"),V.$pristine(x,"copy_instance_variables","initialize_dup")}()},Opal.modules["corelib/hash"]=function(T){var P,he,L,ne,F,fe=T.yield1,Ce=T.hash,f=T.hash_init,S=T.hash_get,te=T.hash_put,v=T.hash_delete,D=T.deny_frozen_access,z=T.freeze,I=T.klass,Q=T.slice,U=T.Opal,N=T.Kernel,G=T.defs,re=T.def,q=T.send,E=T.rb_ge,V=T.rb_gt,le=T.hash2,Z=T.truthy,Y=T.to_a,X=T.return_self,k=T.alias,H=T.nil,A=T.$$$;return T.top.$require("corelib/enumerable"),P=[],ne=[L=I("::",null,"Hash")].concat(P),F=T.$r(ne),L.$include(A("Enumerable")),L.$$prototype.$$is_hash=!0,G(L,"$[]",function(O){var l,h,p,c=this,d=(l=Q(arguments)).length;if(1===d){if((h=U["$coerce_to?"](l["$[]"](0),A("Hash"),"to_hash"))!==H)return c.$allocate()["$merge!"](h);for((l=U["$coerce_to?"](l["$[]"](0),A("Array"),"to_ary"))===H&&N.$raise(A("ArgumentError"),"odd number of arguments for Hash"),d=l.length,h=c.$allocate(),p=0;p<d;p++)if(l[p].$$is_array)switch(l[p].length){case 1:h.$store(l[p][0],H);break;case 2:h.$store(l[p][0],l[p][1]);break;default:N.$raise(A("ArgumentError"),"invalid number of elements ("+l[p].length+" for 1..2)")}return h}for(d%2!=0&&N.$raise(A("ArgumentError"),"odd number of arguments for Hash"),h=c.$allocate(),p=0;p<d;p+=2)h.$store(l[p],l[p+1]);return h},-1),G(L,"$allocate",function(){var m=new this.$$constructor;return f(m),m.$$none=H,m.$$proc=H,m}),G(L,"$try_convert",function(O){return U["$coerce_to?"](O,A("Hash"),"to_hash")}),re(L,"$initialize",function B(O){var m=B.$$p||H,l=this;return B.$$p=null,D(l),void 0!==O&&m!==H&&N.$raise(A("ArgumentError"),"wrong number of arguments (1 for 0)"),l.$$none=void 0===O?H:O,l.$$proc=m,l},-1),re(L,"$==",function(O){var m=this;if(m===O)return!0;if(!O.$$is_hash||m.$$keys.length!==O.$$keys.length)return!1;for(var d,p,_,l=0,c=m.$$keys,h=c.length;l<h;l++)if((d=c[l]).$$is_string?(p=m.$$smap[d],_=O.$$smap[d]):(p=d.value,_=S(O,d.key)),void 0===_||!p["$eql?"](_))return!1;return!0}),re(L,"$>=",function(O){var l=H;return O=U["$coerce_to!"](O,A("Hash"),"to_hash"),!(this.$$keys.length<O.$$keys.length)&&(l=!0,q(O,"each",[],function c(h,d){var _;null==h&&(h=H),null==d&&(d=H),null!=(_=(null==c.$$s?this:c.$$s).$fetch(h,null))&&_===d||(l=!1)},{$$s:this}),l)}),re(L,"$>",function(O){return O=U["$coerce_to!"](O,A("Hash"),"to_hash"),!(this.$$keys.length<=O.$$keys.length)&&E(this,O)}),re(L,"$<",function(O){return O=U["$coerce_to!"](O,A("Hash"),"to_hash"),V(O,this)}),re(L,"$<=",function(O){return O=U["$coerce_to!"](O,A("Hash"),"to_hash"),E(O,this)}),re(L,"$[]",function(O){var l=S(this,O);return void 0!==l?l:this.$default(O)}),re(L,"$[]=",function(O,m){return D(this),te(this,O,m),m}),re(L,"$assoc",function(O){for(var d,l=0,c=this.$$keys,h=c.length;l<h;l++)if((d=c[l]).$$is_string){if(d["$=="](O))return[d,this.$$smap[d]]}else if(d.key["$=="](O))return[d.key,d.value];return H}),re(L,"$clear",function(){var O=this;return D(O),f(O),O}),re(L,"$clone",function(){var m=new this.$$class;return f(m),T.hash_clone(this,m),m}),re(L,"$compact",function(){for(var d,p,m=Ce(),l=0,c=this.$$keys,h=c.length;l<h;l++)(d=c[l]).$$is_string?p=this.$$smap[d]:(p=d.value,d=d.key),p!==H&&te(m,d,p);return m}),re(L,"$compact!",function(){var O=this;D(O);for(var d,p,m=!1,l=0,c=O.$$keys,h=c.length;l<h;l++)(d=c[l]).$$is_string?p=O.$$smap[d]:(p=d.value,d=d.key),p===H&&void 0!==v(O,d)&&(m=!0,h--,l--);return m?O:H}),re(L,"$compare_by_identity",function(){var O=this;D(O);var m,l,c,d,h=O.$$keys;if(O.$$by_identity)return O;if(0===O.$$keys.length)return O.$$by_identity=!0,O;for(d=le([],{}).$compare_by_identity(),m=0,l=h.length;m<l;m++)(c=h[m]).$$is_string||(c=c.key),te(d,c,S(O,c));return O.$$by_identity=!0,O.$$map=d.$$map,O.$$smap=d.$$smap,O}),re(L,"$compare_by_identity?",function(){return!0===this.$$by_identity}),re(L,"$default",function(O){var m=this;return void 0!==O&&m.$$proc!==H&&void 0!==m.$$proc?m.$$proc.$call(m,O):void 0===m.$$none?H:m.$$none},-1),re(L,"$default=",function(O){var m=this;return D(m),m.$$proc=H,m.$$none=O,O}),re(L,"$default_proc",function(){return void 0!==this.$$proc?this.$$proc:H}),re(L,"$default_proc=",function(O){var m=this;D(m);var l=O;return l!==H&&(l=U["$coerce_to!"](l,A("Proc"),"to_proc"))["$lambda?"]()&&2!==l.$arity().$abs()&&N.$raise(A("TypeError"),"default_proc takes two arguments"),m.$$none=H,m.$$proc=l,O}),re(L,"$delete",function B(O){var m=B.$$p||H;B.$$p=null,D(this);var c=v(this,O);return void 0!==c?c:m!==H?T.yield1(m,O):H}),re(L,"$delete_if",function B(){var O=B.$$p||H,m=this;if(B.$$p=null,!Z(O))return q(m,"enum_for",["delete_if"],function x(){return(null==x.$$s?this:x.$$s).$size()},{$$s:m});D(m);for(var d,p,_,l=0,c=m.$$keys,h=c.length;l<h;l++)(d=c[l]).$$is_string?p=m.$$smap[d]:(p=d.value,d=d.key),!1!==(_=O(d,p))&&_!==H&&void 0!==v(m,d)&&(h--,l--);return m}),re(L,"$dig",function(O,m){var c,h=this,d=H;return c=Q(arguments,1),(d=h["$[]"](O))===H||0===c.length?d:(Z(d["$respond_to?"]("dig"))||N.$raise(A("TypeError"),d.$class()+" does not have #dig method"),q(d,"dig",Y(c)))},-2),re(L,"$each",function B(){var O=B.$$p||H,m=this;if(B.$$p=null,!Z(O))return q(m,"enum_for",["each"],function _(){return(null==_.$$s?this:_.$$s).$size()},{$$s:m});for(var d,p,l=0,c=m.$$keys.slice(),h=c.length;l<h;l++)(d=c[l]).$$is_string?p=m.$$smap[d]:(p=d.value,d=d.key),fe(O,[d,p]);return m}),re(L,"$each_key",function B(){var O=B.$$p||H,m=this;if(B.$$p=null,!Z(O))return q(m,"enum_for",["each_key"],function p(){return(null==p.$$s?this:p.$$s).$size()},{$$s:m});for(var d,l=0,c=m.$$keys.slice(),h=c.length;l<h;l++)O((d=c[l]).$$is_string?d:d.key);return m}),re(L,"$each_value",function B(){var O=B.$$p||H,m=this;if(B.$$p=null,!Z(O))return q(m,"enum_for",["each_value"],function p(){return(null==p.$$s?this:p.$$s).$size()},{$$s:m});for(var d,l=0,c=m.$$keys.slice(),h=c.length;l<h;l++)O((d=c[l]).$$is_string?m.$$smap[d]:d.value);return m}),re(L,"$empty?",function(){return 0===this.$$keys.length}),re(L,"$except",function(O){var l,c=this;return l=Q(arguments),q(c.$dup(),"except!",Y(l))},-1),re(L,"$except!",function(O){var m,c=this;return m=Q(arguments),q(m,"each",[],function h(d){return null==d&&(d=H),(null==h.$$s?this:h.$$s).$delete(d)},{$$s:c}),c},-1),re(L,"$fetch",function B(O,m){var l=B.$$p||H;B.$$p=null;var h=S(this,O);return void 0!==h?h:l!==H?l(O):void 0!==m?m:N.$raise(A("KeyError").$new("key not found: "+O.$inspect(),le(["key","receiver"],{key:O,receiver:this})))},-2),re(L,"$fetch_values",function B(O){var l,m=B.$$p||H,h=this;return B.$$p=null,l=Q(arguments),q(l,"map",[],function d(p){return null==p&&(p=H),q(null==d.$$s?this:d.$$s,"fetch",[p],m.$to_proc())},{$$s:h})},-1),re(L,"$flatten",function(O){null==O&&(O=1),O=U["$coerce_to!"](O,A("Integer"),"to_int");for(var p,_,l=[],c=0,h=this.$$keys,d=h.length;c<d;c++)if((p=h[c]).$$is_string?_=this.$$smap[p]:(_=p.value,p=p.key),l.push(p),_.$$is_array){if(1===O){l.push(_);continue}l=l.concat(_.$flatten(O-2))}else l.push(_);return l},-1),re(L,"$freeze",function(){var O=this;return Z(O["$frozen?"]())?O:z(O)}),re(L,"$has_key?",function(O){return void 0!==S(this,O)}),re(L,"$has_value?",function(O){for(var d,l=0,c=this.$$keys,h=c.length;l<h;l++)if(((d=c[l]).$$is_string?this.$$smap[d]:d.value)["$=="](O))return!0;return!1}),re(L,"$hash",function(){var h,O=this,m=void 0===T.hash_ids,l=O.$object_id(),c=["Hash"];try{if(m&&(T.hash_ids=Object.create(null)),T[l])return"self";for(h in T.hash_ids)if(O["$eql?"](T.hash_ids[h]))return"self";T.hash_ids[l]=O;for(var p=0,_=O.$$keys,x=_.length;p<x;p++)c.push((h=_[p]).$$is_string?[h,O.$$smap[h].$hash()]:[h.key_hash,h.value.$hash()]);return c.sort().join()}finally{m&&(T.hash_ids=void 0)}}),re(L,"$index",function(O){for(var d,p,l=0,c=this.$$keys,h=c.length;l<h;l++)if((d=c[l]).$$is_string?p=this.$$smap[d]:(p=d.value,d=d.key),p["$=="](O))return d;return H}),re(L,"$indexes",function(O){for(var l,x,c=this,h=[],d=0,p=(l=Q(arguments)).length;d<p;d++)void 0!==(x=S(c,l[d]))?h.push(x):h.push(c.$default());return h},-1),re(L,"$inspect",function(){var O=this,m=void 0===he,l=O.$object_id(),c=[];return function(){try{if(m&&(he={}),he.hasOwnProperty(l))return"{...}";he[l]=!0;for(var _,x,h=0,d=O.$$keys,p=d.length;h<p;h++)(_=d[h]).$$is_string?x=O.$$smap[_]:(x=_.value,_=_.key),_=F("Opal").$inspect(_),x=F("Opal").$inspect(x),c.push(_+"=>"+x);return"{"+c.join(", ")+"}"}finally{m&&(he=void 0)}}()}),re(L,"$invert",function(){for(var d,p,m=Ce(),l=0,c=this.$$keys,h=c.length;l<h;l++)(d=c[l]).$$is_string?p=this.$$smap[d]:(p=d.value,d=d.key),te(m,p,d);return m}),re(L,"$keep_if",function B(){var O=B.$$p||H,m=this;if(B.$$p=null,!Z(O))return q(m,"enum_for",["keep_if"],function x(){return(null==x.$$s?this:x.$$s).$size()},{$$s:m});D(m);for(var d,p,_,l=0,c=m.$$keys,h=c.length;l<h;l++)(d=c[l]).$$is_string?p=m.$$smap[d]:(p=d.value,d=d.key),(!1===(_=O(d,p))||_===H)&&void 0!==v(m,d)&&(h--,l--);return m}),re(L,"$keys",function(){for(var d,m=[],l=0,c=this.$$keys,h=c.length;l<h;l++)m.push((d=c[l]).$$is_string?d:d.key);return m}),re(L,"$length",function(){return this.$$keys.length}),re(L,"$merge",function B(O){var c,m=B.$$p||H,h=this;return B.$$p=null,c=Q(arguments),q(h.$dup(),"merge!",Y(c),m.$to_proc())},-1),re(L,"$merge!",function B(O){var c,d,p,_,x,$,se,ae,Te,m=B.$$p||H,h=this;for(B.$$p=null,c=Q(arguments),D(h),d=0;d<c.length;++d)if($=(x=(_=U["$coerce_to!"](c[d],A("Hash"),"to_hash")).$$keys).length,m===H)for(p=0;p<$;p++)(se=x[p]).$$is_string?Te=_.$$smap[se]:(Te=se.value,se=se.key),te(h,se,Te);else for(p=0;p<$;p++)(se=x[p]).$$is_string?Te=_.$$smap[se]:(Te=se.value,se=se.key),void 0!==(ae=S(h,se))?te(h,se,m(se,ae,Te)):te(h,se,Te);return h},-1),re(L,"$rassoc",function(O){for(var d,p,l=0,c=this.$$keys,h=c.length;l<h;l++)if((d=c[l]).$$is_string?p=this.$$smap[d]:(p=d.value,d=d.key),p["$=="](O))return[d,p];return H}),re(L,"$rehash",function(){var O=this;return D(O),T.hash_rehash(O),O}),re(L,"$reject",function B(){var O=B.$$p||H,m=this;if(B.$$p=null,!Z(O))return q(m,"enum_for",["reject"],function $(){return(null==$.$$s?this:$.$$s).$size()},{$$s:m});for(var p,_,x,l=Ce(),c=0,h=m.$$keys,d=h.length;c<d;c++)(p=h[c]).$$is_string?_=m.$$smap[p]:(_=p.value,p=p.key),(!1===(x=O(p,_))||x===H)&&te(l,p,_);return l}),re(L,"$reject!",function B(){var O=B.$$p||H,m=this;if(B.$$p=null,!Z(O))return q(m,"enum_for",["reject!"],function $(){return(null==$.$$s?this:$.$$s).$size()},{$$s:m});D(m);for(var p,_,x,l=!1,c=0,h=m.$$keys,d=h.length;c<d;c++)(p=h[c]).$$is_string?_=m.$$smap[p]:(_=p.value,p=p.key),!1!==(x=O(p,_))&&x!==H&&void 0!==v(m,p)&&(l=!0,d--,c--);return l?m:H}),re(L,"$replace",function(O){var m=this;D(m),O=U["$coerce_to!"](O,A("Hash"),"to_hash"),f(m);for(var d,_,l=0,c=O.$$keys,h=c.length;l<h;l++)(d=c[l]).$$is_string?_=O.$$smap[d]:(_=d.value,d=d.key),te(m,d,_);return Z(O.$default_proc())?m["$default_proc="](O.$default_proc()):m["$default="](O.$default()),m}),re(L,"$select",function B(){var O=B.$$p||H,m=this;if(B.$$p=null,!Z(O))return q(m,"enum_for",["select"],function $(){return(null==$.$$s?this:$.$$s).$size()},{$$s:m});for(var p,_,x,l=Ce(),c=0,h=m.$$keys,d=h.length;c<d;c++)(p=h[c]).$$is_string?_=m.$$smap[p]:(_=p.value,p=p.key),!1!==(x=O(p,_))&&x!==H&&te(l,p,_);return l}),re(L,"$select!",function B(){var O=B.$$p||H,m=this;if(B.$$p=null,!Z(O))return q(m,"enum_for",["select!"],function $(){return(null==$.$$s?this:$.$$s).$size()},{$$s:m});D(m);for(var p,_,x,l=H,c=0,h=m.$$keys,d=h.length;c<d;c++)(p=h[c]).$$is_string?_=m.$$smap[p]:(_=p.value,p=p.key),(!1===(x=O(p,_))||x===H)&&(void 0!==v(m,p)&&(d--,c--),l=m);return l}),re(L,"$shift",function(){var O=this;D(O);var l,m=O.$$keys;return m.length>0?[l=(l=m[0]).$$is_string?l:l.key,v(O,l)]:H}),re(L,"$slice",function(O){var l,c=this;l=Q(arguments);for(var h=Ce(),d=0,p=l.length;d<p;d++){var _=l[d],x=S(c,_);void 0!==x&&te(h,_,x)}return h},-1),re(L,"$to_a",function(){for(var d,p,m=[],l=0,c=this.$$keys,h=c.length;l<h;l++)(d=c[l]).$$is_string?p=this.$$smap[d]:(p=d.value,d=d.key),m.push([d,p]);return m}),re(L,"$to_h",function B(){var O=B.$$p||H,m=this;if(B.$$p=null,O!==H)return q(m,"map",[],O.$to_proc()).$to_h();if(m.$$class===T.Hash)return m;var l=new T.Hash;return f(l),T.hash_clone(m,l),l}),re(L,"$to_hash",X),re(L,"$to_proc",function(){return q(this,"proc",[],function m(l){var c=null==m.$$s?this:m.$$s;return null==l&&N.$raise(A("ArgumentError"),"no key given"),c["$[]"](l)},{$$arity:-1,$$s:this})}),re(L,"$transform_keys",function B(){var O=B.$$p||H,m=this;if(B.$$p=null,!Z(O))return q(m,"enum_for",["transform_keys"],function x(){return(null==x.$$s?this:x.$$s).$size()},{$$s:m});for(var p,_,l=Ce(),c=0,h=m.$$keys,d=h.length;c<d;c++)(p=h[c]).$$is_string?_=m.$$smap[p]:(_=p.value,p=p.key),p=fe(O,p),te(l,p,_);return l}),re(L,"$transform_keys!",function B(){var O=B.$$p||H,m=this;if(B.$$p=null,!Z(O))return q(m,"enum_for",["transform_keys!"],function x(){return(null==x.$$s?this:x.$$s).$size()},{$$s:m});D(m);var c,d,p,_,l=T.slice(m.$$keys),h=l.length;for(c=0;c<h;c++)(d=l[c]).$$is_string?p=m.$$smap[d]:(p=d.value,d=d.key),_=fe(O,d),v(m,d),te(m,_,p);return m}),re(L,"$transform_values",function B(){var O=B.$$p||H,m=this;if(B.$$p=null,!Z(O))return q(m,"enum_for",["transform_values"],function x(){return(null==x.$$s?this:x.$$s).$size()},{$$s:m});for(var p,_,l=Ce(),c=0,h=m.$$keys,d=h.length;c<d;c++)(p=h[c]).$$is_string?_=m.$$smap[p]:(_=p.value,p=p.key),_=fe(O,_),te(l,p,_);return l}),re(L,"$transform_values!",function B(){var O=B.$$p||H,m=this;if(B.$$p=null,!Z(O))return q(m,"enum_for",["transform_values!"],function _(){return(null==_.$$s?this:_.$$s).$size()},{$$s:m});D(m);for(var d,p,l=0,c=m.$$keys,h=c.length;l<h;l++)(d=c[l]).$$is_string?p=m.$$smap[d]:(p=d.value,d=d.key),p=fe(O,p),te(m,d,p);return m}),re(L,"$values",function(){for(var d,m=[],l=0,c=this.$$keys,h=c.length;l<h;l++)m.push((d=c[l]).$$is_string?this.$$smap[d]:d.value);return m}),k(L,"dup","clone"),k(L,"each_pair","each"),k(L,"eql?","=="),k(L,"filter","select"),k(L,"filter!","select!"),k(L,"include?","has_key?"),k(L,"indices","indexes"),k(L,"key","index"),k(L,"key?","has_key?"),k(L,"member?","has_key?"),k(L,"size","length"),k(L,"store","[]="),k(L,"to_s","inspect"),k(L,"update","merge!"),k(L,"value?","has_value?"),k(L,"values_at","indexes")},Opal.modules["corelib/number"]=function(T){var L,ne,B,m,l,F,he,fe=T.klass,Ce=T.Opal,f=T.Kernel,S=T.def,te=T.eqeqeq,v=T.truthy,D=T.rb_gt,z=T.not,I=T.rb_lt,Q=T.alias,U=T.send2,N=T.find_super,G=T.send,re=T.rb_plus,q=T.rb_minus,E=T.eqeq,V=T.return_self,le=T.rb_divide,Z=T.to_ary,Y=T.rb_times,X=T.rb_le,k=T.rb_ge,R=T.return_val,ee=T.const_set,A=[],M=T.nil,C=T.$$$;return T.top.$require("corelib/numeric"),function(P,L,ne){var h,F=fe("::",L,"Number");function O(h){var d=new Uint8Array(8);return new DataView(d.buffer).setFloat64(0,h,!0),d}function m(h){return new DataView(h.buffer).getFloat64(0,!0)}function l(h){for(var d=O(h),p=0;p<d.length;p++){if(255!==d[p]){d[p]++;break}d[p]=0}return m(d)}function c(h){for(var d=O(h),p=0;p<d.length;p++){if(0!==d[p]){d[p]--;break}d[p]=255}return m(d)}[F].concat(ne),Ce.$bridge(Number,F),T.prop(F.$$prototype,"$$is_number",!0),F.$$is_number_class=!0,h=T.get_singleton_class(F),S(h,"$allocate",function(){return f.$raise(C("TypeError"),"allocator undefined for "+this.$name())}),T.udef(h,"$new"),S(F,"$coerce",function(d){var p=this;if(d===M)f.$raise(C("TypeError"),"can't convert "+d.$class()+" into Float");else{if(d.$$is_string)return[f.$Float(d),p];if(d["$respond_to?"]("to_f"))return[Ce["$coerce_to!"](d,C("Float"),"to_f"),p];if(d.$$is_number)return[d,p];f.$raise(C("TypeError"),"can't convert "+d.$class()+" into Float")}}),S(F,"$__id__",function(){return 2*this+1}),S(F,"$+",function(d){return d.$$is_number?this+d:this.$__coerced__("+",d)}),S(F,"$-",function(d){return d.$$is_number?this-d:this.$__coerced__("-",d)}),S(F,"$*",function(d){return d.$$is_number?this*d:this.$__coerced__("*",d)}),S(F,"$/",function(d){return d.$$is_number?this/d:this.$__coerced__("/",d)}),S(F,"$%",function(d){var p=this;return d.$$is_number?d==-1/0?d:0!=d?d<0||p<0?(p%d+d)%d:p%d:void f.$raise(C("ZeroDivisionError"),"divided by 0"):p.$__coerced__("%",d)}),S(F,"$&",function(d){return d.$$is_number?this&d:this.$__coerced__("&",d)}),S(F,"$|",function(d){return d.$$is_number?this|d:this.$__coerced__("|",d)}),S(F,"$^",function(d){return d.$$is_number?this^d:this.$__coerced__("^",d)}),S(F,"$<",function(d){return d.$$is_number?this<d:this.$__coerced__("<",d)}),S(F,"$<=",function(d){return d.$$is_number?this<=d:this.$__coerced__("<=",d)}),S(F,"$>",function(d){return d.$$is_number?this>d:this.$__coerced__(">",d)}),S(F,"$>=",function(d){return d.$$is_number?this>=d:this.$__coerced__(">=",d)}),S(F,"$<=>",function(d){try{return function(h,d){return d.$$is_number?isNaN(h)||isNaN(d)?M:h>d?1:h<d?-1:0:h.$__coerced__("<=>",d)}(this,d)}catch(_){if(!T.rescue(_,[C("ArgumentError")]))throw _;try{return M}finally{T.pop_exception()}}}),S(F,"$<<",function(d){return(d=Ce["$coerce_to!"](d,C("Integer"),"to_int"))>0?this<<d:this>>-d}),S(F,"$>>",function(d){return(d=Ce["$coerce_to!"](d,C("Integer"),"to_int"))>0?this>>d:this<<-d}),S(F,"$[]",function(d){return(d=Ce["$coerce_to!"](d,C("Integer"),"to_int"))<0?0:d>=32?this<0?1:0:this>>d&1}),S(F,"$+@",function(){return+this}),S(F,"$-@",function(){return-this}),S(F,"$~",function(){return~this}),S(F,"$**",function(d){var p=this;return te(C("Integer"),d)?z(C("Integer")["$==="](p))||v(D(d,0))?Math.pow(p,d):C("Rational").$new(p,1)["$**"](d):I(p,0)&&(te(C("Float"),d)||te(C("Rational"),d))?C("Complex").$new(p,0)["$**"](d.$to_f()):v(null!=d.$$is_number)?Math.pow(p,d):p.$__coerced__("**",d)}),S(F,"$==",function(d){return d.$$is_number?this.valueOf()===d.valueOf():!!d["$respond_to?"]("==")&&d["$=="](this)}),Q(F,"===","=="),S(F,"$abs",function(){return Math.abs(this)}),S(F,"$abs2",function(){return Math.abs(this*this)}),S(F,"$allbits?",function(d){return(this&(d=Ce["$coerce_to!"](d,C("Integer"),"to_int")))==d}),S(F,"$anybits?",function(d){return 0!=(this&Ce["$coerce_to!"](d,C("Integer"),"to_int"))}),S(F,"$angle",function(){var d=this;return v(d["$nan?"]())?d:0==d?1/d>0?0:Math.PI:d<0?Math.PI:0}),S(F,"$bit_length",function(){var d=this;if(te(C("Integer"),d)||f.$raise(C("NoMethodError").$new("undefined method `bit_length` for "+d+":Float","bit_length")),0===d||-1===d)return 0;for(var p=0,_=d<0?~d:d;0!=_;)p+=1,_>>>=1;return p}),S(F,"$ceil",function(d){null==d&&(d=0);var _=this.$to_f();if(_%1==0&&d>=0)return _;var x=Math.pow(10,d),$=Math.ceil(_*x)/x;return _%1==0&&($=Math.round($)),$},-1),S(F,"$chr",function(d){return T.enc(String.fromCharCode(this),d||"BINARY")},-1),S(F,"$denominator",function h(){var d=h.$$p||M,p=this;return h.$$p=null,v(p["$nan?"]())||v(p["$infinite?"]())?1:U(p,N(p,"denominator",h,!1,!0),"denominator",[],d)}),S(F,"$downto",function h(d){var p=h.$$p||M,_=this;if(h.$$p=null,p===M)return G(_,"enum_for",["downto",d],function $(){var se=null==$.$$s?this:$.$$s;return te(C("Numeric"),d)||f.$raise(C("ArgumentError"),"comparison of "+se.$class()+" with "+d.$class()+" failed"),v(D(d,se))?0:re(q(se,d),1)},{$$s:_});d.$$is_number||f.$raise(C("ArgumentError"),"comparison of "+_.$class()+" with "+d.$class()+" failed");for(var x=_;x>=d;x--)p(x);return _}),S(F,"$equal?",function(d){var _;return v(_=this["$=="](d))?_:isNaN(this)&&isNaN(d)}),S(F,"$even?",function(){return this%2==0}),S(F,"$floor",function(d){null==d&&(d=0);var _=this.$to_f();if(_%1==0&&d>=0)return _;var x=Math.pow(10,d),$=Math.floor(_*x)/x;return _%1==0&&($=Math.round($)),$},-1),S(F,"$gcd",function(d){te(C("Integer"),d)||f.$raise(C("TypeError"),"not an integer");for(var _=Math.abs(this),x=Math.abs(d);_>0;){var $=_;_=x%_,x=$}return x}),S(F,"$gcdlcm",function(d){return[this.$gcd(d),this.$lcm(d)]}),S(F,"$integer?",function(){return this%1==0}),S(F,"$is_a?",function h(d){var p=h.$$p||M,_=this;return h.$$p=null,!!(E(d,C("Integer"))&&te(C("Integer"),_)||E(d,C("Integer"))&&te(C("Integer"),_)||E(d,C("Float"))&&te(C("Float"),_))||U(_,N(_,"is_a?",h,!1,!0),"is_a?",[d],p)}),S(F,"$instance_of?",function h(d){var p=h.$$p||M,_=this;return h.$$p=null,!!(E(d,C("Integer"))&&te(C("Integer"),_)||E(d,C("Integer"))&&te(C("Integer"),_)||E(d,C("Float"))&&te(C("Float"),_))||U(_,N(_,"instance_of?",h,!1,!0),"instance_of?",[d],p)}),S(F,"$lcm",function(d){var p=this;return te(C("Integer"),d)||f.$raise(C("TypeError"),"not an integer"),0==p||0==d?0:Math.abs(p*d/p.$gcd(d))}),S(F,"$next",function(){return this+1}),S(F,"$nobits?",function(d){return 0==(this&Ce["$coerce_to!"](d,C("Integer"),"to_int"))}),S(F,"$nonzero?",function(){return 0==this?M:this}),S(F,"$numerator",function h(){var d=h.$$p||M,p=this;return h.$$p=null,v(p["$nan?"]())||v(p["$infinite?"]())?p:U(p,N(p,"numerator",h,!1,!0),"numerator",[],d)}),S(F,"$odd?",function(){return this%2!=0}),S(F,"$ord",V),S(F,"$pow",function(d,p){var _=this;return 0==_&&f.$raise(C("ZeroDivisionError"),"divided by 0"),void 0===p?_["$**"](d):(C("Integer")["$==="](d)||f.$raise(C("TypeError"),"Integer#pow() 2nd argument not allowed unless a 1st argument is integer"),d<0&&f.$raise(C("TypeError"),"Integer#pow() 1st argument cannot be negative when 2nd argument specified"),C("Integer")["$==="](p)||f.$raise(C("TypeError"),"Integer#pow() 2nd argument not allowed unless all arguments are integers"),0===p&&f.$raise(C("ZeroDivisionError"),"divided by 0"),_["$**"](d)["$%"](p))},-2),S(F,"$pred",function(){return this-1}),S(F,"$quo",function h(d){var p=h.$$p||M,_=this;return h.$$p=null,te(C("Integer"),_)?U(_,N(_,"quo",h,!1,!0),"quo",[d],p):le(_,d)}),S(F,"$rationalize",function(d){var p,_,x=this,$=M,se=M;return arguments.length>1&&f.$raise(C("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),te(C("Integer"),x)?C("Rational").$new(x,1):v(x["$infinite?"]())?f.$raise(C("FloatDomainError"),"Infinity"):v(x["$nan?"]())?f.$raise(C("FloatDomainError"),"NaN"):v(null==d)?(_=C("Math").$frexp(x),$=null==(p=Z(_))[0]?M:p[0],se=null==p[1]?M:p[1],$=C("Math").$ldexp($,C(C("Float"),"MANT_DIG")).$to_i(),se=q(se,C(C("Float"),"MANT_DIG")),C("Rational").$new(Y(2,$),1["$<<"](q(1,se))).$rationalize(C("Rational").$new(1,1["$<<"](q(1,se))))):x.$to_r().$rationalize(d)},-1),S(F,"$remainder",function(d){return q(this,Y(d,le(this,d).$truncate()))}),S(F,"$round",function(d){var p,_,se,x=this;if(te(C("Integer"),x)){if(v(null==d)||(te(C("Float"),d)&&v(d["$infinite?"]())&&f.$raise(C("RangeError"),"Infinity"),d=Ce["$coerce_to!"](d,C("Integer"),"to_int"),v(I(d,C(C("Integer"),"MIN")))&&f.$raise(C("RangeError"),"out of bounds"),v(d>=0)))return x;if(.415241*(d=d["$-@"]())-.125>x.$size())return 0;var ae=Math.pow(10,d),Te=Math.floor((Math.abs(x)+ae/2)/ae)*ae;return x<0?-Te:Te}if(v(x["$nan?"]())&&v(null==d)&&f.$raise(C("FloatDomainError"),"NaN"),d=Ce["$coerce_to!"](d||0,C("Integer"),"to_int"),v(X(d,0)))v(x["$nan?"]())?f.$raise(C("RangeError"),"NaN"):v(x["$infinite?"]())&&f.$raise(C("FloatDomainError"),"Infinity");else{if(E(d,0))return Math.round(x);if(v(x["$nan?"]())||v(x["$infinite?"]()))return x}return _=C("Math").$frexp(x),se=null==(p=Z(_))[1]?M:p[1],v(k(d,q(re(C(C("Float"),"DIG"),2),v(D(se,0))?le(se,4):q(le(se,3),1))))?x:v(I(d,(v(D(se,0))?re(le(se,3),1):le(se,4))["$-@"]()))?0:Math.round(x*Math.pow(10,d))/Math.pow(10,d)},-1),S(F,"$times",function h(){var d=h.$$p||M,p=this;if(h.$$p=null,!v(d))return G(p,"enum_for",["times"],function x(){return null==x.$$s?this:x.$$s},{$$s:p});for(var _=0;_<p;_++)d(_);return p}),S(F,"$to_f",V),S(F,"$to_i",function(){var d=this;return d<0?Math.ceil(d):Math.floor(d)}),S(F,"$to_r",function(){var d,p,_=this,x=M,$=M;return te(C("Integer"),_)?C("Rational").$new(_,1):(p=C("Math").$frexp(_),x=null==(d=Z(p))[0]?M:d[0],$=null==d[1]?M:d[1],x=C("Math").$ldexp(x,C(C("Float"),"MANT_DIG")).$to_i(),$=q($,C(C("Float"),"MANT_DIG")),Y(x,C(C("Float"),"RADIX")["$**"]($)).$to_r())}),S(F,"$to_s",function(d){var p=this;return null==d&&(d=10),d=Ce["$coerce_to!"](d,C("Integer"),"to_int"),(v(I(d,2))||v(D(d,36)))&&f.$raise(C("ArgumentError"),"invalid radix "+d),E(p,0)&&v(1/p==-1/0)?"-0.0":p.toString(d)},-1),S(F,"$truncate",function(d){null==d&&(d=0);var _=this.$to_f();if(_%1==0&&d>=0)return _;var x=Math.pow(10,d),$=parseInt(_*x,10)/x;return _%1==0&&($=Math.round($)),$},-1),S(F,"$digits",function(d){var p=this;null==d&&(d=10),I(p,0)&&f.$raise(C(C("Math"),"DomainError"),"out of domain"),d=Ce["$coerce_to!"](d,C("Integer"),"to_int"),v(I(d,2))&&f.$raise(C("ArgumentError"),"invalid radix "+d),p!=parseInt(p)&&f.$raise(C("NoMethodError"),"undefined method `digits' for "+p.$inspect());var _=p,x=[];if(0==p)return[0];for(;0!=_;)x.push(_%d),_=parseInt(_/d,10);return x},-1),S(F,"$divmod",function h(d){var p=h.$$p||M,_=this;return h.$$p=null,v(_["$nan?"]())||v(d["$nan?"]())?f.$raise(C("FloatDomainError"),"NaN"):v(_["$infinite?"]())?f.$raise(C("FloatDomainError"),"Infinity"):U(_,N(_,"divmod",h,!1,!0),"divmod",[d],p)}),S(F,"$upto",function h(d){var p=h.$$p||M,_=this;if(h.$$p=null,p===M)return G(_,"enum_for",["upto",d],function $(){var se=null==$.$$s?this:$.$$s;return te(C("Numeric"),d)||f.$raise(C("ArgumentError"),"comparison of "+se.$class()+" with "+d.$class()+" failed"),v(I(d,se))?0:re(q(d,se),1)},{$$s:_});d.$$is_number||f.$raise(C("ArgumentError"),"comparison of "+_.$class()+" with "+d.$class()+" failed");for(var x=_;x<=d;x++)p(x);return _}),S(F,"$zero?",function(){return 0==this}),S(F,"$size",R(4)),S(F,"$nan?",function(){return isNaN(this)}),S(F,"$finite?",function(){var d=this;return d!=1/0&&d!=-1/0&&!isNaN(d)}),S(F,"$infinite?",function(){return this==1/0?1:this==-1/0?-1:M}),S(F,"$positive?",function(){var d=this;return 0!=d&&(d==1/0||1/d>0)}),S(F,"$negative?",function(){return this==-1/0||1/this<0}),S(F,"$next_float",function(){var d=this;return E(d,C(C("Float"),"INFINITY"))?C(C("Float"),"INFINITY"):v(d["$nan?"]())?C(C("Float"),"NAN"):k(d,0)?l(Math.abs(d)):c(d)}),S(F,"$prev_float",function(){var d=this;return E(d,C(C("Float"),"INFINITY")["$-@"]())?C(C("Float"),"INFINITY")["$-@"]():v(d["$nan?"]())?C(C("Float"),"NAN"):D(d,0)?c(d):-l(Math.abs(d))}),Q(F,"arg","angle"),Q(F,"eql?","=="),Q(F,"fdiv","/"),Q(F,"inspect","to_s"),Q(F,"kind_of?","is_a?"),Q(F,"magnitude","abs"),Q(F,"modulo","%"),Q(F,"object_id","__id__"),Q(F,"phase","angle"),Q(F,"succ","next"),Q(F,"to_int","to_i")}(0,C("Numeric"),A),ee("::","Fixnum",C("Number")),L=C("Numeric"),ne=A,he=[F=fe("::",L,"Integer")].concat(ne),F.$$is_number_class=!0,F.$$is_integer_class=!0,m=[B=T.get_singleton_class(F)].concat(he),l=T.$r(m),S(B,"$allocate",function(){return f.$raise(C("TypeError"),"allocator undefined for "+this.$name())}),T.udef(B,"$new"),S(B,"$sqrt",function(h){return(h=Ce["$coerce_to!"](h,C("Integer"),"to_int"))<0&&f.$raise(C(C("Math"),"DomainError"),'Numerical argument is out of domain - "isqrt"'),parseInt(Math.sqrt(h),10)}),S(B,"$try_convert",function(h){return l("Opal")["$coerce_to?"](h,this,"to_int")}),ee(F,"MAX",Math.pow(2,30)-1),ee(F,"MIN",-Math.pow(2,30)),function(P,L,ne){var F=fe("::",L,"Float");return[F].concat(ne),F.$$is_number_class=!0,function(B,O){S(B,"$allocate",function(){return f.$raise(C("TypeError"),"allocator undefined for "+this.$name())}),T.udef(B,"$new"),S(B,"$===",function(l){return!!l.$$is_number})}(T.get_singleton_class(F)),ee(F,"INFINITY",1/0),ee(F,"MAX",Number.MAX_VALUE),ee(F,"MIN",Number.MIN_VALUE),ee(F,"NAN",NaN),ee(F,"DIG",15),ee(F,"MANT_DIG",53),ee(F,"RADIX",2),ee(F,"EPSILON",Number.EPSILON||2220446049250313e-31)}(0,C("Numeric"),A)},Opal.modules["corelib/range"]=function(T){var fe=T.klass,Ce=T.truthy,f=T.Kernel,S=T.def,te=T.not,v=T.send2,D=T.find_super,z=T.rb_lt,I=T.rb_le,Q=T.send,U=T.eqeq,N=T.eqeqeq,G=T.return_ivar,re=T.rb_gt,q=T.rb_minus,E=T.Opal,V=T.rb_divide,le=T.rb_plus,Z=T.rb_times,Y=T.rb_ge,X=T.thrower,k=T.alias,H=T.nil,A=T.$$$;return T.top.$require("corelib/enumerable"),function(M,C,P){var L=fe("::",null,"Range"),ne=[L].concat([]),F=T.$r(ne),he=L.$$prototype;function B(O){return O.begin===H||O.end===H||O.begin===-1/0||O.end===1/0||O.begin===1/0||O.end===-1/0}return he.begin=he.end=he.excl=H,L.$include(A("Enumerable")),L.$$prototype.$$is_range=!0,L.$attr_reader("begin","end"),S(L,"$initialize",function(m,l,c){var h=this;return null==c&&(c=!1),Ce(h.begin)&&f.$raise(A("NameError"),"'initialize' called twice"),Ce(m["$<=>"](l))||Ce(m["$nil?"]())||Ce(l["$nil?"]())||f.$raise(A("ArgumentError"),"bad value for range"),h.begin=m,h.end=l,h.excl=c},-3),S(L,"$===",function(m){return this["$include?"](m)}),S(L,"$count",function O(){var m=O.$$p||H,l=this;return O.$$p=null,te(m!==H)&&Ce(B(l))?A(A("Float"),"INFINITY"):v(l,D(l,"count",O,!1,!0),"count",[],m)}),S(L,"$to_a",function O(){var m=O.$$p||H,l=this;return O.$$p=null,Ce(B(l))&&f.$raise(A("TypeError"),"cannot convert endless range to an array"),v(l,D(l,"to_a",O,!1,!0),"to_a",[],m)}),S(L,"$cover?",function(m){var c,_,l=this,h=H,d=H,p=H;return c=Ce(h=Ce(d=Ce(p=l.begin["$nil?"]())?-1:p)?d:l.begin["$<=>"](m))&&h,_=Ce(h=Ce(d=Ce(p=l.end["$nil?"]())?-1:p)?d:m["$<=>"](l.end))&&h,Ce(h=Ce(d=Ce(l.excl)?Ce(p=_)?z(_,0):p:Ce(p=_)?I(_,0):p)?c:d)?I(c,0):h}),S(L,"$each",function O(){var h,p,_,m=O.$$p||H,l=this,c=H,d=H;if(O.$$p=null,m===H)return Q(l,"enum_for",["each"],function x(){return(null==x.$$s?this:x.$$s).$size()},{$$s:l});if(l.begin.$$is_number&&l.end.$$is_number){for((l.begin%1!=0||l.end%1!=0)&&f.$raise(A("TypeError"),"can't iterate from Float"),p=l.begin,_=l.end+(Ce(l.excl)?0:1);p<_;p++)m(p);return l}if(l.begin.$$is_string&&l.end.$$is_string)return Q(l.begin,"upto",[l.end,l.excl],m.$to_proc()),l;for(h=l.end,Ce((c=l.begin)["$respond_to?"]("succ"))||f.$raise(A("TypeError"),"can't iterate from "+c.$class());Ce(Ce(d=l.end["$nil?"]())?d:z(c["$<=>"](h),0));)T.yield1(m,c),c=c.$succ();return te(l.excl)&&U(c,h)&&T.yield1(m,c),l}),S(L,"$eql?",function(m){var l=this,c=H,h=H;return!!N(A("Range"),m)&&(Ce(c=Ce(h=l.excl["$==="](m["$exclude_end?"]()))?l.begin["$eql?"](m.$begin()):h)?l.end["$eql?"](m.$end()):c)}),S(L,"$exclude_end?",G("excl")),S(L,"$first",function O(m){var l=O.$$p||H,c=this;return O.$$p=null,Ce(c.begin["$nil?"]())&&f.$raise(A("RangeError"),"cannot get the minimum of beginless range"),Ce(null==m)?c.begin:v(c,D(c,"first",O,!1,!0),"first",[m],l)},-1),S(L,"$last",function(m){var l=this;return Ce(l.end["$nil?"]())&&f.$raise(A("RangeError"),"cannot get the maximum of endless range"),Ce(null==m)?l.end:l.$to_a().$last(m)},-1),S(L,"$max",function O(){var m=O.$$p||H,l=this;return O.$$p=null,Ce(l.end["$nil?"]())?f.$raise(A("RangeError"),"cannot get the maximum of endless range"):m!==H?v(l,D(l,"max",O,!1,!0),"max",[],m):te(l.begin["$nil?"]())&&(Ce(re(l.begin,l.end))||Ce(l.excl)&&U(l.begin,l.end))?H:l.excl?l.end-1:l.end}),S(L,"$min",function O(){var m=O.$$p||H,l=this;return O.$$p=null,Ce(l.begin["$nil?"]())?f.$raise(A("RangeError"),"cannot get the minimum of beginless range"):m!==H?v(l,D(l,"min",O,!1,!0),"min",[],m):te(l.end["$nil?"]())&&(Ce(re(l.begin,l.end))||Ce(l.excl)&&U(l.begin,l.end))?H:l.begin}),S(L,"$size",function(){var m=this,l=H,c=H,h=H;return l=A(A("Float"),"INFINITY"),U(m.begin,l)&&te(m.end["$nil?"]())||U(m.end,l["$-@"]())&&te(m.begin["$nil?"]())?0:Ce(B(m))?l:N(A("Numeric"),m.begin)&&N(A("Numeric"),m.end)?(c=m.begin,h=m.end,Ce(m.excl)&&(h=q(h,1)),Ce(z(h,c))?0:(Math.abs(h-c)+1).$to_i()):H}),S(L,"$step",function O(m){var l=O.$$p||H,c=this,h=H,d=H;function p(){null==m?m=1:m.$$is_number||(m=E["$coerce_to!"](m,A("Integer"),"to_int")),m<0?f.$raise(A("ArgumentError"),"step can't be negative"):0===m&&f.$raise(A("ArgumentError"),"step can't be 0")}return O.$$p=null,l===H?(Ce(c.begin["$is_a?"](F("Numeric")))||Ce(c.begin["$nil?"]()))&&(Ce(c.end["$is_a?"](F("Numeric")))||Ce(c.end["$nil?"]()))&&te(Ce(h=c.begin["$nil?"]())?c.end["$nil?"]():h)?A(A("Enumerator"),"ArithmeticSequence").$new(c,m,"step"):Q(c,"enum_for",["step",m],function(){return p(),function _(){if(!c.begin["$respond_to?"]("succ")||c.begin.$$is_string&&c.end.$$is_string)return H;if(m%1==0)return V(c.$size(),m).$ceil();var Ae,x=c.begin,$=c.end,se=Math.abs,ae=Math.floor,Te=(se(x)+se($)+se($-x))/se(m)*A(A("Float"),"EPSILON");return Te>.5&&(Te=.5),c.excl?(Ae=ae(($-x)/m-Te))*m+x<$&&Ae++:Ae=ae(($-x)/m+Te)+1,Ae}()}):(p(),Ce(c.begin.$$is_number&&c.end.$$is_number)?(d=0,function(){try{var x=X("break");Q(c,"loop",[],function $(){var ae,se=null==$.$$s?this:$.$$s;return null==se.begin&&(se.begin=H),null==se.excl&&(se.excl=H),null==se.end&&(se.end=H),ae=le(se.begin,Z(d,m)),Ce(se.excl)?Ce(Y(ae,se.end))&&x.$throw():Ce(re(ae,se.end))&&x.$throw(),T.yield1(l,ae),d=le(d,1)},{$$s:c})}catch($){if($===x)return $.$v;throw $}}()):(c.begin.$$is_string&&c.end.$$is_string&&m%1!=0&&f.$raise(A("TypeError"),"no implicit conversion to float from string"),Q(c,"each_with_index",[],function($,se){return null==$&&($=H),null==se&&(se=H),U(se["$%"](m),0)?T.yield1(l,$):H})),c)},-1),S(L,"$%",function(m){var l=this;return Ce(l.begin["$is_a?"](F("Numeric")))&&Ce(l.end["$is_a?"](F("Numeric")))?A(A("Enumerator"),"ArithmeticSequence").$new(l,m,"%"):l.$step(m)}),S(L,"$bsearch",function O(){var m=O.$$p||H,l=this;return O.$$p=null,m===H?l.$enum_for("bsearch"):(Ce(B(l)&&(l.begin.$$is_number||l.end.$$is_number))&&f.$raise(A("NotImplementedError"),"Can't #bsearch an infinite range"),Ce(l.begin.$$is_number&&l.end.$$is_number)||f.$raise(A("TypeError"),"can't do binary search for "+l.begin.$class()),Q(l.$to_a(),"bsearch",[],m.$to_proc()))}),S(L,"$to_s",function(){var m=this,l=H;return(Ce(l=m.begin)?l:"")+(Ce(m.excl)?"...":"..")+(Ce(l=m.end)?l:"")}),S(L,"$inspect",function(){var m=this,l=H;return(Ce(l=m.begin)?m.begin.$inspect():l)+(Ce(m.excl)?"...":"..")+(Ce(l=m.end)?m.end.$inspect():l)}),S(L,"$marshal_load",function(m){var l=this;return l.begin=m["$[]"]("begin"),l.end=m["$[]"]("end"),l.excl=m["$[]"]("excl")}),S(L,"$hash",function(){var m=this;return[m.begin,m.end,m.excl].$hash()}),k(L,"==","eql?"),k(L,"include?","cover?"),k(L,"member?","cover?")}()},Opal.modules["corelib/proc"]=function(T){var V,fe=T.slice,f=T.truthy,S=T.Kernel,te=T.defs,v=T.def,D=T.send,z=T.to_a,I=T.return_self,Q=T.ensure_kwargs,U=T.Opal,N=T.alias,G=T.nil,re=T.$$$;return V=(0,T.klass)("::",Function,"Proc"),T.prop(V.$$prototype,"$$is_proc",!0),T.prop(V.$$prototype,"$$is_lambda",!1),te(V,"$new",function le(){var Z=le.$$p||G;return le.$$p=null,f(Z)||S.$raise(re("ArgumentError"),"tried to create a Proc object without a block"),Z}),v(V,"$call",function le(Z){var k,Y=le.$$p||G,R=this;le.$$p=null,k=fe(arguments),Y!==G&&(R.$$p=Y);var ee,H=R.$$brk,A=R.$$ret;if(H||A&&R.$$is_lambda)try{ee=R.$$is_lambda?R.apply(null,k):T.yieldX(R,k)}catch(M){if(M===H)return M.$v;if(R.$$is_lambda&&M===A)return M.$v;throw M}else ee=R.$$is_lambda?R.apply(null,k):T.yieldX(R,k);return ee},-1),v(V,"$>>",function le(Z){return le.$$p=null,D(S,"proc",[],function k(R){var H,ee=k.$$p||G,M=null==k.$$s?this:k.$$s,C=G;return k.$$p=null,H=fe(arguments),C=D(M,"call",z(H),ee.$to_proc()),Z.$call(C)},{$$arity:-1,$$s:this})}),v(V,"$<<",function le(Z){return le.$$p=null,D(S,"proc",[],function k(R){var H,ee=k.$$p||G,M=null==k.$$s?this:k.$$s,C=G;return k.$$p=null,H=fe(arguments),C=D(Z,"call",z(H),ee.$to_proc()),M.$call(C)},{$$arity:-1,$$s:this})}),v(V,"$to_proc",I),v(V,"$lambda?",function(){return!!this.$$is_lambda}),v(V,"$arity",function(){var Z=this;return Z.$$is_curried?-1:null!=Z.$$arity?Z.$$arity:Z.length}),v(V,"$source_location",function(){var Y=G;return this.$$is_curried?G:f(Y=this.$$source_location)?Y:G}),v(V,"$binding",function(){var Y=this;return Y.$$is_curried&&S.$raise(re("ArgumentError"),"Can't create Binding"),f(re("::","Binding","skip_raise")?"constant":G)?re("Binding").$new(G,[],Y.$$s,Y.$source_location()):G}),v(V,"$parameters",function(Z){var Y,X=this;if(Y=(Z=Q(Z)).$$smap.lambda,X.$$is_curried)return[["rest"]];if(X.$$parameters){if(null==Y?X.$$is_lambda:Y)return X.$$parameters;var R,ee,k=[];for(R=0,ee=X.$$parameters.length;R<ee;R++){var H=X.$$parameters[R];"req"===H[0]&&(H=["opt",H[1]]),k.push(H)}return k}return[]},-1),v(V,"$curry",function(Z){var Y=this;function X(){var ee,k=fe(arguments),R=k.length;return R>Z&&Y.$$is_lambda&&!Y.$$is_curried&&S.$raise(re("ArgumentError"),"wrong number of arguments ("+R+" for "+Z+")"),R>=Z?Y.$call.apply(Y,k):(ee=function(){return X.apply(null,k.concat(fe(arguments)))},ee.$$is_lambda=Y.$$is_lambda,ee.$$is_curried=!0,ee)}return void 0===Z?Z=Y.length:(Z=U["$coerce_to!"](Z,re("Integer"),"to_int"),Y.$$is_lambda&&Z!==Y.length&&S.$raise(re("ArgumentError"),"wrong number of arguments ("+Z+" for "+Y.length+")")),X.$$is_lambda=Y.$$is_lambda,X.$$is_curried=!0,X},-1),v(V,"$dup",function(){var Z=this,Y=Z.$$original_proc||Z,X=function(){return Y.apply(this,arguments)};for(var k in Z)Z.hasOwnProperty(k)&&(X[k]=Z[k]);return X}),N(V,"===","call"),N(V,"clone","dup"),N(V,"yield","call"),N(V,"[]","call")},Opal.modules["corelib/method"]=function(T){var G,re,fe=T.klass,Ce=T.def,f=T.truthy,S=T.slice,te=T.alias,v=T.Kernel,D=T.send,z=T.to_a,I=T.nil,Q=T.$$$;return(re=(G=fe("::",null,"Method")).$$prototype).method=re.receiver=re.owner=re.name=I,G.$attr_reader("owner","receiver","name"),Ce(G,"$initialize",function(E,V,le,Z){var Y=this;return Y.receiver=E,Y.owner=V,Y.name=Z,Y.method=le}),Ce(G,"$arity",function(){return this.method.$arity()}),Ce(G,"$parameters",function(){return this.method.$$parameters}),Ce(G,"$source_location",function(){var V;return f(V=this.method.$$source_location)?V:["(eval)",0]}),Ce(G,"$comments",function(){var V;return f(V=this.method.$$comments)?V:[]}),Ce(G,"$call",function q(E){var Z,V=q.$$p||I,Y=this;return q.$$p=null,Z=S(arguments),Y.method.$$p=V,Y.method.apply(Y.receiver,Z)},-1),Ce(G,"$curry",function(E){return this.method.$curry(E)},-1),Ce(G,"$>>",function(E){return this.method["$>>"](E)}),Ce(G,"$<<",function(E){return this.method["$<<"](E)}),Ce(G,"$unbind",function(){var E=this;return Q("UnboundMethod").$new(E.receiver.$class(),E.owner,E.method,E.name)}),Ce(G,"$to_proc",function(){var E=this,V=E.$call.bind(E);return V.$$unbound=E.method,V.$$is_lambda=!0,V.$$arity=null==E.method.$$arity?E.method.length:E.method.$$arity,V.$$parameters=E.method.$$parameters,V}),Ce(G,"$inspect",function(){var E=this;return"#<"+E.$class()+": "+E.receiver.$class()+"#"+E.name+" (defined in "+E.owner+" in "+E.$source_location().$join(":")+")>"}),te(G,"[]","call"),te(G,"===","call"),function(U,N){var G=fe("::",null,"UnboundMethod"),re=G.$$prototype;return re.method=re.owner=re.name=re.source=I,G.$attr_reader("source","owner","name"),Ce(G,"$initialize",function(E,V,le,Z){var Y=this;return Y.source=E,Y.owner=V,Y.method=le,Y.name=Z}),Ce(G,"$arity",function(){return this.method.$arity()}),Ce(G,"$parameters",function(){return this.method.$$parameters}),Ce(G,"$source_location",function(){var V;return f(V=this.method.$$source_location)?V:["(eval)",0]}),Ce(G,"$comments",function(){var V;return f(V=this.method.$$comments)?V:[]}),Ce(G,"$bind",function(E){var V=this;if(V.owner.$$is_module||T.is_a(E,V.owner))return Q("Method").$new(E,V.owner,V.method,V.name);v.$raise(Q("TypeError"),"can't bind singleton method to a different class (expected "+E+".kind_of?("+V.owner+" to be true)")}),Ce(G,"$bind_call",function q(E,V){var Y,le=q.$$p||I,X=this;return q.$$p=null,Y=S(arguments,1),D(X.$bind(E),"call",z(Y),le.$to_proc())},-2),Ce(G,"$inspect",function(){var E=this;return"#<"+E.$class()+": "+E.source+"#"+E.name+" (defined in "+E.owner+" in "+E.$source_location().$join(":")+")>"})}()},Opal.modules["corelib/variables"]=function(T){var fe=T.gvars,Ce=T.const_set,f=T.Object,S=T.hash2,te=T.nil;return fe["&"]=fe["~"]=fe["`"]=fe["'"]=te,fe.LOADED_FEATURES=fe['"']=T.loaded_features,fe.LOAD_PATH=fe[":"]=[],fe["/"]="\n",fe[","]=te,Ce("::","ARGV",[]),Ce("::","ARGF",f.$new()),Ce("::","ENV",S([],{})),fe.VERBOSE=!1,fe.DEBUG=!1,fe.SAFE=0},Opal.modules["corelib/io"]=function(T){var k,C,P,Ce=T.const_set,f=T.not,S=T.truthy,te=T.def,v=T.return_ivar,D=T.return_val,z=T.slice,I=T.Kernel,Q=T.gvars,U=T.send,N=T.to_a,G=T.rb_plus,re=T.neqeq,q=T.range,E=T.hash2,V=T.eqeq,le=T.to_ary,Z=T.rb_gt,Y=T.assign_ivar_val,X=T.alias,R=T.nil,ee=T.$$$;(P=(C=(0,T.klass)("::",null,"IO")).$$prototype).read_buffer=P.closed=R,Ce(C,"SEEK_SET",0),Ce(C,"SEEK_CUR",1),Ce(C,"SEEK_END",2),Ce(C,"SEEK_DATA",3),Ce(C,"SEEK_HOLE",4),Ce(C,"READABLE",1),Ce(C,"WRITABLE",4),C.$attr_reader("eof"),C.$attr_accessor("read_proc","sync","tty","write_proc"),te(C,"$initialize",function(ne,F){var he=this;return null==F&&(F="r"),he.fd=ne,he.flags=F,he.eof=!1,S(F["$include?"]("r"))&&f(F["$match?"](/[wa+]/))?he.closed="write":S(F["$match?"](/[wa]/))&&f(F["$match?"](/[r+]/))?he.closed="read":R},-2),te(C,"$fileno",v("fd")),te(C,"$tty?",function(){return 1==this.tty}),te(C,"$write",function(ne){return this.write_proc(ne),ne.$size()}),te(C,"$flush",D(R)),te(C,"$<<",function(ne){return this.$write(ne),this}),te(C,"$print",function(ne){var he,B=this;null==Q[","]&&(Q[","]=R);for(var O=0,m=(he=z(arguments)).length;O<m;O++)he[O]=I.$String(he[O]);return B.$write(he.join(Q[","])),R},-1),te(C,"$puts",function(ne){var he,O,B=this;if(0===(he=z(arguments)).length)return B.$write("\n"),R;for(var m=0,l=he.length;m<l;m++)if(he[m].$$is_array){var c=he[m].$flatten();c.length>0&&U(B,"puts",N(c))}else(O=he[m].$$is_string?he[m].valueOf():I.$String(he[m])).endsWith("\n")||(O+="\n"),B.$write(O);return R},-1),te(C,"$getc",function(){var F,ne=this,he=R,B=R;ne.read_buffer=S(F=ne.read_buffer)?F:"",he="";do{if(ne.read_buffer=G(ne.read_buffer,he),re(ne.read_buffer,""))return B=ne.read_buffer["$[]"](0),ne.read_buffer=ne.read_buffer["$[]"](q(1,-1,!1)),B}while(S(he=ne.$sysread_noraise(1)));return R}),te(C,"$getbyte",function(){var ne;return(ne=this.$getc())===R||null==ne?R:ne.$ord()}),te(C,"$readbyte",function(){return this.$readchar().$ord()}),te(C,"$readchar",function(){var F;return S(F=this.$getc())?F:I.$raise(ee("EOFError"),"end of file reached")}),te(C,"$readline",function(ne){var F,B=this,O=R;return F=z(arguments),S(O=U(B,"gets",N(F)))?O:I.$raise(ee("EOFError"),"end of file reached")},-1),te(C,"$gets",function(ne,F,he){var B,O,l,h,m=this,c=R,d=R,p=R,_=R;null==Q["/"]&&(Q["/"]=R),null==ne&&(ne=!1),null==F&&(F=R),null==he&&(he=E([],{})),S(ne.$$is_number)&&f(F)&&(ne=(B=[!1,ne,F])[0],F=B[1],he=B[2]),S(ne.$$is_hash)&&f(F)&&V(he,E([],{}))?(ne=(B=[!1,R,ne])[0],F=B[1],he=B[2]):S(F.$$is_hash)&&V(he,E([],{}))&&(ne=(B=[ne,R,F])[0],F=B[1],he=B[2]),l=ne,V(ne,!1)&&(ne=Q["/"]),V(ne,"")&&(ne=/\r?\n\r?\n/),ne=S(c=ne)?c:"",V(l,"")||(ne=ne.$to_str()),h=V(l,"")?2:ne.$length(),V(ne," ")&&(ne=/ /),m.read_buffer=S(c=m.read_buffer)?c:"",d="",p=R;do{if(m.read_buffer=G(m.read_buffer,d),re(ne,"")&&S(S(ne.$$is_regexp)?m.read_buffer["$match?"](ne):m.read_buffer["$include?"](ne))){_=m.read_buffer,O=m.read_buffer.$split(ne,2),p=null==(B=le(O))[0]?R:B[0],m.read_buffer=null==B[1]?R:B[1],re(p,_)&&(p=G(p,_["$[]"](p.$length(),h)));break}}while(S(d=m.$sysread_noraise(V(ne,"")?65536:1)));return S(p)||(p=(B=[S(c=m.read_buffer)?c:"",""])[0],m.read_buffer=B[1],V(p,"")&&(p=R)),S(p)&&(S(F)&&(p=p["$[]"](T.Range.$new(0,F,!0)),m.read_buffer=G(p["$[]"](T.Range.$new(F,-1,!1)),m.read_buffer)),S(he["$[]"]("chomp"))&&(p=p.$sub(/\r?\n$/,"")),V(l,"")&&(p=p.$sub(/^[\r\n]+/,""))),V(l,!1)&&(Q._=p),p},-1),te(C,"$sysread",function(ne){var he;return S(he=this.read_proc(ne))?he:(this.eof=!0,I.$raise(ee("EOFError"),"end of file reached"))}),te(C,"$sysread_noraise",function(ne){try{return this.$sysread(ne)}catch(he){if(!T.rescue(he,[ee("EOFError")]))throw he;try{return R}finally{T.pop_exception()}}}),te(C,"$readpartial",function(ne){var F,O,he=this,B=R,m=R;return he.read_buffer=S(B=he.read_buffer)?B:"",O=he.$sysread(ne),m=(F=[G(he.read_buffer,S(B=O)?B:""),""])[0],he.read_buffer=F[1],V(m,"")&&(m=R),m}),te(C,"$read",function(ne){var F,he=this,B=R,O=R,m=R;null==ne&&(ne=R),he.read_buffer=S(B=he.read_buffer)?B:"",O="",m=R;do{if(he.read_buffer=G(he.read_buffer,O),S(ne)&&S(Z(he.read_buffer.$length(),ne)))return m=(F=[he.read_buffer["$[]"](T.Range.$new(0,ne,!0)),he.read_buffer["$[]"](T.Range.$new(ne,-1,!1))])[0],he.read_buffer=F[1],m}while(S(O=he.$sysread_noraise(S(B=ne)?B:65536)));return m=(F=[he.read_buffer,""])[0],he.read_buffer=F[1],m},-1),te(C,"$readlines",function(ne){return null==Q["/"]&&(Q["/"]=R),null==ne&&(ne=Q["/"]),this.$each_line(ne).$to_a()},-1),te(C,"$each",function L(ne,F){var B,O,m,he=L.$$p||R,l=this,c=R;if(null==Q["/"]&&(Q["/"]=R),L.$$p=null,(B=z(arguments)).length>0&&(O=B.shift()),null==O&&(O=Q["/"]),m=B,he===R)return U(l,"enum_for",["each",O].concat(N(m)));for(;S(c=U(l,"gets",[O].concat(N(m))));)T.yield1(he,c);return l},-1),te(C,"$each_byte",function L(){var ne=L.$$p||R,F=this,he=R;if(L.$$p=null,ne===R)return F.$enum_for("each_byte");for(;S(he=F.$getbyte());)T.yield1(ne,he);return F}),te(C,"$each_char",function L(){var ne=L.$$p||R,F=this,he=R;if(L.$$p=null,ne===R)return F.$enum_for("each_char");for(;S(he=F.$getc());)T.yield1(ne,he);return F}),te(C,"$close",Y("closed","both")),te(C,"$close_read",function(){return this.closed=V(this.closed,"write")?"both":"read"}),te(C,"$close_write",function(){return this.closed=V(this.closed,"read")?"both":"write"}),te(C,"$closed?",function(){return this.closed["$=="]("both")}),te(C,"$closed_read?",function(){var F;return S(F=this.closed["$=="]("read"))?F:this.closed["$=="]("both")}),te(C,"$closed_write?",function(){var F;return S(F=this.closed["$=="]("write"))?F:this.closed["$=="]("both")}),te(C,"$check_writable",function(){return S(this["$closed_write?"]())?I.$raise(ee("IOError"),"not opened for writing"):R}),te(C,"$check_readable",function(){return S(this["$closed_read?"]())?I.$raise(ee("IOError"),"not opened for reading"):R}),X(C,"each_line","each"),X(C,"eof?","eof"),Ce("::","STDIN",Q.stdin=ee("IO").$new(0,"r")),Ce("::","STDOUT",Q.stdout=ee("IO").$new(1,"w")),Ce("::","STDERR",Q.stderr=ee("IO").$new(2,"w"));var H=T.global.console;return ee("STDOUT")["$write_proc="]("object"==typeof process&&"object"==typeof process.stdout?function(A){process.stdout.write(A)}:function(A){H.log(A)}),ee("STDERR")["$write_proc="]("object"==typeof process&&"object"==typeof process.stderr?function(A){process.stderr.write(A)}:function(A){H.warn(A)}),k=[function(A){var M=prompt();return null!==M?M+"\n":R}],U(ee("STDIN"),"read_proc=",k),k[k.length-1]},Opal.modules["opal/regexp_anchors"]=function(T){var D,z,I,Q,Ce=T.const_set,f=[],te=T.$$$;return D=f,I=[z=(0,T.module)(f[0],"Opal")].concat(D),Q=T.$r(I),Ce(z,"REGEXP_START","^"),Ce(z,"REGEXP_END","$"),Ce(z,"FORBIDDEN_STARTING_IDENTIFIER_CHARS","\\u0001-\\u002F\\u003A-\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),Ce(z,"FORBIDDEN_ENDING_IDENTIFIER_CHARS","\\u0001-\\u0020\\u0022-\\u002F\\u003A-\\u003E\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),Ce(z,"INLINE_IDENTIFIER_REGEXP",Q("Regexp").$new("[^"+te(z,"FORBIDDEN_STARTING_IDENTIFIER_CHARS")+"]*[^"+te(z,"FORBIDDEN_ENDING_IDENTIFIER_CHARS")+"]")),Ce(z,"FORBIDDEN_CONST_NAME_CHARS","\\u0001-\\u0020\\u0021-\\u002F\\u003B-\\u003F\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),Ce(z,"CONST_NAME_REGEXP",Q("Regexp").$new(te(z,"REGEXP_START")+"(::)?[A-Z][^"+te(z,"FORBIDDEN_CONST_NAME_CHARS")+"]*"+te(z,"REGEXP_END")))},Opal.modules["opal/mini"]=function(T){var fe=T.Object;return fe.$require("opal/base"),fe.$require("corelib/nil"),fe.$require("corelib/boolean"),fe.$require("corelib/string"),fe.$require("corelib/comparable"),fe.$require("corelib/enumerable"),fe.$require("corelib/enumerator"),fe.$require("corelib/array"),fe.$require("corelib/hash"),fe.$require("corelib/number"),fe.$require("corelib/range"),fe.$require("corelib/proc"),fe.$require("corelib/method"),fe.$require("corelib/regexp"),fe.$require("corelib/variables"),fe.$require("corelib/io"),fe.$require("opal/regexp_anchors")},Opal.modules["corelib/kernel/format"]=function(T){var re,fe=T.coerce_to,f=T.slice,S=T.truthy,te=T.eqeq,v=T.Opal,D=T.Kernel,z=T.gvars,Q=T.alias,U=T.nil,N=T.$$$;return(0,T.def)(re=(0,T.module)("::","Kernel"),"$format",function(E,V){var le,Z,Y=U;null==z.DEBUG&&(z.DEBUG=U),le=f(arguments,1),te((Z=le).$length(),1)&&S(Z["$[]"](0)["$respond_to?"]("to_ary"))&&(Y=v["$coerce_to?"](Z["$[]"](0),N("Array"),"to_ary"),S(Y["$nil?"]())||(Z=Y.$to_a()));var R,ee,A,M,C,P,L,ne,F,he,B,O,m,l,c,p,X="",k=0,H=E.length,h=1,d=0,_=0,x=1,$=2,se=4,ae=8,Te=16,Ae=32,de=64,Fe=128;function xe(){p&Ae&&D.$raise(N("ArgumentError"),"flag after width"),p&Fe&&D.$raise(N("ArgumentError"),"flag after precision")}function ke(){p&Ae&&D.$raise(N("ArgumentError"),"width given twice"),p&Fe&&D.$raise(N("ArgumentError"),"width after precision")}function De(b){return b>=Z.length&&D.$raise(N("ArgumentError"),"too few arguments"),Z[b]}function Me(){switch(d){case-1:D.$raise(N("ArgumentError"),"unnumbered("+h+") mixed with numbered");case-2:D.$raise(N("ArgumentError"),"unnumbered("+h+") mixed with named")}return De((d=h++)-1)}function _e(b){return d>0&&D.$raise(N("ArgumentError"),"numbered("+b+") after unnumbered("+d+")"),-2===d&&D.$raise(N("ArgumentError"),"numbered("+b+") after named"),b<1&&D.$raise(N("ArgumentError"),"invalid index - "+b+"$"),d=-1,De(b-1)}function ce(){return void 0===c?Me():c}function pe(b){for(var K,ge="";;ee++){if(ee===H&&D.$raise(N("ArgumentError"),"malformed format string - %*[0-9]"),E.charCodeAt(ee)<48||E.charCodeAt(ee)>57)return ee--,(K=parseInt(ge,10)||0)>2147483647&&D.$raise(N("ArgumentError"),b+" too big"),K;ge+=E.charAt(ee)}}function ye(b){var K,ge=pe(b);return"$"===E.charAt(ee+1)?(ee++,K=_e(ge)):K=Me(),K.$to_int()}for(ee=E.indexOf("%");-1!==ee;ee=E.indexOf("%",ee)){switch(M=void 0,p=_,P=-1,L=-1,c=void 0,R=ee,ee++,E.charAt(ee)){case"%":k=ee;case"":case"\n":case"\0":ee++;continue}e:for(;ee<H;ee++)switch(E.charAt(ee)){case" ":xe(),p|=Te;continue e;case"#":xe(),p|=x;continue e;case"+":xe(),p|=se;continue e;case"-":xe(),p|=$;continue e;case"0":xe(),p|=ae;continue e;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":if(ne=pe("width"),"$"===E.charAt(ee+1)){if(ee+2===H){M="%",ee++;break e}void 0!==c&&D.$raise(N("ArgumentError"),"value given twice - %"+ne+"$"),c=_e(ne),ee++}else ke(),p|=Ae,P=ne;continue e;case"<":case"{":for(he="<"===E.charAt(ee)?">":"}",F="",ee++;;ee++){if(ee===H&&D.$raise(N("ArgumentError"),"malformed name - unmatched parenthesis"),E.charAt(ee)===he){if(d>0&&D.$raise(N("ArgumentError"),"named "+F+" after unnumbered("+d+")"),-1===d&&D.$raise(N("ArgumentError"),"named "+F+" after numbered"),d=-2,(void 0===Z[0]||!Z[0].$$is_hash)&&D.$raise(N("ArgumentError"),"one hash required"),c=Z[0].$fetch(F),">"===he)continue e;if(M=c.toString(),-1!==L&&(M=M.slice(0,L)),p&$)for(;M.length<P;)M+=" ";else for(;M.length<P;)M=" "+M;break e}F+=E.charAt(ee)}case"*":ee++,ke(),p|=Ae,(P=ye("width"))<0&&(p|=$,P=-P);continue e;case".":if(p&Fe&&D.$raise(N("ArgumentError"),"precision given twice"),p|=de|Fe,L=0,ee++,"*"===E.charAt(ee)){ee++,(L=ye("precision"))<0&&(p&=~de);continue e}L=pe("precision");continue e;case"d":case"i":case"u":if((A=D.$Integer(ce()))>=0){for(M=A.toString();M.length<L;)M="0"+M;if(p&$)for((p&se||p&Te)&&(M=(p&se?"+":" ")+M);M.length<P;)M+=" ";else if(p&ae&&-1===L){for(;M.length<P-(p&se||p&Te?1:0);)M="0"+M;(p&se||p&Te)&&(M=(p&se?"+":" ")+M)}else for((p&se||p&Te)&&(M=(p&se?"+":" ")+M);M.length<P;)M=" "+M}else{for(M=(-A).toString();M.length<L;)M="0"+M;if(p&$)for(M="-"+M;M.length<P;)M+=" ";else if(p&ae&&-1===L){for(;M.length<P-1;)M="0"+M;M="-"+M}else for(M="-"+M;M.length<P;)M=" "+M}break e;case"b":case"B":case"o":case"x":case"X":switch(E.charAt(ee)){case"b":case"B":B=2,O="0b",m=/^1+/,l="1";break;case"o":B=8,O="0",m=/^3?7+/,l="7";break;case"x":case"X":B=16,O="0x",m=/^f+/,l="f"}if((A=D.$Integer(ce()))>=0){for(M=A.toString(B);M.length<L;)M="0"+M;if(p&$)for((p&se||p&Te)&&(M=(p&se?"+":" ")+M),p&x&&0!==A&&(M=O+M);M.length<P;)M+=" ";else if(p&ae&&-1===L){for(;M.length<P-(p&se||p&Te?1:0)-(p&x&&0!==A?O.length:0);)M="0"+M;p&x&&0!==A&&(M=O+M),(p&se||p&Te)&&(M=(p&se?"+":" ")+M)}else for(p&x&&0!==A&&(M=O+M),(p&se||p&Te)&&(M=(p&se?"+":" ")+M);M.length<P;)M=" "+M}else if(p&se||p&Te){for(M=(-A).toString(B);M.length<L;)M="0"+M;if(p&$)for(p&x&&(M=O+M),M="-"+M;M.length<P;)M+=" ";else if(p&ae&&-1===L){for(;M.length<P-1-(p&x?2:0);)M="0"+M;p&x&&(M=O+M),M="-"+M}else for(p&x&&(M=O+M),M="-"+M;M.length<P;)M=" "+M}else{for(M=(A>>>0).toString(B).replace(m,l);M.length<L-2;)M=l+M;if(p&$)for(M=".."+M,p&x&&(M=O+M);M.length<P;)M+=" ";else if(p&ae&&-1===L){for(;M.length<P-2-(p&x?O.length:0);)M=l+M;M=".."+M,p&x&&(M=O+M)}else for(M=".."+M,p&x&&(M=O+M);M.length<P;)M=" "+M}E.charAt(ee)===E.charAt(ee).toUpperCase()&&(M=M.toUpperCase());break e;case"f":case"e":case"E":case"g":case"G":if((A=D.$Float(ce()))>=0||isNaN(A)){if(A===1/0)M="Inf";else switch(E.charAt(ee)){case"f":M=A.toFixed(-1===L?6:L);break;case"e":case"E":M=A.toExponential(-1===L?6:L);break;case"g":case"G":M=A.toExponential(),(C=parseInt(M.split("e")[1],10))<-4||C>=(-1===L?6:L)||(M=A.toPrecision(-1===L?p&x?6:void 0:L))}if(p&$)for((p&se||p&Te)&&(M=(p&se?"+":" ")+M);M.length<P;)M+=" ";else if(p&ae&&A!==1/0&&!isNaN(A)){for(;M.length<P-(p&se||p&Te?1:0);)M="0"+M;(p&se||p&Te)&&(M=(p&se?"+":" ")+M)}else for((p&se||p&Te)&&(M=(p&se?"+":" ")+M);M.length<P;)M=" "+M}else{if(A===-1/0)M="Inf";else switch(E.charAt(ee)){case"f":M=(-A).toFixed(-1===L?6:L);break;case"e":case"E":M=(-A).toExponential(-1===L?6:L);break;case"g":case"G":M=(-A).toExponential(),(C=parseInt(M.split("e")[1],10))<-4||C>=(-1===L?6:L)||(M=(-A).toPrecision(-1===L?p&x?6:void 0:L))}if(p&$)for(M="-"+M;M.length<P;)M+=" ";else if(p&ae&&A!==-1/0){for(;M.length<P-1;)M="0"+M;M="-"+M}else for(M="-"+M;M.length<P;)M=" "+M}E.charAt(ee)===E.charAt(ee).toUpperCase()&&A!==1/0&&A!==-1/0&&!isNaN(A)&&(M=M.toUpperCase()),M=M.replace(/([eE][-+]?)([0-9])$/,"$10$2");break e;case"a":case"A":D.$raise(N("NotImplementedError"),"`A` and `a` format field types are not implemented in Opal yet");case"c":if((A=ce())["$respond_to?"]("to_ary")&&(A=A.$to_ary()[0]),1!==(M=A["$respond_to?"]("to_str")?A.$to_str():String.fromCharCode(fe(A,N("Integer"),"to_int"))).length&&D.$raise(N("ArgumentError"),"%c requires a character"),p&$)for(;M.length<P;)M+=" ";else for(;M.length<P;)M=" "+M;break e;case"p":if(M=ce().$inspect(),-1!==L&&(M=M.slice(0,L)),p&$)for(;M.length<P;)M+=" ";else for(;M.length<P;)M=" "+M;break e;case"s":if(M=ce().$to_s(),-1!==L&&(M=M.slice(0,L)),p&$)for(;M.length<P;)M+=" ";else for(;M.length<P;)M=" "+M;break e;default:D.$raise(N("ArgumentError"),"malformed format string - %"+E.charAt(ee))}void 0===M&&D.$raise(N("ArgumentError"),"malformed format string - %"),X+=E.slice(k,R)+M,k=ee+1}return z.DEBUG&&d>=0&&h<Z.length&&D.$raise(N("ArgumentError"),"too many arguments for format string"),X+E.slice(k)},-2),Q(re,"sprintf","format")},Opal.modules["corelib/string/encoding"]=function(T){var q,R,ee,fe=T.klass,Ce=T.hash2,f=T.rb_plus,S=T.truthy,te=T.send,v=T.defs,D=T.eqeq,z=T.def,I=T.return_ivar,Q=T.return_val,U=T.slice,N=T.Kernel,G=T.Opal,re=T.rb_lt,E=T.top,le=T.$r([]),Z=T.nil,Y=T.$$$;return E.$require("corelib/string"),(ee=(R=fe("::",null,"Encoding")).$$prototype).name=ee.dummy=Z,v(R,"$register",function H(A,M){var L,F,he,C=H.$$p||Z,ne=Z,B=Z,O=Z;return H.$$p=null,null==M&&(M=Ce([],{})),L=f([A],S(ne=M["$[]"]("aliases"))?ne:[]),F=S(ne=M["$[]"]("ascii"))&&ne,he=S(ne=M["$[]"]("dummy"))&&ne,S(M["$[]"]("inherits"))?(B=M["$[]"]("inherits").$clone()).$initialize(A,L,F,he):B=this.$new(A,L,F,he),C!==Z&&te(B,"instance_eval",[],C.$to_proc()),O=T.encodings,te(L,"each",[],function m(l){return null==l&&(l=Z),(null==m.$$s?this:m.$$s).$const_set(l.$tr("-","_"),B),O[l]=B},{$$s:this})},-2),v(R,"$find",function(A){return D(A,"default_external")?this.$default_external():T.find_encoding(A)}),R.$singleton_class().$attr_accessor("default_external"),R.$attr_reader("name","names"),z(R,"$initialize",function(A,M,C,P){var L=this;return L.name=A,L.names=M,L.ascii=C,L.dummy=P}),z(R,"$ascii_compatible?",I("ascii")),z(R,"$dummy?",I("dummy")),z(R,"$binary?",Q(!1)),z(R,"$to_s",I("name")),z(R,"$inspect",function(){return"#<Encoding:"+this.name+(S(this.dummy)?" (dummy)":Z)+">"}),z(R,"$charsize",function(A){for(var M=0,C=0,P=A.length;C<P;C++){var L=A.charCodeAt(C);L>=55296&&L<=56319||M++}return M}),z(R,"$each_char",function H(A){var M=H.$$p||Z;H.$$p=null;for(var C="",P=0,L=A.length;P<L;P++){var ne=A.charCodeAt(P),F=A.charAt(P);ne>=56320&&ne<=57343?C=F:(ne>=55296&&ne<=56319&&(F=C+F),"UTF-8"!=A.encoding.name&&((F=new String(F)).encoding=A.encoding),T.yield1(M,F))}}),z(R,"$each_byte",function(A){return U(arguments),N.$raise(Y("NotImplementedError"))},-1),z(R,"$bytesize",function(A){return U(arguments),N.$raise(Y("NotImplementedError"))},-1),fe("::",Y("StandardError"),"EncodingError"),fe("::",Y("EncodingError"),"CompatibilityError"),te(Y("Encoding"),"register",["UTF-8",Ce(["aliases","ascii"],{aliases:["CP65001"],ascii:!0})],function X(){var k=null==X.$$s?this:X.$$s;return z(k,"$each_byte",function R(ee){var H=R.$$p||Z;R.$$p=null;for(var M,A=1/0,C=ee.length,P=null,L=0;L<C;++L){if((M=ee.charCodeAt(L))>55295&&M<57344){if(!P){if(M>56319){(A-=3)>-1&&(T.yield1(H,239),T.yield1(H,191),T.yield1(H,189));continue}if(L+1===C){(A-=3)>-1&&(T.yield1(H,239),T.yield1(H,191),T.yield1(H,189));continue}P=M;continue}if(M<56320){(A-=3)>-1&&(T.yield1(H,239),T.yield1(H,191),T.yield1(H,189)),P=M;continue}M=65536+(P-55296<<10|M-56320)}else P&&(A-=3)>-1&&(T.yield1(H,239),T.yield1(H,191),T.yield1(H,189));if(P=null,M<128){if((A-=1)<0)break;T.yield1(H,M)}else if(M<2048){if((A-=2)<0)break;T.yield1(H,M>>6|192),T.yield1(H,63&M|128)}else if(M<65536){if((A-=3)<0)break;T.yield1(H,M>>12|224),T.yield1(H,M>>6&63|128),T.yield1(H,63&M|128)}else if(M<1114112){if((A-=4)<0)break;T.yield1(H,M>>18|240),T.yield1(H,M>>12&63|128),T.yield1(H,M>>6&63|128),T.yield1(H,63&M|128)}}}),z(k,"$bytesize",function(ee){return ee.$bytes().$length()})},{$$s:E}),te(Y("Encoding"),"register",["UTF-16LE"],function X(){var k=null==X.$$s?this:X.$$s;return z(k,"$each_byte",function R(ee){var H=R.$$p||Z;R.$$p=null;for(var A=0,M=ee.length;A<M;A++){var C=ee.charCodeAt(A);T.yield1(H,255&C),T.yield1(H,C>>8)}}),z(k,"$bytesize",function(ee){return 2*ee.length})},{$$s:E}),te(Y("Encoding"),"register",["UTF-16BE",Ce(["inherits"],{inherits:Y(Y("Encoding"),"UTF_16LE")})],function X(){return z(null==X.$$s?this:X.$$s,"$each_byte",function R(ee){var H=R.$$p||Z;R.$$p=null;for(var A=0,M=ee.length;A<M;A++){var C=ee.charCodeAt(A);T.yield1(H,C>>8),T.yield1(H,255&C)}})},{$$s:E}),te(Y("Encoding"),"register",["UTF-32LE"],function X(){var k=null==X.$$s?this:X.$$s;return z(k,"$each_byte",function R(ee){var H=R.$$p||Z;R.$$p=null;for(var A=0,M=ee.length;A<M;A++){var C=ee.charCodeAt(A);T.yield1(H,255&C),T.yield1(H,C>>8),T.yield1(H,0),T.yield1(H,0)}}),z(k,"$bytesize",function(ee){return 4*ee.length})},{$$s:E}),te(Y("Encoding"),"register",["UTF-32BE",Ce(["inherits"],{inherits:Y(Y("Encoding"),"UTF_32LE")})],function X(){return z(null==X.$$s?this:X.$$s,"$each_byte",function R(ee){var H=R.$$p||Z;R.$$p=null;for(var A=0,M=ee.length;A<M;A++){var C=ee.charCodeAt(A);T.yield1(H,0),T.yield1(H,0),T.yield1(H,C>>8),T.yield1(H,255&C)}})},{$$s:E}),te(Y("Encoding"),"register",["ASCII-8BIT",Ce(["aliases","ascii"],{aliases:["BINARY"],ascii:!0})],function X(){var k=null==X.$$s?this:X.$$s;return z(k,"$each_char",function R(ee){var H=R.$$p||Z;R.$$p=null;for(var A=0,M=ee.length;A<M;A++){var C=new String(ee.charAt(A));C.encoding=ee.encoding,T.yield1(H,C)}}),z(k,"$charsize",function(ee){return ee.length}),z(k,"$each_byte",function R(ee){var H=R.$$p||Z;R.$$p=null;for(var A=0,M=ee.length;A<M;A++){var C=ee.charCodeAt(A);T.yield1(H,255&C)}}),z(k,"$bytesize",function(ee){return ee.length}),z(k,"$binary?",Q(!0))},{$$s:E}),Y("Encoding").$register("ISO-8859-1",Ce(["aliases","ascii","inherits"],{aliases:["ISO8859-1"],ascii:!0,inherits:Y(Y("Encoding"),"ASCII_8BIT")})),Y("Encoding").$register("US-ASCII",Ce(["aliases","ascii","inherits"],{aliases:["ASCII"],ascii:!0,inherits:Y(Y("Encoding"),"ASCII_8BIT")})),function(X,k){var R=fe("::",null,"String"),ee=R.$$prototype;ee.internal_encoding=ee.bytes=ee.encoding=Z,R.$attr_reader("encoding"),R.$attr_reader("internal_encoding"),T.prop(String.prototype,"bytes",Z),T.prop(String.prototype,"encoding",Y(Y("Encoding"),"UTF_8")),T.prop(String.prototype,"internal_encoding",Y(Y("Encoding"),"UTF_8")),z(R,"$b",function(){return this.$dup().$force_encoding("binary")}),z(R,"$bytesize",function(){return this.internal_encoding.$bytesize(this)}),z(R,"$each_byte",function H(){var A=H.$$p||Z,M=this;return H.$$p=null,A===Z?te(M,"enum_for",["each_byte"],function C(){return(null==C.$$s?this:C.$$s).$bytesize()},{$$s:M}):(te(M.internal_encoding,"each_byte",[M],A.$to_proc()),M)}),z(R,"$bytes",function(){var A=this,M=Z;return"string"==typeof A?new String(A).$each_byte().$to_a():(A.bytes=S(M=A.bytes)?M:A.$each_byte().$to_a(),A.bytes.$dup())}),z(R,"$each_char",function H(){var A=H.$$p||Z,M=this;return H.$$p=null,A===Z?te(M,"enum_for",["each_char"],function C(){return(null==C.$$s?this:C.$$s).$length()},{$$s:M}):(te(M.encoding,"each_char",[M],A.$to_proc()),M)}),z(R,"$chars",function H(){var A=H.$$p||Z;return H.$$p=null,S(A)?te(this,"each_char",[],A.$to_proc()):this.$each_char().$to_a()}),z(R,"$each_codepoint",function H(){var A=H.$$p||Z,M=this;if(H.$$p=null,A===Z)return M.$enum_for("each_codepoint");for(var C=0,P=M.length;C<P;C++)T.yield1(A,M.codePointAt(C));return M}),z(R,"$codepoints",function H(){var A=H.$$p||Z;return H.$$p=null,A!==Z?te(this,"each_codepoint",[],A.$to_proc()):this.$each_codepoint().$to_a()}),z(R,"$encode",function(A){return T.enc(this,A)}),z(R,"$force_encoding",function(A){var C=this;return A===C.encoding||(A=G["$coerce_to!"](A,Y("String"),"to_s"),(A=Y("Encoding").$find(A))===C.encoding)||(C=T.set_encoding(C,A)),C}),z(R,"$getbyte",function(A){var C=Z;return C=this.$bytes(),A=G["$coerce_to!"](A,Y("Integer"),"to_int"),S(re(C.$length(),A))?Z:C["$[]"](A)}),z(R,"$initialize_copy",function(A){return"\n      self.encoding = other.encoding;\n      self.internal_encoding = other.internal_encoding;\n    "}),z(R,"$valid_encoding?",Q(!0))}(),q=[Y(le("Encoding"),"UTF_8")],te(Y("Encoding"),"default_external=",q),q[q.length-1]},Opal.modules["corelib/math"]=function(T){var le,Z,Y,X,fe=T.type_error,f=T.const_set,S=T.Class,te=T.slice,v=T.Kernel,D=T.defs,z=T.truthy,I=T.send,Q=T.def,U=T.rb_minus,N=T.eqeqeq,G=T.rb_divide,q=T.nil,E=T.$$$;return le=[],Y=[Z=(0,T.module)("::","Math")].concat(le),X=T.$r(Y),f(Z,"E",Math.E),f(Z,"PI",Math.PI),f(Z,"DomainError",S.$new(E("StandardError"))),D(Z,"$checked",function(R,ee){var A;if(A=te(arguments,1),isNaN(A[0])||2==A.length&&isNaN(A[1]))return NaN;var M=Math[R].apply(null,A);return isNaN(M)&&v.$raise(X("DomainError"),'Numerical argument is out of domain - "'+R+'"'),M},-2),D(Z,"$float!",function(R){try{return v.$Float(R)}catch(ee){if(!T.rescue(ee,[E("ArgumentError")]))throw ee;try{return v.$raise(fe(R,E("Float")))}finally{T.pop_exception()}}}),D(Z,"$integer!",function(R){try{return v.$Integer(R)}catch(ee){if(!T.rescue(ee,[E("ArgumentError")]))throw ee;try{return v.$raise(fe(R,E("Integer")))}finally{T.pop_exception()}}}),Z.$module_function(),z(void 0!==Math.erf)||T.prop(Math,"erf",function(k){var P=1;k<0&&(P=-1);var L=1/(1+.3275911*(k=Math.abs(k)));return P*(1-((((1.061405429*L-1.453152027)*L+1.421413741)*L-.284496736)*L+.254829592)*L*Math.exp(-k*k))}),z(void 0!==Math.erfc)||T.prop(Math,"erfc",function(k){var R=Math.abs(k),ee=1/(.5*R+1),O=ee*Math.exp(-R*R-1.26551223+ee*(ee*(ee*(ee*(ee*(ee*(ee*(ee*(.17087277*ee-.82215223)+1.48851587)-1.13520398)+.27886807)-.18628806)+.09678418)+.37409196)+1.00002368));return k<0?2-O:O}),I(["acos","acosh","asin","asinh","atan","atanh","cbrt","cos","cosh","erf","erfc","exp","sin","sinh","sqrt","tanh"],"each",[],function k(R){return null==R&&(R=q),I(null==k.$$s?this:k.$$s,"define_method",[R],function(A){return null==A&&(A=q),E("Math").$checked(R,E("Math")["$float!"](A))})},{$$s:Z}),Q(Z,"$atan2",function(R,ee){return E("Math").$checked("atan2",E("Math")["$float!"](R),E("Math")["$float!"](ee))}),Q(Z,"$hypot",function(R,ee){return E("Math").$checked("hypot",E("Math")["$float!"](R),E("Math")["$float!"](ee))}),Q(Z,"$frexp",function(R){if(R=X("Math")["$float!"](R),isNaN(R))return[NaN,0];var ee=Math.floor(Math.log(Math.abs(R))/Math.log(2))+1;return[R/Math.pow(2,ee),ee]}),Q(Z,"$gamma",function(R){R=X("Math")["$float!"](R);var ee,H,A,M,C,P,L,ne,F,B=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];if(isNaN(R))return NaN;if(0===R&&1/R<0)return-1/0;if((-1===R||R===-1/0)&&v.$raise(X("DomainError"),'Numerical argument is out of domain - "gamma"'),X("Integer")["$==="](R)){if(R<=0)return isFinite(R)?1/0:NaN;if(R>171)return 1/0;for(M=R-2,C=R-1;M>1;)C*=M,M--;return 0==C&&(C=1),C}if(R<.5)return Math.PI/(Math.sin(Math.PI*R)*E("Math").$gamma(U(1,R)));if(R>=171.35)return 1/0;if(R>85)return F=(ne=(L=(P=R*R)*R)*R)*R,Math.sqrt(2*Math.PI/R)*Math.pow(R/Math.E,R)*(1+1/(12*R)+1/(288*P)-139/(51840*L)-571/(2488320*ne)+163879/(209018880*F)+5246819/(75246796800*F*R));for(R-=1,A=B[0],ee=1;ee<B.length;++ee)A+=B[ee]/(R+ee);return H=R+4.7421875+.5,Math.sqrt(2*Math.PI)*Math.pow(H,R+.5)*Math.exp(-H)*A}),Q(Z,"$ldexp",function(R,ee){return R=X("Math")["$float!"](R),ee=X("Math")["$integer!"](ee),isNaN(ee)&&v.$raise(E("RangeError"),"float NaN out of range of integer"),R*Math.pow(2,ee)}),Q(Z,"$lgamma",function(R){return-1==R?[1/0,1]:[Math.log(Math.abs(E("Math").$gamma(R))),E("Math").$gamma(R)<0?-1:1]}),Q(Z,"$log",function(R,ee){return N(E("String"),R)&&v.$raise(fe(R,E("Float"))),z(null==ee)?E("Math").$checked("log",E("Math")["$float!"](R)):(N(E("String"),ee)&&v.$raise(fe(ee,E("Float"))),G(E("Math").$checked("log",E("Math")["$float!"](R)),E("Math").$checked("log",E("Math")["$float!"](ee))))},-2),Q(Z,"$log10",function(R){return N(E("String"),R)&&v.$raise(fe(R,E("Float"))),E("Math").$checked("log10",E("Math")["$float!"](R))}),Q(Z,"$log2",function(R){return N(E("String"),R)&&v.$raise(fe(R,E("Float"))),E("Math").$checked("log2",E("Math")["$float!"](R))}),Q(Z,"$tan",function(R){return R=E("Math")["$float!"](R),z(R["$infinite?"]())?E(E("Float"),"NAN"):E("Math").$checked("tan",E("Math")["$float!"](R))})},Opal.modules["corelib/complex/base"]=function(T){var z,I,Q,U,Ce=T.truthy,f=T.def,S=T.klass,te=[],v=T.nil;return z=te,Q=[I=(0,T.module)("::","Kernel")].concat(z),U=T.$r(Q),f(I,"$Complex",function(G,re){return null==re&&(re=v),Ce(re)?U("Complex").$new(G,re):U("Complex").$new(G,0)},-2),function(D,z,I){var Q=S("::",null,"String"),U=[Q].concat(I),N=T.$r(U);return f(Q,"$to_c",function(){return N("Complex").$from_string(this)})}(0,0,te)},Opal.modules["corelib/complex"]=function(T){var ee,H,A,M,C,fe=T.klass,Ce=T.truthy,f=T.eqeqeq,S=T.Kernel,te=T.defs,v=T.rb_times,D=T.def,z=T.rb_plus,I=T.rb_minus,Q=T.rb_divide,U=T.eqeq,N=T.to_ary,G=T.rb_gt,re=T.neqeq,q=T.return_val,E=T.const_set,V=T.alias,le=T.top,Y=T.nil,X=T.$$$;return le.$require("corelib/numeric"),le.$require("corelib/complex/base"),ee=[],A=[H=fe("::",X("Numeric"),"Complex")].concat(ee),M=T.$r(A),(C=H.$$prototype).real=C.imag=Y,te(H,"$rect",function(L,ne){return null==ne&&(ne=0),f(X("Numeric"),L)&&Ce(L["$real?"]())&&f(X("Numeric"),ne)&&Ce(ne["$real?"]())||S.$raise(X("TypeError"),"not a real"),this.$new(L,ne)},-2),te(H,"$polar",function(L,ne){return null==ne&&(ne=0),f(X("Numeric"),L)&&Ce(L["$real?"]())&&f(X("Numeric"),ne)&&Ce(ne["$real?"]())||S.$raise(X("TypeError"),"not a real"),this.$new(v(L,X("Math").$cos(ne)),v(L,X("Math").$sin(ne)))},-2),H.$attr_reader("real","imag"),D(H,"$initialize",function(L,ne){var F=this;return null==ne&&(ne=0),F.real=L,F.imag=ne,F.$freeze()},-2),D(H,"$coerce",function(L){return f(X("Complex"),L)?[L,this]:f(X("Numeric"),L)&&Ce(L["$real?"]())?[X("Complex").$new(L,0),this]:S.$raise(X("TypeError"),L.$class()+" can't be coerced into Complex")}),D(H,"$==",function(L){var ne=this,F=Y;return f(X("Complex"),L)?Ce(F=ne.real["$=="](L.$real()))?ne.imag["$=="](L.$imag()):F:f(X("Numeric"),L)&&Ce(L["$real?"]())?Ce(F=ne.real["$=="](L))?ne.imag["$=="](0):F:L["$=="](ne)}),D(H,"$-@",function(){return S.$Complex(this.real["$-@"](),this.imag["$-@"]())}),D(H,"$+",function(L){var ne=this;return f(X("Complex"),L)?S.$Complex(z(ne.real,L.$real()),z(ne.imag,L.$imag())):f(X("Numeric"),L)&&Ce(L["$real?"]())?S.$Complex(z(ne.real,L),ne.imag):ne.$__coerced__("+",L)}),D(H,"$-",function(L){var ne=this;return f(X("Complex"),L)?S.$Complex(I(ne.real,L.$real()),I(ne.imag,L.$imag())):f(X("Numeric"),L)&&Ce(L["$real?"]())?S.$Complex(I(ne.real,L),ne.imag):ne.$__coerced__("-",L)}),D(H,"$*",function(L){var ne=this;return f(X("Complex"),L)?S.$Complex(I(v(ne.real,L.$real()),v(ne.imag,L.$imag())),z(v(ne.real,L.$imag()),v(ne.imag,L.$real()))):f(X("Numeric"),L)&&Ce(L["$real?"]())?S.$Complex(v(ne.real,L),v(ne.imag,L)):ne.$__coerced__("*",L)}),D(H,"$/",function(L){var ne=this;return f(X("Complex"),L)?f(X("Number"),ne.real)&&Ce(ne.real["$nan?"]())||f(X("Number"),ne.imag)&&Ce(ne.imag["$nan?"]())||f(X("Number"),L.$real())&&Ce(L.$real()["$nan?"]())||f(X("Number"),L.$imag())&&Ce(L.$imag()["$nan?"]())?X("Complex").$new(X(X("Float"),"NAN"),X(X("Float"),"NAN")):Q(v(ne,L.$conj()),L.$abs2()):f(X("Numeric"),L)&&Ce(L["$real?"]())?S.$Complex(ne.real.$quo(L),ne.imag.$quo(L)):ne.$__coerced__("/",L)}),D(H,"$**",function(L){var ne,F,he=this,B=Y,O=Y,m=Y,l=Y,c=Y,h=Y,d=Y,p=Y,_=Y,x=Y,$=Y;if(U(L,0))return X("Complex").$new(1,0);if(f(X("Complex"),L))return F=he.$polar(),B=null==(ne=N(F))[0]?Y:ne[0],O=null==ne[1]?Y:ne[1],m=L.$real(),l=L.$imag(),c=X("Math").$exp(I(v(m,X("Math").$log(B)),v(l,O))),h=z(v(O,m),v(l,X("Math").$log(B))),X("Complex").$polar(c,h);if(f(X("Integer"),L)){if(Ce(G(L,0))){for(p=d=he,_=I(L,1);re(_,0);){for(F=_.$divmod(2),x=null==(ne=N(F))[0]?Y:ne[0],$=null==ne[1]?Y:ne[1];U($,0);)d=S.$Complex(I(v(d.$real(),d.$real()),v(d.$imag(),d.$imag())),v(v(2,d.$real()),d.$imag())),F=(_=x).$divmod(2),x=null==(ne=N(F))[0]?Y:ne[0],$=null==ne[1]?Y:ne[1];p=v(p,d),_=I(_,1)}return p}return Q(X("Rational").$new(1,1),he)["$**"](L["$-@"]())}return f(X("Float"),L)||f(X("Rational"),L)?(F=he.$polar(),B=null==(ne=N(F))[0]?Y:ne[0],O=null==ne[1]?Y:ne[1],X("Complex").$polar(B["$**"](L),v(O,L))):he.$__coerced__("**",L)}),D(H,"$abs",function(){return X("Math").$hypot(this.real,this.imag)}),D(H,"$abs2",function(){var L=this;return z(v(L.real,L.real),v(L.imag,L.imag))}),D(H,"$angle",function(){return X("Math").$atan2(this.imag,this.real)}),D(H,"$conj",function(){return S.$Complex(this.real,this.imag["$-@"]())}),D(H,"$denominator",function(){return this.real.$denominator().$lcm(this.imag.$denominator())}),D(H,"$eql?",function(L){var F,he;return Ce(F=Ce(he=M("Complex")["$==="](L))?this.real.$class()["$=="](this.imag.$class()):he)?this["$=="](L):F}),D(H,"$fdiv",function(L){return f(X("Numeric"),L)||S.$raise(X("TypeError"),L.$class()+" can't be coerced into Complex"),Q(this,L)}),D(H,"$finite?",function(){var ne;return Ce(ne=this.real["$finite?"]())?this.imag["$finite?"]():ne}),D(H,"$hash",function(){return"Complex:"+this.real+":"+this.imag}),D(H,"$infinite?",function(){var ne;return Ce(ne=this.real["$infinite?"]())?ne:this.imag["$infinite?"]()}),D(H,"$inspect",function(){return"("+this+")"}),D(H,"$numerator",function(){var ne,L=this;return ne=L.$denominator(),S.$Complex(v(L.real.$numerator(),Q(ne,L.real.$denominator())),v(L.imag.$numerator(),Q(ne,L.imag.$denominator())))}),D(H,"$polar",function(){return[this.$abs(),this.$arg()]}),D(H,"$rationalize",function(L){var ne=this;return arguments.length>1&&S.$raise(X("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),re(ne.imag,0)&&S.$raise(X("RangeError"),"can't convert "+ne+" into Rational"),ne.$real().$rationalize(L)},-1),D(H,"$real?",q(!1)),D(H,"$rect",function(){return[this.real,this.imag]}),D(H,"$to_f",function(){var L=this;return U(L.imag,0)||S.$raise(X("RangeError"),"can't convert "+L+" into Float"),L.real.$to_f()}),D(H,"$to_i",function(){var L=this;return U(L.imag,0)||S.$raise(X("RangeError"),"can't convert "+L+" into Integer"),L.real.$to_i()}),D(H,"$to_r",function(){var L=this;return U(L.imag,0)||S.$raise(X("RangeError"),"can't convert "+L+" into Rational"),L.real.$to_r()}),D(H,"$to_s",function(){var L=this,ne=Y;return ne=L.real.$inspect(),ne=z(ne,f(X("Number"),L.imag)&&Ce(L.imag["$nan?"]())||Ce(L.imag["$positive?"]())||Ce(L.imag["$zero?"]())?"+":"-"),ne=z(ne,L.imag.$abs().$inspect()),f(X("Number"),L.imag)&&(Ce(L.imag["$nan?"]())||Ce(L.imag["$infinite?"]()))&&(ne=z(ne,"*")),z(ne,"i")}),E(A[0],"I",H.$new(0,1)),te(H,"$from_string",function(L){var he,B,ne=/[+-]?[\d_]+(\.[\d_]+)?(e\d+)?/;function m(){return ne.test(L)}function l(){var d=L.match(ne)[0];return L=L.slice(d.length),d.replace(/_/g,"")}function c(){if(m()){var h=parseFloat(l());if("/"===L[0]){if(L=L.slice(1),m()){var d=parseFloat(l());return S.$Rational(h,d)}return L="/"+L,h}return h}return null}return L.match(ne),(he=c())?(B=c())?S.$Complex(he,B):"i"===L[0]?S.$Complex(0,he):S.$Complex(he,0):S.$Complex(0,"i"===L[0]?1:"-"===L[0]&&"i"===L[1]?-1:"+"===L[0]&&"i"===L[1]?1:0)}),V(T.get_singleton_class(H),"rectangular","rect"),V(H,"arg","angle"),V(H,"conjugate","conj"),V(H,"divide","/"),V(H,"imaginary","imag"),V(H,"magnitude","abs"),V(H,"phase","arg"),V(H,"quo","/"),V(H,"rectangular","rect"),T.udef(H,"$negative?"),T.udef(H,"$positive?"),T.udef(H,"$step"),Y},Opal.modules["corelib/rational/base"]=function(T){var Ce=T.def,f=T.klass,te=T.$$$;return Ce((0,T.module)("::","Kernel"),"$Rational",function(I,Q){return null==Q&&(Q=1),te("Rational").$convert(I,Q)},-2),Ce(f("::",null,"String"),"$to_r",function(){return te("Rational").$from_string(this)})},Opal.modules["corelib/rational"]=function(T){var H,A,fe=T.klass,Ce=T.eqeq,f=T.Kernel,S=T.truthy,te=T.rb_lt,v=T.rb_divide,D=T.defs,z=T.eqeqeq,I=T.not,Q=T.Opal,U=T.def,N=T.return_ivar,G=T.rb_minus,re=T.rb_times,q=T.rb_plus,E=T.rb_gt,V=T.rb_le,le=T.return_self,Z=T.alias,Y=T.top,X=T.nil,k=T.$$$;return Y.$require("corelib/numeric"),Y.$require("corelib/rational/base"),(A=(H=fe("::",k("Numeric"),"Rational")).$$prototype).num=A.den=X,D(H,"$reduce",function(C,P){var ne;if(C=C.$to_i(),P=P.$to_i(),Ce(P,0))f.$raise(k("ZeroDivisionError"),"divided by 0");else if(S(te(P,0)))C=C["$-@"](),P=P["$-@"]();else if(Ce(P,1))return this.$new(C,P);return ne=C.$gcd(P),this.$new(v(C,ne),v(P,ne))}),D(H,"$convert",function(C,P){return(S(C["$nil?"]())||S(P["$nil?"]()))&&f.$raise(k("TypeError"),"cannot convert nil into Rational"),z(k("Integer"),C)&&z(k("Integer"),P)?this.$reduce(C,P):((z(k("Float"),C)||z(k("String"),C)||z(k("Complex"),C))&&(C=C.$to_r()),(z(k("Float"),P)||z(k("String"),P)||z(k("Complex"),P))&&(P=P.$to_r()),S(P["$equal?"](1))&&I(k("Integer")["$==="](C))?Q["$coerce_to!"](C,k("Rational"),"to_r"):z(k("Numeric"),C)&&z(k("Numeric"),P)?v(C,P):this.$reduce(C,P))}),U(H,"$initialize",function(C,P){var L=this;return L.num=C,L.den=P,L.$freeze()}),U(H,"$numerator",N("num")),U(H,"$denominator",N("den")),U(H,"$coerce",function(C){var L,P=this;return z(k("Rational"),L=C)?[C,P]:z(k("Integer"),L)?[C.$to_r(),P]:z(k("Float"),L)?[C,P.$to_f()]:X}),U(H,"$==",function(C){var L,P=this,ne=X;return z(k("Rational"),L=C)?S(ne=P.num["$=="](C.$numerator()))?P.den["$=="](C.$denominator()):ne:z(k("Integer"),L)?S(ne=P.num["$=="](C))?P.den["$=="](1):ne:z(k("Float"),L)?P.$to_f()["$=="](C):C["$=="](P)}),U(H,"$<=>",function(C){var L,P=this;return z(k("Rational"),L=C)?G(re(P.num,C.$denominator()),re(P.den,C.$numerator()))["$<=>"](0):z(k("Integer"),L)?G(P.num,re(P.den,C))["$<=>"](0):z(k("Float"),L)?P.$to_f()["$<=>"](C):P.$__coerced__("<=>",C)}),U(H,"$+",function(C){var L,P=this,ne=X,F=X;return z(k("Rational"),L=C)?(ne=q(re(P.num,C.$denominator()),re(P.den,C.$numerator())),F=re(P.den,C.$denominator()),f.$Rational(ne,F)):z(k("Integer"),L)?f.$Rational(q(P.num,re(C,P.den)),P.den):z(k("Float"),L)?q(P.$to_f(),C):P.$__coerced__("+",C)}),U(H,"$-",function(C){var L,P=this,ne=X,F=X;return z(k("Rational"),L=C)?(ne=G(re(P.num,C.$denominator()),re(P.den,C.$numerator())),F=re(P.den,C.$denominator()),f.$Rational(ne,F)):z(k("Integer"),L)?f.$Rational(G(P.num,re(C,P.den)),P.den):z(k("Float"),L)?G(P.$to_f(),C):P.$__coerced__("-",C)}),U(H,"$*",function(C){var L,P=this,ne=X,F=X;return z(k("Rational"),L=C)?(ne=re(P.num,C.$numerator()),F=re(P.den,C.$denominator()),f.$Rational(ne,F)):z(k("Integer"),L)?f.$Rational(re(P.num,C),P.den):z(k("Float"),L)?re(P.$to_f(),C):P.$__coerced__("*",C)}),U(H,"$/",function(C){var L,P=this,ne=X,F=X;return z(k("Rational"),L=C)?(ne=re(P.num,C.$denominator()),F=re(P.den,C.$numerator()),f.$Rational(ne,F)):z(k("Integer"),L)?Ce(C,0)?v(P.$to_f(),0):f.$Rational(P.num,re(P.den,C)):z(k("Float"),L)?v(P.$to_f(),C):P.$__coerced__("/",C)}),U(H,"$**",function(C){var L,P=this;return z(k("Integer"),L=C)?Ce(P,0)&&S(te(C,0))?k(k("Float"),"INFINITY"):S(E(C,0))?f.$Rational(P.num["$**"](C),P.den["$**"](C)):S(te(C,0))?f.$Rational(P.den["$**"](C["$-@"]()),P.num["$**"](C["$-@"]())):f.$Rational(1,1):z(k("Float"),L)?P.$to_f()["$**"](C):z(k("Rational"),L)?Ce(C,0)?f.$Rational(1,1):Ce(C.$denominator(),1)?S(te(C,0))?f.$Rational(P.den["$**"](C.$numerator().$abs()),P.num["$**"](C.$numerator().$abs())):f.$Rational(P.num["$**"](C.$numerator()),P.den["$**"](C.$numerator())):Ce(P,0)&&S(te(C,0))?f.$raise(k("ZeroDivisionError"),"divided by 0"):P.$to_f()["$**"](C):P.$__coerced__("**",C)}),U(H,"$abs",function(){return f.$Rational(this.num.$abs(),this.den.$abs())}),U(H,"$ceil",function(C){var P=this;return null==C&&(C=0),Ce(C,0)?v(P.num["$-@"](),P.den)["$-@"]().$ceil():P.$with_precision("ceil",C)},-1),U(H,"$floor",function(C){var P=this;return null==C&&(C=0),Ce(C,0)?v(P.num["$-@"](),P.den)["$-@"]().$floor():P.$with_precision("floor",C)},-1),U(H,"$hash",function(){return"Rational:"+this.num+":"+this.den}),U(H,"$inspect",function(){return"("+this+")"}),U(H,"$rationalize",function(C){var P=this;if(arguments.length>1&&f.$raise(k("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),null==C)return P;for(var l,c,h,d,p,L=C.$abs(),ne=G(P,L),F=q(P,L),he=0,B=1,O=1,m=0;h=ne.$ceil(),!V(h,F);)l=(d=h-1)*B+he,c=d*m+O,p=v(1,G(F,d)),F=v(1,G(ne,d)),ne=p,he=B,O=m,B=l,m=c;return f.$Rational(h*B+he,h*m+O)},-1),U(H,"$round",function(C){var P=this,L=X,ne=X,F=X;return null==C&&(C=0),Ce(C,0)?Ce(P.num,0)?0:Ce(P.den,1)?P.num:(L=q(re(P.num.$abs(),2),P.den),ne=re(P.den,2),F=v(L,ne).$truncate(),S(te(P.num,0))?F["$-@"]():F):P.$with_precision("round",C)},-1),U(H,"$to_f",function(){return v(this.num,this.den)}),U(H,"$to_i",function(){return this.$truncate()}),U(H,"$to_r",le),U(H,"$to_s",function(){return this.num+"/"+this.den}),U(H,"$truncate",function(C){var P=this;return null==C&&(C=0),Ce(C,0)?S(te(P.num,0))?P.$ceil():P.$floor():P.$with_precision("truncate",C)},-1),U(H,"$with_precision",function(C,P){var ne,F=X;return z(k("Integer"),P)||f.$raise(k("TypeError"),"not an Integer"),ne=10["$**"](P),F=re(this,ne),S(te(P,1))?v(F.$send(C),ne).$to_i():f.$Rational(F.$send(C),ne)}),D(H,"$from_string",function(C){var F,he,P=C.trimLeft(),L=/^[+-]?[\d_]+(\.[\d_]+)?/;function B(){return L.test(P)}function O(){var l=P.match(L)[0];return P=P.slice(l.length),l.replace(/_/g,"")}return P.match(L),B()?(F=parseFloat(O()),"/"===P[0]?(P=P.slice(1),B()?(he=parseFloat(O()),f.$Rational(F,he)):f.$Rational(F,1)):f.$Rational(F,1)):f.$Rational(0,1)}),Z(H,"divide","/"),Z(H,"quo","/")},Opal.modules["corelib/time"]=function(T){var fe=T.slice,Ce=T.deny_frozen_access,f=T.klass,S=T.Kernel,te=T.Opal,v=T.defs,D=T.eqeqeq,z=T.def,I=T.truthy,Q=T.rb_gt,U=T.rb_lt,N=T.send,G=T.rb_plus,re=T.rb_divide,q=T.rb_minus,E=T.range,V=T.neqeq,le=T.rb_le,Z=T.eqeq,Y=T.alias,R=T.nil,ee=T.$$$;return T.top.$require("corelib/comparable"),function(H,A,M){var C=f("::",A,"Time"),P=[C].concat([]),L=T.$r(P);C.$include(ee("Comparable"));var m,ne=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],F=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],he=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],B=["January","February","March","April","May","June","July","August","September","October","November","December"];function O(m,l,c,h,d,p){if(m=m.$$is_string?parseInt(m,10):te["$coerce_to!"](m,ee("Integer"),"to_int"),l===R)l=1;else if(!l.$$is_number)if(l["$respond_to?"]("to_str"))switch(l=l.$to_str(),l.toLowerCase()){case"jan":l=1;break;case"feb":l=2;break;case"mar":l=3;break;case"apr":l=4;break;case"may":l=5;break;case"jun":l=6;break;case"jul":l=7;break;case"aug":l=8;break;case"sep":l=9;break;case"oct":l=10;break;case"nov":l=11;break;case"dec":l=12;break;default:l=l.$to_i()}else l=te["$coerce_to!"](l,ee("Integer"),"to_int");return(l<1||l>12)&&S.$raise(ee("ArgumentError"),"month out of range: "+l),l-=1,((c=c===R?1:c.$$is_string?parseInt(c,10):te["$coerce_to!"](c,ee("Integer"),"to_int"))<1||c>31)&&S.$raise(ee("ArgumentError"),"day out of range: "+c),((h=h===R?0:h.$$is_string?parseInt(h,10):te["$coerce_to!"](h,ee("Integer"),"to_int"))<0||h>24)&&S.$raise(ee("ArgumentError"),"hour out of range: "+h),((d=d===R?0:d.$$is_string?parseInt(d,10):te["$coerce_to!"](d,ee("Integer"),"to_int"))<0||d>59)&&S.$raise(ee("ArgumentError"),"min out of range: "+d),p===R?p=0:p.$$is_number||(p=p.$$is_string?parseInt(p,10):te["$coerce_to!"](p,ee("Integer"),"to_int")),(p<0||p>60)&&S.$raise(ee("ArgumentError"),"sec out of range: "+p),[m,l,c,h,d,p]}return v(C,"$at",function(l,c){var h;return ee("Time")["$==="](l)?(void 0!==c&&S.$raise(ee("TypeError"),"can't convert Time into an exact number"),(h=new Date(l.getTime())).timezone=l.timezone,h):(l.$$is_number||(l=te["$coerce_to!"](l,ee("Integer"),"to_int")),void 0===c?new Date(1e3*l):(c.$$is_number||(c=te["$coerce_to!"](c,ee("Integer"),"to_int")),new Date(1e3*l+c/1e3)))},-2),v(C,"$new",function(l,c,h,d,p,_,x){var se,ae,Te,Ae;return null==c&&(c=R),null==h&&(h=R),null==d&&(d=R),null==p&&(p=R),null==_&&(_=R),null==x&&(x=R),void 0===l?new Date:(l=(se=O(l,c,h,d,p,_))[0],c=se[1],h=se[2],d=se[3],p=se[4],_=se[5],x===R?(ae=new Date(l,c,h,d,p,0,1e3*_),l<100&&ae.setFullYear(l),ae):(Te=this.$_parse_offset(x),Ae=new Date(Date.UTC(l,c,h,d,p,0,1e3*_)),l<100&&Ae.setUTCFullYear(l),(ae=new Date(Ae.getTime()-36e5*Te)).timezone=Te,ae))},-1),v(C,"$_parse_offset",function(l){var c;return l.$$is_string?"UTC"==l?c=0:/^[+-]\d\d:[0-5]\d$/.test(l)?c=("-"==l[0]?-1:1)*(+(l[1]+l[2])+ +(l[4]+l[5])/60):S.$raise(ee("ArgumentError"),'"+HH:MM", "-HH:MM", "UTC" expected for utc_offset: '+l):l.$$is_number?c=l/3600:S.$raise(ee("ArgumentError"),"Opal doesn't support other types for a timezone argument than Integer and String"),c}),v(C,"$local",function(l,c,h,d,p,_,x,$,se,ae){var Te,Ae;return null==c&&(c=R),null==h&&(h=R),null==d&&(d=R),null==p&&(p=R),null==_&&(_=R),null==x&&(x=R),null==$&&($=R),null==se&&(se=R),null==ae&&(ae=R),10===arguments.length&&(l=(Te=fe(arguments))[5],c=Te[4],h=Te[3],d=Te[2],p=Te[1],_=Te[0]),l=(Te=O(l,c,h,d,p,_))[0],c=Te[1],h=Te[2],d=Te[3],p=Te[4],_=Te[5],Ae=new Date(l,c,h,d,p,0,1e3*_),l<100&&Ae.setFullYear(l),Ae},-2),v(C,"$gm",function(l,c,h,d,p,_,x,$,se,ae){var Te,Ae;return null==c&&(c=R),null==h&&(h=R),null==d&&(d=R),null==p&&(p=R),null==_&&(_=R),null==x&&(x=R),null==$&&($=R),null==se&&(se=R),null==ae&&(ae=R),10===arguments.length&&(l=(Te=fe(arguments))[5],c=Te[4],h=Te[3],d=Te[2],p=Te[1],_=Te[0]),l=(Te=O(l,c,h,d,p,_))[0],c=Te[1],h=Te[2],d=Te[3],p=Te[4],_=Te[5],Ae=new Date(Date.UTC(l,c,h,d,p,0,1e3*_)),l<100&&Ae.setUTCFullYear(l),Ae.timezone=0,Ae},-2),v(C,"$now",function(){return this.$new()}),z(C,"$+",function(l){D(ee("Time"),l)&&S.$raise(ee("TypeError"),"time + time?"),l.$$is_number||(l=te["$coerce_to!"](l,ee("Integer"),"to_int"));var h=new Date(this.getTime()+1e3*l);return h.timezone=this.timezone,h}),z(C,"$-",function(l){var c=this;if(D(ee("Time"),l))return(c.getTime()-l.getTime())/1e3;l.$$is_number||(l=te["$coerce_to!"](l,ee("Integer"),"to_int"));var h=new Date(c.getTime()-1e3*l);return h.timezone=c.timezone,h}),z(C,"$<=>",function(l){var h=R;return D(ee("Time"),l)?this.$to_f()["$<=>"](l.$to_f()):(h=l["$<=>"](this),I(h["$nil?"]())?R:I(Q(h,0))?-1:I(U(h,0))?1:0)}),z(C,"$==",function(l){var h;return I(h=ee("Time")["$==="](l))?this.$to_f()===l.$to_f():h}),z(C,"$asctime",function(){return this.$strftime("%a %b %e %H:%M:%S %Y")}),N([["year","getFullYear","getUTCFullYear"],["mon","getMonth","getUTCMonth",1],["wday","getDay","getUTCDay"],["day","getDate","getUTCDate"],["hour","getHours","getUTCHours"],["min","getMinutes","getUTCMinutes"],["sec","getSeconds","getUTCSeconds"]],"each",[],function m(l,c,h,d){var p=null==m.$$s?this:m.$$s;return null==l&&(l=R),null==c&&(c=R),null==h&&(h=R),null==d&&(d=0),N(p,"define_method",[l],function _(){var x=null==_.$$s?this:_.$$s;return d+(null!=x.timezone?new Date(x.getTime()+36e5*x.timezone)[h]():x[c]())},{$$s:p})},{$$arity:-4,$$s:C}),z(C,"$yday",function(){var c,h,l=this;return c=L("Time").$new(l.$year()).$to_i(),h=L("Time").$new(l.$year(),l.$month(),l.$day()).$to_i(),G(re(q(h,c),86400).$round(),1)}),z(C,"$isdst",function(){var l=this,c=new Date(l.getFullYear(),0,1),h=new Date(l.getFullYear(),6,1);return l.getTimezoneOffset()<Math.max(c.getTimezoneOffset(),h.getTimezoneOffset())}),z(C,"$dup",function(){var l=this,c=R;return(c=new Date(l.getTime())).$copy_instance_variables(l),c.$initialize_dup(l),c}),z(C,"$eql?",function(l){var h;return I(h=l["$is_a?"](ee("Time")))?this["$<=>"](l)["$zero?"]():h}),N([["sunday?",0],["monday?",1],["tuesday?",2],["wednesday?",3],["thursday?",4],["friday?",5],["saturday?",6]],"each",[],function m(l,c){var h=null==m.$$s?this:m.$$s;return null==l&&(l=R),null==c&&(c=R),N(h,"define_method",[l],function d(){return(null==d.$$s?this:d.$$s).$wday()===c},{$$s:h})},{$$s:C}),z(C,"$hash",function(){return"Time:"+this.getTime()}),z(C,"$inspect",function(){var l=this;return I(l["$utc?"]())?l.$strftime("%Y-%m-%d %H:%M:%S UTC"):l.$strftime("%Y-%m-%d %H:%M:%S %z")}),z(C,"$succ",function(){var c=new Date(this.getTime()+1e3);return c.timezone=this.timezone,c}),z(C,"$usec",function(){return 1e3*this.getMilliseconds()}),z(C,"$zone",function(){var l=this;if(0===l.timezone)return"UTC";if(null!=l.timezone)return R;var h,c=l.toString();return"GMT"==(h=-1==c.indexOf("(")?c.match(/[A-Z]{3,4}/)[0]:c.match(/\((.+)\)(?:\s|$)/)[1])&&/(GMT\W*\d{4})/.test(c)?RegExp.$1:h}),z(C,"$getgm",function(){var c=new Date(this.getTime());return c.timezone=0,c}),z(C,"$gmtime",function(){var l=this;return 0!==l.timezone&&(Ce(l),l.timezone=0),l}),z(C,"$gmt?",function(){return 0===this.timezone}),z(C,"$gmt_offset",function(){var l=this;return null!=l.timezone?60*l.timezone:60*-l.getTimezoneOffset()}),z(C,"$strftime",function(l){var c=this;return l.replace(/%([\-_#^0]*:{0,2})(\d+)?([EO]*)(.)/g,function(h,d,p,_,x){var se,ae,Te,$="",Ae=-1!==d.indexOf("0"),de=-1===d.indexOf("-"),Fe=-1!==d.indexOf("_"),xe=-1!==d.indexOf("^"),ke=-1!==d.indexOf("#"),De=(d.match(":")||[]).length;switch(p=parseInt(p,10),Ae&&Fe&&(d.indexOf("0")<d.indexOf("_")?Ae=!1:Fe=!1),x){case"Y":$+=c.$year();break;case"C":Ae=!Fe,$+=Math.round(c.$year()/100);break;case"y":Ae=!Fe,$+=c.$year()%100;break;case"m":Ae=!Fe,$+=c.$mon();break;case"B":$+=B[c.$mon()-1];break;case"b":case"h":Fe=!Ae,$+=he[c.$mon()-1];break;case"d":Ae=!Fe,$+=c.$day();break;case"e":Fe=!Ae,$+=c.$day();break;case"j":Ae=!Fe,p=isNaN(p)?3:p,$+=c.$yday();break;case"H":Ae=!Fe,$+=c.$hour();break;case"k":Fe=!Ae,$+=c.$hour();break;case"I":Ae=!Fe,$+=c.$hour()%12||12;break;case"l":Fe=!Ae,$+=c.$hour()%12||12;break;case"P":$+=c.$hour()>=12?"pm":"am";break;case"p":$+=c.$hour()>=12?"PM":"AM";break;case"M":Ae=!Fe,$+=c.$min();break;case"S":Ae=!Fe,$+=c.$sec();break;case"L":Ae=!Fe,p=isNaN(p)?3:p,$+=c.getMilliseconds();break;case"N":p=isNaN(p)?9:p,$=($+=c.getMilliseconds().toString().$rjust(3,"0")).$ljust(p,"0");break;case"z":var Me=null==c.timezone?c.getTimezoneOffset():60*-c.timezone,_e=Math.floor(Math.abs(Me)/60),ce=Math.abs(Me)%60;$+=Me<0?"+":"-",$+=_e<10?"0":"",$+=_e,De>0&&($+=":"),$+=ce<10?"0":"",$+=ce,De>1&&($+=":00");break;case"Z":$+=c.$zone();break;case"A":$+=ne[c.$wday()];break;case"a":$+=F[c.$wday()];break;case"u":$+=c.$wday()+1;break;case"w":$+=c.$wday();break;case"V":$+=c.$cweek_cyear()["$[]"](0).$to_s().$rjust(2,"0");break;case"G":$+=c.$cweek_cyear()["$[]"](1);break;case"g":$+=c.$cweek_cyear()["$[]"](1)["$[]"](E(-2,-1,!1));break;case"s":$+=c.$to_i();break;case"n":$+="\n";break;case"t":$+="\t";break;case"%":$+="%";break;case"c":$+=c.$strftime("%a %b %e %T %Y");break;case"D":case"x":$+=c.$strftime("%m/%d/%y");break;case"F":$+=c.$strftime("%Y-%m-%d");break;case"v":$+=c.$strftime("%e-%^b-%4Y");break;case"r":$+=c.$strftime("%I:%M:%S %p");break;case"R":$+=c.$strftime("%H:%M");break;case"T":case"X":$+=c.$strftime("%H:%M:%S");break;case"J":if((se=c.$to_date().$jd())<2405160){$+=c.$strftime("%Y-%m-%d");break}se<2419614?(ae="M",Te=1867):se<2424875?(ae="T",Te=1911):se<2447535?(ae="S",Te=1925):se<2458605?(ae="H",Te=1988):(ae="R",Te=2018),$+=c.$format("%c%02d",ae,q(c.$year(),Te)),$+=c.$strftime("-%m-%d");break;default:return h}return xe&&($=$.toUpperCase()),ke&&($=$.replace(/[A-Z]/,function(pe){pe.toLowerCase()}).replace(/[a-z]/,function(pe){pe.toUpperCase()})),de&&(Ae||Fe)&&($=$.$rjust(isNaN(p)?2:p,Fe?" ":"0")),$})}),z(C,"$to_a",function(){var l=this;return[l.$sec(),l.$min(),l.$hour(),l.$day(),l.$month(),l.$year(),l.$wday(),l.$yday(),l.$isdst(),l.$zone()]}),z(C,"$to_f",function(){return this.getTime()/1e3}),z(C,"$to_i",function(){return parseInt(this.getTime()/1e3,10)}),z(C,"$cweek_cyear",function(){var h,l=this,p=R,_=R,x=R,se=R;return h=ee("Time").$new(l.$year(),1,1).$wday(),p=l.$year(),I(le(h,4))&&V(h,0)?_=q(h,1):(_=q(q(h,7),1),Z(_,-8)&&(_=-1)),x=re(G(l.$yday(),_),7).$ceil(),I(le(x,0))?ee("Time").$new(q(l.$year(),1),12,31).$cweek_cyear():(Z(x,53)&&(se=ee("Time").$new(l.$year(),12,31).$wday(),I(le(se,3))&&V(se,0)&&(x=1,p=G(p,1))),[x,p])}),m=T.get_singleton_class(C),Y(m,"mktime","local"),Y(m,"utc","gm"),Y(C,"ctime","asctime"),Y(C,"dst?","isdst"),Y(C,"getutc","getgm"),Y(C,"gmtoff","gmt_offset"),Y(C,"mday","day"),Y(C,"month","mon"),Y(C,"to_s","inspect"),Y(C,"tv_sec","to_i"),Y(C,"tv_usec","usec"),Y(C,"utc","gmtime"),Y(C,"utc?","gmt?"),Y(C,"utc_offset","gmt_offset")}(0,Date)},Opal.modules["corelib/struct"]=function(T){var fe=T.klass,Ce=T.slice,f=T.extract_kwargs,S=T.ensure_kwargs,te=T.truthy,v=T.neqeq,D=T.eqeq,z=T.Opal,I=T.send,Q=T.Class,U=T.to_a,N=T.def,G=T.defs,re=T.Kernel,q=T.hash2,E=T.rb_gt,V=T.rb_minus,le=T.eqeqeq,Z=T.rb_lt,Y=T.rb_ge,X=T.rb_plus,k=T.alias,H=T.nil,A=T.$$$;return T.top.$require("corelib/enumerable"),function(M,C,P){var L=fe("::",null,"Struct"),ne=[L].concat([]),F=T.$r(ne);L.$include(A("Enumerable")),G(L,"$new",function B(O,m,l){var h,d,p,_,c=B.$$p||H,x=this,$=H;if(B.$$p=null,h=Ce(arguments,1),d=f(h),d=S(d),p=h,null==(_=d.$$smap.keyword_init)&&(_=!1),te(O))if(D(O.$class(),A("String"))&&v(O["$[]"](0).$upcase(),O["$[]"](0)))p.$unshift(O),O=H;else try{O=z["$const_name!"](O)}catch(se){if(!T.rescue(se,[A("TypeError"),A("NameError")]))throw se;try{p.$unshift(O),O=H}finally{T.pop_exception()}}return I(p,"map",[],function(ae){return null==ae&&(ae=H),z["$coerce_to!"](ae,A("String"),"to_str")}),$=I(Q,"new",[x],function se(){var Te,ae=null==se.$$s?this:se.$$s;return I(p,"each",[],function Te(Ae){return null==Ae&&(Ae=H),(null==Te.$$s?this:Te.$$s).$define_struct_attribute(Ae)},{$$s:ae}),Te=T.get_singleton_class(ae),N(Te,"$new",function(Fe){var ke,De=this,Me=H;return ke=Ce(arguments),(Me=De.$allocate()).$$data={},I(Me,"initialize",U(ke)),Me},-1),Te.$alias_method("[]","new")},{$$s:x}),te(c)&&I($,"module_eval",[],c.$to_proc()),$.$$keyword_init=_,te(O)&&A("Struct").$const_set(O,$),$},-2),G(L,"$define_struct_attribute",function(O){var m=this;return D(m,A("Struct"))&&re.$raise(A("ArgumentError"),"you cannot define attributes to the Struct class"),m.$members()["$<<"](O),I(m,"define_method",[O],function l(){return(null==l.$$s?this:l.$$s).$$data[O]},{$$s:m}),I(m,"define_method",[O+"="],function l(c){return null==c&&(c=H),(null==l.$$s?this:l.$$s).$$data[O]=c},{$$s:m})}),G(L,"$members",function(){var m,O=this;return null==O.members&&(O.members=H),D(O,A("Struct"))&&re.$raise(A("ArgumentError"),"the Struct class has no members"),O.members=te(m=O.members)?m:[]}),G(L,"$inherited",function(O){var l,m=this;return null==m.members&&(m.members=H),l=m.members,I(O,"instance_eval",[],function c(){return(null==c.$$s?this:c.$$s).members=l},{$$s:m})}),N(L,"$initialize",function(O){var m,l,c=this,h=H,d=H,p=H;return m=Ce(arguments),l=m,te(c.$class().$$keyword_init)?(h=te(d=l.$last())?d:q([],{}),(te(E(l.$length(),1))||te(1===l.length&&!h.$$is_hash))&&re.$raise(A("ArgumentError"),"wrong number of arguments (given "+l.$length()+", expected 0)"),p=V(h.$keys(),c.$class().$members()),te(p["$any?"]())&&re.$raise(A("ArgumentError"),"unknown keywords: "+p.$join(", ")),I(c.$class().$members(),"each",[],function _(x){var $,se=null==_.$$s?this:_.$$s;return null==x&&(x=H),$=[x,h["$[]"](x)],I(se,"[]=",$),$[$.length-1]},{$$s:c})):(te(E(l.$length(),c.$class().$members().$length()))&&re.$raise(A("ArgumentError"),"struct size differs"),I(c.$class().$members(),"each_with_index",[],function _(x,$){var se,ae=null==_.$$s?this:_.$$s;return null==x&&(x=H),null==$&&($=H),se=[x,l["$[]"]($)],I(ae,"[]=",se),se[se.length-1]},{$$s:c}))},-1),N(L,"$initialize_copy",function(O){this.$$data={};var c,h,d,l=Object.keys(O.$$data);for(c=0,h=l.length;c<h;c++)this.$$data[d=l[c]]=O.$$data[d]}),G(L,"$keyword_init?",function(){return this.$$keyword_init}),N(L,"$members",function(){return this.$class().$members()}),N(L,"$hash",function(){return F("Hash").$new(this.$$data).$hash()}),N(L,"$[]",function(O){var m=this;return le(A("Integer"),O)?(te(Z(O,m.$class().$members().$size()["$-@"]()))&&re.$raise(A("IndexError"),"offset "+O+" too small for struct(size:"+m.$class().$members().$size()+")"),te(Y(O,m.$class().$members().$size()))&&re.$raise(A("IndexError"),"offset "+O+" too large for struct(size:"+m.$class().$members().$size()+")"),O=m.$class().$members()["$[]"](O)):le(A("String"),O)?m.$$data.hasOwnProperty(O)||re.$raise(A("NameError").$new("no member '"+O+"' in struct",O)):re.$raise(A("TypeError"),"no implicit conversion of "+O.$class()+" into Integer"),O=z["$coerce_to!"](O,A("String"),"to_str"),m.$$data[O]}),N(L,"$[]=",function(O,m){var l=this;return le(A("Integer"),O)?(te(Z(O,l.$class().$members().$size()["$-@"]()))&&re.$raise(A("IndexError"),"offset "+O+" too small for struct(size:"+l.$class().$members().$size()+")"),te(Y(O,l.$class().$members().$size()))&&re.$raise(A("IndexError"),"offset "+O+" too large for struct(size:"+l.$class().$members().$size()+")"),O=l.$class().$members()["$[]"](O)):le(A("String"),O)?te(l.$class().$members()["$include?"](O.$to_sym()))||re.$raise(A("NameError").$new("no member '"+O+"' in struct",O)):re.$raise(A("TypeError"),"no implicit conversion of "+O.$class()+" into Integer"),O=z["$coerce_to!"](O,A("String"),"to_str"),l.$$data[O]=m}),N(L,"$==",function(O){if(!te(O["$instance_of?"](this.$class())))return!1;var l={},c={};return function h(d,p){var _,x,$;for(_ in l[d.$__id__()]=!0,c[p.$__id__()]=!0,d.$$data)if(x=d.$$data[_],$=p.$$data[_],A("Struct")["$==="](x)){if(!(l.hasOwnProperty(x.$__id__())&&c.hasOwnProperty($.$__id__())||h(x,$)))return!1}else if(!x["$=="]($))return!1;return!0}(this,O)}),N(L,"$eql?",function(O){if(!te(O["$instance_of?"](this.$class())))return!1;var l={},c={};return function h(d,p){var _,x,$;for(_ in l[d.$__id__()]=!0,c[p.$__id__()]=!0,d.$$data)if(x=d.$$data[_],$=p.$$data[_],A("Struct")["$==="](x)){if(!(l.hasOwnProperty(x.$__id__())&&c.hasOwnProperty($.$__id__())||h(x,$)))return!1}else if(!x["$eql?"]($))return!1;return!0}(this,O)}),N(L,"$each",function B(){var O=B.$$p||H,m=this;return B.$$p=null,O===H?I(m,"enum_for",["each"],function l(){return(null==l.$$s?this:l.$$s).$size()},{$$s:m}):(I(m.$class().$members(),"each",[],function l(c){return null==c&&(c=H),T.yield1(O,(null==l.$$s?this:l.$$s)["$[]"](c))},{$$s:m}),m)}),N(L,"$each_pair",function B(){var O=B.$$p||H,m=this;return B.$$p=null,O===H?I(m,"enum_for",["each_pair"],function l(){return(null==l.$$s?this:l.$$s).$size()},{$$s:m}):(I(m.$class().$members(),"each",[],function l(c){return null==c&&(c=H),T.yield1(O,[c,(null==l.$$s?this:l.$$s)["$[]"](c)])},{$$s:m}),m)}),N(L,"$length",function(){return this.$class().$members().$length()}),N(L,"$to_a",function(){return I(this.$class().$members(),"map",[],function m(l){return null==l&&(l=H),(null==m.$$s?this:m.$$s)["$[]"](l)},{$$s:this})});var he=[];return N(L,"$inspect",function(){var O=this,m=H,l=H;return function(){try{return m="#<struct ",te(he["$include?"](O.$__id__()))?X(m,":...>"):(he["$<<"](O.$__id__()),l=!0,le(A("Struct"),O)&&te(O.$class().$name())&&(m=X(m,O.$class()+" ")),m=X(m,I(O.$each_pair(),"map",[],function(h,d){return null==h&&(h=H),null==d&&(d=H),h+"="+F("Opal").$inspect(d)}).$join(", ")),m=X(m,">"))}finally{te(l)&&he.pop()}}()}),N(L,"$to_h",function B(){var O=B.$$p||H,m=this;return B.$$p=null,O!==H?I(I(m,"map",[],O.$to_proc()),"to_h",U(m.$args())):I(m.$class().$members(),"each_with_object",[q([],{})],function l(c,h){var d;return null==c&&(c=H),null==h&&(h=H),d=[c,(null==l.$$s?this:l.$$s)["$[]"](c)],I(h,"[]=",d),d[d.length-1]},{$$s:m})}),N(L,"$values_at",function(O){var m,l,c=this;m=Ce(arguments);for(var h=[],d=0,p=(l=I(l=m,"map",[],function(x){return null==x&&(x=H),x.$$is_range?x.$to_a():x}).$flatten()).length;d<p;d++)l[d].$$is_number||re.$raise(A("TypeError"),"no implicit conversion of "+l[d].$class()+" into Integer"),h.push(c["$[]"](l[d]));return h},-1),N(L,"$dig",function(O,m){var c,h=this,d=H;return c=Ce(arguments,1),(d=te(O.$$is_string&&h.$$data.hasOwnProperty(O))&&h.$$data[O]||H)===H||0===c.length?d:(te(d["$respond_to?"]("dig"))||re.$raise(A("TypeError"),d.$class()+" does not have #dig method"),I(d,"dig",U(c)))},-2),k(L,"size","length"),k(L,"to_s","inspect"),k(L,"values","to_a")}()},Opal.modules["corelib/set"]=function(T){var fe=T.freeze,Ce=T.klass,f=T.slice,S=T.defs,te=T.hash2,v=T.truthy,D=T.eqeqeq,z=T.Kernel,I=T.send,Q=T.def,U=T.eqeq,N=T.rb_lt,G=T.rb_le,re=T.alias,E=T.nil,V=T.$$$;return function(le,Z,Y){var X=Ce("::",null,"Set"),k=[X].concat([]),R=T.$r(k);function A(M){v(M["$is_a?"](V("Set")))||z.$raise(V("ArgumentError"),"value must be a set")}return X.$$prototype.hash=E,X.$include(V("Enumerable")),S(X,"$[]",function(C){var P,ne=this;return P=f(arguments),ne.$new(P)},-1),Q(X,"$initialize",function M(C){var P=M.$$p||E,L=this;return M.$$p=null,null==C&&(C=E),L.hash=te([],{}),v(C["$nil?"]())?E:(D(V("Enumerable"),C)||z.$raise(V("ArgumentError"),"value must be enumerable"),v(P)?I(C,"each",[],function ne(F){return null==F&&(F=E),(null==ne.$$s?this:ne.$$s).$add(T.yield1(P,F))},{$$s:L}):L.$merge(C))},-1),Q(X,"$dup",function(){return this.$class().$new().$merge(this)}),Q(X,"$-",function(C){return v(C["$respond_to?"]("each"))||z.$raise(V("ArgumentError"),"value must be enumerable"),this.$dup().$subtract(C)}),Q(X,"$inspect",function(){return"#<Set: {"+this.$to_a().$join(",")+"}>"}),Q(X,"$==",function(C){var P=this;return!!v(P["$equal?"](C))||(v(C["$instance_of?"](P.$class()))?P.hash["$=="](C.$instance_variable_get("@hash")):!(!v(C["$is_a?"](V("Set")))||!U(P.$size(),C.$size()))&&I(C,"all?",[],function L(ne){var F=null==L.$$s?this:L.$$s;return null==F.hash&&(F.hash=E),null==ne&&(ne=E),F.hash["$include?"](ne)},{$$s:P}))}),Q(X,"$add",function(C){return this.hash["$[]="](C,!0),this}),Q(X,"$classify",function M(){var C=M.$$p||E,P=this,L=E;return M.$$p=null,C===E?P.$enum_for("classify"):(L=I(V("Hash"),"new",[],function ne(F,he){var B;return null==F&&(F=E),null==he&&(he=E),B=[he,(null==ne.$$s?this:ne.$$s).$class().$new()],I(F,"[]=",B),B[B.length-1]},{$$s:P}),I(P,"each",[],function(F){return null==F&&(F=E),L["$[]"](T.yield1(C,F)).$add(F)}),L)}),Q(X,"$collect!",function M(){var C=M.$$p||E,P=this,L=E;return M.$$p=null,C===E?P.$enum_for("collect!"):(L=P.$class().$new(),I(P,"each",[],function(F){return null==F&&(F=E),L["$<<"](T.yield1(C,F))}),P.$replace(L))}),Q(X,"$compare_by_identity",function(){var C=this;return v(C.hash["$respond_to?"]("compare_by_identity"))?(C.hash.$compare_by_identity(),C):C.$raise(R("NotImplementedError"),C.$class().$name()+"#compare_by_identity is not implemented")}),Q(X,"$compare_by_identity?",function(){var P;return v(P=this.hash["$respond_to?"]("compare_by_identity?"))?this.hash["$compare_by_identity?"]():P}),Q(X,"$delete",function(C){return this.hash.$delete(C),this}),Q(X,"$delete?",function(C){var P=this;return v(P["$include?"](C))?(P.$delete(C),P):E}),Q(X,"$delete_if",function M(){var C=M.$$p||E,P=this;return M.$$p=null,C===E?P.$enum_for("delete_if"):(I(I(P,"select",[],function(ne){return null==ne&&(ne=E),T.yield1(C,ne)}),"each",[],function L(ne){var F=null==L.$$s?this:L.$$s;return null==F.hash&&(F.hash=E),null==ne&&(ne=E),F.hash.$delete(ne)},{$$s:P}),P)}),Q(X,"$freeze",function(){var C=this;return v(C["$frozen?"]())?C:(C.hash.$freeze(),fe(C))}),Q(X,"$keep_if",function M(){var C=M.$$p||E,P=this;return M.$$p=null,C===E?P.$enum_for("keep_if"):(I(I(P,"reject",[],function(ne){return null==ne&&(ne=E),T.yield1(C,ne)}),"each",[],function L(ne){var F=null==L.$$s?this:L.$$s;return null==F.hash&&(F.hash=E),null==ne&&(ne=E),F.hash.$delete(ne)},{$$s:P}),P)}),Q(X,"$reject!",function M(){var C=M.$$p||E,P=this,L=E;return M.$$p=null,C===E?P.$enum_for("reject!"):(L=P.$size(),I(P,"delete_if",[],C.$to_proc()),U(P.$size(),L)?E:P)}),Q(X,"$select!",function M(){var C=M.$$p||E,P=this,L=E;return M.$$p=null,C===E?P.$enum_for("select!"):(L=P.$size(),I(P,"keep_if",[],C.$to_proc()),U(P.$size(),L)?E:P)}),Q(X,"$add?",function(C){return v(this["$include?"](C))?E:this.$add(C)}),Q(X,"$each",function M(){var C=M.$$p||E,P=this;return M.$$p=null,C===E?P.$enum_for("each"):(I(P.hash,"each_key",[],C.$to_proc()),P)}),Q(X,"$empty?",function(){return this.hash["$empty?"]()}),Q(X,"$eql?",function(C){return this.hash["$eql?"](I(C,"instance_eval",[],function L(){var ne=null==L.$$s?this:L.$$s;return null==ne.hash&&(ne.hash=E),ne.hash},{$$s:this}))}),Q(X,"$clear",function(){return this.hash.$clear(),this}),Q(X,"$include?",function(C){return this.hash["$include?"](C)}),Q(X,"$merge",function(C){return I(C,"each",[],function L(ne){return null==ne&&(ne=E),(null==L.$$s?this:L.$$s).$add(ne)},{$$s:this}),this}),Q(X,"$replace",function(C){var P=this;return P.$clear(),P.$merge(C),P}),Q(X,"$size",function(){return this.hash.$size()}),Q(X,"$subtract",function(C){return I(C,"each",[],function L(ne){return null==ne&&(ne=E),(null==L.$$s?this:L.$$s).$delete(ne)},{$$s:this}),this}),Q(X,"$|",function(C){return v(C["$respond_to?"]("each"))||z.$raise(V("ArgumentError"),"value must be enumerable"),this.$dup().$merge(C)}),Q(X,"$superset?",function(C){return A(C),!v(N(this.$size(),C.$size()))&&I(C,"all?",[],function L(ne){return null==ne&&(ne=E),(null==L.$$s?this:L.$$s)["$include?"](ne)},{$$s:this})}),Q(X,"$proper_superset?",function(C){return A(C),!v(G(this.$size(),C.$size()))&&I(C,"all?",[],function L(ne){return null==ne&&(ne=E),(null==L.$$s?this:L.$$s)["$include?"](ne)},{$$s:this})}),Q(X,"$subset?",function(C){return A(C),!v(N(C.$size(),this.$size()))&&I(this,"all?",[],function(ne){return null==ne&&(ne=E),C["$include?"](ne)})}),Q(X,"$proper_subset?",function(C){return A(C),!v(G(C.$size(),this.$size()))&&I(this,"all?",[],function(ne){return null==ne&&(ne=E),C["$include?"](ne)})}),Q(X,"$intersect?",function(C){var P=this;return A(C),v(N(P.$size(),C.$size()))?I(P,"any?",[],function(ne){return null==ne&&(ne=E),C["$include?"](ne)}):I(C,"any?",[],function L(ne){return null==ne&&(ne=E),(null==L.$$s?this:L.$$s)["$include?"](ne)},{$$s:P})}),Q(X,"$disjoint?",function(C){return this["$intersect?"](C)["$!"]()}),Q(X,"$to_a",function(){return this.hash.$keys()}),re(X,"+","|"),re(X,"<","proper_subset?"),re(X,"<<","add"),re(X,"<=","subset?"),re(X,">","proper_superset?"),re(X,">=","superset?"),re(X,"difference","-"),re(X,"filter!","select!"),re(X,"length","size"),re(X,"map!","collect!"),re(X,"member?","include?"),re(X,"union","|")}()},Opal.modules["corelib/dir"]=function(T){var G,U,Ce=T.def,f=T.truthy,S=T.alias,v=T.nil,D=T.$$$;return[U=(0,T.klass)("::",null,"Dir")].concat([]),G=T.get_singleton_class(U),Ce(G,"$chdir",function q(E){var V=q.$$p||v,le=v;return q.$$p=null,function(){try{return le=T.current_dir,T.current_dir=E,T.yieldX(V,[])}finally{T.current_dir=le}}()}),Ce(G,"$pwd",function(){return T.current_dir||"."}),Ce(G,"$home",function(){var E;return f(E=D("ENV")["$[]"]("HOME"))?E:"."}),S(G,"getwd","pwd")},Opal.modules["corelib/file"]=function(T){var X,k,R,ee,fe=T.truthy,f=T.const_set,S=T.Opal,te=T.regexp,v=T.rb_plus,D=T.def,z=T.Kernel,I=T.eqeq,Q=T.rb_lt,U=T.rb_minus,N=T.range,G=T.send,re=T.slice,q=T.alias,V=T.nil,le=T.$$$;return X=[],R=[k=(0,T.klass)("::",le("IO"),"File")].concat(X),ee=V,f(R[0],"Separator",f(R[0],"SEPARATOR","/")),f(R[0],"ALT_SEPARATOR",V),f(R[0],"PATH_SEPARATOR",":"),f(R[0],"FNM_SYSCASE",0),ee=/^[a-zA-Z]:(?:\\|\/)/,function(H,A){var M=[H].concat(A),C=T.$r(M);function P(ne){return fe(ne["$respond_to?"]("to_path"))&&(ne=ne.$to_path()),S["$coerce_to!"](ne,le("String"),"to_str")}function L(){return C("ALT_SEPARATOR")===V?T.escape_regexp(C("SEPARATOR")):T.escape_regexp(v(C("SEPARATOR"),C("ALT_SEPARATOR")))}return D(H,"$absolute_path",function(F,he){var B,O,l,c,h,m=V,d=V,p=V,_=V,x=V;null==he&&(he=V),B=C("SEPARATOR"),O=L(),m=[],F=fe(F["$respond_to?"]("to_path"))?F.$to_path():F,F=S["$coerce_to!"](F,le("String"),"to_str"),he=fe(l=he)?l:le("Dir").$pwd(),c=F.substr(0,B.length)===B||ee.test(F),h=he.substr(0,B.length)===B||ee.test(he),fe(c)?(d=F.$split(te(["[",O,"]"])),p=ee.test(F)?"":F.$sub(te(["^([",O,"]+).*$"]),"\\1"),_=!0):(d=v(he.$split(te(["[",O,"]"])),F.$split(te(["[",O,"]"]))),p=ee.test(he)?"":he.$sub(te(["^([",O,"]+).*$"]),"\\1"),_=h);for(var $,se=0,ae=d.length;se<ae;se++)($=d[se])!==V&&(""!==$||0!==m.length&&!_)&&("."!==$||0!==m.length&&!_)&&(".."===$?m.pop():m.push($));return!_&&"."!==d[0]&&m.$unshift("."),x=m.$join(B),fe(_)&&(x=v(p,x)),x},-2),D(H,"$expand_path",function(F,he){var O,m,l=V,c=V,h=V;return null==he&&(he=V),O=C("SEPARATOR"),m=L(),fe("~"===F[0]||he&&"~"===he[0])&&(l=C("Dir").$home(),fe(l)||z.$raise(le("ArgumentError"),"couldn't find HOME environment -- expanding `~'"),c=ee.test(l)?"":l.$sub(te(["^([",m,"]+).*$"]),"\\1"),fe(l["$start_with?"](c))||z.$raise(le("ArgumentError"),"non-absolute home"),l=v(l,O),h=te(["^\\~(?:",O,"|$)"]),F=F.$sub(h,l),fe(he)&&(he=he.$sub(h,l))),this.$absolute_path(F,he)},-2),D(H,"$dirname",function(F,he){var O;if(null==he&&(he=1),I(he,0))return F;fe(Q(he,0))&&z.$raise(le("ArgumentError"),"level can't be negative"),O=L();var l,m=(F=P(F)).match(new RegExp("^["+O+"]"));return l=""===(F=(F=(F=F.replace(new RegExp("["+O+"]+$"),"")).replace(new RegExp("[^"+O+"]+$"),"")).replace(new RegExp("["+O+"]+$"),""))?m?"/":".":F,1==he?l:this.$dirname(l,U(he,1))},-2),D(H,"$basename",function(F,he){var B;return null==he&&(he=V),B=L(),0==(F=P(F)).length||(he=he!==V?S["$coerce_to!"](he,le("String"),"to_str"):null,F=(F=F.replace(new RegExp("(.)["+B+"]*$"),"$1")).replace(new RegExp("^(?:.*["+B+"])?([^"+B+"]+)$"),"$1"),".*"===he?F=F.replace(/\.[^\.]+$/,""):null!==he&&(he=T.escape_regexp(he),F=F.replace(new RegExp(he+"$"),""))),F},-2),D(H,"$extname",function(F){var B=V,O=V;return F=P(F),B=this.$basename(F),fe(B["$empty?"]())||(O=B["$[]"](N(1,-1,!1)).$rindex("."),fe(O["$nil?"]())||I(v(O,1),U(B.$length(),1)))?"":B["$[]"](T.Range.$new(v(O,1),-1,!1))}),D(H,"$exist?",function(F){return null!=T.modules[F]}),D(H,"$directory?",function(F){var he=V;for(var B in he=[],T.modules)he.push(B);return F=F.$gsub(te(["(^.",C("SEPARATOR"),"+|",C("SEPARATOR"),"+$)"])),G(he,"find",[],function(m){return null==m&&(m=V),m["$=~"](te(["^",F]))})}),D(H,"$join",function(F){var he,B,O=V;return he=re(arguments),fe((B=he)["$empty?"]())?"":(O="",B=G(B.$flatten().$each_with_index(),"map",[],function(l,c){return null==l&&(l=V),null==c&&(c=V),I(c,0)&&fe(l["$empty?"]())||I(B.$length(),v(c,1))&&fe(l["$empty?"]())?C("SEPARATOR"):l}),B=G(B,"reject",[],"empty?".$to_proc()),G(B,"each_with_index",[],function(l,c){var h=V;return null==l&&(l=V),null==c&&(c=V),h=B["$[]"](v(c,1)),fe(h["$nil?"]())?O=""+O+l:(fe(l["$end_with?"](C("SEPARATOR")))&&fe(h["$start_with?"](C("SEPARATOR")))&&(l=l.$sub(te([C("SEPARATOR"),"+$"]),"")),O=fe(l["$end_with?"](C("SEPARATOR")))||fe(h["$start_with?"](C("SEPARATOR")))?""+O+l:""+O+l+C("SEPARATOR"))}),O)},-1),D(H,"$split",function(F){return F.$split(C("SEPARATOR"))}),q(H,"realpath","expand_path"),q(H,"exists?","exist?")}(T.get_singleton_class(k),R)},Opal.modules["corelib/process/base"]=function(T){var z,fe=T.klass,Ce=T.slice,f=T.defs,S=T.return_val,te=T.nil;return z=fe("::",null,"Signal"),f(z,"$trap",function(Q){return Ce(arguments),te},-1),function(v,D){var z=fe("::",null,"GC");return f(z,"$start",S(te))}()},Opal.modules["corelib/process"]=function(T){var fe=T.module,Ce=T.defs,f=T.truthy,S=T.return_val,te=T.Kernel,v=T.nil,D=T.$$$;return function(z){var I=fe("::","Process"),Q=v;if(I.__clocks__=[],Ce(I,"$__register_clock__",function(G,re){var q=this;return null==q.__clocks__&&(q.__clocks__=v),q.$const_set(G,q.__clocks__.$size()),q.__clocks__["$<<"](re)}),I.$__register_clock__("CLOCK_REALTIME",function(){return Date.now()}),Q=!1,T.global.performance)Q=function(){return performance.now()};else if(T.global.process&&process.hrtime){var U=process.hrtime();Q=function(){var N=process.hrtime(U);return 1e3*N[0]+(N[1]/1e3|0)/1e3}}return f(Q)&&I.$__register_clock__("CLOCK_MONOTONIC",Q),Ce(I,"$pid",S(0)),Ce(I,"$times",function(){var G;return G=D("Time").$now().$to_f(),D(D("Benchmark"),"Tms").$new(G,G,G,G,G)}),Ce(I,"$clock_gettime",function(G,re){var q=this,V=v;null==q.__clocks__&&(q.__clocks__=v),null==re&&(re="float_second"),f(V=q.__clocks__["$[]"](G))||te.$raise(D(D("Errno"),"EINVAL"),"clock_gettime("+G+") "+q.__clocks__["$[]"](G));var le=V();switch(re){case"float_second":return le/1e3;case"float_millisecond":return le/1;case"float_microsecond":return 1e3*le;case"second":return le/1e3|0;case"millisecond":return le/1|0;case"microsecond":return 1e3*le|0;case"nanosecond":return 1e6*le|0;default:te.$raise(D("ArgumentError"),"unexpected unit: "+re)}},-2)}()},Opal.modules["corelib/random/formatter"]=function(T){var re,le,Z,Y,X,q,Ce=T.module,f=T.def,S=T.range,te=T.send,v=T.rb_divide,D=T.Kernel,z=T.Opal,Q=T.nil,U=T.$$$;return re=[],le=[q=(0,T.klass)("::",null,"Random")].concat(re),Y=[Z=Ce(q,"Formatter")].concat(le),X=T.$r(Y),f(Z,"$hex",function(R){null==R&&(R=Q),R=U("Random").$_verify_count(R);for(var H=this.$bytes(R),A="",M=0;M<R;M++)A+=H.charCodeAt(M).toString(16).padStart(2,"0");return A.$encode("US-ASCII")},-1),f(Z,"$random_bytes",function(R){return null==R&&(R=Q),this.$bytes(R)},-1),f(Z,"$base64",function(R){return null==R&&(R=Q),U("Base64").$strict_encode64(this.$random_bytes(R)).$encode("US-ASCII")},-1),f(Z,"$urlsafe_base64",function(R,ee){return null==R&&(R=Q),null==ee&&(ee=!1),U("Base64").$urlsafe_encode64(this.$random_bytes(R),ee).$encode("US-ASCII")},-1),f(Z,"$uuid",function(){var ee=Q;return(ee=this.$hex(16).$split(""))["$[]="](12,"4"),ee["$[]="](16,(3&parseInt(ee["$[]"](16),16)|8).toString(16)),ee=[ee["$[]"](S(0,8,!0)),ee["$[]"](S(8,12,!0)),ee["$[]"](S(12,16,!0)),ee["$[]"](S(16,20,!0)),ee["$[]"](S(20,32,!0))],(ee=te(ee,"map",[],"join".$to_proc())).$join("-")}),f(Z,"$random_float",function(){var ee=Q,H=Q;return ee=this.$bytes(4),H=0,te(4,"times",[],function(M){return null==M&&(M=Q),H=(H=H["$<<"](8))["$|"](ee["$[]"](M).$ord())}),v(H.$abs(),2147483647)}),f(Z,"$random_number",function(R){var ee=this;function H(){return ee.$random_float()}function A(C){return Math.floor(H()*C)}return null==R?H():R.$$is_range?function M(){var C=R.begin,P=R.end;if(C===Q||P===Q)return Q;var L=P-C;return L<0?Q:0===L?C:(P%1==0&&C%1==0&&!R.excl&&L++,A(L)+C)}():R.$$is_number?(R<=0&&D.$raise(U("ArgumentError"),"invalid argument - "+R),R%1==0?A(R):H()*R):((R=z["$coerce_to!"](R,U("Integer"),"to_int"))<=0&&D.$raise(U("ArgumentError"),"invalid argument - "+R),A(R))},-1),f(Z,"$alphanumeric",function(R){var H=Q;return null==R&&(R=Q),R=X("Random").$_verify_count(R),H=te([S("0","9",!1),S("a","z",!1),S("A","Z",!1)],"map",[],"to_a".$to_proc()).$flatten(),te(U("Array"),"new",[R],function A(M){return null==M&&(M=Q),H["$[]"]((null==A.$$s?this:A.$$s).$random_number(H.$length()))},{$$s:this}).$join()},-1),q.$include(U(U("Random"),"Formatter")),q.$extend(U(U("Random"),"Formatter"))},Opal.modules["corelib/random/mersenne_twister"]=function(T){var Q,I,U,fe=T.klass,Ce=T.const_set,f=T.send,te=T.$$$,v=T.nil;return v=function(){var D=624,z=397,G=function(Y,X){return function(Y,X){return 2147483648&Y|2147483647&X}(Y,X)>>>1^(1&X?2567483615:0)};function V(Y){var X;return--Y.left<=0&&function E(Y){var R,X=0,k=Y.state;for(Y.left=D,Y.next=0,R=228;--R;X++)k[X]=k[X+z]^G(k[X+0],k[X+1]);for(R=z;--R;X++)k[X]=k[X+(z-D)]^G(k[X+0],k[X+1]);k[X]=k[X+(z-D)]^G(k[X+0],k[0])}(Y),X=Y.state[Y.next++],X^=X>>>11,X^=X<<7&2636928640,X^=X<<15&4022730752,(X^=X>>>18)>>>0}return{genrand_real:function Z(Y){return function le(Y,X){return(67108864*(Y>>>=5)+(X>>>=6))*(1/9007199254740992)}(V(Y),V(Y))},init:function re(Y){var X={left:0,next:D,state:new Array(D)};return function q(Y,X){var k;for(Y.state[0]=X>>>0,k=1;k<D;k++)Y.state[k]=1812433253*(Y.state[k-1]^Y.state[k-1]>>30>>>0)+k,Y.state[k]&=4294967295;Y.left=1,Y.next=D}(X,Y),X}}}(),I=fe("::",null,"Random"),U=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1,Ce(I,"MERSENNE_TWISTER_GENERATOR",{new_seed:function(){return Math.round(Math.random()*U)},reseed:function(N){return v.init(N)},rand:function(N){return v.genrand_real(N)}}),f(I,"generator=",Q=[te(I,"MERSENNE_TWISTER_GENERATOR")]),Q[Q.length-1]},Opal.modules["corelib/random"]=function(T){var re,fe=T.truthy,Ce=T.klass,f=T.Kernel,S=T.defs,te=T.Opal,v=T.def,D=T.eqeqeq,z=T.send,I=T.top,Q=T.nil,U=T.$$$;return I.$require("corelib/random/formatter"),(re=Ce("::",null,"Random")).$attr_reader("seed","state"),S(re,"$_verify_count",function(E){return fe(E)||(E=16),"number"!=typeof E&&(E=E.$to_int()),E<0&&f.$raise(U("ArgumentError"),"negative string size (or size too big)"),Math.floor(E)}),v(re,"$initialize",function(E){return null==E&&(E=U("Random").$new_seed()),E=te["$coerce_to!"](E,U("Integer"),"to_int"),this.state=E,this.$reseed(E)},-1),v(re,"$reseed",function(E){return this.seed=E,this.$rng=T.$$rand.reseed(E)}),S(re,"$new_seed",function(){return T.$$rand.new_seed()}),S(re,"$rand",function(E){return U(this,"DEFAULT").$rand(E)},-1),S(re,"$srand",function(E){var le;return null==E&&(E=U("Random").$new_seed()),E=te["$coerce_to!"](E,U("Integer"),"to_int"),le=U(this,"DEFAULT").$seed(),U(this,"DEFAULT").$reseed(E),le},-1),S(re,"$urandom",function(E){return U("SecureRandom").$bytes(E)}),v(re,"$==",function(E){var le=Q;return!!D(U("Random"),E)&&(fe(le=this.$seed()["$=="](E.$seed()))?this.$state()["$=="](E.$state()):le)}),v(re,"$bytes",function(E){return E=U("Random").$_verify_count(E),z(U("Array"),"new",[E],function le(){return(null==le.$$s?this:le.$$s).$rand(255).$chr()},{$$s:this}).$join().$encode("ASCII-8BIT")}),S(re,"$bytes",function(E){return U(this,"DEFAULT").$bytes(E)}),v(re,"$rand",function(E){return this.$random_number(E)},-1),v(re,"$random_float",function(){return this.state++,T.$$rand.rand(this.$rng)}),S(re,"$random_float",function(){return U(this,"DEFAULT").$random_float()}),S(re,"$generator=",function(E){var V=this;return T.$$rand=E,fe(V["$const_defined?"]("DEFAULT"))?U(V,"DEFAULT").$reseed():V.$const_set("DEFAULT",V.$new(V.$new_seed()))}),I.$require("corelib/random/mersenne_twister")},Opal.modules["corelib/unsupported"]=function(T){var le,Z,Y,fe=T.Kernel,Ce=T.klass,f=T.send,S=T.slice,te=T.module,v=T.def,D=T.return_val,z=T.alias,I=T.defs,Q=T.top,N=T.nil,G=T.$$$,re={};function q(V){switch(T.config.unsupported_features_severity){case"error":fe.$raise(G("NotImplementedError"),V);break;case"warning":!function E(V){re[V]||(re[V]=!0,Q.$warn(V))}(V)}}return Z=Ce("::",null,"String"),Y="String#%s not supported. Mutable String methods are not supported in Opal.",f(["<<","capitalize!","chomp!","chop!","downcase!","gsub!","lstrip!","next!","reverse!","slice!","squeeze!","strip!","sub!","succ!","swapcase!","tr!","tr_s!","upcase!","prepend","[]=","clear","encode!","unicode_normalize!"],"each",[],function X(k){return null==k&&(k=N),f(null==X.$$s?this:X.$$s,"define_method",[k],function(H){return S(arguments),fe.$raise(G("NotImplementedError"),Y["$%"](k))},-1)},{$$s:Z}),function(V){var le=te("::","Kernel"),Z="Object tainting is not supported by Opal";v(le,"$taint",function(){return q(Z),this}),v(le,"$untaint",function(){return q(Z),this}),v(le,"$tainted?",function(){return q(Z),!1})}(),function(V,le){var Z=Ce("::",null,"Module");v(Z,"$public",function(X){var R,ee=this;return 0===(R=S(arguments)).length?(ee.$$module_function=!1,N):1===R.length?R[0]:R},-1),v(Z,"$private_class_method",function(X){var R;return 1===(R=S(arguments)).length?R[0]:R},-1),v(Z,"$private_method_defined?",D(!1)),v(Z,"$private_constant",function(X){return S(arguments),N},-1),z(Z,"nesting","public"),z(Z,"private","public"),z(Z,"protected","public"),z(Z,"protected_method_defined?","private_method_defined?"),z(Z,"public_class_method","private_class_method"),z(Z,"public_instance_method","instance_method"),z(Z,"public_instance_methods","instance_methods"),z(Z,"public_method_defined?","method_defined?")}(),le=te("::","Kernel"),v(le,"$private_methods",function(Y){return S(arguments),[]},-1),z(le,"protected_methods","private_methods"),z(le,"private_instance_methods","private_methods"),z(le,"protected_instance_methods","private_methods"),function(V,le){var Z=te("::","Kernel"),Y=[Z].concat([]),X=T.$r(Y);v(Z,"$eval",function(R){return S(arguments),fe.$raise(G("NotImplementedError"),"To use Kernel#eval, you must first require 'opal-parser'. See https://github.com/opal/opal/blob/"+X("RUBY_ENGINE_VERSION")+"/docs/opal_parser.md for details.")},-1)}(),I(Q,"$public",function(le){var Y;return 1===(Y=S(arguments)).length?Y[0]:Y},-1),I(Q,"$private",function(le){var Y;return 1===(Y=S(arguments)).length?Y[0]:Y},-1)},Opal.modules["corelib/binding"]=function(T){var Z,Y,Ce=T.truthy,f=T.def,S=T.slice,te=T.send,v=T.to_a,D=T.Kernel,z=T.return_ivar,I=T.eqeq,Q=T.thrower,U=T.module,N=T.const_set,G=T.top,q=T.nil,E=T.$$$;return(Y=(Z=(0,T.klass)("::",null,"Binding")).$$prototype).jseval=Y.scope_variables=q,f(Z,"$initialize",function(k,R,ee,H){var A,M=this;return null==R&&(R=[]),null==H&&(H=q),M.jseval=(A=[k,R,ee,H])[0],M.scope_variables=A[1],M.receiver=A[2],M.source_location=A[3],Ce(void 0!==typeof ee)?q:ee=M.$js_eval("self")},-2),f(Z,"$js_eval",function(k){var ee,H=this;return ee=S(arguments),Ce(H.jseval)?te(H.jseval,"call",v(ee)):D.$raise("Evaluation on a Proc#binding is not supported")},-1),f(Z,"$local_variable_get",function(k){try{return this.$js_eval(k)}catch(ee){if(!T.rescue(ee,[E("Exception")]))throw ee;try{return D.$raise(E("NameError"),"local variable `"+k+"' is not defined for "+this.$inspect())}finally{T.pop_exception()}}}),f(Z,"$local_variable_set",function(k,R){return T.Binding.tmp_value=R,this.$js_eval(k+" = Opal.Binding.tmp_value"),delete T.Binding.tmp_value,R}),f(Z,"$local_variables",z("scope_variables")),f(Z,"$local_variable_defined?",function(k){return this.scope_variables["$include?"](k)}),f(Z,"$eval",function(k,R,ee){try{return Q("eval_return"),null==R&&(R=q),null==ee&&(ee=q),I(k,"self")?this.$receiver():D.$eval(k,this,R,ee)}catch(M){if(M===T.t_eval_return)return M.$v;throw M}},-2),Z.$attr_reader("receiver","source_location"),f(U("::","Kernel"),"$binding",function(){return D.$raise("Opal doesn't support dynamic calls to binding")}),N([][0],"TOPLEVEL_BINDING",E("Binding").$new(function(V){return new Function("self","return "+V)(G)},[],G,["<main>",0]))},Opal.modules["corelib/irb"]=function(T){var X,H,ne,F,A,M,C,R,fe=T.module,Ce=T.truthy,f=T.Kernel,S=T.defs,te=T.hash,v=T.gvars,D=T.lambda,z=T.send,I=T.rb_plus,Q=T.const_set,U=T.klass,N=T.def,G=T.Opal,re=T.range,q=T.eqeq,E=T.thrower,V=[],le=T.nil,Z=T.$$$;X=V,H=R=[fe(V[0],"Opal")].concat(X),M=[A=fe(R[0],"IRB")].concat(H),C=T.$r(M),S(A,"$ensure_loaded",function(L){var F,he;if(Ce(T.loaded_features["$include?"](L)))return le;if(F="https://cdn.opalrb.com/opal/"+(Ce(C("RUBY_ENGINE_VERSION")["$include?"]("dev"))?"master":C("RUBY_ENGINE_VERSION"))+"/"+L+".js","undefined"!=typeof XMLHttpRequest){var B=new XMLHttpRequest;B.open("GET",F,!1),B.send(""),he=B.responseText}else f.$raise("You need to provision "+L+" yourself in this environment");return new Function("Opal",he)(T),T.require(L),Ce(T.loaded_features["$include?"](L))?le:f.$raise("Could not load "+L+" for some reason")}),A.$singleton_class().$attr_accessor("output"),S(A,"$prepare_console",function P(){var L=P.$$p||le,F=this,he=le,B=le;return null==v.stdout&&(v.stdout=le),null==v.stderr&&(v.stderr=le),null==v.stdin&&(v.stdin=le),P.$$p=null,function(){try{return F["$output="](""),he=te(v.stdout,D(function(m){return null==m&&(m=le),v.stdout=m}),v.stderr,D(function(m){return null==m&&(m=le),v.stderr=m})),Ce(F["$browser?"]())&&(z(he,"each",[],function O(m,l){var c=null==O.$$s?this:O.$$s,h=le;return null==m&&(m=le),null==l&&(l=le),(h=m.$dup())["$write_proc="](z(c,"proc",[],function d(p){var _=null==d.$$s?this:d.$$s;return null==p&&(p=le),_["$output="](I(_.$output(),p)),_["$output="](_.$output().$split("\n").$last(30).$join("\n")),Ce(p["$end_with?"]("\n"))&&_["$output="](I(_.$output(),"\n")),m.$write_proc().$call(p)},{$$s:c})),h["$tty="](!1),l.$call(h)},{$$s:F}),B=v.stdin.$read_proc(),v.stdin["$read_proc="](function(O){var m=prompt(F.$output());return null!==m?m+"\n":le})),T.yieldX(L,[])}finally{z(he,"each",[],function(m,l){return null==m&&(m=le),null==l&&(l=le),l.$call(m)}),z(v.stdin,"read_proc=",[B]),z(F,"output=",[""])}}()}),S(A,"$browser?",function(){return"undefined"!=typeof document&&"undefined"!=typeof prompt}),Q(M[0],"LINEBREAKS",["unexpected token $end","unterminated string meets end of file"].$freeze()),(F=(ne=U(M[0],null,"Silencer")).$$prototype).collector=F.stderr=le,N(ne,"$initialize",function(){return null==v.stderr&&(v.stderr=le),this.stderr=v.stderr}),N(ne,"$silence",function he(){var B=he.$$p||le,O=this;return he.$$p=null,function(){try{return O.collector=Z("StringIO").$new(),v.stderr=O.collector,T.yieldX(B,[])}finally{v.stderr=O.stderr}}()}),N(ne,"$warnings",function(){return this.collector.$string()}),function(Y,X,k){var R=U("::",null,"Binding"),ee=[R].concat(k),H=T.$r(ee);N(R,"$irb",function(){try{var M=E("return"),P=le;return Z(G,"IRB").$ensure_loaded("opal-replutils"),P=Z(Z(G,"IRB"),"Silencer").$new(),z(Z(G,"IRB"),"prepare_console",[],function L(){var ne=null==L.$$s?this:L.$$s;return function(){try{var F=E("break");return z(ne,"loop",[],function he(){var B=null==he.$$s?this:he.$$s,O=le,m=le,l=le,c=le,h=le;for(B.$print(">> "),O=B.$gets(),Ce(O)||F.$throw(),m="",Ce(Z(G,"IRB")["$browser?"]())&&B.$puts(O),Ce(O["$start_with?"]("ls "))?(m=O["$[]"](re(3,-1,!1)),l="ls"):q(O,"ls\n")?(m="self",l="ls"):Ce(O["$start_with?"]("show "))?(m=O["$[]"](re(5,-1,!1)),l="show"):(m=O,l="inspect"),c=le;;){try{z(P,"silence",[],function(){return c=T.compile(m,{irb:!0})})}catch(d){if(!T.rescue(d,[H("SyntaxError")]))throw d;h=d;try{if(Ce(Z(Z(G,"IRB"),"LINEBREAKS")["$include?"](h.$message()))){B.$print(".. "),O=B.$gets(),Ce(O)||M.$throw(),Ce(Z(G,"IRB")["$browser?"]())&&B.$puts(O),m=I(m,O);continue}Ce(P.$warnings()["$empty?"]())?B.$warn(h.$full_message()):B.$warn(P.$warnings())}finally{T.pop_exception()}}break}return q(l,"show")&&(B.$puts(c),M.$throw()),B.$puts(Z("REPLUtils").$eval_and_print(c,l,!1,B))},{$$s:ne,$$ret:M})}catch(he){if(he===F)return he.$v;throw he}}()},{$$s:this})}catch(L){if(L===M)return L.$v;throw L}})}(0,0,V),T.irb=function(Y){Z("Binding").$new(Y).$irb()},T.load_parser=function(){T.Opal.IRB.$ensure_loaded("opal-parser")},void 0===T.eval&&(T.eval=function(Y){return T.load_parser(),T.eval(Y)}),void 0===T.compile&&(T.compile=function(Y,X){return T.load_parser(),T.compile(Y,X)})},Opal.queue(function(T){var fe=T.Object;return fe.$require("opal/base"),fe.$require("opal/mini"),fe.$require("corelib/kernel/format"),fe.$require("corelib/string/encoding"),fe.$autoload("Math","corelib/math"),fe.$require("corelib/complex/base"),fe.$autoload("Complex","corelib/complex"),fe.$require("corelib/rational/base"),fe.$autoload("Rational","corelib/rational"),fe.$require("corelib/time"),fe.$autoload("Struct","corelib/struct"),fe.$autoload("Set","corelib/set"),fe.$autoload("Dir","corelib/dir"),fe.$autoload("File","corelib/file"),fe.$require("corelib/process/base"),fe.$autoload("Process","corelib/process"),fe.$autoload("Random","corelib/random"),fe.$require("corelib/unsupported"),fe.$require("corelib/binding"),fe.$require("corelib/irb")}),Opal.queue(function(T){var L,O,m,l,c,ne,F,he,fe=T.module,Ce=T.defs,f=T.slice,S=T.truthy,te=T.send,v=T.Kernel,D=T.extract_kwargs,z=T.ensure_kwargs,I=T.range,Q=T.to_a,U=T.def,N=T.return_ivar,G=T.alias,re=T.klass,q=T.rb_minus,E=T.return_val,V=T.hash2,le=T.send2,Z=T.find_super,Y=T.eqeqeq,X=T.rb_ge,k=T.return_self,R=T.gvars,ee=T.top,H=[],A=T.$r(H),M=T.nil,C=T.$$$;return L=H,F=[ne=fe(H[0],"Native")].concat(L),he=T.$r(F),Ce(ne,"$is_a?",function(O,m){try{return O instanceof this.$try_convert(m)}catch(c){return!1}}),Ce(ne,"$try_convert",function(O,m){return null==m&&(m=M),this["$native?"](O)?O:O["$respond_to?"]("to_n")?O.$to_n():m},-2),Ce(ne,"$convert",function(O){return this["$native?"](O)?O:O["$respond_to?"]("to_n")?O.$to_n():void this.$raise(he("ArgumentError"),O.$inspect()+" isn't native")}),Ce(ne,"$call",function B(O,m,l){var d,c=B.$$p||M,p=this;B.$$p=null,d=f(arguments,2);var _=O[m];if(_ instanceof Function){for(var x=new Array(d.length),$=0,se=d.length;$<se;$++){var ae=d[$],Te=p.$try_convert(ae);x[$]=Te===M?ae:Te}return c!==M&&x.push(c),p.$Native(_.apply(O,x))}return p.$Native(_)},-3),Ce(ne,"$proc",function B(){var O=B.$$p||M;return B.$$p=null,S(O)||this.$raise(he("LocalJumpError"),"no block given"),te(v,"proc",[],function l(c){var h,d,p=null==l.$$s?this:l.$$s,_=M;if(h=f(arguments),te(d=h,"map!",[],function $(se){return null==se&&(se=M),(null==$.$$s?this:$.$$s).$Native(se)},{$$s:p}),_=p.$Native(this),this===T.global)return O.apply(p,d);var x=O.$$s;O.$$s=null;try{return O.apply(_,d)}finally{O.$$s=x}},{$$arity:-1,$$s:this})}),O=F,l=[m=fe(F[0],"Helpers")].concat(O),c=T.$r(l),U(m,"$alias_native",function h(d,p,_){var x,$,se,ae,Ae=this;return h.$$p=null,x=f(arguments,1),$=D(x),$=z($),x.length>0&&(se=x.shift()),null==se&&(se=d),null==(ae=$.$$smap.as)&&(ae=M),S(se["$end_with?"]("="))?te(Ae,"define_method",[d],function de(Fe){var xe=null==de.$$s?this:de.$$s;return null==xe.native&&(xe.native=M),null==Fe&&(Fe=M),xe.native[se["$[]"](I(0,-2,!1))]=c("Native").$convert(Fe),Fe},{$$s:Ae}):S(ae)?te(Ae,"define_method",[d],function de(Fe){var De,xe=de.$$p||M,Me=null==de.$$s?this:de.$$s,_e=M;return null==Me.native&&(Me.native=M),de.$$p=null,De=f(arguments),_e=te(c("Native"),"call",[Me.native,se].concat(Q(De)),xe.$to_proc()),S(_e)?ae.$new(_e.$to_n()):M},{$$arity:-1,$$s:Ae}):te(Ae,"define_method",[d],function de(Fe){var De,xe=de.$$p||M,Me=null==de.$$s?this:de.$$s;return null==Me.native&&(Me.native=M),de.$$p=null,De=f(arguments),te(c("Native"),"call",[Me.native,se].concat(Q(De)),xe.$to_proc())},{$$arity:-1,$$s:Ae})},-2),U(m,"$native_reader",function(d){var p,x=this;return p=f(arguments),te(p,"each",[],function $(se){var ae=null==$.$$s?this:$.$$s;return null==se&&(se=M),te(ae,"define_method",[se],function Te(){var Ae=null==Te.$$s?this:Te.$$s;return null==Ae.native&&(Ae.native=M),Ae.$Native(Ae.native[se])},{$$s:ae})},{$$s:x})},-1),U(m,"$native_writer",function(d){var p,x=this;return p=f(arguments),te(p,"each",[],function $(se){var ae=null==$.$$s?this:$.$$s;return null==se&&(se=M),te(ae,"define_method",[se+"="],function Te(Ae){var de=null==Te.$$s?this:Te.$$s;return null==de.native&&(de.native=M),null==Ae&&(Ae=M),de.$Native(de.native[se]=Ae)},{$$s:ae})},{$$s:x})},-1),U(m,"$native_accessor",function(d){var p,_,x=this;return p=f(arguments),te(x,"native_reader",Q(_=p)),te(x,"native_writer",Q(_))},-1),function(B,O){var m=fe(B,"Wrapper"),l=[m].concat(O),c=T.$r(l);U(m,"$initialize",function(d){return S(v["$native?"](d))||v.$raise(c("ArgumentError"),d.$inspect()+" isn't native"),this.native=d}),U(m,"$to_n",N("native")),Ce(m,"$included",function(d){return d.$extend(c("Helpers"))})}(F[0],F),Ce(ne,"$included",function(O){return this.$warn("Including ::Native is deprecated. Please include Native::Wrapper instead."),O.$include(he("Wrapper"))}),function(P,L){var ne=fe(P,"Kernel"),F=[ne].concat(L),he=T.$r(F);U(ne,"$native?",function(O){return null==O||!O.$$class}),U(ne,"$Native",function B(O){var l=this;return B.$$p=null,S(null==O)?M:S(l["$native?"](O))?C(he("Native"),"Object").$new(O):S(O["$is_a?"](he("Array")))?te(O,"map",[],function c(h){return null==h&&(h=M),(null==c.$$s?this:c.$$s).$Native(h)},{$$s:l}):S(O["$is_a?"](he("Proc")))?te(l,"proc",[],function c(h){var p,d=c.$$p||M,x=null==c.$$s?this:c.$$s;return c.$$p=null,p=f(arguments),x.$Native(te(O,"call",Q(p),d.$to_proc()))},{$$arity:-1,$$s:l}):O}),G(ne,"_Array","Array"),U(ne,"$Array",function B(O,m){var h,l=B.$$p||M,d=this;return B.$$p=null,h=f(arguments,1),S(d["$native?"](O))?te(C(he("Native"),"Array"),"new",[O].concat(Q(h)),l.$to_proc()).$to_a():d.$_Array(O)},-2)}(H[0],H),function(P,L){var ne=re(P,L,"Object");ne.$$prototype.native=M,ne.$include(C(C("Native"),"Wrapper")),U(ne,"$==",function(B){return this.native===C("Native").$try_convert(B)}),U(ne,"$has_key?",function(B){return T.hasOwnProperty.call(this.native,B)}),U(ne,"$each",function he(B){var m,l=he.$$p||M,c=this;if(he.$$p=null,m=f(arguments),l!==M){for(var h in c.native)T.yieldX(l,[h,c.native[h]]);return c}return te(c,"method_missing",["each"].concat(Q(m)))},-1),U(ne,"$[]",function(B){var m=this.native[B];return m instanceof Function?m:C("Native").$call(this.native,B)}),U(ne,"$[]=",function(B,O){var l;return l=C("Native").$try_convert(O),this.native[B]=S(l===M)?O:l}),U(ne,"$merge!",function(B){for(var m in B=C("Native").$convert(B))this.native[m]=B[m];return this}),U(ne,"$respond_to?",function(B,O){return null==O&&(O=!1),v.$instance_method("respond_to?").$bind(this).$call(B,O)},-2),U(ne,"$respond_to_missing?",function(B,O){return null==O&&(O=!1),T.hasOwnProperty.call(this.native,B)},-2),U(ne,"$method_missing",function he(B,O){var c,h,m=he.$$p||M,d=this;return he.$$p=null,c=f(arguments,1),"="===B.charAt(B.length-1)?(h=[B.$slice(0,q(B.$length(),1)),c["$[]"](0)],te(d,"[]=",h),h[h.length-1]):te(C("Native"),"call",[d.native,B].concat(Q(c)),m.$to_proc())},-2),U(ne,"$nil?",E(!1)),U(ne,"$is_a?",function(B){return T.is_a(this,B)}),U(ne,"$instance_of?",function(B){return this.$$class===B}),U(ne,"$class",function(){return this.$$class}),U(ne,"$to_a",function he(B){var O=he.$$p||M;return he.$$p=null,null==B&&(B=V([],{})),te(C(C("Native"),"Array"),"new",[this.native,B],O.$to_proc()).$to_a()},-1),U(ne,"$inspect",function(){return"#<Native:"+String(this.native)+">"}),G(ne,"include?","has_key?"),G(ne,"key?","has_key?"),G(ne,"kind_of?","is_a?"),G(ne,"member?","has_key?")}(A("Native"),A("BasicObject")),function(P,L,ne){var F=re(P,null,"Array"),he=[F].concat(ne),B=T.$r(he),O=F.$$prototype;O.named=O.native=O.get=O.block=O.set=O.length=M,F.$include(C(B("Native"),"Wrapper")),F.$include(B("Enumerable")),U(F,"$initialize",function m(l,c){var h=m.$$p||M,d=this,p=M;return m.$$p=null,null==c&&(c=V([],{})),le(d,Z(d,"initialize",m,!1,!0),"initialize",[l],null),d.get=S(p=c["$[]"]("get"))?p:c["$[]"]("access"),d.named=c["$[]"]("named"),d.set=S(p=c["$[]"]("set"))?p:c["$[]"]("access"),d.length=S(p=c["$[]"]("length"))?p:"length",d.block=h,S(null==d.$length())?d.$raise(B("ArgumentError"),"no length found on the array-like object"):M},-2),U(F,"$each",function m(){var l=m.$$p||M,c=this;if(m.$$p=null,!S(l))return c.$enum_for("each");for(var h=0,d=c.$length();h<d;h++)T.yield1(l,c["$[]"](h));return c}),U(F,"$[]",function(l){var h,d,c=this;return h=Y(B("String"),d=l)||Y(B("Symbol"),d)?S(c.named)?c.native[c.named](l):c.native[l]:Y(B("Integer"),d)?S(c.get)?c.native[c.get](l):c.native[l]:M,S(h)?S(c.block)?c.block.$call(h):c.$Native(h):M}),U(F,"$[]=",function(l,c){var h=this;return S(h.set)?h.native[h.set](l,B("Native").$convert(c)):h.native[l]=B("Native").$convert(c)}),U(F,"$last",function(l){var c=this,h=M,d=M;if(null==l&&(l=M),S(l)){for(h=q(c.$length(),1),d=[];S(X(h,0));)d["$<<"](c["$[]"](h)),h=q(h,1);return d}return c["$[]"](q(c.$length(),1))},-1),U(F,"$length",function(){return this.native[this.length]}),U(F,"$inspect",function(){return this.$to_a().$inspect()}),G(F,"to_ary","to_a")}(A("Native"),0,H),function(P,L){var ne=re(P,null,"Numeric");U(ne,"$to_n",function(){return this.valueOf()})}(H[0]),function(P,L){var ne=re(P,null,"Proc");U(ne,"$to_n",k)}(H[0]),function(P,L){var ne=re(P,null,"String");U(ne,"$to_n",function(){return this.valueOf()})}(H[0]),function(P,L){var ne=re(P,null,"Regexp");U(ne,"$to_n",function(){return this.valueOf()})}(H[0]),function(P,L){var ne=re(P,null,"MatchData");U(ne,"$to_n",N("matches"))}(H[0]),function(P,L,ne){var F=re(P,null,"Struct"),he=[F].concat(ne),B=T.$r(he);U(F,"$to_n",function(){var l=M;return l={},te(this,"each_pair",[],function(h,d){return null==h&&(h=M),null==d&&(d=M),l[h]=B("Native").$try_convert(d,d)}),l})}(H[0],0,H),function(P,L,ne){var F=re(P,null,"Array"),he=[F].concat(ne),B=T.$r(he);U(F,"$to_n",function(){for(var l=[],c=0,h=this.length;c<h;c++){var d=this[c];l.push(B("Native").$try_convert(d,d))}return l})}(H[0],0,H),function(P,L){var ne=re(P,null,"Boolean");U(ne,"$to_n",function(){return this.valueOf()})}(H[0]),function(P,L){var ne=re(P,null,"Time");U(ne,"$to_n",k)}(H[0]),function(P,L){var ne=re(P,null,"NilClass");U(ne,"$to_n",function(){return null})}(H[0]),S(A("Hash")["$method_defined?"]("_initialize"))||function(P,L,ne){var F=re(P,null,"Hash"),he=[F].concat(ne),B=T.$r(he);G(F,"_initialize","initialize"),U(F,"$initialize",function O(m){var l=O.$$p||M,c=this;if(O.$$p=null,null!=m&&(void 0===m.constructor||m.constructor===Object)){var p,_,h=c.$$smap,d=c.$$keys;for(p in m)!(_=m[p])||void 0!==_.constructor&&_.constructor!==Object?_&&_.$$is_array?(_=_.map(function(x){return!x||void 0!==x.constructor&&x.constructor!==Object?c.$Native(x):B("Hash").$new(x)}),h[p]=_):h[p]=c.$Native(_):h[p]=B("Hash").$new(_),d.push(p);return c}return te(c,"_initialize",[m],l.$to_proc())},-1),U(F,"$to_n",function(){for(var d,p,l={},c=this.$$keys,h=this.$$smap,_=0,x=c.length;_<x;_++)p=(d=c[_]).$$is_string?h[d]:(d=d.key).value,l[d]=B("Native").$try_convert(p,p);return l})}(H[0],0,H),function(P,L){var ne=re(P,null,"Module");U(ne,"$native_module",function(){return T.global[this.$name()]=this})}(H[0]),function(P,L,ne){var F=re(P,null,"Class"),he=[F].concat(ne),B=T.$r(he);U(F,"$native_alias",function(m,l){var c=this,h=c.prototype[T.jsid(l)];h||c.$raise(B("NameError").$new("undefined method `"+l+"' for class `"+c.$inspect()+"'",l)),c.prototype[m]=h}),U(F,"$native_class",function(){var m=this;return m.$native_module(),m.new=m.$new})}(H[0],0,H),R.$=R.global=ee.$Native(T.global)}),Opal.modules.strscan=function(T){var G,re,q,E,V,Ce=T.def,f=T.truthy,S=T.eqeqeq,te=T.Opal,v=T.return_ivar,D=T.send,z=T.alias,I=[],Q=T.nil;return G=I,q=[re=(0,T.klass)(I[0],null,"StringScanner")].concat(G),E=T.$r(q),(V=re.$$prototype).pos=V.string=V.working=V.matched=V.prev_pos=V.match=Q,re.$attr_reader("pos","matched"),Ce(re,"$initialize",function(Z){var Y=this;return Y.string=Z,Y.pos=0,Y.matched=Q,Y.working=Z,Y.match=[]}),re.$attr_reader("string"),Ce(re,"$beginning_of_line?",function(){var Z=this;return 0===Z.pos||"\n"===Z.string.charAt(Z.pos-1)}),Ce(re,"$scan",function(Z){var Y=this,X=(Z=Y.$anchor(Z)).exec(Y.working);return null==X?Y.matched=Q:(Y.prev_pos=Y.pos,Y.pos+=X[0].length,Y.working=Y.working.substring(X[0].length),Y.matched=X[0],Y.match=X,X[0])}),Ce(re,"$scan_until",function(Z){var Y=this;Z=Y.$anchor(Z);for(var X=Y.working,k=0;X.length!=k;++k){var R=Z.exec(X.substr(k));if(null!==R){var ee=k+R[0].length,H=X.substr(0,ee);return Y.matched=R[0],Y.match=R,Y.prev_pos=Y.pos+k,Y.pos+=ee,Y.working=X.substr(ee),H}}return Y.matched=Q}),Ce(re,"$[]",function(Z){var X;if(f(this.match["$empty?"]()))return Q;S(E("Symbol"),X=Z)?Z=Z.$to_s():S(E("String"),X)||(Z=te["$coerce_to!"](Z,E("Integer"),"to_int"));var k=this.match;return Z<0&&(Z+=k.length),Z<0||Z>=k.length||null==k[Z]?Q:k[Z]}),Ce(re,"$check",function(Z){var Y=this,X=(Z=Y.$anchor(Z)).exec(Y.working);return Y.matched=null==X?Q:X[0]}),Ce(re,"$check_until",function(Z){var Y=this,X=Y.prev_pos,k=Y.pos,R=Y.working,ee=Y.$scan_until(Z);return Y.prev_pos=X,Y.pos=k,Y.working=R,ee}),Ce(re,"$peek",function(Z){return this.working.substring(0,Z)}),Ce(re,"$eos?",function(){return 0===this.working.length}),Ce(re,"$exist?",function(Z){var X=Z.exec(this.working);return null==X?Q:0==X.index?0:X.index+1}),Ce(re,"$skip",function(Z){var Y=this,X=(Z=Y.$anchor(Z)).exec(Y.working);if(null==X)return Y.match=[],Y.matched=Q;var k=X[0],R=k.length;return Y.matched=k,Y.match=X,Y.prev_pos=Y.pos,Y.pos+=R,Y.working=Y.working.substring(R),R}),Ce(re,"$skip_until",function(Z){var X=this.$scan_until(Z);return X===Q?Q:(this.matched=X.substr(-1),X.length)}),Ce(re,"$get_byte",function(){var Z=this,Y=Q;return Z.pos<Z.string.length?(Z.prev_pos=Z.pos,Z.pos+=1,Y=Z.matched=Z.working.substring(0,1),Z.working=Z.working.substring(1)):Z.matched=Q,Y}),Ce(re,"$match?",function(Z){var Y=this,X=(Z=Y.$anchor(Z)).exec(Y.working);return null==X?Q:(Y.prev_pos=Y.pos,X[0].length)}),Ce(re,"$pos=",function(Z){var Y=this;return Z<0&&(Z+=Y.string.$length()),Y.pos=Z,Y.working=Y.string.slice(Z)}),Ce(re,"$matched_size",function(){return this.matched===Q?Q:this.matched.length}),Ce(re,"$post_match",function(){var Z=this;return Z.matched===Q?Q:Z.string.substr(Z.pos)}),Ce(re,"$pre_match",function(){var Z=this;return Z.matched===Q?Q:Z.string.substr(0,Z.prev_pos)}),Ce(re,"$reset",function(){var Z=this;return Z.working=Z.string,Z.matched=Q,Z.pos=0}),Ce(re,"$rest",v("working")),Ce(re,"$rest?",function(){return 0!==this.working.length}),Ce(re,"$rest_size",function(){return this.$rest().$size()}),Ce(re,"$terminate",function(){var Z,Y=this;return Y.match=Q,Z=[Y.string.$length()],D(Y,"pos=",Z),Z[Z.length-1]}),Ce(re,"$unscan",function(){var Z=this;return Z.pos=Z.prev_pos,Z.prev_pos=Q,Z.match=Q,Z}),z(re,"bol?","beginning_of_line?"),z(re,"getch","get_byte"),re.$private(),Ce(re,"$anchor",function(Z){var Y=Z.toString().match(/\/([^\/]+)$/);return Y=Y?Y[1]:void 0,new RegExp("^(?:"+Z.source+")",Y)})},Opal.queue(function(T){var I,Q,G,U,fe=T.klass,Ce=T.def,f=T.module,S=T.top,te=[],v=T.$r(te),D=T.nil;return S.$require("strscan"),Q=te,[U=fe(te[0],null,"Dir")].concat(Q),G=T.get_singleton_class(U),Ce(G,"$[]",function(){return[]}),I=f(te[0],"StringScannerPatch"),Ce(I,"$scan_until",function(U){var N=this;U=(N=this).$anchor(U);for(var q,G=N.pos,re=N.working;;){var E=0===re.length;if(q=U.exec(re),G+=1,re=re.substr(1),null!=q)return N.matched=N.string.substr(N.pos,G-N.pos-1+q[0].length),N.prev_pos=G-1,N.pos=G,N.working=re.substr(q[0].length-1),N.matched;if(E)return N.matched=D}}),v("StringScanner").$prepend(v("StringScannerPatch")),T.top.$__dir__=()=>"/",D})},8465:(T,fe,Ce)=>{Ce(9993),Opal.modules["bcdice/arithmetic/node"]=function(f){var k,A,L,m,l,F,he,C,ee,S=f.module,te=f.klass,v=f.def,D=f.thrower,z=f.return_ivar,I=f.send2,Q=f.find_super,U=f.eqeq,N=f.const_set,G=f.eqeqeq,re=f.rb_divide,q=f.truthy,E=f.assign_ivar,V=f.alias,le=[],Z=f.nil,Y=f.$$$;return k=le,A=ee=[S(le[0],"BCDice")].concat(k),L=C=[S(ee[0],"Arithmetic")].concat(A),F=[S(C[0],"Node")].concat(L),he=f.$r(F),(l=(m=te(F[0],null,"BinaryOp")).$$prototype).lhs=l.rhs=l.op=Z,v(m,"$initialize",function(h,d,p){var _=this;return _.lhs=h,_.op=d,_.rhs=p}),v(m,"$eval",function(h){try{D("eval_return");var x,p=this,_=Z;return _=p.lhs.$eval(h),x=p.rhs.$eval(h),_.$send(p.op,x)}catch($){if($===f.t_eval_return)return $.$v;throw $}}),v(m,"$output",function(){var h=this;return""+h.lhs.$output()+h.op+h.rhs.$output()}),v(m,"$s_exp",function(){var h=this;return"("+h.$op_for_s_exp()+" "+h.lhs.$s_exp()+" "+h.rhs.$s_exp()+")"}),v(m,"$op_for_s_exp",z("op")),function(B,O,m){var l=te(B,O,"DivideBase"),c=[l].concat(m),h=f.$r(c),d=l.$$prototype;d.lhs=d.rhs=d.op=Z,v(l,"$initialize",function p(_,x){return p.$$p=null,I(this,Q(this,"initialize",p,!1,!0),"initialize",[_,"/",x],null)}),v(l,"$eval",function(_){try{D("eval_return");var se,ae,$=this;return se=$.lhs.$eval(_),ae=$.rhs.$eval(_),U(ae,0)&&$.$raise(h("ZeroDivisionError")),$.$divide_and_round(se,ae,_)}catch(Te){if(Te===f.t_eval_return)return Te.$v;throw Te}}),v(l,"$output",function p(){var _=p.$$p||Z,x=this;return p.$$p=null,""+I(x,Q(x,"output",p,!1,!0),"output",[],_)+x.$rounding_method()}),l.$private(),v(l,"$rounding_method",function(){return Y(this.$class(),"ROUNDING_METHOD")}),v(l,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),v(l,"$divide_and_round",function(_,x,$){return this.$raise(h("NotImplementedError"))})}(F[0],he("BinaryOp"),F),function(B,O,m){var l=te(B,O,"DivideWithGameSystemDefault"),c=[l].concat(m),h=f.$r(c);N(c[0],"ROUNDING_METHOD",""),l.$private(),v(l,"$divide_and_round",function(p,_,x){var $,se=Z;return G(Y(h("RoundType"),"CEIL"),$=x)?re(p.$to_f(),_).$ceil():G(Y(h("RoundType"),"ROUND"),$)?(se=re(p.$to_f(),_),q(se["$negative?"]())?se.$abs().$round()["$-@"]():se.$round()):re(p,_).$floor()})}(F[0],he("DivideBase"),F),function(B,O,m){var l=te(B,O,"DivideWithCeil"),c=[l].concat(m);N(c[0],"ROUNDING_METHOD","C"),l.$private(),v(l,"$divide_and_round",function(d,p,_){return re(d.$to_f(),p).$ceil()})}(F[0],he("DivideBase"),F),function(B,O,m){var l=te(B,O,"DivideWithRound"),c=[l].concat(m);N(c[0],"ROUNDING_METHOD","R"),l.$private(),v(l,"$divide_and_round",function(d,p,_){var x=Z;return x=re(d.$to_f(),p),q(x["$negative?"]())?x.$abs().$round()["$-@"]():x.$round()})}(F[0],he("DivideBase"),F),function(B,O,m){var l=te(B,O,"DivideWithFloor"),c=[l].concat(m);N(c[0],"ROUNDING_METHOD","F"),l.$private(),v(l,"$divide_and_round",function(d,p,_){return re(d,p).$floor()})}(F[0],he("DivideBase"),F),function(B,O){var m=te(B,null,"Negative");m.$$prototype.body=Z,v(m,"$initialize",E("body")),v(m,"$eval",function(h){try{return D("eval_return"),this.body.$eval(h)["$-@"]()}catch(_){if(_===f.t_eval_return)return _.$v;throw _}}),v(m,"$output",function(){return"-"+this.body.$output()}),v(m,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(F[0]),function(B,O){var m=te(B,null,"Parenthesis");m.$$prototype.expr=Z,v(m,"$initialize",E("expr")),v(m,"$eval",function(h){try{return D("eval_return"),this.expr.$eval(h)}catch(_){if(_===f.t_eval_return)return _.$v;throw _}}),v(m,"$output",function(){return"("+this.expr.$output()+")"}),v(m,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(F[0]),function(B,O){var m=te(B,null,"Number");return m.$$prototype.value=Z,v(m,"$initialize",E("value")),v(m,"$eval",z("value")),v(m,"$output",function(){return this.value.$to_s()}),V(m,"s_exp","output")}(F[0])},Opal.modules["racc/parser"]=function(f){var P,ne,F,S=f.module,te=f.klass,v=f.truthy,D=f.const_set,z=f.defs,I=f.gvars,Q=f.rb_lt,U=f.def,N=f.to_ary,G=f.send,re=f.neqeq,q=f.rb_plus,E=f.eqeq,V=f.rb_ge,le=f.rb_gt,Z=f.rb_minus,Y=f.rb_le,X=f.rb_times,k=f.assign_ivar_val,ee=[],H=f.$r(ee),A=f.nil,M=f.$$$;return P=ee,ne=[S(ee[0],"Racc")].concat(P),F=f.$r(ne),te(ne[0],F("StandardError"),"ParseError"),v(M("::","ParseError","skip_raise")?"constant":A)||D(ee[0],"ParseError",M(H("Racc"),"ParseError")),function(C,P){var m,l,c,h,d,F=[S(C,"Racc")].concat(P),he=f.$r(F);return v(he("Racc_No_Extensions","skip_raise")?"constant":A)||D(F[0],"Racc_No_Extensions",!1),m=F,c=[l=te(F[0],null,"Parser")].concat(m),h=f.$r(c),(d=l.$$prototype).yydebug=d.racc_debug_out=d.racc_error_status=d.racc_t=d.racc_vstack=d.racc_val=d.racc_state=d.racc_tstack=A,D(c[0],"Racc_Runtime_Version","1.4.6"),D(c[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),D(c[0],"Racc_Runtime_Core_Version_R","1.4.6"),D(c[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),D(c[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),D(c[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),D(c[0],"Racc_Runtime_Core_Version",h("Racc_Runtime_Core_Version_R")),D(c[0],"Racc_Runtime_Core_Revision",h("Racc_Runtime_Core_Revision_R")),D(c[0],"Racc_Runtime_Type","ruby"),z(h("Parser"),"$racc_runtime_type",function(){return h("Racc_Runtime_Type")}),U(l,"$_racc_setup",function(){var _,x,$=this,se=A,ae=A;return null==I.stderr&&(I.stderr=A),v(M($.$class(),"Racc_debug_parser"))||($.yydebug=!1),v(null!=(_=$.yydebug)&&_!==A?"instance-variable":A)||($.yydebug=!1),v($.yydebug)&&(v(null!=(x=$.racc_debug_out)&&x!==A?"instance-variable":A)||($.racc_debug_out=I.stderr),$.racc_debug_out=v(se=$.racc_debug_out)?se:I.stderr),ae=M($.$class(),"Racc_arg"),v(Q(ae.$size(),14))&&ae["$[]="](13,!0),ae}),U(l,"$_racc_init_sysvars",function(){var _=this;return _.racc_state=[0],_.racc_tstack=[],_.racc_vstack=[],_.racc_t=A,_.racc_val=A,_.racc_read_next=!0,_.racc_user_yyerror=!1,_.racc_error_status=0}),U(l,"$do_parse",function(){return this.$__send__(h("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),U(l,"$next_token",function(){return this.$raise(h("NotImplementedError"),this.$class()+"#next_token is not defined")}),U(l,"$_racc_do_parse_rb",function(_,x){var $,Te=A,Ae=A,de=A,Fe=A,ke=A,De=A,Me=A,_e=A;return $=N(_),Te=null==$[0]?A:$[0],Ae=null==$[1]?A:$[1],de=null==$[2]?A:$[2],Fe=null==$[3]?A:$[3],ke=null==$[10]?A:$[10],this.$_racc_init_sysvars(),De=Me=_e=A,G(this,"catch",["racc_end_parse"],function ce(){var pe,ye,b=null==ce.$$s?this:ce.$$s,K=A;for(null==b.racc_state&&(b.racc_state=A),null==b.racc_read_next&&(b.racc_read_next=A),null==b.racc_t&&(b.racc_t=A),null==b.yydebug&&(b.yydebug=A),null==b.racc_val&&(b.racc_val=A);v(!0);)for(v(_e=Fe["$[]"](b.racc_state["$[]"](-1)))?(v(b.racc_read_next)&&re(b.racc_t,0)&&(ye=b.$next_token(),pe=N(ye),De=null==pe[0]?A:pe[0],b.racc_val=null==pe[1]?A:pe[1],b.racc_t=v(De)?v(K=ke["$[]"](De))?K:1:0,v(b.yydebug)&&b.$racc_read_token(b.racc_t,De,b.racc_val),b.racc_read_next=!1),_e=q(_e,b.racc_t),v(V(_e,0))&&v(Me=Te["$[]"](_e))&&E(Ae["$[]"](_e),b.racc_state["$[]"](-1))||(Me=de["$[]"](b.racc_state["$[]"](-1)))):Me=de["$[]"](b.racc_state["$[]"](-1));v(Me=b.$_racc_evalact(Me,_)););},{$$s:this})}),U(l,"$yyparse",function(_,x){return this.$__send__(h("Racc_YY_Parse_Method"),_,x,this.$_racc_setup(),!0)}),U(l,"$_racc_yyparse_rb",function(_,x,$,se){var ae,de=A,Fe=A,xe=A,ke=A,Me=A,_e=A,ce=A;return ae=N($),de=null==ae[0]?A:ae[0],Fe=null==ae[1]?A:ae[1],xe=null==ae[2]?A:ae[2],ke=null==ae[3]?A:ae[3],Me=null==ae[10]?A:ae[10],this.$_racc_init_sysvars(),_e=A,ce=A,G(this,"catch",["racc_end_parse"],function pe(){var ye=null==pe.$$s?this:pe.$$s;for(null==ye.racc_state&&(ye.racc_state=A);!v(ce=ke["$[]"](ye.racc_state["$[]"](-1)));)for(;v(_e=ye.$_racc_evalact(xe["$[]"](ye.racc_state["$[]"](-1)),$)););return G(_,"__send__",[x],function b(K,ge){var be=null==b.$$s?this:b.$$s,Pe=A,Ue=A;for(null==be.racc_t&&(be.racc_t=A),null==be.racc_state&&(be.racc_state=A),null==be.racc_read_next&&(be.racc_read_next=A),null==K&&(K=A),null==ge&&(ge=A),be.racc_t=v(K)?v(Pe=Me["$[]"](K))?Pe:1:0,be.racc_val=ge,be.racc_read_next=!1,ce=q(ce,be.racc_t),v(V(ce,0))&&v(_e=de["$[]"](ce))&&E(Fe["$[]"](ce),be.racc_state["$[]"](-1))||(_e=xe["$[]"](be.racc_state["$[]"](-1)));v(_e=be.$_racc_evalact(_e,$)););for(;v(v(Pe=v(Ue=(ce=ke["$[]"](be.racc_state["$[]"](-1)))["$!"]())?Ue:be.racc_read_next["$!"]())?Pe:be.racc_t["$=="](0));)for(v(ce)&&v(ce=q(ce,be.racc_t))&&v(V(ce,0))&&v(_e=de["$[]"](ce))&&E(Fe["$[]"](ce),be.racc_state["$[]"](-1))||(_e=xe["$[]"](be.racc_state["$[]"](-1)));v(_e=be.$_racc_evalact(_e,$)););},{$$s:ye})},{$$s:this})}),U(l,"$_racc_evalact",function(_,x){var $,xe,ae=this,Te=A,Ae=A,Fe=A,ke=A,De=A,Me=A;if(Te=null==($=N(x))[0]?A:$[0],Ae=null==$[1]?A:$[1],Fe=null==$[3]?A:$[3],xe=null==$[11]?A:$[11],ke=null==$[12]?A:$[12],v(le(_,0))&&v(Q(_,xe)))v(le(ae.racc_error_status,0))&&(E(ae.racc_t,1)||(ae.racc_error_status=Z(ae.racc_error_status,1))),ae.racc_vstack.$push(ae.racc_val),ae.racc_state.$push(_),ae.racc_read_next=!0,v(ae.yydebug)&&(ae.racc_tstack.$push(ae.racc_t),ae.$racc_shift(ae.racc_t,ae.racc_tstack,ae.racc_vstack));else if(v(Q(_,0))&&v(le(_,ke["$-@"]()))){if(De=G(ae,"catch",["racc_jump"],function _e(){var ce=null==_e.$$s?this:_e.$$s;return null==ce.racc_state&&(ce.racc_state=A),ce.racc_state.$push(ce.$_racc_do_reduce(x,_)),!1},{$$s:ae}),v(De))switch(De.valueOf()){case 1:return ae.racc_user_yyerror=!0,ke["$-@"]();case 2:return xe;default:ae.$raise("[Racc Bug] unknown jump code")}}else if(E(_,xe))v(ae.yydebug)&&ae.$racc_accept(),ae.$throw("racc_end_parse",ae.racc_vstack["$[]"](0));else{if(E(_,ke["$-@"]())){switch(ae.racc_error_status.valueOf()){case 0:v(x["$[]"](21))||ae.$on_error(ae.racc_t,ae.racc_val,ae.racc_vstack);break;case 3:E(ae.racc_t,0)&&ae.$throw("racc_end_parse",A),ae.racc_read_next=!0}for(ae.racc_user_yyerror=!1,ae.racc_error_status=3;v(!0)&&!(v(Me=Fe["$[]"](ae.racc_state["$[]"](-1)))&&(Me=q(Me,1),v(V(Me,0))&&v(_=Te["$[]"](Me))&&E(Ae["$[]"](Me),ae.racc_state["$[]"](-1))));)v(Y(ae.racc_state.$size(),1))&&ae.$throw("racc_end_parse",A),ae.racc_state.$pop(),ae.racc_vstack.$pop(),v(ae.yydebug)&&(ae.racc_tstack.$pop(),ae.$racc_e_pop(ae.racc_state,ae.racc_tstack,ae.racc_vstack));return _}ae.$raise("[Racc Bug] unknown action "+_.$inspect())}return v(ae.yydebug)&&ae.$racc_next_state(ae.racc_state["$[]"](-1),ae.racc_state),A}),U(l,"$_racc_do_reduce",function(_,x){var $,ke,Me,K,ge,be,Ye,ae=this,Ae=A,de=A,Fe=A,xe=A,De=A,_e=A,ce=A,pe=A,ye=A,b=A,Pe=A,Ue=A,nt=A;return Ae=null==($=N(_))[4]?A:$[4],de=null==$[5]?A:$[5],Fe=null==$[6]?A:$[6],xe=null==$[7]?A:$[7],ke=null==$[8]?A:$[8],De=null==$[9]?A:$[9],Me=null==$[13]?A:$[13],_e=ae.racc_state,ce=ae.racc_vstack,pe=ae.racc_tstack,ye=X(x,-3),b=De["$[]"](ye),K=De["$[]"](q(ye,1)),ge=De["$[]"](q(ye,2)),be=[],v(ae.yydebug)&&(Pe=pe["$[]"](b["$-@"](),b)),Ue=ce["$[]"](b["$-@"](),b),v(ae.yydebug)&&pe["$[]="](b["$-@"](),b,be),ce["$[]="](b["$-@"](),b,be),_e["$[]="](b["$-@"](),b,be),v(Me)?ce.$push(ae.$__send__(ge,Ue,ce,Ue["$[]"](0))):ce.$push(ae.$__send__(ge,Ue,ce)),pe.$push(K),v(ae.yydebug)&&ae.$racc_reduce(Pe,K,pe,ce),Ye=Z(K,ke),v(ye=xe["$[]"](Ye))&&(ye=q(ye,_e["$[]"](-1)),v(V(ye,0))&&v(nt=Ae["$[]"](ye))&&E(de["$[]"](ye),Ye))?nt:Fe["$[]"](Ye)}),U(l,"$on_error",function(_,x,$){var ae;return this.$raise(h("ParseError"),this.$sprintf("\nparse error on value %s (%s)",x.$inspect(),v(ae=this.$token_to_str(_))?ae:"?"))}),U(l,"$yyerror",function(){return this.$throw("racc_jump",1)}),U(l,"$yyaccept",function(){return this.$throw("racc_jump",2)}),U(l,"$yyerrok",k("racc_error_status",0)),U(l,"$racc_read_token",function(_,x,$){var se=this;return se.racc_debug_out.$print("read    "),se.racc_debug_out.$print(x.$inspect(),"(",se.$racc_token2str(_),") "),se.racc_debug_out.$puts($.$inspect()),se.racc_debug_out.$puts()}),U(l,"$racc_shift",function(_,x,$){return this.racc_debug_out.$puts("shift   "+this.$racc_token2str(_)),this.$racc_print_stacks(x,$),this.racc_debug_out.$puts()}),U(l,"$racc_reduce",function(_,x,$,se){var ae=this,Te=A;return(Te=ae.racc_debug_out).$print("reduce "),v(_["$empty?"]())?Te.$print(" <none>"):G(_,"each",[],function Ae(de){return null==de&&(de=A),Te.$print(" ",(null==Ae.$$s?this:Ae.$$s).$racc_token2str(de))},{$$s:ae}),Te.$puts(" --\x3e "+ae.$racc_token2str(x)),ae.$racc_print_stacks($,se),ae.racc_debug_out.$puts()}),U(l,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),U(l,"$racc_e_pop",function(_,x,$){return this.racc_debug_out.$puts("error recovering mode: pop token"),this.$racc_print_states(_),this.$racc_print_stacks(x,$),this.racc_debug_out.$puts()}),U(l,"$racc_next_state",function(_,x){var $=this;return $.racc_debug_out.$puts("goto    "+_),$.$racc_print_states(x),$.racc_debug_out.$puts()}),U(l,"$racc_print_stacks",function(_,x){var se=A;return(se=this.racc_debug_out).$print("        ["),G(_,"each_index",[],function ae(Te){return null==Te&&(Te=A),se.$print(" (",(null==ae.$$s?this:ae.$$s).$racc_token2str(_["$[]"](Te))," ",x["$[]"](Te).$inspect(),")")},{$$s:this}),se.$puts(" ]")}),U(l,"$racc_print_states",function(_){var $=A;return($=this.racc_debug_out).$print("        ["),G(_,"each",[],function(ae){return null==ae&&(ae=A),$.$print(" ",ae)}),$.$puts(" ]")}),U(l,"$racc_token2str",function(_){var $;return v($=M(this.$class(),"Racc_token_to_s_table")["$[]"](_))?$:this.$raise("[Racc Bug] can't convert token "+_+" to string")}),U(l,"$token_to_str",function(_){return M(this.$class(),"Racc_token_to_s_table")["$[]"](_)})}(ee[0],ee)},Opal.modules.strscan=function(f){var E,V,le,Z,Y,te=f.def,v=f.truthy,D=f.eqeqeq,z=f.Opal,I=f.return_ivar,Q=f.send,U=f.alias,N=[],G=f.nil;return E=N,le=[V=(0,f.klass)(N[0],null,"StringScanner")].concat(E),Z=f.$r(le),(Y=V.$$prototype).pos=Y.string=Y.working=Y.matched=Y.prev_pos=Y.match=G,V.$attr_reader("pos","matched"),te(V,"$initialize",function(k){var R=this;return R.string=k,R.pos=0,R.matched=G,R.working=k,R.match=[]}),V.$attr_reader("string"),te(V,"$beginning_of_line?",function(){var k=this;return 0===k.pos||"\n"===k.string.charAt(k.pos-1)}),te(V,"$scan",function(k){var R=this,ee=(k=R.$anchor(k)).exec(R.working);return null==ee?R.matched=G:(R.prev_pos=R.pos,R.pos+=ee[0].length,R.working=R.working.substring(ee[0].length),R.matched=ee[0],R.match=ee,ee[0])}),te(V,"$scan_until",function(k){var R=this;k=R.$anchor(k);for(var ee=R.working,H=0;ee.length!=H;++H){var A=k.exec(ee.substr(H));if(null!==A){var M=H+A[0].length,C=ee.substr(0,M);return R.matched=A[0],R.match=A,R.prev_pos=R.pos+H,R.pos+=M,R.working=ee.substr(M),C}}return R.matched=G}),te(V,"$[]",function(k){var ee;if(v(this.match["$empty?"]()))return G;D(Z("Symbol"),ee=k)?k=k.$to_s():D(Z("String"),ee)||(k=z["$coerce_to!"](k,Z("Integer"),"to_int"));var H=this.match;return k<0&&(k+=H.length),k<0||k>=H.length||null==H[k]?G:H[k]}),te(V,"$check",function(k){var R=this,ee=(k=R.$anchor(k)).exec(R.working);return R.matched=null==ee?G:ee[0]}),te(V,"$check_until",function(k){var R=this,ee=R.prev_pos,H=R.pos,A=R.working,M=R.$scan_until(k);return R.prev_pos=ee,R.pos=H,R.working=A,M}),te(V,"$peek",function(k){return this.working.substring(0,k)}),te(V,"$eos?",function(){return 0===this.working.length}),te(V,"$exist?",function(k){var ee=k.exec(this.working);return null==ee?G:0==ee.index?0:ee.index+1}),te(V,"$skip",function(k){var R=this,ee=(k=R.$anchor(k)).exec(R.working);if(null==ee)return R.match=[],R.matched=G;var H=ee[0],A=H.length;return R.matched=H,R.match=ee,R.prev_pos=R.pos,R.pos+=A,R.working=R.working.substring(A),A}),te(V,"$skip_until",function(k){var ee=this.$scan_until(k);return ee===G?G:(this.matched=ee.substr(-1),ee.length)}),te(V,"$get_byte",function(){var k=this,R=G;return k.pos<k.string.length?(k.prev_pos=k.pos,k.pos+=1,R=k.matched=k.working.substring(0,1),k.working=k.working.substring(1)):k.matched=G,R}),te(V,"$match?",function(k){var R=this,ee=(k=R.$anchor(k)).exec(R.working);return null==ee?G:(R.prev_pos=R.pos,ee[0].length)}),te(V,"$pos=",function(k){var R=this;return k<0&&(k+=R.string.$length()),R.pos=k,R.working=R.string.slice(k)}),te(V,"$matched_size",function(){return this.matched===G?G:this.matched.length}),te(V,"$post_match",function(){var k=this;return k.matched===G?G:k.string.substr(k.pos)}),te(V,"$pre_match",function(){var k=this;return k.matched===G?G:k.string.substr(0,k.prev_pos)}),te(V,"$reset",function(){var k=this;return k.working=k.string,k.matched=G,k.pos=0}),te(V,"$rest",I("working")),te(V,"$rest?",function(){return 0!==this.working.length}),te(V,"$rest_size",function(){return this.$rest().$size()}),te(V,"$terminate",function(){var k,R=this;return R.match=G,k=[R.string.$length()],Q(R,"pos=",k),k[k.length-1]}),te(V,"$unscan",function(){var k=this;return k.pos=k.prev_pos,k.prev_pos=G,k.match=G,k}),U(V,"bol?","beginning_of_line?"),U(V,"getch","get_byte"),V.$private(),te(V,"$anchor",function(k){var R=k.toString().match(/\/([^\/]+)$/);return R=R?R[1]:void 0,new RegExp("^(?:"+k.source+")",R)})},Opal.modules["bcdice/normalize"]=function(f){var U,q,G,S=f.module,te=f.eqeqeq,v=f.def,D=f.eqeq,z=[],I=f.nil;return U=z,G=[S(z[0],"BCDice")].concat(U),(q=S(G[0],"Normalize")).$module_function(),v(q,"$comparison_operator",function(V){var le;return te(/<=|=</,le=V)?"<=":te(/>=|=>/,le)?">=":te(/<>|!=|=!/,le)?"!=":te(/</,le)?"<":te(/>/,le)?">":te(/=/,le)?"==":I}),v(q,"$target_number",function(V){return D(V,"?")?V:V.$to_i()})},Opal.modules["bcdice/common_command/lexer"]=function(f){var re,le,R,ee,H,A,Y,E,S=f.module,te=f.klass,v=f.const_set,D=f.hash2,z=f.truthy,I=f.def,Q=f.top,U=[],N=f.nil;return Q.$require("strscan"),Q.$require("bcdice/normalize"),re=U,le=E=[S(U[0],"BCDice")].concat(re),R=Y=[S(E[0],"CommonCommand")].concat(le),H=[ee=te(Y[0],null,"Lexer")].concat(R),A=f.$r(H),ee.$$prototype.scanner=N,v(H[0],"SYMBOLS",D(["+","-","*","/","(",")","[","]","?","@"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","?":"QUESTION","@":"AT"}).$freeze()),I(ee,"$initialize",function(P){var ne;return P=z(ne=P.$split(" ",2).$first())?ne:"",this.scanner=A("StringScanner").$new(P)}),I(ee,"$next_token",function(){var P=this,L=N,ne=N,F=N,B=N;return z(P.scanner["$eos?"]())?[!1,"$"]:z(L=P.scanner.$scan(/\d+/))?["NUMBER",L.$to_i()]:z(ne=P.scanner.$scan(/[<>!=]+/))?["CMP_OP",A("Normalize").$comparison_operator(ne)]:(F=P.scanner.$getch().$upcase(),[z(B=A("SYMBOLS")["$[]"](F))?B:F.$to_sym(),F])}),I(ee,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/arithmetic/parser"]=function(f){var E,Y,A,F,he,B,O,m,l,c,h,d,x,M,L,ne,k,R,le,S=f.module,te=f.klass,v=f.defs,D=f.def,z=f.hash,I=f.const_set,Q=f.truthy,U=f.top,N=[],G=f.nil,re=f.$$$;return U.$require("racc/parser.rb"),U.$require("bcdice/common_command/lexer"),U.$require("bcdice/arithmetic/node"),E=N,Y=le=[S(N[0],"BCDice")].concat(E),k=[S(le[0],"Arithmetic")].concat(Y),R=f.$r(k),A=k,L=[M=te(k[0],re(R("Racc"),"Parser"),"Parser")].concat(A),ne=f.$r(L),M.$$prototype.lexer=G,v(M,"$parse",function(Ae){return this.$new().$parse(Ae)}),D(M,"$parse",function(Ae){try{return this.lexer=re(re(ne("BCDice"),"CommonCommand"),"Lexer").$new(Ae),this.$do_parse()}catch(Fe){if(!f.rescue(Fe,[ne("ParseError")]))throw Fe;try{return G}finally{f.pop_exception()}}}),M.$private(),D(M,"$next_token",function(){return this.lexer.$next_token()}),F=f.large_array_unpack("8,17,8,12,13,4,5,4,5,7,8,7,8,12,13,4,5,4,5,7,8,7,8,12,13,4,5,4,5,7,8,7,8,,,4,5,4,5,7,9,7,,,10,11,,10,11,22,26,24,25,27"),he=f.large_array_unpack("0,9,4,2,2,0,0,4,4,0,5,4,7,18,18,5,5,7,7,5,10,7,11,19,19,10,10,11,11,10,12,11,13,,,12,12,13,13,12,1,13,,,16,16,,1,1,16,21,21,21,21"),B=[-2,40,-6,G,0,8,G,10,G,1,18,20,28,30,G,G,37,G,4,14,G,47,G,G,G,G,G,G],O=[-17,-17,-3,-6,-17,-17,-14,-17,-16,-17,-17,-17,-17,-17,-12,-13,-17,28,-1,-2,-4,-7,-15,-5,-8,-9,-10,-11],m=[14,15,23,1,18,19,G,G,20,21,16],l=[3,3,4,1,2,2,G,G,3,3,1],c=[G,3,-6,-4,-19,G],h=[G,G,2,3,G,6],d=f.large_array_unpack("0,0,racc_error,3,14,_reduce_1,3,14,_reduce_2,1,14,_reduce_none,3,15,_reduce_4,4,15,_reduce_5,1,15,_reduce_none,0,17,_reduce_7,1,17,_reduce_8,1,17,_reduce_9,1,17,_reduce_10,1,17,_reduce_11,2,16,_reduce_12,2,16,_reduce_13,1,16,_reduce_none,3,18,_reduce_15,1,18,_reduce_16"),x=z(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12),I(L[0],"Racc_arg",[F,he,O,B,m,l,h,c,13,d,x,28,17,!0]),Q(ne("Ractor","skip_raise")?"constant":G)&&ne("Ractor").$make_shareable(ne("Racc_arg")),I(L[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","add","mul","unary","round_type","term"]),Q(ne("Ractor","skip_raise")?"constant":G)&&ne("Ractor").$make_shareable(ne("Racc_token_to_s_table")),I(L[0],"Racc_debug_parser",!1),D(M,"$_reduce_1",function(Ae,de,Fe){return re(re(ne("Arithmetic"),"Node"),"BinaryOp").$new(Ae["$[]"](0),"+",Ae["$[]"](2))}),D(M,"$_reduce_2",function(Ae,de,Fe){return re(re(ne("Arithmetic"),"Node"),"BinaryOp").$new(Ae["$[]"](0),"-",Ae["$[]"](2))}),D(M,"$_reduce_4",function(Ae,de,Fe){return re(re(ne("Arithmetic"),"Node"),"BinaryOp").$new(Ae["$[]"](0),"*",Ae["$[]"](2))}),D(M,"$_reduce_5",function(Ae,de,Fe){return Ae["$[]"](3).$new(Ae["$[]"](0),Ae["$[]"](2))}),D(M,"$_reduce_7",function(Ae,de,Fe){return re(re(ne("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),D(M,"$_reduce_8",function(Ae,de,Fe){return re(re(ne("Arithmetic"),"Node"),"DivideWithCeil")}),D(M,"$_reduce_9",function(Ae,de,Fe){return re(re(ne("Arithmetic"),"Node"),"DivideWithCeil")}),D(M,"$_reduce_10",function(Ae,de,Fe){return re(re(ne("Arithmetic"),"Node"),"DivideWithRound")}),D(M,"$_reduce_11",function(Ae,de,Fe){return re(re(ne("Arithmetic"),"Node"),"DivideWithFloor")}),D(M,"$_reduce_12",function(Ae,de,Fe){return Ae["$[]"](1)}),D(M,"$_reduce_13",function(Ae,de,Fe){return re(re(ne("Arithmetic"),"Node"),"Negative").$new(Ae["$[]"](1))}),D(M,"$_reduce_15",function(Ae,de,Fe){return Ae["$[]"](1)}),D(M,"$_reduce_16",function(Ae,de,Fe){return re(re(ne("Arithmetic"),"Node"),"Number").$new(Ae["$[]"](0))}),D(M,"$_reduce_none",function(Ae,de,Fe){return Ae["$[]"](0)})},Opal.modules["bcdice/arithmetic"]=function(f){var U,q,le,Y,X,E,V,G,S=f.module,te=f.thrower,v=f.def,D=f.top,z=[],I=f.nil;return D.$require("bcdice/arithmetic/node"),D.$require("bcdice/arithmetic/parser"),U=z,q=G=[S(z[0],"BCDice")].concat(U),V=[E=S(G[0],"Arithmetic")].concat(q),Y=[le=f.get_singleton_class(E)].concat(V),X=f.$r(Y),v(le,"$eval",function(R,ee){try{var A;te("eval_return");try{return(A=X("Parser").$parse(R))===I||null==A?I:A.$eval(ee)}catch(C){if(!f.rescue(C,[X("ZeroDivisionError")]))throw C;try{return I}finally{f.pop_exception()}}}catch(C){if(C===f.t_eval_return)return C.$v;throw C}})},Opal.queue(function(f){var E,X,k,R,ee,H,le,S=f.module,te=f.klass,v=f.defs,D=f.def,z=f.send,I=f.truthy,Q=f.eqeq,U=f.thrower,G=[],re=f.nil;return f.top.$require("bcdice/arithmetic"),E=G,X=le=[S(G[0],"BCDice")].concat(E),R=[k=te(le[0],null,"Preprocessor")].concat(X),ee=f.$r(R),(H=k.$$prototype).game_system=H.text=re,v(k,"$process",function(M,C){return ee("Preprocessor").$new(M,C).$process()}),D(k,"$initialize",function(M,C){return this.text=M,this.game_system=C}),D(k,"$process",function(){var M=this;return M.$trim_after_whitespace(),M.$replace_parentheses(),M.text=M.game_system.$change_text(M.text),M.$replace_implicit_d(),M.text}),k.$private(),D(k,"$trim_after_whitespace",function(){return this.text=this.text.$strip().$split(/\s/,2).$first()}),D(k,"$replace_parentheses",function(){try{U("eval_return");var C=this;return function(){try{var P=U("break");return z(C,"loop",[],function L(){var F,ne=null==L.$$s?this:L.$$s;if(null==ne.text&&(ne.text=re),F=ne.text,ne.text=z(ne.text,"gsub",[/\([\d\/+*\-CURF]+\)/],function he(B){var m,O=null==he.$$s?this:he.$$s;return null==O.game_system&&(O.game_system=re),null==B&&(B=re),I(m=ee("Arithmetic").$eval(B,O.game_system.$round_type()))?m:B},{$$s:ne}),!Q(F,ne.text))return re;P.$throw()},{$$s:C})}catch(L){if(L===P)return L.$v;throw L}}()}catch(P){if(P===f.t_eval_return)return P.$v;throw P}}),D(k,"$replace_implicit_d",function(){var M=this;return M.text=z(M.text,"gsub",[/(\d+)D([^\w]|$)/i],function C(){var P=null==C.$$s?this:C.$$s;return null==P.game_system&&(P.game_system=re),ee("Regexp").$last_match(1)+"D"+P.game_system.$sides_implicit_d()+ee("Regexp").$last_match(2)},{$$s:M})})})},6956:(T,fe,Ce)=>{Ce(9993),Opal.queue(function(f){var I,v=[];return I=v,(0,f.const_set)([(0,f.module)(v[0],"BCDice")].concat(I)[0],"VERSION","3.14.0")})},3583:function(T,fe,Ce){"use strict";var f=this&&this.__importDefault||function(v){return v&&v.__esModule?v:{default:v}};Object.defineProperty(fe,"__esModule",{value:!0}),fe.Opal=fe.I18n=fe.BCDice=void 0,Ce(6956);var S=f(Ce(8459));fe.BCDice=S.default.module(null,"BCDice"),fe.I18n=S.default.module(null,"I18n");var te=Ce(8459);Object.defineProperty(fe,"Opal",{enumerable:!0,get:function(){return f(te).default}})},8459:(T,fe,Ce)=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.nilToNull=void 0,Ce(9993),Opal.config.unsupported_features_severity="ignore",fe.default=Opal,fe.nilToNull=function f(S){return S===Opal.nil?null:S}},3693:function(T,fe,Ce){"use strict";var f=this&&this.__assign||function(){return f=Object.assign||function(D){for(var z,I=1,Q=arguments.length;I<Q;I++)for(var U in z=arguments[I])Object.prototype.hasOwnProperty.call(z,U)&&(D[U]=z[U]);return D},f.apply(this,arguments)},S=this&&this.__rest||function(D,z){var I={};for(var Q in D)Object.prototype.hasOwnProperty.call(D,Q)&&z.indexOf(Q)<0&&(I[Q]=D[Q]);if(null!=D&&"function"==typeof Object.getOwnPropertySymbols){var U=0;for(Q=Object.getOwnPropertySymbols(D);U<Q.length;U++)z.indexOf(Q[U])<0&&Object.prototype.propertyIsEnumerable.call(D,Q[U])&&(I[Q[U]]=D[Q[U]])}return I};Object.defineProperty(fe,"__esModule",{value:!0}),fe.parseResult=void 0;var te=Ce(3583);fe.parseResult=function v(D){if(D===te.Opal.nil)return null;var z=D.detailed_rands,I=S(D,["detailed_rands"]);return f(f({},I),{detailedRands:z.map(function(Q){return Q.$to_n()})})}},7585:function(T,fe,Ce){var f;T.exports=(f=f||function(S,te){var v;if("undefined"!=typeof window&&window.crypto&&(v=window.crypto),"undefined"!=typeof self&&self.crypto&&(v=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(v=globalThis.crypto),!v&&"undefined"!=typeof window&&window.msCrypto&&(v=window.msCrypto),!v&&"undefined"!=typeof global&&global.crypto&&(v=global.crypto),!v)try{v=Ce(2480)}catch(Y){}var D=function(){if(v){if("function"==typeof v.getRandomValues)try{return v.getRandomValues(new Uint32Array(1))[0]}catch(Y){}if("function"==typeof v.randomBytes)try{return v.randomBytes(4).readInt32LE()}catch(Y){}}throw new Error("Native crypto module could not be used to get secure random number.")},z=Object.create||function(){function Y(){}return function(X){var k;return Y.prototype=X,k=new Y,Y.prototype=null,k}}(),I={},Q=I.lib={},U=Q.Base={extend:function(Y){var X=z(this);return Y&&X.mixIn(Y),(!X.hasOwnProperty("init")||this.init===X.init)&&(X.init=function(){X.$super.init.apply(this,arguments)}),X.init.prototype=X,X.$super=this,X},create:function(){var Y=this.extend();return Y.init.apply(Y,arguments),Y},init:function(){},mixIn:function(Y){for(var X in Y)Y.hasOwnProperty(X)&&(this[X]=Y[X]);Y.hasOwnProperty("toString")&&(this.toString=Y.toString)},clone:function(){return this.init.prototype.extend(this)}},N=Q.WordArray=U.extend({init:function(Y,X){Y=this.words=Y||[],this.sigBytes=null!=X?X:4*Y.length},toString:function(Y){return(Y||re).stringify(this)},concat:function(Y){var X=this.words,k=Y.words,R=this.sigBytes,ee=Y.sigBytes;if(this.clamp(),R%4)for(var H=0;H<ee;H++)X[R+H>>>2]|=(k[H>>>2]>>>24-H%4*8&255)<<24-(R+H)%4*8;else for(var M=0;M<ee;M+=4)X[R+M>>>2]=k[M>>>2];return this.sigBytes+=ee,this},clamp:function(){var Y=this.words,X=this.sigBytes;Y[X>>>2]&=4294967295<<32-X%4*8,Y.length=S.ceil(X/4)},clone:function(){var Y=U.clone.call(this);return Y.words=this.words.slice(0),Y},random:function(Y){for(var X=[],k=0;k<Y;k+=4)X.push(D());return new N.init(X,Y)}}),G=I.enc={},re=G.Hex={stringify:function(Y){for(var X=Y.words,k=Y.sigBytes,R=[],ee=0;ee<k;ee++){var H=X[ee>>>2]>>>24-ee%4*8&255;R.push((H>>>4).toString(16)),R.push((15&H).toString(16))}return R.join("")},parse:function(Y){for(var X=Y.length,k=[],R=0;R<X;R+=2)k[R>>>3]|=parseInt(Y.substr(R,2),16)<<24-R%8*4;return new N.init(k,X/2)}},q=G.Latin1={stringify:function(Y){for(var X=Y.words,k=Y.sigBytes,R=[],ee=0;ee<k;ee++)R.push(String.fromCharCode(X[ee>>>2]>>>24-ee%4*8&255));return R.join("")},parse:function(Y){for(var X=Y.length,k=[],R=0;R<X;R++)k[R>>>2]|=(255&Y.charCodeAt(R))<<24-R%4*8;return new N.init(k,X)}},E=G.Utf8={stringify:function(Y){try{return decodeURIComponent(escape(q.stringify(Y)))}catch(X){throw new Error("Malformed UTF-8 data")}},parse:function(Y){return q.parse(unescape(encodeURIComponent(Y)))}},V=Q.BufferedBlockAlgorithm=U.extend({reset:function(){this._data=new N.init,this._nDataBytes=0},_append:function(Y){"string"==typeof Y&&(Y=E.parse(Y)),this._data.concat(Y),this._nDataBytes+=Y.sigBytes},_process:function(Y){var X,k=this._data,R=k.words,ee=k.sigBytes,H=this.blockSize,M=ee/(4*H),C=(M=Y?S.ceil(M):S.max((0|M)-this._minBufferSize,0))*H,P=S.min(4*C,ee);if(C){for(var L=0;L<C;L+=H)this._doProcessBlock(R,L);X=R.splice(0,C),k.sigBytes-=P}return new N.init(X,P)},clone:function(){var Y=U.clone.call(this);return Y._data=this._data.clone(),Y},_minBufferSize:0}),Z=(Q.Hasher=V.extend({cfg:U.extend(),init:function(Y){this.cfg=this.cfg.extend(Y),this.reset()},reset:function(){V.reset.call(this),this._doReset()},update:function(Y){return this._append(Y),this._process(),this},finalize:function(Y){return Y&&this._append(Y),this._doFinalize()},blockSize:16,_createHelper:function(Y){return function(X,k){return new Y.init(k).finalize(X)}},_createHmacHelper:function(Y){return function(X,k){return new Z.HMAC.init(Y,k).finalize(X)}}}),I.algo={});return I}(Math),f)},7412:function(T,fe,Ce){var f;T.exports=(f=Ce(7585),function(){if("function"==typeof ArrayBuffer){var v=f.lib.WordArray,D=v.init,z=v.init=function(I){if(I instanceof ArrayBuffer&&(I=new Uint8Array(I)),(I instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&I instanceof Uint8ClampedArray||I instanceof Int16Array||I instanceof Uint16Array||I instanceof Int32Array||I instanceof Uint32Array||I instanceof Float32Array||I instanceof Float64Array)&&(I=new Uint8Array(I.buffer,I.byteOffset,I.byteLength)),I instanceof Uint8Array){for(var Q=I.byteLength,U=[],N=0;N<Q;N++)U[N>>>2]|=I[N]<<24-N%4*8;D.call(this,U,Q)}else D.apply(this,arguments)};z.prototype=v}}(),f.lib.WordArray)},1817:function(T,fe,Ce){var f;T.exports=(f=Ce(7585),function(S){var te=f,v=te.lib,D=v.WordArray,z=v.Hasher,I=te.algo,Q=[],U=[];!function(){function re(le){for(var Z=S.sqrt(le),Y=2;Y<=Z;Y++)if(!(le%Y))return!1;return!0}function q(le){return 4294967296*(le-(0|le))|0}for(var E=2,V=0;V<64;)re(E)&&(V<8&&(Q[V]=q(S.pow(E,.5))),U[V]=q(S.pow(E,1/3)),V++),E++}();var N=[],G=I.SHA256=z.extend({_doReset:function(){this._hash=new D.init(Q.slice(0))},_doProcessBlock:function(re,q){for(var E=this._hash.words,V=E[0],le=E[1],Z=E[2],Y=E[3],X=E[4],k=E[5],R=E[6],ee=E[7],H=0;H<64;H++){if(H<16)N[H]=0|re[q+H];else{var A=N[H-15],C=N[H-2];N[H]=((A<<25|A>>>7)^(A<<14|A>>>18)^A>>>3)+N[H-7]+((C<<15|C>>>17)^(C<<13|C>>>19)^C>>>10)+N[H-16]}var ne=V&le^V&Z^le&Z,B=ee+((X<<26|X>>>6)^(X<<21|X>>>11)^(X<<7|X>>>25))+(X&k^~X&R)+U[H]+N[H];ee=R,R=k,k=X,X=Y+B|0,Y=Z,Z=le,le=V,V=B+(((V<<30|V>>>2)^(V<<19|V>>>13)^(V<<10|V>>>22))+ne)|0}E[0]=E[0]+V|0,E[1]=E[1]+le|0,E[2]=E[2]+Z|0,E[3]=E[3]+Y|0,E[4]=E[4]+X|0,E[5]=E[5]+k|0,E[6]=E[6]+R|0,E[7]=E[7]+ee|0},_doFinalize:function(){var re=this._data,q=re.words,E=8*this._nDataBytes,V=8*re.sigBytes;return q[V>>>5]|=128<<24-V%32,q[14+(V+64>>>9<<4)]=S.floor(E/4294967296),q[15+(V+64>>>9<<4)]=E,re.sigBytes=4*q.length,this._process(),this._hash},clone:function(){var re=z.clone.call(this);return re._hash=this._hash.clone(),re}});te.SHA256=z._createHelper(G),te.HmacSHA256=z._createHmacHelper(G)}(Math),f.SHA256)},6654:T=>{!function(Ce){T.exports=Ce;var f="listeners",S={on:function v(U,N){return Q(this,U).push(N),this},once:function D(U,N){var G=this;return re.originalListener=N,Q(G,U).push(re),G;function re(){z.call(G,U,re),N.apply(this,arguments)}},off:z,emit:function I(U,N){var G=this,re=Q(G,U,!0);if(!re)return!1;var q=arguments.length;if(1===q)re.forEach(V);else if(2===q)re.forEach(le);else{var E=Array.prototype.slice.call(arguments,1);re.forEach(Z)}return!!re.length;function V(Y){Y.call(G)}function le(Y){Y.call(G,N)}function Z(Y){Y.apply(G,E)}}};function te(U){for(var N in S)U[N]=S[N];return U}function z(U,N){var re,G=this;if(arguments.length){if(N){if(re=Q(G,U,!0)){if(!(re=re.filter(q)).length)return z.call(G,U);G[f][U]=re}}else if((re=G[f])&&(delete re[U],!Object.keys(re).length))return z.call(G)}else delete G[f];return G;function q(E){return E!==N&&E.originalListener!==N}}function Q(U,N,G){if(!G||U[f]){var re=U[f]||(U[f]={});return re[N]||(re[N]=[])}}te(Ce.prototype),Ce.mixin=te}(function fe(){if(!(this instanceof fe))return new fe})},9069:T=>{"use strict";var f,fe="object"==typeof Reflect?Reflect:null,Ce=fe&&"function"==typeof fe.apply?fe.apply:function(k,R,ee){return Function.prototype.apply.call(k,R,ee)};f=fe&&"function"==typeof fe.ownKeys?fe.ownKeys:Object.getOwnPropertySymbols?function(k){return Object.getOwnPropertyNames(k).concat(Object.getOwnPropertySymbols(k))}:function(k){return Object.getOwnPropertyNames(k)};var te=Number.isNaN||function(k){return k!=k};function v(){v.init.call(this)}T.exports=v,T.exports.once=function le(X,k){return new Promise(function(R,ee){function H(M){X.removeListener(k,A),ee(M)}function A(){"function"==typeof X.removeListener&&X.removeListener("error",H),R([].slice.call(arguments))}Y(X,k,A,{once:!0}),"error"!==k&&function Z(X,k,R){"function"==typeof X.on&&Y(X,"error",k,R)}(X,H,{once:!0})})},v.EventEmitter=v,v.prototype._events=void 0,v.prototype._eventsCount=0,v.prototype._maxListeners=void 0;var D=10;function z(X){if("function"!=typeof X)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof X)}function I(X){return void 0===X._maxListeners?v.defaultMaxListeners:X._maxListeners}function Q(X,k,R,ee){var H,A,M;if(z(R),void 0===(A=X._events)?(A=X._events=Object.create(null),X._eventsCount=0):(void 0!==A.newListener&&(X.emit("newListener",k,R.listener?R.listener:R),A=X._events),M=A[k]),void 0===M)M=A[k]=R,++X._eventsCount;else if("function"==typeof M?M=A[k]=ee?[R,M]:[M,R]:ee?M.unshift(R):M.push(R),(H=I(X))>0&&M.length>H&&!M.warned){M.warned=!0;var C=new Error("Possible EventEmitter memory leak detected. "+M.length+" "+String(k)+" listeners added. Use emitter.setMaxListeners() to increase limit");C.name="MaxListenersExceededWarning",C.emitter=X,C.type=k,C.count=M.length,function S(X){console&&console.warn&&console.warn(X)}(C)}return X}function U(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function N(X,k,R){var ee={fired:!1,wrapFn:void 0,target:X,type:k,listener:R},H=U.bind(ee);return H.listener=R,ee.wrapFn=H,H}function G(X,k,R){var ee=X._events;if(void 0===ee)return[];var H=ee[k];return void 0===H?[]:"function"==typeof H?R?[H.listener||H]:[H]:R?function V(X){for(var k=new Array(X.length),R=0;R<k.length;++R)k[R]=X[R].listener||X[R];return k}(H):q(H,H.length)}function re(X){var k=this._events;if(void 0!==k){var R=k[X];if("function"==typeof R)return 1;if(void 0!==R)return R.length}return 0}function q(X,k){for(var R=new Array(k),ee=0;ee<k;++ee)R[ee]=X[ee];return R}function Y(X,k,R,ee){if("function"==typeof X.on)ee.once?X.once(k,R):X.on(k,R);else{if("function"!=typeof X.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof X);X.addEventListener(k,function H(A){ee.once&&X.removeEventListener(k,H),R(A)})}}Object.defineProperty(v,"defaultMaxListeners",{enumerable:!0,get:function(){return D},set:function(X){if("number"!=typeof X||X<0||te(X))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+X+".");D=X}}),v.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},v.prototype.setMaxListeners=function(k){if("number"!=typeof k||k<0||te(k))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+k+".");return this._maxListeners=k,this},v.prototype.getMaxListeners=function(){return I(this)},v.prototype.emit=function(k){for(var R=[],ee=1;ee<arguments.length;ee++)R.push(arguments[ee]);var H="error"===k,A=this._events;if(void 0!==A)H=H&&void 0===A.error;else if(!H)return!1;if(H){var M;if(R.length>0&&(M=R[0]),M instanceof Error)throw M;var C=new Error("Unhandled error."+(M?" ("+M.message+")":""));throw C.context=M,C}var P=A[k];if(void 0===P)return!1;if("function"==typeof P)Ce(P,this,R);else{var L=P.length,ne=q(P,L);for(ee=0;ee<L;++ee)Ce(ne[ee],this,R)}return!0},v.prototype.on=v.prototype.addListener=function(k,R){return Q(this,k,R,!1)},v.prototype.prependListener=function(k,R){return Q(this,k,R,!0)},v.prototype.once=function(k,R){return z(R),this.on(k,N(this,k,R)),this},v.prototype.prependOnceListener=function(k,R){return z(R),this.prependListener(k,N(this,k,R)),this},v.prototype.off=v.prototype.removeListener=function(k,R){var ee,H,A,M,C;if(z(R),void 0===(H=this._events))return this;if(void 0===(ee=H[k]))return this;if(ee===R||ee.listener===R)0==--this._eventsCount?this._events=Object.create(null):(delete H[k],H.removeListener&&this.emit("removeListener",k,ee.listener||R));else if("function"!=typeof ee){for(A=-1,M=ee.length-1;M>=0;M--)if(ee[M]===R||ee[M].listener===R){C=ee[M].listener,A=M;break}if(A<0)return this;0===A?ee.shift():function E(X,k){for(;k+1<X.length;k++)X[k]=X[k+1];X.pop()}(ee,A),1===ee.length&&(H[k]=ee[0]),void 0!==H.removeListener&&this.emit("removeListener",k,C||R)}return this},v.prototype.removeAllListeners=function(k){var R,ee,H;if(void 0===(ee=this._events))return this;if(void 0===ee.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==ee[k]&&(0==--this._eventsCount?this._events=Object.create(null):delete ee[k]),this;if(0===arguments.length){var M,A=Object.keys(ee);for(H=0;H<A.length;++H)"removeListener"!==(M=A[H])&&this.removeAllListeners(M);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(R=ee[k]))this.removeListener(k,R);else if(void 0!==R)for(H=R.length-1;H>=0;H--)this.removeListener(k,R[H]);return this},v.prototype.listeners=function(k){return G(this,k,!0)},v.prototype.rawListeners=function(k){return G(this,k,!1)},v.listenerCount=function(X,k){return"function"==typeof X.listenerCount?X.listenerCount(k):re.call(X,k)},v.prototype.listenerCount=re,v.prototype.eventNames=function(){return this._eventsCount>0?f(this._events):[]}},4327:function(T,fe){var S;void 0!==(S=function(){"use strict";function v(N,G,re){var q=new XMLHttpRequest;q.open("GET",N),q.responseType="blob",q.onload=function(){U(q.response,G,re)},q.onerror=function(){console.error("could not download file")},q.send()}function D(N){var G=new XMLHttpRequest;G.open("HEAD",N,!1);try{G.send()}catch(re){}return 200<=G.status&&299>=G.status}function z(N){try{N.dispatchEvent(new MouseEvent("click"))}catch(re){var G=document.createEvent("MouseEvents");G.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),N.dispatchEvent(G)}}var I="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,Q=I.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),U=I.saveAs||("object"!=typeof window||window!==I?function(){}:"download"in HTMLAnchorElement.prototype&&!Q?function(N,G,re){var q=I.URL||I.webkitURL,E=document.createElement("a");E.download=G=G||N.name||"download",E.rel="noopener","string"==typeof N?(E.href=N,E.origin===location.origin?z(E):D(E.href)?v(N,G,re):z(E,E.target="_blank")):(E.href=q.createObjectURL(N),setTimeout(function(){q.revokeObjectURL(E.href)},4e4),setTimeout(function(){z(E)},0))}:"msSaveOrOpenBlob"in navigator?function(N,G,re){if(G=G||N.name||"download","string"!=typeof N)navigator.msSaveOrOpenBlob(function te(N,G){return void 0===G?G={autoBom:!1}:"object"!=typeof G&&(console.warn("Deprecated: Expected third argument to be a object"),G={autoBom:!G}),G.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(N.type)?new Blob(["\ufeff",N],{type:N.type}):N}(N,re),G);else if(D(N))v(N,G,re);else{var q=document.createElement("a");q.href=N,q.target="_blank",setTimeout(function(){z(q)})}}:function(N,G,re,q){if((q=q||open("","_blank"))&&(q.document.title=q.document.body.innerText="downloading..."),"string"==typeof N)return v(N,G,re);var E="application/octet-stream"===N.type,V=/constructor/i.test(I.HTMLElement)||I.safari,le=/CriOS\/[\d]+/.test(navigator.userAgent);if((le||E&&V||Q)&&"undefined"!=typeof FileReader){var Z=new FileReader;Z.onloadend=function(){var k=Z.result;k=le?k:k.replace(/^data:[^;]*;/,"data:attachment/file;"),q?q.location.href=k:location=k,q=null},Z.readAsDataURL(N)}else{var Y=I.URL||I.webkitURL,X=Y.createObjectURL(N);q?q.location=X:location.href=X,q=null,setTimeout(function(){Y.revokeObjectURL(X)},4e4)}});I.saveAs=U.saveAs=U,T.exports=U}.apply(fe,[]))&&(T.exports=S)},5386:(T,fe,Ce)=>{var f;!function(S,te,v,D){"use strict";var le,z=["","webkit","Moz","MS","ms","o"],I=te.createElement("div"),U=Math.round,N=Math.abs,G=Date.now;function re(ze,qe,tt){return setTimeout(k(ze,tt),qe)}function q(ze,qe,tt){return!!Array.isArray(ze)&&(E(ze,tt[qe],tt),!0)}function E(ze,qe,tt){var ht;if(ze)if(ze.forEach)ze.forEach(qe,tt);else if(ze.length!==D)for(ht=0;ht<ze.length;)qe.call(tt,ze[ht],ht,ze),ht++;else for(ht in ze)ze.hasOwnProperty(ht)&&qe.call(tt,ze[ht],ht,ze)}function V(ze,qe,tt){var ht="DEPRECATED METHOD: "+qe+"\n"+tt+" AT \n";return function(){var kt=new Error("get-stack-trace"),Gt=kt&&kt.stack?kt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Vn=S.console&&(S.console.warn||S.console.log);return Vn&&Vn.call(S.console,ht,Gt),ze.apply(this,arguments)}}le="function"!=typeof Object.assign?function(qe){if(qe===D||null===qe)throw new TypeError("Cannot convert undefined or null to object");for(var tt=Object(qe),ht=1;ht<arguments.length;ht++){var kt=arguments[ht];if(kt!==D&&null!==kt)for(var Gt in kt)kt.hasOwnProperty(Gt)&&(tt[Gt]=kt[Gt])}return tt}:Object.assign;var Z=V(function(qe,tt,ht){for(var kt=Object.keys(tt),Gt=0;Gt<kt.length;)(!ht||ht&&qe[kt[Gt]]===D)&&(qe[kt[Gt]]=tt[kt[Gt]]),Gt++;return qe},"extend","Use `assign`."),Y=V(function(qe,tt){return Z(qe,tt,!0)},"merge","Use `assign`.");function X(ze,qe,tt){var kt,ht=qe.prototype;(kt=ze.prototype=Object.create(ht)).constructor=ze,kt._super=ht,tt&&le(kt,tt)}function k(ze,qe){return function(){return ze.apply(qe,arguments)}}function R(ze,qe){return"function"==typeof ze?ze.apply(qe&&qe[0]||D,qe):ze}function ee(ze,qe){return ze===D?qe:ze}function H(ze,qe,tt){E(P(qe),function(ht){ze.addEventListener(ht,tt,!1)})}function A(ze,qe,tt){E(P(qe),function(ht){ze.removeEventListener(ht,tt,!1)})}function M(ze,qe){for(;ze;){if(ze==qe)return!0;ze=ze.parentNode}return!1}function C(ze,qe){return ze.indexOf(qe)>-1}function P(ze){return ze.trim().split(/\s+/g)}function L(ze,qe,tt){if(ze.indexOf&&!tt)return ze.indexOf(qe);for(var ht=0;ht<ze.length;){if(tt&&ze[ht][tt]==qe||!tt&&ze[ht]===qe)return ht;ht++}return-1}function ne(ze){return Array.prototype.slice.call(ze,0)}function F(ze,qe,tt){for(var ht=[],kt=[],Gt=0;Gt<ze.length;){var Vn=qe?ze[Gt][qe]:ze[Gt];L(kt,Vn)<0&&ht.push(ze[Gt]),kt[Gt]=Vn,Gt++}return tt&&(ht=qe?ht.sort(function(gr,ro){return gr[qe]>ro[qe]}):ht.sort()),ht}function he(ze,qe){for(var tt,ht,kt=qe[0].toUpperCase()+qe.slice(1),Gt=0;Gt<z.length;){if((ht=(tt=z[Gt])?tt+kt:qe)in ze)return ht;Gt++}return D}var B=1;function m(ze){var qe=ze.ownerDocument||ze;return qe.defaultView||qe.parentWindow||S}var c="ontouchstart"in S,h=he(S,"PointerEvent")!==D,d=c&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),p="touch",x="mouse",ye=["x","y"],b=["clientX","clientY"];function K(ze,qe){var tt=this;this.manager=ze,this.callback=qe,this.element=ze.element,this.target=ze.options.inputTarget,this.domHandler=function(ht){R(ze.options.enable,[ze])&&tt.handler(ht)},this.init()}function be(ze,qe,tt){var ht=tt.pointers.length,kt=tt.changedPointers.length,Gt=1&qe&&ht-kt==0,Vn=12&qe&&ht-kt==0;tt.isFirst=!!Gt,tt.isFinal=!!Vn,Gt&&(ze.session={}),tt.eventType=qe,function Pe(ze,qe){var tt=ze.session,ht=qe.pointers,kt=ht.length;tt.firstInput||(tt.firstInput=nt(qe)),kt>1&&!tt.firstMultiple?tt.firstMultiple=nt(qe):1===kt&&(tt.firstMultiple=!1);var Gt=tt.firstInput,Vn=tt.firstMultiple,pr=Vn?Vn.center:Gt.center,gr=qe.center=vt(ht);qe.timeStamp=G(),qe.deltaTime=qe.timeStamp-Gt.timeStamp,qe.angle=Bn(pr,gr),qe.distance=an(pr,gr),function Ue(ze,qe){var tt=qe.center,ht=ze.offsetDelta||{},kt=ze.prevDelta||{},Gt=ze.prevInput||{};(1===qe.eventType||4===Gt.eventType)&&(kt=ze.prevDelta={x:Gt.deltaX||0,y:Gt.deltaY||0},ht=ze.offsetDelta={x:tt.x,y:tt.y}),qe.deltaX=kt.x+(tt.x-ht.x),qe.deltaY=kt.y+(tt.y-ht.y)}(tt,qe),qe.offsetDirection=cn(qe.deltaX,qe.deltaY);var ro=wt(qe.deltaTime,qe.deltaX,qe.deltaY);qe.overallVelocityX=ro.x,qe.overallVelocityY=ro.y,qe.overallVelocity=N(ro.x)>N(ro.y)?ro.x:ro.y,qe.scale=Vn?function Hi(ze,qe){return an(qe[0],qe[1],b)/an(ze[0],ze[1],b)}(Vn.pointers,ht):1,qe.rotation=Vn?function zn(ze,qe){return Bn(qe[1],qe[0],b)+Bn(ze[1],ze[0],b)}(Vn.pointers,ht):0,qe.maxPointers=tt.prevInput?qe.pointers.length>tt.prevInput.maxPointers?qe.pointers.length:tt.prevInput.maxPointers:qe.pointers.length,function Ye(ze,qe){var kt,Gt,Vn,pr,tt=ze.lastInterval||qe,ht=qe.timeStamp-tt.timeStamp;if(8!=qe.eventType&&(ht>25||tt.velocity===D)){var gr=qe.deltaX-tt.deltaX,ro=qe.deltaY-tt.deltaY,ys=wt(ht,gr,ro);Gt=ys.x,Vn=ys.y,kt=N(ys.x)>N(ys.y)?ys.x:ys.y,pr=cn(gr,ro),ze.lastInterval=qe}else kt=tt.velocity,Gt=tt.velocityX,Vn=tt.velocityY,pr=tt.direction;qe.velocity=kt,qe.velocityX=Gt,qe.velocityY=Vn,qe.direction=pr}(tt,qe);var ys=ze.element;M(qe.srcEvent.target,ys)&&(ys=qe.srcEvent.target),qe.target=ys}(ze,tt),ze.emit("hammer.input",tt),ze.recognize(tt),ze.session.prevInput=tt}function nt(ze){for(var qe=[],tt=0;tt<ze.pointers.length;)qe[tt]={clientX:U(ze.pointers[tt].clientX),clientY:U(ze.pointers[tt].clientY)},tt++;return{timeStamp:G(),pointers:qe,center:vt(qe),deltaX:ze.deltaX,deltaY:ze.deltaY}}function vt(ze){var qe=ze.length;if(1===qe)return{x:U(ze[0].clientX),y:U(ze[0].clientY)};for(var tt=0,ht=0,kt=0;kt<qe;)tt+=ze[kt].clientX,ht+=ze[kt].clientY,kt++;return{x:U(tt/qe),y:U(ht/qe)}}function wt(ze,qe,tt){return{x:qe/ze||0,y:tt/ze||0}}function cn(ze,qe){return ze===qe?1:N(ze)>=N(qe)?ze<0?2:4:qe<0?8:16}function an(ze,qe,tt){tt||(tt=ye);var ht=qe[tt[0]]-ze[tt[0]],kt=qe[tt[1]]-ze[tt[1]];return Math.sqrt(ht*ht+kt*kt)}function Bn(ze,qe,tt){return tt||(tt=ye),180*Math.atan2(qe[tt[1]]-ze[tt[1]],qe[tt[0]]-ze[tt[0]])/Math.PI}K.prototype={handler:function(){},init:function(){this.evEl&&H(this.element,this.evEl,this.domHandler),this.evTarget&&H(this.target,this.evTarget,this.domHandler),this.evWin&&H(m(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&A(this.element,this.evEl,this.domHandler),this.evTarget&&A(this.target,this.evTarget,this.domHandler),this.evWin&&A(m(this.element),this.evWin,this.domHandler)}};var lr={mousedown:1,mousemove:2,mouseup:4},Sl="mousedown",vc="mousemove mouseup";function Jo(){this.evEl=Sl,this.evWin=vc,this.pressed=!1,K.apply(this,arguments)}X(Jo,K,{handler:function(qe){var tt=lr[qe.type];1&tt&&0===qe.button&&(this.pressed=!0),2&tt&&1!==qe.which&&(tt=4),this.pressed&&(4&tt&&(this.pressed=!1),this.callback(this.manager,tt,{pointers:[qe],changedPointers:[qe],pointerType:x,srcEvent:qe}))}});var Dl={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Cd={2:p,3:"pen",4:x,5:"kinect"},eu="pointerdown",xd="pointermove pointerup pointercancel";function tu(){this.evEl=eu,this.evWin=xd,K.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}S.MSPointerEvent&&!S.PointerEvent&&(eu="MSPointerDown",xd="MSPointerMove MSPointerUp MSPointerCancel"),X(tu,K,{handler:function(qe){var tt=this.store,ht=!1,kt=qe.type.toLowerCase().replace("ms",""),Gt=Dl[kt],Vn=Cd[qe.pointerType]||qe.pointerType,pr=Vn==p,gr=L(tt,qe.pointerId,"pointerId");1&Gt&&(0===qe.button||pr)?gr<0&&(tt.push(qe),gr=tt.length-1):12&Gt&&(ht=!0),!(gr<0)&&(tt[gr]=qe,this.callback(this.manager,Gt,{pointers:tt,changedPointers:[qe],pointerType:Vn,srcEvent:qe}),ht&&tt.splice(gr,1))}});var Mo={touchstart:1,touchmove:2,touchend:4,touchcancel:8},Bp="touchstart",jf="touchstart touchmove touchend touchcancel";function Gf(){this.evTarget=Bp,this.evWin=jf,this.started=!1,K.apply(this,arguments)}function Lp(ze,qe){var tt=ne(ze.touches),ht=ne(ze.changedTouches);return 12&qe&&(tt=F(tt.concat(ht),"identifier",!0)),[tt,ht]}X(Gf,K,{handler:function(qe){var tt=Mo[qe.type];if(1===tt&&(this.started=!0),this.started){var ht=Lp.call(this,qe,tt);12&tt&&ht[0].length-ht[1].length==0&&(this.started=!1),this.callback(this.manager,tt,{pointers:ht[0],changedPointers:ht[1],pointerType:p,srcEvent:qe})}}});var qf={touchstart:1,touchmove:2,touchend:4,touchcancel:8},wd="touchstart touchmove touchend touchcancel";function nu(){this.evTarget=wd,this.targetIds={},K.apply(this,arguments)}function es(ze,qe){var tt=ne(ze.touches),ht=this.targetIds;if(3&qe&&1===tt.length)return ht[tt[0].identifier]=!0,[tt,tt];var kt,Gt,Vn=ne(ze.changedTouches),pr=[],gr=this.target;if(Gt=tt.filter(function(ro){return M(ro.target,gr)}),1===qe)for(kt=0;kt<Gt.length;)ht[Gt[kt].identifier]=!0,kt++;for(kt=0;kt<Vn.length;)ht[Vn[kt].identifier]&&pr.push(Vn[kt]),12&qe&&delete ht[Vn[kt].identifier],kt++;return pr.length?[F(Gt.concat(pr),"identifier",!0),pr]:void 0}function iu(){K.apply(this,arguments);var ze=k(this.handler,this);this.touch=new nu(this.manager,ze),this.mouse=new Jo(this.manager,ze),this.primaryTouch=null,this.lastTouches=[]}function Ed(ze,qe){1&ze?(this.primaryTouch=qe.changedPointers[0].identifier,Hp.call(this,qe)):12&ze&&Hp.call(this,qe)}function Hp(ze){var qe=ze.changedPointers[0];if(qe.identifier===this.primaryTouch){var tt={x:qe.clientX,y:qe.clientY};this.lastTouches.push(tt);var ht=this.lastTouches;setTimeout(function(){var Gt=ht.indexOf(tt);Gt>-1&&ht.splice(Gt,1)},2500)}}function Vp(ze){for(var qe=ze.srcEvent.clientX,tt=ze.srcEvent.clientY,ht=0;ht<this.lastTouches.length;ht++){var kt=this.lastTouches[ht],Gt=Math.abs(qe-kt.x),Vn=Math.abs(tt-kt.y);if(Gt<=25&&Vn<=25)return!0}return!1}X(nu,K,{handler:function(qe){var tt=qf[qe.type],ht=es.call(this,qe,tt);!ht||this.callback(this.manager,tt,{pointers:ht[0],changedPointers:ht[1],pointerType:p,srcEvent:qe})}}),X(iu,K,{handler:function(qe,tt,ht){var Gt=ht.pointerType==x;if(!(Gt&&ht.sourceCapabilities&&ht.sourceCapabilities.firesTouchEvents)){if(ht.pointerType==p)Ed.call(this,tt,ht);else if(Gt&&Vp.call(this,ht))return;this.callback(qe,tt,ht)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Td=he(I.style,"touchAction"),ru=Td!==D,Il="compute",Sd="manipulation",ha="none",Ml="pan-x",yc="pan-y",ou=function Cc(){if(!ru)return!1;var ze={},qe=S.CSS&&S.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(tt){ze[tt]=!qe||S.CSS.supports("touch-action",tt)}),ze}();function Al(ze,qe){this.manager=ze,this.set(qe)}function Zn(ze){this.options=le({},this.defaults,ze||{}),this.id=function O(){return B++}(),this.manager=null,this.options.enable=ee(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function au(ze){return 16&ze?"cancel":8&ze?"end":4&ze?"move":2&ze?"start":""}function ui(ze){return 16==ze?"down":8==ze?"up":2==ze?"left":4==ze?"right":""}function Za(ze,qe){var tt=qe.manager;return tt?tt.get(ze):ze}function Ro(){Zn.apply(this,arguments)}function oi(){Ro.apply(this,arguments),this.pX=null,this.pY=null}function Dn(){Ro.apply(this,arguments)}function lu(){Zn.apply(this,arguments),this._timer=null,this._input=null}function Dd(){Ro.apply(this,arguments)}function jt(){Ro.apply(this,arguments)}function Ya(){Zn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function _n(ze,qe){return(qe=qe||{}).recognizers=ee(qe.recognizers,_n.defaults.preset),new cu(ze,qe)}function cu(ze,qe){this.options=le({},_n.defaults,qe||{}),this.options.inputTarget=this.options.inputTarget||ze,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ze,this.input=function ge(ze){return new(ze.options.inputClass||(h?tu:d?nu:c?iu:Jo))(ze,be)}(this),this.touchAction=new Al(this,this.options.touchAction),jp(this,!0),E(this.options.recognizers,function(tt){var ht=this.add(new tt[0](tt[1]));tt[2]&&ht.recognizeWith(tt[2]),tt[3]&&ht.requireFailure(tt[3])},this)}function jp(ze,qe){var ht,tt=ze.element;tt.style&&(E(ze.options.cssProps,function(kt,Gt){ht=he(tt.style,Gt),qe?(ze.oldCssProps[ht]=tt.style[ht],tt.style[ht]=kt):tt.style[ht]=ze.oldCssProps[ht]||""}),qe||(ze.oldCssProps={}))}Al.prototype={set:function(ze){ze==Il&&(ze=this.compute()),ru&&this.manager.element.style&&ou[ze]&&(this.manager.element.style[Td]=ze),this.actions=ze.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ze=[];return E(this.manager.recognizers,function(qe){R(qe.options.enable,[qe])&&(ze=ze.concat(qe.getTouchAction()))}),function Up(ze){if(C(ze,ha))return ha;var qe=C(ze,Ml),tt=C(ze,yc);return qe&&tt?ha:qe||tt?qe?Ml:yc:C(ze,Sd)?Sd:"auto"}(ze.join(" "))},preventDefaults:function(ze){var qe=ze.srcEvent,tt=ze.offsetDirection;if(!this.manager.session.prevented){var ht=this.actions,kt=C(ht,ha)&&!ou[ha],Gt=C(ht,yc)&&!ou[yc],Vn=C(ht,Ml)&&!ou[Ml];if(kt&&1===ze.pointers.length&&ze.distance<2&&ze.deltaTime<250)return;return Vn&&Gt||!(kt||Gt&&6&tt||Vn&&24&tt)?void 0:this.preventSrc(qe)}qe.preventDefault()},preventSrc:function(ze){this.manager.session.prevented=!0,ze.preventDefault()}},Zn.prototype={defaults:{},set:function(ze){return le(this.options,ze),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ze){if(q(ze,"recognizeWith",this))return this;var qe=this.simultaneous;return qe[(ze=Za(ze,this)).id]||(qe[ze.id]=ze,ze.recognizeWith(this)),this},dropRecognizeWith:function(ze){return q(ze,"dropRecognizeWith",this)||(ze=Za(ze,this),delete this.simultaneous[ze.id]),this},requireFailure:function(ze){if(q(ze,"requireFailure",this))return this;var qe=this.requireFail;return-1===L(qe,ze=Za(ze,this))&&(qe.push(ze),ze.requireFailure(this)),this},dropRequireFailure:function(ze){if(q(ze,"dropRequireFailure",this))return this;ze=Za(ze,this);var qe=L(this.requireFail,ze);return qe>-1&&this.requireFail.splice(qe,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ze){return!!this.simultaneous[ze.id]},emit:function(ze){var qe=this,tt=this.state;function ht(kt){qe.manager.emit(kt,ze)}tt<8&&ht(qe.options.event+au(tt)),ht(qe.options.event),ze.additionalEvent&&ht(ze.additionalEvent),tt>=8&&ht(qe.options.event+au(tt))},tryEmit:function(ze){if(this.canEmit())return this.emit(ze);this.state=32},canEmit:function(){for(var ze=0;ze<this.requireFail.length;){if(!(33&this.requireFail[ze].state))return!1;ze++}return!0},recognize:function(ze){var qe=le({},ze);if(!R(this.options.enable,[this,qe]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(qe),30&this.state&&this.tryEmit(qe)},process:function(ze){},getTouchAction:function(){},reset:function(){}},X(Ro,Zn,{defaults:{pointers:1},attrTest:function(ze){var qe=this.options.pointers;return 0===qe||ze.pointers.length===qe},process:function(ze){var qe=this.state,tt=ze.eventType,ht=6&qe,kt=this.attrTest(ze);return ht&&(8&tt||!kt)?16|qe:ht||kt?4&tt?8|qe:2&qe?4|qe:2:32}}),X(oi,Ro,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var ze=this.options.direction,qe=[];return 6&ze&&qe.push(yc),24&ze&&qe.push(Ml),qe},directionTest:function(ze){var qe=this.options,tt=!0,ht=ze.distance,kt=ze.direction,Gt=ze.deltaX,Vn=ze.deltaY;return kt&qe.direction||(6&qe.direction?(kt=0===Gt?1:Gt<0?2:4,tt=Gt!=this.pX,ht=Math.abs(ze.deltaX)):(kt=0===Vn?1:Vn<0?8:16,tt=Vn!=this.pY,ht=Math.abs(ze.deltaY))),ze.direction=kt,tt&&ht>qe.threshold&&kt&qe.direction},attrTest:function(ze){return Ro.prototype.attrTest.call(this,ze)&&(2&this.state||!(2&this.state)&&this.directionTest(ze))},emit:function(ze){this.pX=ze.deltaX,this.pY=ze.deltaY;var qe=ui(ze.direction);qe&&(ze.additionalEvent=this.options.event+qe),this._super.emit.call(this,ze)}}),X(Dn,Ro,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ha]},attrTest:function(ze){return this._super.attrTest.call(this,ze)&&(Math.abs(ze.scale-1)>this.options.threshold||2&this.state)},emit:function(ze){1!==ze.scale&&(ze.additionalEvent=this.options.event+(ze.scale<1?"in":"out")),this._super.emit.call(this,ze)}}),X(lu,Zn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(ze){var qe=this.options,tt=ze.pointers.length===qe.pointers,ht=ze.distance<qe.threshold,kt=ze.deltaTime>qe.time;if(this._input=ze,!ht||!tt||12&ze.eventType&&!kt)this.reset();else if(1&ze.eventType)this.reset(),this._timer=re(function(){this.state=8,this.tryEmit()},qe.time,this);else if(4&ze.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(ze){8===this.state&&(ze&&4&ze.eventType?this.manager.emit(this.options.event+"up",ze):(this._input.timeStamp=G(),this.manager.emit(this.options.event,this._input)))}}),X(Dd,Ro,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ha]},attrTest:function(ze){return this._super.attrTest.call(this,ze)&&(Math.abs(ze.rotation)>this.options.threshold||2&this.state)}}),X(jt,Ro,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return oi.prototype.getTouchAction.call(this)},attrTest:function(ze){var tt,qe=this.options.direction;return 30&qe?tt=ze.overallVelocity:6&qe?tt=ze.overallVelocityX:24&qe&&(tt=ze.overallVelocityY),this._super.attrTest.call(this,ze)&&qe&ze.offsetDirection&&ze.distance>this.options.threshold&&ze.maxPointers==this.options.pointers&&N(tt)>this.options.velocity&&4&ze.eventType},emit:function(ze){var qe=ui(ze.offsetDirection);qe&&this.manager.emit(this.options.event+qe,ze),this.manager.emit(this.options.event,ze)}}),X(Ya,Zn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Sd]},process:function(ze){var qe=this.options,tt=ze.pointers.length===qe.pointers,ht=ze.distance<qe.threshold,kt=ze.deltaTime<qe.time;if(this.reset(),1&ze.eventType&&0===this.count)return this.failTimeout();if(ht&&kt&&tt){if(4!=ze.eventType)return this.failTimeout();var Gt=!this.pTime||ze.timeStamp-this.pTime<qe.interval,Vn=!this.pCenter||an(this.pCenter,ze.center)<qe.posThreshold;if(this.pTime=ze.timeStamp,this.pCenter=ze.center,Vn&&Gt?this.count+=1:this.count=1,this._input=ze,0==this.count%qe.taps)return this.hasRequireFailures()?(this._timer=re(function(){this.state=8,this.tryEmit()},qe.interval,this),2):8}return 32},failTimeout:function(){return this._timer=re(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),_n.VERSION="2.0.7",_n.defaults={domEvents:!1,touchAction:Il,enable:!0,inputTarget:null,inputClass:null,preset:[[Dd,{enable:!1}],[Dn,{enable:!1},["rotate"]],[jt,{direction:6}],[oi,{direction:6},["swipe"]],[Ya],[Ya,{event:"doubletap",taps:2},["tap"]],[lu]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},cu.prototype={set:function(ze){return le(this.options,ze),ze.touchAction&&this.touchAction.update(),ze.inputTarget&&(this.input.destroy(),this.input.target=ze.inputTarget,this.input.init()),this},stop:function(ze){this.session.stopped=ze?2:1},recognize:function(ze){var qe=this.session;if(!qe.stopped){this.touchAction.preventDefaults(ze);var tt,ht=this.recognizers,kt=qe.curRecognizer;(!kt||kt&&8&kt.state)&&(kt=qe.curRecognizer=null);for(var Gt=0;Gt<ht.length;)tt=ht[Gt],2===qe.stopped||kt&&tt!=kt&&!tt.canRecognizeWith(kt)?tt.reset():tt.recognize(ze),!kt&&14&tt.state&&(kt=qe.curRecognizer=tt),Gt++}},get:function(ze){if(ze instanceof Zn)return ze;for(var qe=this.recognizers,tt=0;tt<qe.length;tt++)if(qe[tt].options.event==ze)return qe[tt];return null},add:function(ze){if(q(ze,"add",this))return this;var qe=this.get(ze.options.event);return qe&&this.remove(qe),this.recognizers.push(ze),ze.manager=this,this.touchAction.update(),ze},remove:function(ze){if(q(ze,"remove",this))return this;if(ze=this.get(ze)){var qe=this.recognizers,tt=L(qe,ze);-1!==tt&&(qe.splice(tt,1),this.touchAction.update())}return this},on:function(ze,qe){if(ze!==D&&qe!==D){var tt=this.handlers;return E(P(ze),function(ht){tt[ht]=tt[ht]||[],tt[ht].push(qe)}),this}},off:function(ze,qe){if(ze!==D){var tt=this.handlers;return E(P(ze),function(ht){qe?tt[ht]&&tt[ht].splice(L(tt[ht],qe),1):delete tt[ht]}),this}},emit:function(ze,qe){this.options.domEvents&&function xc(ze,qe){var tt=te.createEvent("Event");tt.initEvent(ze,!0,!0),tt.gesture=qe,qe.target.dispatchEvent(tt)}(ze,qe);var tt=this.handlers[ze]&&this.handlers[ze].slice();if(tt&&tt.length){qe.type=ze,qe.preventDefault=function(){qe.srcEvent.preventDefault()};for(var ht=0;ht<tt.length;)tt[ht](qe),ht++}},destroy:function(){this.element&&jp(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},le(_n,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:cu,Input:K,TouchAction:Al,TouchInput:nu,MouseInput:Jo,PointerEventInput:tu,TouchMouseInput:iu,SingleTouchInput:Gf,Recognizer:Zn,AttrRecognizer:Ro,Tap:Ya,Pan:oi,Swipe:jt,Pinch:Dn,Rotate:Dd,Press:lu,on:H,off:A,each:E,merge:Y,extend:Z,assign:le,inherit:X,bindFn:k,prefixed:he}),(void 0!==S?S:"undefined"!=typeof self?self:{}).Hammer=_n,(f=function(){return _n}.call(fe,Ce,fe,T))!==D&&(T.exports=f)}(window,document)},8461:(T,fe)=>{fe.read=function(Ce,f,S,te,v){var D,z,I=8*v-te-1,Q=(1<<I)-1,U=Q>>1,N=-7,G=S?v-1:0,re=S?-1:1,q=Ce[f+G];for(G+=re,D=q&(1<<-N)-1,q>>=-N,N+=I;N>0;D=256*D+Ce[f+G],G+=re,N-=8);for(z=D&(1<<-N)-1,D>>=-N,N+=te;N>0;z=256*z+Ce[f+G],G+=re,N-=8);if(0===D)D=1-U;else{if(D===Q)return z?NaN:1/0*(q?-1:1);z+=Math.pow(2,te),D-=U}return(q?-1:1)*z*Math.pow(2,D-te)},fe.write=function(Ce,f,S,te,v,D){var z,I,Q,U=8*D-v-1,N=(1<<U)-1,G=N>>1,re=23===v?Math.pow(2,-24)-Math.pow(2,-77):0,q=te?0:D-1,E=te?1:-1,V=f<0||0===f&&1/f<0?1:0;for(f=Math.abs(f),isNaN(f)||f===1/0?(I=isNaN(f)?1:0,z=N):(z=Math.floor(Math.log(f)/Math.LN2),f*(Q=Math.pow(2,-z))<1&&(z--,Q*=2),(f+=z+G>=1?re/Q:re*Math.pow(2,1-G))*Q>=2&&(z++,Q/=2),z+G>=N?(I=0,z=N):z+G>=1?(I=(f*Q-1)*Math.pow(2,v),z+=G):(I=f*Math.pow(2,G-1)*Math.pow(2,v),z=0));v>=8;Ce[S+q]=255&I,q+=E,I/=256,v-=8);for(z=z<<v|I,U+=v;U>0;Ce[S+q]=255&z,q+=E,z/=256,U-=8);Ce[S+q-E]|=128*V}},6256:function(T,fe){!function(v){var q,D="undefined",z=D!==typeof Buffer&&Buffer,I=D!==typeof Uint8Array&&Uint8Array,Q=D!==typeof ArrayBuffer&&ArrayBuffer,U=[0,0,0,0,0,0,0,0],N=Array.isArray||function M(C){return!!C&&"[object Array]"==Object.prototype.toString.call(C)},G=4294967296;function E(C,P,L){var ne=P?0:4,F=P?4:0,he=P?0:3,B=P?1:2,O=P?2:1,m=P?3:0,l=P?R:H,c=P?ee:A,h=_.prototype,d="is"+C,p="_"+d;return h.buffer=void 0,h.offset=0,h[p]=!0,h.toNumber=ae,h.toString=function Te(Fe){var xe=this.buffer,ke=this.offset,De=de(xe,ke+ne),Me=de(xe,ke+F),_e="",ce=!L&&2147483648&De;for(ce&&(De=~De,Me=G-Me),Fe=Fe||10;;){var pe=De%Fe*G+Me;if(De=Math.floor(De/Fe),Me=Math.floor(pe/Fe),_e=(pe%Fe).toString(Fe)+_e,!De&&!Me)break}return ce&&(_e="-"+_e),_e},h.toJSON=ae,h.toArray=V,z&&(h.toBuffer=le),I&&(h.toArrayBuffer=Z),_[d]=function x(Fe){return!(!Fe||!Fe[p])},v[C]=_,_;function _(Fe,xe,ke,De){return this instanceof _?function $(Fe,xe,ke,De,Me){I&&Q&&(xe instanceof Q&&(xe=new I(xe)),De instanceof Q&&(De=new I(De))),xe||ke||De||q?(Y(xe,ke)||(Me=ke,De=xe,ke=0,xe=new(q||Array)(8)),Fe.buffer=xe,Fe.offset=ke|=0,D!==typeof De&&("string"==typeof De?function se(Fe,xe,ke,De){var Me=0,_e=ke.length,ce=0,pe=0;"-"===ke[0]&&Me++;for(var ye=Me;Me<_e;){var b=parseInt(ke[Me++],De);if(!(b>=0))break;pe=pe*De+b,ce=ce*De+Math.floor(pe/G),pe%=G}ye&&(ce=~ce,pe?pe=G-pe:ce++),Ae(Fe,xe+ne,ce),Ae(Fe,xe+F,pe)}(xe,ke,De,Me||10):Y(De,Me)?X(xe,ke,De,Me):"number"==typeof Me?(Ae(xe,ke+ne,De),Ae(xe,ke+F,Me)):De>0?l(xe,ke,De):De<0?c(xe,ke,De):X(xe,ke,U,0))):Fe.buffer=k(U,0)}(this,Fe,xe,ke,De):new _(Fe,xe,ke,De)}function ae(){var Fe=this.buffer,xe=this.offset,ke=de(Fe,xe+ne),De=de(Fe,xe+F);return L||(ke|=0),ke?ke*G+De:De}function Ae(Fe,xe,ke){Fe[xe+m]=255&ke,Fe[xe+O]=255&(ke>>=8),Fe[xe+B]=255&(ke>>=8),Fe[xe+he]=255&(ke>>=8)}function de(Fe,xe){return 16777216*Fe[xe+he]+(Fe[xe+B]<<16)+(Fe[xe+O]<<8)+Fe[xe+m]}}function V(C){var P=this.buffer,L=this.offset;return q=null,!1!==C&&0===L&&8===P.length&&N(P)?P:k(P,L)}function le(C){var P=this.buffer,L=this.offset;if(q=z,!1!==C&&0===L&&8===P.length&&Buffer.isBuffer(P))return P;var ne=new z(8);return X(ne,0,P,L),ne}function Z(C){var P=this.buffer,L=this.offset,ne=P.buffer;if(q=I,!1!==C&&0===L&&ne instanceof Q&&8===ne.byteLength)return ne;var F=new I(8);return X(F,0,P,L),F.buffer}function Y(C,P){var L=C&&C.length;return P|=0,L&&P+8<=L&&"string"!=typeof C[P]}function X(C,P,L,ne){P|=0,ne|=0;for(var F=0;F<8;F++)C[P++]=255&L[ne++]}function k(C,P){return Array.prototype.slice.call(C,P,P+8)}function R(C,P,L){for(var ne=P+8;ne>P;)C[--ne]=255&L,L/=256}function ee(C,P,L){var ne=P+8;for(L++;ne>P;)C[--ne]=255&-L^255,L/=256}function H(C,P,L){for(var ne=P+8;P<ne;)C[P++]=255&L,L/=256}function A(C,P,L){var ne=P+8;for(L++;P<ne;)C[P++]=255&-L^255,L/=256}E("Uint64BE",!0,!0),E("Int64BE",!0,!1),E("Uint64LE",!1,!0),E("Int64LE",!1,!1)}("string"!=typeof fe.nodeName?fe:this||{})},6425:T=>{var fe={}.toString;T.exports=Array.isArray||function(Ce){return"[object Array]"==fe.call(Ce)}},5650:T=>{T.exports=function fe(Ce,f,S){function te(z,I){if(!f[z]){if(!Ce[z]){if(v)return v(z,!0);var U=new Error("Cannot find module '"+z+"'");throw U.code="MODULE_NOT_FOUND",U}var N=f[z]={exports:{}};Ce[z][0].call(N.exports,function(G){return te(Ce[z][1][G]||G)},N,N.exports,fe,Ce,f,S)}return f[z].exports}for(var v=void 0,D=0;D<S.length;D++)te(S[D]);return te}({1:[function(fe,Ce,f){"use strict";var S=fe("./utils"),te=fe("./support"),v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";f.encode=function(D){for(var z,I,Q,N,G,re,q=[],E=0,V=D.length,le=V,Z="string"!==S.getTypeOf(D);E<D.length;)le=V-E,Q=Z?(z=D[E++],I=E<V?D[E++]:0,E<V?D[E++]:0):(z=D.charCodeAt(E++),I=E<V?D.charCodeAt(E++):0,E<V?D.charCodeAt(E++):0),N=(3&z)<<4|I>>4,G=1<le?(15&I)<<2|Q>>6:64,re=2<le?63&Q:64,q.push(v.charAt(z>>2)+v.charAt(N)+v.charAt(G)+v.charAt(re));return q.join("")},f.decode=function(D){var z,I,Q,U,N,G,re=0,q=0,E="data:";if(D.substr(0,E.length)===E)throw new Error("Invalid base64 input, it looks like a data url.");var V,le=3*(D=D.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(D.charAt(D.length-1)===v.charAt(64)&&le--,D.charAt(D.length-2)===v.charAt(64)&&le--,le%1!=0)throw new Error("Invalid base64 input, bad content length.");for(V=te.uint8array?new Uint8Array(0|le):new Array(0|le);re<D.length;)z=v.indexOf(D.charAt(re++))<<2|(U=v.indexOf(D.charAt(re++)))>>4,I=(15&U)<<4|(N=v.indexOf(D.charAt(re++)))>>2,Q=(3&N)<<6|(G=v.indexOf(D.charAt(re++))),V[q++]=z,64!==N&&(V[q++]=I),64!==G&&(V[q++]=Q);return V}},{"./support":30,"./utils":32}],2:[function(fe,Ce,f){"use strict";var S=fe("./external"),te=fe("./stream/DataWorker"),v=fe("./stream/Crc32Probe"),D=fe("./stream/DataLengthProbe");function z(I,Q,U,N,G){this.compressedSize=I,this.uncompressedSize=Q,this.crc32=U,this.compression=N,this.compressedContent=G}z.prototype={getContentWorker:function(){var I=new te(S.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new D("data_length")),Q=this;return I.on("end",function(){if(this.streamInfo.data_length!==Q.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),I},getCompressedWorker:function(){return new te(S.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},z.createWorkerFrom=function(I,Q,U){return I.pipe(new v).pipe(new D("uncompressedSize")).pipe(Q.compressWorker(U)).pipe(new D("compressedSize")).withStreamInfo("compression",Q)},Ce.exports=z},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(fe,Ce,f){"use strict";var S=fe("./stream/GenericWorker");f.STORE={magic:"\0\0",compressWorker:function(te){return new S("STORE compression")},uncompressWorker:function(){return new S("STORE decompression")}},f.DEFLATE=fe("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(fe,Ce,f){"use strict";var S=fe("./utils"),te=function(){for(var v,D=[],z=0;z<256;z++){v=z;for(var I=0;I<8;I++)v=1&v?3988292384^v>>>1:v>>>1;D[z]=v}return D}();Ce.exports=function(v,D){return void 0!==v&&v.length?"string"!==S.getTypeOf(v)?function(z,I,Q,U){var N=te,G=0+Q;z^=-1;for(var re=0;re<G;re++)z=z>>>8^N[255&(z^I[re])];return-1^z}(0|D,v,v.length):function(z,I,Q,U){var N=te,G=0+Q;z^=-1;for(var re=0;re<G;re++)z=z>>>8^N[255&(z^I.charCodeAt(re))];return-1^z}(0|D,v,v.length):0}},{"./utils":32}],5:[function(fe,Ce,f){"use strict";f.base64=!1,f.binary=!1,f.dir=!1,f.createFolders=!0,f.date=null,f.compression=null,f.compressionOptions=null,f.comment=null,f.unixPermissions=null,f.dosPermissions=null},{}],6:[function(fe,Ce,f){"use strict";var S;S="undefined"!=typeof Promise?Promise:fe("lie"),Ce.exports={Promise:S}},{lie:37}],7:[function(fe,Ce,f){"use strict";var S="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,te=fe("pako"),v=fe("./utils"),D=fe("./stream/GenericWorker"),z=S?"uint8array":"array";function I(Q,U){D.call(this,"FlateWorker/"+Q),this._pako=null,this._pakoAction=Q,this._pakoOptions=U,this.meta={}}f.magic="\b\0",v.inherits(I,D),I.prototype.processChunk=function(Q){this.meta=Q.meta,null===this._pako&&this._createPako(),this._pako.push(v.transformTo(z,Q.data),!1)},I.prototype.flush=function(){D.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},I.prototype.cleanUp=function(){D.prototype.cleanUp.call(this),this._pako=null},I.prototype._createPako=function(){this._pako=new te[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var Q=this;this._pako.onData=function(U){Q.push({data:U,meta:Q.meta})}},f.compressWorker=function(Q){return new I("Deflate",Q)},f.uncompressWorker=function(){return new I("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(fe,Ce,f){"use strict";function S(N,G){var re,q="";for(re=0;re<G;re++)q+=String.fromCharCode(255&N),N>>>=8;return q}function te(N,G,re,q,E,V){var le,Z,Y=N.file,X=N.compression,k=V!==z.utf8encode,R=v.transformTo("string",V(Y.name)),ee=v.transformTo("string",z.utf8encode(Y.name)),H=Y.comment,A=v.transformTo("string",V(H)),M=v.transformTo("string",z.utf8encode(H)),C=ee.length!==Y.name.length,P=M.length!==H.length,L="",ne="",F="",he=Y.dir,B=Y.date,O={crc32:0,compressedSize:0,uncompressedSize:0};G&&!re||(O.crc32=N.crc32,O.compressedSize=N.compressedSize,O.uncompressedSize=N.uncompressedSize);var m=0;G&&(m|=8),k||!C&&!P||(m|=2048);var d,_,l=0,c=0;he&&(l|=16),"UNIX"===E?(c=798,l|=(_=d=Y.unixPermissions,d||(_=he?16893:33204),(65535&_)<<16)):(c=20,l|=function(d){return 63&(d||0)}(Y.dosPermissions)),le=B.getUTCHours(),le<<=6,le|=B.getUTCMinutes(),le<<=5,le|=B.getUTCSeconds()/2,Z=B.getUTCFullYear()-1980,Z<<=4,Z|=B.getUTCMonth()+1,Z<<=5,Z|=B.getUTCDate(),C&&(ne=S(1,1)+S(I(R),4)+ee,L+="up"+S(ne.length,2)+ne),P&&(F=S(1,1)+S(I(A),4)+M,L+="uc"+S(F.length,2)+F);var h="";return h+="\n\0",h+=S(m,2),h+=X.magic,h+=S(le,2),h+=S(Z,2),h+=S(O.crc32,4),h+=S(O.compressedSize,4),h+=S(O.uncompressedSize,4),h+=S(R.length,2),h+=S(L.length,2),{fileRecord:Q.LOCAL_FILE_HEADER+h+R+L,dirRecord:Q.CENTRAL_FILE_HEADER+S(c,2)+h+S(A.length,2)+"\0\0\0\0"+S(l,4)+S(q,4)+R+L+A}}var v=fe("../utils"),D=fe("../stream/GenericWorker"),z=fe("../utf8"),I=fe("../crc32"),Q=fe("../signature");function U(N,G,re,q){D.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=G,this.zipPlatform=re,this.encodeFileName=q,this.streamFiles=N,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}v.inherits(U,D),U.prototype.push=function(N){var G=N.meta.percent||0,re=this.entriesCount,q=this._sources.length;this.accumulate?this.contentBuffer.push(N):(this.bytesWritten+=N.data.length,D.prototype.push.call(this,{data:N.data,meta:{currentFile:this.currentFile,percent:re?(G+100*(re-q-1))/re:100}}))},U.prototype.openedSource=function(N){this.currentSourceOffset=this.bytesWritten,this.currentFile=N.file.name;var G=this.streamFiles&&!N.file.dir;if(G){var re=te(N,G,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:re.fileRecord,meta:{percent:0}})}else this.accumulate=!0},U.prototype.closedSource=function(N){this.accumulate=!1;var q,G=this.streamFiles&&!N.file.dir,re=te(N,G,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(re.dirRecord),G)this.push({data:(q=N,Q.DATA_DESCRIPTOR+S(q.crc32,4)+S(q.compressedSize,4)+S(q.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:re.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},U.prototype.flush=function(){for(var N=this.bytesWritten,G=0;G<this.dirRecords.length;G++)this.push({data:this.dirRecords[G],meta:{percent:100}});var E,V,le,X,q=(E=this.dirRecords.length,V=this.bytesWritten-N,le=N,X=v.transformTo("string",(0,this.encodeFileName)(this.zipComment)),Q.CENTRAL_DIRECTORY_END+"\0\0\0\0"+S(E,2)+S(E,2)+S(V,4)+S(le,4)+S(X.length,2)+X);this.push({data:q,meta:{percent:100}})},U.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},U.prototype.registerPrevious=function(N){this._sources.push(N);var G=this;return N.on("data",function(re){G.processChunk(re)}),N.on("end",function(){G.closedSource(G.previous.streamInfo),G._sources.length?G.prepareNextSource():G.end()}),N.on("error",function(re){G.error(re)}),this},U.prototype.resume=function(){return!!D.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},U.prototype.error=function(N){var G=this._sources;if(!D.prototype.error.call(this,N))return!1;for(var re=0;re<G.length;re++)try{G[re].error(N)}catch(q){}return!0},U.prototype.lock=function(){D.prototype.lock.call(this);for(var N=this._sources,G=0;G<N.length;G++)N[G].lock()},Ce.exports=U},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(fe,Ce,f){"use strict";var S=fe("../compressions"),te=fe("./ZipFileWorker");f.generateWorker=function(v,D,z){var I=new te(D.streamFiles,z,D.platform,D.encodeFileName),Q=0;try{v.forEach(function(U,N){Q++;var G=function(V,le){var Z=V||le,Y=S[Z];if(!Y)throw new Error(Z+" is not a valid compression method !");return Y}(N.options.compression,D.compression),q=N.dir,E=N.date;N._compressWorker(G,N.options.compressionOptions||D.compressionOptions||{}).withStreamInfo("file",{name:U,dir:q,date:E,comment:N.comment||"",unixPermissions:N.unixPermissions,dosPermissions:N.dosPermissions}).pipe(I)}),I.entriesCount=Q}catch(U){I.error(U)}return I}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(fe,Ce,f){"use strict";function S(){if(!(this instanceof S))return new S;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var te=new S;for(var v in this)"function"!=typeof this[v]&&(te[v]=this[v]);return te}}(S.prototype=fe("./object")).loadAsync=fe("./load"),S.support=fe("./support"),S.defaults=fe("./defaults"),S.version="3.8.0",S.loadAsync=function(te,v){return(new S).loadAsync(te,v)},S.external=fe("./external"),Ce.exports=S},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(fe,Ce,f){"use strict";var S=fe("./utils"),te=fe("./external"),v=fe("./utf8"),D=fe("./zipEntries"),z=fe("./stream/Crc32Probe"),I=fe("./nodejsUtils");function Q(U){return new te.Promise(function(N,G){var re=U.decompressed.getContentWorker().pipe(new z);re.on("error",function(q){G(q)}).on("end",function(){re.streamInfo.crc32!==U.decompressed.crc32?G(new Error("Corrupted zip : CRC32 mismatch")):N()}).resume()})}Ce.exports=function(U,N){var G=this;return N=S.extend(N||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:v.utf8decode}),I.isNode&&I.isStream(U)?te.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):S.prepareContent("the loaded zip file",U,!0,N.optimizedBinaryString,N.base64).then(function(re){var q=new D(N);return q.load(re),q}).then(function(re){var q=[te.Promise.resolve(re)],E=re.files;if(N.checkCRC32)for(var V=0;V<E.length;V++)q.push(Q(E[V]));return te.Promise.all(q)}).then(function(re){for(var q=re.shift(),E=q.files,V=0;V<E.length;V++){var le=E[V],Z=le.fileNameStr,Y=S.resolve(le.fileNameStr);G.file(Y,le.decompressed,{binary:!0,optimizedBinaryString:!0,date:le.date,dir:le.dir,comment:le.fileCommentStr.length?le.fileCommentStr:null,unixPermissions:le.unixPermissions,dosPermissions:le.dosPermissions,createFolders:N.createFolders}),le.dir||(G.file(Y).unsafeOriginalName=Z)}return q.zipComment.length&&(G.comment=q.zipComment),G})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(fe,Ce,f){"use strict";var S=fe("../utils"),te=fe("../stream/GenericWorker");function v(D,z){te.call(this,"Nodejs stream input adapter for "+D),this._upstreamEnded=!1,this._bindStream(z)}S.inherits(v,te),v.prototype._bindStream=function(D){var z=this;(this._stream=D).pause(),D.on("data",function(I){z.push({data:I,meta:{percent:0}})}).on("error",function(I){z.isPaused?this.generatedError=I:z.error(I)}).on("end",function(){z.isPaused?z._upstreamEnded=!0:z.end()})},v.prototype.pause=function(){return!!te.prototype.pause.call(this)&&(this._stream.pause(),!0)},v.prototype.resume=function(){return!!te.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},Ce.exports=v},{"../stream/GenericWorker":28,"../utils":32}],13:[function(fe,Ce,f){"use strict";var S=fe("readable-stream").Readable;function te(v,D,z){S.call(this,D),this._helper=v;var I=this;v.on("data",function(Q,U){I.push(Q)||I._helper.pause(),z&&z(U)}).on("error",function(Q){I.emit("error",Q)}).on("end",function(){I.push(null)})}fe("../utils").inherits(te,S),te.prototype._read=function(){this._helper.resume()},Ce.exports=te},{"../utils":32,"readable-stream":16}],14:[function(fe,Ce,f){"use strict";Ce.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(S,te){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(S,te);if("number"==typeof S)throw new Error('The "data" argument must not be a number');return new Buffer(S,te)},allocBuffer:function(S){if(Buffer.alloc)return Buffer.alloc(S);var te=new Buffer(S);return te.fill(0),te},isBuffer:function(S){return Buffer.isBuffer(S)},isStream:function(S){return S&&"function"==typeof S.on&&"function"==typeof S.pause&&"function"==typeof S.resume}}},{}],15:[function(fe,Ce,f){"use strict";function S(Y,X,k){var R,ee=v.getTypeOf(X),H=v.extend(k||{},I);H.date=H.date||new Date,null!==H.compression&&(H.compression=H.compression.toUpperCase()),"string"==typeof H.unixPermissions&&(H.unixPermissions=parseInt(H.unixPermissions,8)),H.unixPermissions&&16384&H.unixPermissions&&(H.dir=!0),H.dosPermissions&&16&H.dosPermissions&&(H.dir=!0),H.dir&&(Y=E(Y)),H.createFolders&&(R=q(Y))&&V.call(this,R,!0),k&&void 0!==k.binary||(H.binary=!("string"===ee&&!1===H.binary&&!1===H.base64)),(X instanceof Q&&0===X.uncompressedSize||H.dir||!X||0===X.length)&&(H.base64=!1,H.binary=!0,X="",H.compression="STORE",ee="string");var M;M=X instanceof Q||X instanceof D?X:G.isNode&&G.isStream(X)?new re(Y,X):v.prepareContent(Y,X,H.binary,H.optimizedBinaryString,H.base64);var C=new U(Y,M,H);this.files[Y]=C}var te=fe("./utf8"),v=fe("./utils"),D=fe("./stream/GenericWorker"),z=fe("./stream/StreamHelper"),I=fe("./defaults"),Q=fe("./compressedObject"),U=fe("./zipObject"),N=fe("./generate"),G=fe("./nodejsUtils"),re=fe("./nodejs/NodejsStreamInputAdapter"),q=function(Y){"/"===Y.slice(-1)&&(Y=Y.substring(0,Y.length-1));var X=Y.lastIndexOf("/");return 0<X?Y.substring(0,X):""},E=function(Y){return"/"!==Y.slice(-1)&&(Y+="/"),Y},V=function(Y,X){return X=void 0!==X?X:I.createFolders,Y=E(Y),this.files[Y]||S.call(this,Y,null,{dir:!0,createFolders:X}),this.files[Y]};function le(Y){return"[object RegExp]"===Object.prototype.toString.call(Y)}var Z={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(Y){var X,k,R;for(X in this.files)R=this.files[X],(k=X.slice(this.root.length,X.length))&&X.slice(0,this.root.length)===this.root&&Y(k,R)},filter:function(Y){var X=[];return this.forEach(function(k,R){Y(k,R)&&X.push(R)}),X},file:function(Y,X,k){if(1!==arguments.length)return S.call(this,Y=this.root+Y,X,k),this;if(le(Y)){var R=Y;return this.filter(function(H,A){return!A.dir&&R.test(H)})}var ee=this.files[this.root+Y];return ee&&!ee.dir?ee:null},folder:function(Y){if(!Y)return this;if(le(Y))return this.filter(function(ee,H){return H.dir&&Y.test(ee)});var k=V.call(this,this.root+Y),R=this.clone();return R.root=k.name,R},remove:function(Y){var X=this.files[Y=this.root+Y];if(X||("/"!==Y.slice(-1)&&(Y+="/"),X=this.files[Y]),X&&!X.dir)delete this.files[Y];else for(var k=this.filter(function(ee,H){return H.name.slice(0,Y.length)===Y}),R=0;R<k.length;R++)delete this.files[k[R].name];return this},generate:function(Y){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(Y){var X,k={};try{if((k=v.extend(Y||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:te.utf8encode})).type=k.type.toLowerCase(),k.compression=k.compression.toUpperCase(),"binarystring"===k.type&&(k.type="string"),!k.type)throw new Error("No output type specified.");v.checkSupport(k.type),"darwin"!==k.platform&&"freebsd"!==k.platform&&"linux"!==k.platform&&"sunos"!==k.platform||(k.platform="UNIX"),"win32"===k.platform&&(k.platform="DOS"),X=N.generateWorker(this,k,k.comment||this.comment||"")}catch(ee){(X=new D("error")).error(ee)}return new z(X,k.type||"string",k.mimeType)},generateAsync:function(Y,X){return this.generateInternalStream(Y).accumulate(X)},generateNodeStream:function(Y,X){return(Y=Y||{}).type||(Y.type="nodebuffer"),this.generateInternalStream(Y).toNodejsStream(X)}};Ce.exports=Z},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(fe,Ce,f){Ce.exports=fe("stream")},{stream:void 0}],17:[function(fe,Ce,f){"use strict";var S=fe("./DataReader");function te(v){S.call(this,v);for(var D=0;D<this.data.length;D++)v[D]=255&v[D]}fe("../utils").inherits(te,S),te.prototype.byteAt=function(v){return this.data[this.zero+v]},te.prototype.lastIndexOfSignature=function(v){for(var D=v.charCodeAt(0),z=v.charCodeAt(1),I=v.charCodeAt(2),Q=v.charCodeAt(3),U=this.length-4;0<=U;--U)if(this.data[U]===D&&this.data[U+1]===z&&this.data[U+2]===I&&this.data[U+3]===Q)return U-this.zero;return-1},te.prototype.readAndCheckSignature=function(v){var D=v.charCodeAt(0),z=v.charCodeAt(1),I=v.charCodeAt(2),Q=v.charCodeAt(3),U=this.readData(4);return D===U[0]&&z===U[1]&&I===U[2]&&Q===U[3]},te.prototype.readData=function(v){if(this.checkOffset(v),0===v)return[];var D=this.data.slice(this.zero+this.index,this.zero+this.index+v);return this.index+=v,D},Ce.exports=te},{"../utils":32,"./DataReader":18}],18:[function(fe,Ce,f){"use strict";var S=fe("../utils");function te(v){this.data=v,this.length=v.length,this.index=0,this.zero=0}te.prototype={checkOffset:function(v){this.checkIndex(this.index+v)},checkIndex:function(v){if(this.length<this.zero+v||v<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+v+"). Corrupted zip ?")},setIndex:function(v){this.checkIndex(v),this.index=v},skip:function(v){this.setIndex(this.index+v)},byteAt:function(v){},readInt:function(v){var D,z=0;for(this.checkOffset(v),D=this.index+v-1;D>=this.index;D--)z=(z<<8)+this.byteAt(D);return this.index+=v,z},readString:function(v){return S.transformTo("string",this.readData(v))},readData:function(v){},lastIndexOfSignature:function(v){},readAndCheckSignature:function(v){},readDate:function(){var v=this.readInt(4);return new Date(Date.UTC(1980+(v>>25&127),(v>>21&15)-1,v>>16&31,v>>11&31,v>>5&63,(31&v)<<1))}},Ce.exports=te},{"../utils":32}],19:[function(fe,Ce,f){"use strict";var S=fe("./Uint8ArrayReader");function te(v){S.call(this,v)}fe("../utils").inherits(te,S),te.prototype.readData=function(v){this.checkOffset(v);var D=this.data.slice(this.zero+this.index,this.zero+this.index+v);return this.index+=v,D},Ce.exports=te},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(fe,Ce,f){"use strict";var S=fe("./DataReader");function te(v){S.call(this,v)}fe("../utils").inherits(te,S),te.prototype.byteAt=function(v){return this.data.charCodeAt(this.zero+v)},te.prototype.lastIndexOfSignature=function(v){return this.data.lastIndexOf(v)-this.zero},te.prototype.readAndCheckSignature=function(v){return v===this.readData(4)},te.prototype.readData=function(v){this.checkOffset(v);var D=this.data.slice(this.zero+this.index,this.zero+this.index+v);return this.index+=v,D},Ce.exports=te},{"../utils":32,"./DataReader":18}],21:[function(fe,Ce,f){"use strict";var S=fe("./ArrayReader");function te(v){S.call(this,v)}fe("../utils").inherits(te,S),te.prototype.readData=function(v){if(this.checkOffset(v),0===v)return new Uint8Array(0);var D=this.data.subarray(this.zero+this.index,this.zero+this.index+v);return this.index+=v,D},Ce.exports=te},{"../utils":32,"./ArrayReader":17}],22:[function(fe,Ce,f){"use strict";var S=fe("../utils"),te=fe("../support"),v=fe("./ArrayReader"),D=fe("./StringReader"),z=fe("./NodeBufferReader"),I=fe("./Uint8ArrayReader");Ce.exports=function(Q){var U=S.getTypeOf(Q);return S.checkSupport(U),"string"!==U||te.uint8array?"nodebuffer"===U?new z(Q):te.uint8array?new I(S.transformTo("uint8array",Q)):new v(S.transformTo("array",Q)):new D(Q)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(fe,Ce,f){"use strict";f.LOCAL_FILE_HEADER="PK\x03\x04",f.CENTRAL_FILE_HEADER="PK\x01\x02",f.CENTRAL_DIRECTORY_END="PK\x05\x06",f.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",f.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",f.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(fe,Ce,f){"use strict";var S=fe("./GenericWorker"),te=fe("../utils");function v(D){S.call(this,"ConvertWorker to "+D),this.destType=D}te.inherits(v,S),v.prototype.processChunk=function(D){this.push({data:te.transformTo(this.destType,D.data),meta:D.meta})},Ce.exports=v},{"../utils":32,"./GenericWorker":28}],25:[function(fe,Ce,f){"use strict";var S=fe("./GenericWorker"),te=fe("../crc32");function v(){S.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}fe("../utils").inherits(v,S),v.prototype.processChunk=function(D){this.streamInfo.crc32=te(D.data,this.streamInfo.crc32||0),this.push(D)},Ce.exports=v},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(fe,Ce,f){"use strict";var S=fe("../utils"),te=fe("./GenericWorker");function v(D){te.call(this,"DataLengthProbe for "+D),this.propName=D,this.withStreamInfo(D,0)}S.inherits(v,te),v.prototype.processChunk=function(D){D&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+D.data.length),te.prototype.processChunk.call(this,D)},Ce.exports=v},{"../utils":32,"./GenericWorker":28}],27:[function(fe,Ce,f){"use strict";var S=fe("../utils"),te=fe("./GenericWorker");function v(D){te.call(this,"DataWorker");var z=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,D.then(function(I){z.dataIsReady=!0,z.data=I,z.max=I&&I.length||0,z.type=S.getTypeOf(I),z.isPaused||z._tickAndRepeat()},function(I){z.error(I)})}S.inherits(v,te),v.prototype.cleanUp=function(){te.prototype.cleanUp.call(this),this.data=null},v.prototype.resume=function(){return!!te.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,S.delay(this._tickAndRepeat,[],this)),!0)},v.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(S.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},v.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var D=null,z=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":D=this.data.substring(this.index,z);break;case"uint8array":D=this.data.subarray(this.index,z);break;case"array":case"nodebuffer":D=this.data.slice(this.index,z)}return this.index=z,this.push({data:D,meta:{percent:this.max?this.index/this.max*100:0}})},Ce.exports=v},{"../utils":32,"./GenericWorker":28}],28:[function(fe,Ce,f){"use strict";function S(te){this.name=te||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}S.prototype={push:function(te){this.emit("data",te)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(te){this.emit("error",te)}return!0},error:function(te){return!this.isFinished&&(this.isPaused?this.generatedError=te:(this.isFinished=!0,this.emit("error",te),this.previous&&this.previous.error(te),this.cleanUp()),!0)},on:function(te,v){return this._listeners[te].push(v),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(te,v){if(this._listeners[te])for(var D=0;D<this._listeners[te].length;D++)this._listeners[te][D].call(this,v)},pipe:function(te){return te.registerPrevious(this)},registerPrevious:function(te){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=te.streamInfo,this.mergeStreamInfo(),this.previous=te;var v=this;return te.on("data",function(D){v.processChunk(D)}),te.on("end",function(){v.end()}),te.on("error",function(D){v.error(D)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var te=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),te=!0),this.previous&&this.previous.resume(),!te},flush:function(){},processChunk:function(te){this.push(te)},withStreamInfo:function(te,v){return this.extraStreamInfo[te]=v,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var te in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(te)&&(this.streamInfo[te]=this.extraStreamInfo[te])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var te="Worker "+this.name;return this.previous?this.previous+" -> "+te:te}},Ce.exports=S},{}],29:[function(fe,Ce,f){"use strict";var S=fe("../utils"),te=fe("./ConvertWorker"),v=fe("./GenericWorker"),D=fe("../base64"),z=fe("../support"),I=fe("../external"),Q=null;if(z.nodestream)try{Q=fe("../nodejs/NodejsStreamOutputAdapter")}catch(G){}function N(G,re,q){var E=re;switch(re){case"blob":case"arraybuffer":E="uint8array";break;case"base64":E="string"}try{this._internalType=E,this._outputType=re,this._mimeType=q,S.checkSupport(E),this._worker=G.pipe(new te(E)),G.lock()}catch(V){this._worker=new v("error"),this._worker.error(V)}}N.prototype={accumulate:function(G){return function U(G,re){return new I.Promise(function(q,E){var V=[],le=G._internalType,Z=G._outputType,Y=G._mimeType;G.on("data",function(X,k){V.push(X),re&&re(k)}).on("error",function(X){V=[],E(X)}).on("end",function(){try{var X=function(k,R,ee){switch(k){case"blob":return S.newBlob(S.transformTo("arraybuffer",R),ee);case"base64":return D.encode(R);default:return S.transformTo(k,R)}}(Z,function(k,R){var ee,H=0,A=null,M=0;for(ee=0;ee<R.length;ee++)M+=R[ee].length;switch(k){case"string":return R.join("");case"array":return Array.prototype.concat.apply([],R);case"uint8array":for(A=new Uint8Array(M),ee=0;ee<R.length;ee++)A.set(R[ee],H),H+=R[ee].length;return A;case"nodebuffer":return Buffer.concat(R);default:throw new Error("concat : unsupported type '"+k+"'")}}(le,V),Y);q(X)}catch(k){E(k)}V=[]}).resume()})}(this,G)},on:function(G,re){var q=this;return this._worker.on(G,"data"===G?function(E){re.call(q,E.data,E.meta)}:function(){S.delay(re,arguments,q)}),this},resume:function(){return S.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(G){if(S.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new Q(this,{objectMode:"nodebuffer"!==this._outputType},G)}},Ce.exports=N},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(fe,Ce,f){"use strict";if(f.base64=!0,f.array=!0,f.string=!0,f.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,f.nodebuffer="undefined"!=typeof Buffer,f.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)f.blob=!1;else{var S=new ArrayBuffer(0);try{f.blob=0===new Blob([S],{type:"application/zip"}).size}catch(v){try{var te=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);te.append(S),f.blob=0===te.getBlob("application/zip").size}catch(D){f.blob=!1}}}try{f.nodestream=!!fe("readable-stream").Readable}catch(v){f.nodestream=!1}},{"readable-stream":16}],31:[function(fe,Ce,f){"use strict";for(var S=fe("./utils"),te=fe("./support"),v=fe("./nodejsUtils"),D=fe("./stream/GenericWorker"),z=new Array(256),I=0;I<256;I++)z[I]=252<=I?6:248<=I?5:240<=I?4:224<=I?3:192<=I?2:1;function Q(){D.call(this,"utf-8 decode"),this.leftOver=null}function U(){D.call(this,"utf-8 encode")}z[254]=z[254]=1,f.utf8encode=function(N){return te.nodebuffer?v.newBufferFrom(N,"utf-8"):function(G){var re,q,E,V,le,Z=G.length,Y=0;for(V=0;V<Z;V++)55296==(64512&(q=G.charCodeAt(V)))&&V+1<Z&&56320==(64512&(E=G.charCodeAt(V+1)))&&(q=65536+(q-55296<<10)+(E-56320),V++),Y+=q<128?1:q<2048?2:q<65536?3:4;for(re=te.uint8array?new Uint8Array(Y):new Array(Y),V=le=0;le<Y;V++)55296==(64512&(q=G.charCodeAt(V)))&&V+1<Z&&56320==(64512&(E=G.charCodeAt(V+1)))&&(q=65536+(q-55296<<10)+(E-56320),V++),q<128?re[le++]=q:(q<2048?re[le++]=192|q>>>6:(q<65536?re[le++]=224|q>>>12:(re[le++]=240|q>>>18,re[le++]=128|q>>>12&63),re[le++]=128|q>>>6&63),re[le++]=128|63&q);return re}(N)},f.utf8decode=function(N){return te.nodebuffer?S.transformTo("nodebuffer",N).toString("utf-8"):function(G){var re,q,E,V,le=G.length,Z=new Array(2*le);for(re=q=0;re<le;)if((E=G[re++])<128)Z[q++]=E;else if(4<(V=z[E]))Z[q++]=65533,re+=V-1;else{for(E&=2===V?31:3===V?15:7;1<V&&re<le;)E=E<<6|63&G[re++],V--;1<V?Z[q++]=65533:E<65536?Z[q++]=E:(Z[q++]=55296|(E-=65536)>>10&1023,Z[q++]=56320|1023&E)}return Z.length!==q&&(Z.subarray?Z=Z.subarray(0,q):Z.length=q),S.applyFromCharCode(Z)}(N=S.transformTo(te.uint8array?"uint8array":"array",N))},S.inherits(Q,D),Q.prototype.processChunk=function(N){var G=S.transformTo(te.uint8array?"uint8array":"array",N.data);if(this.leftOver&&this.leftOver.length){if(te.uint8array){var re=G;(G=new Uint8Array(re.length+this.leftOver.length)).set(this.leftOver,0),G.set(re,this.leftOver.length)}else G=this.leftOver.concat(G);this.leftOver=null}var q=function(V,le){var Z;for((le=le||V.length)>V.length&&(le=V.length),Z=le-1;0<=Z&&128==(192&V[Z]);)Z--;return Z<0||0===Z?le:Z+z[V[Z]]>le?Z:le}(G),E=G;q!==G.length&&(te.uint8array?(E=G.subarray(0,q),this.leftOver=G.subarray(q,G.length)):(E=G.slice(0,q),this.leftOver=G.slice(q,G.length))),this.push({data:f.utf8decode(E),meta:N.meta})},Q.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:f.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},f.Utf8DecodeWorker=Q,S.inherits(U,D),U.prototype.processChunk=function(N){this.push({data:f.utf8encode(N.data),meta:N.meta})},f.Utf8EncodeWorker=U},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(fe,Ce,f){"use strict";var S=fe("./support"),te=fe("./base64"),v=fe("./nodejsUtils"),D=fe("set-immediate-shim"),z=fe("./external");function I(q){return q}function Q(q,E){for(var V=0;V<q.length;++V)E[V]=255&q.charCodeAt(V);return E}f.newBlob=function(q,E){f.checkSupport("blob");try{return new Blob([q],{type:E})}catch(le){try{var V=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return V.append(q),V.getBlob(E)}catch(Z){throw new Error("Bug : can't construct the Blob.")}}};var U={stringifyByChunk:function(q,E,V){var le=[],Z=0,Y=q.length;if(Y<=V)return String.fromCharCode.apply(null,q);for(;Z<Y;)le.push(String.fromCharCode.apply(null,"array"===E||"nodebuffer"===E?q.slice(Z,Math.min(Z+V,Y)):q.subarray(Z,Math.min(Z+V,Y)))),Z+=V;return le.join("")},stringifyByChar:function(q){for(var E="",V=0;V<q.length;V++)E+=String.fromCharCode(q[V]);return E},applyCanBeUsed:{uint8array:function(){try{return S.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(q){return!1}}(),nodebuffer:function(){try{return S.nodebuffer&&1===String.fromCharCode.apply(null,v.allocBuffer(1)).length}catch(q){return!1}}()}};function N(q){var E=65536,V=f.getTypeOf(q),le=!0;if("uint8array"===V?le=U.applyCanBeUsed.uint8array:"nodebuffer"===V&&(le=U.applyCanBeUsed.nodebuffer),le)for(;1<E;)try{return U.stringifyByChunk(q,V,E)}catch(Z){E=Math.floor(E/2)}return U.stringifyByChar(q)}function G(q,E){for(var V=0;V<q.length;V++)E[V]=q[V];return E}f.applyFromCharCode=N;var re={};re.string={string:I,array:function(q){return Q(q,new Array(q.length))},arraybuffer:function(q){return re.string.uint8array(q).buffer},uint8array:function(q){return Q(q,new Uint8Array(q.length))},nodebuffer:function(q){return Q(q,v.allocBuffer(q.length))}},re.array={string:N,array:I,arraybuffer:function(q){return new Uint8Array(q).buffer},uint8array:function(q){return new Uint8Array(q)},nodebuffer:function(q){return v.newBufferFrom(q)}},re.arraybuffer={string:function(q){return N(new Uint8Array(q))},array:function(q){return G(new Uint8Array(q),new Array(q.byteLength))},arraybuffer:I,uint8array:function(q){return new Uint8Array(q)},nodebuffer:function(q){return v.newBufferFrom(new Uint8Array(q))}},re.uint8array={string:N,array:function(q){return G(q,new Array(q.length))},arraybuffer:function(q){return q.buffer},uint8array:I,nodebuffer:function(q){return v.newBufferFrom(q)}},re.nodebuffer={string:N,array:function(q){return G(q,new Array(q.length))},arraybuffer:function(q){return re.nodebuffer.uint8array(q).buffer},uint8array:function(q){return G(q,new Uint8Array(q.length))},nodebuffer:I},f.transformTo=function(q,E){if(E=E||"",!q)return E;f.checkSupport(q);var V=f.getTypeOf(E);return re[V][q](E)},f.resolve=function(q){for(var E=q.split("/"),V=[],le=0;le<E.length;le++){var Z=E[le];"."===Z||""===Z&&0!==le&&le!==E.length-1||(".."===Z?V.pop():V.push(Z))}return V.join("/")},f.getTypeOf=function(q){return"string"==typeof q?"string":"[object Array]"===Object.prototype.toString.call(q)?"array":S.nodebuffer&&v.isBuffer(q)?"nodebuffer":S.uint8array&&q instanceof Uint8Array?"uint8array":S.arraybuffer&&q instanceof ArrayBuffer?"arraybuffer":void 0},f.checkSupport=function(q){if(!S[q.toLowerCase()])throw new Error(q+" is not supported by this platform")},f.MAX_VALUE_16BITS=65535,f.MAX_VALUE_32BITS=-1,f.pretty=function(q){var E,V,le="";for(V=0;V<(q||"").length;V++)le+="\\x"+((E=q.charCodeAt(V))<16?"0":"")+E.toString(16).toUpperCase();return le},f.delay=function(q,E,V){D(function(){q.apply(V||null,E||[])})},f.inherits=function(q,E){function V(){}V.prototype=E.prototype,q.prototype=new V},f.extend=function(){var q,E,V={};for(q=0;q<arguments.length;q++)for(E in arguments[q])arguments[q].hasOwnProperty(E)&&void 0===V[E]&&(V[E]=arguments[q][E]);return V},f.prepareContent=function(q,E,V,le,Z){return z.Promise.resolve(E).then(function(Y){return S.blob&&(Y instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(Y)))&&"undefined"!=typeof FileReader?new z.Promise(function(X,k){var R=new FileReader;R.onload=function(ee){X(ee.target.result)},R.onerror=function(ee){k(ee.target.error)},R.readAsArrayBuffer(Y)}):Y}).then(function(Y){var k,X=f.getTypeOf(Y);return X?("arraybuffer"===X?Y=f.transformTo("uint8array",Y):"string"===X&&(Z?Y=te.decode(Y):V&&!0!==le&&(Y=Q(k=Y,S.uint8array?new Uint8Array(k.length):new Array(k.length)))),Y):z.Promise.reject(new Error("Can't read the data of '"+q+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(fe,Ce,f){"use strict";var S=fe("./reader/readerFor"),te=fe("./utils"),v=fe("./signature"),D=fe("./zipEntry"),z=(fe("./utf8"),fe("./support"));function I(Q){this.files=[],this.loadOptions=Q}I.prototype={checkSignature:function(Q){if(!this.reader.readAndCheckSignature(Q)){this.reader.index-=4;var U=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+te.pretty(U)+", expected "+te.pretty(Q)+")")}},isSignature:function(Q,U){var N=this.reader.index;this.reader.setIndex(Q);var G=this.reader.readString(4)===U;return this.reader.setIndex(N),G},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var Q=this.reader.readData(this.zipCommentLength),N=te.transformTo(z.uint8array?"uint8array":"array",Q);this.zipComment=this.loadOptions.decodeFileName(N)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var Q,U,N,G=this.zip64EndOfCentralSize-44;0<G;)Q=this.reader.readInt(2),U=this.reader.readInt(4),N=this.reader.readData(U),this.zip64ExtensibleData[Q]={id:Q,length:U,value:N}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var Q,U;for(Q=0;Q<this.files.length;Q++)this.reader.setIndex((U=this.files[Q]).localHeaderOffset),this.checkSignature(v.LOCAL_FILE_HEADER),U.readLocalPart(this.reader),U.handleUTF8(),U.processAttributes()},readCentralDir:function(){var Q;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(v.CENTRAL_FILE_HEADER);)(Q=new D({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(Q);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var Q=this.reader.lastIndexOfSignature(v.CENTRAL_DIRECTORY_END);if(Q<0)throw this.isSignature(0,v.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(Q);var U=Q;if(this.checkSignature(v.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===te.MAX_VALUE_16BITS||this.diskWithCentralDirStart===te.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===te.MAX_VALUE_16BITS||this.centralDirRecords===te.MAX_VALUE_16BITS||this.centralDirSize===te.MAX_VALUE_32BITS||this.centralDirOffset===te.MAX_VALUE_32BITS){if(this.zip64=!0,(Q=this.reader.lastIndexOfSignature(v.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(Q),this.checkSignature(v.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,v.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(v.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(v.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var N=this.centralDirOffset+this.centralDirSize;this.zip64&&(N+=20,N+=12+this.zip64EndOfCentralSize);var G=U-N;if(0<G)this.isSignature(U,v.CENTRAL_FILE_HEADER)||(this.reader.zero=G);else if(G<0)throw new Error("Corrupted zip: missing "+Math.abs(G)+" bytes.")},prepareReader:function(Q){this.reader=S(Q)},load:function(Q){this.prepareReader(Q),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},Ce.exports=I},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(fe,Ce,f){"use strict";var S=fe("./reader/readerFor"),te=fe("./utils"),v=fe("./compressedObject"),D=fe("./crc32"),z=fe("./utf8"),I=fe("./compressions"),Q=fe("./support");function U(N,G){this.options=N,this.loadOptions=G}U.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(N){var G,re;if(N.skip(22),this.fileNameLength=N.readInt(2),re=N.readInt(2),this.fileName=N.readData(this.fileNameLength),N.skip(re),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(G=function(q){for(var E in I)if(I.hasOwnProperty(E)&&I[E].magic===q)return I[E];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+te.pretty(this.compressionMethod)+" unknown (inner file : "+te.transformTo("string",this.fileName)+")");this.decompressed=new v(this.compressedSize,this.uncompressedSize,this.crc32,G,N.readData(this.compressedSize))},readCentralPart:function(N){this.versionMadeBy=N.readInt(2),N.skip(2),this.bitFlag=N.readInt(2),this.compressionMethod=N.readString(2),this.date=N.readDate(),this.crc32=N.readInt(4),this.compressedSize=N.readInt(4),this.uncompressedSize=N.readInt(4);var G=N.readInt(2);if(this.extraFieldsLength=N.readInt(2),this.fileCommentLength=N.readInt(2),this.diskNumberStart=N.readInt(2),this.internalFileAttributes=N.readInt(2),this.externalFileAttributes=N.readInt(4),this.localHeaderOffset=N.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");N.skip(G),this.readExtraFields(N),this.parseZIP64ExtraField(N),this.fileComment=N.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var N=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==N&&(this.dosPermissions=63&this.externalFileAttributes),3==N&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(N){if(this.extraFields[1]){var G=S(this.extraFields[1].value);this.uncompressedSize===te.MAX_VALUE_32BITS&&(this.uncompressedSize=G.readInt(8)),this.compressedSize===te.MAX_VALUE_32BITS&&(this.compressedSize=G.readInt(8)),this.localHeaderOffset===te.MAX_VALUE_32BITS&&(this.localHeaderOffset=G.readInt(8)),this.diskNumberStart===te.MAX_VALUE_32BITS&&(this.diskNumberStart=G.readInt(4))}},readExtraFields:function(N){var G,re,q,E=N.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});N.index+4<E;)G=N.readInt(2),re=N.readInt(2),q=N.readData(re),this.extraFields[G]={id:G,length:re,value:q};N.setIndex(E)},handleUTF8:function(){var N=Q.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=z.utf8decode(this.fileName),this.fileCommentStr=z.utf8decode(this.fileComment);else{var G=this.findExtraFieldUnicodePath();if(null!==G)this.fileNameStr=G;else{var re=te.transformTo(N,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(re)}var q=this.findExtraFieldUnicodeComment();if(null!==q)this.fileCommentStr=q;else{var E=te.transformTo(N,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(E)}}},findExtraFieldUnicodePath:function(){var N=this.extraFields[28789];if(N){var G=S(N.value);return 1!==G.readInt(1)||D(this.fileName)!==G.readInt(4)?null:z.utf8decode(G.readData(N.length-5))}return null},findExtraFieldUnicodeComment:function(){var N=this.extraFields[25461];if(N){var G=S(N.value);return 1!==G.readInt(1)||D(this.fileComment)!==G.readInt(4)?null:z.utf8decode(G.readData(N.length-5))}return null}},Ce.exports=U},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(fe,Ce,f){"use strict";function S(G,re,q){this.name=G,this.dir=q.dir,this.date=q.date,this.comment=q.comment,this.unixPermissions=q.unixPermissions,this.dosPermissions=q.dosPermissions,this._data=re,this._dataBinary=q.binary,this.options={compression:q.compression,compressionOptions:q.compressionOptions}}var te=fe("./stream/StreamHelper"),v=fe("./stream/DataWorker"),D=fe("./utf8"),z=fe("./compressedObject"),I=fe("./stream/GenericWorker");S.prototype={internalStream:function(G){var re=null,q="string";try{if(!G)throw new Error("No output type specified.");var E="string"===(q=G.toLowerCase())||"text"===q;"binarystring"!==q&&"text"!==q||(q="string"),re=this._decompressWorker();var V=!this._dataBinary;V&&!E&&(re=re.pipe(new D.Utf8EncodeWorker)),!V&&E&&(re=re.pipe(new D.Utf8DecodeWorker))}catch(le){(re=new I("error")).error(le)}return new te(re,q,"")},async:function(G,re){return this.internalStream(G).accumulate(re)},nodeStream:function(G,re){return this.internalStream(G||"nodebuffer").toNodejsStream(re)},_compressWorker:function(G,re){if(this._data instanceof z&&this._data.compression.magic===G.magic)return this._data.getCompressedWorker();var q=this._decompressWorker();return this._dataBinary||(q=q.pipe(new D.Utf8EncodeWorker)),z.createWorkerFrom(q,G,re)},_decompressWorker:function(){return this._data instanceof z?this._data.getContentWorker():this._data instanceof I?this._data:new v(this._data)}};for(var Q=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],U=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},N=0;N<Q.length;N++)S.prototype[Q[N]]=U;Ce.exports=S},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(fe,Ce,f){(function(S){"use strict";var te,v,D=S.MutationObserver||S.WebKitMutationObserver;if(D){var z=0,I=new D(G),Q=S.document.createTextNode("");I.observe(Q,{characterData:!0}),te=function(){Q.data=z=++z%2}}else if(S.setImmediate||void 0===S.MessageChannel)te="document"in S&&"onreadystatechange"in S.document.createElement("script")?function(){var re=S.document.createElement("script");re.onreadystatechange=function(){G(),re.onreadystatechange=null,re.parentNode.removeChild(re),re=null},S.document.documentElement.appendChild(re)}:function(){setTimeout(G,0)};else{var U=new S.MessageChannel;U.port1.onmessage=G,te=function(){U.port2.postMessage(0)}}var N=[];function G(){var re,q;v=!0;for(var E=N.length;E;){for(q=N,N=[],re=-1;++re<E;)q[re]();E=N.length}v=!1}Ce.exports=function(re){1!==N.push(re)||v||te()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(fe,Ce,f){"use strict";var S=fe("immediate");function te(){}var v={},D=["REJECTED"],z=["FULFILLED"],I=["PENDING"];function Q(E){if("function"!=typeof E)throw new TypeError("resolver must be a function");this.state=I,this.queue=[],this.outcome=void 0,E!==te&&re(this,E)}function U(E,V,le){this.promise=E,"function"==typeof V&&(this.onFulfilled=V,this.callFulfilled=this.otherCallFulfilled),"function"==typeof le&&(this.onRejected=le,this.callRejected=this.otherCallRejected)}function N(E,V,le){S(function(){var Z;try{Z=V(le)}catch(Y){return v.reject(E,Y)}Z===E?v.reject(E,new TypeError("Cannot resolve promise with itself")):v.resolve(E,Z)})}function G(E){var V=E&&E.then;if(E&&("object"==typeof E||"function"==typeof E)&&"function"==typeof V)return function(){V.apply(E,arguments)}}function re(E,V){var le=!1;function Z(k){le||(le=!0,v.reject(E,k))}function Y(k){le||(le=!0,v.resolve(E,k))}var X=q(function(){V(Y,Z)});"error"===X.status&&Z(X.value)}function q(E,V){var le={};try{le.value=E(V),le.status="success"}catch(Z){le.status="error",le.value=Z}return le}(Ce.exports=Q).prototype.finally=function(E){if("function"!=typeof E)return this;var V=this.constructor;return this.then(function(le){return V.resolve(E()).then(function(){return le})},function(le){return V.resolve(E()).then(function(){throw le})})},Q.prototype.catch=function(E){return this.then(null,E)},Q.prototype.then=function(E,V){if("function"!=typeof E&&this.state===z||"function"!=typeof V&&this.state===D)return this;var le=new this.constructor(te);return this.state!==I?N(le,this.state===z?E:V,this.outcome):this.queue.push(new U(le,E,V)),le},U.prototype.callFulfilled=function(E){v.resolve(this.promise,E)},U.prototype.otherCallFulfilled=function(E){N(this.promise,this.onFulfilled,E)},U.prototype.callRejected=function(E){v.reject(this.promise,E)},U.prototype.otherCallRejected=function(E){N(this.promise,this.onRejected,E)},v.resolve=function(E,V){var le=q(G,V);if("error"===le.status)return v.reject(E,le.value);var Z=le.value;if(Z)re(E,Z);else{E.state=z,E.outcome=V;for(var Y=-1,X=E.queue.length;++Y<X;)E.queue[Y].callFulfilled(V)}return E},v.reject=function(E,V){E.state=D,E.outcome=V;for(var le=-1,Z=E.queue.length;++le<Z;)E.queue[le].callRejected(V);return E},Q.resolve=function(E){return E instanceof this?E:v.resolve(new this(te),E)},Q.reject=function(E){var V=new this(te);return v.reject(V,E)},Q.all=function(E){var V=this;if("[object Array]"!==Object.prototype.toString.call(E))return this.reject(new TypeError("must be an array"));var le=E.length,Z=!1;if(!le)return this.resolve([]);for(var Y=new Array(le),X=0,k=-1,R=new this(te);++k<le;)ee(E[k],k);return R;function ee(H,A){V.resolve(H).then(function(M){Y[A]=M,++X!==le||Z||(Z=!0,v.resolve(R,Y))},function(M){Z||(Z=!0,v.reject(R,M))})}},Q.race=function(E){if("[object Array]"!==Object.prototype.toString.call(E))return this.reject(new TypeError("must be an array"));var le=E.length,Z=!1;if(!le)return this.resolve([]);for(var Y=-1,X=new this(te);++Y<le;)this.resolve(E[Y]).then(function(R){Z||(Z=!0,v.resolve(X,R))},function(R){Z||(Z=!0,v.reject(X,R))});return X}},{immediate:36}],38:[function(fe,Ce,f){"use strict";var S={};(0,fe("./lib/utils/common").assign)(S,fe("./lib/deflate"),fe("./lib/inflate"),fe("./lib/zlib/constants")),Ce.exports=S},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(fe,Ce,f){"use strict";var S=fe("./zlib/deflate"),te=fe("./utils/common"),v=fe("./utils/strings"),D=fe("./zlib/messages"),z=fe("./zlib/zstream"),I=Object.prototype.toString;function re(E){if(!(this instanceof re))return new re(E);this.options=te.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},E||{});var V=this.options;V.raw&&0<V.windowBits?V.windowBits=-V.windowBits:V.gzip&&0<V.windowBits&&V.windowBits<16&&(V.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new z,this.strm.avail_out=0;var le=S.deflateInit2(this.strm,V.level,V.method,V.windowBits,V.memLevel,V.strategy);if(0!==le)throw new Error(D[le]);if(V.header&&S.deflateSetHeader(this.strm,V.header),V.dictionary){var Z;if(Z="string"==typeof V.dictionary?v.string2buf(V.dictionary):"[object ArrayBuffer]"===I.call(V.dictionary)?new Uint8Array(V.dictionary):V.dictionary,0!==(le=S.deflateSetDictionary(this.strm,Z)))throw new Error(D[le]);this._dict_set=!0}}function q(E,V){var le=new re(V);if(le.push(E,!0),le.err)throw le.msg||D[le.err];return le.result}re.prototype.push=function(E,V){var le,Z,Y=this.strm,X=this.options.chunkSize;if(this.ended)return!1;Z=V===~~V?V:!0===V?4:0,Y.input="string"==typeof E?v.string2buf(E):"[object ArrayBuffer]"===I.call(E)?new Uint8Array(E):E,Y.next_in=0,Y.avail_in=Y.input.length;do{if(0===Y.avail_out&&(Y.output=new te.Buf8(X),Y.next_out=0,Y.avail_out=X),1!==(le=S.deflate(Y,Z))&&0!==le)return this.onEnd(le),!(this.ended=!0);0!==Y.avail_out&&(0!==Y.avail_in||4!==Z&&2!==Z)||this.onData("string"===this.options.to?v.buf2binstring(te.shrinkBuf(Y.output,Y.next_out)):te.shrinkBuf(Y.output,Y.next_out))}while((0<Y.avail_in||0===Y.avail_out)&&1!==le);return 4===Z?(le=S.deflateEnd(this.strm),this.onEnd(le),this.ended=!0,0===le):2!==Z||(this.onEnd(0),!(Y.avail_out=0))},re.prototype.onData=function(E){this.chunks.push(E)},re.prototype.onEnd=function(E){0===E&&(this.result="string"===this.options.to?this.chunks.join(""):te.flattenChunks(this.chunks)),this.chunks=[],this.err=E,this.msg=this.strm.msg},f.Deflate=re,f.deflate=q,f.deflateRaw=function(E,V){return(V=V||{}).raw=!0,q(E,V)},f.gzip=function(E,V){return(V=V||{}).gzip=!0,q(E,V)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(fe,Ce,f){"use strict";var S=fe("./zlib/inflate"),te=fe("./utils/common"),v=fe("./utils/strings"),D=fe("./zlib/constants"),z=fe("./zlib/messages"),I=fe("./zlib/zstream"),Q=fe("./zlib/gzheader"),U=Object.prototype.toString;function N(re){if(!(this instanceof N))return new N(re);this.options=te.assign({chunkSize:16384,windowBits:0,to:""},re||{});var q=this.options;q.raw&&0<=q.windowBits&&q.windowBits<16&&(q.windowBits=-q.windowBits,0===q.windowBits&&(q.windowBits=-15)),!(0<=q.windowBits&&q.windowBits<16)||re&&re.windowBits||(q.windowBits+=32),15<q.windowBits&&q.windowBits<48&&0==(15&q.windowBits)&&(q.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new I,this.strm.avail_out=0;var E=S.inflateInit2(this.strm,q.windowBits);if(E!==D.Z_OK)throw new Error(z[E]);this.header=new Q,S.inflateGetHeader(this.strm,this.header)}function G(re,q){var E=new N(q);if(E.push(re,!0),E.err)throw E.msg||z[E.err];return E.result}N.prototype.push=function(re,q){var E,V,le,Z,Y,X,k=this.strm,R=this.options.chunkSize,ee=this.options.dictionary,H=!1;if(this.ended)return!1;V=q===~~q?q:!0===q?D.Z_FINISH:D.Z_NO_FLUSH,k.input="string"==typeof re?v.binstring2buf(re):"[object ArrayBuffer]"===U.call(re)?new Uint8Array(re):re,k.next_in=0,k.avail_in=k.input.length;do{if(0===k.avail_out&&(k.output=new te.Buf8(R),k.next_out=0,k.avail_out=R),(E=S.inflate(k,D.Z_NO_FLUSH))===D.Z_NEED_DICT&&ee&&(X="string"==typeof ee?v.string2buf(ee):"[object ArrayBuffer]"===U.call(ee)?new Uint8Array(ee):ee,E=S.inflateSetDictionary(this.strm,X)),E===D.Z_BUF_ERROR&&!0===H&&(E=D.Z_OK,H=!1),E!==D.Z_STREAM_END&&E!==D.Z_OK)return this.onEnd(E),!(this.ended=!0);k.next_out&&(0!==k.avail_out&&E!==D.Z_STREAM_END&&(0!==k.avail_in||V!==D.Z_FINISH&&V!==D.Z_SYNC_FLUSH)||("string"===this.options.to?(le=v.utf8border(k.output,k.next_out),Z=k.next_out-le,Y=v.buf2string(k.output,le),k.next_out=Z,k.avail_out=R-Z,Z&&te.arraySet(k.output,k.output,le,Z,0),this.onData(Y)):this.onData(te.shrinkBuf(k.output,k.next_out)))),0===k.avail_in&&0===k.avail_out&&(H=!0)}while((0<k.avail_in||0===k.avail_out)&&E!==D.Z_STREAM_END);return E===D.Z_STREAM_END&&(V=D.Z_FINISH),V===D.Z_FINISH?(E=S.inflateEnd(this.strm),this.onEnd(E),this.ended=!0,E===D.Z_OK):V!==D.Z_SYNC_FLUSH||(this.onEnd(D.Z_OK),!(k.avail_out=0))},N.prototype.onData=function(re){this.chunks.push(re)},N.prototype.onEnd=function(re){re===D.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):te.flattenChunks(this.chunks)),this.chunks=[],this.err=re,this.msg=this.strm.msg},f.Inflate=N,f.inflate=G,f.inflateRaw=function(re,q){return(q=q||{}).raw=!0,G(re,q)},f.ungzip=G},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(fe,Ce,f){"use strict";var S="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;f.assign=function(D){for(var z=Array.prototype.slice.call(arguments,1);z.length;){var I=z.shift();if(I){if("object"!=typeof I)throw new TypeError(I+"must be non-object");for(var Q in I)I.hasOwnProperty(Q)&&(D[Q]=I[Q])}}return D},f.shrinkBuf=function(D,z){return D.length===z?D:D.subarray?D.subarray(0,z):(D.length=z,D)};var te={arraySet:function(D,z,I,Q,U){if(z.subarray&&D.subarray)D.set(z.subarray(I,I+Q),U);else for(var N=0;N<Q;N++)D[U+N]=z[I+N]},flattenChunks:function(D){var z,I,Q,U,N,G;for(z=Q=0,I=D.length;z<I;z++)Q+=D[z].length;for(G=new Uint8Array(Q),z=U=0,I=D.length;z<I;z++)G.set(N=D[z],U),U+=N.length;return G}},v={arraySet:function(D,z,I,Q,U){for(var N=0;N<Q;N++)D[U+N]=z[I+N]},flattenChunks:function(D){return[].concat.apply([],D)}};f.setTyped=function(D){D?(f.Buf8=Uint8Array,f.Buf16=Uint16Array,f.Buf32=Int32Array,f.assign(f,te)):(f.Buf8=Array,f.Buf16=Array,f.Buf32=Array,f.assign(f,v))},f.setTyped(S)},{}],42:[function(fe,Ce,f){"use strict";var S=fe("./common"),te=!0,v=!0;try{String.fromCharCode.apply(null,[0])}catch(Q){te=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(Q){v=!1}for(var D=new S.Buf8(256),z=0;z<256;z++)D[z]=252<=z?6:248<=z?5:240<=z?4:224<=z?3:192<=z?2:1;function I(Q,U){if(U<65537&&(Q.subarray&&v||!Q.subarray&&te))return String.fromCharCode.apply(null,S.shrinkBuf(Q,U));for(var N="",G=0;G<U;G++)N+=String.fromCharCode(Q[G]);return N}D[254]=D[254]=1,f.string2buf=function(Q){var U,N,G,re,q,E=Q.length,V=0;for(re=0;re<E;re++)55296==(64512&(N=Q.charCodeAt(re)))&&re+1<E&&56320==(64512&(G=Q.charCodeAt(re+1)))&&(N=65536+(N-55296<<10)+(G-56320),re++),V+=N<128?1:N<2048?2:N<65536?3:4;for(U=new S.Buf8(V),re=q=0;q<V;re++)55296==(64512&(N=Q.charCodeAt(re)))&&re+1<E&&56320==(64512&(G=Q.charCodeAt(re+1)))&&(N=65536+(N-55296<<10)+(G-56320),re++),N<128?U[q++]=N:(N<2048?U[q++]=192|N>>>6:(N<65536?U[q++]=224|N>>>12:(U[q++]=240|N>>>18,U[q++]=128|N>>>12&63),U[q++]=128|N>>>6&63),U[q++]=128|63&N);return U},f.buf2binstring=function(Q){return I(Q,Q.length)},f.binstring2buf=function(Q){for(var U=new S.Buf8(Q.length),N=0,G=U.length;N<G;N++)U[N]=Q.charCodeAt(N);return U},f.buf2string=function(Q,U){var N,G,re,q,E=U||Q.length,V=new Array(2*E);for(N=G=0;N<E;)if((re=Q[N++])<128)V[G++]=re;else if(4<(q=D[re]))V[G++]=65533,N+=q-1;else{for(re&=2===q?31:3===q?15:7;1<q&&N<E;)re=re<<6|63&Q[N++],q--;1<q?V[G++]=65533:re<65536?V[G++]=re:(V[G++]=55296|(re-=65536)>>10&1023,V[G++]=56320|1023&re)}return I(V,G)},f.utf8border=function(Q,U){var N;for((U=U||Q.length)>Q.length&&(U=Q.length),N=U-1;0<=N&&128==(192&Q[N]);)N--;return N<0||0===N?U:N+D[Q[N]]>U?N:U}},{"./common":41}],43:[function(fe,Ce,f){"use strict";Ce.exports=function(S,te,v,D){for(var z=65535&S|0,I=S>>>16&65535|0,Q=0;0!==v;){for(v-=Q=2e3<v?2e3:v;I=I+(z=z+te[D++]|0)|0,--Q;);z%=65521,I%=65521}return z|I<<16|0}},{}],44:[function(fe,Ce,f){"use strict";Ce.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(fe,Ce,f){"use strict";var S=function(){for(var te,v=[],D=0;D<256;D++){te=D;for(var z=0;z<8;z++)te=1&te?3988292384^te>>>1:te>>>1;v[D]=te}return v}();Ce.exports=function(te,v,D,z){var I=S,Q=z+D;te^=-1;for(var U=z;U<Q;U++)te=te>>>8^I[255&(te^v[U])];return-1^te}},{}],46:[function(fe,Ce,f){"use strict";var S,te=fe("../utils/common"),v=fe("./trees"),D=fe("./adler32"),z=fe("./crc32"),I=fe("./messages"),G=-2,H=258,A=262,C=113;function he(de,Fe){return de.msg=I[Fe],Fe}function B(de){return(de<<1)-(4<de?9:0)}function O(de){for(var Fe=de.length;0<=--Fe;)de[Fe]=0}function m(de){var Fe=de.state,xe=Fe.pending;xe>de.avail_out&&(xe=de.avail_out),0!==xe&&(te.arraySet(de.output,Fe.pending_buf,Fe.pending_out,xe,de.next_out),de.next_out+=xe,Fe.pending_out+=xe,de.total_out+=xe,de.avail_out-=xe,Fe.pending-=xe,0===Fe.pending&&(Fe.pending_out=0))}function l(de,Fe){v._tr_flush_block(de,0<=de.block_start?de.block_start:-1,de.strstart-de.block_start,Fe),de.block_start=de.strstart,m(de.strm)}function c(de,Fe){de.pending_buf[de.pending++]=Fe}function h(de,Fe){de.pending_buf[de.pending++]=Fe>>>8&255,de.pending_buf[de.pending++]=255&Fe}function d(de,Fe){var xe,ke,De=de.max_chain_length,Me=de.strstart,_e=de.prev_length,ce=de.nice_match,pe=de.strstart>de.w_size-A?de.strstart-(de.w_size-A):0,ye=de.window,b=de.w_mask,K=de.prev,ge=de.strstart+H,be=ye[Me+_e-1],Pe=ye[Me+_e];de.prev_length>=de.good_match&&(De>>=2),ce>de.lookahead&&(ce=de.lookahead);do{if(ye[(xe=Fe)+_e]===Pe&&ye[xe+_e-1]===be&&ye[xe]===ye[Me]&&ye[++xe]===ye[Me+1]){Me+=2,xe++;do{}while(ye[++Me]===ye[++xe]&&ye[++Me]===ye[++xe]&&ye[++Me]===ye[++xe]&&ye[++Me]===ye[++xe]&&ye[++Me]===ye[++xe]&&ye[++Me]===ye[++xe]&&ye[++Me]===ye[++xe]&&ye[++Me]===ye[++xe]&&Me<ge);if(ke=H-(ge-Me),Me=ge-H,_e<ke){if(de.match_start=Fe,ce<=(_e=ke))break;be=ye[Me+_e-1],Pe=ye[Me+_e]}}}while((Fe=K[Fe&b])>pe&&0!=--De);return _e<=de.lookahead?_e:de.lookahead}function p(de){var Fe,xe,ke,De,Me,_e,ce,pe,ye,b,K=de.w_size;do{if(De=de.window_size-de.lookahead-de.strstart,de.strstart>=K+(K-A)){for(te.arraySet(de.window,de.window,K,K,0),de.match_start-=K,de.strstart-=K,de.block_start-=K,Fe=xe=de.hash_size;ke=de.head[--Fe],de.head[Fe]=K<=ke?ke-K:0,--xe;);for(Fe=xe=K;ke=de.prev[--Fe],de.prev[Fe]=K<=ke?ke-K:0,--xe;);De+=K}if(0===de.strm.avail_in)break;if(ce=de.window,pe=de.strstart+de.lookahead,b=void 0,(ye=De)<(b=(_e=de.strm).avail_in)&&(b=ye),xe=0===b?0:(_e.avail_in-=b,te.arraySet(ce,_e.input,_e.next_in,b,pe),1===_e.state.wrap?_e.adler=D(_e.adler,ce,b,pe):2===_e.state.wrap&&(_e.adler=z(_e.adler,ce,b,pe)),_e.next_in+=b,_e.total_in+=b,b),de.lookahead+=xe,de.lookahead+de.insert>=3)for(de.ins_h=de.window[Me=de.strstart-de.insert],de.ins_h=(de.ins_h<<de.hash_shift^de.window[Me+1])&de.hash_mask;de.insert&&(de.ins_h=(de.ins_h<<de.hash_shift^de.window[Me+3-1])&de.hash_mask,de.prev[Me&de.w_mask]=de.head[de.ins_h],de.head[de.ins_h]=Me,Me++,de.insert--,!(de.lookahead+de.insert<3)););}while(de.lookahead<A&&0!==de.strm.avail_in)}function _(de,Fe){for(var xe,ke;;){if(de.lookahead<A){if(p(de),de.lookahead<A&&0===Fe)return 1;if(0===de.lookahead)break}if(xe=0,de.lookahead>=3&&(de.ins_h=(de.ins_h<<de.hash_shift^de.window[de.strstart+3-1])&de.hash_mask,xe=de.prev[de.strstart&de.w_mask]=de.head[de.ins_h],de.head[de.ins_h]=de.strstart),0!==xe&&de.strstart-xe<=de.w_size-A&&(de.match_length=d(de,xe)),de.match_length>=3)if(ke=v._tr_tally(de,de.strstart-de.match_start,de.match_length-3),de.lookahead-=de.match_length,de.match_length<=de.max_lazy_match&&de.lookahead>=3){for(de.match_length--;de.strstart++,de.ins_h=(de.ins_h<<de.hash_shift^de.window[de.strstart+3-1])&de.hash_mask,xe=de.prev[de.strstart&de.w_mask]=de.head[de.ins_h],de.head[de.ins_h]=de.strstart,0!=--de.match_length;);de.strstart++}else de.strstart+=de.match_length,de.match_length=0,de.ins_h=de.window[de.strstart],de.ins_h=(de.ins_h<<de.hash_shift^de.window[de.strstart+1])&de.hash_mask;else ke=v._tr_tally(de,0,de.window[de.strstart]),de.lookahead--,de.strstart++;if(ke&&(l(de,!1),0===de.strm.avail_out))return 1}return de.insert=de.strstart<2?de.strstart:2,4===Fe?(l(de,!0),0===de.strm.avail_out?3:4):de.last_lit&&(l(de,!1),0===de.strm.avail_out)?1:2}function x(de,Fe){for(var xe,ke,De;;){if(de.lookahead<A){if(p(de),de.lookahead<A&&0===Fe)return 1;if(0===de.lookahead)break}if(xe=0,de.lookahead>=3&&(de.ins_h=(de.ins_h<<de.hash_shift^de.window[de.strstart+3-1])&de.hash_mask,xe=de.prev[de.strstart&de.w_mask]=de.head[de.ins_h],de.head[de.ins_h]=de.strstart),de.prev_length=de.match_length,de.prev_match=de.match_start,de.match_length=2,0!==xe&&de.prev_length<de.max_lazy_match&&de.strstart-xe<=de.w_size-A&&(de.match_length=d(de,xe),de.match_length<=5&&(1===de.strategy||3===de.match_length&&4096<de.strstart-de.match_start)&&(de.match_length=2)),de.prev_length>=3&&de.match_length<=de.prev_length){for(De=de.strstart+de.lookahead-3,ke=v._tr_tally(de,de.strstart-1-de.prev_match,de.prev_length-3),de.lookahead-=de.prev_length-1,de.prev_length-=2;++de.strstart<=De&&(de.ins_h=(de.ins_h<<de.hash_shift^de.window[de.strstart+3-1])&de.hash_mask,xe=de.prev[de.strstart&de.w_mask]=de.head[de.ins_h],de.head[de.ins_h]=de.strstart),0!=--de.prev_length;);if(de.match_available=0,de.match_length=2,de.strstart++,ke&&(l(de,!1),0===de.strm.avail_out))return 1}else if(de.match_available){if((ke=v._tr_tally(de,0,de.window[de.strstart-1]))&&l(de,!1),de.strstart++,de.lookahead--,0===de.strm.avail_out)return 1}else de.match_available=1,de.strstart++,de.lookahead--}return de.match_available&&(ke=v._tr_tally(de,0,de.window[de.strstart-1]),de.match_available=0),de.insert=de.strstart<2?de.strstart:2,4===Fe?(l(de,!0),0===de.strm.avail_out?3:4):de.last_lit&&(l(de,!1),0===de.strm.avail_out)?1:2}function $(de,Fe,xe,ke,De){this.good_length=de,this.max_lazy=Fe,this.nice_length=xe,this.max_chain=ke,this.func=De}function se(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new te.Buf16(1146),this.dyn_dtree=new te.Buf16(122),this.bl_tree=new te.Buf16(78),O(this.dyn_ltree),O(this.dyn_dtree),O(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new te.Buf16(16),this.heap=new te.Buf16(573),O(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new te.Buf16(573),O(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ae(de){var Fe;return de&&de.state?(de.total_in=de.total_out=0,de.data_type=2,(Fe=de.state).pending=0,Fe.pending_out=0,Fe.wrap<0&&(Fe.wrap=-Fe.wrap),Fe.status=Fe.wrap?42:C,de.adler=2===Fe.wrap?0:1,Fe.last_flush=0,v._tr_init(Fe),0):he(de,G)}function Te(de){var xe,Fe=ae(de);return 0===Fe&&((xe=de.state).window_size=2*xe.w_size,O(xe.head),xe.max_lazy_match=S[xe.level].max_lazy,xe.good_match=S[xe.level].good_length,xe.nice_match=S[xe.level].nice_length,xe.max_chain_length=S[xe.level].max_chain,xe.strstart=0,xe.block_start=0,xe.lookahead=0,xe.insert=0,xe.match_length=xe.prev_length=2,xe.match_available=0,xe.ins_h=0),Fe}function Ae(de,Fe,xe,ke,De,Me){if(!de)return G;var _e=1;if(-1===Fe&&(Fe=6),ke<0?(_e=0,ke=-ke):15<ke&&(_e=2,ke-=16),De<1||9<De||8!==xe||ke<8||15<ke||Fe<0||9<Fe||Me<0||4<Me)return he(de,G);8===ke&&(ke=9);var ce=new se;return(de.state=ce).strm=de,ce.wrap=_e,ce.gzhead=null,ce.w_bits=ke,ce.w_size=1<<ce.w_bits,ce.w_mask=ce.w_size-1,ce.hash_bits=De+7,ce.hash_size=1<<ce.hash_bits,ce.hash_mask=ce.hash_size-1,ce.hash_shift=~~((ce.hash_bits+3-1)/3),ce.window=new te.Buf8(2*ce.w_size),ce.head=new te.Buf16(ce.hash_size),ce.prev=new te.Buf16(ce.w_size),ce.lit_bufsize=1<<De+6,ce.pending_buf_size=4*ce.lit_bufsize,ce.pending_buf=new te.Buf8(ce.pending_buf_size),ce.d_buf=1*ce.lit_bufsize,ce.l_buf=3*ce.lit_bufsize,ce.level=Fe,ce.strategy=Me,ce.method=xe,Te(de)}S=[new $(0,0,0,0,function(de,Fe){var xe=65535;for(xe>de.pending_buf_size-5&&(xe=de.pending_buf_size-5);;){if(de.lookahead<=1){if(p(de),0===de.lookahead&&0===Fe)return 1;if(0===de.lookahead)break}de.strstart+=de.lookahead,de.lookahead=0;var ke=de.block_start+xe;if((0===de.strstart||de.strstart>=ke)&&(de.lookahead=de.strstart-ke,de.strstart=ke,l(de,!1),0===de.strm.avail_out)||de.strstart-de.block_start>=de.w_size-A&&(l(de,!1),0===de.strm.avail_out))return 1}return de.insert=0,4===Fe?(l(de,!0),0===de.strm.avail_out?3:4):(de.strstart>de.block_start&&l(de,!1),1)}),new $(4,4,8,4,_),new $(4,5,16,8,_),new $(4,6,32,32,_),new $(4,4,16,16,x),new $(8,16,32,32,x),new $(8,16,128,128,x),new $(8,32,128,256,x),new $(32,128,258,1024,x),new $(32,258,258,4096,x)],f.deflateInit=function(de,Fe){return Ae(de,Fe,8,15,8,0)},f.deflateInit2=Ae,f.deflateReset=Te,f.deflateResetKeep=ae,f.deflateSetHeader=function(de,Fe){return de&&de.state?2!==de.state.wrap?G:(de.state.gzhead=Fe,0):G},f.deflate=function(de,Fe){var xe,ke,De,Me;if(!de||!de.state||5<Fe||Fe<0)return de?he(de,G):G;if(ke=de.state,!de.output||!de.input&&0!==de.avail_in||666===ke.status&&4!==Fe)return he(de,0===de.avail_out?-5:G);if(ke.strm=de,xe=ke.last_flush,ke.last_flush=Fe,42===ke.status)if(2===ke.wrap)de.adler=0,c(ke,31),c(ke,139),c(ke,8),ke.gzhead?(c(ke,(ke.gzhead.text?1:0)+(ke.gzhead.hcrc?2:0)+(ke.gzhead.extra?4:0)+(ke.gzhead.name?8:0)+(ke.gzhead.comment?16:0)),c(ke,255&ke.gzhead.time),c(ke,ke.gzhead.time>>8&255),c(ke,ke.gzhead.time>>16&255),c(ke,ke.gzhead.time>>24&255),c(ke,9===ke.level?2:2<=ke.strategy||ke.level<2?4:0),c(ke,255&ke.gzhead.os),ke.gzhead.extra&&ke.gzhead.extra.length&&(c(ke,255&ke.gzhead.extra.length),c(ke,ke.gzhead.extra.length>>8&255)),ke.gzhead.hcrc&&(de.adler=z(de.adler,ke.pending_buf,ke.pending,0)),ke.gzindex=0,ke.status=69):(c(ke,0),c(ke,0),c(ke,0),c(ke,0),c(ke,0),c(ke,9===ke.level?2:2<=ke.strategy||ke.level<2?4:0),c(ke,3),ke.status=C);else{var _e=8+(ke.w_bits-8<<4)<<8;_e|=(2<=ke.strategy||ke.level<2?0:ke.level<6?1:6===ke.level?2:3)<<6,0!==ke.strstart&&(_e|=32),_e+=31-_e%31,ke.status=C,h(ke,_e),0!==ke.strstart&&(h(ke,de.adler>>>16),h(ke,65535&de.adler)),de.adler=1}if(69===ke.status)if(ke.gzhead.extra){for(De=ke.pending;ke.gzindex<(65535&ke.gzhead.extra.length)&&(ke.pending!==ke.pending_buf_size||(ke.gzhead.hcrc&&ke.pending>De&&(de.adler=z(de.adler,ke.pending_buf,ke.pending-De,De)),m(de),De=ke.pending,ke.pending!==ke.pending_buf_size));)c(ke,255&ke.gzhead.extra[ke.gzindex]),ke.gzindex++;ke.gzhead.hcrc&&ke.pending>De&&(de.adler=z(de.adler,ke.pending_buf,ke.pending-De,De)),ke.gzindex===ke.gzhead.extra.length&&(ke.gzindex=0,ke.status=73)}else ke.status=73;if(73===ke.status)if(ke.gzhead.name){De=ke.pending;do{if(ke.pending===ke.pending_buf_size&&(ke.gzhead.hcrc&&ke.pending>De&&(de.adler=z(de.adler,ke.pending_buf,ke.pending-De,De)),m(de),De=ke.pending,ke.pending===ke.pending_buf_size)){Me=1;break}Me=ke.gzindex<ke.gzhead.name.length?255&ke.gzhead.name.charCodeAt(ke.gzindex++):0,c(ke,Me)}while(0!==Me);ke.gzhead.hcrc&&ke.pending>De&&(de.adler=z(de.adler,ke.pending_buf,ke.pending-De,De)),0===Me&&(ke.gzindex=0,ke.status=91)}else ke.status=91;if(91===ke.status)if(ke.gzhead.comment){De=ke.pending;do{if(ke.pending===ke.pending_buf_size&&(ke.gzhead.hcrc&&ke.pending>De&&(de.adler=z(de.adler,ke.pending_buf,ke.pending-De,De)),m(de),De=ke.pending,ke.pending===ke.pending_buf_size)){Me=1;break}Me=ke.gzindex<ke.gzhead.comment.length?255&ke.gzhead.comment.charCodeAt(ke.gzindex++):0,c(ke,Me)}while(0!==Me);ke.gzhead.hcrc&&ke.pending>De&&(de.adler=z(de.adler,ke.pending_buf,ke.pending-De,De)),0===Me&&(ke.status=103)}else ke.status=103;if(103===ke.status&&(ke.gzhead.hcrc?(ke.pending+2>ke.pending_buf_size&&m(de),ke.pending+2<=ke.pending_buf_size&&(c(ke,255&de.adler),c(ke,de.adler>>8&255),de.adler=0,ke.status=C)):ke.status=C),0!==ke.pending){if(m(de),0===de.avail_out)return ke.last_flush=-1,0}else if(0===de.avail_in&&B(Fe)<=B(xe)&&4!==Fe)return he(de,-5);if(666===ke.status&&0!==de.avail_in)return he(de,-5);if(0!==de.avail_in||0!==ke.lookahead||0!==Fe&&666!==ke.status){var ce=2===ke.strategy?function(pe,ye){for(var b;;){if(0===pe.lookahead&&(p(pe),0===pe.lookahead)){if(0===ye)return 1;break}if(pe.match_length=0,b=v._tr_tally(pe,0,pe.window[pe.strstart]),pe.lookahead--,pe.strstart++,b&&(l(pe,!1),0===pe.strm.avail_out))return 1}return pe.insert=0,4===ye?(l(pe,!0),0===pe.strm.avail_out?3:4):pe.last_lit&&(l(pe,!1),0===pe.strm.avail_out)?1:2}(ke,Fe):3===ke.strategy?function(pe,ye){for(var b,K,ge,be,Pe=pe.window;;){if(pe.lookahead<=H){if(p(pe),pe.lookahead<=H&&0===ye)return 1;if(0===pe.lookahead)break}if(pe.match_length=0,pe.lookahead>=3&&0<pe.strstart&&(K=Pe[ge=pe.strstart-1])===Pe[++ge]&&K===Pe[++ge]&&K===Pe[++ge]){be=pe.strstart+H;do{}while(K===Pe[++ge]&&K===Pe[++ge]&&K===Pe[++ge]&&K===Pe[++ge]&&K===Pe[++ge]&&K===Pe[++ge]&&K===Pe[++ge]&&K===Pe[++ge]&&ge<be);pe.match_length=H-(be-ge),pe.match_length>pe.lookahead&&(pe.match_length=pe.lookahead)}if(pe.match_length>=3?(b=v._tr_tally(pe,1,pe.match_length-3),pe.lookahead-=pe.match_length,pe.strstart+=pe.match_length,pe.match_length=0):(b=v._tr_tally(pe,0,pe.window[pe.strstart]),pe.lookahead--,pe.strstart++),b&&(l(pe,!1),0===pe.strm.avail_out))return 1}return pe.insert=0,4===ye?(l(pe,!0),0===pe.strm.avail_out?3:4):pe.last_lit&&(l(pe,!1),0===pe.strm.avail_out)?1:2}(ke,Fe):S[ke.level].func(ke,Fe);if(3!==ce&&4!==ce||(ke.status=666),1===ce||3===ce)return 0===de.avail_out&&(ke.last_flush=-1),0;if(2===ce&&(1===Fe?v._tr_align(ke):5!==Fe&&(v._tr_stored_block(ke,0,0,!1),3===Fe&&(O(ke.head),0===ke.lookahead&&(ke.strstart=0,ke.block_start=0,ke.insert=0))),m(de),0===de.avail_out))return ke.last_flush=-1,0}return 4!==Fe?0:ke.wrap<=0?1:(2===ke.wrap?(c(ke,255&de.adler),c(ke,de.adler>>8&255),c(ke,de.adler>>16&255),c(ke,de.adler>>24&255),c(ke,255&de.total_in),c(ke,de.total_in>>8&255),c(ke,de.total_in>>16&255),c(ke,de.total_in>>24&255)):(h(ke,de.adler>>>16),h(ke,65535&de.adler)),m(de),0<ke.wrap&&(ke.wrap=-ke.wrap),0!==ke.pending?0:1)},f.deflateEnd=function(de){var Fe;return de&&de.state?42!==(Fe=de.state.status)&&69!==Fe&&73!==Fe&&91!==Fe&&103!==Fe&&Fe!==C&&666!==Fe?he(de,G):(de.state=null,Fe===C?he(de,-3):0):G},f.deflateSetDictionary=function(de,Fe){var xe,ke,De,Me,_e,ce,pe,ye,b=Fe.length;if(!de||!de.state||2===(Me=(xe=de.state).wrap)||1===Me&&42!==xe.status||xe.lookahead)return G;for(1===Me&&(de.adler=D(de.adler,Fe,b,0)),xe.wrap=0,b>=xe.w_size&&(0===Me&&(O(xe.head),xe.strstart=0,xe.block_start=0,xe.insert=0),ye=new te.Buf8(xe.w_size),te.arraySet(ye,Fe,b-xe.w_size,xe.w_size,0),Fe=ye,b=xe.w_size),_e=de.avail_in,ce=de.next_in,pe=de.input,de.avail_in=b,de.next_in=0,de.input=Fe,p(xe);xe.lookahead>=3;){for(ke=xe.strstart,De=xe.lookahead-2;xe.ins_h=(xe.ins_h<<xe.hash_shift^xe.window[ke+3-1])&xe.hash_mask,xe.prev[ke&xe.w_mask]=xe.head[xe.ins_h],xe.head[xe.ins_h]=ke,ke++,--De;);xe.strstart=ke,xe.lookahead=2,p(xe)}return xe.strstart+=xe.lookahead,xe.block_start=xe.strstart,xe.insert=xe.lookahead,xe.lookahead=0,xe.match_length=xe.prev_length=2,xe.match_available=0,de.next_in=ce,de.input=pe,de.avail_in=_e,xe.wrap=Me,0},f.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(fe,Ce,f){"use strict";Ce.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(fe,Ce,f){"use strict";Ce.exports=function(S,te){var v,D,z,I,Q,U,N,G,re,q,E,V,le,Z,Y,X,k,R,ee,H,A,M,C,P,L;P=S.input,z=(D=S.next_in)+(S.avail_in-5),L=S.output,Q=(I=S.next_out)-(te-S.avail_out),U=I+(S.avail_out-257),N=(v=S.state).dmax,G=v.wsize,re=v.whave,q=v.wnext,E=v.window,V=v.hold,le=v.bits,Z=v.lencode,Y=v.distcode,X=(1<<v.lenbits)-1,k=(1<<v.distbits)-1;e:do{le<15&&(V+=P[D++]<<le,V+=P[D++]<<(le+=8),le+=8),R=Z[V&X];t:for(;;){if(V>>>=ee=R>>>24,le-=ee,0==(ee=R>>>16&255))L[I++]=65535&R;else{if(!(16&ee)){if(0==(64&ee)){R=Z[(65535&R)+(V&(1<<ee)-1)];continue t}if(32&ee){v.mode=12;break e}S.msg="invalid literal/length code",v.mode=30;break e}H=65535&R,(ee&=15)&&(le<ee&&(V+=P[D++]<<le,le+=8),H+=V&(1<<ee)-1,V>>>=ee,le-=ee),le<15&&(V+=P[D++]<<le,V+=P[D++]<<(le+=8),le+=8),R=Y[V&k];n:for(;;){if(V>>>=ee=R>>>24,le-=ee,!(16&(ee=R>>>16&255))){if(0==(64&ee)){R=Y[(65535&R)+(V&(1<<ee)-1)];continue n}S.msg="invalid distance code",v.mode=30;break e}if(A=65535&R,le<(ee&=15)&&(V+=P[D++]<<le,(le+=8)<ee&&(V+=P[D++]<<le,le+=8)),N<(A+=V&(1<<ee)-1)){S.msg="invalid distance too far back",v.mode=30;break e}if(V>>>=ee,le-=ee,(ee=I-Q)<A){if(re<(ee=A-ee)&&v.sane){S.msg="invalid distance too far back",v.mode=30;break e}if(C=E,(M=0)===q){if(M+=G-ee,ee<H){for(H-=ee;L[I++]=E[M++],--ee;);M=I-A,C=L}}else if(q<ee){if(M+=G+q-ee,(ee-=q)<H){for(H-=ee;L[I++]=E[M++],--ee;);if(M=0,q<H){for(H-=ee=q;L[I++]=E[M++],--ee;);M=I-A,C=L}}}else if(M+=q-ee,ee<H){for(H-=ee;L[I++]=E[M++],--ee;);M=I-A,C=L}for(;2<H;)L[I++]=C[M++],L[I++]=C[M++],L[I++]=C[M++],H-=3;H&&(L[I++]=C[M++],1<H&&(L[I++]=C[M++]))}else{for(M=I-A;L[I++]=L[M++],L[I++]=L[M++],L[I++]=L[M++],2<(H-=3););H&&(L[I++]=L[M++],1<H&&(L[I++]=L[M++]))}break}}break}}while(D<z&&I<U);D-=H=le>>3,V&=(1<<(le-=H<<3))-1,S.next_in=D,S.next_out=I,S.avail_in=D<z?z-D+5:5-(D-z),S.avail_out=I<U?U-I+257:257-(I-U),v.hold=V,v.bits=le}},{}],49:[function(fe,Ce,f){"use strict";var S=fe("../utils/common"),te=fe("./adler32"),v=fe("./crc32"),D=fe("./inffast"),z=fe("./inftrees"),N=-2;function E(M){return(M>>>24&255)+(M>>>8&65280)+((65280&M)<<8)+((255&M)<<24)}function V(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new S.Buf16(320),this.work=new S.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function le(M){var C;return M&&M.state?(M.total_in=M.total_out=(C=M.state).total=0,M.msg="",C.wrap&&(M.adler=1&C.wrap),C.mode=1,C.last=0,C.havedict=0,C.dmax=32768,C.head=null,C.hold=0,C.bits=0,C.lencode=C.lendyn=new S.Buf32(852),C.distcode=C.distdyn=new S.Buf32(592),C.sane=1,C.back=-1,0):N}function Z(M){var C;return M&&M.state?((C=M.state).wsize=0,C.whave=0,C.wnext=0,le(M)):N}function Y(M,C){var P,L;return M&&M.state?(L=M.state,C<0?(P=0,C=-C):(P=1+(C>>4),C<48&&(C&=15)),C&&(C<8||15<C)?N:(null!==L.window&&L.wbits!==C&&(L.window=null),L.wrap=P,L.wbits=C,Z(M))):N}function X(M,C){var P,L;return M?(L=new V,(M.state=L).window=null,0!==(P=Y(M,C))&&(M.state=null),P):N}var k,R,ee=!0;function H(M){if(ee){var C;for(k=new S.Buf32(512),R=new S.Buf32(32),C=0;C<144;)M.lens[C++]=8;for(;C<256;)M.lens[C++]=9;for(;C<280;)M.lens[C++]=7;for(;C<288;)M.lens[C++]=8;for(z(1,M.lens,0,288,k,0,M.work,{bits:9}),C=0;C<32;)M.lens[C++]=5;z(2,M.lens,0,32,R,0,M.work,{bits:5}),ee=!1}M.lencode=k,M.lenbits=9,M.distcode=R,M.distbits=5}function A(M,C,P,L){var ne,F=M.state;return null===F.window&&(F.wsize=1<<F.wbits,F.wnext=0,F.whave=0,F.window=new S.Buf8(F.wsize)),L>=F.wsize?(S.arraySet(F.window,C,P-F.wsize,F.wsize,0),F.wnext=0,F.whave=F.wsize):(L<(ne=F.wsize-F.wnext)&&(ne=L),S.arraySet(F.window,C,P-L,ne,F.wnext),(L-=ne)?(S.arraySet(F.window,C,P-L,L,0),F.wnext=L,F.whave=F.wsize):(F.wnext+=ne,F.wnext===F.wsize&&(F.wnext=0),F.whave<F.wsize&&(F.whave+=ne))),0}f.inflateReset=Z,f.inflateReset2=Y,f.inflateResetKeep=le,f.inflateInit=function(M){return X(M,15)},f.inflateInit2=X,f.inflate=function(M,C){var P,L,ne,F,he,B,O,m,l,c,h,d,p,_,x,$,se,ae,Te,Ae,de,Fe,xe,ke,De=0,Me=new S.Buf8(4),_e=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!M||!M.state||!M.output||!M.input&&0!==M.avail_in)return N;12===(P=M.state).mode&&(P.mode=13),he=M.next_out,ne=M.output,F=M.next_in,L=M.input,m=P.hold,l=P.bits,c=B=M.avail_in,h=O=M.avail_out,Fe=0;e:for(;;)switch(P.mode){case 1:if(0===P.wrap){P.mode=13;break}for(;l<16;){if(0===B)break e;B--,m+=L[F++]<<l,l+=8}if(2&P.wrap&&35615===m){Me[P.check=0]=255&m,Me[1]=m>>>8&255,P.check=v(P.check,Me,2,0),l=m=0,P.mode=2;break}if(P.flags=0,P.head&&(P.head.done=!1),!(1&P.wrap)||(((255&m)<<8)+(m>>8))%31){M.msg="incorrect header check",P.mode=30;break}if(8!=(15&m)){M.msg="unknown compression method",P.mode=30;break}if(l-=4,de=8+(15&(m>>>=4)),0===P.wbits)P.wbits=de;else if(de>P.wbits){M.msg="invalid window size",P.mode=30;break}P.dmax=1<<de,M.adler=P.check=1,P.mode=512&m?10:12,l=m=0;break;case 2:for(;l<16;){if(0===B)break e;B--,m+=L[F++]<<l,l+=8}if(P.flags=m,8!=(255&P.flags)){M.msg="unknown compression method",P.mode=30;break}if(57344&P.flags){M.msg="unknown header flags set",P.mode=30;break}P.head&&(P.head.text=m>>8&1),512&P.flags&&(Me[0]=255&m,Me[1]=m>>>8&255,P.check=v(P.check,Me,2,0)),l=m=0,P.mode=3;case 3:for(;l<32;){if(0===B)break e;B--,m+=L[F++]<<l,l+=8}P.head&&(P.head.time=m),512&P.flags&&(Me[0]=255&m,Me[1]=m>>>8&255,Me[2]=m>>>16&255,Me[3]=m>>>24&255,P.check=v(P.check,Me,4,0)),l=m=0,P.mode=4;case 4:for(;l<16;){if(0===B)break e;B--,m+=L[F++]<<l,l+=8}P.head&&(P.head.xflags=255&m,P.head.os=m>>8),512&P.flags&&(Me[0]=255&m,Me[1]=m>>>8&255,P.check=v(P.check,Me,2,0)),l=m=0,P.mode=5;case 5:if(1024&P.flags){for(;l<16;){if(0===B)break e;B--,m+=L[F++]<<l,l+=8}P.length=m,P.head&&(P.head.extra_len=m),512&P.flags&&(Me[0]=255&m,Me[1]=m>>>8&255,P.check=v(P.check,Me,2,0)),l=m=0}else P.head&&(P.head.extra=null);P.mode=6;case 6:if(1024&P.flags&&(B<(d=P.length)&&(d=B),d&&(P.head&&(de=P.head.extra_len-P.length,P.head.extra||(P.head.extra=new Array(P.head.extra_len)),S.arraySet(P.head.extra,L,F,d,de)),512&P.flags&&(P.check=v(P.check,L,d,F)),B-=d,F+=d,P.length-=d),P.length))break e;P.length=0,P.mode=7;case 7:if(2048&P.flags){if(0===B)break e;for(d=0;de=L[F+d++],P.head&&de&&P.length<65536&&(P.head.name+=String.fromCharCode(de)),de&&d<B;);if(512&P.flags&&(P.check=v(P.check,L,d,F)),B-=d,F+=d,de)break e}else P.head&&(P.head.name=null);P.length=0,P.mode=8;case 8:if(4096&P.flags){if(0===B)break e;for(d=0;de=L[F+d++],P.head&&de&&P.length<65536&&(P.head.comment+=String.fromCharCode(de)),de&&d<B;);if(512&P.flags&&(P.check=v(P.check,L,d,F)),B-=d,F+=d,de)break e}else P.head&&(P.head.comment=null);P.mode=9;case 9:if(512&P.flags){for(;l<16;){if(0===B)break e;B--,m+=L[F++]<<l,l+=8}if(m!==(65535&P.check)){M.msg="header crc mismatch",P.mode=30;break}l=m=0}P.head&&(P.head.hcrc=P.flags>>9&1,P.head.done=!0),M.adler=P.check=0,P.mode=12;break;case 10:for(;l<32;){if(0===B)break e;B--,m+=L[F++]<<l,l+=8}M.adler=P.check=E(m),l=m=0,P.mode=11;case 11:if(0===P.havedict)return M.next_out=he,M.avail_out=O,M.next_in=F,M.avail_in=B,P.hold=m,P.bits=l,2;M.adler=P.check=1,P.mode=12;case 12:if(5===C||6===C)break e;case 13:if(P.last){m>>>=7&l,l-=7&l,P.mode=27;break}for(;l<3;){if(0===B)break e;B--,m+=L[F++]<<l,l+=8}switch(P.last=1&m,l-=1,3&(m>>>=1)){case 0:P.mode=14;break;case 1:if(H(P),P.mode=20,6!==C)break;m>>>=2,l-=2;break e;case 2:P.mode=17;break;case 3:M.msg="invalid block type",P.mode=30}m>>>=2,l-=2;break;case 14:for(m>>>=7&l,l-=7&l;l<32;){if(0===B)break e;B--,m+=L[F++]<<l,l+=8}if((65535&m)!=(m>>>16^65535)){M.msg="invalid stored block lengths",P.mode=30;break}if(P.length=65535&m,l=m=0,P.mode=15,6===C)break e;case 15:P.mode=16;case 16:if(d=P.length){if(B<d&&(d=B),O<d&&(d=O),0===d)break e;S.arraySet(ne,L,F,d,he),B-=d,F+=d,O-=d,he+=d,P.length-=d;break}P.mode=12;break;case 17:for(;l<14;){if(0===B)break e;B--,m+=L[F++]<<l,l+=8}if(P.nlen=257+(31&m),l-=5,P.ndist=1+(31&(m>>>=5)),l-=5,P.ncode=4+(15&(m>>>=5)),m>>>=4,l-=4,286<P.nlen||30<P.ndist){M.msg="too many length or distance symbols",P.mode=30;break}P.have=0,P.mode=18;case 18:for(;P.have<P.ncode;){for(;l<3;){if(0===B)break e;B--,m+=L[F++]<<l,l+=8}P.lens[_e[P.have++]]=7&m,m>>>=3,l-=3}for(;P.have<19;)P.lens[_e[P.have++]]=0;if(P.lencode=P.lendyn,P.lenbits=7,Fe=z(0,P.lens,0,19,P.lencode,0,P.work,xe={bits:P.lenbits}),P.lenbits=xe.bits,Fe){M.msg="invalid code lengths set",P.mode=30;break}P.have=0,P.mode=19;case 19:for(;P.have<P.nlen+P.ndist;){for(;$=(De=P.lencode[m&(1<<P.lenbits)-1])>>>16&255,se=65535&De,!((x=De>>>24)<=l);){if(0===B)break e;B--,m+=L[F++]<<l,l+=8}if(se<16)m>>>=x,l-=x,P.lens[P.have++]=se;else{if(16===se){for(ke=x+2;l<ke;){if(0===B)break e;B--,m+=L[F++]<<l,l+=8}if(m>>>=x,l-=x,0===P.have){M.msg="invalid bit length repeat",P.mode=30;break}de=P.lens[P.have-1],d=3+(3&m),m>>>=2,l-=2}else if(17===se){for(ke=x+3;l<ke;){if(0===B)break e;B--,m+=L[F++]<<l,l+=8}l-=x,de=0,d=3+(7&(m>>>=x)),m>>>=3,l-=3}else{for(ke=x+7;l<ke;){if(0===B)break e;B--,m+=L[F++]<<l,l+=8}l-=x,de=0,d=11+(127&(m>>>=x)),m>>>=7,l-=7}if(P.have+d>P.nlen+P.ndist){M.msg="invalid bit length repeat",P.mode=30;break}for(;d--;)P.lens[P.have++]=de}}if(30===P.mode)break;if(0===P.lens[256]){M.msg="invalid code -- missing end-of-block",P.mode=30;break}if(P.lenbits=9,Fe=z(1,P.lens,0,P.nlen,P.lencode,0,P.work,xe={bits:P.lenbits}),P.lenbits=xe.bits,Fe){M.msg="invalid literal/lengths set",P.mode=30;break}if(P.distbits=6,P.distcode=P.distdyn,Fe=z(2,P.lens,P.nlen,P.ndist,P.distcode,0,P.work,xe={bits:P.distbits}),P.distbits=xe.bits,Fe){M.msg="invalid distances set",P.mode=30;break}if(P.mode=20,6===C)break e;case 20:P.mode=21;case 21:if(6<=B&&258<=O){M.next_out=he,M.avail_out=O,M.next_in=F,M.avail_in=B,P.hold=m,P.bits=l,D(M,h),he=M.next_out,ne=M.output,O=M.avail_out,F=M.next_in,L=M.input,B=M.avail_in,m=P.hold,l=P.bits,12===P.mode&&(P.back=-1);break}for(P.back=0;$=(De=P.lencode[m&(1<<P.lenbits)-1])>>>16&255,se=65535&De,!((x=De>>>24)<=l);){if(0===B)break e;B--,m+=L[F++]<<l,l+=8}if($&&0==(240&$)){for(ae=x,Te=$,Ae=se;$=(De=P.lencode[Ae+((m&(1<<ae+Te)-1)>>ae)])>>>16&255,se=65535&De,!(ae+(x=De>>>24)<=l);){if(0===B)break e;B--,m+=L[F++]<<l,l+=8}m>>>=ae,l-=ae,P.back+=ae}if(m>>>=x,l-=x,P.back+=x,P.length=se,0===$){P.mode=26;break}if(32&$){P.back=-1,P.mode=12;break}if(64&$){M.msg="invalid literal/length code",P.mode=30;break}P.extra=15&$,P.mode=22;case 22:if(P.extra){for(ke=P.extra;l<ke;){if(0===B)break e;B--,m+=L[F++]<<l,l+=8}P.length+=m&(1<<P.extra)-1,m>>>=P.extra,l-=P.extra,P.back+=P.extra}P.was=P.length,P.mode=23;case 23:for(;$=(De=P.distcode[m&(1<<P.distbits)-1])>>>16&255,se=65535&De,!((x=De>>>24)<=l);){if(0===B)break e;B--,m+=L[F++]<<l,l+=8}if(0==(240&$)){for(ae=x,Te=$,Ae=se;$=(De=P.distcode[Ae+((m&(1<<ae+Te)-1)>>ae)])>>>16&255,se=65535&De,!(ae+(x=De>>>24)<=l);){if(0===B)break e;B--,m+=L[F++]<<l,l+=8}m>>>=ae,l-=ae,P.back+=ae}if(m>>>=x,l-=x,P.back+=x,64&$){M.msg="invalid distance code",P.mode=30;break}P.offset=se,P.extra=15&$,P.mode=24;case 24:if(P.extra){for(ke=P.extra;l<ke;){if(0===B)break e;B--,m+=L[F++]<<l,l+=8}P.offset+=m&(1<<P.extra)-1,m>>>=P.extra,l-=P.extra,P.back+=P.extra}if(P.offset>P.dmax){M.msg="invalid distance too far back",P.mode=30;break}P.mode=25;case 25:if(0===O)break e;if(P.offset>(d=h-O)){if((d=P.offset-d)>P.whave&&P.sane){M.msg="invalid distance too far back",P.mode=30;break}p=d>P.wnext?P.wsize-(d-=P.wnext):P.wnext-d,d>P.length&&(d=P.length),_=P.window}else _=ne,p=he-P.offset,d=P.length;for(O<d&&(d=O),O-=d,P.length-=d;ne[he++]=_[p++],--d;);0===P.length&&(P.mode=21);break;case 26:if(0===O)break e;ne[he++]=P.length,O--,P.mode=21;break;case 27:if(P.wrap){for(;l<32;){if(0===B)break e;B--,m|=L[F++]<<l,l+=8}if(M.total_out+=h-=O,P.total+=h,h&&(M.adler=P.check=P.flags?v(P.check,ne,h,he-h):te(P.check,ne,h,he-h)),h=O,(P.flags?m:E(m))!==P.check){M.msg="incorrect data check",P.mode=30;break}l=m=0}P.mode=28;case 28:if(P.wrap&&P.flags){for(;l<32;){if(0===B)break e;B--,m+=L[F++]<<l,l+=8}if(m!==(4294967295&P.total)){M.msg="incorrect length check",P.mode=30;break}l=m=0}P.mode=29;case 29:Fe=1;break e;case 30:Fe=-3;break e;case 31:return-4;default:return N}return M.next_out=he,M.avail_out=O,M.next_in=F,M.avail_in=B,P.hold=m,P.bits=l,(P.wsize||h!==M.avail_out&&P.mode<30&&(P.mode<27||4!==C))&&A(M,M.output,M.next_out,h-M.avail_out)?(P.mode=31,-4):(h-=M.avail_out,M.total_in+=c-=M.avail_in,M.total_out+=h,P.total+=h,P.wrap&&h&&(M.adler=P.check=P.flags?v(P.check,ne,h,M.next_out-h):te(P.check,ne,h,M.next_out-h)),M.data_type=P.bits+(P.last?64:0)+(12===P.mode?128:0)+(20===P.mode||15===P.mode?256:0),(0==c&&0===h||4===C)&&0===Fe&&(Fe=-5),Fe)},f.inflateEnd=function(M){if(!M||!M.state)return N;var C=M.state;return C.window&&(C.window=null),M.state=null,0},f.inflateGetHeader=function(M,C){var P;return M&&M.state?0==(2&(P=M.state).wrap)?N:((P.head=C).done=!1,0):N},f.inflateSetDictionary=function(M,C){var P,L=C.length;return M&&M.state?0!==(P=M.state).wrap&&11!==P.mode?N:11===P.mode&&te(1,C,L,0)!==P.check?-3:A(M,C,L,L)?(P.mode=31,-4):(P.havedict=1,0):N},f.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(fe,Ce,f){"use strict";var S=fe("../utils/common"),te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],v=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],D=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],z=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];Ce.exports=function(I,Q,U,N,G,re,q,E){var V,le,Z,Y,X,k,R,ee,H,A=E.bits,M=0,C=0,P=0,L=0,ne=0,F=0,he=0,B=0,O=0,m=0,l=null,c=0,h=new S.Buf16(16),d=new S.Buf16(16),p=null,_=0;for(M=0;M<=15;M++)h[M]=0;for(C=0;C<N;C++)h[Q[U+C]]++;for(ne=A,L=15;1<=L&&0===h[L];L--);if(L<ne&&(ne=L),0===L)return G[re++]=20971520,G[re++]=20971520,E.bits=1,0;for(P=1;P<L&&0===h[P];P++);for(ne<P&&(ne=P),M=B=1;M<=15;M++)if(B<<=1,(B-=h[M])<0)return-1;if(0<B&&(0===I||1!==L))return-1;for(d[1]=0,M=1;M<15;M++)d[M+1]=d[M]+h[M];for(C=0;C<N;C++)0!==Q[U+C]&&(q[d[Q[U+C]]++]=C);if(k=0===I?(l=p=q,19):1===I?(l=te,c-=257,p=v,_-=257,256):(l=D,p=z,-1),M=P,X=re,he=C=m=0,Z=-1,Y=(O=1<<(F=ne))-1,1===I&&852<O||2===I&&592<O)return 1;for(;;){for(R=M-he,H=q[C]<k?(ee=0,q[C]):q[C]>k?(ee=p[_+q[C]],l[c+q[C]]):(ee=96,0),V=1<<M-he,P=le=1<<F;G[X+(m>>he)+(le-=V)]=R<<24|ee<<16|H|0,0!==le;);for(V=1<<M-1;m&V;)V>>=1;if(0!==V?(m&=V-1,m+=V):m=0,C++,0==--h[M]){if(M===L)break;M=Q[U+q[C]]}if(ne<M&&(m&Y)!==Z){for(0===he&&(he=ne),X+=P,B=1<<(F=M-he);F+he<L&&!((B-=h[F+he])<=0);)F++,B<<=1;if(O+=1<<F,1===I&&852<O||2===I&&592<O)return 1;G[Z=m&Y]=ne<<24|F<<16|X-re|0}}return 0!==m&&(G[X+m]=M-he<<24|64<<16|0),E.bits=ne,0}},{"../utils/common":41}],51:[function(fe,Ce,f){"use strict";Ce.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(fe,Ce,f){"use strict";var S=fe("../utils/common");function D(De){for(var Me=De.length;0<=--Me;)De[Me]=0}var Q=256,U=286,N=30,q=15,k=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],R=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],A=new Array(576);D(A);var M=new Array(60);D(M);var C=new Array(512);D(C);var P=new Array(256);D(P);var L=new Array(29);D(L);var ne,F,he,B=new Array(N);function O(De,Me,_e,ce,pe){this.static_tree=De,this.extra_bits=Me,this.extra_base=_e,this.elems=ce,this.max_length=pe,this.has_stree=De&&De.length}function m(De,Me){this.dyn_tree=De,this.max_code=0,this.stat_desc=Me}function l(De){return De<256?C[De]:C[256+(De>>>7)]}function c(De,Me){De.pending_buf[De.pending++]=255&Me,De.pending_buf[De.pending++]=Me>>>8&255}function h(De,Me,_e){De.bi_valid>16-_e?(De.bi_buf|=Me<<De.bi_valid&65535,c(De,De.bi_buf),De.bi_buf=Me>>16-De.bi_valid,De.bi_valid+=_e-16):(De.bi_buf|=Me<<De.bi_valid&65535,De.bi_valid+=_e)}function d(De,Me,_e){h(De,_e[2*Me],_e[2*Me+1])}function p(De,Me){for(var _e=0;_e|=1&De,De>>>=1,_e<<=1,0<--Me;);return _e>>>1}function _(De,Me,_e){var ce,pe,ye=new Array(16),b=0;for(ce=1;ce<=q;ce++)ye[ce]=b=b+_e[ce-1]<<1;for(pe=0;pe<=Me;pe++){var K=De[2*pe+1];0!==K&&(De[2*pe]=p(ye[K]++,K))}}function x(De){var Me;for(Me=0;Me<U;Me++)De.dyn_ltree[2*Me]=0;for(Me=0;Me<N;Me++)De.dyn_dtree[2*Me]=0;for(Me=0;Me<19;Me++)De.bl_tree[2*Me]=0;De.dyn_ltree[512]=1,De.opt_len=De.static_len=0,De.last_lit=De.matches=0}function $(De){8<De.bi_valid?c(De,De.bi_buf):0<De.bi_valid&&(De.pending_buf[De.pending++]=De.bi_buf),De.bi_buf=0,De.bi_valid=0}function se(De,Me,_e,ce){var pe=2*Me,ye=2*_e;return De[pe]<De[ye]||De[pe]===De[ye]&&ce[Me]<=ce[_e]}function ae(De,Me,_e){for(var ce=De.heap[_e],pe=_e<<1;pe<=De.heap_len&&(pe<De.heap_len&&se(Me,De.heap[pe+1],De.heap[pe],De.depth)&&pe++,!se(Me,ce,De.heap[pe],De.depth));)De.heap[_e]=De.heap[pe],_e=pe,pe<<=1;De.heap[_e]=ce}function Te(De,Me,_e){var ce,pe,ye,b,K=0;if(0!==De.last_lit)for(;ce=De.pending_buf[De.d_buf+2*K]<<8|De.pending_buf[De.d_buf+2*K+1],pe=De.pending_buf[De.l_buf+K],K++,0===ce?d(De,pe,Me):(d(De,(ye=P[pe])+Q+1,Me),0!==(b=k[ye])&&h(De,pe-=L[ye],b),d(De,ye=l(--ce),_e),0!==(b=R[ye])&&h(De,ce-=B[ye],b)),K<De.last_lit;);d(De,256,Me)}function Ae(De,Me){var _e,ce,pe,ye=Me.dyn_tree,b=Me.stat_desc.static_tree,K=Me.stat_desc.has_stree,ge=Me.stat_desc.elems,be=-1;for(De.heap_len=0,De.heap_max=573,_e=0;_e<ge;_e++)0!==ye[2*_e]?(De.heap[++De.heap_len]=be=_e,De.depth[_e]=0):ye[2*_e+1]=0;for(;De.heap_len<2;)ye[2*(pe=De.heap[++De.heap_len]=be<2?++be:0)]=1,De.depth[pe]=0,De.opt_len--,K&&(De.static_len-=b[2*pe+1]);for(Me.max_code=be,_e=De.heap_len>>1;1<=_e;_e--)ae(De,ye,_e);for(pe=ge;_e=De.heap[1],De.heap[1]=De.heap[De.heap_len--],ae(De,ye,1),ce=De.heap[1],De.heap[--De.heap_max]=_e,De.heap[--De.heap_max]=ce,ye[2*pe]=ye[2*_e]+ye[2*ce],De.depth[pe]=(De.depth[_e]>=De.depth[ce]?De.depth[_e]:De.depth[ce])+1,ye[2*_e+1]=ye[2*ce+1]=pe,De.heap[1]=pe++,ae(De,ye,1),2<=De.heap_len;);De.heap[--De.heap_max]=De.heap[1],function(Pe,Ue){var Ye,nt,vt,wt,cn,an,Bn=Ue.dyn_tree,zn=Ue.max_code,Hi=Ue.stat_desc.static_tree,lr=Ue.stat_desc.has_stree,Sl=Ue.stat_desc.extra_bits,vc=Ue.stat_desc.extra_base,Jo=Ue.stat_desc.max_length,Dl=0;for(wt=0;wt<=q;wt++)Pe.bl_count[wt]=0;for(Bn[2*Pe.heap[Pe.heap_max]+1]=0,Ye=Pe.heap_max+1;Ye<573;Ye++)Jo<(wt=Bn[2*Bn[2*(nt=Pe.heap[Ye])+1]+1]+1)&&(wt=Jo,Dl++),Bn[2*nt+1]=wt,zn<nt||(Pe.bl_count[wt]++,cn=0,vc<=nt&&(cn=Sl[nt-vc]),Pe.opt_len+=(an=Bn[2*nt])*(wt+cn),lr&&(Pe.static_len+=an*(Hi[2*nt+1]+cn)));if(0!==Dl){do{for(wt=Jo-1;0===Pe.bl_count[wt];)wt--;Pe.bl_count[wt]--,Pe.bl_count[wt+1]+=2,Pe.bl_count[Jo]--,Dl-=2}while(0<Dl);for(wt=Jo;0!==wt;wt--)for(nt=Pe.bl_count[wt];0!==nt;)zn<(vt=Pe.heap[--Ye])||(Bn[2*vt+1]!==wt&&(Pe.opt_len+=(wt-Bn[2*vt+1])*Bn[2*vt],Bn[2*vt+1]=wt),nt--)}}(De,Me),_(ye,be,De.bl_count)}function de(De,Me,_e){var ce,pe,ye=-1,b=Me[1],K=0,ge=7,be=4;for(0===b&&(ge=138,be=3),Me[2*(_e+1)+1]=65535,ce=0;ce<=_e;ce++)pe=b,b=Me[2*(ce+1)+1],++K<ge&&pe===b||(K<be?De.bl_tree[2*pe]+=K:0!==pe?(pe!==ye&&De.bl_tree[2*pe]++,De.bl_tree[32]++):K<=10?De.bl_tree[34]++:De.bl_tree[36]++,ye=pe,be=(K=0)===b?(ge=138,3):pe===b?(ge=6,3):(ge=7,4))}function Fe(De,Me,_e){var ce,pe,ye=-1,b=Me[1],K=0,ge=7,be=4;for(0===b&&(ge=138,be=3),ce=0;ce<=_e;ce++)if(pe=b,b=Me[2*(ce+1)+1],!(++K<ge&&pe===b)){if(K<be)for(;d(De,pe,De.bl_tree),0!=--K;);else 0!==pe?(pe!==ye&&(d(De,pe,De.bl_tree),K--),d(De,16,De.bl_tree),h(De,K-3,2)):K<=10?(d(De,17,De.bl_tree),h(De,K-3,3)):(d(De,18,De.bl_tree),h(De,K-11,7));ye=pe,be=(K=0)===b?(ge=138,3):pe===b?(ge=6,3):(ge=7,4)}}D(B);var xe=!1;function ke(De,Me,_e,ce){var pe,ye,b;h(De,0+(ce?1:0),3),ye=Me,b=_e,$(pe=De),c(pe,b),c(pe,~b),S.arraySet(pe.pending_buf,pe.window,ye,b,pe.pending),pe.pending+=b}f._tr_init=function(De){xe||(function(){var Me,_e,ce,pe,ye,b=new Array(16);for(pe=ce=0;pe<28;pe++)for(L[pe]=ce,Me=0;Me<1<<k[pe];Me++)P[ce++]=pe;for(P[ce-1]=pe,pe=ye=0;pe<16;pe++)for(B[pe]=ye,Me=0;Me<1<<R[pe];Me++)C[ye++]=pe;for(ye>>=7;pe<N;pe++)for(B[pe]=ye<<7,Me=0;Me<1<<R[pe]-7;Me++)C[256+ye++]=pe;for(_e=0;_e<=q;_e++)b[_e]=0;for(Me=0;Me<=143;)A[2*Me+1]=8,Me++,b[8]++;for(;Me<=255;)A[2*Me+1]=9,Me++,b[9]++;for(;Me<=279;)A[2*Me+1]=7,Me++,b[7]++;for(;Me<=287;)A[2*Me+1]=8,Me++,b[8]++;for(_(A,287,b),Me=0;Me<N;Me++)M[2*Me+1]=5,M[2*Me]=p(Me,5);ne=new O(A,k,257,U,q),F=new O(M,R,0,N,q),he=new O(new Array(0),ee,0,19,7)}(),xe=!0),De.l_desc=new m(De.dyn_ltree,ne),De.d_desc=new m(De.dyn_dtree,F),De.bl_desc=new m(De.bl_tree,he),De.bi_buf=0,De.bi_valid=0,x(De)},f._tr_stored_block=ke,f._tr_flush_block=function(De,Me,_e,ce){var pe,ye,b=0;0<De.level?(2===De.strm.data_type&&(De.strm.data_type=function(K){var ge,be=4093624447;for(ge=0;ge<=31;ge++,be>>>=1)if(1&be&&0!==K.dyn_ltree[2*ge])return 0;if(0!==K.dyn_ltree[18]||0!==K.dyn_ltree[20]||0!==K.dyn_ltree[26])return 1;for(ge=32;ge<Q;ge++)if(0!==K.dyn_ltree[2*ge])return 1;return 0}(De)),Ae(De,De.l_desc),Ae(De,De.d_desc),b=function(K){var ge;for(de(K,K.dyn_ltree,K.l_desc.max_code),de(K,K.dyn_dtree,K.d_desc.max_code),Ae(K,K.bl_desc),ge=18;3<=ge&&0===K.bl_tree[2*H[ge]+1];ge--);return K.opt_len+=3*(ge+1)+5+5+4,ge}(De),(ye=De.static_len+3+7>>>3)<=(pe=De.opt_len+3+7>>>3)&&(pe=ye)):pe=ye=_e+5,_e+4<=pe&&-1!==Me?ke(De,Me,_e,ce):4===De.strategy||ye===pe?(h(De,2+(ce?1:0),3),Te(De,A,M)):(h(De,4+(ce?1:0),3),function(K,ge,be,Pe){var Ue;for(h(K,ge-257,5),h(K,be-1,5),h(K,Pe-4,4),Ue=0;Ue<Pe;Ue++)h(K,K.bl_tree[2*H[Ue]+1],3);Fe(K,K.dyn_ltree,ge-1),Fe(K,K.dyn_dtree,be-1)}(De,De.l_desc.max_code+1,De.d_desc.max_code+1,b+1),Te(De,De.dyn_ltree,De.dyn_dtree)),x(De),ce&&$(De)},f._tr_tally=function(De,Me,_e){return De.pending_buf[De.d_buf+2*De.last_lit]=Me>>>8&255,De.pending_buf[De.d_buf+2*De.last_lit+1]=255&Me,De.pending_buf[De.l_buf+De.last_lit]=255&_e,De.last_lit++,0===Me?De.dyn_ltree[2*_e]++:(De.matches++,Me--,De.dyn_ltree[2*(P[_e]+Q+1)]++,De.dyn_dtree[2*l(Me)]++),De.last_lit===De.lit_bufsize-1},f._tr_align=function(De){var Me;h(De,2,3),d(De,256,A),16===(Me=De).bi_valid?(c(Me,Me.bi_buf),Me.bi_buf=0,Me.bi_valid=0):8<=Me.bi_valid&&(Me.pending_buf[Me.pending++]=255&Me.bi_buf,Me.bi_buf>>=8,Me.bi_valid-=8)}},{"../utils/common":41}],53:[function(fe,Ce,f){"use strict";Ce.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(fe,Ce,f){"use strict";Ce.exports="function"==typeof setImmediate?setImmediate:function(){var S=[].slice.apply(arguments);S.splice(1,0,0),setTimeout.apply(null,S)}},{}]},{},[10])(10)},7489:function(T,fe,Ce){var f;T=Ce.nmd(T),function(){var S,z="Expected a function",Q="__lodash_hash_undefined__",N="__lodash_placeholder__",R=32,H=128,O=1/0,m=9007199254740991,c=NaN,h=4294967295,_=[["ary",H],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",R],["partialRight",64],["rearg",256]],x="[object Arguments]",$="[object Array]",ae="[object Boolean]",Te="[object Date]",de="[object Error]",Fe="[object Function]",xe="[object GeneratorFunction]",ke="[object Map]",De="[object Number]",_e="[object Object]",ce="[object Promise]",ye="[object RegExp]",b="[object Set]",K="[object String]",ge="[object Symbol]",Pe="[object WeakMap]",Ye="[object ArrayBuffer]",nt="[object DataView]",vt="[object Float32Array]",wt="[object Float64Array]",cn="[object Int8Array]",an="[object Int16Array]",Bn="[object Int32Array]",zn="[object Uint8Array]",Hi="[object Uint8ClampedArray]",lr="[object Uint16Array]",Sl="[object Uint32Array]",vc=/\b__p \+= '';/g,Jo=/\b(__p \+=) '' \+/g,Dl=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Cd=/&(?:amp|lt|gt|quot|#39);/g,eu=/[&<>"']/g,xd=RegExp(Cd.source),tu=RegExp(eu.source),Mo=/<%-([\s\S]+?)%>/g,Bp=/<%([\s\S]+?)%>/g,jf=/<%=([\s\S]+?)%>/g,Gf=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Lp=/^\w*$/,qf=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,wd=/[\\^$.*+?()[\]{}|]/g,nu=RegExp(wd.source),es=/^\s+/,zp=/\s/,bc=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,iu=/\{\n\/\* \[wrapped with (.+)\] \*/,Ed=/,? & /,Hp=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Vp=/[()=,{}\[\]\/\s]/,Td=/\\(\\)?/g,ru=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Il=/\w*$/,kl=/^[-+]0x[0-9a-f]+$/i,Sd=/^0b[01]+$/i,ha=/^\[object .+?Constructor\]$/,Ml=/^0o[0-7]+$/i,yc=/^(?:0|[1-9]\d*)$/,ou=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Al=/($^)/,Up=/['\n\r\u2028\u2029\\]/g,Cc="\\ud800-\\udfff",$o="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Po="\\u2700-\\u27bf",Pl="a-z\\xdf-\\xf6\\xf8-\\xff",Za="A-Z\\xc0-\\xd6\\xd8-\\xde",Ro="\\ufe0e\\ufe0f",oi="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",lu="["+Cc+"]",Dd="["+oi+"]",jt="["+$o+"]",Ya="\\d+",_n="["+Po+"]",Dr="["+Pl+"]",Id="[^"+Cc+oi+Ya+Po+Pl+Za+"]",cu="\\ud83c[\\udffb-\\udfff]",xc="[^"+Cc+"]",Vr="(?:\\ud83c[\\udde6-\\uddff]){2}",ze="[\\ud800-\\udbff][\\udc00-\\udfff]",qe="["+Za+"]",ht="(?:"+Dr+"|"+Id+")",kt="(?:"+qe+"|"+Id+")",Gt="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",Vn="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",pr="(?:"+jt+"|"+cu+")?",gr="["+Ro+"]?",No=gr+pr+"(?:\\u200d(?:"+[xc,Vr,ze].join("|")+")"+gr+pr+")*",qi="(?:"+[_n,Vr,ze].join("|")+")"+No,Xw="(?:"+[xc+jt+"?",jt,Vr,ze,lu].join("|")+")",Qw=RegExp("['\u2019]","g"),Jw=RegExp(jt,"g"),Tn=RegExp(cu+"(?="+cu+")|"+Xw+No,"g"),eE=RegExp([qe+"?"+Dr+"+"+Gt+"(?="+[Dd,qe,"$"].join("|")+")",kt+"+"+Vn+"(?="+[Dd,qe+ht,"$"].join("|")+")",qe+"?"+ht+"+"+Gt,qe+"+"+Vn,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ya,qi].join("|"),"g"),ts=RegExp("[\\u200d"+Cc+$o+Ro+"]"),Gp=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Qm=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],yb=-1,Wi={};Wi[vt]=Wi[wt]=Wi[cn]=Wi[an]=Wi[Bn]=Wi[zn]=Wi[Hi]=Wi[lr]=Wi[Sl]=!0,Wi[x]=Wi[$]=Wi[Ye]=Wi[ae]=Wi[nt]=Wi[Te]=Wi[de]=Wi[Fe]=Wi[ke]=Wi[De]=Wi[_e]=Wi[ye]=Wi[b]=Wi[K]=Wi[Pe]=!1;var Ni={};Ni[x]=Ni[$]=Ni[Ye]=Ni[nt]=Ni[ae]=Ni[Te]=Ni[vt]=Ni[wt]=Ni[cn]=Ni[an]=Ni[Bn]=Ni[ke]=Ni[De]=Ni[_e]=Ni[ye]=Ni[b]=Ni[K]=Ni[ge]=Ni[zn]=Ni[Hi]=Ni[lr]=Ni[Sl]=!0,Ni[de]=Ni[Fe]=Ni[Pe]=!1;var Cb={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Rn=parseFloat,Wp=parseInt,e0="object"==typeof global&&global&&global.Object===Object&&global,Fl="object"==typeof self&&self&&self.Object===Object&&self,Ir=e0||Fl||Function("return this")(),xb=fe&&!fe.nodeType&&fe,Cs=xb&&T&&!T.nodeType&&T,xs=Cs&&Cs.exports===xb,t0=xs&&e0.process,js=function(){try{return Cs&&Cs.require&&Cs.require("util").types||t0&&t0.binding&&t0.binding("util")}catch(mt){}}(),ws=js&&js.isArrayBuffer,n0=js&&js.isDate,r0=js&&js.isMap,o0=js&&js.isRegExp,wb=js&&js.isSet,wi=js&&js.isTypedArray;function Es(at,mt,gt){switch(gt.length){case 0:return at.call(mt);case 1:return at.call(mt,gt[0]);case 2:return at.call(mt,gt[0],gt[1]);case 3:return at.call(mt,gt[0],gt[1],gt[2])}return at.apply(mt,gt)}function tE(at,mt,gt,Kt){for(var Pn=-1,_i=null==at?0:at.length;++Pn<_i;){var Mr=at[Pn];mt(Kt,Mr,gt(Mr),at)}return Kt}function Ur(at,mt){for(var gt=-1,Kt=null==at?0:at.length;++gt<Kt&&!1!==mt(at[gt],gt,at););return at}function Oi(at,mt){for(var gt=null==at?0:at.length;gt--&&!1!==mt(at[gt],gt,at););return at}function kd(at,mt){for(var gt=-1,Kt=null==at?0:at.length;++gt<Kt;)if(!mt(at[gt],gt,at))return!1;return!0}function pa(at,mt){for(var gt=-1,Kt=null==at?0:at.length,Pn=0,_i=[];++gt<Kt;){var Mr=at[gt];mt(Mr,gt,at)&&(_i[Pn++]=Mr)}return _i}function uu(at,mt){return!(null==at||!at.length)&&wc(at,mt,0)>-1}function Zf(at,mt,gt){for(var Kt=-1,Pn=null==at?0:at.length;++Kt<Pn;)if(gt(mt,at[Kt]))return!0;return!1}function di(at,mt){for(var gt=-1,Kt=null==at?0:at.length,Pn=Array(Kt);++gt<Kt;)Pn[gt]=mt(at[gt],gt,at);return Pn}function Ts(at,mt){for(var gt=-1,Kt=mt.length,Pn=at.length;++gt<Kt;)at[Pn+gt]=mt[gt];return at}function Zp(at,mt,gt,Kt){var Pn=-1,_i=null==at?0:at.length;for(Kt&&_i&&(gt=at[++Pn]);++Pn<_i;)gt=mt(gt,at[Pn],Pn,at);return gt}function Qt(at,mt,gt,Kt){var Pn=null==at?0:at.length;for(Kt&&Pn&&(gt=at[--Pn]);Pn--;)gt=mt(gt,at[Pn],Pn,at);return gt}function Yp(at,mt){for(var gt=-1,Kt=null==at?0:at.length;++gt<Kt;)if(mt(at[gt],gt,at))return!0;return!1}var s0=ga("length");function ns(at,mt,gt){var Kt;return gt(at,function(Pn,_i,Mr){if(mt(Pn,_i,Mr))return Kt=_i,!1}),Kt}function Yf(at,mt,gt,Kt){for(var Pn=at.length,_i=gt+(Kt?1:-1);Kt?_i--:++_i<Pn;)if(mt(at[_i],_i,at))return _i;return-1}function wc(at,mt,gt){return mt==mt?function Oo(at,mt,gt){for(var Kt=gt-1,Pn=at.length;++Kt<Pn;)if(at[Kt]===mt)return Kt;return-1}(at,mt,gt):Yf(at,jr,gt)}function nn(at,mt,gt,Kt){for(var Pn=gt-1,_i=at.length;++Pn<_i;)if(Kt(at[Pn],mt))return Pn;return-1}function jr(at){return at!=at}function Gr(at,mt){var gt=null==at?0:at.length;return gt?Md(at,mt)/gt:c}function ga(at){return function(mt){return null==mt?S:mt[at]}}function Ka(at){return function(mt){return null==at?S:at[mt]}}function is(at,mt,gt,Kt,Pn){return Pn(at,function(_i,Mr,Ui){gt=Kt?(Kt=!1,_i):mt(gt,_i,Mr,Ui)}),gt}function Md(at,mt){for(var gt,Kt=-1,Pn=at.length;++Kt<Pn;){var _i=mt(at[Kt]);_i!==S&&(gt=gt===S?_i:gt+_i)}return gt}function Ec(at,mt){for(var gt=-1,Kt=Array(at);++gt<at;)Kt[gt]=mt(gt);return Kt}function Rl(at){return at&&at.slice(0,Bi(at)+1).replace(es,"")}function Ai(at){return function(mt){return at(mt)}}function Kp(at,mt){return di(mt,function(gt){return at[gt]})}function oo(at,mt){return at.has(mt)}function Vt(at,mt){for(var gt=-1,Kt=at.length;++gt<Kt&&wc(mt,at[gt],0)>-1;);return gt}function Un(at,mt){for(var gt=at.length;gt--&&wc(mt,at[gt],0)>-1;);return gt}function Ki(at,mt){for(var gt=at.length,Kt=0;gt--;)at[gt]===mt&&++Kt;return Kt}var rs=Ka({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),Tc=Ka({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function kr(at){return"\\"+Cb[at]}function Vi(at){return ts.test(at)}function Nn(at){var mt=-1,gt=Array(at.size);return at.forEach(function(Kt,Pn){gt[++mt]=[Pn,Kt]}),gt}function Pd(at,mt){return function(gt){return at(mt(gt))}}function os(at,mt){for(var gt=-1,Kt=at.length,Pn=0,_i=[];++gt<Kt;){var Mr=at[gt];(Mr===mt||Mr===N)&&(at[gt]=N,_i[Pn++]=gt)}return _i}function fu(at){var mt=-1,gt=Array(at.size);return at.forEach(function(Kt){gt[++mt]=Kt}),gt}function Gs(at){return Vi(at)?function Tb(at){for(var mt=Tn.lastIndex=0;Tn.test(at);)++mt;return mt}(at):s0(at)}function cr(at){return Vi(at)?function _a(at){return at.match(Tn)||[]}(at):function a0(at){return at.split("")}(at)}function Bi(at){for(var mt=at.length;mt--&&zp.test(at.charAt(mt)););return mt}var Eb=Ka({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Dc=function at(mt){var u,gt=(mt=null==mt?Ir:Dc.defaults(Ir.Object(),mt,Dc.pick(Ir,Qm))).Array,Kt=mt.Date,Pn=mt.Error,_i=mt.Function,Mr=mt.Math,Ui=mt.Object,c0=mt.RegExp,nE=mt.String,Ws=mt.TypeError,Qp=gt.prototype,Rd=Ui.prototype,Jp=mt["__core-js_shared__"],eg=_i.prototype.toString,Pi=Rd.hasOwnProperty,rE=0,Sb=(u=/[^.]+$/.exec(Jp&&Jp.keys&&Jp.keys.IE_PROTO||""))?"Symbol(src)_1."+u:"",tg=Rd.toString,u0=eg.call(Ui),ng=Ir._,oE=c0("^"+eg.call(Pi).replace(wd,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ig=xs?mt.Buffer:S,Ic=mt.Symbol,ma=mt.Uint8Array,d0=ig?ig.allocUnsafe:S,br=Pd(Ui.getPrototypeOf,Ui),rg=Ui.create,f0=Rd.propertyIsEnumerable,Qf=Qp.splice,og=Ic?Ic.isConcatSpreadable:S,pu=Ic?Ic.iterator:S,kc=Ic?Ic.toStringTag:S,gu=function(){try{var u=ql(Ui,"defineProperty");return u({},"",{}),u}catch(y){}}(),Db=mt.clearTimeout!==Ir.clearTimeout&&mt.clearTimeout,Ss=Kt&&Kt.now!==Ir.Date.now&&Kt.now,sg=mt.setTimeout!==Ir.setTimeout&&mt.setTimeout,Jf=Mr.ceil,_u=Mr.floor,ag=Ui.getOwnPropertySymbols,Ib=ig?ig.isBuffer:S,eh=mt.isFinite,kb=Qp.join,lg=Pd(Ui.keys,Ui),Ar=Mr.max,Yn=Mr.min,h0=Kt.now,Mb=mt.parseInt,ur=Mr.random,Ab=Qp.reverse,p0=ql(mt,"DataView"),Nl=ql(mt,"Map"),Bo=ql(mt,"Promise"),mu=ql(mt,"Set"),Mc=ql(mt,"WeakMap"),$a=ql(Ui,"create"),so=Mc&&new Mc,Ac={},cg=Wl(p0),Pb=Wl(Nl),Ol=Wl(Bo),g0=Wl(mu),ug=Wl(Mc),wn=Ic?Ic.prototype:S,th=wn?wn.valueOf:S,_0=wn?wn.toString:S;function He(u){if(nr(u)&&!On(u)&&!(u instanceof Xn)){if(u instanceof Ds)return u;if(Pi.call(u,"__wrapped__"))return Pu(u)}return new Ds(u)}var $u=function(){function u(){}return function(y){if(!j(y))return{};if(rg)return rg(y);u.prototype=y;var ue=new u;return u.prototype=S,ue}}();function Nd(){}function Ds(u,y){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!y,this.__index__=0,this.__values__=S}function Xn(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=h,this.__views__=[]}function Zi(u){var y=-1,ue=null==u?0:u.length;for(this.clear();++y<ue;){var Ie=u[y];this.set(Ie[0],Ie[1])}}function Bl(u){var y=-1,ue=null==u?0:u.length;for(this.clear();++y<ue;){var Ie=u[y];this.set(Ie[0],Ie[1])}}function ba(u){var y=-1,ue=null==u?0:u.length;for(this.clear();++y<ue;){var Ie=u[y];this.set(Ie[0],Ie[1])}}function Pc(u){var y=-1,ue=null==u?0:u.length;for(this.__data__=new ba;++y<ue;)this.add(u[y])}function Is(u){var y=this.__data__=new Bl(u);this.size=y.size}function _g(u,y){var ue=On(u),Ie=!ue&&Yl(u),Ne=!ue&&!Ie&&Kl(u),Ge=!ue&&!Ie&&!Ne&&sl(u),Ke=ue||Ie||Ne||Ge,rt=Ke?Ec(u.length,nE):[],ct=rt.length;for(var yt in u)(y||Pi.call(u,yt))&&(!Ke||!("length"==yt||Ne&&("offset"==yt||"parent"==yt)||Ge&&("buffer"==yt||"byteLength"==yt||"byteOffset"==yt)||Qs(yt,ct)))&&rt.push(yt);return rt}function mg(u){var y=u.length;return y?u[Nc(0,y-1)]:S}function y0(u,y){return zg(Ho(u),Fc(y,0,u.length))}function oh(u){return zg(Ho(u))}function $g(u,y,ue){(ue!==S&&!ls(u[y],ue)||ue===S&&!(y in u))&&Ja(u,y,ue)}function Bd(u,y,ue){var Ie=u[y];(!Pi.call(u,y)||!ls(Ie,ue)||ue===S&&!(y in u))&&Ja(u,y,ue)}function Pr(u,y){for(var ue=u.length;ue--;)if(ls(u[ue][0],y))return ue;return-1}function Ll(u,y,ue,Ie){return ya(u,function(Ne,Ge,Ke){y(Ie,Ne,ue(Ne),Ke)}),Ie}function tr(u,y){return u&&Ea(y,yr(y),u)}function Ja(u,y,ue){"__proto__"==y&&gu?gu(u,y,{configurable:!0,enumerable:!0,value:ue,writable:!0}):u[y]=ue}function vg(u,y){for(var ue=-1,Ie=y.length,Ne=gt(Ie),Ge=null==u;++ue<Ie;)Ne[ue]=Ge?S:Hh(u,y[ue]);return Ne}function Fc(u,y,ue){return u==u&&(ue!==S&&(u=u<=ue?u:ue),y!==S&&(u=u>=y?u:y)),u}function ks(u,y,ue,Ie,Ne,Ge){var Ke,rt=1&y,ct=2&y,yt=4&y;if(ue&&(Ke=Ne?ue(u,Ie,Ne,Ge):ue(u)),Ke!==S)return Ke;if(!j(u))return u;var Ct=On(u);if(Ct){if(Ke=function Au(u){var y=u.length,ue=new u.constructor(y);return y&&"string"==typeof u[0]&&Pi.call(u,"index")&&(ue.index=u.index,ue.input=u.input),ue}(u),!rt)return Ho(u,Ke)}else{var Dt=lo(u),zt=Dt==Fe||Dt==xe;if(Kl(u))return R0(u,rt);if(Dt==_e||Dt==x||zt&&!Ne){if(Ke=ct||zt?{}:q0(u),!rt)return ct?function Zb(u,y){return Ea(u,G0(u),y)}(u,function bu(u,y){return u&&Ea(y,jo(y),u)}(Ke,u)):function Wb(u,y){return Ea(u,j0(u),y)}(u,tr(Ke,u))}else{if(!Ni[Dt])return Ne?u:{};Ke=function ey(u,y,ue){var Ie=u.constructor;switch(y){case Ye:return Pg(u);case ae:case Te:return new Ie(+u);case nt:return function lE(u,y){var ue=y?Pg(u.buffer):u.buffer;return new u.constructor(ue,u.byteOffset,u.byteLength)}(u,ue);case vt:case wt:case cn:case an:case Bn:case zn:case Hi:case lr:case Sl:return zo(u,ue);case ke:return new Ie;case De:case K:return new Ie(u);case ye:return function cE(u){var y=new u.constructor(u.source,Il.exec(u));return y.lastIndex=u.lastIndex,y}(u);case b:return new Ie;case ge:return function N0(u){return th?Ui(th.call(u)):{}}(u)}}(u,Dt,rt)}}Ge||(Ge=new Is);var on=Ge.get(u);if(on)return on;Ge.set(u,Ke),p_(u)?u.forEach(function(bn){Ke.add(ks(bn,y,ue,bn,u,Ge))}):f_(u)&&u.forEach(function(bn,Kn){Ke.set(Kn,ks(bn,y,ue,Kn,u,Ge))});var jn=Ct?S:(yt?ct?wh:Mu:ct?jo:yr)(u);return Ur(jn||u,function(bn,Kn){jn&&(bn=u[Kn=bn]),Bd(Ke,Kn,ks(bn,y,ue,Kn,u,Ge))}),Ke}function Ld(u,y,ue){var Ie=ue.length;if(null==u)return!Ie;for(u=Ui(u);Ie--;){var Ne=ue[Ie],Ke=u[Ne];if(Ke===S&&!(Ne in u)||!(0,y[Ne])(Ke))return!1}return!0}function zd(u,y,ue){if("function"!=typeof u)throw new Ws(z);return Kd(function(){u.apply(S,ue)},y)}function zl(u,y,ue,Ie){var Ne=-1,Ge=uu,Ke=!0,rt=u.length,ct=[],yt=y.length;if(!rt)return ct;ue&&(y=di(y,Ai(ue))),Ie?(Ge=Zf,Ke=!1):y.length>=200&&(Ge=oo,Ke=!1,y=new Pc(y));e:for(;++Ne<rt;){var Ct=u[Ne],Dt=null==ue?Ct:ue(Ct);if(Ct=Ie||0!==Ct?Ct:0,Ke&&Dt==Dt){for(var zt=yt;zt--;)if(y[zt]===Dt)continue e;ct.push(Ct)}else Ge(y,Dt,Ie)||ct.push(Ct)}return ct}He.templateSettings={escape:Mo,evaluate:Bp,interpolate:jf,variable:"",imports:{_:He}},(He.prototype=Nd.prototype).constructor=He,(Ds.prototype=$u(Nd.prototype)).constructor=Ds,(Xn.prototype=$u(Nd.prototype)).constructor=Xn,Zi.prototype.clear=function m0(){this.__data__=$a?$a(null):{},this.size=0},Zi.prototype.delete=function Od(u){var y=this.has(u)&&delete this.__data__[u];return this.size-=y?1:0,y},Zi.prototype.get=function va(u){var y=this.__data__;if($a){var ue=y[u];return ue===Q?S:ue}return Pi.call(y,u)?y[u]:S},Zi.prototype.has=function dg(u){var y=this.__data__;return $a?y[u]!==S:Pi.call(y,u)},Zi.prototype.set=function fg(u,y){var ue=this.__data__;return this.size+=this.has(u)?0:1,ue[u]=$a&&y===S?Q:y,this},Bl.prototype.clear=function Fb(){this.__data__=[],this.size=0},Bl.prototype.delete=function nh(u){var y=this.__data__,ue=Pr(y,u);return!(ue<0||(ue==y.length-1?y.pop():Qf.call(y,ue,1),--this.size,0))},Bl.prototype.get=function ih(u){var y=this.__data__,ue=Pr(y,u);return ue<0?S:y[ue][1]},Bl.prototype.has=function vo(u){return Pr(this.__data__,u)>-1},Bl.prototype.set=function Xa(u,y){var ue=this.__data__,Ie=Pr(ue,u);return Ie<0?(++this.size,ue.push([u,y])):ue[Ie][1]=y,this},ba.prototype.clear=function vu(){this.size=0,this.__data__={hash:new Zi,map:new(Nl||Bl),string:new Zi}},ba.prototype.delete=function Qa(u){var y=Th(this,u).delete(u);return this.size-=y?1:0,y},ba.prototype.get=function Rb(u){return Th(this,u).get(u)},ba.prototype.has=function $0(u){return Th(this,u).has(u)},ba.prototype.set=function Nb(u,y){var ue=Th(this,u),Ie=ue.size;return ue.set(u,y),this.size+=ue.size==Ie?0:1,this},Pc.prototype.add=Pc.prototype.push=function hg(u){return this.__data__.set(u,Q),this},Pc.prototype.has=function pg(u){return this.__data__.has(u)},Is.prototype.clear=function gg(){this.__data__=new Bl,this.size=0},Is.prototype.delete=function Ob(u){var y=this.__data__,ue=y.delete(u);return this.size=y.size,ue},Is.prototype.get=function v0(u){return this.__data__.get(u)},Is.prototype.has=function rh(u){return this.__data__.has(u)},Is.prototype.set=function b0(u,y){var ue=this.__data__;if(ue instanceof Bl){var Ie=ue.__data__;if(!Nl||Ie.length<199)return Ie.push([u,y]),this.size=++ue.size,this;ue=this.__data__=new ba(Ie)}return ue.set(u,y),this.size=ue.size,this};var ya=$h(Ca),bg=$h(yg,!0);function Lb(u,y){var ue=!0;return ya(u,function(Ie,Ne,Ge){return ue=!!y(Ie,Ne,Ge)}),ue}function Zs(u,y,ue){for(var Ie=-1,Ne=u.length;++Ie<Ne;){var Ge=u[Ie],Ke=y(Ge);if(null!=Ke&&(rt===S?Ke==Ke&&!fo(Ke):ue(Ke,rt)))var rt=Ke,ct=Ge}return ct}function C0(u,y){var ue=[];return ya(u,function(Ie,Ne,Ge){y(Ie,Ne,Ge)&&ue.push(Ie)}),ue}function qr(u,y,ue,Ie,Ne){var Ge=-1,Ke=u.length;for(ue||(ue=Ih),Ne||(Ne=[]);++Ge<Ke;){var rt=u[Ge];y>0&&ue(rt)?y>1?qr(rt,y-1,ue,Ie,Ne):Ts(Ne,rt):Ie||(Ne[Ne.length]=rt)}return Ne}var Rc=Gd(),sh=Gd(!0);function Ca(u,y){return u&&Rc(u,y,yr)}function yg(u,y){return u&&sh(u,y,yr)}function Cg(u,y){return pa(y,function(ue){return rl(u[ue])})}function yu(u,y){for(var ue=0,Ie=(y=el(y,u)).length;null!=u&&ue<Ie;)u=u[Vo(y[ue++])];return ue&&ue==Ie?u:S}function Vd(u,y,ue){var Ie=y(u);return On(u)?Ie:Ts(Ie,ue(u))}function ao(u){return null==u?u===S?"[object Undefined]":"[object Null]":kc&&kc in Ui(u)?function Qb(u){var y=Pi.call(u,kc),ue=u[kc];try{u[kc]=S;var Ie=!0}catch(Ge){}var Ne=tg.call(u);return Ie&&(y?u[kc]=ue:delete u[kc]),Ne}(u):function iy(u){return tg.call(u)}(u)}function Ud(u,y){return u>y}function ah(u,y){return null!=u&&Pi.call(u,y)}function x0(u,y){return null!=u&&y in Ui(u)}function Hl(u,y,ue){for(var Ie=ue?Zf:uu,Ne=u[0].length,Ge=u.length,Ke=Ge,rt=gt(Ge),ct=1/0,yt=[];Ke--;){var Ct=u[Ke];Ke&&y&&(Ct=di(Ct,Ai(y))),ct=Yn(Ct.length,ct),rt[Ke]=!ue&&(y||Ne>=120&&Ct.length>=120)?new Pc(Ke&&Ct):S}Ct=u[0];var Dt=-1,zt=rt[0];e:for(;++Dt<Ne&&yt.length<ct;){var on=Ct[Dt],vn=y?y(on):on;if(on=ue||0!==on?on:0,!(zt?oo(zt,vn):Ie(yt,vn,ue))){for(Ke=Ge;--Ke;){var jn=rt[Ke];if(!(jn?oo(jn,vn):Ie(u[Ke],vn,ue)))continue e}zt&&zt.push(vn),yt.push(on)}}return yt}function xa(u,y,ue){var Ie=null==(u=Q0(u,y=el(y,u)))?u:u[Vo(hn(y))];return null==Ie?S:Es(Ie,u,ue)}function lh(u){return nr(u)&&ao(u)==x}function Cu(u,y,ue,Ie,Ne){return u===y||(null==u||null==y||!nr(u)&&!nr(y)?u!=u&&y!=y:function E0(u,y,ue,Ie,Ne,Ge){var Ke=On(u),rt=On(y),ct=Ke?$:lo(u),yt=rt?$:lo(y),Ct=(ct=ct==x?_e:ct)==_e,Dt=(yt=yt==x?_e:yt)==_e,zt=ct==yt;if(zt&&Kl(u)){if(!Kl(y))return!1;Ke=!0,Ct=!1}if(zt&&!Ct)return Ge||(Ge=new Is),Ke||sl(u)?Zd(u,y,ue,Ie,Ne,Ge):function Xb(u,y,ue,Ie,Ne,Ge,Ke){switch(ue){case nt:if(u.byteLength!=y.byteLength||u.byteOffset!=y.byteOffset)return!1;u=u.buffer,y=y.buffer;case Ye:return!(u.byteLength!=y.byteLength||!Ge(new ma(u),new ma(y)));case ae:case Te:case De:return ls(+u,+y);case de:return u.name==y.name&&u.message==y.message;case ye:case K:return u==y+"";case ke:var rt=Nn;case b:if(rt||(rt=fu),u.size!=y.size&&!(1&Ie))return!1;var yt=Ke.get(u);if(yt)return yt==y;Ie|=2,Ke.set(u,y);var Ct=Zd(rt(u),rt(y),Ie,Ne,Ge,Ke);return Ke.delete(u),Ct;case ge:if(th)return th.call(u)==th.call(y)}return!1}(u,y,ct,ue,Ie,Ne,Ge);if(!(1&ue)){var on=Ct&&Pi.call(u,"__wrapped__"),vn=Dt&&Pi.call(y,"__wrapped__");if(on||vn){var jn=on?u.value():u,bn=vn?y.value():y;return Ge||(Ge=new Is),Ne(jn,bn,ue,Ie,Ge)}}return!!zt&&(Ge||(Ge=new Is),function V0(u,y,ue,Ie,Ne,Ge){var Ke=1&ue,rt=Mu(u),ct=rt.length;if(ct!=Mu(y).length&&!Ke)return!1;for(var Dt=ct;Dt--;){var zt=rt[Dt];if(!(Ke?zt in y:Pi.call(y,zt)))return!1}var on=Ge.get(u),vn=Ge.get(y);if(on&&vn)return on==y&&vn==u;var jn=!0;Ge.set(u,y),Ge.set(y,u);for(var bn=Ke;++Dt<ct;){var Kn=u[zt=rt[Dt]],ti=y[zt];if(Ie)var Rs=Ke?Ie(ti,Kn,zt,y,u,Ge):Ie(Kn,ti,zt,u,y,Ge);if(!(Rs===S?Kn===ti||Ne(Kn,ti,ue,Ie,Ge):Rs)){jn=!1;break}bn||(bn="constructor"==zt)}if(jn&&!bn){var Go=u.constructor,yo=y.constructor;Go!=yo&&"constructor"in u&&"constructor"in y&&!("function"==typeof Go&&Go instanceof Go&&"function"==typeof yo&&yo instanceof yo)&&(jn=!1)}return Ge.delete(u),Ge.delete(y),jn}(u,y,ue,Ie,Ne,Ge))}(u,y,ue,Ie,Cu,Ne))}function xg(u,y,ue,Ie){var Ne=ue.length,Ge=Ne,Ke=!Ie;if(null==u)return!Ge;for(u=Ui(u);Ne--;){var rt=ue[Ne];if(Ke&&rt[2]?rt[1]!==u[rt[0]]:!(rt[0]in u))return!1}for(;++Ne<Ge;){var ct=(rt=ue[Ne])[0],yt=u[ct],Ct=rt[1];if(Ke&&rt[2]){if(yt===S&&!(ct in u))return!1}else{var Dt=new Is;if(Ie)var zt=Ie(yt,Ct,ct,u,y,Dt);if(!(zt===S?Cu(Ct,yt,3,Ie,Dt):zt))return!1}}return!0}function xu(u){return!(!j(u)||function ty(u){return!!Sb&&Sb in u}(u))&&(rl(u)?oE:ha).test(Wl(u))}function jd(u){return"function"==typeof u?u:null==u?Wr:"object"==typeof u?On(u)?S0(u[0],u[1]):Dg(u):N_(u)}function Tg(u){if(!Yd(u))return lg(u);var y=[];for(var ue in Ui(u))Pi.call(u,ue)&&"constructor"!=ue&&y.push(ue);return y}function dh(u,y){return u<y}function Sg(u,y){var ue=-1,Ie=Uo(u)?gt(u.length):[];return ya(u,function(Ne,Ge,Ke){Ie[++ue]=y(Ne,Ge,Ke)}),Ie}function Dg(u){var y=U0(u);return 1==y.length&&y[0][2]?Y0(y[0][0],y[0][1]):function(ue){return ue===u||xg(ue,u,y)}}function S0(u,y){return kh(u)&&Z0(y)?Y0(Vo(u),y):function(ue){var Ie=Hh(ue,u);return Ie===S&&Ie===y?Vh(ue,u):Cu(y,Ie,3)}}function fh(u,y,ue,Ie,Ne){u!==y&&Rc(y,function(Ge,Ke){if(Ne||(Ne=new Is),j(Ge))!function hh(u,y,ue,Ie,Ne,Ge,Ke){var rt=Og(u,ue),ct=Og(y,ue),yt=Ke.get(ct);if(yt)$g(u,ue,yt);else{var Ct=Ge?Ge(rt,ct,ue+"",u,y,Ke):S,Dt=Ct===S;if(Dt){var zt=On(ct),on=!zt&&Kl(ct),vn=!zt&&!on&&sl(ct);Ct=ct,zt||on||vn?On(rt)?Ct=rt:dr(rt)?Ct=Ho(rt):on?(Dt=!1,Ct=R0(ct,!0)):vn?(Dt=!1,Ct=zo(ct,!0)):Ct=[]:Nu(ct)||Yl(ct)?(Ct=rt,Yl(rt)?Ct=L$(rt):(!j(rt)||rl(rt))&&(Ct=q0(ct))):Dt=!1}Dt&&(Ke.set(ct,Ct),Ne(Ct,ct,Ie,Ge,Ke),Ke.delete(ct)),$g(u,ue,Ct)}}(u,y,Ke,ue,fh,Ie,Ne);else{var rt=Ie?Ie(Og(u,Ke),Ge,Ke+"",u,y,Ne):S;rt===S&&(rt=Ge),$g(u,Ke,rt)}},jo)}function wu(u,y){var ue=u.length;if(ue)return Qs(y+=y<0?ue:0,ue)?u[y]:S}function D0(u,y,ue){y=y.length?di(y,function(Ge){return On(Ge)?function(Ke){return yu(Ke,1===Ge.length?Ge[0]:Ge)}:Ge}):[Wr];var Ie=-1;return y=di(y,Ai(fn())),function Kf(at,mt){var gt=at.length;for(at.sort(mt);gt--;)at[gt]=at[gt].value;return at}(Sg(u,function(Ge,Ke,rt){return{criteria:di(y,function(yt){return yt(Ge)}),index:++Ie,value:Ge}}),function(Ge,Ke){return function Iu(u,y,ue){for(var Ie=-1,Ne=u.criteria,Ge=y.criteria,Ke=Ne.length,rt=ue.length;++Ie<Ke;){var ct=_h(Ne[Ie],Ge[Ie]);if(ct)return Ie>=rt?ct:ct*("desc"==ue[Ie]?-1:1)}return u.index-y.index}(Ge,Ke,ue)})}function Ig(u,y,ue){for(var Ie=-1,Ne=y.length,Ge={};++Ie<Ne;){var Ke=y[Ie],rt=yu(u,Ke);ue(rt,Ke)&&wa(Ge,el(Ke,u),rt)}return Ge}function Fr(u,y,ue,Ie){var Ne=Ie?nn:wc,Ge=-1,Ke=y.length,rt=u;for(u===y&&(y=Ho(y)),ue&&(rt=di(u,Ai(ue)));++Ge<Ke;)for(var ct=0,yt=y[Ge],Ct=ue?ue(yt):yt;(ct=Ne(rt,Ct,ct,Ie))>-1;)rt!==u&&Qf.call(rt,ct,1),Qf.call(u,ct,1);return u}function ph(u,y){for(var ue=u?y.length:0,Ie=ue-1;ue--;){var Ne=y[ue];if(ue==Ie||Ne!==Ge){var Ge=Ne;Qs(Ne)?Qf.call(u,Ne,1):A0(u,Ne)}}return u}function Nc(u,y){return u+_u(ur()*(y-u+1))}function Vl(u,y){var ue="";if(!u||y<1||y>m)return ue;do{y%2&&(ue+=u),(y=_u(y/2))&&(u+=u)}while(y);return ue}function Fn(u,y){return Lg(X0(u,y,Wr),u+"")}function k0(u){return mg(ll(u))}function kg(u,y){var ue=ll(u);return zg(ue,Fc(y,0,ue.length))}function wa(u,y,ue,Ie){if(!j(u))return u;for(var Ne=-1,Ge=(y=el(y,u)).length,Ke=Ge-1,rt=u;null!=rt&&++Ne<Ge;){var ct=Vo(y[Ne]),yt=ue;if("__proto__"===ct||"constructor"===ct||"prototype"===ct)return u;if(Ne!=Ke){var Ct=rt[ct];(yt=Ie?Ie(Ct,ct,rt):S)===S&&(yt=j(Ct)?Ct:Qs(y[Ne+1])?[]:{})}Bd(rt,ct,yt),rt=rt[ct]}return u}var Vb=so?function(u,y){return so.set(u,y),u}:Wr,Ub=gu?function(u,y){return gu(u,"toString",{configurable:!0,enumerable:!1,value:M_(y),writable:!0})}:Wr;function ei(u){return zg(ll(u))}function Ys(u,y,ue){var Ie=-1,Ne=u.length;y<0&&(y=-y>Ne?0:Ne+y),(ue=ue>Ne?Ne:ue)<0&&(ue+=Ne),Ne=y>ue?0:ue-y>>>0,y>>>=0;for(var Ge=gt(Ne);++Ie<Ne;)Ge[Ie]=u[Ie+y];return Ge}function aE(u,y){var ue;return ya(u,function(Ie,Ne,Ge){return!(ue=y(Ie,Ne,Ge))}),!!ue}function Mg(u,y,ue){var Ie=0,Ne=null==u?Ie:u.length;if("number"==typeof y&&y==y&&Ne<=2147483647){for(;Ie<Ne;){var Ge=Ie+Ne>>>1,Ke=u[Ge];null!==Ke&&!fo(Ke)&&(ue?Ke<=y:Ke<y)?Ie=Ge+1:Ne=Ge}return Ne}return M0(u,y,Wr,ue)}function M0(u,y,ue,Ie){var Ne=0,Ge=null==u?0:u.length;if(0===Ge)return 0;for(var Ke=(y=ue(y))!=y,rt=null===y,ct=fo(y),yt=y===S;Ne<Ge;){var Ct=_u((Ne+Ge)/2),Dt=ue(u[Ct]),zt=Dt!==S,on=null===Dt,vn=Dt==Dt,jn=fo(Dt);if(Ke)var bn=Ie||vn;else bn=yt?vn&&(Ie||zt):rt?vn&&zt&&(Ie||!on):ct?vn&&zt&&!on&&(Ie||!jn):!on&&!jn&&(Ie?Dt<=y:Dt<y);bn?Ne=Ct+1:Ge=Ct}return Yn(Ge,4294967294)}function jb(u,y){for(var ue=-1,Ie=u.length,Ne=0,Ge=[];++ue<Ie;){var Ke=u[ue],rt=y?y(Ke):Ke;if(!ue||!ls(rt,ct)){var ct=rt;Ge[Ne++]=0===Ke?0:Ke}}return Ge}function Gb(u){return"number"==typeof u?u:fo(u)?c:+u}function Ms(u){if("string"==typeof u)return u;if(On(u))return di(u,Ms)+"";if(fo(u))return _0?_0.call(u):"";var y=u+"";return"0"==y&&1/u==-O?"-0":y}function As(u,y,ue){var Ie=-1,Ne=uu,Ge=u.length,Ke=!0,rt=[],ct=rt;if(ue)Ke=!1,Ne=Zf;else if(Ge>=200){var yt=y?null:Kb(u);if(yt)return fu(yt);Ke=!1,Ne=oo,ct=new Pc}else ct=y?[]:rt;e:for(;++Ie<Ge;){var Ct=u[Ie],Dt=y?y(Ct):Ct;if(Ct=ue||0!==Ct?Ct:0,Ke&&Dt==Dt){for(var zt=ct.length;zt--;)if(ct[zt]===Dt)continue e;y&&ct.push(Dt),rt.push(Ct)}else Ne(ct,Dt,ue)||(ct!==rt&&ct.push(Dt),rt.push(Ct))}return rt}function A0(u,y){return null==(u=Q0(u,y=el(y,u)))||delete u[Vo(hn(y))]}function _r(u,y,ue,Ie){return wa(u,y,ue(yu(u,y)),Ie)}function Su(u,y,ue,Ie){for(var Ne=u.length,Ge=Ie?Ne:-1;(Ie?Ge--:++Ge<Ne)&&y(u[Ge],Ge,u););return ue?Ys(u,Ie?0:Ge,Ie?Ge+1:Ne):Ys(u,Ie?Ge+1:0,Ie?Ne:Ge)}function Du(u,y){var ue=u;return ue instanceof Xn&&(ue=ue.value()),Zp(y,function(Ie,Ne){return Ne.func.apply(Ne.thisArg,Ts([Ie],Ne.args))},ue)}function P0(u,y,ue){var Ie=u.length;if(Ie<2)return Ie?As(u[0]):[];for(var Ne=-1,Ge=gt(Ie);++Ne<Ie;)for(var Ke=u[Ne],rt=-1;++rt<Ie;)rt!=Ne&&(Ge[Ne]=zl(Ge[Ne]||Ke,u[rt],y,ue));return As(qr(Ge,1),y,ue)}function F0(u,y,ue){for(var Ie=-1,Ne=u.length,Ge=y.length,Ke={};++Ie<Ne;)ue(Ke,u[Ie],Ie<Ge?y[Ie]:S);return Ke}function Lo(u){return dr(u)?u:[]}function Ps(u){return"function"==typeof u?u:Wr}function el(u,y){return On(u)?u:kh(u,y)?[u]:t$(mi(u))}var gh=Fn;function Fs(u,y,ue){var Ie=u.length;return ue=ue===S?Ie:ue,!y&&ue>=Ie?u:Ys(u,y,ue)}var Ag=Db||function(u){return Ir.clearTimeout(u)};function R0(u,y){if(y)return u.slice();var ue=u.length,Ie=d0?d0(ue):new u.constructor(ue);return u.copy(Ie),Ie}function Pg(u){var y=new u.constructor(u.byteLength);return new ma(y).set(new ma(u)),y}function zo(u,y){var ue=y?Pg(u.buffer):u.buffer;return new u.constructor(ue,u.byteOffset,u.length)}function _h(u,y){if(u!==y){var ue=u!==S,Ie=null===u,Ne=u==u,Ge=fo(u),Ke=y!==S,rt=null===y,ct=y==y,yt=fo(y);if(!rt&&!yt&&!Ge&&u>y||Ge&&Ke&&ct&&!rt&&!yt||Ie&&Ke&&ct||!ue&&ct||!Ne)return 1;if(!Ie&&!Ge&&!yt&&u<y||yt&&ue&&Ne&&!Ie&&!Ge||rt&&ue&&Ne||!Ke&&Ne||!ct)return-1}return 0}function qb(u,y,ue,Ie){for(var Ne=-1,Ge=u.length,Ke=ue.length,rt=-1,ct=y.length,yt=Ar(Ge-Ke,0),Ct=gt(ct+yt),Dt=!Ie;++rt<ct;)Ct[rt]=y[rt];for(;++Ne<Ke;)(Dt||Ne<Ge)&&(Ct[ue[Ne]]=u[Ne]);for(;yt--;)Ct[rt++]=u[Ne++];return Ct}function Fg(u,y,ue,Ie){for(var Ne=-1,Ge=u.length,Ke=-1,rt=ue.length,ct=-1,yt=y.length,Ct=Ar(Ge-rt,0),Dt=gt(Ct+yt),zt=!Ie;++Ne<Ct;)Dt[Ne]=u[Ne];for(var on=Ne;++ct<yt;)Dt[on+ct]=y[ct];for(;++Ke<rt;)(zt||Ne<Ge)&&(Dt[on+ue[Ke]]=u[Ne++]);return Dt}function Ho(u,y){var ue=-1,Ie=u.length;for(y||(y=gt(Ie));++ue<Ie;)y[ue]=u[ue];return y}function Ea(u,y,ue,Ie){var Ne=!ue;ue||(ue={});for(var Ge=-1,Ke=y.length;++Ge<Ke;){var rt=y[Ge],ct=Ie?Ie(ue[rt],u[rt],rt,ue,u):S;ct===S&&(ct=u[rt]),Ne?Ja(ue,rt,ct):Bd(ue,rt,ct)}return ue}function mh(u,y){return function(ue,Ie){var Ne=On(ue)?tE:Ll,Ge=y?y():{};return Ne(ue,u,fn(Ie,2),Ge)}}function Oc(u){return Fn(function(y,ue){var Ie=-1,Ne=ue.length,Ge=Ne>1?ue[Ne-1]:S,Ke=Ne>2?ue[2]:S;for(Ge=u.length>3&&"function"==typeof Ge?(Ne--,Ge):S,Ke&&co(ue[0],ue[1],Ke)&&(Ge=Ne<3?S:Ge,Ne=1),y=Ui(y);++Ie<Ne;){var rt=ue[Ie];rt&&u(y,rt,Ie,Ge)}return y})}function $h(u,y){return function(ue,Ie){if(null==ue)return ue;if(!Uo(ue))return u(ue,Ie);for(var Ne=ue.length,Ge=y?Ne:-1,Ke=Ui(ue);(y?Ge--:++Ge<Ne)&&!1!==Ie(Ke[Ge],Ge,Ke););return ue}}function Gd(u){return function(y,ue,Ie){for(var Ne=-1,Ge=Ui(y),Ke=Ie(y),rt=Ke.length;rt--;){var ct=Ke[u?rt:++Ne];if(!1===ue(Ge[ct],ct,Ge))break}return y}}function ku(u){return function(y){var ue=Vi(y=mi(y))?cr(y):S,Ie=ue?ue[0]:y.charAt(0),Ne=ue?Fs(ue,1).join(""):y.slice(1);return Ie[u]()+Ne}}function Ul(u){return function(y){return Zp(i1(S_(y).replace(Qw,"")),u,"")}}function jl(u){return function(){var y=arguments;switch(y.length){case 0:return new u;case 1:return new u(y[0]);case 2:return new u(y[0],y[1]);case 3:return new u(y[0],y[1],y[2]);case 4:return new u(y[0],y[1],y[2],y[3]);case 5:return new u(y[0],y[1],y[2],y[3],y[4]);case 6:return new u(y[0],y[1],y[2],y[3],y[4],y[5]);case 7:return new u(y[0],y[1],y[2],y[3],y[4],y[5],y[6])}var ue=$u(u.prototype),Ie=u.apply(ue,y);return j(Ie)?Ie:ue}}function O0(u){return function(y,ue,Ie){var Ne=Ui(y);if(!Uo(y)){var Ge=fn(ue,3);y=yr(y),ue=function(rt){return Ge(Ne[rt],rt,Ne)}}var Ke=u(y,ue,Ie);return Ke>-1?Ne[Ge?y[Ke]:Ke]:S}}function B0(u){return Ks(function(y){var ue=y.length,Ie=ue,Ne=Ds.prototype.thru;for(u&&y.reverse();Ie--;){var Ge=y[Ie];if("function"!=typeof Ge)throw new Ws(z);if(Ne&&!Ke&&"wrapper"==Eh(Ge))var Ke=new Ds([],!0)}for(Ie=Ke?Ie:ue;++Ie<ue;){var rt=Eh(Ge=y[Ie]),ct="wrapper"==rt?Ng(Ge):S;Ke=ct&&nl(ct[0])&&424==ct[1]&&!ct[4].length&&1==ct[9]?Ke[Eh(ct[0])].apply(Ke,ct[3]):1==Ge.length&&nl(Ge)?Ke[rt]():Ke.thru(Ge)}return function(){var yt=arguments,Ct=yt[0];if(Ke&&1==yt.length&&On(Ct))return Ke.plant(Ct).value();for(var Dt=0,zt=ue?y[Dt].apply(this,yt):Ct;++Dt<ue;)zt=y[Dt].call(this,zt);return zt}})}function qd(u,y,ue,Ie,Ne,Ge,Ke,rt,ct,yt){var Ct=y&H,Dt=1&y,zt=2&y,on=24&y,vn=512&y,jn=zt?S:jl(u);return function bn(){for(var Kn=arguments.length,ti=gt(Kn),Rs=Kn;Rs--;)ti[Rs]=arguments[Rs];if(on)var Go=Xs(bn),yo=Ki(ti,Go);if(Ie&&(ti=qb(ti,Ie,Ne,on)),Ge&&(ti=Fg(ti,Ge,Ke,on)),Kn-=yo,on&&Kn<yt){var fr=os(ti,Go);return Ch(u,y,qd,bn.placeholder,ue,ti,fr,rt,ct,yt-Kn)}var Ns=Dt?ue:this,ka=zt?Ns[u]:u;return Kn=ti.length,rt?ti=ry(ti,rt):vn&&Kn>1&&ti.reverse(),Ct&&ct<Kn&&(ti.length=ct),this&&this!==Ir&&this instanceof bn&&(ka=jn||jl(ka)),ka.apply(Ns,ti)}}function L0(u,y){return function(ue,Ie){return function zb(u,y,ue,Ie){return Ca(u,function(Ne,Ge,Ke){y(Ie,ue(Ne),Ge,Ke)}),Ie}(ue,u,y(Ie),{})}}function Gl(u,y){return function(ue,Ie){var Ne;if(ue===S&&Ie===S)return y;if(ue!==S&&(Ne=ue),Ie!==S){if(Ne===S)return Ie;"string"==typeof ue||"string"==typeof Ie?(ue=Ms(ue),Ie=Ms(Ie)):(ue=Gb(ue),Ie=Gb(Ie)),Ne=u(ue,Ie)}return Ne}}function vh(u){return Ks(function(y){return y=di(y,Ai(fn())),Fn(function(ue){var Ie=this;return u(y,function(Ne){return Es(Ne,Ie,ue)})})})}function bh(u,y){var ue=(y=y===S?" ":Ms(y)).length;if(ue<2)return ue?Vl(y,u):y;var Ie=Vl(y,Jf(u/Gs(y)));return Vi(y)?Fs(cr(Ie),0,u).join(""):Ie.slice(0,u)}function Rg(u){return function(y,ue,Ie){return Ie&&"number"!=typeof Ie&&co(y,ue,Ie)&&(ue=Ie=S),y=al(y),ue===S?(ue=y,y=0):ue=al(ue),function Tu(u,y,ue,Ie){for(var Ne=-1,Ge=Ar(Jf((y-u)/(ue||1)),0),Ke=gt(Ge);Ge--;)Ke[Ie?Ge:++Ne]=u,u+=ue;return Ke}(y,ue,Ie=Ie===S?y<ue?1:-1:al(Ie),u)}}function yh(u){return function(y,ue){return"string"==typeof y&&"string"==typeof ue||(y=ta(y),ue=ta(ue)),u(y,ue)}}function Ch(u,y,ue,Ie,Ne,Ge,Ke,rt,ct,yt){var Ct=8&y;y|=Ct?R:64,4&(y&=~(Ct?64:R))||(y&=-4);var jn=[u,y,Ne,Ct?Ge:S,Ct?Ke:S,Ct?S:Ge,Ct?S:Ke,rt,ct,yt],bn=ue.apply(S,jn);return nl(u)&&Bg(bn,jn),bn.placeholder=Ie,J0(bn,u,y)}function Bc(u){var y=Mr[u];return function(ue,Ie){if(ue=ta(ue),(Ie=null==Ie?0:Yn(Hn(Ie),292))&&eh(ue)){var Ne=(mi(ue)+"e").split("e");return+((Ne=(mi(y(Ne[0]+"e"+(+Ne[1]+Ie)))+"e").split("e"))[0]+"e"+(+Ne[1]-Ie))}return y(ue)}}var Kb=mu&&1/fu(new mu([,-0]))[1]==O?function(u){return new mu(u)}:cf;function z0(u){return function(y){var ue=lo(y);return ue==ke?Nn(y):ue==b?function hu(at){var mt=-1,gt=Array(at.size);return at.forEach(function(Kt){gt[++mt]=[Kt,Kt]}),gt}(y):function Xf(at,mt){return di(mt,function(gt){return[gt,at[gt]]})}(y,u(y))}}function tl(u,y,ue,Ie,Ne,Ge,Ke,rt){var ct=2&y;if(!ct&&"function"!=typeof u)throw new Ws(z);var yt=Ie?Ie.length:0;if(yt||(y&=-97,Ie=Ne=S),Ke=Ke===S?Ke:Ar(Hn(Ke),0),rt=rt===S?rt:Hn(rt),yt-=Ne?Ne.length:0,64&y){var Ct=Ie,Dt=Ne;Ie=Ne=S}var zt=ct?S:Ng(u),on=[u,y,ue,Ie,Ne,Ct,Dt,Ge,Ke,rt];if(zt&&function Ta(u,y){var ue=u[1],Ie=y[1],Ne=ue|Ie;if(!(Ne<131||(Ie==H&&8==ue||Ie==H&&256==ue&&u[7].length<=y[8]||384==Ie&&y[7].length<=y[8]&&8==ue)))return u;1&Ie&&(u[2]=y[2],Ne|=1&ue?0:4);var rt=y[3];if(rt){var ct=u[3];u[3]=ct?qb(ct,rt,y[4]):rt,u[4]=ct?os(u[3],N):y[4]}(rt=y[5])&&(u[5]=(ct=u[5])?Fg(ct,rt,y[6]):rt,u[6]=ct?os(u[5],N):y[6]),(rt=y[7])&&(u[7]=rt),Ie&H&&(u[8]=null==u[8]?y[8]:Yn(u[8],y[8])),null==u[9]&&(u[9]=y[9]),u[0]=y[0],u[1]=Ne}(on,zt),u=on[0],y=on[1],ue=on[2],Ie=on[3],Ne=on[4],!(rt=on[9]=on[9]===S?ct?0:u.length:Ar(on[9]-yt,0))&&24&y&&(y&=-25),y&&1!=y)vn=8==y||16==y?function Yb(u,y,ue){var Ie=jl(u);return function Ne(){for(var Ge=arguments.length,Ke=gt(Ge),rt=Ge,ct=Xs(Ne);rt--;)Ke[rt]=arguments[rt];var yt=Ge<3&&Ke[0]!==ct&&Ke[Ge-1]!==ct?[]:os(Ke,ct);return(Ge-=yt.length)<ue?Ch(u,y,qd,Ne.placeholder,S,Ke,yt,S,S,ue-Ge):Es(this&&this!==Ir&&this instanceof Ne?Ie:u,this,Ke)}}(u,y,rt):y!=R&&33!=y||Ne.length?qd.apply(S,on):function In(u,y,ue,Ie){var Ne=1&y,Ge=jl(u);return function Ke(){for(var rt=-1,ct=arguments.length,yt=-1,Ct=Ie.length,Dt=gt(Ct+ct),zt=this&&this!==Ir&&this instanceof Ke?Ge:u;++yt<Ct;)Dt[yt]=Ie[yt];for(;ct--;)Dt[yt++]=arguments[++rt];return Es(zt,Ne?ue:this,Dt)}}(u,y,ue,Ie);else var vn=function uE(u,y,ue){var Ie=1&y,Ne=jl(u);return function Ge(){return(this&&this!==Ir&&this instanceof Ge?Ne:u).apply(Ie?ue:this,arguments)}}(u,y,ue);return J0((zt?Vb:Bg)(vn,on),u,y)}function xh(u,y,ue,Ie){return u===S||ls(u,Rd[ue])&&!Pi.call(Ie,ue)?y:u}function Wd(u,y,ue,Ie,Ne,Ge){return j(u)&&j(y)&&(Ge.set(y,u),fh(u,y,S,Wd,Ge),Ge.delete(y)),u}function H0(u){return Nu(u)?S:u}function Zd(u,y,ue,Ie,Ne,Ge){var Ke=1&ue,rt=u.length,ct=y.length;if(rt!=ct&&!(Ke&&ct>rt))return!1;var yt=Ge.get(u),Ct=Ge.get(y);if(yt&&Ct)return yt==y&&Ct==u;var Dt=-1,zt=!0,on=2&ue?new Pc:S;for(Ge.set(u,y),Ge.set(y,u);++Dt<rt;){var vn=u[Dt],jn=y[Dt];if(Ie)var bn=Ke?Ie(jn,vn,Dt,y,u,Ge):Ie(vn,jn,Dt,u,y,Ge);if(bn!==S){if(bn)continue;zt=!1;break}if(on){if(!Yp(y,function(Kn,ti){if(!oo(on,ti)&&(vn===Kn||Ne(vn,Kn,ue,Ie,Ge)))return on.push(ti)})){zt=!1;break}}else if(vn!==jn&&!Ne(vn,jn,ue,Ie,Ge)){zt=!1;break}}return Ge.delete(u),Ge.delete(y),zt}function Ks(u){return Lg(X0(u,S,s$),u+"")}function Mu(u){return Vd(u,yr,j0)}function wh(u){return Vd(u,jo,G0)}var Ng=so?function(u){return so.get(u)}:cf;function Eh(u){for(var y=u.name+"",ue=Ac[y],Ie=Pi.call(Ac,y)?ue.length:0;Ie--;){var Ne=ue[Ie],Ge=Ne.func;if(null==Ge||Ge==u)return Ne.name}return y}function Xs(u){return(Pi.call(He,"placeholder")?He:u).placeholder}function fn(){var u=He.iteratee||lf;return u=u===lf?jd:u,arguments.length?u(arguments[0],arguments[1]):u}function Th(u,y){var ue=u.__data__;return function W0(u){var y=typeof u;return"string"==y||"number"==y||"symbol"==y||"boolean"==y?"__proto__"!==u:null===u}(y)?ue["string"==typeof y?"string":"hash"]:ue.map}function U0(u){for(var y=yr(u),ue=y.length;ue--;){var Ie=y[ue],Ne=u[Ie];y[ue]=[Ie,Ne,Z0(Ne)]}return y}function ql(u,y){var ue=function Sc(at,mt){return null==at?S:at[mt]}(u,y);return xu(ue)?ue:S}var j0=ag?function(u){return null==u?[]:(u=Ui(u),pa(ag(u),function(y){return f0.call(u,y)}))}:Hu,G0=ag?function(u){for(var y=[];u;)Ts(y,j0(u)),u=br(u);return y}:Hu,lo=ao;function Dh(u,y,ue){for(var Ie=-1,Ne=(y=el(y,u)).length,Ge=!1;++Ie<Ne;){var Ke=Vo(y[Ie]);if(!(Ge=null!=u&&ue(u,Ke)))break;u=u[Ke]}return Ge||++Ie!=Ne?Ge:!!(Ne=null==u?0:u.length)&&kn(Ne)&&Qs(Ke,Ne)&&(On(u)||Yl(u))}function q0(u){return"function"!=typeof u.constructor||Yd(u)?{}:$u(br(u))}function Ih(u){return On(u)||Yl(u)||!!(og&&u&&u[og])}function Qs(u,y){var ue=typeof u;return!!(y=null==y?m:y)&&("number"==ue||"symbol"!=ue&&yc.test(u))&&u>-1&&u%1==0&&u<y}function co(u,y,ue){if(!j(ue))return!1;var Ie=typeof y;return!!("number"==Ie?Uo(ue)&&Qs(y,ue.length):"string"==Ie&&y in ue)&&ls(ue[y],u)}function kh(u,y){if(On(u))return!1;var ue=typeof u;return!("number"!=ue&&"symbol"!=ue&&"boolean"!=ue&&null!=u&&!fo(u))||Lp.test(u)||!Gf.test(u)||null!=y&&u in Ui(y)}function nl(u){var y=Eh(u),ue=He[y];if("function"!=typeof ue||!(y in Xn.prototype))return!1;if(u===ue)return!0;var Ie=Ng(ue);return!!Ie&&u===Ie[0]}(p0&&lo(new p0(new ArrayBuffer(1)))!=nt||Nl&&lo(new Nl)!=ke||Bo&&lo(Bo.resolve())!=ce||mu&&lo(new mu)!=b||Mc&&lo(new Mc)!=Pe)&&(lo=function(u){var y=ao(u),ue=y==_e?u.constructor:S,Ie=ue?Wl(ue):"";if(Ie)switch(Ie){case cg:return nt;case Pb:return ke;case Ol:return ce;case g0:return b;case ug:return Pe}return y});var ny=Jp?rl:O_;function Yd(u){var y=u&&u.constructor;return u===("function"==typeof y&&y.prototype||Rd)}function Z0(u){return u==u&&!j(u)}function Y0(u,y){return function(ue){return null!=ue&&ue[u]===y&&(y!==S||u in Ui(ue))}}function X0(u,y,ue){return y=Ar(y===S?u.length-1:y,0),function(){for(var Ie=arguments,Ne=-1,Ge=Ar(Ie.length-y,0),Ke=gt(Ge);++Ne<Ge;)Ke[Ne]=Ie[y+Ne];Ne=-1;for(var rt=gt(y+1);++Ne<y;)rt[Ne]=Ie[Ne];return rt[y]=ue(Ke),Es(u,this,rt)}}function Q0(u,y){return y.length<2?u:yu(u,Ys(y,0,-1))}function ry(u,y){for(var ue=u.length,Ie=Yn(y.length,ue),Ne=Ho(u);Ie--;){var Ge=y[Ie];u[Ie]=Qs(Ge,ue)?Ne[Ge]:S}return u}function Og(u,y){if(("constructor"!==y||"function"!=typeof u[y])&&"__proto__"!=y)return u[y]}var Bg=e$(Vb),Kd=sg||function(u,y){return Ir.setTimeout(u,y)},Lg=e$(Ub);function J0(u,y,ue){var Ie=y+"";return Lg(u,function dE(u,y){var ue=y.length;if(!ue)return u;var Ie=ue-1;return y[Ie]=(ue>1?"& ":"")+y[Ie],y=y.join(ue>2?", ":" "),u.replace(bc,"{\n/* [wrapped with "+y+"] */\n")}(Ie,function Sa(u,y){return Ur(_,function(ue){var Ie="_."+ue[0];y&ue[1]&&!uu(u,Ie)&&u.push(Ie)}),u.sort()}(function Sh(u){var y=u.match(iu);return y?y[1].split(Ed):[]}(Ie),ue)))}function e$(u){var y=0,ue=0;return function(){var Ie=h0(),Ne=16-(Ie-ue);if(ue=Ie,Ne>0){if(++y>=800)return arguments[0]}else y=0;return u.apply(S,arguments)}}function zg(u,y){var ue=-1,Ie=u.length,Ne=Ie-1;for(y=y===S?Ie:y;++ue<y;){var Ge=Nc(ue,Ne),Ke=u[Ge];u[Ge]=u[ue],u[ue]=Ke}return u.length=y,u}var t$=function ss(u){var y=Rh(u,function(Ie){return 500===ue.size&&ue.clear(),Ie}),ue=y.cache;return y}(function(u){var y=[];return 46===u.charCodeAt(0)&&y.push(""),u.replace(qf,function(ue,Ie,Ne,Ge){y.push(Ne?Ge.replace(Td,"$1"):Ie||ue)}),y});function Vo(u){if("string"==typeof u||fo(u))return u;var y=u+"";return"0"==y&&1/u==-O?"-0":y}function Wl(u){if(null!=u){try{return eg.call(u)}catch(y){}try{return u+""}catch(y){}}return""}function Pu(u){if(u instanceof Xn)return u.clone();var y=new Ds(u.__wrapped__,u.__chain__);return y.__actions__=Ho(u.__actions__),y.__index__=u.__index__,y.__values__=u.__values__,y}var fE=Fn(function(u,y){return dr(u)?zl(u,qr(y,1,dr,!0)):[]}),hE=Fn(function(u,y){var ue=hn(y);return dr(ue)&&(ue=S),dr(u)?zl(u,qr(y,1,dr,!0),fn(ue,2)):[]}),pE=Fn(function(u,y){var ue=hn(y);return dr(ue)&&(ue=S),dr(u)?zl(u,qr(y,1,dr,!0),S,ue):[]});function jg(u,y,ue){var Ie=null==u?0:u.length;if(!Ie)return-1;var Ne=null==ue?0:Hn(ue);return Ne<0&&(Ne=Ar(Ie+Ne,0)),Yf(u,fn(y,3),Ne)}function o$(u,y,ue){var Ie=null==u?0:u.length;if(!Ie)return-1;var Ne=Ie-1;return ue!==S&&(Ne=Hn(ue),Ne=ue<0?Ar(Ie+Ne,0):Yn(Ne,Ie-1)),Yf(u,fn(y,3),Ne,!0)}function s$(u){return null!=u&&u.length?qr(u,1):[]}function Xd(u){return u&&u.length?u[0]:S}var ay=Fn(function(u){var y=di(u,Lo);return y.length&&y[0]===u[0]?Hl(y):[]}),ji=Fn(function(u){var y=hn(u),ue=di(u,Lo);return y===hn(ue)?y=S:ue.pop(),ue.length&&ue[0]===u[0]?Hl(ue,fn(y,2)):[]}),Lc=Fn(function(u){var y=hn(u),ue=di(u,Lo);return(y="function"==typeof y?y:S)&&ue.pop(),ue.length&&ue[0]===u[0]?Hl(ue,S,y):[]});function hn(u){var y=null==u?0:u.length;return y?u[y-1]:S}var uy=Fn(u$);function u$(u,y){return u&&u.length&&y&&y.length?Fr(u,y):u}var mE=Ks(function(u,y){var ue=null==u?0:u.length,Ie=vg(u,y);return ph(u,di(y,function(Ne){return Qs(Ne,ue)?+Ne:Ne}).sort(_h)),Ie});function zc(u){return null==u?u:Ab.call(u)}var my=Fn(function(u){return As(qr(u,1,dr,!0))}),$y=Fn(function(u){var y=hn(u);return dr(y)&&(y=S),As(qr(u,1,dr,!0),fn(y,2))}),Zg=Fn(function(u){var y=hn(u);return y="function"==typeof y?y:S,As(qr(u,1,dr,!0),S,y)});function Kg(u){if(!u||!u.length)return[];var y=0;return u=pa(u,function(ue){if(dr(ue))return y=Ar(ue.length,y),!0}),Ec(y,function(ue){return di(u,ga(ue))})}function _$(u,y){if(!u||!u.length)return[];var ue=Kg(u);return null==y?ue:di(ue,function(Ie){return Es(y,S,Ie)})}var Jd=Fn(function(u,y){return dr(u)?zl(u,y):[]}),yy=Fn(function(u){return P0(pa(u,dr))}),Cy=Fn(function(u){var y=hn(u);return dr(y)&&(y=S),P0(pa(u,dr),fn(y,2))}),xy=Fn(function(u){var y=hn(u);return y="function"==typeof y?y:S,P0(pa(u,dr),S,y)}),wy=Fn(Kg),Ty=Fn(function(u){var y=u.length,ue=y>1?u[y-1]:S;return ue="function"==typeof ue?(u.pop(),ue):S,_$(u,ue)});function $$(u){var y=He(u);return y.__chain__=!0,y}function Mh(u,y){return y(u)}var Dy=Ks(function(u){var y=u.length,ue=y?u[0]:0,Ie=this.__wrapped__,Ne=function(Ge){return vg(Ge,u)};return!(y>1||this.__actions__.length)&&Ie instanceof Xn&&Qs(ue)?((Ie=Ie.slice(ue,+ue+(y?1:0))).__actions__.push({func:Mh,args:[Ne],thisArg:S}),new Ds(Ie,this.__chain__).thru(function(Ge){return y&&!Ge.length&&Ge.push(S),Ge})):this.thru(Ne)}),v$=mh(function(u,y,ue){Pi.call(u,ue)?++u[ue]:Ja(u,ue,1)}),Xg=O0(jg),Qg=O0(o$);function Jg(u,y){return(On(u)?Ur:ya)(u,fn(y,3))}function e_(u,y){return(On(u)?Oi:bg)(u,fn(y,3))}var t_=mh(function(u,y,ue){Pi.call(u,ue)?u[ue].push(y):Ja(u,ue,[y])}),y$=Fn(function(u,y,ue){var Ie=-1,Ne="function"==typeof y,Ge=Uo(u)?gt(u.length):[];return ya(u,function(Ke){Ge[++Ie]=Ne?Es(y,Ke,ue):xa(Ke,y,ue)}),Ge}),CE=mh(function(u,y,ue){Ja(u,ue,y)});function il(u,y){return(On(u)?di:Sg)(u,fn(y,3))}var C$=mh(function(u,y,ue){u[ue?0:1].push(y)},function(){return[[],[]]}),x$=Fn(function(u,y){if(null==u)return[];var ue=y.length;return ue>1&&co(u,y[0],y[1])?y=[]:ue>2&&co(y[0],y[1],y[2])&&(y=[y[0]]),D0(u,qr(y,1),[])}),Ru=Ss||function(){return Ir.Date.now()};function Ph(u,y,ue){return y=ue?S:y,tl(u,H,S,S,S,S,y=u&&null==y?u.length:y)}function E$(u,y){var ue;if("function"!=typeof y)throw new Ws(z);return u=Hn(u),function(){return--u>0&&(ue=y.apply(this,arguments)),u<=1&&(y=S),ue}}var o_=Fn(function(u,y,ue){var Ie=1;if(ue.length){var Ne=os(ue,Xs(o_));Ie|=R}return tl(u,Ie,y,ue,Ne)}),s_=Fn(function(u,y,ue){var Ie=3;if(ue.length){var Ne=os(ue,Xs(s_));Ie|=R}return tl(y,Ie,u,ue,Ne)});function l_(u,y,ue){var Ie,Ne,Ge,Ke,rt,ct,yt=0,Ct=!1,Dt=!1,zt=!0;if("function"!=typeof u)throw new Ws(z);function on(fr){var Ns=Ie,ka=Ne;return Ie=Ne=S,yt=fr,Ke=u.apply(ka,Ns)}function vn(fr){return yt=fr,rt=Kd(Kn,y),Ct?on(fr):Ke}function bn(fr){var Ns=fr-ct;return ct===S||Ns>=y||Ns<0||Dt&&fr-yt>=Ge}function Kn(){var fr=Ru();if(bn(fr))return ti(fr);rt=Kd(Kn,function jn(fr){var DC=y-(fr-ct);return Dt?Yn(DC,Ge-(fr-yt)):DC}(fr))}function ti(fr){return rt=S,zt&&Ie?on(fr):(Ie=Ne=S,Ke)}function yo(){var fr=Ru(),Ns=bn(fr);if(Ie=arguments,Ne=this,ct=fr,Ns){if(rt===S)return vn(ct);if(Dt)return Ag(rt),rt=Kd(Kn,y),on(ct)}return rt===S&&(rt=Kd(Kn,y)),Ke}return y=ta(y)||0,j(ue)&&(Ct=!!ue.leading,Ge=(Dt="maxWait"in ue)?Ar(ta(ue.maxWait)||0,y):Ge,zt="trailing"in ue?!!ue.trailing:zt),yo.cancel=function Rs(){rt!==S&&Ag(rt),yt=0,Ie=ct=Ne=rt=S},yo.flush=function Go(){return rt===S?Ke:ti(Ru())},yo}var T$=Fn(function(u,y){return zd(u,1,y)}),Ly=Fn(function(u,y,ue){return zd(u,ta(y)||0,ue)});function Rh(u,y){if("function"!=typeof u||null!=y&&"function"!=typeof y)throw new Ws(z);var ue=function(){var Ie=arguments,Ne=y?y.apply(this,Ie):Ie[0],Ge=ue.cache;if(Ge.has(Ne))return Ge.get(Ne);var Ke=u.apply(this,Ie);return ue.cache=Ge.set(Ne,Ke)||Ge,Ke};return ue.cache=new(Rh.Cache||ba),ue}function tf(u){if("function"!=typeof u)throw new Ws(z);return function(){var y=arguments;switch(y.length){case 0:return!u.call(this);case 1:return!u.call(this,y[0]);case 2:return!u.call(this,y[0],y[1]);case 3:return!u.call(this,y[0],y[1],y[2])}return!u.apply(this,y)}}Rh.Cache=ba;var D$=gh(function(u,y){var ue=(y=1==y.length&&On(y[0])?di(y[0],Ai(fn())):di(qr(y,1),Ai(fn()))).length;return Fn(function(Ie){for(var Ne=-1,Ge=Yn(Ie.length,ue);++Ne<Ge;)Ie[Ne]=y[Ne].call(this,Ie[Ne]);return Es(u,this,Ie)})}),nf=Fn(function(u,y){var ue=os(y,Xs(nf));return tl(u,R,S,y,ue)}),c_=Fn(function(u,y){var ue=os(y,Xs(c_));return tl(u,64,S,y,ue)}),Nh=Ks(function(u,y){return tl(u,256,S,S,S,y)});function ls(u,y){return u===y||u!=u&&y!=y}var P$=yh(Ud),xE=yh(function(u,y){return u>=y}),Yl=lh(function(){return arguments}())?lh:function(u){return nr(u)&&Pi.call(u,"callee")&&!f0.call(u,"callee")},On=gt.isArray,F$=ws?Ai(ws):function ch(u){return nr(u)&&ao(u)==Ye};function Uo(u){return null!=u&&kn(u.length)&&!rl(u)}function dr(u){return nr(u)&&Uo(u)}var Kl=Ib||O_,R$=n0?Ai(n0):function sE(u){return nr(u)&&ao(u)==Te};function Bh(u){if(!nr(u))return!1;var y=ao(u);return y==de||"[object DOMException]"==y||"string"==typeof u.message&&"string"==typeof u.name&&!Nu(u)}function rl(u){if(!j(u))return!1;var y=ao(u);return y==Fe||y==xe||"[object AsyncFunction]"==y||"[object Proxy]"==y}function N$(u){return"number"==typeof u&&u==Hn(u)}function kn(u){return"number"==typeof u&&u>-1&&u%1==0&&u<=m}function j(u){var y=typeof u;return null!=u&&("object"==y||"function"==y)}function nr(u){return null!=u&&"object"==typeof u}var f_=r0?Ai(r0):function Hb(u){return nr(u)&&lo(u)==ke};function zh(u){return"number"==typeof u||nr(u)&&ao(u)==De}function Nu(u){if(!nr(u)||ao(u)!=_e)return!1;var y=br(u);if(null===y)return!0;var ue=Pi.call(y,"constructor")&&y.constructor;return"function"==typeof ue&&ue instanceof ue&&eg.call(ue)==u0}var of=o0?Ai(o0):function wg(u){return nr(u)&&ao(u)==ye},p_=wb?Ai(wb):function Eg(u){return nr(u)&&lo(u)==b};function g_(u){return"string"==typeof u||!On(u)&&nr(u)&&ao(u)==K}function fo(u){return"symbol"==typeof u||nr(u)&&ao(u)==ge}var sl=wi?Ai(wi):function uh(u){return nr(u)&&kn(u.length)&&!!Wi[ao(u)]},EE=yh(dh),Yy=yh(function(u,y){return u<=y});function B$(u){if(!u)return[];if(Uo(u))return g_(u)?cr(u):Ho(u);if(pu&&u[pu])return function du(at){for(var mt,gt=[];!(mt=at.next()).done;)gt.push(mt.value);return gt}(u[pu]());var y=lo(u);return(y==ke?Nn:y==b?fu:ll)(u)}function al(u){return u?(u=ta(u))===O||u===-O?17976931348623157e292*(u<0?-1:1):u==u?u:0:0===u?u:0}function Hn(u){var y=al(u),ue=y%1;return y==y?ue?y-ue:y:0}function v_(u){return u?Fc(Hn(u),0,h):0}function ta(u){if("number"==typeof u)return u;if(fo(u))return c;if(j(u)){var y="function"==typeof u.valueOf?u.valueOf():u;u=j(y)?y+"":y}if("string"!=typeof u)return 0===u?u:+u;u=Rl(u);var ue=Sd.test(u);return ue||Ml.test(u)?Wp(u.slice(2),ue?2:8):kl.test(u)?c:+u}function L$(u){return Ea(u,jo(u))}function mi(u){return null==u?"":Ms(u)}var z$=Oc(function(u,y){if(Yd(y)||Uo(y))Ea(y,yr(y),u);else for(var ue in y)Pi.call(y,ue)&&Bd(u,ue,y[ue])}),H$=Oc(function(u,y){Ea(y,jo(y),u)}),Ou=Oc(function(u,y,ue,Ie){Ea(y,jo(y),u,Ie)}),SE=Oc(function(u,y,ue,Ie){Ea(y,yr(y),u,Ie)}),DE=Ks(vg),kE=Fn(function(u,y){u=Ui(u);var ue=-1,Ie=y.length,Ne=Ie>2?y[2]:S;for(Ne&&co(y[0],y[1],Ne)&&(Ie=1);++ue<Ie;)for(var Ge=y[ue],Ke=jo(Ge),rt=-1,ct=Ke.length;++rt<ct;){var yt=Ke[rt],Ct=u[yt];(Ct===S||ls(Ct,Rd[yt])&&!Pi.call(u,yt))&&(u[yt]=Ge[yt])}return u}),ME=Fn(function(u){return u.push(S,Wd),Es(U$,S,u)});function Hh(u,y,ue){var Ie=null==u?S:yu(u,y);return Ie===S?ue:Ie}function Vh(u,y){return null!=u&&Dh(u,y,x0)}var C_=L0(function(u,y,ue){null!=y&&"function"!=typeof y.toString&&(y=tg.call(y)),u[y]=ue},M_(Wr)),Xy=L0(function(u,y,ue){null!=y&&"function"!=typeof y.toString&&(y=tg.call(y)),Pi.call(u,y)?u[y].push(ue):u[y]=[ue]},fn),Ql=Fn(xa);function yr(u){return Uo(u)?_g(u):Tg(u)}function jo(u){return Uo(u)?_g(u,!0):function T0(u){if(!j(u))return function K0(u){var y=[];if(null!=u)for(var ue in Ui(u))y.push(ue);return y}(u);var y=Yd(u),ue=[];for(var Ie in u)"constructor"==Ie&&(y||!Pi.call(u,Ie))||ue.push(Ie);return ue}(u)}var V$=Oc(function(u,y,ue){fh(u,y,ue)}),U$=Oc(function(u,y,ue,Ie){fh(u,y,ue,Ie)}),Jy=Ks(function(u,y){var ue={};if(null==u)return ue;var Ie=!1;y=di(y,function(Ge){return Ge=el(Ge,u),Ie||(Ie=Ge.length>1),Ge}),Ea(u,wh(u),ue),Ie&&(ue=ks(ue,7,H0));for(var Ne=y.length;Ne--;)A0(ue,y[Ne]);return ue}),Bu=Ks(function(u,y){return null==u?{}:function I0(u,y){return Ig(u,y,function(ue,Ie){return Vh(u,Ie)})}(u,y)});function Uh(u,y){if(null==u)return{};var ue=di(wh(u),function(Ie){return[Ie]});return y=fn(y),Ig(u,ue,function(Ie,Ne){return y(Ie,Ne[0])})}var j$=z0(yr),w_=z0(jo);function ll(u){return null==u?[]:Kp(u,yr(u))}var Y$=Ul(function(u,y,ue){return y=y.toLowerCase(),u+(ue?K$(y):y)});function K$(u){return k_(mi(u).toLowerCase())}function S_(u){return(u=mi(u))&&u.replace(ou,rs).replace(Jw,"")}var iC=Ul(function(u,y,ue){return u+(ue?"-":"")+y.toLowerCase()}),rC=Ul(function(u,y,ue){return u+(ue?" ":"")+y.toLowerCase()}),BE=ku("toLowerCase"),sC=Ul(function(u,y,ue){return u+(ue?"_":"")+y.toLowerCase()}),lC=Ul(function(u,y,ue){return u+(ue?" ":"")+k_(y)}),I_=Ul(function(u,y,ue){return u+(ue?" ":"")+y.toUpperCase()}),k_=ku("toUpperCase");function i1(u,y,ue){return u=mi(u),(y=ue?S:y)===S?function Ad(at){return Gp.test(at)}(u)?function qs(at){return at.match(eE)||[]}(u):function l0(at){return at.match(Hp)||[]}(u):u.match(y)||[]}var hC=Fn(function(u,y){try{return Es(u,S,y)}catch(ue){return Bh(ue)?ue:new Pn(ue)}}),r1=Ks(function(u,y){return Ur(y,function(ue){ue=Vo(ue),Ja(u,ue,o_(u[ue],u))}),u});function M_(u){return function(){return u}}var _C=B0(),mC=B0(!0);function Wr(u){return u}function lf(u){return jd("function"==typeof u?u:ks(u,1))}var F_=Fn(function(u,y){return function(ue){return xa(ue,u,y)}}),o1=Fn(function(u,y){return function(ue){return xa(u,ue,y)}});function R_(u,y,ue){var Ie=yr(y),Ne=Cg(y,Ie);null==ue&&(!j(y)||!Ne.length&&Ie.length)&&(ue=y,y=u,u=this,Ne=Cg(y,yr(y)));var Ge=!(j(ue)&&"chain"in ue&&!ue.chain),Ke=rl(u);return Ur(Ne,function(rt){var ct=y[rt];u[rt]=ct,Ke&&(u.prototype[rt]=function(){var yt=this.__chain__;if(Ge||yt){var Ct=u(this.__wrapped__),Dt=Ct.__actions__=Ho(this.__actions__);return Dt.push({func:ct,args:arguments,thisArg:u}),Ct.__chain__=yt,Ct}return ct.apply(u,Ts([this.value()],arguments))})}),u}function cf(){}var bC=vh(di),s1=vh(kd),a1=vh(Yp);function N_(u){return kh(u)?ga(Vo(u)):function Eu(u){return function(y){return yu(y,u)}}(u)}var c1=Rg(),cl=Rg(!0);function Hu(){return[]}function O_(){return!1}var CC=Gl(function(u,y){return u+y},0),z_=Bc("ceil"),d1=Gl(function(u,y){return u/y},1),f1=Bc("floor"),Vu=Gl(function(u,y){return u*y},1),g1=Bc("round"),TC=Gl(function(u,y){return u-y},0);return He.after=function w$(u,y){if("function"!=typeof y)throw new Ws(z);return u=Hn(u),function(){if(--u<1)return y.apply(this,arguments)}},He.ary=Ph,He.assign=z$,He.assignIn=H$,He.assignInWith=Ou,He.assignWith=SE,He.at=DE,He.before=E$,He.bind=o_,He.bindAll=r1,He.bindKey=s_,He.castArray=function rf(){if(!arguments.length)return[];var u=arguments[0];return On(u)?u:[u]},He.chain=$$,He.chunk=function n$(u,y,ue){y=(ue?co(u,y,ue):y===S)?1:Ar(Hn(y),0);var Ie=null==u?0:u.length;if(!Ie||y<1)return[];for(var Ne=0,Ge=0,Ke=gt(Jf(Ie/y));Ne<Ie;)Ke[Ge++]=Ys(u,Ne,Ne+=y);return Ke},He.compact=function i$(u){for(var y=-1,ue=null==u?0:u.length,Ie=0,Ne=[];++y<ue;){var Ge=u[y];Ge&&(Ne[Ie++]=Ge)}return Ne},He.concat=function r$(){var u=arguments.length;if(!u)return[];for(var y=gt(u-1),ue=arguments[0],Ie=u;Ie--;)y[Ie-1]=arguments[Ie];return Ts(On(ue)?Ho(ue):[ue],qr(y,1))},He.cond=function pC(u){var y=null==u?0:u.length,ue=fn();return u=y?di(u,function(Ie){if("function"!=typeof Ie[1])throw new Ws(z);return[ue(Ie[0]),Ie[1]]}):[],Fn(function(Ie){for(var Ne=-1;++Ne<y;){var Ge=u[Ne];if(Es(Ge[0],this,Ie))return Es(Ge[1],this,Ie)}})},He.conforms=function gC(u){return function Bb(u){var y=yr(u);return function(ue){return Ld(ue,u,y)}}(ks(u,1))},He.constant=M_,He.countBy=v$,He.create=function IE(u,y){var ue=$u(u);return null==y?ue:tr(ue,y)},He.curry=function a_(u,y,ue){var Ie=tl(u,8,S,S,S,S,S,y=ue?S:y);return Ie.placeholder=a_.placeholder,Ie},He.curryRight=function Zl(u,y,ue){var Ie=tl(u,16,S,S,S,S,S,y=ue?S:y);return Ie.placeholder=Zl.placeholder,Ie},He.debounce=l_,He.defaults=kE,He.defaultsDeep=ME,He.defer=T$,He.delay=Ly,He.difference=fE,He.differenceBy=hE,He.differenceWith=pE,He.drop=function Hg(u,y,ue){var Ie=null==u?0:u.length;return Ie?Ys(u,(y=ue||y===S?1:Hn(y))<0?0:y,Ie):[]},He.dropRight=function Vg(u,y,ue){var Ie=null==u?0:u.length;return Ie?Ys(u,0,(y=Ie-(y=ue||y===S?1:Hn(y)))<0?0:y):[]},He.dropRightWhile=function Ug(u,y){return u&&u.length?Su(u,fn(y,3),!0,!0):[]},He.dropWhile=function gE(u,y){return u&&u.length?Su(u,fn(y,3),!0):[]},He.fill=function _E(u,y,ue,Ie){var Ne=null==u?0:u.length;return Ne?(ue&&"number"!=typeof ue&&co(u,y,ue)&&(ue=0,Ie=Ne),function Hd(u,y,ue,Ie){var Ne=u.length;for((ue=Hn(ue))<0&&(ue=-ue>Ne?0:Ne+ue),(Ie=Ie===S||Ie>Ne?Ne:Hn(Ie))<0&&(Ie+=Ne),Ie=ue>Ie?0:v_(Ie);ue<Ie;)u[ue++]=y;return u}(u,y,ue,Ie)):[]},He.filter=function as(u,y){return(On(u)?pa:C0)(u,fn(y,3))},He.flatMap=function My(u,y){return qr(il(u,y),1)},He.flatMapDeep=function b$(u,y){return qr(il(u,y),O)},He.flatMapDepth=function ef(u,y,ue){return ue=ue===S?1:Hn(ue),qr(il(u,y),ue)},He.flatten=s$,He.flattenDeep=function oy(u){return null!=u&&u.length?qr(u,O):[]},He.flattenDepth=function sy(u,y){return null!=u&&u.length?qr(u,y=y===S?1:Hn(y)):[]},He.flip=function Fh(u){return tl(u,512)},He.flow=_C,He.flowRight=mC,He.fromPairs=function a$(u){for(var y=-1,ue=null==u?0:u.length,Ie={};++y<ue;){var Ne=u[y];Ie[Ne[0]]=Ne[1]}return Ie},He.functions=function b_(u){return null==u?[]:Cg(u,yr(u))},He.functionsIn=function Ky(u){return null==u?[]:Cg(u,jo(u))},He.groupBy=t_,He.initial=function Gg(u){return null!=u&&u.length?Ys(u,0,-1):[]},He.intersection=ay,He.intersectionBy=ji,He.intersectionWith=Lc,He.invert=C_,He.invertBy=Xy,He.invokeMap=y$,He.iteratee=lf,He.keyBy=CE,He.keys=yr,He.keysIn=jo,He.map=il,He.mapKeys=function x_(u,y){var ue={};return y=fn(y,3),Ca(u,function(Ie,Ne,Ge){Ja(ue,y(Ie,Ne,Ge),Ie)}),ue},He.mapValues=function Qy(u,y){var ue={};return y=fn(y,3),Ca(u,function(Ie,Ne,Ge){Ja(ue,Ne,y(Ie,Ne,Ge))}),ue},He.matches=function $C(u){return Dg(ks(u,1))},He.matchesProperty=function P_(u,y){return S0(u,ks(y,1))},He.memoize=Rh,He.merge=V$,He.mergeWith=U$,He.method=F_,He.methodOf=o1,He.mixin=R_,He.negate=tf,He.nthArg=function HE(u){return u=Hn(u),Fn(function(y){return wu(y,u)})},He.omit=Jy,He.omitBy=function sf(u,y){return Uh(u,tf(fn(y)))},He.once=function S$(u){return E$(2,u)},He.orderBy=function i_(u,y,ue,Ie){return null==u?[]:(On(y)||(y=null==y?[]:[y]),On(ue=Ie?S:ue)||(ue=null==ue?[]:[ue]),D0(u,y,ue))},He.over=bC,He.overArgs=D$,He.overEvery=s1,He.overSome=a1,He.partial=nf,He.partialRight=c_,He.partition=C$,He.pick=Bu,He.pickBy=Uh,He.property=N_,He.propertyOf=function l1(u){return function(y){return null==u?S:yu(u,y)}},He.pull=uy,He.pullAll=u$,He.pullAllBy=function dy(u,y,ue){return u&&u.length&&y&&y.length?Fr(u,y,fn(ue,2)):u},He.pullAllWith=function fy(u,y,ue){return u&&u.length&&y&&y.length?Fr(u,y,S,ue):u},He.pullAt=mE,He.range=c1,He.rangeRight=cl,He.rearg=Nh,He.reject=function Py(u,y){return(On(u)?pa:C0)(u,tf(fn(y,3)))},He.remove=function $E(u,y){var ue=[];if(!u||!u.length)return ue;var Ie=-1,Ne=[],Ge=u.length;for(y=fn(y,3);++Ie<Ge;){var Ke=u[Ie];y(Ke,Ie,u)&&(ue.push(Ke),Ne.push(Ie))}return ph(u,Ne),ue},He.rest=function Oh(u,y){if("function"!=typeof u)throw new Ws(z);return Fn(u,y=y===S?y:Hn(y))},He.reverse=zc,He.sampleSize=function Ry(u,y,ue){return y=(ue?co(u,y,ue):y===S)?1:Hn(y),(On(u)?y0:kg)(u,y)},He.set=function af(u,y,ue){return null==u?u:wa(u,y,ue)},He.setWith=function zu(u,y,ue,Ie){return Ie="function"==typeof Ie?Ie:S,null==u?u:wa(u,y,ue,Ie)},He.shuffle=function Ny(u){return(On(u)?oh:ei)(u)},He.slice=function bo(u,y,ue){var Ie=null==u?0:u.length;return Ie?(ue&&"number"!=typeof ue&&co(u,y,ue)?(y=0,ue=Ie):(y=null==y?0:Hn(y),ue=ue===S?Ie:Hn(ue)),Ys(u,y,ue)):[]},He.sortBy=x$,He.sortedUniq=function hy(u){return u&&u.length?jb(u):[]},He.sortedUniqBy=function py(u,y){return u&&u.length?jb(u,fn(y,2)):[]},He.split=function aC(u,y,ue){return ue&&"number"!=typeof ue&&co(u,y,ue)&&(y=ue=S),(ue=ue===S?h:ue>>>0)?(u=mi(u))&&("string"==typeof y||null!=y&&!of(y))&&!(y=Ms(y))&&Vi(u)?Fs(cr(u),0,ue):u.split(y,ue):[]},He.spread=function I$(u,y){if("function"!=typeof u)throw new Ws(z);return y=null==y?0:Ar(Hn(y),0),Fn(function(ue){var Ie=ue[y],Ne=Fs(ue,0,y);return Ie&&Ts(Ne,Ie),Es(u,this,Ne)})},He.tail=function h$(u){var y=null==u?0:u.length;return y?Ys(u,1,y):[]},He.take=function gy(u,y,ue){return u&&u.length?Ys(u,0,(y=ue||y===S?1:Hn(y))<0?0:y):[]},He.takeRight=function p$(u,y,ue){var Ie=null==u?0:u.length;return Ie?Ys(u,(y=Ie-(y=ue||y===S?1:Hn(y)))<0?0:y,Ie):[]},He.takeRightWhile=function _y(u,y){return u&&u.length?Su(u,fn(y,3),!1,!0):[]},He.takeWhile=function g$(u,y){return u&&u.length?Su(u,fn(y,3)):[]},He.tap=function Sy(u,y){return y(u),u},He.throttle=function u_(u,y,ue){var Ie=!0,Ne=!0;if("function"!=typeof u)throw new Ws(z);return j(ue)&&(Ie="leading"in ue?!!ue.leading:Ie,Ne="trailing"in ue?!!ue.trailing:Ne),l_(u,y,{leading:Ie,maxWait:y,trailing:Ne})},He.thru=Mh,He.toArray=B$,He.toPairs=j$,He.toPairsIn=w_,He.toPath=function L_(u){return On(u)?di(u,Vo):fo(u)?[u]:Ho(t$(mi(u)))},He.toPlainObject=L$,He.transform=function G$(u,y,ue){var Ie=On(u),Ne=Ie||Kl(u)||sl(u);if(y=fn(y,4),null==ue){var Ge=u&&u.constructor;ue=Ne?Ie?new Ge:[]:j(u)&&rl(Ge)?$u(br(u)):{}}return(Ne?Ur:Ca)(u,function(Ke,rt,ct){return y(ue,Ke,rt,ct)}),ue},He.unary=function k$(u){return Ph(u,1)},He.union=my,He.unionBy=$y,He.unionWith=Zg,He.uniq=function vy(u){return u&&u.length?As(u):[]},He.uniqBy=function by(u,y){return u&&u.length?As(u,fn(y,2)):[]},He.uniqWith=function Yg(u,y){return y="function"==typeof y?y:S,u&&u.length?As(u,S,y):[]},He.unset=function E_(u,y){return null==u||A0(u,y)},He.unzip=Kg,He.unzipWith=_$,He.update=function T_(u,y,ue){return null==u?u:_r(u,y,Ps(ue))},He.updateWith=function q$(u,y,ue,Ie){return Ie="function"==typeof Ie?Ie:S,null==u?u:_r(u,y,Ps(ue),Ie)},He.values=ll,He.valuesIn=function eC(u){return null==u?[]:Kp(u,jo(u))},He.without=Jd,He.words=i1,He.wrap=function d_(u,y){return nf(Ps(y),u)},He.xor=yy,He.xorBy=Cy,He.xorWith=xy,He.zip=wy,He.zipObject=function Ey(u,y){return F0(u||[],y||[],Bd)},He.zipObjectDeep=function m$(u,y){return F0(u||[],y||[],wa)},He.zipWith=Ty,He.entries=j$,He.entriesIn=w_,He.extend=H$,He.extendWith=Ou,R_(He,He),He.add=CC,He.attempt=hC,He.camelCase=Y$,He.capitalize=K$,He.ceil=z_,He.clamp=function W$(u,y,ue){return ue===S&&(ue=y,y=S),ue!==S&&(ue=(ue=ta(ue))==ue?ue:0),y!==S&&(y=(y=ta(y))==y?y:0),Fc(ta(u),y,ue)},He.clone=function zy(u){return ks(u,4)},He.cloneDeep=function Hy(u){return ks(u,5)},He.cloneDeepWith=function Vy(u,y){return ks(u,5,y="function"==typeof y?y:S)},He.cloneWith=function M$(u,y){return ks(u,4,y="function"==typeof y?y:S)},He.conformsTo=function A$(u,y){return null==y||Ld(u,y,yr(y))},He.deburr=S_,He.defaultTo=function A_(u,y){return null==u||u!=u?y:u},He.divide=d1,He.endsWith=function tC(u,y,ue){u=mi(u),y=Ms(y);var Ie=u.length,Ne=ue=ue===S?Ie:Fc(Hn(ue),0,Ie);return(ue-=y.length)>=0&&u.slice(ue,Ne)==y},He.eq=ls,He.escape=function nC(u){return(u=mi(u))&&tu.test(u)?u.replace(eu,Tc):u},He.escapeRegExp=function cs(u){return(u=mi(u))&&nu.test(u)?u.replace(wd,"\\$&"):u},He.every=function yE(u,y,ue){var Ie=On(u)?kd:Lb;return ue&&co(u,y,ue)&&(y=S),Ie(u,fn(y,3))},He.find=Xg,He.findIndex=jg,He.findKey=function AE(u,y){return ns(u,fn(y,3),Ca)},He.findLast=Qg,He.findLastIndex=o$,He.findLastKey=function PE(u,y){return ns(u,fn(y,3),yg)},He.floor=f1,He.forEach=Jg,He.forEachRight=e_,He.forIn=function FE(u,y){return null==u?u:Rc(u,fn(y,3),jo)},He.forInRight=function RE(u,y){return null==u?u:sh(u,fn(y,3),jo)},He.forOwn=function NE(u,y){return u&&Ca(u,fn(y,3))},He.forOwnRight=function Xl(u,y){return u&&yg(u,fn(y,3))},He.get=Hh,He.gt=P$,He.gte=xE,He.has=function y_(u,y){return null!=u&&Dh(u,y,ah)},He.hasIn=Vh,He.head=Xd,He.identity=Wr,He.includes=function n_(u,y,ue,Ie){u=Uo(u)?u:ll(u),ue=ue&&!Ie?Hn(ue):0;var Ne=u.length;return ue<0&&(ue=Ar(Ne+ue,0)),g_(u)?ue<=Ne&&u.indexOf(y,ue)>-1:!!Ne&&wc(u,y,ue)>-1},He.indexOf=function l$(u,y,ue){var Ie=null==u?0:u.length;if(!Ie)return-1;var Ne=null==ue?0:Hn(ue);return Ne<0&&(Ne=Ar(Ie+Ne,0)),wc(u,y,Ne)},He.inRange=function OE(u,y,ue){return y=al(y),ue===S?(ue=y,y=0):ue=al(ue),function w0(u,y,ue){return u>=Yn(y,ue)&&u<Ar(y,ue)}(u=ta(u),y,ue)},He.invoke=Ql,He.isArguments=Yl,He.isArray=On,He.isArrayBuffer=F$,He.isArrayLike=Uo,He.isArrayLikeObject=dr,He.isBoolean=function Js(u){return!0===u||!1===u||nr(u)&&ao(u)==ae},He.isBuffer=Kl,He.isDate=R$,He.isElement=function Uy(u){return nr(u)&&1===u.nodeType&&!Nu(u)},He.isEmpty=function jy(u){if(null==u)return!0;if(Uo(u)&&(On(u)||"string"==typeof u||"function"==typeof u.splice||Kl(u)||sl(u)||Yl(u)))return!u.length;var y=lo(u);if(y==ke||y==b)return!u.size;if(Yd(u))return!Tg(u).length;for(var ue in u)if(Pi.call(u,ue))return!1;return!0},He.isEqual=function Gy(u,y){return Cu(u,y)},He.isEqualWith=function qy(u,y,ue){var Ie=(ue="function"==typeof ue?ue:S)?ue(u,y):S;return Ie===S?Cu(u,y,S,ue):!!Ie},He.isError=Bh,He.isFinite=function Wy(u){return"number"==typeof u&&eh(u)},He.isFunction=rl,He.isInteger=N$,He.isLength=kn,He.isMap=f_,He.isMatch=function Lh(u,y){return u===y||xg(u,y,U0(y))},He.isMatchWith=function ea(u,y,ue){return ue="function"==typeof ue?ue:S,xg(u,y,U0(y),ue)},He.isNaN=function O$(u){return zh(u)&&u!=+u},He.isNative=function Zy(u){if(ny(u))throw new Pn("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return xu(u)},He.isNil=function ol(u){return null==u},He.isNull=function h_(u){return null===u},He.isNumber=zh,He.isObject=j,He.isObjectLike=nr,He.isPlainObject=Nu,He.isRegExp=of,He.isSafeInteger=function wE(u){return N$(u)&&u>=-m&&u<=m},He.isSet=p_,He.isString=g_,He.isSymbol=fo,He.isTypedArray=sl,He.isUndefined=function __(u){return u===S},He.isWeakMap=function m_(u){return nr(u)&&lo(u)==Pe},He.isWeakSet=function $_(u){return nr(u)&&"[object WeakSet]"==ao(u)},He.join=function ly(u,y){return null==u?"":kb.call(u,y)},He.kebabCase=iC,He.last=hn,He.lastIndexOf=function c$(u,y,ue){var Ie=null==u?0:u.length;if(!Ie)return-1;var Ne=Ie;return ue!==S&&(Ne=(Ne=Hn(ue))<0?Ar(Ie+Ne,0):Yn(Ne,Ie-1)),y==y?function Fd(at,mt,gt){for(var Kt=gt+1;Kt--;)if(at[Kt]===mt)return Kt;return Kt}(u,y,Ne):Yf(u,jr,Ne,!0)},He.lowerCase=rC,He.lowerFirst=BE,He.lt=EE,He.lte=Yy,He.max=function h1(u){return u&&u.length?Zs(u,Wr,Ud):S},He.maxBy=function xC(u,y){return u&&u.length?Zs(u,fn(y,2),Ud):S},He.mean=function H_(u){return Gr(u,Wr)},He.meanBy=function wC(u,y){return Gr(u,fn(y,2))},He.min=function EC(u){return u&&u.length?Zs(u,Wr,dh):S},He.minBy=function p1(u,y){return u&&u.length?Zs(u,fn(y,2),dh):S},He.stubArray=Hu,He.stubFalse=O_,He.stubObject=function yC(){return{}},He.stubString=function VE(){return""},He.stubTrue=function B_(){return!0},He.multiply=Vu,He.nth=function cy(u,y){return u&&u.length?wu(u,Hn(y)):S},He.noConflict=function vC(){return Ir._===this&&(Ir._=ng),this},He.noop=cf,He.now=Ru,He.pad=function LE(u,y,ue){u=mi(u);var Ie=(y=Hn(y))?Gs(u):0;if(!y||Ie>=y)return u;var Ne=(y-Ie)/2;return bh(_u(Ne),ue)+u+bh(Jf(Ne),ue)},He.padEnd=function X$(u,y,ue){u=mi(u);var Ie=(y=Hn(y))?Gs(u):0;return y&&Ie<y?u+bh(y-Ie,ue):u},He.padStart=function zE(u,y,ue){u=mi(u);var Ie=(y=Hn(y))?Gs(u):0;return y&&Ie<y?bh(y-Ie,ue)+u:u},He.parseInt=function oC(u,y,ue){return ue||null==y?y=0:y&&(y=+y),Mb(mi(u).replace(es,""),y||0)},He.random=function Z$(u,y,ue){if(ue&&"boolean"!=typeof ue&&co(u,y,ue)&&(y=ue=S),ue===S&&("boolean"==typeof y?(ue=y,y=S):"boolean"==typeof u&&(ue=u,u=S)),u===S&&y===S?(u=0,y=1):(u=al(u),y===S?(y=u,u=0):y=al(y)),u>y){var Ie=u;u=y,y=Ie}if(ue||u%1||y%1){var Ne=ur();return Yn(u+Ne*(y-u+Rn("1e-"+((Ne+"").length-1))),y)}return Nc(u,y)},He.reduce=function Ay(u,y,ue){var Ie=On(u)?Zp:is,Ne=arguments.length<3;return Ie(u,fn(y,4),ue,Ne,ya)},He.reduceRight=function r_(u,y,ue){var Ie=On(u)?Qt:is,Ne=arguments.length<3;return Ie(u,fn(y,4),ue,Ne,bg)},He.repeat=function D_(u,y,ue){return y=(ue?co(u,y,ue):y===S)?1:Hn(y),Vl(mi(u),y)},He.replace=function Q$(){var u=arguments,y=mi(u[0]);return u.length<3?y:y.replace(u[1],u[2])},He.result=function Lu(u,y,ue){var Ie=-1,Ne=(y=el(y,u)).length;for(Ne||(Ne=1,u=S);++Ie<Ne;){var Ge=null==u?S:u[Vo(y[Ie])];Ge===S&&(Ie=Ne,Ge=ue),u=rl(Ge)?Ge.call(u):Ge}return u},He.round=g1,He.runInContext=at,He.sample=function Fy(u){return(On(u)?mg:k0)(u)},He.size=function Oy(u){if(null==u)return 0;if(Uo(u))return g_(u)?Gs(u):u.length;var y=lo(u);return y==ke||y==b?u.size:Tg(u).length},He.snakeCase=sC,He.some=function By(u,y,ue){var Ie=On(u)?Yp:aE;return ue&&co(u,y,ue)&&(y=S),Ie(u,fn(y,3))},He.sortedIndex=function qg(u,y){return Mg(u,y)},He.sortedIndexBy=function d$(u,y,ue){return M0(u,y,fn(ue,2))},He.sortedIndexOf=function f$(u,y){var ue=null==u?0:u.length;if(ue){var Ie=Mg(u,y);if(Ie<ue&&ls(u[Ie],y))return Ie}return-1},He.sortedLastIndex=function uo(u,y){return Mg(u,y,!0)},He.sortedLastIndexBy=function Qd(u,y,ue){return M0(u,y,fn(ue,2),!0)},He.sortedLastIndexOf=function Wg(u,y){if(null!=u&&u.length){var Ie=Mg(u,y,!0)-1;if(ls(u[Ie],y))return Ie}return-1},He.startCase=lC,He.startsWith=function J$(u,y,ue){return u=mi(u),ue=null==ue?0:Fc(Hn(ue),0,u.length),y=Ms(y),u.slice(ue,ue+y.length)==y},He.subtract=TC,He.sum=function SC(u){return u&&u.length?Md(u,Wr):0},He.sumBy=function Uu(u,y){return u&&u.length?Md(u,fn(y,2)):0},He.template=function cC(u,y,ue){var Ie=He.templateSettings;ue&&co(u,y,ue)&&(y=S),u=mi(u),y=Ou({},y,Ie,xh);var rt,ct,Ne=Ou({},y.imports,Ie.imports,xh),Ge=yr(Ne),Ke=Kp(Ne,Ge),yt=0,Ct=y.interpolate||Al,Dt="__p += '",zt=c0((y.escape||Al).source+"|"+Ct.source+"|"+(Ct===jf?ru:Al).source+"|"+(y.evaluate||Al).source+"|$","g"),on="//# sourceURL="+(Pi.call(y,"sourceURL")?(y.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++yb+"]")+"\n";u.replace(zt,function(bn,Kn,ti,Rs,Go,yo){return ti||(ti=Rs),Dt+=u.slice(yt,yo).replace(Up,kr),Kn&&(rt=!0,Dt+="' +\n__e("+Kn+") +\n'"),Go&&(ct=!0,Dt+="';\n"+Go+";\n__p += '"),ti&&(Dt+="' +\n((__t = ("+ti+")) == null ? '' : __t) +\n'"),yt=yo+bn.length,bn}),Dt+="';\n";var vn=Pi.call(y,"variable")&&y.variable;if(vn){if(Vp.test(vn))throw new Pn("Invalid `variable` option passed into `_.template`")}else Dt="with (obj) {\n"+Dt+"\n}\n";Dt=(ct?Dt.replace(vc,""):Dt).replace(Jo,"$1").replace(Dl,"$1;"),Dt="function("+(vn||"obj")+") {\n"+(vn?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(rt?", __e = _.escape":"")+(ct?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+Dt+"return __p\n}";var jn=hC(function(){return _i(Ge,on+"return "+Dt).apply(S,Ke)});if(jn.source=Dt,Bh(jn))throw jn;return jn},He.times=function u1(u,y){if((u=Hn(u))<1||u>m)return[];var ue=h,Ie=Yn(u,h);y=fn(y),u-=h;for(var Ne=Ec(Ie,y);++ue<u;)y(ue);return Ne},He.toFinite=al,He.toInteger=Hn,He.toLength=v_,He.toLower=function e1(u){return mi(u).toLowerCase()},He.toNumber=ta,He.toSafeInteger=function TE(u){return u?Fc(Hn(u),-m,m):0===u?u:0},He.toString=mi,He.toUpper=function uC(u){return mi(u).toUpperCase()},He.trim=function dC(u,y,ue){if((u=mi(u))&&(ue||y===S))return Rl(u);if(!u||!(y=Ms(y)))return u;var Ie=cr(u),Ne=cr(y);return Fs(Ie,Vt(Ie,Ne),Un(Ie,Ne)+1).join("")},He.trimEnd=function t1(u,y,ue){if((u=mi(u))&&(ue||y===S))return u.slice(0,Bi(u)+1);if(!u||!(y=Ms(y)))return u;var Ie=cr(u);return Fs(Ie,0,Un(Ie,cr(y))+1).join("")},He.trimStart=function n1(u,y,ue){if((u=mi(u))&&(ue||y===S))return u.replace(es,"");if(!u||!(y=Ms(y)))return u;var Ie=cr(u);return Fs(Ie,Vt(Ie,cr(y))).join("")},He.truncate=function fC(u,y){var ue=30,Ie="...";if(j(y)){var Ne="separator"in y?y.separator:Ne;ue="length"in y?Hn(y.length):ue,Ie="omission"in y?Ms(y.omission):Ie}var Ge=(u=mi(u)).length;if(Vi(u)){var Ke=cr(u);Ge=Ke.length}if(ue>=Ge)return u;var rt=ue-Gs(Ie);if(rt<1)return Ie;var ct=Ke?Fs(Ke,0,rt).join(""):u.slice(0,rt);if(Ne===S)return ct+Ie;if(Ke&&(rt+=ct.length-rt),of(Ne)){if(u.slice(rt).search(Ne)){var yt,Ct=ct;for(Ne.global||(Ne=c0(Ne.source,mi(Il.exec(Ne))+"g")),Ne.lastIndex=0;yt=Ne.exec(Ct);)var Dt=yt.index;ct=ct.slice(0,Dt===S?rt:Dt)}}else if(u.indexOf(Ms(Ne),rt)!=rt){var zt=ct.lastIndexOf(Ne);zt>-1&&(ct=ct.slice(0,zt))}return ct+Ie},He.unescape=function Ia(u){return(u=mi(u))&&xd.test(u)?u.replace(Cd,Eb):u},He.uniqueId=function uf(u){var y=++rE;return mi(u)+y},He.upperCase=I_,He.upperFirst=k_,He.each=Jg,He.eachRight=e_,He.first=Xd,R_(He,function(){var u={};return Ca(He,function(y,ue){Pi.call(He.prototype,ue)||(u[ue]=y)}),u}(),{chain:!1}),He.VERSION="4.17.21",Ur(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){He[u].placeholder=He}),Ur(["drop","take"],function(u,y){Xn.prototype[u]=function(ue){ue=ue===S?1:Ar(Hn(ue),0);var Ie=this.__filtered__&&!y?new Xn(this):this.clone();return Ie.__filtered__?Ie.__takeCount__=Yn(ue,Ie.__takeCount__):Ie.__views__.push({size:Yn(ue,h),type:u+(Ie.__dir__<0?"Right":"")}),Ie},Xn.prototype[u+"Right"]=function(ue){return this.reverse()[u](ue).reverse()}}),Ur(["filter","map","takeWhile"],function(u,y){var ue=y+1,Ie=1==ue||3==ue;Xn.prototype[u]=function(Ne){var Ge=this.clone();return Ge.__iteratees__.push({iteratee:fn(Ne,3),type:ue}),Ge.__filtered__=Ge.__filtered__||Ie,Ge}}),Ur(["head","last"],function(u,y){var ue="take"+(y?"Right":"");Xn.prototype[u]=function(){return this[ue](1).value()[0]}}),Ur(["initial","tail"],function(u,y){var ue="drop"+(y?"":"Right");Xn.prototype[u]=function(){return this.__filtered__?new Xn(this):this[ue](1)}}),Xn.prototype.compact=function(){return this.filter(Wr)},Xn.prototype.find=function(u){return this.filter(u).head()},Xn.prototype.findLast=function(u){return this.reverse().find(u)},Xn.prototype.invokeMap=Fn(function(u,y){return"function"==typeof u?new Xn(this):this.map(function(ue){return xa(ue,u,y)})}),Xn.prototype.reject=function(u){return this.filter(tf(fn(u)))},Xn.prototype.slice=function(u,y){u=Hn(u);var ue=this;return ue.__filtered__&&(u>0||y<0)?new Xn(ue):(u<0?ue=ue.takeRight(-u):u&&(ue=ue.drop(u)),y!==S&&(ue=(y=Hn(y))<0?ue.dropRight(-y):ue.take(y-u)),ue)},Xn.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},Xn.prototype.toArray=function(){return this.take(h)},Ca(Xn.prototype,function(u,y){var ue=/^(?:filter|find|map|reject)|While$/.test(y),Ie=/^(?:head|last)$/.test(y),Ne=He[Ie?"take"+("last"==y?"Right":""):y],Ge=Ie||/^find/.test(y);!Ne||(He.prototype[y]=function(){var Ke=this.__wrapped__,rt=Ie?[1]:arguments,ct=Ke instanceof Xn,yt=rt[0],Ct=ct||On(Ke),Dt=function(Kn){var ti=Ne.apply(He,Ts([Kn],rt));return Ie&&zt?ti[0]:ti};Ct&&ue&&"function"==typeof yt&&1!=yt.length&&(ct=Ct=!1);var zt=this.__chain__,on=!!this.__actions__.length,vn=Ge&&!zt,jn=ct&&!on;if(!Ge&&Ct){Ke=jn?Ke:new Xn(this);var bn=u.apply(Ke,rt);return bn.__actions__.push({func:Mh,args:[Dt],thisArg:S}),new Ds(bn,zt)}return vn&&jn?u.apply(this,rt):(bn=this.thru(Dt),vn?Ie?bn.value()[0]:bn.value():bn)})}),Ur(["pop","push","shift","sort","splice","unshift"],function(u){var y=Qp[u],ue=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",Ie=/^(?:pop|shift)$/.test(u);He.prototype[u]=function(){var Ne=arguments;if(Ie&&!this.__chain__){var Ge=this.value();return y.apply(On(Ge)?Ge:[],Ne)}return this[ue](function(Ke){return y.apply(On(Ke)?Ke:[],Ne)})}}),Ca(Xn.prototype,function(u,y){var ue=He[y];if(ue){var Ie=ue.name+"";Pi.call(Ac,Ie)||(Ac[Ie]=[]),Ac[Ie].push({name:y,func:ue})}}),Ac[qd(S,2).name]=[{name:"wrapper",func:S}],Xn.prototype.clone=function Tt(){var u=new Xn(this.__wrapped__);return u.__actions__=Ho(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=Ho(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=Ho(this.__views__),u},Xn.prototype.reverse=function ii(){if(this.__filtered__){var u=new Xn(this);u.__dir__=-1,u.__filtered__=!0}else(u=this.clone()).__dir__*=-1;return u},Xn.prototype.value=function Le(){var u=this.__wrapped__.value(),y=this.__dir__,ue=On(u),Ie=y<0,Ne=ue?u.length:0,Ge=function Jb(u,y,ue){for(var Ie=-1,Ne=ue.length;++Ie<Ne;){var Ge=ue[Ie],Ke=Ge.size;switch(Ge.type){case"drop":u+=Ke;break;case"dropRight":y-=Ke;break;case"take":y=Yn(y,u+Ke);break;case"takeRight":u=Ar(u,y-Ke)}}return{start:u,end:y}}(0,Ne,this.__views__),Ke=Ge.start,rt=Ge.end,ct=rt-Ke,yt=Ie?rt:Ke-1,Ct=this.__iteratees__,Dt=Ct.length,zt=0,on=Yn(ct,this.__takeCount__);if(!ue||!Ie&&Ne==ct&&on==ct)return Du(u,this.__actions__);var vn=[];e:for(;ct--&&zt<on;){for(var jn=-1,bn=u[yt+=y];++jn<Dt;){var Kn=Ct[jn],Rs=Kn.type,Go=(0,Kn.iteratee)(bn);if(2==Rs)bn=Go;else if(!Go){if(1==Rs)continue e;break e}}vn[zt++]=bn}return vn},He.prototype.at=Dy,He.prototype.chain=function Iy(){return $$(this)},He.prototype.commit=function Ah(){return new Ds(this.value(),this.__chain__)},He.prototype.next=function ky(){this.__values__===S&&(this.__values__=B$(this.value()));var u=this.__index__>=this.__values__.length;return{done:u,value:u?S:this.__values__[this.__index__++]}},He.prototype.plant=function Da(u){for(var y,ue=this;ue instanceof Nd;){var Ie=Pu(ue);Ie.__index__=0,Ie.__values__=S,y?Ne.__wrapped__=Ie:y=Ie;var Ne=Ie;ue=ue.__wrapped__}return Ne.__wrapped__=u,y},He.prototype.reverse=function vE(){var u=this.__wrapped__;if(u instanceof Xn){var y=u;return this.__actions__.length&&(y=new Xn(this)),(y=y.reverse()).__actions__.push({func:Mh,args:[zc],thisArg:S}),new Ds(y,this.__chain__)}return this.thru(zc)},He.prototype.toJSON=He.prototype.valueOf=He.prototype.value=function bE(){return Du(this.__wrapped__,this.__actions__)},He.prototype.first=He.prototype.head,pu&&(He.prototype[pu]=function Fu(){return this}),He}();Ir._=Dc,(f=function(){return Dc}.call(fe,Ce,fe,T))!==S&&(T.exports=f)}.call(this)},9263:(T,fe,Ce)=>{var f=Ce(9209),S=Ce(966);function te(v){this._init(v)}te.prototype={_init:function(v){v=v||{},this._data=null,this._table=null,this._result=null,this._onDataCallback=v.onData,this._onEndCallback=v.onEnd},_createTable:function(){for(var v=S.createBuffer(8,f.TABLE_LENGTH),D=0;D<f.TABLE_LENGTH;D++)v[D]=f.BASE62TABLE.charCodeAt(D);return v},_onData:function(v,D){var z=S.bufferToString_fast(v,D);this._onDataCallback?this._onDataCallback(z):this._result+=z},_onEnd:function(){this._onEndCallback&&this._onEndCallback(),this._data=this._table=null},_search:function(){var v=2,D=this._data,z=this._offset,I=f.BUFFER_MAX;if(this._dataLen-z<I&&(I=this._dataLen-z),v>I)return!1;var G,re,q,E,V,Q=z-f.WINDOW_BUFFER_MAX,U=D.substring(Q,z+I),N=z+v-3-Q;do{if(2===v){if(re=D.charAt(z)+D.charAt(z+1),!~(q=U.indexOf(re))||q>N)break}else 3===v?re+=D.charAt(z+2):re=D.substr(z,v);if(!~(E=f.STRING_LASTINDEXOF_BUG?D.substring(Q,z+v-1).lastIndexOf(re):U.lastIndexOf(re,N)))break;V=E,G=Q+E;do{if(D.charCodeAt(z+v)!==D.charCodeAt(G+v))break}while(++v<I);if(q===E){v++;break}}while(++v<I);return 2!==v&&(this._index=f.WINDOW_BUFFER_MAX-V,this._length=v-1,!0)},compress:function(v){if(null==v||0===v.length)return"";var D,z=this._createTable(),I=S.createWindow(),Q=S.createBuffer(8,f.COMPRESS_CHUNK_SIZE),U=0;this._result="",this._offset=I.length,this._data=I+v,this._dataLen=this._data.length,I=v=null;for(var re,q,E,V,le,N=-1,G=-1;this._offset<this._dataLen;)this._search()?(this._index<f.BUFFER_MAX?(q=this._index,E=0):E=(this._index-(q=this._index%f.BUFFER_MAX))/f.BUFFER_MAX,2===this._length?(Q[U++]=z[E+f.COMPRESS_FIXED_START],Q[U++]=z[q]):(Q[U++]=z[E+f.COMPRESS_START],Q[U++]=z[q],Q[U++]=z[this._length]),this._offset+=this._length,~G&&(G=-1)):(re=this._data.charCodeAt(this._offset++))<f.LATIN_BUFFER_MAX?(re<f.UNICODE_CHAR_MAX?(q=re,E=0,N=f.LATIN_INDEX):N=(E=(re-(q=re%f.UNICODE_CHAR_MAX))/f.UNICODE_CHAR_MAX)+f.LATIN_INDEX,G===N?Q[U++]=z[q]:(Q[U++]=z[N-f.LATIN_INDEX_START],Q[U++]=z[q],G=N)):(re<f.UNICODE_BUFFER_MAX?(q=re,E=0,N=f.UNICODE_INDEX):N=(E=(re-(q=re%f.UNICODE_BUFFER_MAX))/f.UNICODE_BUFFER_MAX)+f.UNICODE_INDEX,q<f.UNICODE_CHAR_MAX?(V=q,le=0):le=(q-(V=q%f.UNICODE_CHAR_MAX))/f.UNICODE_CHAR_MAX,G===N?(Q[U++]=z[V],Q[U++]=z[le]):(Q[U++]=z[f.CHAR_START],Q[U++]=z[N-f.TABLE_LENGTH],Q[U++]=z[V],Q[U++]=z[le],G=N)),U>=f.COMPRESS_CHUNK_MAX&&(this._onData(Q,U),U=0);return U>0&&this._onData(Q,U),this._onEnd(),D=this._result,this._result=null,null===D?"":D}},T.exports=te},9209:(T,fe)=>{var Ce=fe.HAS_TYPED="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array,f=!1,S=!1;try{"a"===String.fromCharCode.apply(null,[97])&&(f=!0)}catch(Z){}if(Ce)try{"a"===String.fromCharCode.apply(null,new Uint8Array([97]))&&(S=!0)}catch(Z){}fe.CAN_CHARCODE_APPLY=f,fe.CAN_CHARCODE_APPLY_TYPED=S;var te=fe.APPLY_BUFFER_SIZE=65533;fe.APPLY_BUFFER_SIZE_OK=null;var v=!1;-1!=="abc\u307b\u3052".lastIndexOf("\u307b\u3052",1)&&(v=!0),fe.STRING_LASTINDEXOF_BUG=v;var D=fe.BASE62TABLE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",z=fe.TABLE_LENGTH=D.length,I=Math.max(z,62)-Math.min(z,62);fe.BUFFER_MAX=z-1;var Q=fe.WINDOW_MAX=1024;fe.WINDOW_BUFFER_MAX=304;var U=fe.COMPRESS_CHUNK_SIZE=te;fe.COMPRESS_CHUNK_MAX=U-z;var N=fe.DECOMPRESS_CHUNK_SIZE=te;fe.DECOMPRESS_CHUNK_MAX=N+2*Q,fe.LATIN_BUFFER_MAX=132;var re=fe.UNICODE_CHAR_MAX=40;fe.UNICODE_BUFFER_MAX=re*(re+1),fe.LATIN_INDEX=z+1,fe.LATIN_INDEX_START=I+20,fe.UNICODE_INDEX=z+5,fe.DECODE_MAX=z-I-19;var q=fe.LATIN_DECODE_MAX=re+7,E=fe.CHAR_START=q+1,V=fe.COMPRESS_START=E+1,le=fe.COMPRESS_FIXED_START=V+5;fe.COMPRESS_INDEX=le+5},9727:(T,fe,Ce)=>{var f=Ce(9209),S=Ce(966);function te(v){this._init(v)}te.prototype={_init:function(v){v=v||{},this._result=null,this._onDataCallback=v.onData,this._onEndCallback=v.onEnd},_createTable:function(){for(var v={},D=0;D<f.TABLE_LENGTH;D++)v[f.BASE62TABLE.charAt(D)]=D;return v},_onData:function(v){var D;if(this._onDataCallback){if(v)D=this._result,this._result=[];else{var z=f.DECOMPRESS_CHUNK_SIZE-f.WINDOW_MAX;D=this._result.slice(f.WINDOW_MAX,f.WINDOW_MAX+z),this._result=this._result.slice(0,f.WINDOW_MAX).concat(this._result.slice(f.WINDOW_MAX+z))}D.length>0&&this._onDataCallback(S.bufferToString_fast(D))}},_onEnd:function(){this._onEndCallback&&this._onEndCallback()},decompress:function(v){if(null==v||0===v.length)return"";this._result=S.stringToArray(S.createWindow());for(var D,G,re,q,V,le,Z,Y,X,k,z=this._createTable(),I=!1,Q=null,U=v.length,N=0;N<U;N++)if(void 0!==(re=z[v.charAt(N)])){if(re<f.DECODE_MAX)V=I?z[v.charAt(++N)]*f.UNICODE_CHAR_MAX+re+f.UNICODE_BUFFER_MAX*Q:Q*f.UNICODE_CHAR_MAX+re,this._result[this._result.length]=V;else if(re<f.LATIN_DECODE_MAX)Q=re-f.DECODE_MAX,I=!1;else if(re===f.CHAR_START)Q=(q=z[v.charAt(++N)])-5,I=!0;else if(re<f.COMPRESS_INDEX){if(q=z[v.charAt(++N)],re<f.COMPRESS_FIXED_START?(le=(re-f.COMPRESS_START)*f.BUFFER_MAX+q,Z=z[v.charAt(++N)]):(le=(re-f.COMPRESS_FIXED_START)*f.BUFFER_MAX+q,Z=2),(Y=this._result.slice(-le)).length>Z&&(Y.length=Z),X=Y.length,Y.length>0)for(k=0;k<Z;)for(G=0;G<X&&(this._result[this._result.length]=Y[G],!(++k>=Z));G++);Q=null}this._result.length>=f.DECOMPRESS_CHUNK_MAX&&this._onData()}return this._result=this._result.slice(f.WINDOW_MAX),this._onData(!0),this._onEnd(),D=S.bufferToString_fast(this._result),this._result=null,D}},T.exports=te},8497:(T,fe,Ce)=>{var f=Ce(9263),S=Ce(9727);Ce(1014),fe.n=function(te,v){return new f(v).compress(te)},fe.L=function(te,v){return new S(v).decompress(te)}},966:(T,fe,Ce)=>{var f=Ce(9209),S=String.fromCharCode;fe.createBuffer=function(z,I){if(!f.HAS_TYPED)return new Array(I);switch(z){case 8:return new Uint8Array(I);case 16:return new Uint16Array(I)}};var te=fe.truncateBuffer=function(z,I){return z.length===I?z:z.subarray?z.subarray(0,I):(z.length=I,z)};fe.bufferToString_fast=function(z,I){if(null==I?I=z.length:z=te(z,I),f.CAN_CHARCODE_APPLY&&f.CAN_CHARCODE_APPLY_TYPED){var Q=z.length;if(Q<f.APPLY_BUFFER_SIZE&&f.APPLY_BUFFER_SIZE_OK)return S.apply(null,z);if(null===f.APPLY_BUFFER_SIZE_OK)try{var U=S.apply(null,z);return Q>f.APPLY_BUFFER_SIZE&&(f.APPLY_BUFFER_SIZE_OK=!0),U}catch(N){f.APPLY_BUFFER_SIZE_OK=!1}}return v(z)};var v=fe.bufferToString_chunked=function(z){for(var N,I="",Q=z.length,U=0;U<Q;){if(N=z.subarray?z.subarray(U,U+f.APPLY_BUFFER_SIZE):z.slice(U,U+f.APPLY_BUFFER_SIZE),U+=f.APPLY_BUFFER_SIZE,!f.APPLY_BUFFER_SIZE_OK){if(null===f.APPLY_BUFFER_SIZE_OK)try{I+=S.apply(null,N),N.length>f.APPLY_BUFFER_SIZE&&(f.APPLY_BUFFER_SIZE_OK=!0);continue}catch(G){f.APPLY_BUFFER_SIZE_OK=!1}return D(z)}I+=S.apply(null,N)}return I},D=fe.bufferToString_slow=function(z){for(var I="",Q=z.length,U=0;U<Q;U++)I+=S(z[U]);return I};fe.stringToArray=function(z){for(var I=[],Q=z&&z.length,U=0;U<Q;U++)I[U]=z.charCodeAt(U);return I},fe.createWindow=function(){for(var z=f.WINDOW_MAX>>7,I="        ";!(z&f.WINDOW_MAX);)I+=I,z<<=1;return I}},2391:(T,fe,Ce)=>{fe.encode=Ce(8048).encode,fe.decode=Ce(9175).decode,Ce(7704),Ce(8131),Ce(1490),Ce(9234)},2295:function(T){function fe(Ce){return Ce&&Ce.isBuffer&&Ce}T.exports=fe("undefined"!=typeof Buffer&&Buffer)||fe(this.Buffer)||fe("undefined"!=typeof window&&window.Buffer)||this.Buffer},7625:(T,fe)=>{fe.copy=function te(v,D,z,I){var Q;z||(z=0),!I&&0!==I&&(I=this.length),D||(D=0);var U=I-z;if(v===this&&z<D&&D<I)for(Q=U-1;Q>=0;Q--)v[Q+D]=this[Q+z];else for(Q=0;Q<U;Q++)v[Q+D]=this[Q+z];return U},fe.toString=function S(v,D,z){var I=this,Q=0|D;z||(z=I.length);for(var U="",N=0;Q<z;)(N=I[Q++])<128?U+=String.fromCharCode(N):(192==(224&N)?N=(31&N)<<6|63&I[Q++]:224==(240&N)?N=(15&N)<<12|(63&I[Q++])<<6|63&I[Q++]:240==(248&N)&&(N=(7&N)<<18|(63&I[Q++])<<12|(63&I[Q++])<<6|63&I[Q++]),N>=65536?(N-=65536,U+=String.fromCharCode(55296+(N>>>10),56320+(1023&N))):U+=String.fromCharCode(N));return U},fe.write=function f(v,D){for(var z=this,I=D||(D|=0),Q=v.length,U=0,N=0;N<Q;)(U=v.charCodeAt(N++))<128?z[I++]=U:U<2048?(z[I++]=192|U>>>6,z[I++]=128|63&U):U<55296||U>57343?(z[I++]=224|U>>>12,z[I++]=128|U>>>6&63,z[I++]=128|63&U):(U=65536+(U-55296<<10|v.charCodeAt(N++)-56320),z[I++]=240|U>>>18,z[I++]=128|U>>>12&63,z[I++]=128|U>>>6&63,z[I++]=128|63&U);return I-D}},1864:(T,fe,Ce)=>{var f=Ce(6093),S=T.exports=te(0);function te(D){return new Array(D)}S.alloc=te,S.concat=f.concat,S.from=function v(D){if(!f.isBuffer(D)&&f.isView(D))D=f.Uint8Array.from(D);else if(f.isArrayBuffer(D))D=new Uint8Array(D);else{if("string"==typeof D)return f.from.call(S,D);if("number"==typeof D)throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(D)}},1884:(T,fe,Ce)=>{var f=Ce(6093),S=f.global,te=T.exports=f.hasBuffer?v(0):[];function v(z){return new S(z)}te.alloc=f.hasBuffer&&S.alloc||v,te.concat=f.concat,te.from=function D(z){if(!f.isBuffer(z)&&f.isView(z))z=f.Uint8Array.from(z);else if(f.isArrayBuffer(z))z=new Uint8Array(z);else{if("string"==typeof z)return f.from.call(te,z);if("number"==typeof z)throw new TypeError('"value" argument must not be a number')}return S.from&&1!==S.from.length?S.from(z):new S(z)}},5364:(T,fe,Ce)=>{var f=Ce(7625);fe.copy=z,fe.slice=I,fe.toString=function Q(N,G,re){var q=!v&&S.isBuffer(this)?this.toString:f.toString;return q.apply(this,arguments)},fe.write=function U(N){return function G(){return(this[N]||f[N]).apply(this,arguments)}}("write");var S=Ce(6093),te=S.global,v=S.hasBuffer&&"TYPED_ARRAY_SUPPORT"in te,D=v&&!te.TYPED_ARRAY_SUPPORT;function z(N,G,re,q){var E=S.isBuffer(this),V=S.isBuffer(N);if(E&&V)return this.copy(N,G,re,q);if(D||E||V||!S.isView(this)||!S.isView(N))return f.copy.call(this,N,G,re,q);var le=re||null!=q?I.call(this,re,q):this;return N.set(le,G),le.length}function I(N,G){var re=this.slice||!D&&this.subarray;if(re)return re.call(this,N,G);var q=S.alloc.call(this,G-N);return z.call(this,q,0,N,G),q}},5321:(T,fe,Ce)=>{var f=Ce(6093),S=T.exports=f.hasArrayBuffer?te(0):[];function te(D){return new Uint8Array(D)}S.alloc=te,S.concat=f.concat,S.from=function v(D){if(f.isView(D)){var z=D.byteOffset,I=D.byteLength;(D=D.buffer).byteLength!==I&&(D.slice?D=D.slice(z,z+I):(D=new Uint8Array(D)).byteLength!==I&&(D=Array.prototype.slice.call(D,z,z+I)))}else{if("string"==typeof D)return f.from.call(S,D);if("number"==typeof D)throw new TypeError('"value" argument must not be a number')}return new Uint8Array(D)}},6093:(T,fe,Ce)=>{var f=fe.global=Ce(2295),S=fe.hasBuffer=f&&!!f.isBuffer,te=fe.hasArrayBuffer="undefined"!=typeof ArrayBuffer,v=fe.isArray=Ce(6425);fe.isArrayBuffer=te?function V(k){return k instanceof ArrayBuffer||E(k)}:Y;var D=fe.isBuffer=S?f.isBuffer:Y,z=fe.isView=te?ArrayBuffer.isView||X("ArrayBuffer","buffer"):Y;fe.alloc=re,fe.concat=function q(k,R){R||(R=0,Array.prototype.forEach.call(k,function M(P){R+=P.length}));var H=re.call(this!==fe&&this||k[0],R),A=0;return Array.prototype.forEach.call(k,function C(P){A+=N.copy.call(P,H,A)}),H},fe.from=function G(k){return"string"==typeof k?le.call(this,k):Z(this).from(k)};var I=fe.Array=Ce(1864),Q=fe.Buffer=Ce(1884),U=fe.Uint8Array=Ce(5321),N=fe.prototype=Ce(5364);function re(k){return Z(this).alloc(k)}var E=X("ArrayBuffer");function le(k){var R=3*k.length,ee=re.call(this,R),H=N.write.call(ee,k);return R!==H&&(ee=N.slice.call(ee,0,H)),ee}function Z(k){return D(k)?Q:z(k)?U:v(k)?I:S?Q:te?U:I}function Y(){return!1}function X(k,R){return k="[object "+k+"]",function(ee){return null!=ee&&{}.toString.call(R?ee[R]:ee)===k}}},5166:(T,fe,Ce)=>{var f=Ce(6425);fe.createCodec=Q,fe.install=function v(U){for(var N in U)te.prototype[N]=D(te.prototype[N],U[N])},fe.filter=function I(U){return f(U)?function z(U){return U=U.slice(),function(G){return U.reduce(N,G)};function N(G,re){return re(G)}}(U):U};var S=Ce(6093);function te(U){if(!(this instanceof te))return new te(U);this.options=U,this.init()}function D(U,N){return U&&N?function G(){return U.apply(this,arguments),N.apply(this,arguments)}:U||N}function Q(U){return new te(U)}te.prototype.init=function(){var U=this.options;return U&&U.uint8array&&(this.bufferish=S.Uint8Array),this},fe.preset=Q({preset:!0})},9234:(T,fe,Ce)=>{Ce(8334),Ce(2732),Ce(5166)},5333:(T,fe,Ce)=>{fe.T=te;var f=Ce(8334).preset;function te(v){if(!(this instanceof te))return new te(v);if(v&&(this.options=v,v.codec)){var D=this.codec=v.codec;D.bufferish&&(this.bufferish=D.bufferish)}}Ce(6473).k.mixin(te.prototype),te.prototype.codec=f,te.prototype.fetch=function(){return this.codec.decode(this)}},9175:(T,fe,Ce)=>{fe.decode=function S(te,v){var D=new f(v);return D.write(te),D.read()};var f=Ce(5333).T},8131:(T,fe,Ce)=>{var S=Ce(6654),te=Ce(5333).T;function v(D){if(!(this instanceof v))return new v(D);te.call(this,D)}v.prototype=new te,S.mixin(v.prototype),v.prototype.decode=function(D){arguments.length&&this.write(D),this.flush()},v.prototype.push=function(D){this.emit("data",D)},v.prototype.end=function(D){this.decode(D),this.emit("end")}},8400:(T,fe,Ce)=>{fe.F=te;var f=Ce(2732).preset;function te(v){if(!(this instanceof te))return new te(v);if(v&&(this.options=v,v.codec)){var D=this.codec=v.codec;D.bufferish&&(this.bufferish=D.bufferish)}}Ce(6473).I.mixin(te.prototype),te.prototype.codec=f,te.prototype.write=function(v){this.codec.encode(this,v)}},8048:(T,fe,Ce)=>{fe.encode=function S(te,v){var D=new f(v);return D.write(te),D.read()};var f=Ce(8400).F},7704:(T,fe,Ce)=>{var S=Ce(6654),te=Ce(8400).F;function v(D){if(!(this instanceof v))return new v(D);te.call(this,D)}v.prototype=new te,S.mixin(v.prototype),v.prototype.encode=function(D){this.write(D),this.emit("data",this.read())},v.prototype.end=function(D){arguments.length&&this.encode(D),this.flush(),this.emit("end")}},7846:(T,fe,Ce)=>{fe.S=function S(te,v){if(!(this instanceof S))return new S(te,v);this.buffer=f.from(te),this.type=v};var f=Ce(6093)},4106:(T,fe,Ce)=>{fe.setExtPackers=function z(G){G.addExtPacker(14,Error,[N,I]),G.addExtPacker(1,EvalError,[N,I]),G.addExtPacker(2,RangeError,[N,I]),G.addExtPacker(3,ReferenceError,[N,I]),G.addExtPacker(4,SyntaxError,[N,I]),G.addExtPacker(5,TypeError,[N,I]),G.addExtPacker(6,URIError,[N,I]),G.addExtPacker(10,RegExp,[U,I]),G.addExtPacker(11,Boolean,[Q,I]),G.addExtPacker(12,String,[Q,I]),G.addExtPacker(13,Date,[Number,I]),G.addExtPacker(15,Number,[Q,I]),"undefined"!=typeof Uint8Array&&(G.addExtPacker(17,Int8Array,te),G.addExtPacker(18,Uint8Array,te),G.addExtPacker(19,Int16Array,te),G.addExtPacker(20,Uint16Array,te),G.addExtPacker(21,Int32Array,te),G.addExtPacker(22,Uint32Array,te),G.addExtPacker(23,Float32Array,te),"undefined"!=typeof Float64Array&&G.addExtPacker(24,Float64Array,te),"undefined"!=typeof Uint8ClampedArray&&G.addExtPacker(25,Uint8ClampedArray,te),G.addExtPacker(26,ArrayBuffer,te),G.addExtPacker(29,DataView,te)),f.hasBuffer&&G.addExtPacker(27,S,f.from)};var v,f=Ce(6093),S=f.global,te=f.Uint8Array.from,D={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function I(G){return v||(v=Ce(8048).encode),v(G)}function Q(G){return G.valueOf()}function U(G){(G=RegExp.prototype.toString.call(G).split("/")).shift();var re=[G.pop()];return re.unshift(G.join("/")),re}function N(G){var re={};for(var q in D)re[q]=G[q];return re}},9146:(T,fe,Ce)=>{fe.setExtUnpackers=function D(G){G.addExtUnpacker(14,[z,Q(Error)]),G.addExtUnpacker(1,[z,Q(EvalError)]),G.addExtUnpacker(2,[z,Q(RangeError)]),G.addExtUnpacker(3,[z,Q(ReferenceError)]),G.addExtUnpacker(4,[z,Q(SyntaxError)]),G.addExtUnpacker(5,[z,Q(TypeError)]),G.addExtUnpacker(6,[z,Q(URIError)]),G.addExtUnpacker(10,[z,I]),G.addExtUnpacker(11,[z,U(Boolean)]),G.addExtUnpacker(12,[z,U(String)]),G.addExtUnpacker(13,[z,U(Date)]),G.addExtUnpacker(15,[z,U(Number)]),"undefined"!=typeof Uint8Array&&(G.addExtUnpacker(17,U(Int8Array)),G.addExtUnpacker(18,U(Uint8Array)),G.addExtUnpacker(19,[N,U(Int16Array)]),G.addExtUnpacker(20,[N,U(Uint16Array)]),G.addExtUnpacker(21,[N,U(Int32Array)]),G.addExtUnpacker(22,[N,U(Uint32Array)]),G.addExtUnpacker(23,[N,U(Float32Array)]),"undefined"!=typeof Float64Array&&G.addExtUnpacker(24,[N,U(Float64Array)]),"undefined"!=typeof Uint8ClampedArray&&G.addExtUnpacker(25,U(Uint8ClampedArray)),G.addExtUnpacker(26,N),G.addExtUnpacker(29,[N,U(DataView)])),f.hasBuffer&&G.addExtUnpacker(27,U(S))};var te,f=Ce(6093),S=f.global,v={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function z(G){return te||(te=Ce(9175).decode),te(G)}function I(G){return RegExp.apply(null,G)}function Q(G){return function(re){var q=new G;for(var E in v)q[E]=re[E];return q}}function U(G){return function(re){return new G(re)}}function N(G){return new Uint8Array(G).buffer}},1490:(T,fe,Ce)=>{Ce(8334),Ce(2732),Ce(5166)},6473:(T,fe,Ce)=>{fe.k=D,fe.I=z;var f=Ce(6093),v="BUFFER_SHORTAGE";function D(){if(!(this instanceof D))return new D}function z(){if(!(this instanceof z))return new z}function U(){throw new Error("method not implemented: write()")}function N(){throw new Error("method not implemented: fetch()")}function G(){return this.buffers&&this.buffers.length?(this.flush(),this.pull()):this.fetch()}function re(V){(this.buffers||(this.buffers=[])).push(V)}function q(){return(this.buffers||(this.buffers=[])).shift()}function E(V){return function le(Z){for(var Y in V)Z[Y]=V[Y];return Z}}D.mixin=E(function I(){return{bufferish:f,write:function V(Y){var X=this.offset?f.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=X?Y?this.bufferish.concat([X,Y]):X:Y,this.offset=0},fetch:N,flush:function le(){for(;this.offset<this.buffer.length;){var X,Y=this.offset;try{X=this.fetch()}catch(k){if(k&&k.message!=v)throw k;this.offset=Y;break}this.push(X)}},push:re,pull:q,read:G,reserve:function Z(Y){var X=this.offset,k=X+Y;if(k>this.buffer.length)throw new Error(v);return this.offset=k,X},offset:0}}()),D.mixin(D.prototype),z.mixin=E(function Q(){return{bufferish:f,write:U,fetch:function V(){var k=this.start;if(k<this.offset){var R=this.start=this.offset;return f.prototype.slice.call(this.buffer,k,R)}},flush:function le(){for(;this.start<this.offset;){var k=this.fetch();k&&this.push(k)}},push:re,pull:function Z(){var k=this.buffers||(this.buffers=[]),R=k.length>1?this.bufferish.concat(k):k[0];return k.length=0,R},read:G,reserve:function Y(k){var R=0|k;if(this.buffer){var ee=this.buffer.length,H=0|this.offset,A=H+R;if(A<ee)return this.offset=A,H;this.flush(),k=Math.max(k,Math.min(2*ee,this.maxBufferSize))}return k=Math.max(k,this.minBufferSize),this.buffer=this.bufferish.alloc(k),this.start=0,this.offset=R,0},send:function X(k){var R=k.length;if(R>this.minBufferSize)this.flush(),this.push(k);else{var ee=this.reserve(R);f.prototype.copy.call(k,this.buffer,ee)}},maxBufferSize:65536,minBufferSize:2048,offset:0,start:0}}()),z.mixin(z.prototype)},8334:(T,fe,Ce)=>{var f=Ce(7846).S,S=Ce(9146),te=Ce(4613).readUint8,v=Ce(1788),D=Ce(5166);function I(){var N=this.options;return this.decode=function z(N){var G=v.getReadToken(N);return function re(q){var E=te(q),V=G[E];if(!V)throw new Error("Invalid type: "+(E&&"0x"+E.toString(16)));return V(q)}}(N),N&&N.preset&&S.setExtUnpackers(this),this}D.install({addExtUnpacker:function Q(N,G){(this.extUnpackers||(this.extUnpackers=[]))[N]=D.filter(G)},getExtUnpacker:function U(N){return(this.extUnpackers||(this.extUnpackers=[]))[N]||function re(q){return new f(q,N)}},init:I}),fe.preset=I.call(D.preset)},4613:(T,fe,Ce)=>{var f=Ce(8461),S=Ce(6256),te=S.Uint64BE,v=S.Int64BE;fe.getReadFormat=function U(F){var B=F&&F.int64;return{map:I&&F&&F.usemap?G:N,array:re,str:q,bin:D.hasArrayBuffer&&F&&F.binarraybuffer?V:E,ext:le,uint8:Z,uint16:X,uint32:R,uint64:H(8,B?C:A),int8:Y,int16:k,int32:ee,int64:H(8,B?P:M),float32:H(4,L),float64:H(8,ne)}},fe.readUint8=Z;var D=Ce(6093),z=Ce(5364),I="undefined"!=typeof Map;function N(F,he){var O,B={},m=new Array(he),l=new Array(he),c=F.codec.decode;for(O=0;O<he;O++)m[O]=c(F),l[O]=c(F);for(O=0;O<he;O++)B[m[O]]=l[O];return B}function G(F,he){var O,B=new Map,m=new Array(he),l=new Array(he),c=F.codec.decode;for(O=0;O<he;O++)m[O]=c(F),l[O]=c(F);for(O=0;O<he;O++)B.set(m[O],l[O]);return B}function re(F,he){for(var B=new Array(he),O=F.codec.decode,m=0;m<he;m++)B[m]=O(F);return B}function q(F,he){var B=F.reserve(he);return z.toString.call(F.buffer,"utf-8",B,B+he)}function E(F,he){var B=F.reserve(he),m=z.slice.call(F.buffer,B,B+he);return D.from(m)}function V(F,he){var B=F.reserve(he),m=z.slice.call(F.buffer,B,B+he);return D.Uint8Array.from(m).buffer}function le(F,he){var B=F.reserve(he+1),O=F.buffer[B++],m=B+he,l=F.codec.getExtUnpacker(O);if(!l)throw new Error("Invalid ext type: "+(O&&"0x"+O.toString(16)));return l(z.slice.call(F.buffer,B,m))}function Z(F){var he=F.reserve(1);return F.buffer[he]}function Y(F){var he=F.reserve(1),B=F.buffer[he];return 128&B?B-256:B}function X(F){var he=F.reserve(2),B=F.buffer;return B[he++]<<8|B[he]}function k(F){var he=F.reserve(2),B=F.buffer,O=B[he++]<<8|B[he];return 32768&O?O-65536:O}function R(F){var he=F.reserve(4),B=F.buffer;return 16777216*B[he++]+(B[he++]<<16)+(B[he++]<<8)+B[he]}function ee(F){var he=F.reserve(4),B=F.buffer;return B[he++]<<24|B[he++]<<16|B[he++]<<8|B[he]}function H(F,he){return function(B){var O=B.reserve(F);return he.call(B.buffer,O,!0)}}function A(F){return new te(this,F).toNumber()}function M(F){return new v(this,F).toNumber()}function C(F){return new te(this,F)}function P(F){return new v(this,F)}function L(F){return f.read(this,F,!1,23,4)}function ne(F){return f.read(this,F,!1,52,8)}},1788:(T,fe,Ce)=>{var f=Ce(4613);function te(Q){var U,N=new Array(256);for(U=0;U<=127;U++)N[U]=D(U);for(U=128;U<=143;U++)N[U]=I(U-128,Q.map);for(U=144;U<=159;U++)N[U]=I(U-144,Q.array);for(U=160;U<=191;U++)N[U]=I(U-160,Q.str);for(N[192]=D(null),N[193]=null,N[194]=D(!1),N[195]=D(!0),N[196]=z(Q.uint8,Q.bin),N[197]=z(Q.uint16,Q.bin),N[198]=z(Q.uint32,Q.bin),N[199]=z(Q.uint8,Q.ext),N[200]=z(Q.uint16,Q.ext),N[201]=z(Q.uint32,Q.ext),N[202]=Q.float32,N[203]=Q.float64,N[204]=Q.uint8,N[205]=Q.uint16,N[206]=Q.uint32,N[207]=Q.uint64,N[208]=Q.int8,N[209]=Q.int16,N[210]=Q.int32,N[211]=Q.int64,N[212]=I(1,Q.ext),N[213]=I(2,Q.ext),N[214]=I(4,Q.ext),N[215]=I(8,Q.ext),N[216]=I(16,Q.ext),N[217]=z(Q.uint8,Q.str),N[218]=z(Q.uint16,Q.str),N[219]=z(Q.uint32,Q.str),N[220]=z(Q.uint16,Q.array),N[221]=z(Q.uint32,Q.array),N[222]=z(Q.uint16,Q.map),N[223]=z(Q.uint32,Q.map),U=224;U<=255;U++)N[U]=D(U-256);return N}function D(Q){return function(){return Q}}function z(Q,U){return function(N){var G=Q(N);return U(N,G)}}function I(Q,U){return function(N){return U(N,Q)}}fe.getReadToken=function S(Q){var U=f.getReadFormat(Q);return Q&&Q.useraw?function v(Q){var U,N=te(Q).slice();for(N[217]=N[196],N[218]=N[197],N[219]=N[198],U=160;U<=191;U++)N[U]=I(U-160,Q.bin);return N}(U):te(U)}},2732:(T,fe,Ce)=>{var f=Ce(7846).S,S=Ce(4106),te=Ce(9118),v=Ce(5166);function z(){var U=this.options;return this.encode=function D(U){var N=te.getWriteType(U);return function G(re,q){var E=N[typeof q];if(!E)throw new Error('Unsupported type "'+typeof q+'": '+q);E(re,q)}}(U),U&&U.preset&&S.setExtPackers(this),this}v.install({addExtPacker:function I(U,N,G){G=v.filter(G);var re=N.name;function V(le){return G&&(le=G(le)),new f(le,U)}re&&"Object"!==re?(this.extPackers||(this.extPackers={}))[re]=V:(this.extEncoderList||(this.extEncoderList=[])).unshift([N,V])},getExtPacker:function Q(U){var N=this.extPackers||(this.extPackers={}),G=U.constructor,re=G&&G.name&&N[G.name];if(re)return re;for(var q=this.extEncoderList||(this.extEncoderList=[]),E=q.length,V=0;V<E;V++){var le=q[V];if(G===le[0])return le[1]}},init:z}),fe.preset=z.call(v.preset)},3041:(T,fe,Ce)=>{var f=Ce(8461),S=Ce(6256),te=S.Uint64BE,v=S.Int64BE,D=Ce(8323).w,z=Ce(6093),I=z.global,U=z.hasBuffer&&"TYPED_ARRAY_SUPPORT"in I&&!I.TYPED_ARRAY_SUPPORT,N=z.hasBuffer&&I.prototype||{};function q(){var H=D.slice();return H[196]=V(196),H[197]=le(197),H[198]=Z(198),H[199]=V(199),H[200]=le(200),H[201]=Z(201),H[202]=Y(202,4,N.writeFloatBE||R,!0),H[203]=Y(203,8,N.writeDoubleBE||ee,!0),H[204]=V(204),H[205]=le(205),H[206]=Z(206),H[207]=Y(207,8,X),H[208]=V(208),H[209]=le(209),H[210]=Z(210),H[211]=Y(211,8,k),H[217]=V(217),H[218]=le(218),H[219]=Z(219),H[220]=le(220),H[221]=Z(221),H[222]=le(222),H[223]=Z(223),H}function V(H){return function(A,M){var C=A.reserve(2),P=A.buffer;P[C++]=H,P[C]=M}}function le(H){return function(A,M){var C=A.reserve(3),P=A.buffer;P[C++]=H,P[C++]=M>>>8,P[C]=M}}function Z(H){return function(A,M){var C=A.reserve(5),P=A.buffer;P[C++]=H,P[C++]=M>>>24,P[C++]=M>>>16,P[C++]=M>>>8,P[C]=M}}function Y(H,A,M,C){return function(P,L){var ne=P.reserve(A+1);P.buffer[ne++]=H,M.call(P.buffer,L,ne,C)}}function X(H,A){new te(this,A,H)}function k(H,A){new v(this,A,H)}function R(H,A){f.write(this,H,A,!1,23,4)}function ee(H,A){f.write(this,H,A,!1,52,8)}fe.getWriteToken=function G(H){return H&&H.uint8array?function re(){var H=q();return H[202]=Y(202,4,R),H[203]=Y(203,8,ee),H}():U||z.hasBuffer&&H&&H.safe?function E(){var H=D.slice();return H[196]=Y(196,1,I.prototype.writeUInt8),H[197]=Y(197,2,I.prototype.writeUInt16BE),H[198]=Y(198,4,I.prototype.writeUInt32BE),H[199]=Y(199,1,I.prototype.writeUInt8),H[200]=Y(200,2,I.prototype.writeUInt16BE),H[201]=Y(201,4,I.prototype.writeUInt32BE),H[202]=Y(202,4,I.prototype.writeFloatBE),H[203]=Y(203,8,I.prototype.writeDoubleBE),H[204]=Y(204,1,I.prototype.writeUInt8),H[205]=Y(205,2,I.prototype.writeUInt16BE),H[206]=Y(206,4,I.prototype.writeUInt32BE),H[207]=Y(207,8,X),H[208]=Y(208,1,I.prototype.writeInt8),H[209]=Y(209,2,I.prototype.writeInt16BE),H[210]=Y(210,4,I.prototype.writeInt32BE),H[211]=Y(211,8,k),H[217]=Y(217,1,I.prototype.writeUInt8),H[218]=Y(218,2,I.prototype.writeUInt16BE),H[219]=Y(219,4,I.prototype.writeUInt32BE),H[220]=Y(220,2,I.prototype.writeUInt16BE),H[221]=Y(221,4,I.prototype.writeUInt32BE),H[222]=Y(222,2,I.prototype.writeUInt16BE),H[223]=Y(223,4,I.prototype.writeUInt32BE),H}():q()}},9118:(T,fe,Ce)=>{var f=Ce(6425),S=Ce(6256),te=S.Uint64BE,v=S.Int64BE,D=Ce(6093),z=Ce(5364),I=Ce(3041),Q=Ce(8323).w,U=Ce(7846).S,N="undefined"!=typeof Uint8Array,G="undefined"!=typeof Map,re=[];re[1]=212,re[2]=213,re[4]=214,re[8]=215,re[16]=216,fe.getWriteType=function q(E){var V=I.getWriteToken(E),le=E&&E.useraw,Z=N&&E&&E.binarraybuffer,Y=Z?D.isArrayBuffer:D.isBuffer,X=Z?function l(_,x){m(_,new Uint8Array(x))}:m,R=G&&E&&E.usemap?function d(_,x){if(!(x instanceof Map))return h(_,x);var $=x.size;V[$<16?128+$:$<=65535?222:223](_,$);var ae=_.codec.encode;x.forEach(function(Te,Ae,de){ae(_,Ae),ae(_,Te)})}:h;return{boolean:function H(_,x){V[x?195:194](_,x)},function:B,number:function A(_,x){var $=0|x;x===$?V[-32<=$&&$<=127?255&$:0<=$?$<=255?204:$<=65535?205:206:-128<=$?208:-32768<=$?209:210](_,$):V[203](_,x)},object:le?function he(_,x){if(Y(x))return function p(_,x){var $=x.length;V[$<32?160+$:$<=65535?218:219](_,$),_.send(x)}(_,x);F(_,x)}:F,string:function ne(_){return function x($,se){var ae=se.length;$.offset=$.reserve(5+3*ae);var Ae=$.buffer,de=_(ae),Fe=$.offset+de;ae=z.write.call(Ae,se,Fe);var xe=_(ae);de!==xe&&z.copy.call(Ae,Ae,Fe+xe-de,Fe,Fe+ae),V[1===xe?160+ae:xe<=3?215+xe:219]($,ae),$.offset+=ae}}(le?function L(_){return _<32?1:_<=65535?3:5}:function P(_){return _<32?1:_<=255?2:_<=65535?3:5}),symbol:B,undefined:B};function F(_,x){if(null===x)return B(_,x);if(Y(x))return X(_,x);if(f(x))return function O(_,x){var $=x.length;V[$<16?144+$:$<=65535?220:221](_,$);for(var ae=_.codec.encode,Te=0;Te<$;Te++)ae(_,x[Te])}(_,x);if(te.isUint64BE(x))return function M(_,x){V[207](_,x.toArray())}(_,x);if(v.isInt64BE(x))return function C(_,x){V[211](_,x.toArray())}(_,x);var $=_.codec.getExtPacker(x);if($&&(x=$(x)),x instanceof U)return function c(_,x){var $=x.buffer,se=$.length;V[re[se]||(se<255?199:se<=65535?200:201)](_,se),Q[x.type](_),_.send($)}(_,x);R(_,x)}function B(_,x){V[192](_,x)}function m(_,x){var $=x.length;V[$<255?196:$<=65535?197:198](_,$),_.send(x)}function h(_,x){var $=Object.keys(x),se=$.length;V[se<16?128+se:se<=65535?222:223](_,se);var Te=_.codec.encode;$.forEach(function(Ae){Te(_,Ae),Te(_,x[Ae])})}}},8323:(T,fe)=>{for(var Ce=fe.w=new Array(256),f=0;f<=255;f++)Ce[f]=S(f);function S(te){return function(v){var D=v.reserve(1);v.buffer[D]=te}}},1203:T=>{function fe(te){var v="    ";if(isNaN(parseInt(te)))v=te;else switch(te){case 1:v=" ";break;case 2:v="  ";break;case 3:v="   ";break;case 4:v="    ";break;case 5:v="     ";break;case 6:v="      ";break;case 7:v="       ";break;case 8:v="        ";break;case 9:v="         ";break;case 10:v="          ";break;case 11:v="           ";break;case 12:v="            "}for(var D=["\n"],z=0;z<100;z++)D.push(D[z]+v);return D}function Ce(){this.step="    ",this.shift=fe(this.step)}function f(te,v){return v-(te.replace(/\(/g,"").length-te.replace(/\)/g,"").length)}function S(te,v){return te.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+v+v+"AND ").replace(/ BETWEEN /gi,"~::~"+v+"BETWEEN ").replace(/ CASE /gi,"~::~"+v+"CASE ").replace(/ ELSE /gi,"~::~"+v+"ELSE ").replace(/ END /gi,"~::~"+v+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+v+"ON ").replace(/ OR /gi,"~::~"+v+v+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+v+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+v).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+v+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/\s{0,}UPDATE /gi,"UPDATE ").replace(/ SET /gi," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}Ce.prototype.xml=function(te,v){var D=te.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),z=D.length,I=!1,Q=0,U="",N=0,G=v?fe(v):this.shift;for(N=0;N<z;N++)D[N].search(/<!/)>-1?(U+=G[Q]+D[N],I=!0,(D[N].search(/-->/)>-1||D[N].search(/\]>/)>-1||D[N].search(/!DOCTYPE/)>-1)&&(I=!1)):D[N].search(/-->/)>-1||D[N].search(/\]>/)>-1?(U+=D[N],I=!1):/^<\w/.exec(D[N-1])&&/^<\/\w/.exec(D[N])&&/^<[\w:\-\.\,]+/.exec(D[N-1])==/^<\/[\w:\-\.\,]+/.exec(D[N])[0].replace("/","")?(U+=D[N],I||Q--):D[N].search(/<\w/)>-1&&-1==D[N].search(/<\//)&&-1==D[N].search(/\/>/)?U=U+=I?D[N]:G[Q++]+D[N]:D[N].search(/<\w/)>-1&&D[N].search(/<\//)>-1?U=U+=I?D[N]:G[Q]+D[N]:D[N].search(/<\//)>-1?U=U+=I?D[N]:G[--Q]+D[N]:D[N].search(/\/>/)>-1?U=U+=I?D[N]:G[Q]+D[N]:D[N].search(/<\?/)>-1||D[N].search(/xmlns\:/)>-1||D[N].search(/xmlns\=/)>-1?U+=G[Q]+D[N]:U+=D[N];return"\n"==U[0]?U.slice(1):U},Ce.prototype.json=function(te,D){return D=D||this.step,"undefined"==typeof JSON?te:"string"==typeof te?JSON.stringify(JSON.parse(te),null,D):"object"==typeof te?JSON.stringify(te,null,D):te},Ce.prototype.css=function(te,v){var D=te.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),z=D.length,I=0,Q="",U=0,N=v?fe(v):this.shift;for(U=0;U<z;U++)/\{/.exec(D[U])?Q+=N[I++]+D[U]:/\}/.exec(D[U])?Q+=N[--I]+D[U]:(/\*\\/.exec(D[U]),Q+=N[I]+D[U]);return Q.replace(/^\n{1,}/,"")},Ce.prototype.sql=function(te,v){var D=te.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),z=D.length,I=[],Q=0,U=this.step,re=0,q="",E=0,V=v?fe(v):this.shift;for(E=0;E<z;E++)I=I.concat(E%2?D[E]:S(D[E],U));for(z=I.length,E=0;E<z;E++)re=f(I[E],re),/\s{0,}\s{0,}SELECT\s{0,}/.exec(I[E])&&(I[E]=I[E].replace(/\,/g,",\n"+U+U)),/\s{0,}\s{0,}SET\s{0,}/.exec(I[E])&&(I[E]=I[E].replace(/\,/g,",\n"+U+U)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(I[E])?q+=V[++Q]+I[E]:/\'/.exec(I[E])?(re<1&&Q&&Q--,q+=I[E]):(q+=V[Q]+I[E],re<1&&Q&&Q--);return q.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},Ce.prototype.xmlmin=function(te,v){return(v?te:te.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns")).replace(/>\s{0,}</g,"><")},Ce.prototype.jsonmin=function(te){return"undefined"==typeof JSON?te:JSON.stringify(JSON.parse(te),null,0)},Ce.prototype.cssmin=function(te,v){return(v?te:te.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"")).replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},Ce.prototype.sqlmin=function(te){return te.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")},T.exports=new Ce},2480:()=>{},5861:(T,fe,Ce)=>{"use strict";function f(te,v,D,z,I,Q,U){try{var N=te[Q](U),G=N.value}catch(re){return void D(re)}N.done?v(G):Promise.resolve(G).then(z,I)}function S(te){return function(){var v=this,D=arguments;return new Promise(function(z,I){var Q=te.apply(v,D);function U(G){f(Q,z,I,U,N,"next",G)}function N(G){f(Q,z,I,U,N,"throw",G)}U(void 0)})}}Ce.d(fe,{Z:()=>S})},6884:T=>{"use strict";T.exports=JSON.parse('{"ja_jp":{"success":"\u6210\u529f","failure":"\u5931\u6557","critical":"\u30af\u30ea\u30c6\u30a3\u30ab\u30eb","fumble":"\u30d5\u30a1\u30f3\u30d6\u30eb"},"zh_hans":{"success":"\u6210\u529f","failure":"\u5931\u8d25","fumble":"\u5927\u5931\u8d25","RTT":{"rtt_format":"\u968f\u673a\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s","rttn_format":"%<category_name>s\u9886\u57df\u968f\u673a\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"}},"ko_kr":{"success":"\uc131\uacf5","failure":"\uc2e4\ud328","fumble":"\ud38c\ube14","RTT":{"rtt_format":"\ub79c\ub364 \ud2b9\uae30 \uacb0\uc815\ud45c(%<category_dice>d,%<row_dice>d) \uff1e %<text>s","rttn_format":"\uc9c0\uc815\ud2b9\uae30(%<category_name>s)\ud45c(%<row_dice>d) \uff1e %<text>s"}},"en_us":{"success":"Success","failure":"Failure","critical":"Critical","fumble":"Fumble"},"zh_hant":{"success":"\u6210\u529f","failure":"\u5931\u6557"}}')},1014:T=>{"use strict";T.exports={}}},T=>{T(T.s=7849)}]);